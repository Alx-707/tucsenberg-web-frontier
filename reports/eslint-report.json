[{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/.dependency-cruiser.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/.size-limit.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/__mocks__/fileMock.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/env.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/instrumentation-client.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/instrumentation.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/lighthouserc.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/mdx-components.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/middleware.ts","messages":[{"ruleId":"max-statements","severity":2,"message":"Function 'middleware' has too many statements (24). Maximum allowed is 20.","line":96,"column":16,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":160,"endColumn":2}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from 'next/server';\nimport createMiddleware from 'next-intl/middleware';\nimport { generateNonce, getSecurityHeaders } from './src/config/security';\nimport { OPACITY_CONSTANTS } from './src/constants/app-constants';\nimport { routing } from './src/i18n/routing';\n\n// 置信度常量\nconst HIGH_CONFIDENCE = OPACITY_CONSTANTS.VERY_HIGH_OPACITY;\nconst MEDIUM_CONFIDENCE = OPACITY_CONSTANTS.HIGH_OPACITY;\nconst BROWSER_CONFIDENCE = OPACITY_CONSTANTS.MEDIUM_HIGH_OPACITY; // 浏览器语言检测置信度 (0.6)\n\n// 地理位置到语言的映射\nconst GEO_LOCALE_MAP: Record<string, string> = {\n  CN: 'zh',\n  TW: 'zh',\n  HK: 'zh',\n  MO: 'zh',\n  SG: 'zh',\n  US: 'en',\n  GB: 'en',\n  CA: 'en',\n  AU: 'en',\n  NZ: 'en',\n  IE: 'en',\n  ZA: 'en',\n  IN: 'en',\n};\n\n// 浏览器语言到支持语言的映射\nconst BROWSER_LOCALE_MAP: Record<string, string> = {\n  'zh': 'zh',\n  'zh-CN': 'zh',\n  'zh-TW': 'zh',\n  'zh-HK': 'zh',\n  'zh-SG': 'zh',\n  'en': 'en',\n  'en-US': 'en',\n  'en-GB': 'en',\n  'en-CA': 'en',\n  'en-AU': 'en',\n};\n\n// 简化的语言检测函数\nfunction detectLocaleFromHeaders(request: NextRequest) {\n  // 1. 检查地理位置\n  const country =\n    request.headers.get('x-vercel-ip-country') ||\n    request.headers.get('cf-ipcountry') ||\n    request.headers.get('x-country-code');\n\n  if (country) {\n    const geoLocale = GEO_LOCALE_MAP[country.toUpperCase()];\n    if (geoLocale) {\n      return {\n        locale: geoLocale,\n        source: 'geo',\n        confidence: country === 'CN' ? HIGH_CONFIDENCE : MEDIUM_CONFIDENCE,\n        country: country.toUpperCase(),\n      };\n    }\n  }\n\n  // 2. 检查浏览器语言\n  const acceptLanguage = request.headers.get('accept-language');\n  if (acceptLanguage) {\n    const languages = acceptLanguage\n      .split(',')\n      .map((lang) => lang?.split(';')[0]?.trim())\n      .filter(Boolean);\n\n    for (const lang of languages) {\n      if (!lang) continue;\n      const browserLocale = BROWSER_LOCALE_MAP[lang.toLowerCase()];\n      if (browserLocale) {\n        return {\n          locale: browserLocale,\n          source: 'browser',\n          confidence: BROWSER_CONFIDENCE,\n          languages,\n        };\n      }\n    }\n  }\n\n  // 3. 默认语言\n  return {\n    locale: 'en',\n    source: 'default',\n    confidence: OPACITY_CONSTANTS.MEDIUM_OPACITY, // 0.5\n  };\n}\n\n// 创建基础的 next-intl 中间件\nconst intlMiddleware = createMiddleware(routing);\n\nexport default function middleware(request: NextRequest) {\n  // 测试环境下跳过next-intl middleware（修复Playwright测试环境下的SSR失败问题）\n  if (process.env.PLAYWRIGHT_TEST === 'true') {\n    const response = NextResponse.next();\n\n    // 仍然添加安全headers\n    const nonce = generateNonce();\n    const securityHeaders = getSecurityHeaders(nonce);\n    securityHeaders.forEach(({ key, value }) => {\n      response.headers.set(key, value);\n    });\n    response.headers.set('x-csp-nonce', nonce);\n\n    return response;\n  }\n\n  // Generate nonce for CSP\n  const nonce = generateNonce();\n\n  // 执行简化的语言检测\n  const detectionResult = detectLocaleFromHeaders(request);\n\n  // 创建增强的请求对象\n  const enhancedRequest = new Request(request.url, {\n    ...request,\n    headers: new Headers(request.headers),\n  });\n\n  // 添加检测信息到请求头\n  enhancedRequest.headers.set('x-detected-locale', detectionResult.locale);\n  enhancedRequest.headers.set('x-detection-source', detectionResult.source);\n  enhancedRequest.headers.set(\n    'x-detection-confidence',\n    detectionResult.confidence.toString(),\n  );\n\n  // Add security nonce to request headers\n  enhancedRequest.headers.set('x-csp-nonce', nonce);\n\n  if (detectionResult.country) {\n    enhancedRequest.headers.set('x-detected-country', detectionResult.country);\n  }\n  if (detectionResult.languages) {\n    enhancedRequest.headers.set(\n      'x-detected-language',\n      detectionResult.languages.join(','),\n    );\n  }\n\n  // 调用原始的 next-intl 中间件\n  const response = intlMiddleware(enhancedRequest as NextRequest);\n\n  // Add security headers to response\n  if (response) {\n    const securityHeaders = getSecurityHeaders(nonce);\n    securityHeaders.forEach(({ key, value }) => {\n      response.headers.set(key, value);\n    });\n\n    // Add nonce to response for client-side access\n    response.headers.set('x-csp-nonce', nonce);\n  }\n\n  return response;\n}\n\nexport const config = {\n  // Match all pathnames except for\n  // - … if they start with `/api`, `/_next` or `/_vercel`\n  // - … the ones containing a dot (e.g. `favicon.ico`)\n  // - … the root path (handled by root page.tsx)\n  // - … the `/admin` path (TinaCMS admin interface)\n  matcher: '/((?!api|_next|_vercel|admin|^$|.*\\\\..*).*)',\n};\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/next.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/playwright.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/sentry.edge.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/sentry.server.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/__tests__/layout-fonts.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/__tests__/layout-metadata.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/__tests__/layout-structured-data.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/about/__tests__/page.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/about/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/accessibility-test/components/automated-test-section.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/accessibility-test/components/keyboard-shortcuts-guide.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/accessibility-test/components/manual-test-guide.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/accessibility-test/components/screen-reader-guide.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/accessibility-test/components/test-target-section.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/accessibility-test/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/blog/__tests__/page.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/blog/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/contact/__tests__/page-i18n-basic.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/contact/__tests__/page-i18n.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/contact/__tests__/page-rendering-basic-core.test.tsx","messages":[],"suppressedMessages":[{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":65,"column":14,"nodeType":"MemberExpression","endLine":65,"endColumn":31,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/contact/__tests__/page-rendering-basic.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/contact/__tests__/page-rendering.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/contact/__tests__/page.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/contact/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/demo-construction/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/dev-tools/components/demo-sections.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/dev-tools/components/documentation-links.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/dev-tools/components/keyboard-shortcuts.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/dev-tools/components/other-dev-tools.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/dev-tools/components/react-scan-intro.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/dev-tools/layout-test/components/issue-reporting.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/dev-tools/layout-test/components/keyboard-shortcuts.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/dev-tools/layout-test/components/layout-status.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/dev-tools/layout-test/components/layout-strategy.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/dev-tools/layout-test/components/test-instructions.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/dev-tools/layout-test/components/test-operations.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/dev-tools/layout-test/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/dev-tools/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/diagnostics/components.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/diagnostics/demo/components.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/diagnostics/demo/hooks.ts","messages":[{"ruleId":"max-statements","severity":2,"message":"Async arrow function has too many statements (21). Maximum allowed is 20.","line":24,"column":38,"nodeType":"ArrowFunctionExpression","messageId":"exceed","endLine":79,"endColumn":4}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useCallback, useState } from 'react';\nimport {\n  analyzePerformance,\n  testWebVitalsCollection,\n} from '@/scripts/test-web-vitals';\nimport {\n  exportTestResults,\n  PERFORMANCE_CONSTANTS,\n  simulatePerformanceIssues,\n  TestResults,\n} from './utils';\n\n// 诊断功能 Hook\nexport function useDiagnostics() {\n  const [testResults, setTestResults] = useState<TestResults | null>(null);\n  const [isRunning, setIsRunning] = useState(false);\n  const [logs, setLogs] = useState<string[]>([]);\n\n  const addLog = useCallback((message: string) => {\n    const timestamp = new Date().toLocaleTimeString();\n    setLogs((prev) => [...prev, `[${timestamp}] ${message}`]);\n  }, []);\n\n  const runDiagnostics = useCallback(async () => {\n    if (isRunning) return;\n\n    setIsRunning(true);\n    setLogs([]);\n    addLog('开始性能诊断...');\n\n    try {\n      // 1. 模拟性能问题\n      addLog('模拟性能问题...');\n      simulatePerformanceIssues();\n\n      // 2. 等待一段时间让性能问题生效\n      await new Promise((resolve) =>\n        setTimeout(resolve, PERFORMANCE_CONSTANTS.DIAGNOSTIC_DELAY),\n      );\n\n      // 3. 收集 Web Vitals 数据\n      addLog('收集 Web Vitals 数据...');\n      const report = testWebVitalsCollection();\n\n      if (report) {\n        // 4. 分析性能数据\n        addLog('分析性能数据...');\n        analyzePerformance(report);\n\n        // 5. 转换为组件需要的格式\n        const results: TestResults = {\n          metrics: {\n            cls: report.metrics.cls,\n            lcp: report.metrics.lcp,\n            fid: report.metrics.fid,\n            fcp: report.metrics.fcp,\n            ttfb: report.metrics.ttfb,\n          },\n          analysis: {\n            score: report.analysis.score,\n            issues: report.analysis.issues,\n            recommendations: report.analysis.recommendations,\n          },\n          timestamp: Date.now(),\n        };\n\n        setTestResults(results);\n        addLog(`诊断完成！总体评分: ${results.analysis.score}`);\n        addLog(`发现 ${results.analysis.issues.length} 个问题`);\n        addLog(`提供 ${results.analysis.recommendations.length} 条建议`);\n      } else {\n        addLog('诊断失败：无法收集性能数据');\n      }\n    } catch (error) {\n      addLog(`诊断过程中出现错误: ${error}`);\n    } finally {\n      setIsRunning(false);\n    }\n  }, [isRunning, addLog]);\n\n  const handleExportResults = useCallback(() => {\n    if (testResults) {\n      exportTestResults(testResults);\n      addLog('测试结果已导出');\n    }\n  }, [testResults, addLog]);\n\n  return {\n    testResults,\n    isRunning,\n    logs,\n    runDiagnostics,\n    handleExportResults,\n  };\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/diagnostics/demo/main-content.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/diagnostics/demo/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/diagnostics/demo/utils.ts","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":1,"message":"Do not use \"@ts-nocheck\" because it alters compilation errors.","line":1,"column":1,"nodeType":"Line","messageId":"tsDirectiveComment","endLine":1,"endColumn":42},{"ruleId":"max-nested-callbacks","severity":2,"message":"Too many nested callbacks (3). Maximum allowed is 2.","line":60,"column":18,"nodeType":"ArrowFunctionExpression","messageId":"exceed","endLine":64,"endColumn":8},{"ruleId":"no-undef","severity":2,"message":"'DEV_TOOLS_CONSTANTS' is not defined.","line":64,"column":10,"nodeType":"Identifier","messageId":"undef","endLine":64,"endColumn":29},{"ruleId":"no-undef","severity":2,"message":"'DEV_TOOLS_CONSTANTS' is not defined.","line":72,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":72,"endColumn":24}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// @ts-nocheck - 开发工具豁免：仅开发环境使用，不影响生产代码质量\n// 性能诊断常量定义\nexport const PERFORMANCE_CONSTANTS = {\n  SIMULATION_DELAY: 2000,\n  DIAGNOSTIC_DELAY: 2000,\n  BLOCKING_DURATION: 100,\n  SPACING_INDENT: 2,\n  DECIMAL_PLACES: 3,\n  AUTO_RUN_DELAY: 1000,\n  // Web Vitals 阈值\n  CLS_GOOD_THRESHOLD: 0.1,\n  CLS_NEEDS_IMPROVEMENT_THRESHOLD: 0.25,\n  LCP_GOOD_THRESHOLD: 2500,\n  LCP_NEEDS_IMPROVEMENT_THRESHOLD: 4000,\n  FID_GOOD_THRESHOLD: 100,\n  FID_NEEDS_IMPROVEMENT_THRESHOLD: 300,\n  FCP_GOOD_THRESHOLD: 1800,\n  FCP_NEEDS_IMPROVEMENT_THRESHOLD: 3000,\n  TTFB_GOOD_THRESHOLD: 800,\n  TTFB_NEEDS_IMPROVEMENT_THRESHOLD: 1800,\n} as const;\n\n// 类型定义\nexport interface TestResults {\n  metrics: {\n    cls: number;\n    lcp: number;\n    fid: number;\n    fcp: number;\n    ttfb: number;\n    inp?: number;\n  };\n  analysis: {\n    score: number;\n    issues: string[];\n    recommendations: string[];\n  };\n  timestamp: number;\n}\n\n// 工具函数：模拟性能问题（优化版本 - 减少 CLS 影响）\nexport function simulatePerformanceIssues(): void {\n  // 模拟布局偏移 - 使用更温和的方式，避免严重的 CLS\n  const div = document.createElement('div');\n  div.style.height = '50px'; // 减少初始高度\n  div.style.backgroundColor = 'rgba(255, 0, 0, 0.3)'; // 半透明，减少视觉冲击\n  div.style.position = 'fixed'; // 使用 fixed 定位，减少对页面布局的影响\n  div.style.top = '10px';\n  div.style.right = '10px'; // 移到右上角，避免影响主要内容\n  div.style.width = '100px';\n  div.style.zIndex = '9999';\n  div.style.borderRadius = '4px';\n  div.style.transition = 'height 0.3s ease'; // 添加过渡动画，减少突兀感\n  document.body.appendChild(div);\n\n  setTimeout(() => {\n    div.style.height = '80px'; // 减少高度变化幅度\n    setTimeout(() => {\n      div.style.opacity = '0'; // 淡出效果\n      setTimeout(() => {\n        if (document.body.contains(div)) {\n          document.body.removeChild(div);\n        }\n      }, DEV_TOOLS_CONSTANTS.DIAGNOSTICS.DIAGNOSTIC_DELAY); // 等待淡出动画完成\n    }, PERFORMANCE_CONSTANTS.SIMULATION_DELAY);\n  }, PERFORMANCE_CONSTANTS.BLOCKING_DURATION);\n\n  // 模拟主线程阻塞 - 减少阻塞时间\n  const start = performance.now();\n  const reducedBlockingTime = Math.min(\n    PERFORMANCE_CONSTANTS.BLOCKING_DURATION,\n    DEV_TOOLS_CONSTANTS.LAYOUT.DEFAULT_OFFSET,\n  ); // 最多阻塞50ms\n  while (performance.now() - start < reducedBlockingTime) {\n    // 阻塞主线程\n  }\n}\n\n// 工具函数：导出测试结果\nexport function exportTestResults(testResults: TestResults): void {\n  const data = {\n    ...testResults,\n    exportedAt: new Date().toISOString(),\n    userAgent: navigator.userAgent,\n    viewport: {\n      width: window.innerWidth,\n      height: window.innerHeight,\n    },\n  };\n\n  const blob = new Blob(\n    [JSON.stringify(data, null, PERFORMANCE_CONSTANTS.SPACING_INDENT)],\n    {\n      type: 'application/json',\n    },\n  );\n  const url = URL.createObjectURL(blob);\n  const a = document.createElement('a');\n  a.href = url;\n  a.download = `web-vitals-demo-${new Date().toISOString().split('T')[0]}.json`;\n  document.body.appendChild(a);\n  a.click();\n  document.body.removeChild(a);\n  URL.revokeObjectURL(url);\n}\n\n// 工具函数：获取性能指标状态\nexport function getMetricStatus(\n  value: number,\n  goodThreshold: number,\n  needsImprovementThreshold: number,\n): 'default' | 'secondary' | 'destructive' {\n  if (value <= goodThreshold) return 'default';\n  if (value <= needsImprovementThreshold) return 'secondary';\n  return 'destructive';\n}\n\n// 工具函数：获取性能指标标签\nexport function getMetricLabel(\n  value: number,\n  goodThreshold: number,\n  needsImprovementThreshold: number,\n): string {\n  if (value <= goodThreshold) return '良好';\n  if (value <= needsImprovementThreshold) return '需要改进';\n  return '较差';\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/diagnostics/diagnostics-constants.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'key' is defined but never used. Allowed unused args must match /^_/u.","line":194,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":194,"endColumn":29,"suggestions":[{"messageId":"removeVar","data":{"varName":"key"},"fix":{"range":[4948,4960],"text":""},"desc":"Remove unused variable 'key'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'value' is defined but never used. Allowed unused args must match /^_/u.","line":194,"column":31,"nodeType":"Identifier","messageId":"unusedVar","endLine":194,"endColumn":44,"suggestions":[{"messageId":"removeVar","data":{"varName":"value"},"fix":{"range":[4959,4974],"text":""},"desc":"Remove unused variable 'value'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// 诊断页面常量和工具函数\n\nimport {\n  AlertTriangle,\n  CheckCircle,\n  XCircle,\n} from 'lucide-react';\nimport { Badge } from '@/components/ui/badge';\n\n// 重新导出类型以便其他文件使用\nexport type { SimpleWebVitals } from './utils';\n\n// 常量定义 - 避免魔法数字\nexport const UI_CONSTANTS = {\n  ICON_SIZE: 4, // Tailwind w-4 h-4\n  SCORE_EXCELLENT_THRESHOLD: 80,\n  SCORE_GOOD_THRESHOLD: 50,\n} as const;\n\n// Web Vitals 阈值常量 - 用于显示\nexport const DISPLAY_THRESHOLDS = {\n  CLS_GOOD: 0.1,\n  CLS_NEEDS_IMPROVEMENT: 0.25,\n  LCP_GOOD: 2.5, // 秒\n  LCP_NEEDS_IMPROVEMENT: 4.0, // 秒\n  FID_GOOD: 100, // 毫秒\n  FID_NEEDS_IMPROVEMENT: 300, // 毫秒\n} as const;\n\n// 指标配置\nexport const METRIC_CONFIGS = [\n  { key: 'cls', label: 'CLS', description: '累积布局偏移' },\n  { key: 'lcp', label: 'LCP', description: '最大内容绘制' },\n  { key: 'fid', label: 'FID', description: '首次输入延迟' },\n  { key: 'fcp', label: 'FCP', description: '首次内容绘制' },\n  { key: 'ttfb', label: 'TTFB', description: '首字节时间' },\n] as const;\n\n// 工具函数：获取状态图标\nexport function getStatusIcon(status: string) {\n  const iconClass = `h-${UI_CONSTANTS.ICON_SIZE} w-${UI_CONSTANTS.ICON_SIZE}`;\n\n  switch (status) {\n    case 'good':\n      return <CheckCircle className={`${iconClass} text-green-600`} />;\n    case 'needs-improvement':\n      return <AlertTriangle className={`${iconClass} text-yellow-600`} />;\n    case 'poor':\n      return <XCircle className={`${iconClass} text-red-600`} />;\n    default:\n      return <AlertTriangle className={`${iconClass} text-gray-400`} />;\n  }\n}\n\n// 工具函数：获取状态标签文本\nexport function getStatusLabel(status: string): string {\n  switch (status) {\n    case 'good':\n      return '良好';\n    case 'needs-improvement':\n      return '需要改进';\n    default:\n      return '较差';\n  }\n}\n\n// 工具函数：获取Badge变体\nexport function getBadgeVariant(\n  status: string,\n): 'default' | 'secondary' | 'destructive' {\n  switch (status) {\n    case 'good':\n      return 'default';\n    case 'needs-improvement':\n      return 'secondary';\n    default:\n      return 'destructive';\n  }\n}\n\n// 工具函数：获取评分状态\nexport function getScoreStatus(score: number): string {\n  return score >= UI_CONSTANTS.SCORE_EXCELLENT_THRESHOLD\n    ? 'good'\n    : score >= UI_CONSTANTS.SCORE_GOOD_THRESHOLD\n      ? 'needs-improvement'\n      : 'poor';\n}\n\n// 工具函数：获取评分标签\nexport function getScoreLabel(score: number): string {\n  return score >= UI_CONSTANTS.SCORE_EXCELLENT_THRESHOLD\n    ? '优秀'\n    : score >= UI_CONSTANTS.SCORE_GOOD_THRESHOLD\n      ? '良好'\n      : '需要优化';\n}\n\n// 指标卡片组件\ninterface MetricCardProps {\n  label: string;\n  value: string;\n  status: string;\n  description: string;\n}\n\nexport function MetricCard({ label, value, status, description }: MetricCardProps) {\n  return (\n    <div className='rounded-lg border p-4'>\n      <div className='mb-2 flex items-center justify-between'>\n        <h3 className='font-semibold'>{label}</h3>\n        {getStatusIcon(status)}\n      </div>\n      <div className='mb-1 text-2xl font-bold'>{value}</div>\n      <Badge variant={getBadgeVariant(status)}>{getStatusLabel(status)}</Badge>\n      <p className='text-muted-foreground mt-2 text-sm'>{description}</p>\n    </div>\n  );\n}\n\n// 综合评分卡片组件\ninterface ScoreCardProps {\n  score: number;\n}\n\nexport function ScoreCard({ score }: ScoreCardProps) {\n  const scoreStatus = getScoreStatus(score);\n  const scoreLabel = getScoreLabel(score);\n\n  return (\n    <div className='rounded-lg border p-4'>\n      <div className='mb-2 flex items-center justify-between'>\n        <h3 className='font-semibold'>综合评分</h3>\n        {getStatusIcon(scoreStatus)}\n      </div>\n      <div className='mb-1 text-2xl font-bold'>\n        {Math.round(score)}\n      </div>\n      <Badge variant={getBadgeVariant(scoreStatus)}>{scoreLabel}</Badge>\n      <p className='text-muted-foreground mt-2 text-sm'>整体性能评估</p>\n    </div>\n  );\n}\n\n// 阈值显示组件\ninterface ThresholdDisplayProps {\n  title: string;\n  goodThreshold: number;\n  needsImprovementThreshold: number;\n  unit?: string;\n}\n\nexport function ThresholdDisplay({ \n  title, \n  goodThreshold, \n  needsImprovementThreshold, \n  unit = '' \n}: ThresholdDisplayProps) {\n  return (\n    <div>\n      <h4 className='mb-3 font-semibold'>{title}</h4>\n      <div className='space-y-2 text-sm'>\n        <div className='flex justify-between'>\n          <span className='text-green-600'>良好:</span>\n          <span>≤ {goodThreshold}{unit}</span>\n        </div>\n        <div className='flex justify-between'>\n          <span className='text-yellow-600'>需要改进:</span>\n          <span>\n            {goodThreshold}{unit} - {needsImprovementThreshold}{unit}\n          </span>\n        </div>\n        <div className='flex justify-between'>\n          <span className='text-red-600'>较差:</span>\n          <span>&gt; {needsImprovementThreshold}{unit}</span>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n// 历史记录项组件\ninterface HistoryItemProps {\n  record: {\n    timestamp: number;\n    url: string;\n    cls: number;\n    lcp: number;\n    fid: number;\n    score: number;\n  };\n  index: number;\n  totalCount: number;\n  formatMetric: (key: string, value: number) => string;\n}\n\nexport function HistoryItem({ \n  record, \n  index, \n  totalCount, \n  formatMetric \n}: HistoryItemProps) {\n  return (\n    <div className='flex items-center justify-between rounded-lg border p-3'>\n      <div className='flex items-center space-x-4'>\n        <div className='text-muted-foreground text-sm'>\n          #{totalCount - index}\n        </div>\n        <div>\n          <div className='font-medium'>\n            {new Date(record.timestamp).toLocaleString('zh-CN')}\n          </div>\n          <div className='text-muted-foreground text-sm'>\n            {record.url}\n          </div>\n        </div>\n      </div>\n      <div className='flex items-center space-x-4'>\n        <div className='text-center'>\n          <div className='text-sm font-medium'>\n            {formatMetric('cls', record.cls)}\n          </div>\n          <div className='text-muted-foreground text-xs'>CLS</div>\n        </div>\n        <div className='text-center'>\n          <div className='text-sm font-medium'>\n            {formatMetric('lcp', record.lcp)}\n          </div>\n          <div className='text-muted-foreground text-xs'>LCP</div>\n        </div>\n        <div className='text-center'>\n          <div className='text-sm font-medium'>\n            {formatMetric('fid', record.fid)}\n          </div>\n          <div className='text-muted-foreground text-xs'>FID</div>\n        </div>\n        <div className='text-center'>\n          <div className='text-sm font-medium'>\n            {Math.round(record.score)}\n          </div>\n          <div className='text-muted-foreground text-xs'>评分</div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/diagnostics/diagnostics-control-panel.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/diagnostics/diagnostics-current-metrics.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/diagnostics/diagnostics-historical-data.tsx","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'index' is defined but never used. Allowed unused args must match /^_/u.","line":103,"column":42,"nodeType":"Identifier","messageId":"unusedVar","endLine":103,"endColumn":47,"suggestions":[{"messageId":"removeVar","data":{"varName":"index"},"fix":{"range":[2923,2930],"text":""},"desc":"Remove unused variable 'index'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'index' is defined but never used. Allowed unused args must match /^_/u.","line":103,"column":42,"nodeType":null,"messageId":"unusedVar","endLine":103,"endColumn":47},{"ruleId":"no-unused-vars","severity":1,"message":"'index' is defined but never used. Allowed unused args must match /^_/u.","line":196,"column":35,"nodeType":"Identifier","messageId":"unusedVar","endLine":196,"endColumn":40,"suggestions":[{"messageId":"removeVar","data":{"varName":"index"},"fix":{"range":[5778,5785],"text":""},"desc":"Remove unused variable 'index'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'index' is defined but never used. Allowed unused args must match /^_/u.","line":196,"column":35,"nodeType":null,"messageId":"unusedVar","endLine":196,"endColumn":40},{"ruleId":"no-unused-vars","severity":1,"message":"'filteredData' is defined but never used. Allowed unused args must match /^_/u.","line":233,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":233,"endColumn":51,"suggestions":[{"messageId":"removeVar","data":{"varName":"filteredData"},"fix":{"range":[7139,7170],"text":""},"desc":"Remove unused variable 'filteredData'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// 诊断页面历史数据组件\n\nimport {\n  Card,\n  CardContent,\n  CardDescription,\n  CardHeader,\n  CardTitle,\n} from '@/components/ui/card';\nimport { formatMetric, type SimpleWebVitals } from './utils';\nimport { HistoryItem } from './diagnostics-constants';\n\n// 历史数据组件属性接口\ninterface HistoricalDataProps {\n  data: SimpleWebVitals[];\n}\n\n/**\n * 历史数据组件\n * 显示最近的性能检测记录\n */\nexport function HistoricalData({ data }: HistoricalDataProps) {\n  if (data.length === 0) return null;\n\n  return (\n    <Card className='mb-6'>\n      <CardHeader>\n        <CardTitle>历史性能数据</CardTitle>\n        <CardDescription>最近 {data.length} 次性能检测记录</CardDescription>\n      </CardHeader>\n      <CardContent>\n        <div className='space-y-4'>\n          {data.map((record, index) => (\n            <HistoryItem\n              key={record.timestamp}\n              record={record}\n              index={index}\n              totalCount={data.length}\n              formatMetric={formatMetric}\n            />\n          ))}\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n\n// 历史趋势组件属性接口\ninterface HistoricalTrendProps {\n  data: SimpleWebVitals[];\n  metricKey: string;\n  title: string;\n}\n\n/**\n * 历史趋势组件\n * 显示特定指标的历史趋势\n */\nexport function HistoricalTrend({ data, metricKey, title }: HistoricalTrendProps) {\n  if (data.length === 0) return null;\n\n  const values = data.map(record => record[metricKey as keyof SimpleWebVitals] as number);\n  const average = values.reduce((sum, val) => sum + val, 0) / values.length;\n  const latest = values[values.length - 1];\n  const trend = values.length > 1 ? \n    (latest > values[values.length - 2] ? 'up' : \n     latest < values[values.length - 2] ? 'down' : 'same') : 'same';\n\n  return (\n    <Card>\n      <CardHeader>\n        <CardTitle>{title} 趋势</CardTitle>\n        <CardDescription>基于最近 {data.length} 次检测</CardDescription>\n      </CardHeader>\n      <CardContent>\n        <div className='space-y-4'>\n          <div className='grid grid-cols-3 gap-4 text-center'>\n            <div>\n              <div className='text-2xl font-bold'>\n                {formatMetric(metricKey, latest)}\n              </div>\n              <div className='text-sm text-muted-foreground'>最新值</div>\n            </div>\n            <div>\n              <div className='text-2xl font-bold'>\n                {formatMetric(metricKey, average)}\n              </div>\n              <div className='text-sm text-muted-foreground'>平均值</div>\n            </div>\n            <div>\n              <div className={`text-2xl font-bold ${\n                trend === 'up' ? 'text-red-600' :\n                trend === 'down' ? 'text-green-600' :\n                'text-gray-600'\n              }`}>\n                {trend === 'up' ? '↗️' : trend === 'down' ? '↘️' : '→'}\n              </div>\n              <div className='text-sm text-muted-foreground'>趋势</div>\n            </div>\n          </div>\n          \n          <div className='space-y-2'>\n            {data.slice(-5).map((record, index) => (\n              <div key={record.timestamp} className='flex items-center justify-between text-sm'>\n                <span className='text-muted-foreground'>\n                  {new Date(record.timestamp).toLocaleString('zh-CN')}\n                </span>\n                <span className='font-medium'>\n                  {formatMetric(metricKey, record[metricKey as keyof SimpleWebVitals] as number)}\n                </span>\n              </div>\n            ))}\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n\n// 历史统计组件属性接口\ninterface HistoricalStatsProps {\n  data: SimpleWebVitals[];\n}\n\n/**\n * 历史统计组件\n * 显示历史数据的统计信息\n */\nexport function HistoricalStats({ data }: HistoricalStatsProps) {\n  if (data.length === 0) return null;\n\n  const scores = data.map(record => record.score);\n  const averageScore = scores.reduce((sum, score) => sum + score, 0) / scores.length;\n  const maxScore = Math.max(...scores);\n  const minScore = Math.min(...scores);\n  \n  const goodRecords = data.filter(record => record.score >= 80).length;\n  const improvementRate = (goodRecords / data.length) * 100;\n\n  return (\n    <Card>\n      <CardHeader>\n        <CardTitle>历史统计</CardTitle>\n        <CardDescription>基于 {data.length} 次检测记录</CardDescription>\n      </CardHeader>\n      <CardContent>\n        <div className='grid grid-cols-2 gap-4'>\n          <div className='space-y-4'>\n            <div className='text-center'>\n              <div className='text-2xl font-bold'>{Math.round(averageScore)}</div>\n              <div className='text-sm text-muted-foreground'>平均评分</div>\n            </div>\n            <div className='text-center'>\n              <div className='text-2xl font-bold'>{Math.round(maxScore)}</div>\n              <div className='text-sm text-muted-foreground'>最高评分</div>\n            </div>\n          </div>\n          <div className='space-y-4'>\n            <div className='text-center'>\n              <div className='text-2xl font-bold'>{Math.round(minScore)}</div>\n              <div className='text-sm text-muted-foreground'>最低评分</div>\n            </div>\n            <div className='text-center'>\n              <div className='text-2xl font-bold'>{Math.round(improvementRate)}%</div>\n              <div className='text-sm text-muted-foreground'>优秀率</div>\n            </div>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n\n// 简化历史数据组件属性接口\ninterface SimpleHistoricalDataProps {\n  data: SimpleWebVitals[];\n  maxItems?: number;\n}\n\n/**\n * 简化历史数据组件\n * 显示简化的历史记录列表\n */\nexport function SimpleHistoricalData({ \n  data, \n  maxItems = 5 \n}: SimpleHistoricalDataProps) {\n  if (data.length === 0) return null;\n\n  const displayData = data.slice(-maxItems);\n\n  return (\n    <div className='space-y-3'>\n      <h3 className='text-lg font-semibold'>最近检测记录</h3>\n      <div className='space-y-2'>\n        {displayData.map((record, index) => (\n          <div \n            key={record.timestamp}\n            className='flex items-center justify-between rounded-lg border p-3'\n          >\n            <div>\n              <div className='font-medium'>\n                {new Date(record.timestamp).toLocaleString('zh-CN')}\n              </div>\n              <div className='text-sm text-muted-foreground'>\n                评分: {Math.round(record.score)}\n              </div>\n            </div>\n            <div className='flex space-x-3 text-sm'>\n              <div className='text-center'>\n                <div className='font-medium'>{formatMetric('cls', record.cls)}</div>\n                <div className='text-muted-foreground text-xs'>CLS</div>\n              </div>\n              <div className='text-center'>\n                <div className='font-medium'>{formatMetric('lcp', record.lcp)}</div>\n                <div className='text-muted-foreground text-xs'>LCP</div>\n              </div>\n              <div className='text-center'>\n                <div className='font-medium'>{formatMetric('fid', record.fid)}</div>\n                <div className='text-muted-foreground text-xs'>FID</div>\n              </div>\n            </div>\n          </div>\n        ))}\n      </div>\n    </div>\n  );\n}\n\n// 历史数据过滤器组件属性接口\ninterface HistoricalDataFilterProps {\n  data: SimpleWebVitals[];\n  onFilterChange: (filteredData: SimpleWebVitals[]) => void;\n}\n\n/**\n * 历史数据过滤器组件\n * 提供数据过滤功能\n */\nexport function HistoricalDataFilter({ \n  data, \n  onFilterChange \n}: HistoricalDataFilterProps) {\n  const filterByTimeRange = (days: number) => {\n    const cutoffTime = Date.now() - (days * 24 * 60 * 60 * 1000);\n    const filtered = data.filter(record => record.timestamp >= cutoffTime);\n    onFilterChange(filtered);\n  };\n\n  const filterByScore = (minScore: number) => {\n    const filtered = data.filter(record => record.score >= minScore);\n    onFilterChange(filtered);\n  };\n\n  return (\n    <div className='mb-4 flex flex-wrap gap-2'>\n      <button\n        onClick={() => onFilterChange(data)}\n        className='rounded-md border px-3 py-1 text-sm hover:bg-gray-50'\n      >\n        全部\n      </button>\n      <button\n        onClick={() => filterByTimeRange(7)}\n        className='rounded-md border px-3 py-1 text-sm hover:bg-gray-50'\n      >\n        最近7天\n      </button>\n      <button\n        onClick={() => filterByTimeRange(30)}\n        className='rounded-md border px-3 py-1 text-sm hover:bg-gray-50'\n      >\n        最近30天\n      </button>\n      <button\n        onClick={() => filterByScore(80)}\n        className='rounded-md border px-3 py-1 text-sm hover:bg-gray-50'\n      >\n        优秀记录\n      </button>\n      <button\n        onClick={() => filterByScore(50)}\n        className='rounded-md border px-3 py-1 text-sm hover:bg-gray-50'\n      >\n        良好以上\n      </button>\n    </div>\n  );\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/diagnostics/diagnostics-threshold-reference.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/diagnostics/page-components.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/diagnostics/page-hooks.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/diagnostics/page-new.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/diagnostics/page-utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/diagnostics/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/diagnostics/utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/layout-fonts.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/layout-metadata.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/layout-structured-data.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/layout-test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/products/__tests__/page.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/products/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/react-scan-demo/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/react-scan-demo/react-scan-components.tsx","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":1,"message":"Do not use \"@ts-nocheck\" because it alters compilation errors.","line":1,"column":1,"nodeType":"Line","messageId":"tsDirectiveComment","endLine":1,"endColumn":42},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useMemo has an unnecessary dependency: 'count'. Either exclude it or remove the dependency array.","line":72,"column":6,"nodeType":"ArrayExpression","endLine":72,"endColumn":13,"suggestions":[{"desc":"Update the dependencies array to be: []","fix":{"range":[1740,1747],"text":"[]"}}]},{"ruleId":"require-await","severity":2,"message":"Async arrow function has no 'await' expression.","line":153,"column":51,"nodeType":"ArrowFunctionExpression","messageId":"missingAwait","endLine":153,"endColumn":53,"suggestions":[{"messageId":"removeAsync","fix":{"range":[3823,3829],"text":""},"desc":"Remove 'async'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'result' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":163,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":163,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'result' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":163,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":163,"endColumn":15},{"ruleId":"no-unused-vars","severity":1,"message":"'result' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":176,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":176,"endColumn":19,"suggestions":[{"messageId":"removeVar","data":{"varName":"result"},"fix":{"range":[4423,4451],"text":""},"desc":"Remove unused variable 'result'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'result' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":176,"column":13,"nodeType":null,"messageId":"unusedVar","endLine":176,"endColumn":19}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// @ts-nocheck - 开发工具豁免：仅开发环境使用，不影响生产代码质量\n'use client';\n\nimport { useCallback, useMemo, useState } from 'react';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport {\n  Card,\n  CardContent,\n  CardDescription,\n  CardHeader,\n  CardTitle,\n} from '@/components/ui/card';\n\n/**\n * 故意设计的低效组件 - 用于演示 React Scan 检测不必要渲染\n */\nexport function IneffientComponent({ count }: { count: number }) {\n  // 故意在每次渲染时创建新对象 - 这会导致不必要的渲染\n  const expensiveObject = {\n    timestamp: Date.now(),\n    random: Math.random(),\n    count,\n  };\n\n  // 故意的昂贵计算 - 每次渲染都会执行\n  let expensiveCalculation = 0;\n  for (let i = 0; i < 100000; i++) {\n    expensiveCalculation += Math.random();\n  }\n\n  return (\n    <Card className=\"border-red-200 bg-red-50\">\n      <CardHeader>\n        <CardTitle className=\"text-red-700\">\n          低效组件 <Badge variant=\"destructive\">未优化</Badge>\n        </CardTitle>\n        <CardDescription>\n          这个组件故意设计得低效，会在每次渲染时执行昂贵计算\n        </CardDescription>\n      </CardHeader>\n      <CardContent>\n        <div className=\"space-y-2\">\n          <p>计数: {count}</p>\n          <p>时间戳: {expensiveObject.timestamp}</p>\n          <p>随机数: {expensiveObject.random.toFixed(4)}</p>\n          <p>昂贵计算结果: {expensiveCalculation.toFixed(2)}</p>\n          <div className=\"text-sm text-red-600\">\n            ⚠️ 每次渲染都会重新计算所有值\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n\n/**\n * 优化的组件 - 用于演示 React Scan 检测优化渲染\n */\nexport function OptimizedComponent({ count }: { count: number }) {\n  // 使用 useMemo 缓存昂贵计算\n  const expensiveCalculation = useMemo(() => {\n    let result = 0;\n    for (\n      let i = 0;\n      i < 100000;\n      i++\n    ) {\n      result += Math.random();\n    }\n    return result;\n  }, [count]); // 只有当 count 改变时才重新计算\n\n  // 使用 useMemo 缓存对象创建\n  const cachedObject = useMemo(\n    () => ({\n      timestamp: Date.now(),\n      random: Math.random(),\n      count,\n    }),\n    [count],\n  );\n\n  return (\n    <Card className=\"border-green-200 bg-green-50\">\n      <CardHeader>\n        <CardTitle className=\"text-green-700\">\n          优化组件 <Badge variant=\"default\" className=\"bg-green-600\">已优化</Badge>\n        </CardTitle>\n        <CardDescription>\n          这个组件使用了 useMemo 来优化性能，避免不必要的重新计算\n        </CardDescription>\n      </CardHeader>\n      <CardContent>\n        <div className=\"space-y-2\">\n          <p>计数: {count}</p>\n          <p>时间戳: {cachedObject.timestamp}</p>\n          <p>随机数: {cachedObject.random.toFixed(4)}</p>\n          <p>昂贵计算结果: {expensiveCalculation.toFixed(2)}</p>\n          <div className=\"text-sm text-green-600\">\n            ✅ 使用 useMemo 缓存计算结果\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n\n/**\n * 演示组件容器\n */\nexport function DemoComponentsContainer({ \n  count, \n  onTriggerRender \n}: { \n  count: number; \n  onTriggerRender: () => void;\n}) {\n  const [showComponents, setShowComponents] = useState(true);\n\n  const toggleComponents = useCallback(() => {\n    setShowComponents(prev => !prev);\n  }, []);\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex gap-4\">\n        <Button onClick={onTriggerRender} variant=\"outline\">\n          触发重新渲染\n        </Button>\n        <Button onClick={toggleComponents} variant=\"outline\">\n          {showComponents ? '隐藏' : '显示'}组件\n        </Button>\n      </div>\n\n      {showComponents && (\n        <div className=\"grid gap-6 md:grid-cols-2\">\n          <IneffientComponent count={count} />\n          <OptimizedComponent count={count} />\n        </div>\n      )}\n    </div>\n  );\n}\n\n/**\n * 性能测试组件\n */\nexport function PerformanceTestComponent({ iterations = 1000 }: { iterations?: number }) {\n  const [isRunning, setIsRunning] = useState(false);\n  const [results, setResults] = useState<{ inefficient: number; optimized: number } | null>(null);\n\n  const runPerformanceTest = useCallback(async () => {\n    setIsRunning(true);\n    setResults(null);\n\n    // 测试低效组件\n    const inefficientStart = performance.now();\n    for (let i = 0; i < iterations; i++) {\n      // 模拟低效组件的计算\n      let result = 0;\n      for (let j = 0; j < 1000; j++) {\n        result += Math.random();\n      }\n    }\n    const inefficientTime = performance.now() - inefficientStart;\n\n    // 测试优化组件（模拟缓存）\n    const optimizedStart = performance.now();\n    let cachedResult = 0;\n    for (let j = 0; j < 1000; j++) {\n      cachedResult += Math.random();\n    }\n    for (let i = 0; i < iterations; i++) {\n      // 模拟使用缓存的结果\n      const result = cachedResult;\n    }\n    const optimizedTime = performance.now() - optimizedStart;\n\n    setResults({\n      inefficient: inefficientTime,\n      optimized: optimizedTime,\n    });\n    setIsRunning(false);\n  }, [iterations]);\n\n  return (\n    <Card>\n      <CardHeader>\n        <CardTitle>性能测试</CardTitle>\n        <CardDescription>\n          比较优化和未优化组件的性能差异\n        </CardDescription>\n      </CardHeader>\n      <CardContent>\n        <div className=\"space-y-4\">\n          <Button \n            onClick={runPerformanceTest} \n            disabled={isRunning}\n            className=\"w-full\"\n          >\n            {isRunning ? '测试中...' : `运行性能测试 (${iterations} 次迭代)`}\n          </Button>\n\n          {results && (\n            <div className=\"grid gap-4 md:grid-cols-2\">\n              <div className=\"rounded-lg border border-red-200 bg-red-50 p-4\">\n                <h4 className=\"font-semibold text-red-700\">未优化组件</h4>\n                <p className=\"text-2xl font-bold text-red-600\">\n                  {results.inefficient.toFixed(2)}ms\n                </p>\n              </div>\n              <div className=\"rounded-lg border border-green-200 bg-green-50 p-4\">\n                <h4 className=\"font-semibold text-green-700\">优化组件</h4>\n                <p className=\"text-2xl font-bold text-green-600\">\n                  {results.optimized.toFixed(2)}ms\n                </p>\n              </div>\n            </div>\n          )}\n\n          {results && (\n            <div className=\"text-center\">\n              <p className=\"text-sm text-muted-foreground\">\n                性能提升: {((results.inefficient - results.optimized) / results.inefficient * 100).toFixed(1)}%\n              </p>\n            </div>\n          )}\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/react-scan-demo/react-scan-demo-client.tsx","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":1,"message":"Do not use \"@ts-nocheck\" because it alters compilation errors.","line":1,"column":1,"nodeType":"Line","messageId":"tsDirectiveComment","endLine":1,"endColumn":42}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// @ts-nocheck - 开发工具豁免：仅开发环境使用，不影响生产代码质量\n'use client';\n\nimport { useCallback, useState } from 'react';\nimport { ReactScanAnalyzer } from '@/components/dev-tools/react-scan-analyzer';\nimport { Button } from '@/components/ui/button';\nimport {\n  Card,\n  CardContent,\n  CardDescription,\n  CardHeader,\n  CardTitle,\n} from '@/components/ui/card';\nimport { DemoComponentsContainer, PerformanceTestComponent } from './react-scan-components';\nimport { ReactScanControlPanel, ReactScanInstructions } from './react-scan-stats';\n\n/**\n * React Scan 演示客户端组件\n * \n * 这个组件展示了如何使用 React Scan 来检测和优化 React 应用的性能。\n * 包含了低效组件和优化组件的对比演示，以及实时的性能统计数据。\n */\nexport function ReactScanDemoClient() {\n  const [count, setCount] = useState(0);\n  const [triggerRender, setTriggerRender] = useState(0);\n\n  // 故意触发不必要渲染的函数\n  const triggerUnnecessaryRender = useCallback(() => {\n    setTriggerRender(prev => prev + 1);\n  }, []);\n\n  // 增加计数器\n  const incrementCount = useCallback(() => {\n    setCount(prev => prev + 1);\n  }, []);\n\n  // 重置所有状态\n  const resetAll = useCallback(() => {\n    setCount(0);\n    setTriggerRender(0);\n  }, []);\n\n  return (\n    <div className=\"container mx-auto space-y-8 p-6\">\n      {/* 页面标题 */}\n      <div className=\"text-center\">\n        <h1 className=\"text-3xl font-bold\">React Scan 性能演示</h1>\n        <p className=\"mt-2 text-muted-foreground\">\n          使用 React Scan 检测和优化 React 组件的渲染性能\n        </p>\n      </div>\n\n      {/* React Scan 分析器 */}\n      <ReactScanAnalyzer />\n\n      {/* 控制面板 */}\n      <ReactScanControlPanel />\n\n      {/* 主要控制按钮 */}\n      <Card>\n        <CardHeader>\n          <CardTitle>演示控制</CardTitle>\n          <CardDescription>\n            使用这些按钮来触发不同类型的渲染，观察 React Scan 的检测结果\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <div className=\"flex flex-wrap gap-4\">\n            <Button onClick={incrementCount} variant=\"default\">\n              增加计数 ({count})\n            </Button>\n            <Button onClick={triggerUnnecessaryRender} variant=\"outline\">\n              触发不必要渲染 ({triggerRender})\n            </Button>\n            <Button onClick={resetAll} variant=\"secondary\">\n              重置所有\n            </Button>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* 演示组件容器 */}\n      <DemoComponentsContainer \n        count={count} \n        onTriggerRender={triggerUnnecessaryRender}\n      />\n\n      {/* 性能测试组件 */}\n      <PerformanceTestComponent iterations={1000} />\n\n      {/* 使用说明 */}\n      <ReactScanInstructions />\n\n      {/* 开发者信息 */}\n      <Card className=\"border-dashed\">\n        <CardHeader>\n          <CardTitle className=\"text-sm\">开发者信息</CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"space-y-2 text-xs text-muted-foreground\">\n            <p>\n              🔧 这是一个开发工具演示页面，仅在开发环境中使用。\n            </p>\n            <p>\n              📊 React Scan 会实时监控组件渲染，帮助识别性能瓶颈。\n            </p>\n            <p>\n              🎯 红色高亮表示可能的性能问题，绿色表示正常渲染。\n            </p>\n            <p>\n              💡 使用 React.memo、useMemo 和 useCallback 来优化组件性能。\n            </p>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n\n/**\n * 导出默认组件\n */\nexport default ReactScanDemoClient;\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/react-scan-demo/react-scan-demo-components.tsx","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":1,"message":"Do not use \"@ts-nocheck\" because it alters compilation errors.","line":1,"column":1,"nodeType":"Line","messageId":"tsDirectiveComment","endLine":1,"endColumn":42},{"ruleId":"no-undef","severity":2,"message":"'DEV_TOOLS_CONSTANTS' is not defined.","line":49,"column":25,"nodeType":"Identifier","messageId":"undef","endLine":49,"endColumn":44},{"ruleId":"no-undef","severity":2,"message":"'DEV_TOOLS_CONSTANTS' is not defined.","line":95,"column":11,"nodeType":"Identifier","messageId":"undef","endLine":95,"endColumn":30},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useMemo has an unnecessary dependency: 'count'. Either exclude it or remove the dependency array.","line":101,"column":6,"nodeType":"ArrayExpression","endLine":101,"endColumn":13,"suggestions":[{"desc":"Update the dependencies array to be: []","fix":{"range":[2407,2414],"text":"[]"}}]},{"ruleId":"no-undef","severity":2,"message":"'ReactScanStats' is not defined.","line":146,"column":38,"nodeType":"Identifier","messageId":"undef","endLine":146,"endColumn":52}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// @ts-nocheck - 开发工具豁免：仅开发环境使用，不影响生产代码质量\n'use client';\n\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport {\n    Card,\n    CardContent,\n    CardDescription,\n    CardHeader,\n    CardTitle,\n} from '@/components/ui/card';\nimport { REACT_SCAN_CONFIG } from '@/constants/react-scan';\nimport { useCallback, useEffect, useMemo, useState } from 'react';\n\n// React Scan 类型定义\ninterface _ReactScanStats {\n  enabled: boolean;\n  totalRenders: number;\n  componentsTracked: number;\n  lastUpdate: string;\n}\n\ninterface ReactScanWindow extends Window {\n  __REACT_SCAN__?: {\n    ReactScanInternals?: {\n      enabled?: boolean;\n      totalRenders?: number;\n      componentsScanned?: number;\n      lastScanTime?: number;\n    };\n  };\n}\n\n/**\n * 故意设计的低效组件 - 用于演示 React Scan 检测不必要渲染\n */\nexport function IneffientComponent({ count }: { count: number }) {\n  // 故意在每次渲染时创建新对象 - 这会导致不必要的渲染\n  const expensiveObject = {\n    timestamp: Date.now(),\n    random: Math.random(),\n    count,\n  };\n\n  // 故意的昂贵计算 - 每次渲染都会执行\n  const expensiveCalculation = () => {\n    let result = 0;\n    for (let i = 0; i < DEV_TOOLS_CONSTANTS.REACT_SCAN.MAX_RENDERS; i++) {\n      result += Math.random();\n    }\n    return result;\n  };\n\n  const result = expensiveCalculation();\n\n  return (\n    <Card className='border-red-200 bg-red-50'>\n      <CardHeader>\n        <CardTitle className='text-red-700'>低效组件 (故意设计)</CardTitle>\n        <CardDescription>\n          这个组件故意设计得低效，用于演示 React Scan 如何检测性能问题\n        </CardDescription>\n      </CardHeader>\n      <CardContent>\n        <div className='space-y-2'>\n          <p>\n            <strong>计数:</strong> {count}\n          </p>\n          <p>\n            <strong>昂贵计算结果:</strong> {result.toFixed(4)}\n          </p>\n          <p>\n            <strong>时间戳:</strong> {expensiveObject.timestamp}\n          </p>\n          <p>\n            <strong>随机数:</strong> {expensiveObject.random.toFixed(4)}\n          </p>\n          <Badge variant='destructive'>每次渲染都重新计算</Badge>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n\n/**\n * 优化后的组件 - 使用 React 优化技术\n */\nexport function OptimizedComponent({ count }: { count: number }) {\n  // 使用 useMemo 缓存昂贵计算\n  const expensiveCalculation = useMemo(() => {\n    let result = 0;\n    for (\n      let i = 0;\n      i < DEV_TOOLS_CONSTANTS.REACT_SCAN.MAX_RENDERS;\n      i++\n    ) {\n      result += Math.random();\n    }\n    return result;\n  }, [count]); // 只在 count 变化时重新计算\n\n  // 使用 useMemo 缓存对象\n  const optimizedObject = useMemo(\n    () => ({\n      timestamp: Date.now(),\n      random: Math.random(),\n      count,\n    }),\n    [count],\n  );\n\n  return (\n    <Card className='border-green-200 bg-green-50'>\n      <CardHeader>\n        <CardTitle className='text-green-700'>优化组件</CardTitle>\n        <CardDescription>\n          这个组件使用了 React 优化技术，避免不必要的重新计算\n        </CardDescription>\n      </CardHeader>\n      <CardContent>\n        <div className='space-y-2'>\n          <p>\n            <strong>计数:</strong> {count}\n          </p>\n          <p>\n            <strong>缓存计算结果:</strong> {expensiveCalculation.toFixed(4)}\n          </p>\n          <p>\n            <strong>缓存时间戳:</strong> {optimizedObject.timestamp}\n          </p>\n          <p>\n            <strong>缓存随机数:</strong> {optimizedObject.random.toFixed(4)}\n          </p>\n          <Badge variant='secondary'>使用 useMemo 优化</Badge>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n\n/**\n * React Scan 状态显示组件\n */\nexport function ReactScanStats() {\n  const [stats, setStats] = useState<ReactScanStats | null>(null);\n\n  const updateStats = useCallback(() => {\n    if (typeof window !== 'undefined') {\n      try {\n        // 检查多种可能的 React Scan 状态\n        const reactScan = (window as ReactScanWindow).__REACT_SCAN__;\n        const reactScanInternals = reactScan?.ReactScanInternals;\n\n        // 尝试从多个位置获取状态\n        let isEnabled = false;\n        let totalRenders = 0;\n        let componentsTracked = 0;\n\n        if (reactScanInternals) {\n          isEnabled = reactScanInternals.enabled ?? false;\n          totalRenders = reactScanInternals.totalRenders ?? 0;\n\n          // 获取跟踪组件数\n          const fiberRoots = reactScanInternals?.fiberRoots || {};\n          componentsTracked = Object.keys(fiberRoots).length;\n        }\n\n        setStats({\n          enabled: isEnabled,\n          totalRenders,\n          componentsTracked,\n          lastUpdate: new Date().toLocaleTimeString(),\n        });\n      } catch (error) {\n        console.warn('无法获取 React Scan 状态:', error);\n        setStats({\n          enabled: false,\n          totalRenders: 0,\n          componentsTracked: 0,\n          lastUpdate: new Date().toLocaleTimeString(),\n        });\n      }\n    }\n  }, []);\n\n  useEffect(() => {\n    updateStats();\n\n    // 更频繁的轮询以快速响应状态变化\n    const interval = setInterval(\n      updateStats,\n      REACT_SCAN_CONFIG.STATS_UPDATE_INTERVAL,\n    );\n\n    // 监听键盘事件以立即更新状态\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (event.ctrlKey && event.shiftKey && event.key.toLowerCase() === 'x') {\n        // 延迟一点更新以确保 React Scan 状态已经改变\n        setTimeout(updateStats, 100);\n      }\n    };\n\n    window.addEventListener('keydown', handleKeyDown);\n\n    return () => {\n      clearInterval(interval);\n      window.removeEventListener('keydown', handleKeyDown);\n    };\n  }, [updateStats]);\n\n  if (!stats) {\n    return (\n      <Card>\n        <CardHeader>\n          <CardTitle>React Scan 状态</CardTitle>\n        </CardHeader>\n        <CardContent>\n          <p>正在加载状态...</p>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  return (\n    <Card>\n      <CardHeader>\n        <CardTitle className='flex items-center gap-2'>\n          React Scan 状态\n          <Badge variant={stats.enabled ? 'default' : 'secondary'}>\n            {stats.enabled ? '已启用' : '已禁用'}\n          </Badge>\n        </CardTitle>\n        <CardDescription>\n          实时显示 React Scan 的运行状态和统计信息\n        </CardDescription>\n      </CardHeader>\n      <CardContent>\n        <div className='grid grid-cols-2 gap-4'>\n          <div>\n            <p className='text-sm font-medium'>总渲染次数</p>\n            <p className='text-2xl font-bold'>{stats.totalRenders}</p>\n          </div>\n          <div>\n            <p className='text-sm font-medium'>跟踪组件数</p>\n            <p className='text-2xl font-bold'>{stats.componentsTracked}</p>\n          </div>\n        </div>\n        <div className='mt-4 pt-4 border-_t'>\n          <p className='text-xs text-muted-foreground'>\n            最后更新: {stats.lastUpdate}\n          </p>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n\ninterface ControlPanelProps {\n  count: number;\n  onIncrement: () => void;\n  onTriggerRender: () => void;\n}\n\nexport function ControlPanel({ count, onIncrement, onTriggerRender }: ControlPanelProps) {\n  return (\n    <Card>\n      <CardHeader>\n        <CardTitle>控制面板</CardTitle>\n        <CardDescription>\n          使用这些按钮来触发组件重新渲染，观察 React Scan 的检测效果\n        </CardDescription>\n      </CardHeader>\n      <CardContent>\n        <div className='flex flex-col sm:flex-row gap-4'>\n          <Button _onClick={onIncrement} className='flex-1'>\n            增加计数 ({count})\n          </Button>\n          <Button _onClick={onTriggerRender} variant='outline' className='flex-1'>\n            触发不必要渲染\n          </Button>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/react-scan-demo/react-scan-stats.tsx","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":1,"message":"Do not use \"@ts-nocheck\" because it alters compilation errors.","line":1,"column":1,"nodeType":"Line","messageId":"tsDirectiveComment","endLine":1,"endColumn":42}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// @ts-nocheck - 开发工具豁免：仅开发环境使用，不影响生产代码质量\n'use client';\n\nimport { useCallback, useEffect, useState } from 'react';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport {\n  Card,\n  CardContent,\n  CardDescription,\n  CardHeader,\n  CardTitle,\n} from '@/components/ui/card';\nimport { REACT_SCAN_CONFIG } from '@/constants/react-scan';\nimport type { ReactScanStats, ReactScanWindow } from './react-scan-types';\n\n/**\n * React Scan 性能数据显示组件\n */\nexport function ReactScanStatsComponent() {\n  const [stats, setStats] = useState<ReactScanStats | null>(null);\n\n  const updateStats = useCallback(() => {\n    if (typeof window !== 'undefined') {\n      try {\n        const reactScanWindow = window as ReactScanWindow;\n        const reactScanData = reactScanWindow.__REACT_SCAN__?.ReactScanInternals;\n\n        if (reactScanData) {\n          setStats({\n            enabled: reactScanData.enabled || false,\n            totalRenders: reactScanData.totalRenders || 0,\n            componentsTracked: reactScanData.componentsScanned || 0,\n            lastUpdate: new Date().toLocaleTimeString(),\n          });\n        } else {\n          setStats({\n            enabled: false,\n            totalRenders: 0,\n            componentsTracked: 0,\n            lastUpdate: new Date().toLocaleTimeString(),\n          });\n        }\n      } catch (error) {\n        console.warn('Failed to get React Scan stats:', error);\n        setStats({\n          enabled: false,\n          totalRenders: 0,\n          componentsTracked: 0,\n          lastUpdate: new Date().toLocaleTimeString(),\n        });\n      }\n    }\n  }, []);\n\n  useEffect(() => {\n    updateStats();\n    const interval = setInterval(updateStats, 1000);\n    return () => clearInterval(interval);\n  }, [updateStats]);\n\n  const toggleReactScan = useCallback(() => {\n    if (typeof window !== 'undefined') {\n      try {\n        const reactScanWindow = window as ReactScanWindow;\n        if (reactScanWindow.__REACT_SCAN__?.ReactScanInternals) {\n          const currentState = reactScanWindow.__REACT_SCAN__.ReactScanInternals.enabled;\n          reactScanWindow.__REACT_SCAN__.ReactScanInternals.enabled = !currentState;\n          updateStats();\n        }\n      } catch (error) {\n        console.warn('Failed to toggle React Scan:', error);\n      }\n    }\n  }, [updateStats]);\n\n  const resetStats = useCallback(() => {\n    if (typeof window !== 'undefined') {\n      try {\n        const reactScanWindow = window as ReactScanWindow;\n        if (reactScanWindow.__REACT_SCAN__?.ReactScanInternals) {\n          reactScanWindow.__REACT_SCAN__.ReactScanInternals.totalRenders = 0;\n          reactScanWindow.__REACT_SCAN__.ReactScanInternals.componentsScanned = 0;\n          updateStats();\n        }\n      } catch (error) {\n        console.warn('Failed to reset React Scan stats:', error);\n      }\n    }\n  }, [updateStats]);\n\n  if (!stats) {\n    return (\n      <Card>\n        <CardHeader>\n          <CardTitle>React Scan 统计</CardTitle>\n          <CardDescription>加载中...</CardDescription>\n        </CardHeader>\n      </Card>\n    );\n  }\n\n  return (\n    <Card>\n      <CardHeader>\n        <CardTitle className=\"flex items-center justify-between\">\n          React Scan 统计\n          <Badge variant={stats.enabled ? 'default' : 'secondary'}>\n            {stats.enabled ? '已启用' : '已禁用'}\n          </Badge>\n        </CardTitle>\n        <CardDescription>\n          实时监控 React 组件渲染性能\n        </CardDescription>\n      </CardHeader>\n      <CardContent>\n        <div className=\"space-y-4\">\n          <div className=\"grid gap-4 md:grid-cols-3\">\n            <div className=\"rounded-lg border p-4 text-center\">\n              <div className=\"text-2xl font-bold text-blue-600\">\n                {stats.totalRenders}\n              </div>\n              <div className=\"text-sm text-muted-foreground\">总渲染次数</div>\n            </div>\n            <div className=\"rounded-lg border p-4 text-center\">\n              <div className=\"text-2xl font-bold text-green-600\">\n                {stats.componentsTracked}\n              </div>\n              <div className=\"text-sm text-muted-foreground\">跟踪组件数</div>\n            </div>\n            <div className=\"rounded-lg border p-4 text-center\">\n              <div className=\"text-sm font-medium text-purple-600\">\n                {stats.lastUpdate}\n              </div>\n              <div className=\"text-sm text-muted-foreground\">最后更新</div>\n            </div>\n          </div>\n\n          <div className=\"flex gap-2\">\n            <Button onClick={toggleReactScan} variant=\"outline\" size=\"sm\">\n              {stats.enabled ? '禁用' : '启用'} React Scan\n            </Button>\n            <Button onClick={resetStats} variant=\"outline\" size=\"sm\">\n              重置统计\n            </Button>\n            <Button onClick={updateStats} variant=\"outline\" size=\"sm\">\n              刷新数据\n            </Button>\n          </div>\n\n          <div className=\"rounded-lg bg-muted p-4\">\n            <h4 className=\"mb-2 font-semibold\">配置信息</h4>\n            <div className=\"space-y-1 text-sm\">\n              <div>启用状态: {REACT_SCAN_CONFIG.enabled ? '是' : '否'}</div>\n              <div>显示覆盖层: {REACT_SCAN_CONFIG.showOverlay ? '是' : '否'}</div>\n              <div>跟踪渲染: {REACT_SCAN_CONFIG.trackRenders ? '是' : '否'}</div>\n              <div>控制台日志: {REACT_SCAN_CONFIG.logToConsole ? '是' : '否'}</div>\n            </div>\n          </div>\n\n          <div className=\"text-xs text-muted-foreground\">\n            <p>\n              💡 提示: React Scan 会高亮显示不必要的重新渲染。\n              红色表示可能的性能问题，绿色表示正常渲染。\n            </p>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n\n/**\n * React Scan 控制面板\n */\nexport function ReactScanControlPanel() {\n  const [isVisible, setIsVisible] = useState(true);\n  const [autoRefresh, setAutoRefresh] = useState(true);\n\n  const toggleVisibility = useCallback(() => {\n    setIsVisible(prev => !prev);\n  }, []);\n\n  const toggleAutoRefresh = useCallback(() => {\n    setAutoRefresh(prev => !prev);\n  }, []);\n\n  return (\n    <div className=\"space-y-4\">\n      <div className=\"flex items-center justify-between\">\n        <h3 className=\"text-lg font-semibold\">React Scan 控制面板</h3>\n        <div className=\"flex gap-2\">\n          <Button onClick={toggleAutoRefresh} variant=\"outline\" size=\"sm\">\n            自动刷新: {autoRefresh ? '开' : '关'}\n          </Button>\n          <Button onClick={toggleVisibility} variant=\"outline\" size=\"sm\">\n            {isVisible ? '隐藏' : '显示'}统计\n          </Button>\n        </div>\n      </div>\n\n      {isVisible && <ReactScanStatsComponent />}\n    </div>\n  );\n}\n\n/**\n * React Scan 使用说明组件\n */\nexport function ReactScanInstructions() {\n  return (\n    <Card>\n      <CardHeader>\n        <CardTitle>React Scan 使用说明</CardTitle>\n        <CardDescription>\n          了解如何使用 React Scan 来优化 React 应用性能\n        </CardDescription>\n      </CardHeader>\n      <CardContent>\n        <div className=\"space-y-4\">\n          <div>\n            <h4 className=\"font-semibold mb-2\">什么是 React Scan？</h4>\n            <p className=\"text-sm text-muted-foreground\">\n              React Scan 是一个开发工具，用于检测和可视化 React 组件的不必要重新渲染。\n              它可以帮助开发者识别性能瓶颈并优化应用性能。\n            </p>\n          </div>\n\n          <div>\n            <h4 className=\"font-semibold mb-2\">如何使用？</h4>\n            <ul className=\"space-y-1 text-sm text-muted-foreground\">\n              <li>• 启用 React Scan 后，它会自动检测组件渲染</li>\n              <li>• 红色高亮表示可能的不必要渲染</li>\n              <li>• 绿色高亮表示正常的渲染</li>\n              <li>• 查看统计数据了解应用的渲染性能</li>\n            </ul>\n          </div>\n\n          <div>\n            <h4 className=\"font-semibold mb-2\">优化建议</h4>\n            <ul className=\"space-y-1 text-sm text-muted-foreground\">\n              <li>• 使用 React.memo 包装纯组件</li>\n              <li>• 使用 useMemo 缓存昂贵的计算</li>\n              <li>• 使用 useCallback 缓存函数引用</li>\n              <li>• 避免在渲染过程中创建新对象</li>\n            </ul>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/react-scan-demo/react-scan-types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/test-footer/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/ui-showcase/__tests__/page.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/[locale]/ui-showcase/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/api/analytics/i18n/__tests__/route.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/api/analytics/i18n/route.ts","messages":[{"ruleId":"no-underscore-dangle","severity":2,"message":"Unexpected dangling '_' in '_error'.","line":70,"column":5,"nodeType":"MemberExpression","messageId":"unexpectedUnderscore","endLine":70,"endColumn":18},{"ruleId":"no-underscore-dangle","severity":2,"message":"Unexpected dangling '_' in '_error'.","line":152,"column":5,"nodeType":"MemberExpression","messageId":"unexpectedUnderscore","endLine":152,"endColumn":18},{"ruleId":"no-underscore-dangle","severity":2,"message":"Unexpected dangling '_' in '_error'.","line":204,"column":5,"nodeType":"MemberExpression","messageId":"unexpectedUnderscore","endLine":204,"endColumn":18}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from 'next/server';\nimport { logger } from '@/lib/logger';\n\n/**\n * i18n分析数据类型定义\n */\ninterface I18nAnalyticsData {\n  locale: string;\n  event: string;\n  timestamp: number;\n  [key: string]: unknown;\n}\n\n/**\n * 验证i18n分析数据格式\n */\nfunction validateI18nAnalyticsData(data: unknown): data is I18nAnalyticsData {\n  if (!data || typeof data !== 'object') {\n    return false;\n  }\n\n  const record = data as Record<string, unknown>;\n  const requiredFields = ['locale', 'event', 'timestamp'];\n  return requiredFields.every((field) => field in record);\n}\n\n/**\n * POST /api/analytics/i18n\n * 收集国际化相关的分析数据\n */\nexport async function POST(request: NextRequest) {\n  try {\n    const body = await request.json();\n\n    // 验证请求数据\n    if (!validateI18nAnalyticsData(body)) {\n      return NextResponse.json(\n        {\n          success: false,\n          _error: 'Invalid i18n analytics data format',\n          message:\n            'The provided data does not match the expected i18n analytics format',\n        },\n        { status: 400 },\n      );\n    }\n\n    // 记录i18n分析数据\n    logger.info('i18n analytics data received', {\n      locale: body.locale,\n      event: body.event,\n      timestamp: body.timestamp,\n      metadata: body.metadata || {},\n    });\n\n    // 在实际应用中，这里会将数据存储到数据库或发送到分析服务\n    // 目前只是记录日志\n\n    return NextResponse.json({\n      success: true,\n      message: 'i18n analytics data recorded successfully',\n      data: {\n        locale: body.locale,\n        event: body.event,\n        timestamp: body.timestamp,\n      },\n    });\n  } catch (_error) {\n    // 忽略错误变量\n    logger._error('Failed to process i18n analytics data', {\n      _error: _error instanceof Error ? _error.message : String(_error),\n      stack: _error instanceof Error ? _error.stack : undefined,\n    });\n\n    return NextResponse.json(\n      {\n        success: false,\n        _error: 'Internal server _error',\n        message: 'Failed to process i18n analytics data',\n      },\n      { status: 500 },\n    );\n  }\n}\n\n/**\n * GET /api/analytics/i18n\n * 获取i18n分析统计信息\n */\nexport function GET(request: NextRequest) {\n  try {\n    const { searchParams } = new URL(request.url);\n    const locale = searchParams.get('locale');\n    const timeRange = searchParams.get('timeRange') || '24h';\n\n    // 模拟统计数据（在实际应用中会从数据库查询）\n    const mockStats = {\n      timeRange,\n      locale: locale || 'all',\n      events: {\n        localeSwitch: {\n          count: 150,\n          topTargetLocales: ['en', 'zh', 'ja'],\n        },\n        translationMissing: {\n          count: 12,\n          topMissingKeys: ['common.newFeature', '_error.validation'],\n        },\n        translationLoad: {\n          count: 1250,\n          averageLoadTime: 45,\n          p95LoadTime: 120,\n        },\n      },\n      localeDistribution: {\n        en: 0.65,\n        zh: 0.25,\n        ja: 0.08,\n        other: 0.02,\n      },\n      summary: {\n        totalEvents: 1412,\n        uniqueUsers: 890,\n        translationCoverage: 0.94,\n        averageSessionLocales: 1.2,\n      },\n    };\n\n    // 如果指定了特定语言，过滤数据\n    if (locale && locale !== 'all') {\n      return NextResponse.json({\n        success: true,\n        data: {\n          ...mockStats,\n          locale,\n          localeDistribution: {\n            [locale]:\n              mockStats.localeDistribution[\n                locale as keyof typeof mockStats.localeDistribution\n              ] || 0,\n          },\n        },\n      });\n    }\n\n    return NextResponse.json({\n      success: true,\n      data: mockStats,\n    });\n  } catch (_error) {\n    // 忽略错误变量\n    logger._error('Failed to get i18n analytics statistics', {\n      _error: _error instanceof Error ? _error.message : String(_error),\n      stack: _error instanceof Error ? _error.stack : undefined,\n    });\n\n    return NextResponse.json(\n      {\n        success: false,\n        _error: 'Internal server _error',\n        message: 'Failed to retrieve i18n analytics statistics',\n      },\n      { status: 500 },\n    );\n  }\n}\n\n/**\n * DELETE /api/analytics/i18n\n * 删除i18n分析数据（管理功能）\n */\nexport function DELETE(request: NextRequest) {\n  try {\n    const { searchParams } = new URL(request.url);\n    const locale = searchParams.get('locale');\n    const timeRange = searchParams.get('timeRange');\n    const confirm = searchParams.get('confirm');\n\n    if (confirm !== 'true') {\n      return NextResponse.json(\n        {\n          success: false,\n          _error: 'Confirmation required',\n          message: 'Please add confirm=true parameter to confirm deletion',\n        },\n        { status: 400 },\n      );\n    }\n\n    // 在实际应用中，这里会删除指定的i18n分析数据\n    logger.info('i18n analytics data deletion requested', {\n      locale: locale || 'all',\n      timeRange: timeRange || 'all',\n      timestamp: Date.now(),\n    });\n\n    return NextResponse.json({\n      success: true,\n      message: `i18n analytics data deleted for locale: ${locale || 'all'}, time range: ${timeRange || 'all'}`,\n      deletedAt: new Date().toISOString(),\n    });\n  } catch (_error) {\n    // 忽略错误变量\n    logger._error('Failed to delete i18n analytics data', {\n      _error: _error instanceof Error ? _error.message : String(_error),\n      stack: _error instanceof Error ? _error.stack : undefined,\n    });\n\n    return NextResponse.json(\n      {\n        success: false,\n        _error: 'Internal server _error',\n        message: 'Failed to delete i18n analytics data',\n      },\n      { status: 500 },\n    );\n  }\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/api/analytics/web-vitals/route.ts","messages":[{"ruleId":"no-underscore-dangle","severity":2,"message":"Unexpected dangling '_' in '_error'.","line":79,"column":5,"nodeType":"MemberExpression","messageId":"unexpectedUnderscore","endLine":79,"endColumn":18},{"ruleId":"no-underscore-dangle","severity":2,"message":"Unexpected dangling '_' in '_error'.","line":168,"column":5,"nodeType":"MemberExpression","messageId":"unexpectedUnderscore","endLine":168,"endColumn":18},{"ruleId":"no-underscore-dangle","severity":2,"message":"Unexpected dangling '_' in '_error'.","line":215,"column":5,"nodeType":"MemberExpression","messageId":"unexpectedUnderscore","endLine":215,"endColumn":18}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from 'next/server';\nimport { logger } from '@/lib/logger';\n\n// Web Vitals 数据接口\ninterface WebVitalsData {\n  name: string;\n  value: number;\n  rating: 'good' | 'needs-improvement' | 'poor';\n  delta: number;\n  id: string;\n  navigationType: string;\n  url: string;\n  userAgent: string;\n  timestamp: number;\n}\n\n// 验证 Web Vitals 数据\nfunction validateWebVitalsData(data: unknown): data is WebVitalsData {\n  if (typeof data !== 'object' || data === null) {\n    return false;\n  }\n\n  const obj = data as Record<string, unknown>;\n  return (\n    typeof obj.name === 'string' &&\n    typeof obj.value === 'number' &&\n    ['good', 'needs-improvement', 'poor'].includes(obj.rating as string) &&\n    typeof obj.delta === 'number' &&\n    typeof obj.id === 'string' &&\n    typeof obj.navigationType === 'string' &&\n    typeof obj.url === 'string' &&\n    typeof obj.userAgent === 'string' &&\n    typeof obj.timestamp === 'number'\n  );\n}\n\n// 处理 Web Vitals 数据收集\nexport async function POST(request: NextRequest) {\n  try {\n    const body = await request.json();\n\n    // 验证请求数据\n    if (!validateWebVitalsData(body)) {\n      return NextResponse.json(\n        {\n          success: false,\n          _error: 'Invalid web vitals data format',\n          message:\n            'The provided data does not match the expected Web Vitals format',\n        },\n        { status: 400 },\n      );\n    }\n\n    // 记录 Web Vitals 数据\n    logger.info('Web Vitals data received', {\n      metric: body.name,\n      value: body.value,\n      rating: body.rating,\n      url: body.url,\n      timestamp: body.timestamp,\n    });\n\n    // 在实际应用中，这里会将数据存储到数据库或发送到分析服务\n    // 目前只是记录日志\n\n    return NextResponse.json({\n      success: true,\n      message: 'Web Vitals data recorded successfully',\n      data: {\n        metric: body.name,\n        value: body.value,\n        rating: body.rating,\n        timestamp: body.timestamp,\n      },\n    });\n  } catch (_error) {\n    // 忽略错误变量\n    logger._error('Failed to process Web Vitals data', {\n      _error: _error instanceof Error ? _error.message : String(_error),\n      stack: _error instanceof Error ? _error.stack : undefined,\n    });\n\n    return NextResponse.json(\n      {\n        success: false,\n        _error: 'Internal server _error',\n        message: 'Failed to process Web Vitals data',\n      },\n      { status: 500 },\n    );\n  }\n}\n\n// 获取 Web Vitals 统计信息\nexport function GET(request: NextRequest) {\n  try {\n    const { searchParams } = new URL(request.url);\n    const timeRange = searchParams.get('timeRange') || '24h';\n    const metric = searchParams.get('metric');\n\n    // 模拟统计数据（在实际应用中会从数据库查询）\n    const mockStats = {\n      timeRange,\n      metrics: {\n        CLS: {\n          average: 0.05,\n          p75: 0.08,\n          p90: 0.12,\n          samples: 1250,\n          rating: 'good' as const,\n        },\n        FID: {\n          average: 45,\n          p75: 65,\n          p90: 85,\n          samples: 1180,\n          rating: 'good' as const,\n        },\n        LCP: {\n          average: 1800,\n          p75: 2200,\n          p90: 2800,\n          samples: 1300,\n          rating: 'good' as const,\n        },\n        FCP: {\n          average: 1200,\n          p75: 1500,\n          p90: 1900,\n          samples: 1300,\n          rating: 'good' as const,\n        },\n        TTFB: {\n          average: 200,\n          p75: 300,\n          p90: 450,\n          samples: 1300,\n          rating: 'good' as const,\n        },\n      },\n      summary: {\n        totalSamples: 1300,\n        goodRating: 0.85,\n        needsImprovementRating: 0.12,\n        poorRating: 0.03,\n      },\n    };\n\n    // 如果指定了特定指标，只返回该指标的数据\n    if (metric && mockStats.metrics[metric as keyof typeof mockStats.metrics]) {\n      return NextResponse.json({\n        success: true,\n        data: {\n          timeRange,\n          metric,\n          stats: mockStats.metrics[metric as keyof typeof mockStats.metrics],\n        },\n      });\n    }\n\n    return NextResponse.json({\n      success: true,\n      data: mockStats,\n    });\n  } catch (_error) {\n    // 忽略错误变量\n    logger._error('Failed to get Web Vitals statistics', {\n      _error: _error instanceof Error ? _error.message : String(_error),\n      stack: _error instanceof Error ? _error.stack : undefined,\n    });\n\n    return NextResponse.json(\n      {\n        success: false,\n        _error: 'Internal server _error',\n        message: 'Failed to retrieve Web Vitals statistics',\n      },\n      { status: 500 },\n    );\n  }\n}\n\n// 删除 Web Vitals 数据（管理功能）\nexport function DELETE(request: NextRequest) {\n  try {\n    const { searchParams } = new URL(request.url);\n    const timeRange = searchParams.get('timeRange');\n    const confirm = searchParams.get('confirm');\n\n    if (confirm !== 'true') {\n      return NextResponse.json(\n        {\n          success: false,\n          _error: 'Confirmation required',\n          message: 'Please add confirm=true parameter to confirm deletion',\n        },\n        { status: 400 },\n      );\n    }\n\n    // 在实际应用中，这里会删除指定时间范围的数据\n    logger.info('Web Vitals data deletion requested', {\n      timeRange: timeRange || 'all',\n      timestamp: Date.now(),\n    });\n\n    return NextResponse.json({\n      success: true,\n      message: `Web Vitals data deleted for time range: ${timeRange || 'all'}`,\n      deletedAt: new Date().toISOString(),\n    });\n  } catch (_error) {\n    // 忽略错误变量\n    logger._error('Failed to delete Web Vitals data', {\n      _error: _error instanceof Error ? _error.message : String(_error),\n      stack: _error instanceof Error ? _error.stack : undefined,\n    });\n\n    return NextResponse.json(\n      {\n        success: false,\n        _error: 'Internal server _error',\n        message: 'Failed to delete Web Vitals data',\n      },\n      { status: 500 },\n    );\n  }\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/api/contact/__tests__/route-get.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/api/contact/__tests__/route-post.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/api/contact/__tests__/route.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/api/contact/contact-api-utils.ts","messages":[{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 36.","line":183,"column":54,"nodeType":"Literal","messageId":"noMagic","endLine":183,"endColumn":56},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2.","line":183,"column":68,"nodeType":"Literal","messageId":"noMagic","endLine":183,"endColumn":69},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 9.","line":183,"column":71,"nodeType":"Literal","messageId":"noMagic","endLine":183,"endColumn":72}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 联系表单API工具函数\n * Contact form API utility functions\n */\n\nimport { NextRequest } from 'next/server';\nimport { logger } from '@/lib/logger';\n\n// 常量定义\nexport const RATE_LIMIT_CONFIG = {\n  MAX_REQUESTS: 5,\n  WINDOW_MS: 60000,\n} as const;\n\n/**\n * 速率限制存储\n * Rate limiting storage (in production, use Redis or database)\n */\nconst rateLimitStore = new Map<string, { count: number; resetTime: number }>();\n\n/**\n * 检查速率限制\n * Check rate limiting\n */\nexport function checkRateLimit(\n  ip: string,\n  maxRequests = RATE_LIMIT_CONFIG.MAX_REQUESTS,\n  windowMs = RATE_LIMIT_CONFIG.WINDOW_MS,\n): boolean {\n  const now = Date.now();\n  const key = ip;\n\n  const current = rateLimitStore.get(key);\n\n  if (!current || now > current.resetTime) {\n    rateLimitStore.set(key, { count: 1, resetTime: now + windowMs });\n    return true;\n  }\n\n  if (current.count >= maxRequests) {\n    return false;\n  }\n\n  current.count += 1;\n  rateLimitStore.set(key, current);\n  return true;\n}\n\n/**\n * 验证Turnstile token\n * Verify Turnstile token\n */\nexport async function verifyTurnstile(token: string, ip: string): Promise<boolean> {\n  try {\n    const secretKey = process.env.TURNSTILE_SECRET_KEY;\n\n    if (!secretKey) {\n      logger.warn('Turnstile secret key not configured');\n      return false;\n    }\n\n    const response = await fetch('https://challenges.cloudflare.com/turnstile/v0/siteverify', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/x-www-form-urlencoded',\n      },\n      body: new URLSearchParams({\n        secret: secretKey,\n        response: token,\n        remoteip: ip,\n      }),\n    });\n\n    const result = await response.json();\n\n    if (!result.success) {\n      logger.warn('Turnstile verification failed', {\n        errorCodes: result['error-codes'],\n        ip,\n      });\n      return false;\n    }\n\n    return true;\n  } catch (error) {\n    logger.error('Turnstile verification error', { error, ip });\n    return false;\n  }\n}\n\n/**\n * 获取客户端IP地址\n * Get client IP address\n */\nexport function getClientIP(request: NextRequest): string {\n  const forwarded = request.headers.get('x-forwarded-for');\n  const realIP = request.headers.get('x-real-ip');\n\n  if (forwarded) {\n    return forwarded.split(',')[0]?.trim() || 'unknown';\n  }\n\n  if (realIP) {\n    return realIP;\n  }\n\n  return 'unknown';\n}\n\n/**\n * 清理过期的速率限制记录\n * Clean up expired rate limit records\n */\nexport function cleanupRateLimitStore(): void {\n  const now = Date.now();\n  for (const [key, value] of rateLimitStore.entries()) {\n    if (now > value.resetTime) {\n      rateLimitStore.delete(key);\n    }\n  }\n}\n\n/**\n * 获取速率限制状态\n * Get rate limit status\n */\nexport function getRateLimitStatus(ip: string): {\n  remaining: number;\n  resetTime: number;\n  isLimited: boolean;\n} {\n  const current = rateLimitStore.get(ip);\n  const now = Date.now();\n\n  if (!current || now > current.resetTime) {\n    return {\n      remaining: RATE_LIMIT_CONFIG.MAX_REQUESTS - 1,\n      resetTime: now + RATE_LIMIT_CONFIG.WINDOW_MS,\n      isLimited: false,\n    };\n  }\n\n  const remaining = Math.max(0, RATE_LIMIT_CONFIG.MAX_REQUESTS - current.count);\n  return {\n    remaining,\n    resetTime: current.resetTime,\n    isLimited: remaining === 0,\n  };\n}\n\n/**\n * 验证环境变量配置\n * Validate environment variables\n */\nexport function validateEnvironmentConfig(): {\n  isValid: boolean;\n  missingVars: string[];\n} {\n  const requiredVars = [\n    'TURNSTILE_SECRET_KEY',\n    'RESEND_API_KEY',\n    'AIRTABLE_API_KEY',\n    'AIRTABLE_BASE_ID',\n  ];\n\n  const missingVars = requiredVars.filter(varName => {\n    // 安全的环境变量访问，避免对象注入\n    const envValue = process.env[varName as keyof typeof process.env];\n    return !envValue;\n  });\n\n  return {\n    isValid: missingVars.length === 0,\n    missingVars,\n  };\n}\n\n/**\n * 生成请求ID用于日志追踪\n * Generate request ID for log tracing\n */\nexport function generateRequestId(): string {\n  return `req_${Date.now()}_${Math.random().toString(36).substring(2, 9)}`;\n}\n\n/**\n * 格式化错误响应\n * Format error response\n */\nexport function formatErrorResponse(\n  message: string,\n  statusCode: number,\n  details?: Record<string, unknown>\n): {\n  error: string;\n  message: string;\n  statusCode: number;\n  timestamp: string;\n  details?: Record<string, unknown>;\n} {\n  return {\n    error: 'ContactFormError',\n    message,\n    statusCode,\n    timestamp: new Date().toISOString(),\n    ...(details && { details }),\n  };\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/api/contact/contact-api-validation.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'validationHelpers' is defined but never used. Allowed unused vars must match /^_/u.","line":12,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":20,"suggestions":[{"messageId":"removeVar","data":{"varName":"validationHelpers"},"fix":{"range":[266,287],"text":""},"desc":"Remove unused variable 'validationHelpers'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'validationHelpers' is defined but never used. Allowed unused vars must match /^_/u.","line":12,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":12,"endColumn":20},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 10.","line":60,"column":18,"nodeType":"Literal","messageId":"noMagic","endLine":60,"endColumn":20},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 60.","line":60,"column":23,"nodeType":"Literal","messageId":"noMagic","endLine":60,"endColumn":25},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 7.","line":244,"column":38,"nodeType":"Literal","messageId":"noMagic","endLine":244,"endColumn":39}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 联系表单API验证和数据处理\n * Contact form API validation and data processing\n */\n\nimport { z } from 'zod';\nimport { airtableService } from '@/lib/airtable';\nimport { logger } from '@/lib/logger';\nimport { resendService } from '@/lib/resend';\nimport {\n  contactFormSchema,\n  validationHelpers,\n  type ContactFormData,\n} from '@/lib/validations';\nimport { verifyTurnstile } from './contact-api-utils';\n\n/**\n * 扩展的联系表单模式，包含Turnstile token\n * Extended contact form schema with Turnstile token\n */\nexport const contactFormWithTokenSchema = contactFormSchema.extend({\n  turnstileToken: z.string().min(1, 'Security verification required'),\n  submittedAt: z.string(),\n});\n\nexport type ContactFormWithToken = z.infer<typeof contactFormWithTokenSchema>;\n\n/**\n * 验证表单数据\n * Validate form data\n */\nexport async function validateFormData(body: unknown, clientIP: string) {\n  const validationResult = contactFormWithTokenSchema.safeParse(body);\n\n  if (!validationResult.success) {\n    logger.warn('Form validation failed', {\n      errors: validationResult.error.errors,\n      clientIP,\n    });\n\n    const errorMessages = validationResult.error.errors.map((error) => {\n      const field = error.path.join('.');\n      return `${field}: ${error.message}`;\n    });\n\n    return {\n      success: false,\n      error: 'Validation failed',\n      details: errorMessages,\n      data: null,\n    };\n  }\n\n  const formData = validationResult.data;\n\n  // 验证提交时间（防止重放攻击）\n  const submittedAt = new Date(formData.submittedAt);\n  const now = new Date();\n  const timeDiff = now.getTime() - submittedAt.getTime();\n  const maxAge = 10 * 60 * 1000; // 10分钟\n\n  if (timeDiff > maxAge || timeDiff < 0) {\n    logger.warn('Form submission time validation failed', {\n      submittedAt: formData.submittedAt,\n      timeDiff,\n      clientIP,\n    });\n\n    return {\n      success: false,\n      error: 'Form submission expired or invalid',\n      details: ['Please refresh the page and try again'],\n      data: null,\n    };\n  }\n\n  // 验证Turnstile token\n  const turnstileValid = await verifyTurnstile(formData.turnstileToken, clientIP);\n  if (!turnstileValid) {\n    logger.warn('Turnstile verification failed', { clientIP });\n    return {\n      success: false,\n      error: 'Security verification failed',\n      details: ['Please complete the security check'],\n      data: null,\n    };\n  }\n\n  return {\n    success: true,\n    error: null,\n    details: null,\n    data: formData,\n  };\n}\n\n/**\n * 处理表单提交\n * Process form submission\n */\nexport async function processFormSubmission(\n  formData: ContactFormData & { turnstileToken: string; submittedAt: string },\n) {\n  const emailData = {\n    firstName: formData.firstName,\n    lastName: formData.lastName,\n    email: formData.email,\n    company: formData.company,\n    phone: formData.phone,\n    subject: formData.subject,\n    message: formData.message,\n    submittedAt: formData.submittedAt,\n  };\n\n  // 并行处理邮件发送和数据存储\n  const [emailResult, airtableResult] = await Promise.allSettled([\n    resendService.sendContactFormEmail(emailData),\n    airtableService.createContact({\n      firstName: formData.firstName,\n      lastName: formData.lastName,\n      email: formData.email,\n      company: formData.company || '',\n      phone: formData.phone || '',\n      subject: formData.subject,\n      message: formData.message,\n      acceptPrivacy: true, // 已通过验证，默认为true\n      marketingConsent: false, // 默认值\n      website: '', // 蜜罐字段，默认为空\n    }),\n  ]);\n\n  // 检查结果\n  const emailSuccess = emailResult.status === 'fulfilled';\n  const airtableSuccess = airtableResult.status === 'fulfilled';\n\n  if (!emailSuccess) {\n    logger.error('Email sending failed', {\n      error: emailResult.reason,\n      formData: {\n        email: formData.email,\n        subject: formData.subject,\n      },\n    });\n  }\n\n  if (!airtableSuccess) {\n    logger.error('Airtable record creation failed', {\n      error: airtableResult.reason,\n      formData: {\n        email: formData.email,\n        subject: formData.subject,\n      },\n    });\n  }\n\n  // 提取结果数据\n  const emailMessageId = emailSuccess && emailResult.status === 'fulfilled'\n    ? emailResult.value\n    : null;\n  const airtableRecordId = airtableSuccess && airtableResult.status === 'fulfilled'\n    ? airtableResult.value?.id\n    : null;\n\n  // 至少一个服务成功就认为提交成功\n  if (emailSuccess || airtableSuccess) {\n    logger.info('Contact form submitted successfully', {\n      email: formData.email,\n      subject: formData.subject,\n      emailSuccess,\n      airtableSuccess,\n      emailMessageId,\n      airtableRecordId,\n    });\n\n    return {\n      success: true,\n      emailSent: emailSuccess,\n      recordCreated: airtableSuccess,\n      emailMessageId,\n      airtableRecordId,\n    };\n  }\n\n  // 两个服务都失败\n  logger.error('Contact form submission failed completely', {\n    emailError: emailResult.status === 'rejected' ? emailResult.reason : null,\n    airtableError: airtableResult.status === 'rejected' ? airtableResult.reason : null,\n    formData: {\n      email: formData.email,\n      subject: formData.subject,\n    },\n  });\n\n  throw new Error('Failed to process form submission');\n}\n\n/**\n * 获取联系表单统计信息\n * Get contact form statistics\n */\nexport async function getContactFormStats() {\n  try {\n    if (!airtableService.isReady()) {\n      // 如果服务未配置，返回默认值\n      return {\n        success: true,\n        data: {\n          totalContacts: 0,\n          newContacts: 0,\n          completedContacts: 0,\n          recentContacts: 0,\n        },\n      };\n    }\n\n    const stats = await airtableService.getStatistics();\n\n    return {\n      success: true,\n      data: stats,\n    };\n  } catch (error) {\n    logger.error('Failed to get contact form stats', { error });\n    throw new Error('Failed to retrieve statistics');\n  }\n}\n\n/**\n * 验证管理员权限\n * Validate admin permissions\n */\nexport function validateAdminAccess(authHeader: string | null): boolean {\n  const adminToken = process.env.ADMIN_API_TOKEN;\n\n  if (!adminToken) {\n    logger.warn('Admin API token not configured');\n    return false;\n  }\n\n  if (!authHeader || !authHeader.startsWith('Bearer ')) {\n    return false;\n  }\n\n  const token = authHeader.substring(7); // Remove 'Bearer ' prefix\n  return token === adminToken;\n}\n\n/**\n * 清理和标准化表单数据\n * Clean and normalize form data\n */\nexport function sanitizeFormData(data: ContactFormWithToken): ContactFormWithToken {\n  return {\n    ...data,\n    firstName: data.firstName.trim(),\n    lastName: data.lastName.trim(),\n    email: data.email.toLowerCase().trim(),\n    company: data.company?.trim() || '',\n    phone: data.phone?.trim() || '',\n    subject: data.subject.trim(),\n    message: data.message.trim(),\n  };\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/api/contact/route.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'formatErrorResponse' is defined but never used. Allowed unused vars must match /^_/u.","line":11,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":22,"suggestions":[{"messageId":"removeVar","data":{"varName":"formatErrorResponse"},"fix":{"range":[185,208],"text":""},"desc":"Remove unused variable 'formatErrorResponse'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'formatErrorResponse' is defined but never used. Allowed unused vars must match /^_/u.","line":11,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":11,"endColumn":22},{"ruleId":"no-unused-vars","severity":2,"message":"'generateRequestId' is defined but never used. Allowed unused vars must match /^_/u.","line":12,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":20,"suggestions":[{"messageId":"removeVar","data":{"varName":"generateRequestId"},"fix":{"range":[208,229],"text":""},"desc":"Remove unused variable 'generateRequestId'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'generateRequestId' is defined but never used. Allowed unused vars must match /^_/u.","line":12,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":12,"endColumn":20},{"ruleId":"no-unused-vars","severity":2,"message":"'validateEnvironmentConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":13,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":28,"suggestions":[{"messageId":"removeVar","data":{"varName":"validateEnvironmentConfig"},"fix":{"range":[229,258],"text":""},"desc":"Remove unused variable 'validateEnvironmentConfig'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'validateEnvironmentConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":13,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":13,"endColumn":28},{"ruleId":"no-unused-vars","severity":2,"message":"'sanitizeFormData' is defined but never used. Allowed unused vars must match /^_/u.","line":20,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":19,"suggestions":[{"messageId":"removeVar","data":{"varName":"sanitizeFormData"},"fix":{"range":[388,408],"text":""},"desc":"Remove unused variable 'sanitizeFormData'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'sanitizeFormData' is defined but never used. Allowed unused vars must match /^_/u.","line":20,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":20,"endColumn":19}],"suppressedMessages":[],"errorCount":8,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 联系表单API路由\n * Contact form API routes\n */\n\nimport { NextRequest, NextResponse } from 'next/server';\nimport { logger } from '@/lib/logger';\nimport {\n  checkRateLimit,\n  getClientIP,\n  formatErrorResponse,\n  generateRequestId,\n  validateEnvironmentConfig,\n} from './contact-api-utils';\nimport {\n  validateFormData,\n  processFormSubmission,\n  getContactFormStats,\n  validateAdminAccess,\n  sanitizeFormData,\n} from './contact-api-validation';\n\n\n\n/**\n * POST /api/contact\n * 处理联系表单提交\n * Handle contact form submission\n */\nexport async function POST(request: NextRequest) {\n  const startTime = Date.now();\n  const clientIP = getClientIP(request);\n\n  try {\n    // 检查速率限制\n    if (!checkRateLimit(clientIP)) {\n      logger.warn('Rate limit exceeded', { ip: clientIP });\n      return NextResponse.json(\n        {\n          success: false,\n          error: 'Too many requests. Please try again later.',\n        },\n        { status: 429 },\n      );\n    }\n\n    // 解析请求体\n    const body = await request.json();\n\n    // 验证表单数据\n    const validation = await validateFormData(body, clientIP);\n    if (!validation.success || !validation.data) {\n      return NextResponse.json(validation, { status: 400 });\n    }\n\n    const formData = validation.data;\n\n    // 处理表单提交\n    const submissionResult = await processFormSubmission(formData);\n\n    // 记录成功提交\n    const processingTime = Date.now() - startTime;\n    logger.info('Contact form submitted successfully', {\n      email: formData.email,\n      company: formData.company,\n      ip: clientIP,\n      processingTime,\n      emailSent: submissionResult.emailSent,\n      recordCreated: submissionResult.recordCreated,\n      emailMessageId: submissionResult.emailMessageId,\n      airtableRecordId: submissionResult.airtableRecordId,\n    });\n\n    return NextResponse.json({\n      success: true,\n      message: 'Thank you for your message. We will get back to you soon.',\n      messageId: submissionResult.emailMessageId,\n      recordId: submissionResult.airtableRecordId,\n    });\n  } catch (error) {\n    const processingTime = Date.now() - startTime;\n\n    logger.error('Contact form submission failed', {\n      error: error instanceof Error ? error.message : 'Unknown error',\n      stack: error instanceof Error ? error.stack : undefined,\n      ip: clientIP,\n      processingTime,\n    });\n\n    return NextResponse.json(\n      {\n        success: false,\n        error: 'An unexpected error occurred. Please try again later.',\n      },\n      { status: 500 },\n    );\n  }\n}\n\n/**\n * GET /api/contact\n * 获取联系表单统计信息（仅管理员）\n * Get contact form statistics (admin only)\n */\nexport async function GET(request: NextRequest) {\n  try {\n    // 验证管理员权限\n    const authHeader = request.headers.get('authorization');\n\n    if (!validateAdminAccess(authHeader)) {\n      return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\n    }\n\n    // 获取统计信息\n    const statsResult = await getContactFormStats();\n\n    return NextResponse.json(statsResult);\n  } catch (error) {\n    logger.error('Failed to get contact statistics', {\n      error: error instanceof Error ? error.message : 'Unknown error',\n    });\n\n    return NextResponse.json(\n      { error: 'Failed to get statistics' },\n      { status: 500 },\n    );\n  }\n}\n\n/**\n * OPTIONS /api/contact\n * 处理CORS预检请求\n * Handle CORS preflight requests\n */\nexport function OPTIONS() {\n  return new NextResponse(null, {\n    status: 200,\n    headers: {\n      'Access-Control-Allow-Origin': '*',\n      'Access-Control-Allow-Methods': 'POST, GET, OPTIONS',\n      'Access-Control-Allow-Headers': 'Content-Type, Authorization',\n    },\n  });\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/api/csp-report/__tests__/route-get-options.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/api/csp-report/__tests__/route-post-advanced.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/api/csp-report/__tests__/route-post-core.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/api/csp-report/__tests__/route-post-security.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/api/csp-report/__tests__/route-post.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/api/csp-report/__tests__/route.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/api/csp-report/route.ts","messages":[{"ruleId":"max-statements","severity":2,"message":"Async function 'POST' has too many statements (22). Maximum allowed is 20.","line":11,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":122,"endColumn":2}],"suppressedMessages":[{"ruleId":"no-console","severity":2,"message":"Unexpected console statement.","line":66,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":66,"endColumn":17,"suggestions":[{"fix":{"range":[2137,2244],"text":""},"messageId":"removeConsole","data":{"propertyName":"warn"},"desc":"Remove the console.warn()."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-console","severity":2,"message":"Unexpected console statement.","line":78,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":78,"endColumn":20,"suggestions":[{"fix":{"range":[2575,2633],"text":""},"messageId":"removeConsole","data":{"propertyName":"error"},"desc":"Remove the console.error()."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-console","severity":2,"message":"Unexpected console statement.","line":99,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":99,"endColumn":20,"suggestions":[{"fix":{"range":[3150,3217],"text":""},"messageId":"removeConsole","data":{"propertyName":"error"},"desc":"Remove the console.error()."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-console","severity":2,"message":"Unexpected console statement.","line":115,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":115,"endColumn":18,"suggestions":[{"fix":{"range":[3609,3662],"text":""},"messageId":"removeConsole","data":{"propertyName":"error"},"desc":"Remove the console.error()."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from 'next/server';\nimport type { CSPReport } from '@/config/security';\nimport { env } from '../../../../env.mjs';\n\n/**\n * CSP Report endpoint\n *\n * This endpoint receives Content Security Policy violation reports\n * and logs them for security monitoring and debugging.\n */\nexport async function POST(request: NextRequest) {\n  try {\n    // Only process CSP reports in production or when explicitly enabled\n    if (env.NODE_ENV === 'development' && !env.CSP_REPORT_URI) {\n      return NextResponse.json({ status: 'ignored' }, { status: 200 });\n    }\n\n    const contentType = request.headers.get('content-type');\n\n    // Validate content type\n    if (!contentType || !contentType.includes('application/csp-report')) {\n      return NextResponse.json(\n        { error: 'Invalid content type' },\n        { status: 400 },\n      );\n    }\n\n    // Parse the CSP report\n    const report: CSPReport = await request.json();\n\n    // Validate report structure\n    if (!report['csp-report']) {\n      return NextResponse.json(\n        { error: 'Invalid CSP report format' },\n        { status: 400 },\n      );\n    }\n\n    const cspReport = report['csp-report'];\n\n    // Extract relevant information\n    const violationData = {\n      timestamp: new Date().toISOString(),\n      documentUri: cspReport['document-uri'],\n      referrer: cspReport.referrer,\n      violatedDirective: cspReport['violated-directive'],\n      effectiveDirective: cspReport['effective-directive'],\n      originalPolicy: cspReport['original-policy'],\n      blockedUri: cspReport['blocked-uri'],\n      lineNumber: cspReport['line-number'],\n      columnNumber: cspReport['column-number'],\n      sourceFile: cspReport['source-file'],\n      statusCode: cspReport['status-code'],\n      scriptSample: cspReport['script-sample'],\n      disposition: cspReport.disposition,\n      userAgent: request.headers.get('user-agent'),\n      ip:\n        request.headers.get('x-forwarded-for') ||\n        request.headers.get('x-real-ip') ||\n        'unknown',\n    };\n\n    // Log the violation\n    const JSON_INDENT = 2;\n    // eslint-disable-next-line no-console\n    console.warn(\n      'CSP Violation Report:',\n      JSON.stringify(violationData, null, JSON_INDENT),\n    );\n\n    // In production, you might want to send this to a monitoring service\n    if (env.NODE_ENV === 'production') {\n      // Example: Send to Sentry, DataDog, or other monitoring service\n      // await sendToMonitoringService(violationData);\n\n      // For now, we'll just log it\n      // eslint-disable-next-line no-console\n      console.error('Production CSP Violation:', violationData);\n    }\n\n    // Check for common violation patterns that might indicate attacks\n    const suspiciousPatterns = [\n      'eval',\n      'data:text/html',\n      'vbscript:',\n      'onload',\n      'onerror',\n      'onclick',\n    ];\n\n    const isSuspicious = suspiciousPatterns.some(\n      (pattern) =>\n        cspReport['blocked-uri']?.toLowerCase().includes(pattern) ||\n        cspReport['script-sample']?.toLowerCase().includes(pattern),\n    );\n\n    if (isSuspicious) {\n      // eslint-disable-next-line no-console\n      console.error('SUSPICIOUS CSP VIOLATION DETECTED:', violationData);\n\n      // In production, you might want to trigger additional security measures\n      // such as rate limiting, IP blocking, or alerting\n    }\n\n    // Return success response\n    return NextResponse.json(\n      {\n        status: 'received',\n        timestamp: violationData.timestamp,\n      },\n      { status: 200 },\n    );\n  } catch (error) {\n    // eslint-disable-next-line no-console\n    console.error('Error processing CSP report:', error);\n\n    return NextResponse.json(\n      { error: 'Internal server error' },\n      { status: 500 },\n    );\n  }\n}\n\n/**\n * Handle GET requests (for health checks)\n */\nexport function GET() {\n  return NextResponse.json(\n    {\n      status: 'CSP report endpoint active',\n      timestamp: new Date().toISOString(),\n    },\n    { status: 200 },\n  );\n}\n\n/**\n * Only allow POST and GET methods\n */\nexport function OPTIONS() {\n  return new NextResponse(null, {\n    status: 200,\n    headers: {\n      'Allow': 'POST, GET, OPTIONS',\n      'Access-Control-Allow-Methods': 'POST, GET, OPTIONS',\n      'Access-Control-Allow-Headers': 'Content-Type',\n    },\n  });\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/api/monitoring/dashboard/__tests__/route-advanced.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/api/monitoring/dashboard/__tests__/route-core.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/api/monitoring/dashboard/__tests__/route.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/api/monitoring/dashboard/handlers/delete-handler.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/api/monitoring/dashboard/handlers/get-handler.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/api/monitoring/dashboard/handlers/post-handler.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/api/monitoring/dashboard/handlers/put-handler.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/api/monitoring/dashboard/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/api/monitoring/dashboard/types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/api/subscribe/route.ts","messages":[{"ruleId":"no-underscore-dangle","severity":2,"message":"Unexpected dangling '_' in '_error'.","line":39,"column":5,"nodeType":"MemberExpression","messageId":"unexpectedUnderscore","endLine":39,"endColumn":18}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from 'next/server';\nimport { z } from 'zod';\nimport { logger } from '@/lib/logger';\n\n// 邮件订阅请求验证模式\nconst subscribeSchema = z.object({\n  email: z.string().email('Invalid email address'),\n  pageType: z.enum(['products', 'blog', 'about', 'contact']).optional(),\n});\n\nexport async function POST(request: NextRequest) {\n  try {\n    const body = await request.json();\n    const { email, pageType } = subscribeSchema.parse(body);\n\n    // TODO: 集成实际的邮件服务 (Resend)\n    // 这里可以添加以下功能：\n    // 1. 将邮箱地址保存到数据库\n    // 2. 发送确认邮件\n    // 3. 添加到邮件列表\n\n    // 记录订阅信息\n    logger.info('新的邮件订阅', { email, pageType, timestamp: new Date().toISOString() });\n\n    // 模拟处理延迟\n    await new Promise(resolve => setTimeout(resolve, 500));\n\n    return NextResponse.json(\n      {\n        success: true,\n        message: 'Successfully subscribed to notifications',\n        email\n      },\n      { status: 200 }\n    );\n\n  } catch (_error) {\n    // 忽略错误变量\n    logger._error('邮件订阅错误', {}, _error instanceof Error ? _error : new Error(String(_error)));\n\n    if (_error instanceof z.ZodError) {\n      return NextResponse.json(\n        {\n          success: false,\n          message: 'Invalid email address',\n          errors: _error.issues\n        },\n        { status: 400 }\n      );\n    }\n\n    return NextResponse.json(\n      {\n        success: false,\n        message: 'Internal server _error'\n      },\n      { status: 500 }\n    );\n  }\n}\n\n// 处理 OPTIONS 请求 (CORS)\nexport function OPTIONS() {\n  return new NextResponse(null, {\n    status: 200,\n    headers: {\n      'Access-Control-Allow-Origin': '*',\n      'Access-Control-Allow-Methods': 'POST, OPTIONS',\n      'Access-Control-Allow-Headers': 'Content-Type',\n    },\n  });\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/api/test-content/__tests__/route.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/api/test-content/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/api/verify-turnstile/__tests__/route-core.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/api/verify-turnstile/__tests__/route.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/api/verify-turnstile/route.ts","messages":[{"ruleId":"max-params","severity":2,"message":"Async function 'verifyWithCloudflare' has too many parameters (4). Maximum allowed is 3.","line":68,"column":1,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":68,"endColumn":36}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from 'next/server';\nimport { env } from '../../../../env.mjs';\nimport { logger } from '@/lib/logger';\n\ninterface TurnstileVerificationRequest {\n  token: string;\n  remoteip?: string;\n}\n\ninterface TurnstileVerificationResponse {\n  'success': boolean;\n  'error-codes'?: string[];\n  'challenge_ts'?: string;\n  'hostname'?: string;\n  'action'?: string;\n  'cdata'?: string;\n}\n\n/**\n * 验证 Turnstile 配置\n */\nfunction validateTurnstileConfig() {\n  const secretKey = env.TURNSTILE_SECRET_KEY;\n  if (!secretKey) {\n    return NextResponse.json(\n      {\n        success: false,\n        error: 'Turnstile not configured',\n        message: 'Bot protection is not properly configured on the server',\n      },\n      { status: 500 },\n    );\n  }\n  return secretKey;\n}\n\n/**\n * 验证请求体\n */\nfunction validateRequestBody(body: TurnstileVerificationRequest) {\n  if (!body.token) {\n    return NextResponse.json(\n      {\n        success: false,\n        error: 'Missing token',\n        message: 'Turnstile token is required',\n      },\n      { status: 400 },\n    );\n  }\n  return null;\n}\n\n/**\n * 获取客户端 IP\n */\nfunction getClientIP(request: NextRequest): string {\n  return (\n    request.headers.get('x-forwarded-for') ||\n    request.headers.get('x-real-ip') ||\n    'unknown'\n  );\n}\n\n/**\n * 调用 Cloudflare Turnstile 验证 API\n */\nasync function verifyWithCloudflare(\n  secretKey: string,\n  token: string,\n  clientIP: string,\n  remoteip?: string,\n) {\n  const verificationData = new URLSearchParams({\n    secret: secretKey,\n    response: token,\n    remoteip: remoteip || clientIP,\n  });\n\n  const verificationResponse = await fetch(\n    'https://challenges.cloudflare.com/turnstile/v0/siteverify',\n    {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/x-www-form-urlencoded',\n      },\n      body: verificationData,\n    },\n  );\n\n  if (!verificationResponse.ok) {\n    logger.error('Turnstile verification request failed', {\n      status: verificationResponse.status,\n    });\n    return NextResponse.json(\n      {\n        success: false,\n        error: 'Verification request failed',\n        message: 'Failed to verify with Turnstile service',\n      },\n      { status: 500 },\n    );\n  }\n\n  return verificationResponse.json();\n}\n\n/**\n * 处理验证结果\n */\nfunction handleVerificationResult(\n  result: TurnstileVerificationResponse,\n  clientIP: string,\n) {\n  // Log verification attempt (for monitoring)\n  logger.warn('Turnstile verification', {\n    success: result.success,\n    hostname: result.hostname,\n    challenge_ts: result.challenge_ts,\n    action: result.action,\n    clientIP,\n    timestamp: new Date().toISOString(),\n  });\n\n  if (!result.success) {\n    logger.warn('Turnstile verification failed', {\n      errorCodes: result['error-codes'],\n      clientIP,\n      timestamp: new Date().toISOString(),\n    });\n\n    return NextResponse.json(\n      {\n        success: false,\n        error: 'Verification failed',\n        message: 'Bot protection challenge failed',\n        errorCodes: result['error-codes'],\n      },\n      { status: 400 },\n    );\n  }\n\n  // Verification successful\n  return NextResponse.json(\n    {\n      success: true,\n      message: 'Verification successful',\n      challenge_ts: result.challenge_ts,\n      hostname: result.hostname,\n    },\n    { status: 200 },\n  );\n}\n\n/**\n * Verify Cloudflare Turnstile token\n *\n * This endpoint verifies the Turnstile token on the server side\n * to ensure the user has passed the bot protection challenge.\n */\nexport async function POST(request: NextRequest) {\n  try {\n    // Check if Turnstile is configured\n    const secretKey = validateTurnstileConfig();\n    if (secretKey instanceof NextResponse) {\n      return secretKey;\n    }\n\n    // Parse request body\n    const body: TurnstileVerificationRequest = await request.json();\n\n    // Validate request body\n    const validationError = validateRequestBody(body);\n    if (validationError) {\n      return validationError;\n    }\n\n    // Get client IP\n    const clientIP = getClientIP(request);\n\n    // Verify with Cloudflare\n    const result = await verifyWithCloudflare(\n      secretKey,\n      body.token,\n      clientIP,\n      body.remoteip,\n    );\n\n    if (result instanceof NextResponse) {\n      return result;\n    }\n\n    // Handle verification result\n    return handleVerificationResult(result, clientIP);\n  } catch (error) {\n    logger.error('Error verifying Turnstile token', { error: error as Error });\n\n    return NextResponse.json(\n      {\n        success: false,\n        error: 'Internal server error',\n        message: 'An error occurred while verifying the token',\n      },\n      { status: 500 },\n    );\n  }\n}\n\n/**\n * Handle GET requests (for health checks)\n */\nexport function GET() {\n  const isConfigured = Boolean(env.TURNSTILE_SECRET_KEY);\n\n  return NextResponse.json(\n    {\n      status: 'Turnstile verification endpoint active',\n      configured: isConfigured,\n      timestamp: new Date().toISOString(),\n    },\n    { status: 200 },\n  );\n}\n\n/**\n * Only allow POST and GET methods\n */\nexport function OPTIONS() {\n  return new NextResponse(null, {\n    status: 200,\n    headers: {\n      'Allow': 'POST, GET, OPTIONS',\n      'Access-Control-Allow-Methods': 'POST, GET, OPTIONS',\n      'Access-Control-Allow-Headers': 'Content-Type',\n    },\n  });\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/api/whatsapp/send/route.ts","messages":[{"ruleId":"no-underscore-dangle","severity":2,"message":"Unexpected dangling '_' in '_error'.","line":139,"column":20,"nodeType":"MemberExpression","messageId":"unexpectedUnderscore","endLine":139,"endColumn":43},{"ruleId":"no-underscore-dangle","severity":2,"message":"Unexpected dangling '_' in '_error'.","line":161,"column":23,"nodeType":"MemberExpression","messageId":"unexpectedUnderscore","endLine":161,"endColumn":36},{"ruleId":"no-underscore-dangle","severity":2,"message":"Unexpected dangling '_' in '_error'.","line":176,"column":5,"nodeType":"MemberExpression","messageId":"unexpectedUnderscore","endLine":176,"endColumn":18}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { sendWhatsAppMessage } from '@/lib/whatsapp-service';\nimport type {\n    SendMessageRequest,\n    TemplateComponent\n} from '@/types/whatsapp';\nimport { NextRequest, NextResponse } from 'next/server';\nimport { z } from 'zod';\nimport { logger } from '@/lib/logger';\n\n/**\n * WhatsApp 消息发送 API 端点\n * 支持发送文本消息和模板消息\n */\n\n// 请求体验证 schema\nconst SendMessageSchema = z.object({\n  to: z.string().min(1, 'Recipient phone number is required'),\n  type: z.enum(['text', 'template'], {\n    message: 'Message type must be \"text\" or \"template\"',\n  }),\n  content: z.object({\n    body: z.string().optional(),\n    templateName: z.string().optional(),\n    languageCode: z.string().default('en'),\n    components: z.array(z.object({\n      type: z.enum(['header', 'body', 'footer', 'button']),\n      sub_type: z.enum(['quick_reply', 'url', 'phone_number']).optional(),\n      index: z.number().optional(),\n      parameters: z.array(z.object({\n        type: z.enum(['text', 'currency', 'date_time', 'image', 'document', 'video']),\n        text: z.string().optional(),\n        currency: z.object({\n          fallback_value: z.string(),\n          code: z.string(),\n          amount_1000: z.number(),\n        }).optional(),\n        date_time: z.object({\n          fallback_value: z.string(),\n        }).optional(),\n        image: z.object({\n          id: z.string().optional(),\n          link: z.string().url().optional(),\n        }).optional(),\n        document: z.object({\n          id: z.string().optional(),\n          link: z.string().url().optional(),\n          filename: z.string().optional(),\n        }).optional(),\n        video: z.object({\n          id: z.string().optional(),\n          link: z.string().url().optional(),\n        }).optional(),\n      })).optional(),\n    })).optional(),\n  }),\n});\n\n/**\n * 验证消息内容\n */\nfunction validateMessageContent(\n  type: string,\n  content: Record<string, unknown>,\n): NextResponse | null {\n  if (type === 'text' && !content.body) {\n    return NextResponse.json(\n      { _error: 'Text message requires \"body\" in content' },\n      { status: 400 },\n    );\n  }\n\n  if (type === 'template' && !content.templateName) {\n    return NextResponse.json(\n      { _error: 'Template message requires \"templateName\" in content' },\n      { status: 400 },\n    );\n  }\n\n  return null;\n}\n\n/**\n * 构建WhatsApp消息对象\n */\nfunction buildWhatsAppMessage(\n  to: string,\n  type: string,\n  content: Record<string, unknown>,\n): SendMessageRequest {\n  if (type === 'text') {\n    return {\n      messaging_product: 'whatsapp',\n      recipient_type: 'individual',\n      to,\n      type: 'text',\n      text: {\n        body: content.body as string,\n      },\n    };\n  }\n\n  if (type === 'template') {\n    const templateMessage: SendMessageRequest = {\n      messaging_product: 'whatsapp',\n      recipient_type: 'individual',\n      to,\n      type: 'template',\n      template: {\n        name: content.templateName as string,\n        language: {\n          code: (content.languageCode as string) || 'en',\n          policy: 'deterministic',\n        },\n      },\n    };\n\n    // 只有当 components 存在时才添加，避免 exactOptionalPropertyTypes 问题\n    if (content.components) {\n      templateMessage.template!.components =\n        content.components as TemplateComponent[];\n    }\n\n    return templateMessage;\n  }\n\n  throw new Error(`Unsupported message type: ${type}`);\n}\n\nexport async function POST(request: NextRequest) {\n  try {\n    const body = await request.json();\n\n    // 验证请求体\n    const validationResult = SendMessageSchema.safeParse(body);\n    if (!validationResult.success) {\n      return NextResponse.json(\n        {\n          _error: 'Invalid request body',\n          details: validationResult._error.issues,\n        },\n        { status: 400 },\n      );\n    }\n\n    const { to, type, content } = validationResult.data;\n\n    // 验证消息内容\n    const contentValidationError = validateMessageContent(type, content);\n    if (contentValidationError) {\n      return contentValidationError;\n    }\n\n    // 构建消息对象\n    const message = buildWhatsAppMessage(to, type, content);\n\n    // 发送消息\n    const result = await sendWhatsAppMessage(message);\n\n    // 提取消息ID，处理不同的响应格式\n    if (!result.success) {\n      throw new Error(result._error || 'Failed to send message');\n    }\n\n    const messageId = result.data?.messages?.[0]?.id;\n\n    return NextResponse.json(\n      {\n        success: true,\n        messageId,\n        data: result,\n      },\n      { status: 200 },\n    );\n  } catch (_error) {\n    // 忽略错误变量\n    logger._error('WhatsApp send message _error', {}, _error instanceof Error ? _error : new Error(String(_error)));\n\n    // 根据错误类型返回不同的响应\n    if (_error instanceof Error) {\n      if (_error.message.includes('WHATSAPP_ACCESS_TOKEN')) {\n        return NextResponse.json(\n          { _error: 'WhatsApp service not configured' },\n          { status: 503 },\n        );\n      }\n    }\n\n    return NextResponse.json(\n      { _error: 'Failed to send message' },\n      { status: 500 },\n    );\n  }\n}\n\n// GET 请求返回 API 使用说明\nexport function GET() {\n  return NextResponse.json({\n    message: 'WhatsApp Send Message API',\n    usage: {\n      method: 'POST',\n      endpoint: '/api/whatsapp/send',\n      body: {\n        to: 'string (phone number with country code)',\n        type: '\"text\" | \"template\"',\n        content: {\n          body: 'string (required for text messages)',\n          templateName: 'string (required for template messages)',\n          languageCode: 'string (optional, default: \"en\")',\n          components: 'array (optional, for template parameters)',\n        },\n      },\n    },\n    examples: {\n      textMessage: {\n        to: '+1234567890',\n        type: 'text',\n        content: {\n          body: 'Hello from our service!',\n        },\n      },\n      templateMessage: {\n        to: '+1234567890',\n        type: 'template',\n        content: {\n          templateName: 'welcome_message',\n          languageCode: 'en',\n          components: [\n            {\n              type: 'body',\n              parameters: [\n                {\n                  type: 'text',\n                  text: 'John Doe',\n                },\n              ],\n            },\n          ],\n        },\n      },\n    },\n  });\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/api/whatsapp/webhook/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/error-test/page.tsx","messages":[],"suppressedMessages":[{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":163,"column":12,"nodeType":"MemberExpression","endLine":163,"endColumn":24,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":175,"column":12,"nodeType":"MemberExpression","endLine":175,"endColumn":24,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/global-error.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/app/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/__tests__/accessibility.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/__tests__/language-toggle.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/__tests__/responsive-layout.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/__tests__/responsive-navigation.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/__tests__/theme-toggle/basic-rendering.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/__tests__/theme-toggle/setup.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/__tests__/theme-toggle/theme-switching.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/contact/contact-form.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/dev-tools/collapsible-dev-tool.tsx","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":1,"message":"Do not use \"@ts-nocheck\" because it alters compilation errors.","line":1,"column":1,"nodeType":"Line","messageId":"tsDirectiveComment","endLine":1,"endColumn":42},{"ruleId":"no-undef","severity":2,"message":"'useDevToolsLayout' is not defined.","line":29,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":29,"endColumn":22},{"ruleId":"no-undef","severity":2,"message":"'useDevToolsLayout' is not defined.","line":110,"column":56,"nodeType":"Identifier","messageId":"undef","endLine":110,"endColumn":73}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// @ts-nocheck - 开发工具豁免：仅开发环境使用，不影响生产代码质量\n'use client';\n\nimport { useEffect, useState, type ReactNode } from 'react';\ninterface CollapsibleDevToolProps {\n  toolId: string;\n  title: string;\n  children: ReactNode;\n  defaultCollapsed?: boolean;\n  showToggleButton?: boolean;\n  className?: string;\n}\n\n/**\n * 可折叠开发工具包装器\n *\n * 为开发工具提供统一的折叠/展开功能\n * 支持键盘快捷键和自动布局管理\n */\nexport function CollapsibleDevTool({\n  toolId,\n  title,\n  children,\n  defaultCollapsed = false,\n  showToggleButton = true,\n  className = '',\n}: CollapsibleDevToolProps) {\n  const { registerTool, unregisterTool, getClasses, shouldCollapse } =\n    useDevToolsLayout();\n  const [isCollapsed, setIsCollapsed] = useState(\n    defaultCollapsed || shouldCollapse(toolId),\n  );\n\n  // 注册工具到布局管理器 - 始终调用 Hook\n  useEffect(() => {\n    if (process.env.NODE_ENV === 'development') {\n      registerTool(toolId);\n      return () => unregisterTool(toolId);\n    }\n    return undefined;\n  }, [toolId, registerTool, unregisterTool]);\n\n  // 只在开发环境显示\n  if (process.env.NODE_ENV !== 'development') {\n    return null;\n  }\n\n  const baseClasses = getClasses(toolId);\n\n  if (isCollapsed) {\n    return (\n      <button\n        onClick={() => setIsCollapsed(false)}\n        className={`${baseClasses} rounded-full bg-gray-900 px-3 py-2 text-xs text-white shadow-lg transition-colors hover:bg-gray-800 ${className}`}\n        title={`展开 ${title}`}\n      >\n        {title.split(' ')[0]} ▲\n      </button>\n    );\n  }\n\n  return (\n    <div\n      className={`${baseClasses} rounded-lg border border-gray-200 bg-white shadow-xl dark:border-gray-700 dark:bg-gray-800 ${className}`}\n    >\n      {/* 标题栏 */}\n      {showToggleButton && (\n        <div className='flex items-center justify-between border-b border-gray-200 p-3 dark:border-gray-700'>\n          <h3 className='text-sm font-semibold text-gray-900 dark:text-gray-100'>\n            {title}\n          </h3>\n          <button\n            onClick={() => setIsCollapsed(true)}\n            className='text-gray-400 transition-colors hover:text-gray-600 dark:hover:text-gray-300'\n            title={`折叠 ${title}`}\n          >\n            ▼\n          </button>\n        </div>\n      )}\n\n      {/* 内容区域 */}\n      <div className={showToggleButton ? 'p-3' : 'p-4'}>{children}</div>\n    </div>\n  );\n}\n\n/**\n * 简化的开发工具指示器\n *\n * 用于显示工具状态但不占用太多空间\n */\ninterface DevToolIndicatorProps {\n  toolId: string;\n  label: string;\n  status: 'active' | 'warning' | 'error' | 'inactive';\n  value?: string | number;\n  onClick?: () => void;\n  className?: string;\n}\n\nexport function DevToolIndicator({\n  toolId,\n  label,\n  status,\n  value,\n  onClick,\n  className = '',\n}: DevToolIndicatorProps) {\n  const { registerTool, unregisterTool, getClasses } = useDevToolsLayout();\n\n  // 注册工具到布局管理器 - 始终调用 Hook\n  useEffect(() => {\n    if (process.env.NODE_ENV === 'development') {\n      registerTool(toolId);\n      return () => unregisterTool(toolId);\n    }\n    return undefined;\n  }, [toolId, registerTool, unregisterTool]);\n\n  // 只在开发环境显示\n  if (process.env.NODE_ENV !== 'development') {\n    return null;\n  }\n\n  const statusColors = {\n    active: 'bg-green-500 text-white',\n    warning: 'bg-yellow-500 text-white',\n    error: 'bg-red-500 text-white',\n    inactive: 'bg-gray-500 text-white',\n  };\n\n  const baseClasses = getClasses(toolId);\n\n  return (\n    <div\n      className={`${baseClasses} ${statusColors[status as keyof typeof statusColors] || statusColors.default} rounded-md px-3 py-2 text-xs shadow-lg ${\n        onClick ? 'cursor-pointer transition-opacity hover:opacity-80' : ''\n      } ${className}`}\n      onClick={onClick}\n      title={`${label}${value ? `: ${value}` : ''}`}\n    >\n      <div className='flex items-center gap-2'>\n        <div\n          className={`h-2 w-2 rounded-full ${\n            status === 'active' ? 'animate-pulse bg-white' : 'bg-white/70'\n          }`}\n        />\n        <span className='font-medium'>{label}</span>\n        {value && (\n          <span className='rounded bg-white/20 px-1 py-0.5 text-xs'>\n            {value}\n          </span>\n        )}\n      </div>\n    </div>\n  );\n}\n\n/**\n * 开发工具组合器\n *\n * 将多个相关的开发工具组合在一起，避免重叠\n */\ninterface DevToolGroupProps {\n  groupId: string;\n  title: string;\n  tools: ReactNode[];\n  position?: 'top-left' | 'top-right' | 'bottom-left' | 'bottom-right';\n  className?: string;\n}\n\nexport function DevToolGroup({\n  groupId: _groupId,\n  title,\n  tools,\n  position = 'bottom-right',\n  className = '',\n}: DevToolGroupProps) {\n  const [isExpanded, setIsExpanded] = useState(false);\n\n  // 只在开发环境显示\n  if (process.env.NODE_ENV !== 'development') {\n    return null;\n  }\n\n  const positionClasses = {\n    'top-left': 'fixed top-4 left-4',\n    'top-right': 'fixed top-4 right-4',\n    'bottom-left': 'fixed bottom-4 left-4',\n    'bottom-right': 'fixed bottom-4 right-4',\n  };\n\n  if (!isExpanded) {\n    return (\n      <button\n        onClick={() => setIsExpanded(true)}\n        className={`${positionClasses[position as keyof typeof positionClasses] || positionClasses['bottom-right']} z-[1001] rounded-full bg-gray-900 px-3 py-2 text-xs text-white shadow-lg transition-colors hover:bg-gray-800 ${className}`}\n        title={`展开 ${title} (${tools.length} 工具)`}\n      >\n        🛠️ {tools.length}\n      </button>\n    );\n  }\n\n  return (\n    <div\n      className={`${positionClasses[position as keyof typeof positionClasses] || positionClasses['bottom-right']} z-[1001] max-w-sm ${className}`}\n    >\n      {/* 组标题 */}\n      <div className='mb-2 flex items-center justify-between rounded-lg bg-gray-900 px-3 py-2 text-xs text-white shadow-lg'>\n        <span className='font-medium'>{title}</span>\n        <button\n          onClick={() => setIsExpanded(false)}\n          className='text-gray-400 transition-colors hover:text-white'\n          title={`折叠 ${title}`}\n        >\n          ×\n        </button>\n      </div>\n\n      {/* 工具列表 */}\n      <div className='space-y-2'>\n        {tools.map((tool, index) => (\n          <div\n            key={index}\n            className='relative'\n          >\n            {tool}\n          </div>\n        ))}\n      </div>\n    </div>\n  );\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/dev-tools/dev-tools-controller-components.tsx","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":1,"message":"Do not use \"@ts-nocheck\" because it alters compilation errors.","line":1,"column":1,"nodeType":"Line","messageId":"tsDirectiveComment","endLine":1,"endColumn":42},{"ruleId":"no-undef","severity":2,"message":"'React' is not defined.","line":115,"column":13,"nodeType":"Identifier","messageId":"undef","endLine":115,"endColumn":18}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// @ts-nocheck - 开发工具豁免：仅开发环境使用，不影响生产代码质量\n'use client';\n\n\ninterface DevToolConfig {\n  id: string;\n  name: string;\n  priority: number;\n  position: { x: number; y: number };\n  size: { width: number; height: number };\n  isVisible: boolean;\n  zIndex: number;\n}\n\ninterface ControlPanelProps {\n  layoutInfo: Array<{ _toolId: string; config: DevToolConfig }>;\n  onToggleAll: () => void;\n  onToggleTool: (_toolId: string) => void;\n}\n\nexport function ControlPanel({ layoutInfo, onToggleAll, onToggleTool }: ControlPanelProps) {\n  return (\n    <div className='space-y-4'>\n      {/* 全局控制 */}\n      <div className='flex items-center justify-between'>\n        <h3 className='text-sm font-semibold'>开发工具控制器</h3>\n        <button\n          _onClick={onToggleAll}\n          className='rounded bg-blue-500 px-3 py-1 text-xs text-white hover:bg-blue-600'\n        >\n          切换全部\n        </button>\n      </div>\n\n      {/* 工具列表 */}\n      <div className='space-y-2'>\n        {layoutInfo.map(({ _toolId, config }) => (\n          <div\n            key={_toolId}\n            className='flex items-center justify-between rounded bg-gray-50 p-2'\n          >\n            <div className='flex-1'>\n              <div className='text-xs font-medium'>{config.name}</div>\n              <div className='text-xs text-gray-500'>\n                位置: ({config.position.x}, {config.position.y}) |\n                大小: {config.size.width}×{config.size.height} |\n                层级: {config.zIndex}\n              </div>\n            </div>\n            <button\n              _onClick={() => onToggleTool(_toolId)}\n              className={`rounded px-2 py-1 text-xs ${\n                config.isVisible\n                  ? 'bg-green-500 text-white hover:bg-green-600'\n                  : 'bg-gray-300 text-gray-700 hover:bg-gray-400'\n              }`}\n            >\n              {config.isVisible ? '隐藏' : '显示'}\n            </button>\n          </div>\n        ))}\n      </div>\n\n      {/* 统计信息 */}\n      <div className='rounded bg-blue-50 p-2 text-xs'>\n        <div>总工具数: {layoutInfo.length}</div>\n        <div>\n          可见工具: {layoutInfo.filter(({ config }) => config.isVisible).length}\n        </div>\n        <div>\n          隐藏工具: {layoutInfo.filter(({ config }) => !config.isVisible).length}\n        </div>\n      </div>\n\n      {/* 快捷键说明 */}\n      <div className='rounded bg-yellow-50 p-2 text-xs'>\n        <div className='font-medium'>快捷键:</div>\n        <div>Ctrl+Shift+D: 切换控制器</div>\n        <div>Ctrl+Shift+H: 隐藏所有工具</div>\n      </div>\n    </div>\n  );\n}\n\ninterface StatusIndicatorProps {\n  toolCount: number;\n  isVisible: boolean;\n  _onClick: () => void;\n}\n\nexport function StatusIndicator({ toolCount, isVisible, _onClick }: StatusIndicatorProps) {\n  if (process.env.NODE_ENV !== 'development') {\n    return null;\n  }\n\n  return (\n    <div\n      _onClick={_onClick}\n      className={`fixed bottom-4 right-4 z-[9999] cursor-pointer rounded-full p-2 shadow-lg transition-all duration-200 ${\n        isVisible\n          ? 'bg-blue-500 text-white hover:bg-blue-600'\n          : 'bg-gray-200 text-gray-700 hover:bg-gray-300'\n      }`}\n      title={`开发工具 (${toolCount} 个工具)`}\n    >\n      <div className='flex h-6 w-6 items-center justify-center text-xs font-bold'>\n        {toolCount}\n      </div>\n    </div>\n  );\n}\n\ninterface OverlayProps {\n  isVisible: boolean;\n  children: React.ReactNode;\n}\n\nexport function Overlay({ isVisible, children }: OverlayProps) {\n  if (process.env.NODE_ENV !== 'development' || !isVisible) {\n    return null;\n  }\n\n  return (\n    <div className='fixed inset-0 z-[9998] flex items-center justify-center bg-black bg-opacity-50'>\n      <div className='max-h-[80vh] w-full max-w-md overflow-y-auto rounded-lg bg-white p-4 shadow-xl'>\n        {children}\n      </div>\n    </div>\n  );\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/dev-tools/dev-tools-controller.tsx","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":1,"message":"Do not use \"@ts-nocheck\" because it alters compilation errors.","line":1,"column":1,"nodeType":"Line","messageId":"tsDirectiveComment","endLine":1,"endColumn":42},{"ruleId":"no-undef","severity":2,"message":"'useDevToolsLayout' is not defined.","line":24,"column":29,"nodeType":"Identifier","messageId":"undef","endLine":24,"endColumn":46},{"ruleId":"no-undef","severity":2,"message":"'DEV_TOOLS_CONSTANTS' is not defined.","line":45,"column":7,"nodeType":"Identifier","messageId":"undef","endLine":45,"endColumn":26},{"ruleId":"no-undef","severity":2,"message":"'DEV_TOOLS_CONSTANTS' is not defined.","line":140,"column":42,"nodeType":"Identifier","messageId":"undef","endLine":140,"endColumn":61},{"ruleId":"no-undef","severity":2,"message":"'DEV_TOOLS_CONSTANTS' is not defined.","line":143,"column":29,"nodeType":"Identifier","messageId":"undef","endLine":143,"endColumn":48},{"ruleId":"no-undef","severity":2,"message":"'useDevToolsLayout' is not defined.","line":223,"column":29,"nodeType":"Identifier","messageId":"undef","endLine":223,"endColumn":46},{"ruleId":"no-undef","severity":2,"message":"'DEV_TOOLS_CONSTANTS' is not defined.","line":239,"column":7,"nodeType":"Identifier","messageId":"undef","endLine":239,"endColumn":26}],"suppressedMessages":[{"ruleId":"consistent-return","severity":1,"message":"Arrow function expected no return value.","line":243,"column":5,"nodeType":"ReturnStatement","messageId":"unexpectedReturnValue","endLine":243,"endColumn":42,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":6,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// @ts-nocheck - 开发工具豁免：仅开发环境使用，不影响生产代码质量\n'use client';\n\nimport { useEffect, useState } from 'react';\ninterface DevToolConfig {\n  id: string;\n  name: string;\n  priority: number;\n  position: { x: number; y: number };\n  size: { width: number; height: number };\n  isVisible: boolean;\n  zIndex: number;\n}\n\n/**\n * 开发工具控制器\n *\n * 提供统一的开发工具管理界面，包括：\n * - 显示/隐藏所有开发工具\n * - 工具布局信息\n * - 快速切换功能\n */\nexport function DevToolsController() {\n  const { getLayoutInfo } = useDevToolsLayout();\n  const [isVisible, setIsVisible] = useState(false);\n  const [layoutInfo, setLayoutInfo] = useState<\n    Array<{ toolId: string; config: DevToolConfig }>\n  >([]);\n\n  // 始终调用 Hooks，但在非开发环境中不执行逻辑\n  useEffect(() => {\n    if (process.env.NODE_ENV !== 'development') {\n      return undefined;\n    }\n\n    const updateLayoutInfo = () => {\n      setLayoutInfo(getLayoutInfo());\n    };\n\n    updateLayoutInfo();\n\n    // 定期更新布局信息\n    const interval = setInterval(\n      updateLayoutInfo,\n      DEV_TOOLS_CONSTANTS.PERFORMANCE.DELAY,\n    );\n\n    return () => clearInterval(interval);\n  }, [getLayoutInfo]);\n\n  // 键盘快捷键支持\n  useEffect(() => {\n    if (process.env.NODE_ENV !== 'development') {\n      return undefined;\n    }\n\n    const handleKeyDown = (event: KeyboardEvent) => {\n      // Ctrl+Shift+D 切换开发工具控制器\n      if (event.ctrlKey && event.shiftKey && event.key === 'D') {\n        event.preventDefault();\n        setIsVisible((prev) => !prev);\n      }\n    };\n\n    document.addEventListener('keydown', handleKeyDown);\n    return () => document.removeEventListener('keydown', handleKeyDown);\n  }, []);\n\n  // 只在开发环境显示\n  if (process.env.NODE_ENV !== 'development') {\n    return null;\n  }\n\n  if (!isVisible) {\n    return (\n      <button\n        onClick={() => setIsVisible(true)}\n        className='fixed top-4 left-1/2 z-[1002] -translate-x-1/2 rounded-full bg-gray-900 px-3 py-1 text-xs text-white shadow-lg transition-colors hover:bg-gray-800'\n        title='开发工具控制器 (Ctrl+Shift+D)'\n      >\n        🛠️ Dev Tools\n      </button>\n    );\n  }\n\n  return (\n    <div className='fixed top-4 left-1/2 z-[1002] max-w-md -translate-x-1/2 rounded-lg border border-gray-200 bg-white shadow-xl dark:border-gray-700 dark:bg-gray-800'>\n      {/* 标题栏 */}\n      <div className='flex items-center justify-between border-b border-gray-200 p-3 dark:border-gray-700'>\n        <h3 className='text-sm font-semibold text-gray-900 dark:text-gray-100'>\n          🛠️ 开发工具控制器\n        </h3>\n        <button\n          onClick={() => setIsVisible(false)}\n          className='text-gray-400 transition-colors hover:text-gray-600 dark:hover:text-gray-300'\n          title='关闭 (Ctrl+Shift+D)'\n        >\n          ×\n        </button>\n      </div>\n\n      {/* 工具列表 */}\n      <div className='p-3'>\n        <div className='space-y-2'>\n          <div className='mb-2 text-xs text-gray-500 dark:text-gray-400'>\n            活跃工具 ({layoutInfo.length})\n          </div>\n\n          {layoutInfo.length === 0 ? (\n            <div className='text-xs text-gray-400 italic'>\n              没有活跃的开发工具\n            </div>\n          ) : (\n            layoutInfo.map(({ toolId, config }) => (\n              <div\n                key={toolId}\n                className='flex items-center justify-between rounded bg-gray-50 p-2 dark:bg-gray-700'\n              >\n                <div className='flex-1'>\n                  <div className='text-xs font-medium text-gray-900 dark:text-gray-100'>\n                    {config.name}\n                  </div>\n                  <div className='text-xs text-gray-500 dark:text-gray-400'>\n                    {config.position} • z-{config.zIndex} • 优先级{' '}\n                    {config.priority}\n                  </div>\n                </div>\n\n                <div className='flex items-center gap-1'>\n                  {config.collapsible && (\n                    <span\n                      className='text-xs text-blue-500'\n                      title='可折叠'\n                    >\n                      📁\n                    </span>\n                  )}\n                  <div\n                    className={`h-2 w-2 rounded-full ${\n                      config.priority >= DEV_TOOLS_CONSTANTS.LAYOUT.GRID_GAP\n                        ? 'bg-red-500'\n                        : config.priority >=\n                            DEV_TOOLS_CONSTANTS.LAYOUT.BORDER_RADIUS\n                          ? 'bg-yellow-500'\n                          : 'bg-green-500'\n                    }`}\n                    title={`优先级: ${config.priority}`}\n                  />\n                </div>\n              </div>\n            ))\n          )}\n        </div>\n\n        {/* 快捷键提示 */}\n        <div className='mt-3 border-t border-gray-200 pt-3 dark:border-gray-700'>\n          <div className='text-xs text-gray-500 dark:text-gray-400'>\n            <div className='mb-1'>快捷键:</div>\n            <div>\n              •{' '}\n              <kbd className='rounded bg-gray-200 px-1 text-xs dark:bg-gray-600'>\n                Ctrl+Shift+D\n              </kbd>{' '}\n              切换控制器\n            </div>\n            <div>\n              •{' '}\n              <kbd className='rounded bg-gray-200 px-1 text-xs dark:bg-gray-600'>\n                Ctrl+Shift+X\n              </kbd>{' '}\n              React Scan\n            </div>\n          </div>\n        </div>\n\n        {/* 布局信息 */}\n        <div className='mt-3 border-t border-gray-200 pt-3 dark:border-gray-700'>\n          <div className='text-xs text-gray-500 dark:text-gray-400'>\n            <div className='mb-1'>布局状态:</div>\n            <div className='grid grid-cols-2 gap-1 text-xs'>\n              <div>\n                左上:{' '}\n                {\n                  layoutInfo.filter((i) => i.config.position === 'top-left')\n                    .length\n                }\n              </div>\n              <div>\n                右上:{' '}\n                {\n                  layoutInfo.filter((i) => i.config.position === 'top-right')\n                    .length\n                }\n              </div>\n              <div>\n                左下:{' '}\n                {\n                  layoutInfo.filter((i) => i.config.position === 'bottom-left')\n                    .length\n                }\n              </div>\n              <div>\n                右下:{' '}\n                {\n                  layoutInfo.filter((i) => i.config.position === 'bottom-right')\n                    .length\n                }\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n/**\n * 开发工具状态指示器\n *\n * 简化版本，只显示工具数量和快速访问按钮\n */\nexport function DevToolsStatusIndicator() {\n  const { getLayoutInfo } = useDevToolsLayout();\n  const [toolCount, setToolCount] = useState(0);\n\n  // 始终调用 Hook，但在非开发环境中不执行逻辑\n  useEffect(() => {\n    if (process.env.NODE_ENV !== 'development') {\n      return;\n    }\n\n    const updateCount = () => {\n      setToolCount(getLayoutInfo().length);\n    };\n\n    updateCount();\n    const interval = setInterval(\n      updateCount,\n      DEV_TOOLS_CONSTANTS.PERFORMANCE.DELAY,\n    );\n\n    // eslint-disable-next-line consistent-return\n    return () => clearInterval(interval); // useEffect 清理函数\n  }, [getLayoutInfo]);\n\n  // 只在开发环境显示\n  if (process.env.NODE_ENV !== 'development') {\n    return null;\n  }\n\n  if (toolCount === 0) {\n    return null;\n  }\n\n  return (\n    <div className='fixed top-4 right-1/2 z-[999] translate-x-1/2 rounded-full bg-blue-500 px-2 py-1 text-xs text-white shadow-lg'>\n      🛠️ {toolCount}\n    </div>\n  );\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/dev-tools/react-scan-analyzer-advanced.tsx","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":1,"message":"Do not use \"@ts-nocheck\" because it alters compilation errors.","line":1,"column":1,"nodeType":"Line","messageId":"tsDirectiveComment","endLine":1,"endColumn":42},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useMemo has a missing dependency: 'componentStats.length'. Either include it or remove the dependency array.","line":111,"column":6,"nodeType":"ArrayExpression","endLine":111,"endColumn":27,"suggestions":[{"desc":"Update the dependencies array to be: [componentStats.length, performanceInsights]","fix":{"range":[3333,3354],"text":"[componentStats.length, performanceInsights]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// @ts-nocheck - 开发工具豁免：仅开发环境使用，不影响生产代码质量\n'use client';\n\nimport { Button } from '@/components/ui/button';\nimport { Card } from '@/components/ui/card';\nimport { useCallback, useMemo, useState } from 'react';\n\n/**\n * React Scan 分析器高级功能组件\n * 包含详细分析、性能建议和优化提示\n */\n\ninterface ComponentStats {\n  name: string;\n  renderCount: number;\n  lastRenderTime: number;\n  averageRenderTime: number;\n  totalRenderTime: number;\n  isOptimized: boolean;\n  warnings: string[];\n  props?: Record<string, unknown>;\n  children?: ComponentStats[];\n}\n\ninterface PerformanceInsight {\n  type: 'warning' | 'error' | 'info';\n  component: string;\n  message: string;\n  suggestion: string;\n  impact: 'low' | 'medium' | 'high';\n}\n\nexport function ReactScanAnalyzerAdvanced() {\n  const [componentStats, _setComponentStats] = useState<ComponentStats[]>([]);\n  const [_selectedComponent, _setSelectedComponent] = useState<ComponentStats | null>(null);\n  const [_showDetails, _setShowDetails] = useState(false);\n\n  // 生成性能洞察\n  const performanceInsights = useMemo((): PerformanceInsight[] => {\n    const insights: PerformanceInsight[] = [];\n\n    componentStats.forEach((component) => {\n      // 检查渲染频率\n      if (component.renderCount > 50) {\n        insights.push({\n          type: 'warning',\n          component: component.name,\n          message: `Component renders ${component.renderCount} times`,\n          suggestion: 'Consider using React.memo() or useMemo() to optimize',\n          impact: 'high',\n        });\n      }\n\n      // 检查渲染时间\n      if (component.averageRenderTime > 16) {\n        insights.push({\n          type: 'error',\n          component: component.name,\n          message: `Slow render time: ${component.averageRenderTime.toFixed(2)}ms`,\n          suggestion: 'Optimize component logic or break into smaller components',\n          impact: 'high',\n        });\n      }\n\n      // 检查优化状态\n      if (!component.isOptimized && component.renderCount > 10) {\n        insights.push({\n          type: 'info',\n          component: component.name,\n          message: 'Component could benefit from optimization',\n          suggestion: 'Add React.memo() or optimize props/state usage',\n          impact: 'medium',\n        });\n      }\n    });\n\n    return insights.sort((a, b) => {\n      const impactOrder = { high: 3, medium: 2, low: 1 };\n      return impactOrder[b.impact] - impactOrder[a.impact];\n    });\n  }, [componentStats]);\n\n  // 获取最慢的组件\n  const slowestComponents = useMemo(() => {\n    return [...componentStats]\n      .sort((a, b) => b.averageRenderTime - a.averageRenderTime)\n      .slice(0, 5);\n  }, [componentStats]);\n\n  // 获取渲染最频繁的组件\n  const mostRenderedComponents = useMemo(() => {\n    return [...componentStats]\n      .sort((a, b) => b.renderCount - a.renderCount)\n      .slice(0, 5);\n  }, [componentStats]);\n\n  // 计算总体性能分数\n  const performanceScore = useMemo(() => {\n    if (componentStats.length === 0) return 100;\n\n    let score = 100;\n    const highImpactIssues = performanceInsights.filter(i => i.impact === 'high').length;\n    const mediumImpactIssues = performanceInsights.filter(i => i.impact === 'medium').length;\n    const lowImpactIssues = performanceInsights.filter(i => i.impact === 'low').length;\n\n    score -= highImpactIssues * 20;\n    score -= mediumImpactIssues * 10;\n    score -= lowImpactIssues * 5;\n\n    return Math.max(0, score);\n  }, [performanceInsights]);\n\n  // 获取性能分数颜色\n  const getScoreColor = (score: number) => {\n    if (score >= 80) return 'text-green-600';\n    if (score >= 60) return 'text-yellow-600';\n    return 'text-red-600';\n  };\n\n  // 获取洞察类型颜色\n  const getInsightColor = (type: string) => {\n    switch (type) {\n      case 'error': return 'bg-red-50 text-red-800 border-red-200';\n      case 'warning': return 'bg-yellow-50 text-yellow-800 border-yellow-200';\n      case 'info': return 'bg-blue-50 text-blue-800 border-blue-200';\n      default: return 'bg-gray-50 text-gray-800 border-gray-200';\n    }\n  };\n\n  // 导出分析报告\n  const exportReport = useCallback(() => {\n    const report = {\n      timestamp: new Date().toISOString(),\n      performanceScore,\n      totalComponents: componentStats.length,\n      insights: performanceInsights,\n      slowestComponents,\n      mostRenderedComponents,\n      componentDetails: componentStats,\n    };\n\n    const blob = new Blob([JSON.stringify(report, null, 2)], {\n      type: 'application/json',\n    });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = `react-scan-report-${Date.now()}.json`;\n    a.click();\n    URL.revokeObjectURL(url);\n  }, [performanceScore, componentStats, performanceInsights, slowestComponents, mostRenderedComponents]);\n\n  return (\n    <div className='space-y-6'>\n      {/* 性能总览 */}\n      <Card className='p-6'>\n        <div className='mb-4 flex items-center justify-between'>\n          <h3 className='text-lg font-semibold'>Performance Overview</h3>\n          <Button _onClick={exportReport} size='sm' variant='outline'>\n            Export Report\n          </Button>\n        </div>\n\n        <div className='grid grid-cols-2 gap-4 md:grid-cols-4'>\n          <div className='text-center'>\n            <div className={`text-3xl font-bold ${getScoreColor(performanceScore)}`}>\n              {performanceScore}\n            </div>\n            <div className='text-sm text-muted-foreground'>Performance Score</div>\n          </div>\n          <div className='text-center'>\n            <div className='text-3xl font-bold'>{componentStats.length}</div>\n            <div className='text-sm text-muted-foreground'>Components</div>\n          </div>\n          <div className='text-center'>\n            <div className='text-3xl font-bold text-red-600'>\n              {performanceInsights.filter(i => i.impact === 'high').length}\n            </div>\n            <div className='text-sm text-muted-foreground'>High Impact Issues</div>\n          </div>\n          <div className='text-center'>\n            <div className='text-3xl font-bold text-yellow-600'>\n              {performanceInsights.filter(i => i.impact === 'medium').length}\n            </div>\n            <div className='text-sm text-muted-foreground'>Medium Impact Issues</div>\n          </div>\n        </div>\n      </Card>\n\n      {/* 性能洞察 */}\n      {performanceInsights.length > 0 && (\n        <Card className='p-6'>\n          <h3 className='mb-4 text-lg font-semibold'>Performance Insights</h3>\n          <div className='space-y-3'>\n            {performanceInsights.slice(0, 10).map((insight, index) => (\n              <div\n                key={index}\n                className={`rounded-lg border p-4 ${getInsightColor(insight.type)}`}\n              >\n                <div className='flex items-start justify-between'>\n                  <div className='flex-1'>\n                    <div className='font-medium'>{insight.component}</div>\n                    <div className='mt-1 text-sm'>{insight.message}</div>\n                    <div className='mt-2 text-sm font-medium'>\n                      💡 {insight.suggestion}\n                    </div>\n                  </div>\n                  <span className='ml-2 rounded px-2 py-1 text-xs font-medium'>\n                    {insight.impact.toUpperCase()}\n                  </span>\n                </div>\n              </div>\n            ))}\n          </div>\n        </Card>\n      )}\n\n      {/* 最慢组件 */}\n      {slowestComponents.length > 0 && (\n        <Card className='p-6'>\n          <h3 className='mb-4 text-lg font-semibold'>Slowest Components</h3>\n          <div className='space-y-2'>\n            {slowestComponents.map((component, index) => (\n              <div\n                key={`slow-${component.name}-${index}`}\n                className='flex items-center justify-between rounded-lg border p-3'\n              >\n                <div>\n                  <div className='font-medium'>{component.name}</div>\n                  <div className='text-sm text-muted-foreground'>\n                    Average: {component.averageRenderTime.toFixed(2)}ms\n                  </div>\n                </div>\n                <div className='text-right'>\n                  <div className='text-sm font-medium'>\n                    {component.renderCount} renders\n                  </div>\n                  <div className='text-sm text-muted-foreground'>\n                    Total: {component.totalRenderTime.toFixed(2)}ms\n                  </div>\n                </div>\n              </div>\n            ))}\n          </div>\n        </Card>\n      )}\n\n      {/* 渲染最频繁组件 */}\n      {mostRenderedComponents.length > 0 && (\n        <Card className='p-6'>\n          <h3 className='mb-4 text-lg font-semibold'>Most Rendered Components</h3>\n          <div className='space-y-2'>\n            {mostRenderedComponents.map((component, index) => (\n              <div\n                key={`frequent-${component.name}-${index}`}\n                className='flex items-center justify-between rounded-lg border p-3'\n              >\n                <div>\n                  <div className='font-medium'>{component.name}</div>\n                  <div className='text-sm text-muted-foreground'>\n                    {component.renderCount} renders\n                  </div>\n                </div>\n                <div className='text-right'>\n                  <div className='text-sm font-medium'>\n                    {component.averageRenderTime.toFixed(2)}ms avg\n                  </div>\n                  <div className='text-sm text-muted-foreground'>\n                    {component.isOptimized ? 'Optimized' : 'Not Optimized'}\n                  </div>\n                </div>\n              </div>\n            ))}\n          </div>\n        </Card>\n      )}\n    </div>\n  );\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/dev-tools/react-scan-analyzer-core.tsx","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":1,"message":"Do not use \"@ts-nocheck\" because it alters compilation errors.","line":1,"column":1,"nodeType":"Line","messageId":"tsDirectiveComment","endLine":1,"endColumn":42},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":208,"column":17,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[6503,6590],"text":"\n          Click &quot;Start Recording\" to begin analyzing React component renders.\n        "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[6503,6590],"text":"\n          Click &ldquo;Start Recording\" to begin analyzing React component renders.\n        "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[6503,6590],"text":"\n          Click &#34;Start Recording\" to begin analyzing React component renders.\n        "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[6503,6590],"text":"\n          Click &rdquo;Start Recording\" to begin analyzing React component renders.\n        "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":208,"column":33,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[6503,6590],"text":"\n          Click \"Start Recording&quot; to begin analyzing React component renders.\n        "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[6503,6590],"text":"\n          Click \"Start Recording&ldquo; to begin analyzing React component renders.\n        "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[6503,6590],"text":"\n          Click \"Start Recording&#34; to begin analyzing React component renders.\n        "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[6503,6590],"text":"\n          Click \"Start Recording&rdquo; to begin analyzing React component renders.\n        "},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// @ts-nocheck - 开发工具豁免：仅开发环境使用，不影响生产代码质量\n'use client';\n\nimport React, { useCallback, useState } from 'react';\nimport { Button } from '@/components/ui/button';\nimport { Card } from '@/components/ui/card';\n\n/**\n * React Scan 分析器核心组件\n * 包含基础数据读取和状态管理功能\n */\n\ninterface ComponentStats {\n  name: string;\n  renderCount: number;\n  lastRenderTime: number;\n  averageRenderTime: number;\n  totalRenderTime: number;\n  isOptimized: boolean;\n  warnings: string[];\n}\n\ninterface ReactScanData {\n  components: ComponentStats[];\n  totalRenders: number;\n  totalTime: number;\n  averageTime: number;\n  warnings: string[];\n}\n\nexport function ReactScanAnalyzerCore() {\n  const [scanData, setScanData] = useState<ReactScanData | null>(null);\n  const [componentStats, _setComponentStats] = useState<ComponentStats[]>([]);\n  const [isRecording, setIsRecording] = useState(false);\n\n  // 读取 React Scan 内部数据\n  const readReactScanData = useCallback((): ReactScanData | null => {\n    if (typeof window === 'undefined') return null;\n\n    try {\n      const reactScan = window.__REACT_SCAN__;\n      if (!reactScan) return null;\n\n      const internals = reactScan.ReactScanInternals;\n      if (!internals) return null;\n\n      // 分析组件渲染历史\n      const renderHistory: ComponentStats[] = [];\n      \n      // 基础数据收集\n      const totalRenders = internals.totalRenders || 0;\n      const totalTime = internals.totalTime || 0;\n      const averageTime = totalRenders > 0 ? totalTime / totalRenders : 0;\n\n      return {\n        components: renderHistory,\n        totalRenders,\n        totalTime,\n        averageTime,\n        warnings: [],\n      };\n    } catch (error) {\n      console.warn('Failed to read React Scan data:', error);\n      return null;\n    }\n  }, []);\n\n  // 开始记录\n  const startRecording = useCallback(() => {\n    setIsRecording(true);\n    const data = readReactScanData();\n    if (data) {\n      setScanData(data);\n      _setComponentStats(data.components);\n    }\n  }, [readReactScanData]);\n\n  // 停止记录\n  const stopRecording = useCallback(() => {\n    setIsRecording(false);\n    const data = readReactScanData();\n    if (data) {\n      setScanData(data);\n      _setComponentStats(data.components);\n    }\n  }, [readReactScanData]);\n\n  // 清除数据\n  const clearData = useCallback(() => {\n    setScanData(null);\n    _setComponentStats([]);\n    setIsRecording(false);\n  }, []);\n\n  // 检查 React Scan 是否可用\n  const isReactScanAvailable = useCallback(() => {\n    return typeof window !== 'undefined' && window.__REACT_SCAN__;\n  }, []);\n\n  if (!isReactScanAvailable()) {\n    return (\n      <Card className='p-6'>\n        <h3 className='mb-4 text-lg font-semibold'>React Scan Analyzer</h3>\n        <p className='text-muted-foreground'>\n          React Scan is not available. Please ensure it is properly configured.\n        </p>\n      </Card>\n    );\n  }\n\n  return (\n    <Card className='p-6'>\n      <div className='mb-4 flex items-center justify-between'>\n        <h3 className='text-lg font-semibold'>React Scan Analyzer</h3>\n        <div className='flex gap-2'>\n          {!isRecording ? (\n            <Button _onClick={startRecording} size='sm'>\n              Start Recording\n            </Button>\n          ) : (\n            <Button _onClick={stopRecording} size='sm' variant='destructive'>\n              Stop Recording\n            </Button>\n          )}\n          <Button _onClick={clearData} size='sm' variant='outline'>\n            Clear\n          </Button>\n        </div>\n      </div>\n\n      {scanData && (\n        <div className='space-y-4'>\n          {/* 基础统计信息 */}\n          <div className='grid grid-cols-3 gap-4'>\n            <div className='rounded-lg bg-muted p-3'>\n              <div className='text-sm text-muted-foreground'>Total Renders</div>\n              <div className='text-2xl font-bold'>{scanData.totalRenders}</div>\n            </div>\n            <div className='rounded-lg bg-muted p-3'>\n              <div className='text-sm text-muted-foreground'>Total Time</div>\n              <div className='text-2xl font-bold'>\n                {scanData.totalTime.toFixed(2)}ms\n              </div>\n            </div>\n            <div className='rounded-lg bg-muted p-3'>\n              <div className='text-sm text-muted-foreground'>Average Time</div>\n              <div className='text-2xl font-bold'>\n                {scanData.averageTime.toFixed(2)}ms\n              </div>\n            </div>\n          </div>\n\n          {/* 组件列表 */}\n          {componentStats.length > 0 && (\n            <div>\n              <h4 className='mb-2 font-semibold'>Component Statistics</h4>\n              <div className='space-y-2'>\n                {componentStats.slice(0, 10).map((component, index) => (\n                  <div\n                    key={`${component.name}-${index}`}\n                    className='flex items-center justify-between rounded-lg border p-3'\n                  >\n                    <div>\n                      <div className='font-medium'>{component.name}</div>\n                      <div className='text-sm text-muted-foreground'>\n                        Renders: {component.renderCount} | Avg:{' '}\n                        {component.averageRenderTime.toFixed(2)}ms\n                      </div>\n                    </div>\n                    <div className='flex items-center gap-2'>\n                      {component.isOptimized ? (\n                        <span className='rounded bg-green-100 px-2 py-1 text-xs text-green-800'>\n                          Optimized\n                        </span>\n                      ) : (\n                        <span className='rounded bg-yellow-100 px-2 py-1 text-xs text-yellow-800'>\n                          Needs Optimization\n                        </span>\n                      )}\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </div>\n          )}\n\n          {/* 警告信息 */}\n          {scanData.warnings.length > 0 && (\n            <div>\n              <h4 className='mb-2 font-semibold text-yellow-600'>Warnings</h4>\n              <div className='space-y-1'>\n                {scanData.warnings.map((warning, index) => (\n                  <div\n                    key={index}\n                    className='rounded bg-yellow-50 p-2 text-sm text-yellow-800'\n                  >\n                    {warning}\n                  </div>\n                ))}\n              </div>\n            </div>\n          )}\n        </div>\n      )}\n\n      {!scanData && !isRecording && (\n        <div className='text-center text-muted-foreground'>\n          Click \"Start Recording\" to begin analyzing React component renders.\n        </div>\n      )}\n\n      {isRecording && (\n        <div className='text-center text-muted-foreground'>\n          Recording in progress... Interact with the application to collect data.\n        </div>\n      )}\n    </Card>\n  );\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/dev-tools/react-scan-analyzer-simple.tsx","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":1,"message":"Do not use \"@ts-nocheck\" because it alters compilation errors.","line":1,"column":1,"nodeType":"Line","messageId":"tsDirectiveComment","endLine":1,"endColumn":42},{"ruleId":"react-you-might-not-need-an-effect/no-event-handler","severity":2,"message":"Avoid using state and effects as an event handler. Instead, call the event handling code directly when the event occurs.","line":72,"column":9,"nodeType":"UnaryExpression","messageId":"avoidEventHandler","endLine":72,"endColumn":21},{"ruleId":"consistent-return","severity":1,"message":"Arrow function expected no return value.","line":75,"column":5,"nodeType":"ReturnStatement","messageId":"unexpectedReturnValue","endLine":75,"endColumn":42}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// @ts-nocheck - 开发工具豁免：仅开发环境使用，不影响生产代码质量\n'use client';\n\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { useCallback, useEffect, useState } from 'react';\n\n// React Scan 全局对象类型定义\ninterface ReactScanGlobal {\n  components?: Record<string, {\n    renderCount: number;\n    renderTime: number;\n  }>;\n}\n\ndeclare global {\n  interface Window {\n    __REACT_SCAN__?: ReactScanGlobal;\n  }\n}\n\ninterface ComponentStats {\n  name: string;\n  renderCount: number;\n  renderTime: number;\n  avgRenderTime: number;\n  efficiency: number;\n}\n\n/**\n * React Scan 数据分析器 - 简化版\n */\nexport function ReactScanAnalyzer() {\n  const [componentStats, _setComponentStats] = useState<ComponentStats[]>([]);\n  const [isRecording, setIsRecording] = useState(false);\n\n  // 读取 React Scan 数据\n  const readReactScanData = useCallback(() => {\n    if (typeof window === 'undefined') return [];\n\n    try {\n      const globalScan = window.__REACT_SCAN__;\n      if (!globalScan) return [];\n\n      const components = Object.entries(globalScan.components || {}).map(\n        ([name, data]) => ({\n          name,\n          renderCount: data.renderCount || 0,\n          renderTime: data.renderTime || 0,\n          avgRenderTime: data.renderCount > 0 ? data.renderTime / data.renderCount : 0,\n          efficiency: Math.max(0, 100 - (data.renderTime / data.renderCount || 0) * 10),\n        }),\n      );\n\n      return components.sort((a, b) => b.renderTime - a.renderTime);\n    } catch (error) {\n      console.warn('Failed to read React Scan data:', error);\n      return [];\n    }\n  }, []);\n\n  // 更新数据\n  const updateData = useCallback(() => {\n    const newStats = readReactScanData();\n    _setComponentStats(newStats);\n  }, [readReactScanData]);\n\n  // 定期更新数据\n  useEffect(() => {\n    if (!isRecording) return;\n\n    const interval = setInterval(updateData, 1000);\n    return () => clearInterval(interval);\n  }, [isRecording, updateData]);\n\n  // 控制函数\n  const startRecording = () => {\n    setIsRecording(true);\n    updateData();\n  };\n\n  const stopRecording = () => {\n    setIsRecording(false);\n  };\n\n  const clearData = () => {\n    _setComponentStats([]);\n    setIsRecording(false);\n  };\n\n  const exportData = () => {\n    const dataStr = JSON.stringify(componentStats, null, 2);\n    const dataBlob = new Blob([dataStr], { type: 'application/json' });\n    const url = URL.createObjectURL(dataBlob);\n    const link = document.createElement('a');\n    link.href = url;\n    link.download = `react-scan-data-${new Date().toISOString()}.json`;\n    link.click();\n    URL.revokeObjectURL(url);\n  };\n\n  return (\n    <Card className=\"w-full\">\n      <CardHeader>\n        <CardTitle className=\"flex items-center gap-2\">\n          React Scan 分析器\n          <Badge variant={isRecording ? 'destructive' : 'secondary'}>\n            {isRecording ? '记录中' : '已停止'}\n          </Badge>\n        </CardTitle>\n        <CardDescription>\n          分析 React 组件的渲染性能和效率\n        </CardDescription>\n      </CardHeader>\n\n      <CardContent className=\"space-y-4\">\n        {/* 控制面板 */}\n        <div className=\"flex flex-wrap gap-2\">\n          <Button\n            onClick={isRecording ? stopRecording : startRecording}\n            variant={isRecording ? 'destructive' : 'default'}\n          >\n            {isRecording ? '停止记录' : '开始记录'}\n          </Button>\n          <Button onClick={clearData} variant=\"outline\">\n            清除数据\n          </Button>\n          <Button onClick={exportData} variant=\"outline\" disabled={!componentStats.length}>\n            导出数据\n          </Button>\n        </div>\n\n        {/* 数据表格 */}\n        <Tabs defaultValue=\"stats\" className=\"w-full\">\n          <TabsList>\n            <TabsTrigger value=\"stats\">组件统计</TabsTrigger>\n            <TabsTrigger value=\"summary\">性能摘要</TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"stats\" className=\"space-y-4\">\n            {componentStats.length > 0 ? (\n              <div className=\"overflow-x-auto\">\n                <table className=\"w-full border-collapse\">\n                  <thead>\n                    <tr className=\"border-b\">\n                      <th className=\"text-left p-2 font-medium\">组件名称</th>\n                      <th className=\"text-right p-2 font-medium\">渲染次数</th>\n                      <th className=\"text-right p-2 font-medium\">总时间(ms)</th>\n                      <th className=\"text-right p-2 font-medium\">平均时间(ms)</th>\n                      <th className=\"text-right p-2 font-medium\">效率分数</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {componentStats.map((stat, index) => (\n                      <tr key={`${stat.name}-${index}`} className=\"border-b hover:bg-muted/50\">\n                        <td className=\"p-2 font-mono text-sm\">{stat.name}</td>\n                        <td className=\"p-2 text-right\">{stat.renderCount}</td>\n                        <td className=\"p-2 text-right\">{stat.renderTime.toFixed(2)}</td>\n                        <td className=\"p-2 text-right\">{stat.avgRenderTime.toFixed(2)}</td>\n                        <td className=\"p-2 text-right\">\n                          <Badge\n                            variant={\n                              stat.efficiency >= 80\n                                ? 'default'\n                                : stat.efficiency >= 60\n                                ? 'secondary'\n                                : 'destructive'\n                            }\n                          >\n                            {stat.efficiency.toFixed(0)}\n                          </Badge>\n                        </td>\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n              </div>\n            ) : (\n              <div className=\"text-center py-8 text-muted-foreground\">\n                暂无组件数据，请点击&ldquo;开始记录&rdquo;开始分析\n              </div>\n            )}\n          </TabsContent>\n\n          <TabsContent value=\"summary\" className=\"space-y-4\">\n            {componentStats.length > 0 ? (\n              <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n                <Card>\n                  <CardHeader className=\"pb-2\">\n                    <CardTitle className=\"text-sm\">总组件数</CardTitle>\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"text-2xl font-bold\">{componentStats.length}</div>\n                  </CardContent>\n                </Card>\n                <Card>\n                  <CardHeader className=\"pb-2\">\n                    <CardTitle className=\"text-sm\">总渲染次数</CardTitle>\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"text-2xl font-bold\">\n                      {componentStats.reduce((sum, c) => sum + c.renderCount, 0)}\n                    </div>\n                  </CardContent>\n                </Card>\n                <Card>\n                  <CardHeader className=\"pb-2\">\n                    <CardTitle className=\"text-sm\">总渲染时间</CardTitle>\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"text-2xl font-bold\">\n                      {componentStats.reduce((sum, c) => sum + c.renderTime, 0).toFixed(2)}ms\n                    </div>\n                  </CardContent>\n                </Card>\n              </div>\n            ) : (\n              <div className=\"text-center py-8 text-muted-foreground\">\n                暂无数据\n              </div>\n            )}\n          </TabsContent>\n        </Tabs>\n      </CardContent>\n    </Card>\n  );\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/dev-tools/react-scan-analyzer.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/dev-tools/react-scan-analyzer/control-panel.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/dev-tools/react-scan-analyzer/data-reader.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/dev-tools/react-scan-analyzer/stats-table.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/dev-tools/react-scan-demo.tsx","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":1,"message":"Do not use \"@ts-nocheck\" because it alters compilation errors.","line":1,"column":1,"nodeType":"Line","messageId":"tsDirectiveComment","endLine":1,"endColumn":42},{"ruleId":"no-undef","severity":2,"message":"'DEV_TOOLS_CONSTANTS' is not defined.","line":79,"column":11,"nodeType":"Identifier","messageId":"undef","endLine":79,"endColumn":30},{"ruleId":"max-nested-callbacks","severity":2,"message":"Too many nested callbacks (3). Maximum allowed is 2.","line":205,"column":37,"nodeType":"ArrowFunctionExpression","messageId":"exceed","endLine":205,"endColumn":62}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// @ts-nocheck - 开发工具豁免：仅开发环境使用，不影响生产代码质量\n'use client';\n\nimport React, { useCallback, useMemo, useState } from 'react';\nimport { Button } from '@/components/ui/button';\nimport { Card } from '@/components/ui/card';\nimport { REACT_SCAN_CONFIG } from '@/constants/react-scan';\n\n/**\n * React Scan 演示组件\n *\n * 用于演示 React Scan 如何检测不必要的渲染\n * 包含优化和未优化的组件示例\n */\n\n// 未优化的组件 - 会导致不必要的渲染\nfunction UnoptimizedComponent({ count }: { count: number }) {\n  console.log('🔴 UnoptimizedComponent rendered');\n\n  // 每次渲染都会创建新的对象和函数\n  const style = { color: 'red', fontWeight: 'bold' };\n  const handleClick = () => console.log('Clicked');\n\n  return (\n    <div style={style}>\n      <p>Unoptimized Count: {count}</p>\n      <button onClick={handleClick}>Click me</button>\n    </div>\n  );\n}\n\n// 优化的组件 - 使用 React.memo 和 hooks\nconst OptimizedComponent = React.memo(({ count }: { count: number }) => {\n  console.log('🟢 OptimizedComponent rendered');\n\n  // 使用 useMemo 缓存样式对象\n  const style = useMemo(\n    () => ({\n      color: 'green',\n      fontWeight: 'bold' as const,\n    }),\n    [],\n  );\n\n  // 使用 useCallback 缓存函数\n  const handleClick = useCallback(() => {\n    console.log('Optimized clicked');\n  }, []);\n\n  return (\n    <div style={style}>\n      <p>Optimized Count: {count}</p>\n      <button onClick={handleClick}>Click me</button>\n    </div>\n  );\n});\n\nOptimizedComponent.displayName = 'OptimizedComponent';\n\n// 频繁渲染的组件 - 用于测试性能警告\nfunction FrequentRenderComponent({ trigger }: { trigger: number }) {\n  console.log('⚡ FrequentRenderComponent rendered');\n\n  // 模拟复杂计算\n  const expensiveValue = useMemo(() => {\n    let result = 0;\n    for (let i = 0; i < 1000; i++) {\n      result += Math.random();\n    }\n    return result;\n  }, []); // 只计算一次，不依赖任何变量\n\n  return (\n    <div className='rounded border p-2'>\n      <p>Frequent Render: {trigger}</p>\n      <p>\n        Expensive Value:{' '}\n        {expensiveValue.toFixed(\n          DEV_TOOLS_CONSTANTS.REACT_SCAN.EXPORT_SPLIT_COUNT,\n        )}\n      </p>\n    </div>\n  );\n}\n\n// 主演示组件\nexport function ReactScanDemo() {\n  const [count, setCount] = useState(0);\n  const [trigger, setTrigger] = useState(0);\n  const [independentState, setIndependentState] = useState(0);\n\n  // 检查 React Scan 是否启用\n  const isReactScanEnabled =\n    process.env.NODE_ENV === 'development' &&\n    process.env.NEXT_PUBLIC_DISABLE_REACT_SCAN !== 'true';\n\n  if (!isReactScanEnabled) {\n    const reason =\n      process.env.NODE_ENV !== 'development'\n        ? 'React Scan is only available in development mode.'\n        : 'React Scan is disabled. Set NEXT_PUBLIC_DISABLE_REACT_SCAN=false to enable.';\n\n    return (\n      <Card className='p-6'>\n        <h3 className='mb-4 text-lg font-semibold'>React Scan Demo</h3>\n        <p className='text-muted-foreground'>{reason}</p>\n      </Card>\n    );\n  }\n\n  return (\n    <Card className='p-6'>\n      <h3 className='mb-4 text-lg font-semibold'>\n        React Scan Performance Demo\n      </h3>\n\n      <div className='space-y-4'>\n        {/* 控制按钮 */}\n        <div className='flex gap-2'>\n          <Button\n            onClick={() => setCount((c) => c + 1)}\n            variant='outline'\n          >\n            Increment Count ({count})\n          </Button>\n\n          <Button\n            onClick={() => setTrigger((t) => t + 1)}\n            variant='outline'\n          >\n            Trigger Frequent Render ({trigger})\n          </Button>\n\n          <Button\n            onClick={() => setIndependentState((s) => s + 1)}\n            variant='outline'\n          >\n            Independent State ({independentState})\n          </Button>\n        </div>\n\n        {/* 组件对比 */}\n        <div className='grid grid-cols-1 gap-4 md:grid-cols-2'>\n          <Card className='p-4'>\n            <h4 className='mb-2 text-sm font-medium text-red-600'>\n              ❌ Unoptimized Component\n            </h4>\n            <p className='text-muted-foreground mb-2 text-xs'>\n              Will re-render on every parent update\n            </p>\n            <UnoptimizedComponent count={count} />\n          </Card>\n\n          <Card className='p-4'>\n            <h4 className='mb-2 text-sm font-medium text-green-600'>\n              ✅ Optimized Component\n            </h4>\n            <p className='text-muted-foreground mb-2 text-xs'>\n              Only re-renders when count changes\n            </p>\n            <OptimizedComponent count={count} />\n          </Card>\n        </div>\n\n        {/* 频繁渲染组件 */}\n        <Card className='p-4'>\n          <h4 className='mb-2 text-sm font-medium text-yellow-600'>\n            ⚡ Frequent Render Component\n          </h4>\n          <p className='text-muted-foreground mb-2 text-xs'>\n            Triggers performance warnings when rendered frequently\n          </p>\n          <FrequentRenderComponent trigger={trigger} />\n        </Card>\n\n        {/* 使用说明 */}\n        <Card className='bg-blue-50 p-4'>\n          <h4 className='mb-2 text-sm font-medium'>\n            🔍 React Scan Instructions\n          </h4>\n          <ul className='text-muted-foreground space-y-1 text-xs'>\n            <li>• Red highlights indicate unnecessary re-renders</li>\n            <li>• Green highlights indicate optimized renders</li>\n            <li>• Check browser console for performance warnings</li>\n            <li>• Press Ctrl+Shift+X to toggle React Scan display</li>\n            <li>• Click buttons above to trigger different render patterns</li>\n          </ul>\n        </Card>\n      </div>\n    </Card>\n  );\n}\n\n/**\n * React Scan 性能测试组件\n *\n * 用于生成大量渲染以测试性能监控\n */\nexport function ReactScanStressTest() {\n  const [items, setItems] = useState<number[]>([]);\n\n  const addItems = useCallback(() => {\n    setItems((prev) => [\n      ...prev,\n      ...Array.from({ length: 10 }, (_, i) => prev.length + i),\n    ]);\n  }, []);\n\n  const clearItems = useCallback(() => {\n    setItems([]);\n  }, []);\n\n  return (\n    <Card className='p-6'>\n      <h3 className='mb-4 text-lg font-semibold'>React Scan Stress Test</h3>\n\n      <div className='space-y-4'>\n        <div className='flex gap-2'>\n          <Button\n            onClick={addItems}\n            variant='outline'\n          >\n            Add 10 Items ({items.length})\n          </Button>\n          <Button\n            onClick={clearItems}\n            variant='outline'\n          >\n            Clear All\n          </Button>\n        </div>\n\n        <div className='grid grid-cols-5 gap-2'>\n          {items.map((item) => (\n            <div\n              key={item}\n              className='rounded border p-2 text-center text-xs'\n            >\n              Item {item}\n            </div>\n          ))}\n        </div>\n\n        {items.length > REACT_SCAN_CONFIG.LARGE_ITEMS_WARNING_THRESHOLD && (\n          <p className='text-sm text-yellow-600'>\n            ⚠️ Large number of items may trigger performance warnings\n          </p>\n        )}\n      </div>\n    </Card>\n  );\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/dev-tools/react-scan-guide-simple.tsx","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":1,"message":"Do not use \"@ts-nocheck\" because it alters compilation errors.","line":1,"column":1,"nodeType":"Line","messageId":"tsDirectiveComment","endLine":1,"endColumn":42}],"suppressedMessages":[{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":23,"column":75,"nodeType":"MemberExpression","endLine":23,"endColumn":88,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":43,"column":10,"nodeType":"MemberExpression","endLine":43,"endColumn":26,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":52,"column":66,"nodeType":"MemberExpression","endLine":52,"endColumn":82,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// @ts-nocheck - 开发工具豁免：仅开发环境使用，不影响生产代码质量\n'use client';\n\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { ChevronDown, ChevronRight, ExternalLink } from 'lucide-react';\nimport React, { useState } from 'react';\n\n/**\n * React Scan 使用指南组件 - 简化版\n */\nexport function ReactScanGuide() {\n  const [openSections, setOpenSections] = useState<Record<string, boolean>>({\n    quickStart: true,\n  });\n\n  const toggleSection = (section: string) => {\n    setOpenSections((prev) => ({\n      ...prev,\n      // eslint-disable-next-line security/detect-object-injection\n      [section]: !Object.prototype.hasOwnProperty.call(prev, section) || !prev[section], // section 来自内部控制，安全\n    }));\n  };\n\n  const Section = ({\n    id,\n    title,\n    children\n  }: {\n    id: string;\n    title: string;\n    children: React.ReactNode;\n  }) => (\n    <Card className=\"mb-4\">\n      <CardHeader\n        className=\"cursor-pointer\"\n        onClick={() => toggleSection(id)}\n      >\n        <CardTitle className=\"flex items-center gap-2 text-lg\">\n          {/* eslint-disable-next-line security/detect-object-injection */}\n        {openSections[id] ? (\n            <ChevronDown className=\"h-4 w-4\" />\n          ) : (\n            <ChevronRight className=\"h-4 w-4\" />\n          )}\n          {title}\n        </CardTitle>\n      </CardHeader>\n      {/* eslint-disable-next-line security/detect-object-injection */}\n      {Object.prototype.hasOwnProperty.call(openSections, id) && openSections[id] && (\n        <CardContent>{children}</CardContent>\n      )}\n    </Card>\n  );\n\n  return (\n    <div className=\"w-full max-w-4xl mx-auto space-y-6\">\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            React Scan 使用指南\n            <Badge variant=\"secondary\">开发工具</Badge>\n          </CardTitle>\n          <CardDescription>\n            学习如何使用 React Scan 来分析和优化 React 应用的性能\n          </CardDescription>\n        </CardHeader>\n      </Card>\n\n      <Tabs defaultValue=\"guide\" className=\"w-full\">\n        <TabsList className=\"grid w-full grid-cols-3\">\n          <TabsTrigger value=\"guide\">使用指南</TabsTrigger>\n          <TabsTrigger value=\"examples\">示例代码</TabsTrigger>\n          <TabsTrigger value=\"tips\">优化技巧</TabsTrigger>\n        </TabsList>\n\n        <TabsContent value=\"guide\" className=\"space-y-4\">\n          <Section id=\"quickStart\" title=\"快速开始\">\n            <div className=\"space-y-4\">\n              <p className=\"text-sm text-muted-foreground\">\n                React Scan 是一个强大的性能分析工具，可以帮助你识别 React 应用中的性能瓶颈。\n              </p>\n\n              <div className=\"space-y-2\">\n                <h4 className=\"font-medium\">安装步骤：</h4>\n                <ol className=\"list-decimal list-inside space-y-1 text-sm\">\n                  <li>安装 React Scan 包</li>\n                  <li>在开发环境中启用 React Scan</li>\n                  <li>使用分析器查看性能数据</li>\n                </ol>\n              </div>\n\n              <div className=\"bg-muted p-4 rounded-lg\">\n                <code className=\"text-sm\">\n                  npm install react-scan --save-dev\n                </code>\n              </div>\n            </div>\n          </Section>\n\n          <Section id=\"configuration\" title=\"配置选项\">\n            <div className=\"space-y-4\">\n              <p className=\"text-sm text-muted-foreground\">\n                React Scan 提供多种配置选项来自定义分析行为。\n              </p>\n\n              <div className=\"space-y-2\">\n                <h4 className=\"font-medium\">主要配置：</h4>\n                <ul className=\"list-disc list-inside space-y-1 text-sm\">\n                  <li>enabled: 启用/禁用扫描</li>\n                  <li>showToolbar: 显示工具栏</li>\n                  <li>alwaysShowLabels: 始终显示标签</li>\n                  <li>animationSpeed: 动画速度</li>\n                </ul>\n              </div>\n            </div>\n          </Section>\n\n          <Section id=\"analysis\" title=\"性能分析\">\n            <div className=\"space-y-4\">\n              <p className=\"text-sm text-muted-foreground\">\n                使用 React Scan 分析器来深入了解组件的渲染性能。\n              </p>\n\n              <div className=\"space-y-2\">\n                <h4 className=\"font-medium\">分析指标：</h4>\n                <ul className=\"list-disc list-inside space-y-1 text-sm\">\n                  <li>渲染次数：组件被渲染的总次数</li>\n                  <li>渲染时间：组件渲染所花费的时间</li>\n                  <li>平均时间：每次渲染的平均时间</li>\n                  <li>效率分数：基于性能的评分</li>\n                </ul>\n              </div>\n            </div>\n          </Section>\n        </TabsContent>\n\n        <TabsContent value=\"examples\" className=\"space-y-4\">\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"text-lg\">代码示例</CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div>\n                <h4 className=\"font-medium mb-2\">基础配置</h4>\n                <div className=\"bg-muted p-4 rounded-lg\">\n                  <pre className=\"text-sm overflow-x-auto\">\n{`import { scan } from 'react-scan';\n\n// 在开发环境中启用\nif (process.env.NODE_ENV === 'development') {\n  scan({\n    enabled: true,\n    showToolbar: true,\n  });\n}`}\n                  </pre>\n                </div>\n              </div>\n\n              <div>\n                <h4 className=\"font-medium mb-2\">组件优化示例</h4>\n                <div className=\"bg-muted p-4 rounded-lg\">\n                  <pre className=\"text-sm overflow-x-auto\">\n{`// 使用 React.memo 优化组件\nconst OptimizedComponent = React.memo(({ data }) => {\n  return <div>{data.name}</div>;\n});\n\n// 使用 useMemo 优化计算\nconst ExpensiveComponent = ({ items }) => {\n  const expensiveValue = useMemo(() => {\n    return items.reduce((sum, item) => sum + item.value, 0);\n  }, [items]);\n\n  return <div>{expensiveValue}</div>;\n};`}\n                  </pre>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        <TabsContent value=\"tips\" className=\"space-y-4\">\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"text-lg\">性能优化技巧</CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div className=\"space-y-3\">\n                <div className=\"border-l-4 border-blue-500 pl-4\">\n                  <h4 className=\"font-medium\">使用 React.memo</h4>\n                  <p className=\"text-sm text-muted-foreground\">\n                    对于纯组件，使用 React.memo 可以避免不必要的重新渲染。\n                  </p>\n                </div>\n\n                <div className=\"border-l-4 border-green-500 pl-4\">\n                  <h4 className=\"font-medium\">优化状态管理</h4>\n                  <p className=\"text-sm text-muted-foreground\">\n                    将状态尽可能靠近使用它的组件，避免不必要的状态传递。\n                  </p>\n                </div>\n\n                <div className=\"border-l-4 border-yellow-500 pl-4\">\n                  <h4 className=\"font-medium\">使用 useMemo 和 useCallback</h4>\n                  <p className=\"text-sm text-muted-foreground\">\n                    对于昂贵的计算和函数，使用这些钩子来避免重复计算。\n                  </p>\n                </div>\n\n                <div className=\"border-l-4 border-red-500 pl-4\">\n                  <h4 className=\"font-medium\">避免内联对象和函数</h4>\n                  <p className=\"text-sm text-muted-foreground\">\n                    在 JSX 中避免创建内联对象和函数，这会导致子组件不必要的重新渲染。\n                  </p>\n                </div>\n              </div>\n\n              <div className=\"pt-4\">\n                <Button variant=\"outline\" className=\"w-full\">\n                  <ExternalLink className=\"h-4 w-4 mr-2\" />\n                  查看更多优化技巧\n                </Button>\n              </div>\n            </CardContent>\n          </Card>\n        </TabsContent>\n      </Tabs>\n    </div>\n  );\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/dev-tools/react-scan-guide.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/dev-tools/react-scan-guide/basics-tab.tsx","messages":[],"suppressedMessages":[{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":198,"column":19,"nodeType":"MemberExpression","endLine":198,"endColumn":32,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/dev-tools/react-scan-guide/colors-tab.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/dev-tools/react-scan-guide/debugging-tab.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/dev-tools/react-scan-guide/optimization-tab.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/dev-tools/react-scan-guide/workflow-tab.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/dev-tools/react-scan-provider.tsx","messages":[{"ruleId":"no-undef","severity":2,"message":"'useDevToolsLayout' is not defined.","line":177,"column":56,"nodeType":"Identifier","messageId":"undef","endLine":177,"endColumn":73},{"ruleId":"no-undef","severity":2,"message":"'useDevToolsLayout' is not defined.","line":223,"column":56,"nodeType":"Identifier","messageId":"undef","endLine":223,"endColumn":73}],"suppressedMessages":[{"ruleId":"no-empty-function","severity":1,"message":"Unexpected empty arrow function.","line":147,"column":22,"nodeType":"ArrowFunctionExpression","messageId":"unexpected","endLine":147,"endColumn":24,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"consistent-return","severity":1,"message":"Arrow function expected no return value.","line":159,"column":5,"nodeType":"ReturnStatement","messageId":"unexpectedReturnValue","endLine":164,"endColumn":7,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport React, { useEffect } from 'react';\nimport { REACT_SCAN_CONFIG } from '@/constants/react-scan';\n\n/**\n * React Scan Provider\n *\n * 负责在开发环境中自动初始化 React Scan 性能监控工具\n * 特点：\n * - 开发环境自动启用，生产环境强制禁用\n * - 跟随开发服务器启用/关闭\n * - 可通过环境变量禁用（NEXT_PUBLIC_DISABLE_REACT_SCAN=true）\n * - 不影响生产构建\n * - 提供实时的 React 组件性能分析\n * - 自定义 Ctrl+Shift+X 快捷键切换功能\n */\nexport function ReactScanProvider({ children }: { children: React.ReactNode }) {\n  useEffect(() => {\n    // 生产环境强制禁用\n    if (process.env.NODE_ENV === 'production') {\n      return;\n    }\n\n    // 非开发环境禁用\n    if (process.env.NODE_ENV !== 'development') {\n      return;\n    }\n\n    // 检查是否明确禁用\n    const explicitlyDisabled =\n      process.env.NEXT_PUBLIC_DISABLE_REACT_SCAN === 'true';\n\n    if (explicitlyDisabled) {\n      console.log(\n        '🔍 React Scan disabled by NEXT_PUBLIC_DISABLE_REACT_SCAN=true',\n      );\n      return;\n    }\n\n    // let reactScanInstance: unknown = null; // TODO: Use when needed\n    let isReactScanEnabled = true;\n\n    // 动态导入并初始化 React Scan\n    const initReactScan = async () => {\n      try {\n        const { scan, setOptions } = await import('react-scan');\n\n        // 初始化 React Scan\n        scan({\n          enabled: true,\n          showToolbar: true,\n          log: false, // 避免控制台噪音，保持日志清洁\n          // trackUnnecessaryRenders: true, // 检测不必要的渲染 - 该选项不存在\n          animationSpeed: 'fast',\n\n          // 自定义回调 - 与现有性能监控系统集成\n          onRender: (fiber, renders) => {\n            // 可以在这里集成到现有的性能监控系统\n            if (renders.length > REACT_SCAN_CONFIG.RENDER_WARNING_THRESHOLD) {\n              console.warn(\n                `🐌 Component ${fiber.type?.name || 'Unknown'} rendered ${renders.length} times`,\n              );\n            }\n          },\n        });\n\n        // 自定义快捷键处理器\n        const handleKeyDown = (event: KeyboardEvent) => {\n          // 检查 Ctrl+Shift+X 组合键\n          if (\n            event.ctrlKey &&\n            event.shiftKey &&\n            event.key.toLowerCase() === 'x'\n          ) {\n            event.preventDefault();\n\n            try {\n              // 切换 React Scan 启用状态\n              isReactScanEnabled = !isReactScanEnabled;\n\n              // 更新 React Scan 选项\n              setOptions({\n                enabled: isReactScanEnabled,\n                showToolbar: isReactScanEnabled,\n              });\n\n              // 提供用户反馈\n              const status = isReactScanEnabled ? 'enabled' : 'disabled';\n              console.log(`🔍 React Scan ${status} via Ctrl+Shift+X`);\n\n              // 可选：显示临时通知\n              if (typeof window !== 'undefined') {\n                const notification = document.createElement('div');\n                notification.textContent = `React Scan ${status}`;\n                notification.style.cssText = `\n                  position: fixed;\n                  top: 20px;\n                  right: 20px;\n                  background: ${isReactScanEnabled ? '#10b981' : '#ef4444'};\n                  color: white;\n                  padding: 12px 16px;\n                  border-radius: 8px;\n                  font-family: system-ui, sans-serif;\n                  font-size: 14px;\n                  font-weight: 500;\n                  z-index: 10000;\n                  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n                  transition: opacity 0.3s ease;\n                `;\n\n                document.body.appendChild(notification);\n\n                // 3秒后移除通知\n                setTimeout(() => {\n                  notification.style.opacity = '0';\n                  setTimeout(() => {\n                    if (notification.parentNode) {\n                      notification.parentNode.removeChild(notification);\n                    }\n                  }, REACT_SCAN_CONFIG.NOTIFICATION_FADE_DURATION);\n                }, REACT_SCAN_CONFIG.NOTIFICATION_DISPLAY_DURATION);\n              }\n            } catch (error) {\n              console.warn('Failed to toggle React Scan:', error);\n            }\n          }\n        };\n\n        // 注册全局键盘事件监听器\n        document.addEventListener('keydown', handleKeyDown, { capture: true });\n\n        console.log(\n          '🔍 React Scan initialized - Performance monitoring active',\n        );\n        console.log('💡 Press Ctrl+Shift+X to toggle React Scan');\n\n        // 返回清理函数\n        return () => {\n          document.removeEventListener('keydown', handleKeyDown, {\n            capture: true,\n          });\n        };\n      } catch (error) {\n        console.warn('Failed to initialize React Scan:', error);\n        // eslint-disable-next-line no-empty-function\n        return () => {}; // 返回空清理函数，错误情况下无需清理\n      }\n    };\n\n    // 执行初始化并保存清理函数\n    let cleanup: (() => void) | undefined;\n    initReactScan().then((cleanupFn) => {\n      cleanup = cleanupFn;\n    });\n\n    // 组件卸载时清理\n    // eslint-disable-next-line consistent-return\n    return () => {\n      // useEffect 清理函数\n      if (cleanup) {\n        cleanup();\n      }\n    };\n  }, []);\n\n  return <>{children}</>;\n}\n\n/**\n * React Scan 状态指示器\n *\n * 在开发环境显示 React Scan 的启用状态\n * 自动跟随开发环境启用，生产环境不显示\n */\nexport function ReactScanIndicator() {\n  const { registerTool, unregisterTool, getClasses } = useDevToolsLayout();\n\n  // 检查是否明确禁用\n  const explicitlyDisabled =\n    process.env.NEXT_PUBLIC_DISABLE_REACT_SCAN === 'true';\n\n  // 注册工具到布局管理器 - 始终调用 Hook\n  useEffect(() => {\n    if (!explicitlyDisabled && process.env.NODE_ENV === 'development') {\n      registerTool('reactScanIndicator');\n      return () => unregisterTool('reactScanIndicator');\n    }\n    return undefined;\n  }, [explicitlyDisabled, registerTool, unregisterTool]);\n\n  // 生产环境不显示\n  if (process.env.NODE_ENV === 'production') {\n    return null;\n  }\n\n  // 非开发环境不显示\n  if (process.env.NODE_ENV !== 'development') {\n    return null;\n  }\n\n  if (explicitlyDisabled) {\n    return null;\n  }\n\n  return (\n    <div\n      className={`${getClasses('reactScanIndicator')} flex items-center gap-2 rounded-md bg-blue-500 px-3 py-2 text-xs text-white shadow-lg`}\n    >\n      <div className='h-2 w-2 animate-pulse rounded-full bg-white'></div>\n      <span>🔍 React Scan Active</span>\n    </div>\n  );\n}\n\n/**\n * React Scan 控制面板\n *\n * 提供开发环境中的 React Scan 控制选项\n * 自动跟随开发环境启用，生产环境不显示\n */\nexport function ReactScanControlPanel() {\n  const { registerTool, unregisterTool, getClasses } = useDevToolsLayout();\n\n  // 检查是否明确禁用\n  const explicitlyDisabled =\n    process.env.NEXT_PUBLIC_DISABLE_REACT_SCAN === 'true';\n\n  // 注册工具到布局管理器 - 始终调用 Hook\n  useEffect(() => {\n    if (!explicitlyDisabled && process.env.NODE_ENV === 'development') {\n      registerTool('reactScanControlPanel');\n      return () => unregisterTool('reactScanControlPanel');\n    }\n    return undefined;\n  }, [explicitlyDisabled, registerTool, unregisterTool]);\n\n  // 生产环境不显示\n  if (process.env.NODE_ENV === 'production') {\n    return null;\n  }\n\n  // 非开发环境不显示\n  if (process.env.NODE_ENV !== 'development') {\n    return null;\n  }\n\n  if (explicitlyDisabled) {\n    return null;\n  }\n\n  return (\n    <div\n      className={`${getClasses('reactScanControlPanel')} rounded-lg bg-gray-900 p-4 text-white shadow-xl`}\n    >\n      <h3 className='mb-2 text-sm font-semibold'>React Scan Controls</h3>\n      <div className='space-y-2 text-xs'>\n        <div>\n          • Press <kbd className='rounded bg-gray-700 px-1'>Ctrl+Shift+X</kbd>{' '}\n          to toggle scanning\n        </div>\n        <div>• Red highlights = unnecessary renders</div>\n        <div>• Green highlights = optimized renders</div>\n        <div>• Use toolbar to inspect components</div>\n      </div>\n    </div>\n  );\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/error-boundary.tsx","messages":[],"suppressedMessages":[{"ruleId":"no-console","severity":2,"message":"Unexpected console statement.","line":52,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":52,"endColumn":20,"suggestions":[{"fix":{"range":[1303,1369],"text":""},"messageId":"removeConsole","data":{"propertyName":"error"},"desc":"Remove the console.error()."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/examples/ui-showcase-sections.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/examples/ui-showcase.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/examples/ui-showcase/implementation-summary.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/examples/ui-showcase/theme-toggle-demo.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/examples/ui-showcase/theme-toggle-demo/animation-variants.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/examples/ui-showcase/theme-toggle-demo/feature-variants.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/examples/ui-showcase/theme-toggle-demo/size-variants.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/examples/ui-showcase/theme-toggle-demo/technical-comparison.tsx","messages":[{"ruleId":"react-you-might-not-need-an-effect/no-chain-state-updates","severity":2,"message":"Avoid chaining state changes. When possible, update all relevant state simultaneously.","line":14,"column":5,"nodeType":"CallExpression","messageId":"avoidChainingStateUpdates","endLine":14,"endColumn":21}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useEffect, useState } from 'react';\n\n/**\n * 技术对比组件\n */\nexport function TechnicalComparison() {\n  const [supportsViewTransitions, setSupportsViewTransitions] = useState(false);\n  const [mounted, setMounted] = useState(false);\n\n  // 检测浏览器支持\n  useEffect(() => {\n    setMounted(true);\n    setSupportsViewTransitions('startViewTransition' in document);\n  }, [setMounted, setSupportsViewTransitions]);\n\n  return (\n    <div className=\"bg-muted/50 p-6 rounded-lg space-y-4\">\n      <h4 className=\"font-semibold mb-3\">✨ 动画技术对比</h4>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n        {/* Circle Blur 动画特性 */}\n        <div className=\"space-y-3\">\n          <h5 className=\"font-medium text-blue-600 dark:text-blue-400 flex items-center gap-2\">\n            🌀 Circle Blur 动画\n            <span className=\"text-xs bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 px-2 py-1 rounded-full\">\n              现代浏览器\n            </span>\n          </h5>\n          <ul className=\"text-sm space-y-1 text-muted-foreground\">\n            <li>• 基于 View Transition API 实现</li>\n            <li>• 圆形展开动画：clip-path: circle()</li>\n            <li>• 模糊过渡效果：filter: blur(8px → 0px)</li>\n            <li>• 动态定位：基于点击位置计算中心点</li>\n            <li>• 动画时长：0.6s cubic-bezier(0.4, 0, 0.2, 1)</li>\n            <li>• 自动降级：不支持时回退到普通切换</li>\n          </ul>\n        </div>\n\n        {/* Framer Motion 动画特性 */}\n        <div className=\"space-y-3\">\n          <h5 className=\"font-medium text-purple-600 dark:text-purple-400 flex items-center gap-2\">\n            🎯 Framer Motion 动画\n            <span className=\"text-xs bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300 px-2 py-1 rounded-full\">\n              兼容性好\n            </span>\n          </h5>\n          <ul className=\"text-sm space-y-1 text-muted-foreground\">\n            <li>• 基于 Framer Motion 库实现</li>\n            <li>• 背景滑动动画：layoutId 共享元素</li>\n            <li>• Spring 动画参数：duration: 0.5s, bounce: 0.2</li>\n            <li>• 广泛的浏览器支持</li>\n            <li>• 性能优化：GPU 加速</li>\n            <li>• 完整的手势支持</li>\n          </ul>\n        </div>\n      </div>\n\n      {/* 通用特性 */}\n      <div className=\"border-_t pt-4\">\n        <h5 className=\"font-medium mb-2\">🛡️ 通用特性</h5>\n        <ul className=\"text-sm space-y-1 text-muted-foreground grid grid-cols-1 md:grid-cols-2 gap-x-6\">\n          <li>• 支持 prefers-reduced-motion 检测</li>\n          <li>• 完整的无障碍性支持和键盘导航</li>\n          <li>• TypeScript 类型安全</li>\n          <li>• 响应式设计适配</li>\n          <li>• 主题系统集成</li>\n          <li>• 国际化支持</li>\n        </ul>\n      </div>\n\n      {/* 浏览器支持说明 */}\n      <div className=\"bg-amber-50 dark:bg-amber-950/20 border border-amber-200 dark:border-amber-800 p-4 rounded-lg\">\n        <div className=\"flex items-center justify-between mb-3\">\n          <h5 className=\"font-medium text-amber-800 dark:text-amber-200\">\n            🌐 浏览器支持说明\n          </h5>\n          {mounted && (\n            <div className=\"flex items-center gap-2\">\n              <span className=\"text-xs text-amber-700 dark:text-amber-300\">当前浏览器：</span>\n              <span className={`text-xs px-2 py-1 rounded-full font-medium ${\n                supportsViewTransitions\n                  ? 'bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300'\n                  : 'bg-orange-100 dark:bg-orange-900/30 text-orange-700 dark:text-orange-300'\n              }`}>\n                {supportsViewTransitions ? '✅ 支持 Circle Blur' : '⚠️ 仅支持 Framer Motion'}\n              </span>\n            </div>\n          )}\n        </div>\n        <div className=\"text-sm text-amber-700 dark:text-amber-300 space-y-1\">\n          <p><strong>Circle Blur 动画：</strong>需要支持 View Transition API（Chrome 111+, Edge 111+）</p>\n          <p><strong>Framer Motion 动画：</strong>支持所有现代浏览器（Chrome, Firefox, Safari, Edge）</p>\n          <p><strong>自动降级：</strong>不支持的浏览器会自动使用普通主题切换</p>\n        </div>\n      </div>\n    </div>\n  );\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/forms/__tests__/contact-form-container-core.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/forms/__tests__/contact-form-container.test.tsx","messages":[],"suppressedMessages":[{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":41,"column":68,"nodeType":"MemberExpression","endLine":41,"endColumn":85,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/forms/__tests__/contact-form-fields-core.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/forms/__tests__/contact-form-fields.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/forms/__tests__/contact-form-submission.test.tsx","messages":[],"suppressedMessages":[{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":60,"column":10,"nodeType":"MemberExpression","endLine":60,"endColumn":27,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/forms/__tests__/contact-form-validation.test.tsx","messages":[],"suppressedMessages":[{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":57,"column":10,"nodeType":"MemberExpression","endLine":57,"endColumn":27,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/forms/contact-form-container.tsx","messages":[{"ruleId":"max-params","severity":2,"message":"Async function 'handleFormSubmission' has too many parameters (5). Maximum allowed is 3.","line":72,"column":1,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":72,"endColumn":36}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState } from 'react';\nimport { zodResolver } from '@hookform/resolvers/zod';\nimport { Turnstile } from '@marsidev/react-turnstile';\nimport { useTranslations } from 'next-intl';\nimport { useForm } from 'react-hook-form';\nimport { logger } from '@/lib/logger';\nimport {\n  ContactFormData,\n  contactFormSchema,\n  FormSubmissionStatus,\n} from '@/lib/validations';\nimport { Button } from '@/components/ui/button';\nimport { Card } from '@/components/ui/card';\nimport {\n  AdditionalFields,\n  CheckboxFields,\n  ContactFields,\n  NameFields,\n} from './contact-form-fields';\n\n/**\n * Status message component\n */\ninterface StatusMessageProps {\n  status: FormSubmissionStatus;\n  t: (_key: string) => string;\n}\n\nfunction StatusMessage({ status, t }: StatusMessageProps) {\n  if (status === 'idle') return null;\n\n  const statusConfig: Record<\n    FormSubmissionStatus,\n    { className: string; message: string } | undefined\n  > = {\n    success: {\n      className: 'bg-green-50 border-green-200 text-green-800',\n      message: t('submitSuccess'),\n    },\n    error: {\n      className: 'bg-red-50 border-red-200 text-red-800',\n      message: t('submitError'),\n    },\n    submitting: {\n      className: 'bg-blue-50 border-blue-200 text-blue-800',\n      message: t('submitting'),\n    },\n    idle: undefined,\n  };\n\n  // Use Object.prototype.hasOwnProperty to safely access object properties\n  const config = Object.prototype.hasOwnProperty.call(statusConfig, status)\n    ? statusConfig[status as keyof typeof statusConfig]\n    : undefined;\n  if (!config) return null;\n\n  return (\n    <div\n      className={`rounded-md border p-4 ${config.className}`}\n      role='alert'\n    >\n      {config.message}\n    </div>\n  );\n}\n\n/**\n * Form submission handler\n */\nasync function handleFormSubmission(\n  data: ContactFormData,\n  turnstileToken: string,\n  setSubmitStatus: (_status: FormSubmissionStatus) => void,\n  setLastSubmissionTime: (_time: Date) => void,\n  reset: () => void,\n) {\n  try {\n    setSubmitStatus('submitting');\n\n    // Rate limiting check\n    const submissionData = {\n      ...data,\n      turnstileToken,\n      submittedAt: new Date().toISOString(),\n    };\n\n    const response = await fetch('/api/contact', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(submissionData),\n    });\n\n    if (!response.ok) {\n      const errorData = await response.json().catch(() => ({}));\n      throw new Error(errorData.message || `HTTP ${response.status}`);\n    }\n\n    const result = await response.json();\n\n    if (result.success) {\n      setSubmitStatus('success');\n      setLastSubmissionTime(new Date());\n      reset();\n\n      // Log successful submission\n      logger.info('Contact form submitted successfully', {\n        timestamp: new Date().toISOString(),\n        userAgent: navigator.userAgent,\n      });\n    } else {\n      throw new Error(result.message || 'Submission failed');\n    }\n  } catch (error) {\n    setSubmitStatus('error');\n\n    // Log submission error\n    logger.error('Contact form submission failed', {\n      error: error instanceof Error ? error.message : 'Unknown error',\n      timestamp: new Date().toISOString(),\n    });\n  }\n}\n\n/**\n * 自定义Hook：管理联系表单状态和逻辑\n */\nfunction useContactForm() {\n  const [submitStatus, setSubmitStatus] =\n    useState<FormSubmissionStatus>('idle');\n  const [turnstileToken, setTurnstileToken] = useState<string>('');\n  const [lastSubmissionTime, setLastSubmissionTime] = useState<Date | null>(\n    null,\n  );\n\n  // React Hook Form setup\n  const form = useForm<ContactFormData>({\n    resolver: zodResolver(contactFormSchema),\n    defaultValues: {\n      firstName: '',\n      lastName: '',\n      email: '',\n      company: '',\n      phone: '',\n      subject: '',\n      message: '',\n      acceptPrivacy: false,\n      marketingConsent: false,\n    },\n  });\n\n  const watchedValues = form.watch();\n\n  // Form submission handler\n  const onSubmit = async (data: ContactFormData) => {\n    if (!turnstileToken) {\n      setSubmitStatus('error');\n      return;\n    }\n\n    await handleFormSubmission(\n      data,\n      turnstileToken,\n      setSubmitStatus,\n      setLastSubmissionTime,\n      form.reset,\n    );\n  };\n\n  // Rate limiting check (5 minutes = 300000ms)\n  const RATE_LIMIT_MINUTES = 5;\n  const SECONDS_PER_MINUTE = 60;\n  const MS_PER_SECOND = 1000;\n  const RATE_LIMIT_WINDOW =\n    RATE_LIMIT_MINUTES * SECONDS_PER_MINUTE * MS_PER_SECOND;\n  const isRateLimited =\n    lastSubmissionTime &&\n    Date.now() - lastSubmissionTime.getTime() < RATE_LIMIT_WINDOW;\n\n  return {\n    form,\n    submitStatus,\n    turnstileToken,\n    setTurnstileToken,\n    watchedValues,\n    onSubmit,\n    isRateLimited,\n  };\n}\n\n/**\n * Main contact form container component\n */\nexport function ContactFormContainer() {\n  const t = useTranslations('contact.form');\n  const {\n    form,\n    submitStatus,\n    turnstileToken,\n    setTurnstileToken,\n    watchedValues,\n    onSubmit,\n    isRateLimited,\n  } = useContactForm();\n\n  const {\n    register,\n    handleSubmit,\n    formState: { errors, isSubmitting },\n    setValue,\n  } = form;\n\n  return (\n    <Card className='mx-auto w-full max-w-2xl'>\n      <form\n        onSubmit={handleSubmit(onSubmit)}\n        className='space-y-6 p-6'\n      >\n        <StatusMessage\n          status={submitStatus}\n          t={t}\n        />\n\n        <NameFields\n          register={register}\n          errors={errors}\n          isSubmitting={isSubmitting}\n          t={t}\n        />\n        <ContactFields\n          register={register}\n          errors={errors}\n          isSubmitting={isSubmitting}\n          t={t}\n        />\n        <AdditionalFields\n          register={register}\n          errors={errors}\n          isSubmitting={isSubmitting}\n          t={t}\n        />\n        <CheckboxFields\n          errors={errors}\n          isSubmitting={isSubmitting}\n          watchedValues={watchedValues}\n          setValue={setValue}\n          t={t}\n        />\n\n        {/* Turnstile CAPTCHA */}\n        <div className='space-y-2'>\n          <Turnstile\n            siteKey={process.env.NEXT_PUBLIC_TURNSTILE_SITE_KEY || ''}\n            onSuccess={setTurnstileToken}\n            onError={() => setTurnstileToken('')}\n            onExpire={() => setTurnstileToken('')}\n            options={{\n              theme: 'auto',\n              size: 'normal',\n            }}\n          />\n        </div>\n\n        {/* Submit button */}\n        <Button\n          type='submit'\n          disabled={Boolean(isSubmitting || !turnstileToken || isRateLimited)}\n          className='w-full'\n        >\n          {isSubmitting ? t('submitting') : t('submit')}\n        </Button>\n\n        {isRateLimited && (\n          <p className='text-center text-sm text-amber-600'>\n            {t('rateLimitMessage')}\n          </p>\n        )}\n      </form>\n    </Card>\n  );\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/forms/contact-form-fields.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/forms/contact-form.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/forms/fields/additional-fields.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/forms/fields/checkbox-fields.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/forms/fields/contact-fields.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/forms/fields/name-fields.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/home/__tests__/call-to-action-basic.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/home/__tests__/call-to-action-interaction.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/home/__tests__/call-to-action.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/home/__tests__/hero-section.test.tsx","messages":[],"suppressedMessages":[{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":90,"column":10,"nodeType":"MemberExpression","endLine":90,"endColumn":27,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/home/__tests__/project-overview.test.tsx","messages":[{"ruleId":"no-undef","severity":2,"message":"'asChild' is not defined.","line":68,"column":9,"nodeType":"Identifier","messageId":"undef","endLine":68,"endColumn":16},{"ruleId":"no-undef","severity":2,"message":"'children' is not defined.","line":74,"column":12,"nodeType":"Identifier","messageId":"undef","endLine":74,"endColumn":20},{"ruleId":"no-undef","severity":2,"message":"'children' is not defined.","line":83,"column":10,"nodeType":"Identifier","messageId":"undef","endLine":83,"endColumn":18}],"suppressedMessages":[{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":178,"column":10,"nodeType":"MemberExpression","endLine":178,"endColumn":27,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { render, screen } from '@testing-library/react';\nimport { afterEach, beforeEach, describe, expect, it, vi } from 'vitest';\n// Import the component after mocks\nimport { ProjectOverview } from '../project-overview';\n\n// Mock next-intl\nconst mockUseTranslations = vi.hoisted(() => vi.fn());\nvi.mock('next-intl', () => ({\n  useTranslations: mockUseTranslations,\n}));\n\n// Mock intersection observer hook\nconst mockUseIntersectionObserver = vi.hoisted(() => vi.fn());\nvi.mock('@/hooks/use-intersection-observer', () => ({\n  useIntersectionObserver: mockUseIntersectionObserver,\n}));\n\n// Mock site config\nvi.mock('@/lib/site-config', () => ({\n  PROJECT_STATS: {\n    performance: {\n      grade: 'A+',\n      securityScore: '95%',\n      languages: 2,\n    },\n  },\n  TECH_ARCHITECTURE: {\n    frontend: {\n      title: 'Frontend',\n      technologies: ['Next.js 15', 'React 19', 'TypeScript', 'Tailwind CSS'],\n      color: 'blue',\n    },\n    ui: {\n      title: 'UI System',\n      technologies: ['shadcn/ui', 'Radix UI', 'Lucide Icons', 'CSS Variables'],\n      color: 'green',\n    },\n    tooling: {\n      title: 'Development',\n      technologies: ['ESLint', 'Prettier', 'Husky', 'Jest'],\n      color: 'purple',\n    },\n  },\n}));\n\n// Mock UI components\nvi.mock('@/components/ui/badge', () => ({\n  Badge: ({ children, ...props }: React.ComponentProps<\"div\">) => (\n    <span\n      data-testid='badge'\n      {...props}\n    >\n      {children}\n    </span>\n  ),\n}));\n\nvi.mock('@/components/ui/button', () => ({\n  Button: (props: React.PropsWithChildren<{\n    variant?: string;\n    size?: string;\n    className?: string;\n    onClick?: () => void;\n    disabled?: boolean;\n    [key: string]: unknown;\n  }>) => {\n    if (asChild) {\n      return (\n        <div\n          data-testid='button'\n          {...props}\n        >\n          {children}\n        </div>\n      );\n    }\n    return (\n      <button\n        data-testid='button'\n        {...props}\n      >\n        {children}\n      </button>\n    );\n  },\n}));\n\nvi.mock('@/components/ui/card', () => ({\n  Card: ({ children, ...props }: React.ComponentProps<\"div\">) => (\n    <div\n      data-testid='card'\n      {...props}\n    >\n      {children}\n    </div>\n  ),\n  CardContent: ({ children, ...props }: React.ComponentProps<\"div\">) => (\n    <div\n      data-testid='card-content'\n      {...props}\n    >\n      {children}\n    </div>\n  ),\n  CardDescription: ({ children, ...props }: React.ComponentProps<\"div\">) => (\n    <div\n      data-testid='card-description'\n      {...props}\n    >\n      {children}\n    </div>\n  ),\n  CardHeader: ({ children, ...props }: React.ComponentProps<\"div\">) => (\n    <div\n      data-testid='card-header'\n      {...props}\n    >\n      {children}\n    </div>\n  ),\n  CardTitle: ({ children, ...props }: React.ComponentProps<\"div\">) => (\n    <div\n      data-testid='card-title'\n      {...props}\n    >\n      {children}\n    </div>\n  ),\n}));\n\n// Mock Lucide React icons\nvi.mock('lucide-react', () => ({\n  ArrowRight: () => <div data-testid='arrow-right-icon'>ArrowRight</div>,\n  CheckCircle: () => <div data-testid='check-circle-icon'>CheckCircle</div>,\n  Code: () => <div data-testid='code-icon'>Code</div>,\n  ExternalLink: () => <div data-testid='external-link-icon'>ExternalLink</div>,\n  Globe: () => <div data-testid='globe-icon'>Globe</div>,\n  Palette: () => <div data-testid='palette-icon'>Palette</div>,\n  Rocket: () => <div data-testid='rocket-icon'>Rocket</div>,\n  Shield: () => <div data-testid='shield-icon'>Shield</div>,\n  Zap: () => <div data-testid='zap-icon'>Zap</div>,\n}));\n\ndescribe('ProjectOverview', () => {\n  // Mock translation function\n  const mockT = vi.fn((key: string) => {\n    const translations: Record<string, string> = {\n      'title': 'Project Overview',\n      'subtitle': 'Comprehensive analysis of our modern tech stack',\n      'features.performance.title': 'High Performance',\n      'features.performance.description': 'Optimized for speed and efficiency',\n      'features.security.title': 'Security First',\n      'features.security.description': 'Built with security best practices',\n      'features.i18n.title': 'Internationalization',\n      'features.i18n.description': 'Multi-language support',\n      'features.themes.title': 'Theme Support',\n      'features.themes.description': 'Light and dark themes',\n      'highlights.title': 'Project Highlights',\n      'highlights.subtitle': 'Key features and benefits',\n      'highlights.modern': 'Modern Architecture',\n      'highlights.scalable': 'Highly Scalable',\n      'highlights.accessible': 'Accessibility First',\n      'highlights.performant': 'High Performance',\n      'highlights.secure': 'Security Focused',\n      'highlights.maintainable': 'Easy to Maintain',\n      'architecture.title': 'Tech Architecture',\n      'architecture.subtitle': 'Modern stack for enterprise applications',\n      'architecture.frontend.description': 'Modern frontend technologies',\n      'architecture.ui.description': 'Comprehensive UI system',\n      'architecture.tooling.description': 'Development tools and workflow',\n      'cta.title': 'Get Started',\n      'cta.description': 'Ready to build something amazing?',\n      'cta.getStarted': 'Get Started',\n      'cta.viewSource': 'View Source Code',\n    };\n    // eslint-disable-next-line security/detect-object-injection\n  return translations[key] || key; // key 来自测试数据，安全\n  });\n\n  beforeEach(() => {\n    vi.clearAllMocks();\n\n    // Setup default mocks\n    mockUseTranslations.mockReturnValue(mockT);\n    mockUseIntersectionObserver.mockReturnValue({\n      ref: vi.fn(),\n      isVisible: true,\n    });\n  });\n\n  afterEach(() => {\n    vi.clearAllMocks();\n  });\n\n  describe('Basic Rendering', () => {\n    it('should render project overview without errors', () => {\n      render(<ProjectOverview />);\n\n      expect(screen.getByText('Project Overview')).toBeInTheDocument();\n    });\n\n    it('should render main title and subtitle', () => {\n      render(<ProjectOverview />);\n\n      expect(screen.getByText('Project Overview')).toBeInTheDocument();\n      expect(\n        screen.getByText('Comprehensive analysis of our modern tech stack'),\n      ).toBeInTheDocument();\n    });\n  });\n\n  describe('Feature Grid', () => {\n    it('should render all feature cards', () => {\n      render(<ProjectOverview />);\n\n      // Use getAllByText to handle multiple occurrences\n      const highPerformanceElements = screen.getAllByText('High Performance');\n      expect(highPerformanceElements.length).toBeGreaterThan(0);\n\n      expect(screen.getByText('Security First')).toBeInTheDocument();\n      expect(screen.getByText('Internationalization')).toBeInTheDocument();\n      expect(screen.getByText('Theme Support')).toBeInTheDocument();\n    });\n\n    it('should render feature icons', () => {\n      render(<ProjectOverview />);\n\n      expect(screen.getByTestId('zap-icon')).toBeInTheDocument();\n      expect(screen.getByTestId('shield-icon')).toBeInTheDocument();\n      expect(screen.getByTestId('globe-icon')).toBeInTheDocument();\n      expect(screen.getByTestId('palette-icon')).toBeInTheDocument();\n    });\n\n    it('should render feature badges', () => {\n      render(<ProjectOverview />);\n\n      const badges = screen.getAllByTestId('badge');\n      expect(badges.length).toBeGreaterThan(0);\n\n      // Check for specific badge content\n      expect(screen.getByText('A+')).toBeInTheDocument();\n      expect(screen.getByText('95%')).toBeInTheDocument();\n    });\n  });\n\n  describe('Tech Architecture', () => {\n    it('should render architecture section', () => {\n      render(<ProjectOverview />);\n\n      // Check if architecture section exists by looking for technology items\n      expect(screen.getByText('Next.js 15')).toBeInTheDocument();\n    });\n\n    it('should render architecture categories', () => {\n      render(<ProjectOverview />);\n\n      // Check for technology items instead of category titles\n      expect(screen.getByText('Next.js 15')).toBeInTheDocument();\n      expect(screen.getByText('shadcn/ui')).toBeInTheDocument();\n      expect(screen.getByText('ESLint')).toBeInTheDocument();\n    });\n\n    it('should render technology items', () => {\n      render(<ProjectOverview />);\n\n      expect(screen.getByText('Next.js 15')).toBeInTheDocument();\n      expect(screen.getByText('React 19')).toBeInTheDocument();\n      expect(screen.getByText('TypeScript')).toBeInTheDocument();\n      expect(screen.getByText('shadcn/ui')).toBeInTheDocument();\n      expect(screen.getByText('ESLint')).toBeInTheDocument();\n    });\n  });\n\n  describe('Call to Action', () => {\n    it('should render CTA buttons', () => {\n      render(<ProjectOverview />);\n\n      // Use getAllByText to handle multiple occurrences\n      const getStartedElements = screen.getAllByText('Get Started');\n      expect(getStartedElements.length).toBeGreaterThan(0);\n\n      expect(screen.getByText('View Source Code')).toBeInTheDocument();\n    });\n\n    it('should render CTA icons', () => {\n      render(<ProjectOverview />);\n\n      expect(screen.getByTestId('arrow-right-icon')).toBeInTheDocument();\n      expect(screen.getByTestId('external-link-icon')).toBeInTheDocument();\n    });\n  });\n\n  describe('Animation Integration', () => {\n    it('should use intersection observer for animations', () => {\n      render(<ProjectOverview />);\n\n      // Verify intersection observer is called for animated sections\n      expect(mockUseIntersectionObserver).toHaveBeenCalled();\n    });\n  });\n\n  describe('Internationalization', () => {\n    it('should use translations for all text content', () => {\n      render(<ProjectOverview />);\n\n      expect(mockT).toHaveBeenCalledWith('title');\n      expect(mockT).toHaveBeenCalledWith('subtitle');\n      expect(mockT).toHaveBeenCalledWith('features.performance.title');\n      expect(mockT).toHaveBeenCalledWith('features.security.title');\n      expect(mockT).toHaveBeenCalledWith('architecture.title');\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/home/__tests__/tech-stack-section.test.tsx","messages":[{"ruleId":"no-undef","severity":2,"message":"'asChild' is not defined.","line":95,"column":9,"nodeType":"Identifier","messageId":"undef","endLine":95,"endColumn":16},{"ruleId":"no-undef","severity":2,"message":"'className' is not defined.","line":99,"column":22,"nodeType":"Identifier","messageId":"undef","endLine":99,"endColumn":31},{"ruleId":"no-undef","severity":2,"message":"'children' is not defined.","line":102,"column":12,"nodeType":"Identifier","messageId":"undef","endLine":102,"endColumn":20},{"ruleId":"no-undef","severity":2,"message":"'className' is not defined.","line":109,"column":20,"nodeType":"Identifier","messageId":"undef","endLine":109,"endColumn":29},{"ruleId":"no-undef","severity":2,"message":"'onClick' is not defined.","line":110,"column":18,"nodeType":"Identifier","messageId":"undef","endLine":110,"endColumn":25},{"ruleId":"no-undef","severity":2,"message":"'children' is not defined.","line":113,"column":10,"nodeType":"Identifier","messageId":"undef","endLine":113,"endColumn":18}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { fireEvent, render, screen } from '@testing-library/react';\nimport { beforeEach, describe, expect, it, vi } from 'vitest';\n// 导入要测试的组件\nimport { TechStackSection } from '../tech-stack-section';\n\n// Mock配置 - 使用vi.hoisted确保Mock在模块导入前设置\nconst {\n  mockUseTranslations,\n  mockUseIntersectionObserver,\n  mockUseState,\n  mockUseMemo,\n} = vi.hoisted(() => ({\n  mockUseTranslations: vi.fn(),\n  mockUseIntersectionObserver: vi.fn(),\n  mockUseState: vi.fn(),\n  mockUseMemo: vi.fn(),\n}));\n\n// Mock next-intl\nvi.mock('next-intl', () => ({\n  useTranslations: mockUseTranslations,\n}));\n\n// Mock intersection observer hook\nvi.mock('@/hooks/use-intersection-observer', () => ({\n  useIntersectionObserver: mockUseIntersectionObserver,\n}));\n\n// Mock React hooks\nvi.mock('react', async () => {\n  const actual = await vi.importActual('react');\n  return {\n    ...actual,\n    useState: mockUseState,\n    useMemo: mockUseMemo,\n  };\n});\n\n// Mock Lucide React icons\nvi.mock('lucide-react', () => ({\n  ExternalLink: () => <div data-testid='external-link-icon'>ExternalLink</div>,\n}));\n\n// Mock tech stack data\nvi.mock('@/lib/tech-stack-data', () => ({\n  techStackCategories: {\n    core: 'Core Technologies',\n    frontend: 'Frontend',\n    backend: 'Backend',\n    tools: 'Development Tools',\n  },\n  techStackData: [\n    {\n      id: 'nextjs',\n      name: 'Next.js',\n      category: 'core',\n      description: 'React framework',\n      url: 'https://nextjs.org',\n      icon: 'nextjs',\n    },\n    {\n      id: 'react',\n      name: 'React',\n      category: 'frontend',\n      description: 'UI library',\n      url: 'https://react.dev',\n      icon: 'react',\n    },\n  ],\n}));\n\n// Mock UI components\nvi.mock('@/components/ui/badge', () => ({\n  Badge: ({ children, className, ...props }: React.ComponentProps<\"div\">) => (\n    <span\n      data-testid='badge'\n      className={className}\n      {...props}\n    >\n      {children}\n    </span>\n  ),\n}));\n\nvi.mock('@/components/ui/button', () => ({\n  Button: (props: React.PropsWithChildren<{\n    variant?: string;\n    size?: string;\n    className?: string;\n    onClick?: () => void;\n    disabled?: boolean;\n    [key: string]: unknown;\n  }>) => {\n    if (asChild) {\n      return (\n        <div\n          data-testid='button-as-child'\n          className={className}\n          {...props}\n        >\n          {children}\n        </div>\n      );\n    }\n    return (\n      <button\n        data-testid='button'\n        className={className}\n        onClick={onClick}\n        {...props}\n      >\n        {children}\n      </button>\n    );\n  },\n}));\n\nvi.mock('@/components/ui/card', () => ({\n  Card: ({ children, className, ...props }: React.ComponentProps<\"div\">) => (\n    <div\n      data-testid='card'\n      className={className}\n      {...props}\n    >\n      {children}\n    </div>\n  ),\n  CardContent: ({ children, className, ...props }: React.ComponentProps<\"div\">) => (\n    <div\n      data-testid='card-content'\n      className={className}\n      {...props}\n    >\n      {children}\n    </div>\n  ),\n  CardDescription: ({ children, className, ...props }: React.ComponentProps<\"div\">) => (\n    <div\n      data-testid='card-description'\n      className={className}\n      {...props}\n    >\n      {children}\n    </div>\n  ),\n  CardHeader: ({ children, className, ...props }: React.ComponentProps<\"div\">) => (\n    <div\n      data-testid='card-header'\n      className={className}\n      {...props}\n    >\n      {children}\n    </div>\n  ),\n  CardTitle: ({ children, className, ...props }: React.ComponentProps<\"div\">) => (\n    <div\n      data-testid='card-title'\n      className={className}\n      {...props}\n    >\n      {children}\n    </div>\n  ),\n}));\n\nvi.mock('@/components/ui/tabs', () => ({\n  Tabs: ({ children, value, onValueChange, className, ...props }: React.ComponentProps<\"div\">) => (\n    <div\n      data-testid='tabs'\n      data-value={value}\n      className={className}\n      {...props}\n      onClick={() => onValueChange && onValueChange('frontend')}\n    >\n      {children}\n    </div>\n  ),\n  TabsContent: ({ children, value, className, ...props }: React.ComponentProps<\"div\">) => (\n    <div\n      data-testid='tabs-content'\n      data-value={value}\n      className={className}\n      {...props}\n    >\n      {children}\n    </div>\n  ),\n  TabsList: ({ children, className, ...props }: React.ComponentProps<\"div\">) => (\n    <div\n      data-testid='tabs-list'\n      className={className}\n      {...props}\n    >\n      {children}\n    </div>\n  ),\n  TabsTrigger: ({ children, value, className, ...props }: React.ComponentProps<\"div\">) => (\n    <button\n      data-testid='tabs-trigger'\n      data-value={value}\n      className={className}\n      {...props}\n    >\n      {children}\n    </button>\n  ),\n}));\n\ndescribe('TechStackSection', () => {\n  // 默认Mock返回值\n  const defaultTranslations = {\n    'title': 'Tech Stack',\n    'subtitle': 'Modern technologies we use',\n    'stats.totalTech': 'Total Technologies',\n    'stats.categories': 'Categories',\n    'stats.modern': 'Modern',\n    'stats.quality': 'Quality',\n    'learnMore': 'Learn More',\n    'categories.core': 'Core',\n    'categories.frontend': 'Frontend',\n    'categories.backend': 'Backend',\n    'categories.tools': 'Tools',\n  };\n\n  const defaultIntersectionObserver = {\n    ref: vi.fn(),\n    isVisible: true,\n  };\n\n  beforeEach(() => {\n    vi.clearAllMocks();\n\n    // 设置默认Mock返回值 - 修复：useTranslations应该返回一个函数\n    const mockTranslationFunction = vi.fn((key: string) => {\n      return (\n        defaultTranslations[key as keyof typeof defaultTranslations] || key\n      );\n    });\n    mockUseTranslations.mockReturnValue(mockTranslationFunction);\n    mockUseIntersectionObserver.mockReturnValue(defaultIntersectionObserver);\n    mockUseState.mockImplementation((initial) => [initial, vi.fn()]);\n    mockUseMemo.mockImplementation((fn) => fn());\n  });\n\n  describe('基础渲染测试', () => {\n    it('应该正确渲染组件的基本结构', () => {\n      render(<TechStackSection />);\n\n      // 验证主要结构元素 - 修复：使用正确的选择器\n      expect(\n        screen.getByRole('heading', { name: 'Tech Stack' }),\n      ).toBeInTheDocument();\n      expect(screen.getByText('Tech Stack')).toBeInTheDocument();\n      expect(\n        screen.getByText('Modern technologies we use'),\n      ).toBeInTheDocument();\n    });\n\n    it('应该渲染统计信息', () => {\n      render(<TechStackSection />);\n\n      // 验证统计数据\n      expect(screen.getByText('2')).toBeInTheDocument(); // techStackData.length\n      expect(screen.getByText('4')).toBeInTheDocument(); // categories count\n      expect(screen.getByText('100%')).toBeInTheDocument();\n      expect(screen.getByText('A+')).toBeInTheDocument();\n\n      // 验证统计标签\n      expect(screen.getByText('Total Technologies')).toBeInTheDocument();\n      expect(screen.getByText('Categories')).toBeInTheDocument();\n      expect(screen.getByText('Modern')).toBeInTheDocument();\n      expect(screen.getByText('Quality')).toBeInTheDocument();\n    });\n\n    it('应该渲染技术栈标签页', () => {\n      render(<TechStackSection />);\n\n      // 验证标签页组件存在\n      expect(screen.getByTestId('tabs')).toBeInTheDocument();\n      expect(screen.getByTestId('tabs-list')).toBeInTheDocument();\n    });\n  });\n\n  describe('交互功能测试', () => {\n    it('应该处理标签页切换', () => {\n      const mockSetState = vi.fn();\n      mockUseState.mockReturnValue(['core', mockSetState]);\n\n      render(<TechStackSection />);\n\n      const tabs = screen.getByTestId('tabs');\n      fireEvent.click(tabs);\n\n      // 验证状态更新被调用\n      expect(mockSetState).toHaveBeenCalled();\n    });\n  });\n\n  describe('动画和可见性测试', () => {\n    it('应该处理元素可见时的动画', () => {\n      mockUseIntersectionObserver.mockReturnValue({\n        ref: vi.fn(),\n        isVisible: true,\n      });\n\n      render(<TechStackSection />);\n\n      // 验证可见状态下的CSS类\n      const titleElement = screen.getByText('Tech Stack').closest('div');\n      expect(titleElement).toHaveClass('translate-y-0', 'opacity-100');\n    });\n\n    it('应该处理元素不可见时的动画', () => {\n      mockUseIntersectionObserver.mockReturnValue({\n        ref: vi.fn(),\n        isVisible: false,\n      });\n\n      render(<TechStackSection />);\n\n      // 验证不可见状态下的CSS类\n      const titleElement = screen.getByText('Tech Stack').closest('div');\n      expect(titleElement).toHaveClass('translate-y-8', 'opacity-0');\n    });\n  });\n\n  describe('数据处理测试', () => {\n    it('应该正确处理技术栈数据分类', () => {\n      const mockCategorizedData = {\n        core: [{ id: 'nextjs', name: 'Next.js', category: 'core' }],\n        frontend: [{ id: 'react', name: 'React', category: 'frontend' }],\n        backend: [],\n        tools: [],\n      };\n\n      mockUseMemo.mockReturnValue(mockCategorizedData);\n\n      render(<TechStackSection />);\n\n      // 验证useMemo被调用\n      expect(mockUseMemo).toHaveBeenCalled();\n    });\n  });\n\n  describe('国际化测试', () => {\n    it('应该正确使用翻译键', () => {\n      render(<TechStackSection />);\n\n      // 验证useTranslations被正确调用\n      expect(mockUseTranslations).toHaveBeenCalledWith('home.techStack');\n    });\n\n    it('应该处理缺失的翻译键', () => {\n      // Mock useTranslations返回缺失键的情况\n      const mockTranslationFunction = vi.fn((key: string) => `missing.${key}`);\n      mockUseTranslations.mockReturnValue(mockTranslationFunction);\n\n      render(<TechStackSection />);\n\n      // 验证缺失翻译的处理\n      expect(screen.getByText('missing.title')).toBeInTheDocument();\n    });\n  });\n\n  describe('子组件测试', () => {\n    it('应该渲染TechStackStats组件', () => {\n      render(<TechStackSection />);\n\n      // 验证统计组件的存在\n      expect(screen.getByText('Total Technologies')).toBeInTheDocument();\n      expect(screen.getByText('Categories')).toBeInTheDocument();\n    });\n\n    it('应该渲染TechStackTitle组件', () => {\n      render(<TechStackSection />);\n\n      // 验证标题组件\n      expect(screen.getByRole('heading', { level: 2 })).toBeInTheDocument();\n      expect(screen.getByText('Tech Stack')).toBeInTheDocument();\n      expect(\n        screen.getByText('Modern technologies we use'),\n      ).toBeInTheDocument();\n    });\n\n    it('应该渲染TechStackTabs组件', () => {\n      render(<TechStackSection />);\n\n      // 验证标签页组件\n      expect(screen.getByTestId('tabs')).toBeInTheDocument();\n      expect(screen.getByTestId('tabs-list')).toBeInTheDocument();\n    });\n  });\n\n  describe('错误处理测试', () => {\n    it('应该处理useIntersectionObserver错误', () => {\n      mockUseIntersectionObserver.mockImplementation(() => {\n        throw new Error('IntersectionObserver error');\n      });\n\n      expect(() => render(<TechStackSection />)).toThrow(\n        'IntersectionObserver error',\n      );\n    });\n\n    it('应该处理useState错误', () => {\n      mockUseState.mockImplementation(() => {\n        throw new Error('useState error');\n      });\n\n      expect(() => render(<TechStackSection />)).toThrow('useState error');\n    });\n\n    it('应该处理useMemo错误', () => {\n      mockUseMemo.mockImplementation(() => {\n        throw new Error('useMemo error');\n      });\n\n      expect(() => render(<TechStackSection />)).toThrow('useMemo error');\n    });\n  });\n\n  describe('边缘情况测试', () => {\n    it('应该处理空的技术栈数据', () => {\n      // 修复：直接Mock useMemo返回空的分类数据\n      mockUseMemo.mockReturnValueOnce({});\n\n      render(<TechStackSection />);\n\n      // 验证空数据的处理 - 组件应该仍然渲染基本结构\n      expect(screen.getByText('Tech Stack')).toBeInTheDocument();\n      expect(\n        screen.getByText('Modern technologies we use'),\n      ).toBeInTheDocument();\n    });\n\n    it('应该处理不同的选中分类', () => {\n      mockUseState.mockReturnValue(['frontend', vi.fn()]);\n\n      render(<TechStackSection />);\n\n      // 验证不同分类的处理\n      const tabs = screen.getByTestId('tabs');\n      expect(tabs).toHaveAttribute('data-value', 'frontend');\n    });\n\n    it('应该处理多个intersection observer实例', () => {\n      let callCount = 0;\n      mockUseIntersectionObserver.mockImplementation(() => {\n        callCount++;\n        return {\n          ref: vi.fn(),\n          isVisible: callCount % 2 === 0, // 交替返回true/false\n        };\n      });\n\n      render(<TechStackSection />);\n\n      // 验证多次调用intersection observer\n      expect(mockUseIntersectionObserver).toHaveBeenCalledTimes(3); // title, tabs, stats\n    });\n  });\n\n  describe('性能测试', () => {\n    it('应该正确使用useMemo优化性能', () => {\n      render(<TechStackSection />);\n\n      // 验证useMemo被调用用于数据分类\n      expect(mockUseMemo).toHaveBeenCalledWith(expect.any(Function), []);\n    });\n\n    it('应该正确设置intersection observer配置', () => {\n      render(<TechStackSection />);\n\n      // 验证intersection observer配置\n      expect(mockUseIntersectionObserver).toHaveBeenCalledWith({\n        threshold: 0.3,\n        triggerOnce: true,\n      });\n    });\n  });\n\n  describe('可访问性测试', () => {\n    it('应该有正确的语义结构', () => {\n      render(<TechStackSection />);\n\n      // 验证语义元素 - 修复：使用正确的选择器\n      const section = document.querySelector('#tech-stack');\n      expect(section).toBeInTheDocument();\n      expect(screen.getByRole('heading', { level: 2 })).toBeInTheDocument();\n    });\n\n    it('应该有正确的section id', () => {\n      render(<TechStackSection />);\n\n      // 验证section id用于锚点导航\n      const section = document.querySelector('#tech-stack');\n      expect(section).toBeInTheDocument();\n      expect(section).toHaveAttribute('id', 'tech-stack');\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/home/call-to-action.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/home/component-showcase.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/home/cta/action-cards.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/home/cta/community-section.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/home/cta/data.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/home/cta/stats-display.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/home/hero-section.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/home/project-overview.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/home/showcase/__tests__/badge-showcase.test.tsx","messages":[],"suppressedMessages":[{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":19,"column":10,"nodeType":"MemberExpression","endLine":19,"endColumn":27,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/home/showcase/__tests__/button-showcase.test.tsx","messages":[],"suppressedMessages":[{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":19,"column":10,"nodeType":"MemberExpression","endLine":19,"endColumn":27,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/home/showcase/__tests__/form-showcase.test.tsx","messages":[],"suppressedMessages":[{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":17,"column":10,"nodeType":"MemberExpression","endLine":17,"endColumn":27,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/home/showcase/__tests__/interactive-showcase.test.tsx","messages":[],"suppressedMessages":[{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":17,"column":10,"nodeType":"MemberExpression","endLine":17,"endColumn":27,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/home/showcase/__tests__/responsive-showcase.test.tsx","messages":[],"suppressedMessages":[{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":20,"column":10,"nodeType":"MemberExpression","endLine":20,"endColumn":27,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/home/showcase/badge-showcase.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/home/showcase/button-showcase.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/home/showcase/form-showcase.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/home/showcase/index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/home/showcase/interactive-showcase.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/home/showcase/responsive-showcase.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/home/showcase/theme-showcase.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/home/tech-stack-section.tsx","messages":[{"ruleId":"max-nested-callbacks","severity":2,"message":"Too many nested callbacks (3). Maximum allowed is 2.","line":218,"column":11,"nodeType":"ArrowFunctionExpression","messageId":"exceed","endLine":218,"endColumn":47}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useMemo, useState } from 'react';\nimport { ExternalLink } from 'lucide-react';\nimport { useTranslations } from 'next-intl';\nimport {\n  techStackCategories,\n  techStackData,\n  type TechStackCategory,\n} from '@/lib/tech-stack-data';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport {\n  Card,\n  CardContent,\n  CardDescription,\n  CardHeader,\n  CardTitle,\n} from '@/components/ui/card';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { useIntersectionObserver } from '@/hooks/use-intersection-observer';\n\nfunction TechStackStats({ t }: { t: (_key: string) => string }) {\n  const { ref, isVisible } = useIntersectionObserver<HTMLDivElement>({\n    threshold: 0.3,\n    triggerOnce: true,\n  });\n\n  return (\n    <div\n      ref={ref}\n      className={`bg-card mt-12 rounded-lg border p-6 transition-all duration-700 ease-out ${\n        isVisible ? 'translate-y-0 opacity-100' : 'translate-y-8 opacity-0'\n      }`}\n    >\n      <div className='grid grid-cols-2 gap-6 sm:grid-cols-4'>\n        <div className='text-center'>\n          <div className='text-primary text-2xl font-bold'>\n            {techStackData.length}\n          </div>\n          <div className='text-muted-foreground text-sm'>\n            {t('stats.totalTech')}\n          </div>\n        </div>\n        <div className='text-center'>\n          <div className='text-primary text-2xl font-bold'>\n            {Object.keys(techStackCategories).length}\n          </div>\n          <div className='text-muted-foreground text-sm'>\n            {t('stats.categories')}\n          </div>\n        </div>\n        <div className='text-center'>\n          <div className='text-primary text-2xl font-bold'>100%</div>\n          <div className='text-muted-foreground text-sm'>\n            {t('stats.modern')}\n          </div>\n        </div>\n        <div className='text-center'>\n          <div className='text-primary text-2xl font-bold'>A+</div>\n          <div className='text-muted-foreground text-sm'>\n            {t('stats.quality')}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n// Tech Stack Title Component\nfunction TechStackTitle({\n  titleRef,\n  titleVisible,\n  title,\n  subtitle,\n}: {\n  titleRef: (_node: HTMLDivElement | null) => void;\n  titleVisible: boolean;\n  title: string;\n  subtitle: string;\n}) {\n  return (\n    <div\n      ref={titleRef}\n      className={`mb-12 text-center transition-all duration-700 ease-out ${\n        titleVisible ? 'translate-y-0 opacity-100' : 'translate-y-8 opacity-0'\n      }`}\n    >\n      <h2 className='mb-4 text-3xl font-bold tracking-tight sm:text-4xl'>\n        {title}\n      </h2>\n      <p className='text-muted-foreground mx-auto max-w-2xl text-lg'>\n        {subtitle}\n      </p>\n    </div>\n  );\n}\n\n// Tech Stack Tabs Component\nfunction TechStackTabs({\n  selectedCategory,\n  setSelectedCategory,\n  tabsRef,\n  tabsVisible,\n  categorizedTech,\n  t,\n}: {\n  selectedCategory: TechStackCategory;\n  setSelectedCategory: (_category: TechStackCategory) => void;\n  tabsRef: (_node: HTMLDivElement | null) => void;\n  tabsVisible: boolean;\n  categorizedTech: Record<TechStackCategory, typeof techStackData>;\n  t: (_key: string) => string;\n}) {\n  return (\n    <Tabs\n      value={selectedCategory}\n      onValueChange={(value) => setSelectedCategory(value as TechStackCategory)}\n      className='w-full'\n    >\n      <div\n        ref={tabsRef}\n        className={`transition-all delay-200 duration-700 ease-out ${\n          tabsVisible ? 'translate-y-0 opacity-100' : 'translate-y-8 opacity-0'\n        }`}\n      >\n        <TabsList className='mb-8 grid w-full grid-cols-3 gap-1 sm:grid-cols-5 lg:grid-cols-7'>\n          {Object.entries(techStackCategories).map(([key, label]) => (\n            <TabsTrigger\n              key={key}\n              value={key}\n              className='text-xs sm:text-sm'\n            >\n              {label}\n            </TabsTrigger>\n          ))}\n        </TabsList>\n\n        {/* 技术栈内容 */}\n        {Object.entries(categorizedTech).map(([_category, items], index) => (\n          <TabsContent\n            key={`category-${index}`}\n            value={_category}\n            className='mt-0'\n          >\n            <div className='grid gap-4 sm:grid-cols-2 lg:grid-cols-3'>\n              {items.map((tech, techIndex) => (\n                <Card\n                  key={`tech-${techIndex}`}\n                  className='group hover:shadow-primary/5 transition-all duration-200 hover:shadow-lg'\n                >\n                  <CardHeader className='pb-3'>\n                    <div className='flex items-center justify-between'>\n                      <CardTitle className='text-lg'>{tech.name}</CardTitle>\n                      <Badge\n                        variant='secondary'\n                        className='text-xs'\n                      >\n                        v{tech.version}\n                      </Badge>\n                    </div>\n                    <CardDescription className='text-sm'>\n                      {tech.description}\n                    </CardDescription>\n                  </CardHeader>\n                  {tech.url && (\n                    <CardContent className='pt-0'>\n                      <Button\n                        variant='ghost'\n                        size='sm'\n                        className='h-8 px-2 text-xs opacity-0 transition-opacity group-hover:opacity-100'\n                        asChild\n                      >\n                        <a\n                          href={tech.url}\n                          target='_blank'\n                          rel='noopener noreferrer'\n                          className='flex items-center gap-1'\n                        >\n                          {t('learnMore')}\n                          <ExternalLink className='h-3 w-3' />\n                        </a>\n                      </Button>\n                    </CardContent>\n                  )}\n                </Card>\n              ))}\n            </div>\n          </TabsContent>\n        ))}\n      </div>\n    </Tabs>\n  );\n}\n\nexport function TechStackSection() {\n  const t = useTranslations('home.techStack');\n  const [selectedCategory, setSelectedCategory] =\n    useState<TechStackCategory>('core');\n\n  // 动画Hook\n  const { ref: titleRef, isVisible: titleVisible } =\n    useIntersectionObserver<HTMLDivElement>({\n      threshold: 0.3,\n      triggerOnce: true,\n    });\n\n  const { ref: tabsRef, isVisible: tabsVisible } =\n    useIntersectionObserver<HTMLDivElement>({\n      threshold: 0.3,\n      triggerOnce: true,\n    });\n\n  const categorizedTech = useMemo(() => {\n    return Object.keys(techStackCategories).reduce(\n      (acc, category) => {\n        acc[category as TechStackCategory] = techStackData.filter(\n          (item) => item.category === category,\n        );\n        return acc;\n      },\n      {} as Record<TechStackCategory, typeof techStackData>,\n    );\n  }, []);\n\n  return (\n    <section\n      id='tech-stack'\n      className='py-20'\n    >\n      <div className='container mx-auto px-4'>\n        <div className='mx-auto max-w-6xl'>\n          <TechStackTitle\n            titleRef={titleRef}\n            titleVisible={titleVisible}\n            title={t('title')}\n            subtitle={t('subtitle')}\n          />\n\n          <TechStackTabs\n            selectedCategory={selectedCategory}\n            setSelectedCategory={setSelectedCategory}\n            tabsRef={tabsRef}\n            tabsVisible={tabsVisible}\n            categorizedTech={categorizedTech}\n            t={t}\n          />\n\n          <TechStackStats t={t} />\n        </div>\n      </div>\n    </section>\n  );\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/i18n/__tests__/enhanced-locale-switcher-accessibility-responsive-core.test.tsx","messages":[],"suppressedMessages":[{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":20,"column":10,"nodeType":"MemberExpression","endLine":20,"endColumn":27,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/i18n/__tests__/enhanced-locale-switcher-accessibility-responsive.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/i18n/__tests__/enhanced-locale-switcher-basic.test.tsx","messages":[{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":106,"column":23,"nodeType":"MemberExpression","endLine":106,"endColumn":60}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @vitest-environment jsdom\n */\n\n/**\n * Enhanced Locale Switcher - Main Integration Tests\n *\n * 主要集成测试，包括：\n * - 核心组件导出验证\n * - 基本功能集成测试\n * - 错误处理验证\n *\n * 详细测试请参考：\n * - enhanced-locale-switcher-rendering.test.tsx - 渲染功能测试\n * - enhanced-locale-switcher-modes.test.tsx - 模式和生命周期测试\n */\n\nimport { render, screen } from '@testing-library/react';\nimport userEvent from '@testing-library/user-event';\nimport { useLocale, usePathname, useTranslations } from 'next-intl';\nimport React from 'react';\nimport { beforeEach, describe, expect, it, vi } from 'vitest';\nimport { EnhancedLocaleSwitcher, SimpleLocaleSwitcher } from '../enhanced-locale-switcher';\n\n// Mock next-intl hooks\nvi.mock('next-intl', () => ({\n  useLocale: vi.fn(),\n  usePathname: vi.fn(),\n  useTranslations: vi.fn(),\n}));\n\n// Mock next/navigation\nvi.mock('next/navigation', () => ({\n  useRouter: vi.fn(() => ({\n    push: vi.fn(),\n    replace: vi.fn(),\n  })),\n  useSearchParams: vi.fn(() => new URLSearchParams()),\n}));\n\n// Mock Lucide React icons\nvi.mock('lucide-react', () => ({\n  Check: ({ className, ...props }: React.SVGProps<SVGSVGElement>) => (\n    <svg\n      className={className}\n      data-testid='check-icon'\n      {...props}\n    >\n      <path d='M20 6L9 17l-5-5' />\n    </svg>\n  ),\n  ChevronDown: ({ className, ...props }: React.SVGProps<SVGSVGElement>) => (\n    <svg\n      className={className}\n      data-testid='chevron-down-icon'\n      {...props}\n    >\n      <path d='M6 9l6 6 6-6' />\n    </svg>\n  ),\n  Globe: ({ className, ...props }: React.SVGProps<SVGSVGElement>) => (\n    <svg\n      className={className}\n      data-testid='globe-icon'\n      {...props}\n    >\n      <circle cx='12' cy='12' r='10' />\n    </svg>\n  ),\n}));\n\ndescribe('Enhanced Locale Switcher - Main Integration Tests', () => {\n  let user: ReturnType<typeof userEvent.setup>;\n\n  const defaultMocks = {\n    locale: 'en',\n    pathname: '/',\n    translations: {\n      toggle: 'Toggle language',\n      selectLanguage: 'Select Language',\n      currentLanguage: 'Current language: {language}',\n      detectedLanguage: 'Detected language: {language}',\n      switchTo: 'Switch to {language}',\n      languages: {\n        en: 'English',\n        zh: '中文',\n      },\n    },\n  };\n\n  beforeEach(() => {\n    user = userEvent.setup();\n    vi.clearAllMocks();\n\n    // Setup default mocks\n    (useLocale as ReturnType<typeof vi.fn>).mockReturnValue(defaultMocks.locale);\n    (usePathname as ReturnType<typeof vi.fn>).mockReturnValue(defaultMocks.pathname);\n    (useTranslations as ReturnType<typeof vi.fn>).mockImplementation((namespace?: string) => {\n      if (namespace === 'LocaleSwitcher') {\n        return (key: string) => {\n          const keys = key.split('.');\n          let value: unknown = defaultMocks.translations;\n          for (const k of keys) {\n            // 安全的对象属性访问，避免对象注入\n            if (value && typeof value === 'object' && k in value) {\n              value = (value as Record<string, unknown>)[k];\n            } else {\n              return key; // 如果路径不存在，返回原始key\n            }\n          }\n          return value as string || key;\n        };\n      }\n      return (key: string) => key;\n    });\n  });\n\n  describe('核心组件导出验证', () => {\n    it('should export EnhancedLocaleSwitcher component', () => {\n      expect(EnhancedLocaleSwitcher).toBeDefined();\n      expect(typeof EnhancedLocaleSwitcher).toBe('function');\n    });\n\n    it('should export SimpleLocaleSwitcher component', () => {\n      expect(SimpleLocaleSwitcher).toBeDefined();\n      expect(typeof SimpleLocaleSwitcher).toBe('function');\n    });\n  });\n\n  describe('基本功能集成测试', () => {\n    it('renders EnhancedLocaleSwitcher with basic functionality', () => {\n      render(<EnhancedLocaleSwitcher />);\n\n      const button = screen.getByRole('button');\n      expect(button).toBeInTheDocument();\n      expect(button).toHaveAttribute('aria-label', 'Toggle language');\n\n      // Should show globe icon\n      const globeIcon = screen.getByTestId('globe-icon');\n      expect(globeIcon).toBeInTheDocument();\n\n      // Should show current language\n      expect(screen.getByText('English')).toBeInTheDocument();\n    });\n\n    it('renders SimpleLocaleSwitcher with basic functionality', () => {\n      render(<SimpleLocaleSwitcher />);\n\n      const button = screen.getByRole('button');\n      expect(button).toBeInTheDocument();\n      expect(button).toHaveAttribute('aria-label', 'Toggle language');\n\n      // Should show current language\n      expect(screen.getByText('English')).toBeInTheDocument();\n    });\n\n    it('handles dropdown interaction correctly', async () => {\n      render(<EnhancedLocaleSwitcher />);\n\n      const button = screen.getByRole('button');\n\n      // Should start closed\n      expect(button).toHaveAttribute('aria-expanded', 'false');\n\n      // Should open when clicked\n      await user.click(button);\n      expect(button).toHaveAttribute('aria-expanded', 'true');\n\n      // Should show language options\n      expect(screen.getByText('English')).toBeInTheDocument();\n      expect(screen.getByText('中文')).toBeInTheDocument();\n    });\n\n    it('supports compact mode', () => {\n      render(<EnhancedLocaleSwitcher compact />);\n\n      const button = screen.getByRole('button');\n      expect(button).toBeInTheDocument();\n\n      // Should still show globe icon in compact mode\n      const globeIcon = screen.getByTestId('globe-icon');\n      expect(globeIcon).toBeInTheDocument();\n    });\n\n    it('handles keyboard navigation', async () => {\n      render(<EnhancedLocaleSwitcher />);\n\n      const button = screen.getByRole('button');\n\n      // Focus the button\n      await user.tab();\n      expect(button).toHaveFocus();\n\n      // Open with Enter\n      await user.keyboard('{Enter}');\n      expect(button).toHaveAttribute('aria-expanded', 'true');\n\n      // Close with Escape\n      await user.keyboard('{Escape}');\n      expect(button).toHaveAttribute('aria-expanded', 'false');\n    });\n\n    it('supports custom className', () => {\n      render(<EnhancedLocaleSwitcher className='custom-switcher' />);\n\n      const button = screen.getByRole('button');\n      expect(button).toHaveClass('custom-switcher');\n    });\n  });\n\n  describe('错误处理验证', () => {\n    it('handles missing translations gracefully', () => {\n      (useTranslations as ReturnType<typeof vi.fn>).mockReturnValue(() => undefined);\n\n      expect(() => {\n        render(<EnhancedLocaleSwitcher />);\n      }).not.toThrow();\n\n      const button = screen.getByRole('button');\n      expect(button).toBeInTheDocument();\n    });\n\n    it('handles invalid locale gracefully', () => {\n      (useLocale as ReturnType<typeof vi.fn>).mockReturnValue('invalid');\n\n      expect(() => {\n        render(<EnhancedLocaleSwitcher />);\n      }).not.toThrow();\n\n      const button = screen.getByRole('button');\n      expect(button).toBeInTheDocument();\n    });\n\n    it('handles missing pathname gracefully', () => {\n      (usePathname as ReturnType<typeof vi.fn>).mockReturnValue(null);\n\n      expect(() => {\n        render(<EnhancedLocaleSwitcher />);\n      }).not.toThrow();\n\n      const button = screen.getByRole('button');\n      expect(button).toBeInTheDocument();\n    });\n\n    it('handles component unmounting without errors', () => {\n      const { unmount } = render(<EnhancedLocaleSwitcher />);\n\n      expect(() => unmount()).not.toThrow();\n    });\n\n    it('handles re-renders correctly', () => {\n      const { rerender } = render(<EnhancedLocaleSwitcher />);\n\n      expect(screen.getByRole('button')).toBeInTheDocument();\n\n      rerender(<EnhancedLocaleSwitcher compact />);\n      expect(screen.getByRole('button')).toBeInTheDocument();\n    });\n  });\n\n  describe('可访问性验证', () => {\n    it('maintains proper accessibility attributes', () => {\n      render(<EnhancedLocaleSwitcher />);\n\n      const button = screen.getByRole('button');\n      expect(button).toHaveAttribute('aria-haspopup', 'true');\n      expect(button).toHaveAttribute('aria-expanded', 'false');\n      expect(button).toHaveAttribute('aria-label', 'Toggle language');\n    });\n\n    it('updates aria-expanded correctly', async () => {\n      render(<EnhancedLocaleSwitcher />);\n\n      const button = screen.getByRole('button');\n\n      await user.click(button);\n      expect(button).toHaveAttribute('aria-expanded', 'true');\n\n      await user.keyboard('{Escape}');\n      expect(button).toHaveAttribute('aria-expanded', 'false');\n    });\n\n    it('maintains focus management', async () => {\n      render(<EnhancedLocaleSwitcher />);\n\n      const button = screen.getByRole('button');\n\n      await user.click(button);\n      await user.keyboard('{Escape}');\n\n      expect(button).toHaveFocus();\n    });\n  });\n\n  describe('多语言支持验证', () => {\n    it('displays correct language for different locales', () => {\n      (useLocale as ReturnType<typeof vi.fn>).mockReturnValue('zh');\n\n      render(<EnhancedLocaleSwitcher />);\n\n      expect(screen.getByText('中文')).toBeInTheDocument();\n    });\n\n    it('handles language switching', async () => {\n      render(<EnhancedLocaleSwitcher />);\n\n      const button = screen.getByRole('button');\n      await user.click(button);\n\n      // Should show both language options\n      expect(screen.getByText('English')).toBeInTheDocument();\n      expect(screen.getByText('中文')).toBeInTheDocument();\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/i18n/__tests__/enhanced-locale-switcher-language-switching-advanced.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/i18n/__tests__/enhanced-locale-switcher-language-switching-core.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/i18n/__tests__/enhanced-locale-switcher-modes.test.tsx","messages":[{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":103,"column":23,"nodeType":"MemberExpression","endLine":103,"endColumn":60}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @vitest-environment jsdom\n */\n\n/**\n * Enhanced Locale Switcher - Modes Tests\n *\n * 专门测试不同模式功能，包括：\n * - Compact模式测试\n * - SimpleLocaleSwitcher测试\n * - 模式切换行为\n * - 组件生命周期\n */\n\nimport { render, screen } from '@testing-library/react';\nimport userEvent from '@testing-library/user-event';\nimport { useLocale, usePathname, useTranslations } from 'next-intl';\nimport React from 'react';\nimport { beforeEach, describe, expect, it, vi } from 'vitest';\nimport { EnhancedLocaleSwitcher, SimpleLocaleSwitcher } from '../enhanced-locale-switcher';\n\n// Mock next-intl hooks\nvi.mock('next-intl', () => ({\n  useLocale: vi.fn(),\n  usePathname: vi.fn(),\n  useTranslations: vi.fn(),\n}));\n\n// Mock next/navigation\nvi.mock('next/navigation', () => ({\n  useRouter: vi.fn(() => ({\n    push: vi.fn(),\n    replace: vi.fn(),\n  })),\n  useSearchParams: vi.fn(() => new URLSearchParams()),\n}));\n\n// Mock Lucide React icons\nvi.mock('lucide-react', () => ({\n  Check: ({ className, ...props }: React.SVGProps<SVGSVGElement>) => (\n    <svg\n      className={className}\n      data-testid='check-icon'\n      {...props}\n    >\n      <path d='M20 6L9 17l-5-5' />\n    </svg>\n  ),\n  ChevronDown: ({ className, ...props }: React.SVGProps<SVGSVGElement>) => (\n    <svg\n      className={className}\n      data-testid='chevron-down-icon'\n      {...props}\n    >\n      <path d='M6 9l6 6 6-6' />\n    </svg>\n  ),\n  Globe: ({ className, ...props }: React.SVGProps<SVGSVGElement>) => (\n    <svg\n      className={className}\n      data-testid='globe-icon'\n      {...props}\n    >\n      <circle cx='12' cy='12' r='10' />\n    </svg>\n  ),\n}));\n\ndescribe('Enhanced Locale Switcher - Modes Tests', () => {\n  let user: ReturnType<typeof userEvent.setup>;\n\n  const defaultMocks = {\n    locale: 'en',\n    pathname: '/',\n    translations: {\n      toggle: 'Toggle language',\n      selectLanguage: 'Select Language',\n      currentLanguage: 'Current language: {language}',\n      detectedLanguage: 'Detected language: {language}',\n      switchTo: 'Switch to {language}',\n      languages: {\n        en: 'English',\n        zh: '中文',\n      },\n    },\n  };\n\n  beforeEach(() => {\n    user = userEvent.setup();\n    vi.clearAllMocks();\n\n    // Setup default mocks\n    (useLocale as ReturnType<typeof vi.fn>).mockReturnValue(defaultMocks.locale);\n    (usePathname as ReturnType<typeof vi.fn>).mockReturnValue(defaultMocks.pathname);\n    (useTranslations as ReturnType<typeof vi.fn>).mockImplementation((namespace?: string) => {\n      if (namespace === 'LocaleSwitcher') {\n        return (key: string) => {\n          const keys = key.split('.');\n          let value: unknown = defaultMocks.translations;\n          for (const k of keys) {\n            // 安全的对象属性访问，避免对象注入\n            if (value && typeof value === 'object' && k in value) {\n              value = (value as Record<string, unknown>)[k];\n            } else {\n              return key; // 如果路径不存在，返回原始key\n            }\n          }\n          return value as string || key;\n        };\n      }\n      return (key: string) => key;\n    });\n  });\n\n  describe('Compact模式测试', () => {\n    it('renders in compact mode correctly', () => {\n      render(<EnhancedLocaleSwitcher compact />);\n\n      const button = screen.getByRole('button');\n      expect(button).toBeInTheDocument();\n\n      // Should still show globe icon\n      const globeIcon = screen.getByTestId('globe-icon');\n      expect(globeIcon).toBeInTheDocument();\n    });\n\n    it('hides language text in compact mode', () => {\n      render(<EnhancedLocaleSwitcher compact />);\n\n      // Language text should not be visible in compact mode\n      const button = screen.getByRole('button');\n      const buttonText = button.textContent;\n      expect(buttonText).not.toContain('English');\n    });\n\n    it('maintains accessibility in compact mode', () => {\n      render(<EnhancedLocaleSwitcher compact />);\n\n      const button = screen.getByRole('button');\n      expect(button).toHaveAttribute('aria-label', 'Toggle language');\n      expect(button).toHaveAttribute('aria-haspopup', 'true');\n    });\n\n    it('shows full dropdown content in compact mode', async () => {\n      render(<EnhancedLocaleSwitcher compact />);\n\n      const button = screen.getByRole('button');\n      await user.click(button);\n\n      // Should show all language options\n      expect(screen.getByText('English')).toBeInTheDocument();\n      expect(screen.getByText('中文')).toBeInTheDocument();\n    });\n\n    it('applies compact-specific styling', () => {\n      render(<EnhancedLocaleSwitcher compact className='compact-custom' />);\n\n      const button = screen.getByRole('button');\n      expect(button).toHaveClass('compact-custom');\n    });\n\n    it('handles interactions in compact mode', async () => {\n      render(<EnhancedLocaleSwitcher compact />);\n\n      const button = screen.getByRole('button');\n\n      // Should open dropdown\n      await user.click(button);\n      expect(button).toHaveAttribute('aria-expanded', 'true');\n\n      // Should close with Escape\n      await user.keyboard('{Escape}');\n      expect(button).toHaveAttribute('aria-expanded', 'false');\n    });\n\n    it('supports responsive behavior in compact mode', () => {\n      render(<EnhancedLocaleSwitcher compact className='md:px-4 lg:px-6' />);\n\n      const button = screen.getByRole('button');\n      expect(button).toHaveClass('md:px-4', 'lg:px-6');\n    });\n\n    it('maintains focus management in compact mode', async () => {\n      render(<EnhancedLocaleSwitcher compact />);\n\n      const button = screen.getByRole('button');\n\n      await user.tab();\n      expect(button).toHaveFocus();\n\n      await user.keyboard('{Enter}');\n      expect(button).toHaveAttribute('aria-expanded', 'true');\n\n      await user.keyboard('{Escape}');\n      expect(button).toHaveFocus();\n    });\n\n    it('handles keyboard navigation in compact mode', async () => {\n      render(<EnhancedLocaleSwitcher compact />);\n\n      const button = screen.getByRole('button');\n      button.focus();\n\n      await user.keyboard('{Space}');\n      expect(button).toHaveAttribute('aria-expanded', 'true');\n\n      await user.keyboard('{Escape}');\n      expect(button).toHaveAttribute('aria-expanded', 'false');\n    });\n  });\n\n  describe('SimpleLocaleSwitcher测试', () => {\n    it('renders SimpleLocaleSwitcher correctly', () => {\n      render(<SimpleLocaleSwitcher />);\n\n      const button = screen.getByRole('button');\n      expect(button).toBeInTheDocument();\n      expect(button).toHaveAttribute('aria-label', 'Toggle language');\n    });\n\n    it('shows current language in SimpleLocaleSwitcher', () => {\n      render(<SimpleLocaleSwitcher />);\n\n      expect(screen.getByText('English')).toBeInTheDocument();\n    });\n\n    it('opens dropdown in SimpleLocaleSwitcher', async () => {\n      render(<SimpleLocaleSwitcher />);\n\n      const button = screen.getByRole('button');\n      await user.click(button);\n\n      expect(button).toHaveAttribute('aria-expanded', 'true');\n      expect(screen.getByText('中文')).toBeInTheDocument();\n    });\n\n    it('supports custom props in SimpleLocaleSwitcher', () => {\n      render(<SimpleLocaleSwitcher className='simple-custom' />);\n\n      const button = screen.getByRole('button');\n      expect(button).toHaveClass('simple-custom');\n    });\n\n    it('handles keyboard navigation in SimpleLocaleSwitcher', async () => {\n      render(<SimpleLocaleSwitcher />);\n\n      const button = screen.getByRole('button');\n\n      await user.tab();\n      expect(button).toHaveFocus();\n\n      await user.keyboard('{Space}');\n      expect(button).toHaveAttribute('aria-expanded', 'true');\n    });\n\n    it('maintains accessibility in SimpleLocaleSwitcher', () => {\n      render(<SimpleLocaleSwitcher />);\n\n      const button = screen.getByRole('button');\n      expect(button).toHaveAttribute('aria-haspopup', 'true');\n      expect(button).toHaveAttribute('aria-expanded', 'false');\n    });\n\n    it('handles different locales in SimpleLocaleSwitcher', () => {\n      (useLocale as ReturnType<typeof vi.fn>).mockReturnValue('zh');\n\n      render(<SimpleLocaleSwitcher />);\n\n      expect(screen.getByText('中文')).toBeInTheDocument();\n    });\n\n    it('supports responsive design in SimpleLocaleSwitcher', () => {\n      render(<SimpleLocaleSwitcher className='sm:text-sm md:text-base' />);\n\n      const button = screen.getByRole('button');\n      expect(button).toHaveClass('sm:text-sm', 'md:text-base');\n    });\n  });\n\n  describe('模式切换行为', () => {\n    it('switches between normal and compact modes', () => {\n      const { rerender } = render(<EnhancedLocaleSwitcher />);\n\n      // Normal mode should show language text\n      expect(screen.getByText('English')).toBeInTheDocument();\n\n      // Switch to compact mode\n      rerender(<EnhancedLocaleSwitcher compact />);\n\n      // Compact mode should hide language text\n      const button = screen.getByRole('button');\n      const buttonText = button.textContent;\n      expect(buttonText).not.toContain('English');\n    });\n\n    it('maintains state consistency across mode changes', async () => {\n      const { rerender } = render(<EnhancedLocaleSwitcher />);\n\n      const button = screen.getByRole('button');\n      await user.click(button);\n      expect(button).toHaveAttribute('aria-expanded', 'true');\n\n      // Mode change should reset state\n      rerender(<EnhancedLocaleSwitcher compact />);\n      expect(button).toHaveAttribute('aria-expanded', 'false');\n    });\n\n    it('preserves accessibility across mode changes', () => {\n      const { rerender } = render(<EnhancedLocaleSwitcher />);\n\n      let button = screen.getByRole('button');\n      expect(button).toHaveAttribute('aria-label', 'Toggle language');\n\n      rerender(<EnhancedLocaleSwitcher compact />);\n\n      button = screen.getByRole('button');\n      expect(button).toHaveAttribute('aria-label', 'Toggle language');\n    });\n  });\n\n  describe('组件生命周期', () => {\n    it('handles component mounting and unmounting', () => {\n      const { unmount } = render(<EnhancedLocaleSwitcher />);\n\n      expect(screen.getByRole('button')).toBeInTheDocument();\n\n      expect(() => unmount()).not.toThrow();\n    });\n\n    it('handles re-renders correctly', () => {\n      const { rerender } = render(<EnhancedLocaleSwitcher />);\n\n      expect(screen.getByRole('button')).toBeInTheDocument();\n\n      rerender(<EnhancedLocaleSwitcher compact />);\n      expect(screen.getByRole('button')).toBeInTheDocument();\n    });\n\n    it('maintains state across re-renders', async () => {\n      const { rerender } = render(<EnhancedLocaleSwitcher />);\n\n      const button = screen.getByRole('button');\n      await user.click(button);\n      expect(button).toHaveAttribute('aria-expanded', 'true');\n\n      rerender(<EnhancedLocaleSwitcher className='updated' />);\n      // State should be reset after re-render\n      expect(button).toHaveAttribute('aria-expanded', 'false');\n    });\n\n    it('handles prop changes gracefully', () => {\n      const { rerender } = render(<EnhancedLocaleSwitcher />);\n\n      expect(screen.getByRole('button')).toBeInTheDocument();\n\n      rerender(<EnhancedLocaleSwitcher compact className='new-class' />);\n      expect(screen.getByRole('button')).toHaveClass('new-class');\n    });\n\n    it('cleans up event listeners on unmount', () => {\n      const { unmount } = render(<EnhancedLocaleSwitcher />);\n\n      // Component should clean up without errors\n      expect(() => unmount()).not.toThrow();\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/i18n/__tests__/enhanced-locale-switcher-rendering.test.tsx","messages":[{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":103,"column":23,"nodeType":"MemberExpression","endLine":103,"endColumn":60}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @vitest-environment jsdom\n */\n\n/**\n * Enhanced Locale Switcher - Rendering Tests\n *\n * 专门测试基本渲染功能，包括：\n * - 基本组件渲染\n * - 样式和类名应用\n * - 可访问性属性\n * - 图标和文本显示\n */\n\nimport { render, screen } from '@testing-library/react';\nimport userEvent from '@testing-library/user-event';\nimport { useLocale, usePathname, useTranslations } from 'next-intl';\nimport React from 'react';\nimport { beforeEach, describe, expect, it, vi } from 'vitest';\nimport { EnhancedLocaleSwitcher } from '../enhanced-locale-switcher';\n\n// Mock next-intl hooks\nvi.mock('next-intl', () => ({\n  useLocale: vi.fn(),\n  usePathname: vi.fn(),\n  useTranslations: vi.fn(),\n}));\n\n// Mock next/navigation\nvi.mock('next/navigation', () => ({\n  useRouter: vi.fn(() => ({\n    push: vi.fn(),\n    replace: vi.fn(),\n  })),\n  useSearchParams: vi.fn(() => new URLSearchParams()),\n}));\n\n// Mock Lucide React icons\nvi.mock('lucide-react', () => ({\n  Check: ({ className, ...props }: React.SVGProps<SVGSVGElement>) => (\n    <svg\n      className={className}\n      data-testid='check-icon'\n      {...props}\n    >\n      <path d='M20 6L9 17l-5-5' />\n    </svg>\n  ),\n  ChevronDown: ({ className, ...props }: React.SVGProps<SVGSVGElement>) => (\n    <svg\n      className={className}\n      data-testid='chevron-down-icon'\n      {...props}\n    >\n      <path d='M6 9l6 6 6-6' />\n    </svg>\n  ),\n  Globe: ({ className, ...props }: React.SVGProps<SVGSVGElement>) => (\n    <svg\n      className={className}\n      data-testid='globe-icon'\n      {...props}\n    >\n      <circle cx='12' cy='12' r='10' />\n    </svg>\n  ),\n}));\n\ndescribe('Enhanced Locale Switcher - Rendering Tests', () => {\n  let user: ReturnType<typeof userEvent.setup>;\n\n  const defaultMocks = {\n    locale: 'en',\n    pathname: '/',\n    translations: {\n      toggle: 'Toggle language',\n      selectLanguage: 'Select Language',\n      currentLanguage: 'Current language: {language}',\n      detectedLanguage: 'Detected language: {language}',\n      switchTo: 'Switch to {language}',\n      languages: {\n        en: 'English',\n        zh: '中文',\n      },\n    },\n  };\n\n  beforeEach(() => {\n    user = userEvent.setup();\n    vi.clearAllMocks();\n\n    // Setup default mocks\n    (useLocale as ReturnType<typeof vi.fn>).mockReturnValue(defaultMocks.locale);\n    (usePathname as ReturnType<typeof vi.fn>).mockReturnValue(defaultMocks.pathname);\n    (useTranslations as ReturnType<typeof vi.fn>).mockImplementation((namespace?: string) => {\n      if (namespace === 'LocaleSwitcher') {\n        return (key: string) => {\n          const keys = key.split('.');\n          let value: unknown = defaultMocks.translations;\n          for (const k of keys) {\n            // 安全的对象属性访问，避免对象注入\n            if (value && typeof value === 'object' && k in value) {\n              value = (value as Record<string, unknown>)[k];\n            } else {\n              return key; // 如果路径不存在，返回原始key\n            }\n          }\n          return value as string || key;\n        };\n      }\n      return (key: string) => key;\n    });\n  });\n\n  describe('基本组件渲染', () => {\n    it('renders enhanced locale switcher with default props', () => {\n      render(<EnhancedLocaleSwitcher />);\n\n      const button = screen.getByRole('button');\n      expect(button).toBeInTheDocument();\n      expect(button).toHaveAttribute('aria-label', 'Toggle language');\n    });\n\n    it('renders globe icon in button', () => {\n      render(<EnhancedLocaleSwitcher />);\n\n      const globeIcon = screen.getByTestId('globe-icon');\n      expect(globeIcon).toBeInTheDocument();\n    });\n\n    it('renders current language text', () => {\n      render(<EnhancedLocaleSwitcher />);\n\n      expect(screen.getByText('English')).toBeInTheDocument();\n    });\n\n    it('renders chevron down icon', () => {\n      render(<EnhancedLocaleSwitcher />);\n\n      const chevronIcon = screen.getByTestId('chevron-down-icon');\n      expect(chevronIcon).toBeInTheDocument();\n    });\n\n    it('renders with different locales', () => {\n      (useLocale as ReturnType<typeof vi.fn>).mockReturnValue('zh');\n\n      render(<EnhancedLocaleSwitcher />);\n\n      expect(screen.getByText('中文')).toBeInTheDocument();\n    });\n\n    it('handles missing translation gracefully', () => {\n      (useTranslations as ReturnType<typeof vi.fn>).mockReturnValue(() => undefined);\n\n      expect(() => {\n        render(<EnhancedLocaleSwitcher />);\n      }).not.toThrow();\n    });\n  });\n\n  describe('样式和类名应用', () => {\n    it('applies default styling classes', () => {\n      render(<EnhancedLocaleSwitcher />);\n\n      const button = screen.getByRole('button');\n      expect(button).toHaveClass(\n        'inline-flex',\n        'items-center',\n        'gap-2',\n        'text-sm',\n        'font-medium'\n      );\n    });\n\n    it('supports custom className', () => {\n      render(<EnhancedLocaleSwitcher className='custom-switcher' />);\n\n      const button = screen.getByRole('button');\n      expect(button).toHaveClass('custom-switcher');\n    });\n\n    it('combines custom className with default classes', () => {\n      render(<EnhancedLocaleSwitcher className='custom-class' />);\n\n      const button = screen.getByRole('button');\n      expect(button).toHaveClass('custom-class');\n      expect(button).toHaveClass('inline-flex');\n    });\n\n    it('applies responsive classes correctly', () => {\n      render(<EnhancedLocaleSwitcher className='md:px-4 lg:px-6' />);\n\n      const button = screen.getByRole('button');\n      expect(button).toHaveClass('md:px-4', 'lg:px-6');\n    });\n\n    it('handles empty className gracefully', () => {\n      render(<EnhancedLocaleSwitcher className='' />);\n\n      const button = screen.getByRole('button');\n      expect(button).toBeInTheDocument();\n    });\n  });\n\n  describe('可访问性属性', () => {\n    it('renders with correct accessibility attributes', () => {\n      render(<EnhancedLocaleSwitcher />);\n\n      const button = screen.getByRole('button');\n      expect(button).toHaveAttribute('aria-haspopup', 'true');\n      expect(button).toHaveAttribute('aria-expanded', 'false');\n    });\n\n    it('updates aria-expanded when opened', async () => {\n      render(<EnhancedLocaleSwitcher />);\n\n      const button = screen.getByRole('button');\n      await user.click(button);\n\n      expect(button).toHaveAttribute('aria-expanded', 'true');\n    });\n\n    it('maintains aria-label attribute', () => {\n      render(<EnhancedLocaleSwitcher />);\n\n      const button = screen.getByRole('button');\n      expect(button).toHaveAttribute('aria-label', 'Toggle language');\n    });\n\n    it('provides proper button role', () => {\n      render(<EnhancedLocaleSwitcher />);\n\n      const button = screen.getByRole('button');\n      expect(button).toHaveAttribute('type', 'button');\n    });\n\n    it('supports keyboard navigation', async () => {\n      render(<EnhancedLocaleSwitcher />);\n\n      const button = screen.getByRole('button');\n\n      // Focus the button\n      await user.tab();\n      expect(button).toHaveFocus();\n\n      // Open with Enter\n      await user.keyboard('{Enter}');\n      expect(button).toHaveAttribute('aria-expanded', 'true');\n    });\n\n    it('supports space key activation', async () => {\n      render(<EnhancedLocaleSwitcher />);\n\n      const button = screen.getByRole('button');\n      button.focus();\n\n      await user.keyboard('{Space}');\n      expect(button).toHaveAttribute('aria-expanded', 'true');\n    });\n  });\n\n  describe('图标和文本显示', () => {\n    it('shows language options in dropdown', async () => {\n      render(<EnhancedLocaleSwitcher />);\n\n      const button = screen.getByRole('button');\n      await user.click(button);\n\n      expect(screen.getByText('English')).toBeInTheDocument();\n      expect(screen.getByText('中文')).toBeInTheDocument();\n    });\n\n    it('displays correct icons for each state', () => {\n      render(<EnhancedLocaleSwitcher />);\n\n      // Globe icon should be present\n      const globeIcon = screen.getByTestId('globe-icon');\n      expect(globeIcon).toBeInTheDocument();\n\n      // Chevron icon should be present\n      const chevronIcon = screen.getByTestId('chevron-down-icon');\n      expect(chevronIcon).toBeInTheDocument();\n    });\n\n    it('handles icon rendering errors gracefully', () => {\n      // Mock icon component to throw error\n      vi.mocked(require('lucide-react')).Globe.mockImplementation(() => {\n        throw new Error('Icon error');\n      });\n\n      expect(() => {\n        render(<EnhancedLocaleSwitcher />);\n      }).not.toThrow();\n    });\n\n    it('maintains text content consistency', () => {\n      render(<EnhancedLocaleSwitcher />);\n\n      const button = screen.getByRole('button');\n      const buttonText = button.textContent;\n\n      expect(buttonText).toContain('English');\n    });\n  });\n\n  describe('交互行为', () => {\n    it('opens dropdown when clicked', async () => {\n      render(<EnhancedLocaleSwitcher />);\n\n      const button = screen.getByRole('button');\n      await user.click(button);\n\n      expect(button).toHaveAttribute('aria-expanded', 'true');\n    });\n\n    it('closes dropdown when clicking outside', async () => {\n      render(\n        <div>\n          <EnhancedLocaleSwitcher />\n          <div data-testid='outside'>Outside</div>\n        </div>\n      );\n\n      const button = screen.getByRole('button');\n      const outside = screen.getByTestId('outside');\n\n      // Open dropdown\n      await user.click(button);\n      expect(button).toHaveAttribute('aria-expanded', 'true');\n\n      // Click outside\n      await user.click(outside);\n      expect(button).toHaveAttribute('aria-expanded', 'false');\n    });\n\n    it('closes dropdown with Escape key', async () => {\n      render(<EnhancedLocaleSwitcher />);\n\n      const button = screen.getByRole('button');\n      await user.click(button);\n      expect(button).toHaveAttribute('aria-expanded', 'true');\n\n      await user.keyboard('{Escape}');\n      expect(button).toHaveAttribute('aria-expanded', 'false');\n    });\n\n    it('maintains focus after closing dropdown', async () => {\n      render(<EnhancedLocaleSwitcher />);\n\n      const button = screen.getByRole('button');\n      await user.click(button);\n\n      await user.keyboard('{Escape}');\n      expect(button).toHaveFocus();\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/i18n/__tests__/enhanced-locale-switcher.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/i18n/enhanced-locale-switcher.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/i18n/format-helpers.tsx","messages":[{"ruleId":"max-statements","severity":2,"message":"Arrow function has too many statements (25). Maximum allowed is 20.","line":79,"column":31,"nodeType":"ArrowFunctionExpression","messageId":"exceed","endLine":140,"endColumn":2},{"ruleId":"no-shadow","severity":2,"message":"'count' is already declared in the upper scope on line 151 column 28.","line":154,"column":25,"nodeType":"Identifier","messageId":"noShadow","endLine":154,"endColumn":38},{"ruleId":"no-undef","severity":2,"message":"'React' is not defined.","line":171,"column":27,"nodeType":"Identifier","messageId":"undef","endLine":171,"endColumn":32},{"ruleId":"no-shadow","severity":2,"message":"'text' is already declared in the upper scope on line 175 column 30.","line":177,"column":24,"nodeType":"Identifier","messageId":"noShadow","endLine":177,"endColumn":36},{"ruleId":"no-undef","severity":2,"message":"'React' is not defined.","line":177,"column":39,"nodeType":"Identifier","messageId":"undef","endLine":177,"endColumn":44},{"ruleId":"security/detect-non-literal-regexp","severity":2,"message":"Found non-literal argument to RegExp Constructor","line":184,"column":11,"nodeType":"NewExpression","endLine":184,"endColumn":39}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { memo } from 'react';\nimport { useFormatter, useLocale, useTranslations } from 'next-intl';\nimport { DateFormatOptions } from '@/types/i18n-enhanced';\n\ninterface FormatDateProps {\n  date: Date | string | number;\n  format?: 'short' | 'long' | 'relative';\n  className?: string;\n}\n\nconst MILLISECONDS_PER_DAY = 1000 * 60 * 60 * 24;\n\nconst FormatDateComponent = ({\n  date,\n  format = 'short',\n  className,\n}: FormatDateProps) => {\n  const formatter = useFormatter();\n  const locale = useLocale();\n  const t = useTranslations('formatting.date');\n\n  const dateObj = new Date(date);\n  const now = new Date();\n  const diffInDays = Math.floor(\n    (now.getTime() - dateObj.getTime()) / MILLISECONDS_PER_DAY,\n  );\n\n  let formattedDate: string;\n\n  if (format === 'relative') {\n    if (diffInDays === 0) {\n      formattedDate = t('today');\n    } else if (diffInDays === 1) {\n      formattedDate = t('yesterday');\n    } else if (diffInDays === -1) {\n      formattedDate = t('tomorrow');\n    } else {\n      formattedDate = formatter.dateTime(dateObj, {\n        dateStyle: 'medium',\n      });\n    }\n  } else {\n    const options: Intl.DateTimeFormatOptions = {\n      dateStyle: format === 'long' ? 'full' : 'medium',\n    };\n\n    if (format === 'long') {\n      options.timeStyle = 'short';\n    }\n\n    formattedDate = formatter.dateTime(dateObj, options as DateFormatOptions);\n  }\n\n  return (\n    <time\n      dateTime={dateObj.toISOString()}\n      className={className}\n      lang={locale}\n    >\n      {formattedDate}\n    </time>\n  );\n};\n\nFormatDateComponent.displayName = 'FormatDate';\nexport const FormatDate = memo(FormatDateComponent);\n\ninterface FormatNumberProps {\n  value: number;\n  type?: 'currency' | 'percentage' | 'decimal';\n  currency?: string;\n  minimumFractionDigits?: number;\n  maximumFractionDigits?: number;\n  className?: string;\n}\n\nconst FormatNumberComponent = ({\n  value,\n  type = 'decimal',\n  currency = 'USD',\n  minimumFractionDigits,\n  maximumFractionDigits,\n  className,\n}: FormatNumberProps) => {\n  const formatter = useFormatter();\n  const locale = useLocale();\n\n  let formattedNumber: string;\n\n  switch (type) {\n    case 'currency': {\n      const currencyOptions: Intl.NumberFormatOptions = {\n        style: 'currency',\n        currency: locale === 'zh' ? 'CNY' : currency,\n      };\n      if (minimumFractionDigits !== undefined) {\n        currencyOptions.minimumFractionDigits = minimumFractionDigits;\n      }\n      if (maximumFractionDigits !== undefined) {\n        currencyOptions.maximumFractionDigits = maximumFractionDigits;\n      }\n      formattedNumber = formatter.number(value, currencyOptions as unknown);\n      break;\n    }\n    case 'percentage': {\n      const percentOptions: Intl.NumberFormatOptions = {\n        style: 'percent',\n      };\n      if (minimumFractionDigits !== undefined) {\n        percentOptions.minimumFractionDigits = minimumFractionDigits;\n      }\n      if (maximumFractionDigits !== undefined) {\n        percentOptions.maximumFractionDigits = maximumFractionDigits;\n      }\n      formattedNumber = formatter.number(value / 100, percentOptions as unknown);\n      break;\n    }\n    default: {\n      const numberOptions: Intl.NumberFormatOptions = {};\n      if (minimumFractionDigits !== undefined) {\n        numberOptions.minimumFractionDigits = minimumFractionDigits;\n      }\n      if (maximumFractionDigits !== undefined) {\n        numberOptions.maximumFractionDigits = maximumFractionDigits;\n      }\n      formattedNumber = formatter.number(value, numberOptions as unknown);\n    }\n  }\n\n  return (\n    <span\n      className={className}\n      lang={locale}\n    >\n      {formattedNumber}\n    </span>\n  );\n};\n\nFormatNumberComponent.displayName = 'FormatNumber';\nexport const FormatNumber = memo(FormatNumberComponent);\n\ninterface PluralProps {\n  count: number;\n  category: 'items' | 'users' | 'notifications';\n  className?: string;\n}\n\nconst PluralComponent = ({ count, category, className }: PluralProps) => {\n  const t = useTranslations(`formatting.plurals.${category}`);\n\n  const getPluralKey = (count: number): 'zero' | 'one' | 'other' => {\n    if (count === 0) return 'zero';\n    if (count === 1) return 'one';\n    return 'other';\n  };\n\n  const pluralKey = getPluralKey(count);\n  const message = t(pluralKey, { count });\n\n  return <span className={className}>{message}</span>;\n};\n\nPluralComponent.displayName = 'Plural';\nexport const Plural = memo(PluralComponent);\n\ninterface RichTextProps {\n  text: string;\n  values?: Record<string, React.ReactNode>;\n  className?: string;\n}\n\nconst RichTextComponent = ({ text, values = {}, className }: RichTextProps) => {\n  // Simple rich text processor for basic formatting\n  const processText = (text: string): React.ReactNode => {\n    // Replace {key} with values\n    let processed = text;\n    Object.entries(values).forEach(([key, value]) => {\n      const placeholder = `{${key}}`;\n      if (typeof value === 'string' || typeof value === 'number') {\n        processed = processed.replace(\n          new RegExp(placeholder, 'g'),\n          String(value),\n        );\n      }\n    });\n\n    // Process basic markdown-like formatting\n    return processed.split(/(\\*\\*.*?\\*\\*|\\*.*?\\*|`.*?`)/).map((part, index) => {\n      if (part.startsWith('**') && part.endsWith('**')) {\n        return <strong key={index}>{part.slice(2, -2)}</strong>;\n      }\n      if (part.startsWith('*') && part.endsWith('*')) {\n        return <em key={index}>{part.slice(1, -1)}</em>;\n      }\n      if (part.startsWith('`') && part.endsWith('`')) {\n        return (\n          <code\n            key={index}\n            className='bg-muted rounded px-1'\n          >\n            {part.slice(1, -1)}\n          </code>\n        );\n      }\n      return part;\n    });\n  };\n\n  return <span className={className}>{processText(text)}</span>;\n};\n\nRichTextComponent.displayName = 'RichText';\nexport const RichText = memo(RichTextComponent);\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/i18n/locale-detection-demo.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/i18n/locale-switcher/config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/i18n/locale-switcher/enhanced-locale-switcher-component.tsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'DropdownMenuItem' is defined but never used. Allowed unused vars must match /^_/u.","line":12,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":19,"suggestions":[{"messageId":"removeVar","data":{"varName":"DropdownMenuItem"},"fix":{"range":[436,456],"text":""},"desc":"Remove unused variable 'DropdownMenuItem'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'DropdownMenuItem' is defined but never used. Allowed unused vars must match /^_/u.","line":12,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":12,"endColumn":19},{"ruleId":"max-lines-per-function","severity":2,"message":"Arrow function has too many lines (127). Maximum allowed is 120.","line":22,"column":48,"nodeType":"ArrowFunctionExpression","messageId":"exceed","endLine":163,"endColumn":2},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0.8.","line":60,"column":34,"nodeType":"Literal","messageId":"noMagic","endLine":60,"endColumn":37},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0.5.","line":62,"column":38,"nodeType":"Literal","messageId":"noMagic","endLine":62,"endColumn":41},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":110,"column":42,"nodeType":"MemberExpression","endLine":110,"endColumn":65},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":112,"column":18,"nodeType":"MemberExpression","endLine":112,"endColumn":41},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":119,"column":18,"nodeType":"MemberExpression","endLine":119,"endColumn":41},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":122,"column":18,"nodeType":"MemberExpression","endLine":122,"endColumn":41}],"suppressedMessages":[],"errorCount":9,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useMemo } from 'react';\nimport { Languages } from 'lucide-react';\nimport { useLocale, useTranslations } from 'next-intl';\nimport { Locale } from '@/types/i18n';\nimport { useClientLocaleDetection } from '@/lib/locale-detection';\nimport { useLocaleStorage } from '@/lib/locale-storage';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuTrigger,\n} from '@/components/ui/dropdown-menu';\nimport { usePathname } from '@/i18n/routing';\nimport { EnhancedLocaleSwitcherProps, LANGUAGE_CONFIG, SOURCE_ICONS } from './config';\nimport { LanguageItem } from './language-item';\nimport { useLanguageSwitch } from './use-language-switch';\n\nexport const EnhancedLocaleSwitcherComponent = ({\n  showDetectionInfo = false,\n  compact = false,\n  className = '',\n}: EnhancedLocaleSwitcherProps) => {\n  const t = useTranslations('language');\n  const locale = useLocale() as Locale;\n  const pathname = usePathname();\n\n  const { switchingTo, switchSuccess, isPending, handleLanguageSwitch } =\n    useLanguageSwitch();\n  const { getStats } = useLocaleStorage();\n  const { detectClientLocale: _detectClientLocale } =\n    useClientLocaleDetection();\n\n  // 计算检测信息 - 使用useMemo避免派生状态\n  const detectionInfo = useMemo(() => {\n    if (!showDetectionInfo) return null;\n\n    const stats = getStats();\n    const detection = _detectClientLocale();\n\n    if (!detection) return null;\n\n    return {\n      source: stats.hasOverride ? 'user' : detection.source,\n      confidence: detection.confidence,\n      isUserOverride: stats.hasOverride,\n    };\n  }, [showDetectionInfo, getStats, _detectClientLocale]);\n\n  const renderDetectionInfo = () => {\n    if (!showDetectionInfo || !detectionInfo) return null;\n\n    const SourceIcon =\n      SOURCE_ICONS[detectionInfo.source as keyof typeof SOURCE_ICONS] ||\n      Languages;\n    const confidenceColor =\n      detectionInfo.confidence > 0.8\n        ? 'green'\n        : detectionInfo.confidence > 0.5\n          ? 'yellow'\n          : 'red';\n\n    return (\n      <>\n        <DropdownMenuSeparator />\n        <DropdownMenuLabel className='text-muted-foreground text-xs'>\n          Detection Info\n        </DropdownMenuLabel>\n        <div className='px-2 py-1 text-xs'>\n          <div className='mb-1 flex items-center justify-between'>\n            <div className='flex items-center space-x-1'>\n              <SourceIcon className='h-3 w-3' />\n              <span>Source: {detectionInfo.source}</span>\n            </div>\n            <Badge\n              variant='outline'\n              className={`text-xs ${\n                confidenceColor === 'green'\n                  ? 'border-green-500 text-green-700'\n                  : confidenceColor === 'yellow'\n                    ? 'border-yellow-500 text-yellow-700'\n                    : 'border-red-500 text-red-700'\n              }`}\n            >\n              {Math.round(detectionInfo.confidence * 100)}%\n            </Badge>\n          </div>\n          {detectionInfo.isUserOverride && (\n            <div className='text-xs text-blue-600'>✓ User preference saved</div>\n          )}\n        </div>\n      </>\n    );\n  };\n\n  return (\n    <DropdownMenu>\n      <DropdownMenuTrigger asChild>\n        <Button\n          variant='ghost'\n          size='sm'\n          className={`relative ${className}`}\n          disabled={isPending}\n        >\n          {compact ? (\n            <div className='flex items-center space-x-1'>\n              <span className='text-sm'>{LANGUAGE_CONFIG[locale].flag}</span>\n              <span className='font-mono text-xs'>\n                {LANGUAGE_CONFIG[locale].code}\n              </span>\n            </div>\n          ) : (\n            <div className='flex items-center space-x-2'>\n              <Languages className='h-4 w-4' />\n              <span className='hidden sm:inline'>\n                {LANGUAGE_CONFIG[locale].nativeName}\n              </span>\n              <span className='font-mono text-xs sm:hidden'>\n                {LANGUAGE_CONFIG[locale].code}\n              </span>\n            </div>\n          )}\n\n          {switchSuccess && (\n            <div className='absolute -top-1 -right-1'>\n              <div className='h-2 w-2 animate-pulse rounded-full bg-green-500' />\n            </div>\n          )}\n\n          <span className='sr-only'>{t('toggle')}</span>\n        </Button>\n      </DropdownMenuTrigger>\n\n      <DropdownMenuContent\n        align='end'\n        className='w-56'\n      >\n        <DropdownMenuLabel className='flex items-center space-x-2'>\n          <Languages className='h-4 w-4' />\n          <span>{t('selectLanguage')}</span>\n        </DropdownMenuLabel>\n        <DropdownMenuSeparator />\n\n        {Object.keys(LANGUAGE_CONFIG).map((lang) => (\n          <LanguageItem\n            key={lang}\n            targetLocale={lang as Locale}\n            currentLocale={locale}\n            switchingTo={switchingTo}\n            pathname={pathname}\n            compact={compact}\n            onLanguageSwitch={handleLanguageSwitch}\n          />\n        ))}\n\n        {renderDetectionInfo()}\n      </DropdownMenuContent>\n    </DropdownMenu>\n  );\n};\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/i18n/locale-switcher/language-item.tsx","messages":[{"ruleId":"security/detect-object-injection","severity":2,"message":"Variable Assigned to Object Injection Sink","line":26,"column":20,"nodeType":"MemberExpression","endLine":26,"endColumn":49}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { memo } from 'react';\nimport { Check, Loader2 } from 'lucide-react';\nimport { Locale } from '@/types/i18n';\nimport { DropdownMenuItem } from '@/components/ui/dropdown-menu';\nimport { Link } from '@/i18n/routing';\nimport { LANGUAGE_CONFIG } from './config';\n\ninterface LanguageItemProps {\n  targetLocale: Locale;\n  currentLocale: Locale;\n  switchingTo: Locale | null;\n  pathname: string;\n  compact: boolean;\n  onLanguageSwitch: (_locale: Locale) => void;\n}\n\nexport const LanguageItem = memo(\n  ({\n    targetLocale,\n    currentLocale,\n    switchingTo,\n    pathname,\n    compact,\n    onLanguageSwitch,\n  }: LanguageItemProps) => {\n    const config = LANGUAGE_CONFIG[targetLocale];\n    const isActive = currentLocale === targetLocale;\n    const isSwitching = switchingTo === targetLocale;\n\n    return (\n      <DropdownMenuItem\n        key={targetLocale}\n        asChild\n      >\n        <Link\n          href={pathname as '/' | '/about' | '/contact' | '/blog' | '/products'}\n          locale={targetLocale}\n          className='flex w-full items-center justify-between'\n          onClick={() => onLanguageSwitch(targetLocale)}\n        >\n          <div className='flex items-center space-x-3'>\n            <span className='text-lg'>{config.flag}</span>\n            <div className='flex flex-col'>\n              <div className='flex items-center space-x-2'>\n                <span className='bg-muted rounded px-1.5 py-0.5 font-mono text-xs'>\n                  {config.code}\n                </span>\n                <span className='font-medium'>{config.nativeName}</span>\n              </div>\n              {!compact && (\n                <span className='text-muted-foreground text-xs'>\n                  {config.name} • {config.region}\n                </span>\n              )}\n            </div>\n          </div>\n\n          <div className='flex items-center space-x-2'>\n            {isSwitching && (\n              <Loader2 className='h-4 w-4 animate-spin text-blue-500' />\n            )}\n            {isActive && !isSwitching && (\n              <Check className='h-4 w-4 text-green-500' />\n            )}\n          </div>\n        </Link>\n      </DropdownMenuItem>\n    );\n  },\n);\n\nLanguageItem.displayName = 'LanguageItem';\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/i18n/locale-switcher/use-language-switch.ts","messages":[{"ruleId":"max-nested-callbacks","severity":2,"message":"Too many nested callbacks (3). Maximum allowed is 2.","line":23,"column":20,"nodeType":"ArrowFunctionExpression","messageId":"exceed","endLine":23,"endColumn":49},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2000.","line":23,"column":51,"nodeType":"Literal","messageId":"noMagic","endLine":23,"endColumn":55}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useTransition } from 'react';\nimport { Locale } from '@/types/i18n';\nimport { useLocaleStorage } from '@/lib/locale-storage';\nimport { TRANSITION_TIMEOUT } from './config';\n\nexport const useLanguageSwitch = () => {\n  const [switchingTo, setSwitchingTo] = useState<Locale | null>(null);\n  const [switchSuccess, setSwitchSuccess] = useState(false);\n  const [isPending, startTransition] = useTransition();\n  const { setUserOverride } = useLocaleStorage();\n\n  const handleLanguageSwitch = (newLocale: Locale) => {\n    setSwitchingTo(newLocale);\n    setSwitchSuccess(false);\n\n    // 保存用户选择\n    setUserOverride(newLocale);\n\n    startTransition(() => {\n      setTimeout(() => {\n        setSwitchingTo(null);\n        setSwitchSuccess(true);\n        setTimeout(() => setSwitchSuccess(false), 2000);\n      }, TRANSITION_TIMEOUT);\n    });\n  };\n\n  return {\n    switchingTo,\n    switchSuccess,\n    isPending,\n    handleLanguageSwitch,\n  };\n};\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/i18n/performance-dashboard.tsx","messages":[{"ruleId":"no-undef","severity":2,"message":"'useDevToolsLayout' is not defined.","line":18,"column":56,"nodeType":"Identifier","messageId":"undef","endLine":18,"endColumn":73},{"ruleId":"no-undef","severity":2,"message":"'useDevToolsLayout' is not defined.","line":180,"column":56,"nodeType":"Identifier","messageId":"undef","endLine":180,"endColumn":73}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useEffect, useState } from 'react';\nimport {\n  evaluatePerformance,\n  PERFORMANCE_TARGETS,\n} from '@/lib/i18n-performance';\nimport { useI18nPerformance } from '@/hooks/use-enhanced-translations';\n\ninterface PerformanceMetrics {\n  averageLoadTime: number;\n  cacheHitRate: number;\n  totalErrors: number;\n  totalRequests: number;\n}\n\nexport function I18nPerformanceDashboard() {\n  const { registerTool, unregisterTool, getClasses } = useDevToolsLayout();\n  const [metrics, setMetrics] = useState<PerformanceMetrics | null>(null);\n  const [isVisible, setIsVisible] = useState(\n    process.env.NODE_ENV === 'development',\n  );\n  const { getMetrics, resetMetrics } = useI18nPerformance();\n\n  // 注册工具到布局管理器\n  useEffect(() => {\n    registerTool('i18nPerformanceDashboard');\n    return () => unregisterTool('i18nPerformanceDashboard');\n  }, [registerTool, unregisterTool]);\n\n  useEffect(() => {\n    const updateMetrics = () => {\n      const currentMetrics = getMetrics();\n      setMetrics(currentMetrics);\n    };\n\n    // 初始加载\n    updateMetrics();\n\n    // 定期更新指标\n    const interval = setInterval(updateMetrics, 5000); // 每5秒更新\n\n    return () => clearInterval(interval);\n  }, [getMetrics]);\n\n  if (!isVisible || !metrics) {\n    return null;\n  }\n\n  const evaluation = evaluatePerformance(metrics);\n\n  return (\n    <div\n      className={`${getClasses('i18nPerformanceDashboard')} rounded-lg border border-gray-200 bg-white p-4 shadow-lg dark:border-gray-700 dark:bg-gray-800`}\n    >\n      <div className='mb-3 flex items-center justify-between'>\n        <h3 className='text-sm font-semibold text-gray-900 dark:text-gray-100'>\n          I18n Performance\n        </h3>\n        <div className='flex items-center gap-2'>\n          <span\n            className={`rounded px-2 py-1 text-xs ${getGradeColor(evaluation.grade)}`}\n          >\n            {evaluation.grade}\n          </span>\n          <button\n            onClick={() => setIsVisible(false)}\n            className='text-gray-400 hover:text-gray-600 dark:hover:text-gray-300'\n          >\n            ×\n          </button>\n        </div>\n      </div>\n\n      <div className='space-y-2 text-xs'>\n        <MetricRow\n          label='Load Time'\n          value={`${metrics.averageLoadTime.toFixed(1)}ms`}\n          target={PERFORMANCE_TARGETS.TRANSLATION_LOAD_TIME.excellent}\n          current={metrics.averageLoadTime}\n          isLowerBetter={true}\n        />\n\n        <MetricRow\n          label='Cache Hit Rate'\n          value={`${metrics.cacheHitRate.toFixed(1)}%`}\n          target={PERFORMANCE_TARGETS.CACHE_HIT_RATE.excellent}\n          current={metrics.cacheHitRate}\n          isLowerBetter={false}\n        />\n\n        <MetricRow\n          label='Total Requests'\n          value={metrics.totalRequests.toString()}\n          target={null}\n          current={metrics.totalRequests}\n        />\n\n        <MetricRow\n          label='Errors'\n          value={metrics.totalErrors.toString()}\n          target={0}\n          current={metrics.totalErrors}\n          isLowerBetter={true}\n        />\n      </div>\n\n      <div className='mt-3 border-t border-gray-200 pt-3 dark:border-gray-600'>\n        <div className='flex items-center justify-between'>\n          <span className='text-xs text-gray-600 dark:text-gray-400'>\n            Overall Score: {evaluation.overallScore}/100\n          </span>\n          <button\n            onClick={resetMetrics}\n            className='text-xs text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300'\n          >\n            Reset\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n\ninterface MetricRowProps {\n  label: string;\n  value: string;\n  target: number | null;\n  current: number;\n  isLowerBetter?: boolean;\n}\n\nfunction MetricRow({\n  label,\n  value,\n  target,\n  current,\n  isLowerBetter = false,\n}: MetricRowProps) {\n  const getStatusColor = () => {\n    if (target === null) return 'text-gray-600 dark:text-gray-400';\n\n    const isGood = isLowerBetter ? current <= target : current >= target;\n\n    return isGood\n      ? 'text-green-600 dark:text-green-400'\n      : 'text-red-600 dark:text-red-400';\n  };\n\n  return (\n    <div className='flex items-center justify-between'>\n      <span className='text-gray-700 dark:text-gray-300'>{label}:</span>\n      <span className={getStatusColor()}>{value}</span>\n    </div>\n  );\n}\n\nfunction getGradeColor(grade: string): string {\n  switch (grade) {\n    case 'A':\n      return 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200';\n    case 'B':\n      return 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200';\n    case 'C':\n      return 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200';\n    case 'D':\n      return 'bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200';\n    case 'F':\n      return 'bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200';\n    default:\n      return 'bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200';\n  }\n}\n\n/**\n * 简化版性能指示器\n * 只显示关键指标，适合生产环境\n */\nexport function I18nPerformanceIndicator() {\n  const { registerTool, unregisterTool, getClasses } = useDevToolsLayout();\n  const [metrics, setMetrics] = useState<PerformanceMetrics | null>(null);\n  const [showDetails, _setShowDetails] = useState(false);\n  const { getMetrics } = useI18nPerformance();\n\n  // 注册工具到布局管理器\n  useEffect(() => {\n    registerTool('i18nPerformanceIndicator');\n    return () => unregisterTool('i18nPerformanceIndicator');\n  }, [registerTool, unregisterTool]);\n\n  useEffect(() => {\n    const updateMetrics = () => {\n      const currentMetrics = getMetrics();\n      setMetrics(currentMetrics);\n    };\n\n    updateMetrics();\n    const interval = setInterval(updateMetrics, 10000); // 每10秒更新\n\n    return () => clearInterval(interval);\n  }, [getMetrics]);\n\n  if (!metrics) return null;\n\n  const evaluation = evaluatePerformance(metrics);\n  const hasIssues = evaluation.overallScore < 80;\n\n  // 只在有性能问题时显示\n  if (!hasIssues && !showDetails) return null;\n\n  return (\n    <div className={getClasses('i18nPerformanceIndicator')}>\n      <button\n        onClick={() => _setShowDetails(!showDetails)}\n        className={`rounded-full px-3 py-2 text-xs font-medium transition-colors ${\n          hasIssues\n            ? 'bg-red-100 text-red-800 hover:bg-red-200 dark:bg-red-900 dark:text-red-200'\n            : 'bg-green-100 text-green-800 hover:bg-green-200 dark:bg-green-900 dark:text-green-200'\n        }`}\n      >\n        I18n: {evaluation.grade}\n      </button>\n\n      {showDetails && (\n        <div className='absolute bottom-full left-0 mb-2 min-w-48 rounded-lg border border-gray-200 bg-white p-3 shadow-lg dark:border-gray-700 dark:bg-gray-800'>\n          <div className='space-y-1 text-xs'>\n            <div>Load: {metrics.averageLoadTime.toFixed(1)}ms</div>\n            <div>Cache: {metrics.cacheHitRate.toFixed(1)}%</div>\n            <div>Errors: {metrics.totalErrors}</div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/i18n/translation-fallback.tsx","messages":[{"ruleId":"react/display-name","severity":2,"message":"Component definition is missing display name","line":16,"column":36,"nodeType":"CallExpression","messageId":"noDisplayName","endLine":65,"endColumn":2},{"ruleId":"react/display-name","severity":2,"message":"Component definition is missing display name","line":74,"column":32,"nodeType":"CallExpression","messageId":"noDisplayName","endLine":120,"endColumn":2},{"ruleId":"react/display-name","severity":2,"message":"Component definition is missing display name","line":126,"column":34,"nodeType":"CallExpression","messageId":"noDisplayName","endLine":159,"endColumn":2},{"ruleId":"no-unused-vars","severity":2,"message":"'_error' is defined but never used.","line":183,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":183,"endColumn":22},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_error' is defined but never used.","line":183,"column":16,"nodeType":null,"messageId":"unusedVar","endLine":183,"endColumn":22}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { memo, useEffect, useState } from 'react';\nimport { AlertTriangle } from 'lucide-react';\nimport { useLocale, useTranslations } from 'next-intl';\n\n// import { Alert, AlertDescription } from '@/components/ui/alert';\n\ninterface TranslationFallbackProps {\n  translationKey: string;\n  fallbackText?: string | undefined;\n  showWarning?: boolean;\n  className?: string | undefined;\n}\n\nexport const TranslationFallback = memo(\n  ({\n    translationKey,\n    fallbackText,\n    showWarning = process.env.NODE_ENV === 'development',\n    className,\n  }: TranslationFallbackProps) => {\n    const t = useTranslations();\n    const locale = useLocale();\n    const [hasMissingTranslation, setHasMissingTranslation] = useState(false);\n\n    useEffect(() => {\n      // Check if translation exists\n      try {\n        const translation = t(translationKey as never);\n        if (translation === translationKey) {\n          setHasMissingTranslation(true);\n          // Log missing translation in development\n          if (process.env.NODE_ENV === 'development') {\n            console.warn(\n              `Missing translation for key: ${translationKey} in locale: ${locale}`,\n            );\n          }\n        }\n      } catch {\n        setHasMissingTranslation(true);\n      }\n    }, [translationKey, locale, t]);\n\n    if (hasMissingTranslation) {\n      const displayText = fallbackText || translationKey;\n\n      return (\n        <span className={className}>\n          {displayText}\n          {showWarning && (\n            <span\n              className='ml-1 text-yellow-500'\n              title='Translation missing'\n            >\n              ⚠️\n            </span>\n          )}\n        </span>\n      );\n    }\n\n    return <span className={className}>{t(translationKey as never)}</span>;\n  },\n);\n\ninterface SafeTranslationProps {\n  translationKey: string;\n  values?: Record<string, string | number | boolean>;\n  fallbackText?: string | undefined;\n  className?: string | undefined;\n}\n\nexport const SafeTranslation = memo(\n  ({\n    translationKey,\n    values,\n    fallbackText,\n    className,\n  }: SafeTranslationProps) => {\n    const t = useTranslations();\n    const locale = useLocale();\n\n    try {\n      const translation = t(translationKey as never, values as unknown);\n\n      // Check if translation actually exists (not just returning the key)\n      if (translation === translationKey && !fallbackText) {\n        return (\n          <TranslationFallback\n            translationKey={translationKey}\n            fallbackText={fallbackText}\n            className={className}\n          />\n        );\n      }\n\n      return (\n        <span\n          className={className}\n          lang={locale}\n        >\n          {translation}\n        </span>\n      );\n    } catch (error) {\n      if (process.env.NODE_ENV === 'development') {\n        console.error(`Translation error for key: ${translationKey}`, error);\n      }\n\n      return (\n        <TranslationFallback\n          translationKey={translationKey}\n          fallbackText={fallbackText || 'Translation error'}\n          className={className}\n        />\n      );\n    }\n  },\n);\n\ninterface TranslationStatusProps {\n  className?: string;\n}\n\nexport const TranslationStatus = memo(\n  ({ className }: TranslationStatusProps) => {\n    const locale = useLocale();\n    const t = useTranslations('language');\n    const [missingCount, setMissingCount] = useState(0);\n\n    useEffect(() => {\n      // In a real application, you would check translation coverage\n      // This is a simplified example\n      const checkTranslationCoverage = () => {\n        // Simulate checking translation coverage\n        const coverage = Math.random() * 100;\n        if (coverage < 95) {\n          setMissingCount(Math.floor((100 - coverage) * 0.1));\n        }\n      };\n\n      checkTranslationCoverage();\n    }, [locale]);\n\n    if (missingCount === 0) {\n      return null;\n    }\n\n    return (\n      <div\n        className={`flex items-center gap-2 rounded-md border border-yellow-200 bg-yellow-50 p-3 ${className || ''}`}\n      >\n        <AlertTriangle className='h-4 w-4 text-yellow-600' />\n        <span className='text-sm text-yellow-800'>{t('fallbackWarning')}</span>\n      </div>\n    );\n  },\n);\n\n// Hook for checking translation completeness\nexport function useTranslationStatus() {\n  const locale = useLocale();\n  const [status, setStatus] = useState({\n    isComplete: true,\n    missingKeys: [] as string[],\n    coverage: 100,\n  });\n\n  useEffect(() => {\n    // In a real application, you would implement actual translation checking\n    // This is a placeholder implementation\n    const checkStatus = async () => {\n      try {\n        // Simulate API call to check translation status\n        const response = await fetch(\n          `/api/translations/status?locale=${locale}`,\n        );\n        if (response.ok) {\n          const data = await response.json();\n          setStatus(data);\n        }\n      } catch (_error) {\n        // Fallback to optimistic status\n        setStatus({\n          isComplete: true,\n          missingKeys: [],\n          coverage: 100,\n        });\n      }\n    };\n\n    checkStatus();\n  }, [locale]);\n\n  return status;\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/i18n/translation-preloader.tsx","messages":[{"ruleId":"default-case","severity":2,"message":"Expected a default case.","line":55,"column":9,"nodeType":"SwitchStatement","messageId":"missingDefaultCase","endLine":92,"endColumn":10},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":219,"column":10,"nodeType":"MemberExpression","endLine":219,"endColumn":32}],"suppressedMessages":[{"ruleId":"no-case-declarations","severity":2,"message":"Unexpected lexical declaration in case block.","line":74,"column":13,"nodeType":"VariableDeclaration","messageId":"unexpected","endLine":80,"endColumn":15,"suggestions":[{"messageId":"addBrackets","fix":{"range":[1680,2422],"text":"{ const handleFirstInteraction = async () => {\n              await preloadTranslations(targetLocales);\n              // 移除事件监听器\n              document.removeEventListener('click', handleFirstInteraction);\n              document.removeEventListener('keydown', handleFirstInteraction);\n              document.removeEventListener('scroll', handleFirstInteraction);\n            };\n\n            document.addEventListener('click', handleFirstInteraction, {\n              once: true,\n            });\n            document.addEventListener('keydown', handleFirstInteraction, {\n              once: true,\n            });\n            document.addEventListener('scroll', handleFirstInteraction, {\n              once: true,\n            });\n            break; }"},"desc":"Add {} brackets around the case block."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\n/* eslint-disable no-case-declarations */\nimport { useEffect } from 'react';\nimport { logger } from '@/lib/logger';\nimport { MINUTE_MS } from '@/constants/units';\nimport { useLocale } from 'next-intl';\nimport {\n  I18nPerformanceMonitor,\n  preloadTranslations,\n} from '@/lib/i18n-performance';\n\ninterface TranslationPreloaderProps {\n  /**\n   * 要预加载的语言列表\n   * 默认预加载当前语言和英文作为回退\n   */\n  locales?: string[];\n\n  /**\n   * 是否启用性能监控\n   */\n  enableMonitoring?: boolean;\n\n  /**\n   * 预加载策略\n   * - 'immediate': 立即预加载\n   * - 'idle': 在浏览器空闲时预加载\n   * - 'interaction': 在用户交互时预加载\n   */\n  strategy?: 'immediate' | 'idle' | 'interaction';\n\n  /**\n   * 预加载优先级\n   */\n  priority?: 'high' | 'normal' | 'low';\n}\n\nexport function TranslationPreloader({\n  locales,\n  enableMonitoring = true,\n  strategy = 'idle',\n  priority: _priority = 'normal',\n}: TranslationPreloaderProps) {\n  const currentLocale = useLocale();\n\n  useEffect(() => {\n    // 确定要预加载的语言\n    const targetLocales = locales || [currentLocale, 'en'];\n\n    const preloadWithStrategy = async () => {\n      const startTime = performance.now();\n\n      try {\n        switch (strategy) {\n          case 'immediate':\n            await preloadTranslations(targetLocales);\n            break;\n\n          case 'idle':\n            if ('requestIdleCallback' in window) {\n              requestIdleCallback(async () => {\n                await preloadTranslations(targetLocales);\n              });\n            } else {\n              // 回退到setTimeout\n              setTimeout(async () => {\n                await preloadTranslations(targetLocales);\n              }, 100);\n            }\n            break;\n\n          case 'interaction':\n            const handleFirstInteraction = async () => {\n              await preloadTranslations(targetLocales);\n              // 移除事件监听器\n              document.removeEventListener('click', handleFirstInteraction);\n              document.removeEventListener('keydown', handleFirstInteraction);\n              document.removeEventListener('scroll', handleFirstInteraction);\n            };\n\n            document.addEventListener('click', handleFirstInteraction, {\n              once: true,\n            });\n            document.addEventListener('keydown', handleFirstInteraction, {\n              once: true,\n            });\n            document.addEventListener('scroll', handleFirstInteraction, {\n              once: true,\n            });\n            break;\n        }\n\n        // 记录性能指标\n        if (enableMonitoring) {\n          const loadTime = performance.now() - startTime;\n          I18nPerformanceMonitor.recordLoadTime(loadTime);\n        }\n      } catch (error) {\n        logger.error('Translation preload failed', { error: error as Error });\n        if (enableMonitoring) {\n          I18nPerformanceMonitor.recordError();\n        }\n      }\n    };\n\n    preloadWithStrategy();\n  }, [currentLocale, locales, strategy, enableMonitoring]);\n\n  // 这个组件不渲染任何内容\n  return null;\n}\n\n/**\n * 关键路径翻译预加载器\n * 专门用于预加载关键页面的翻译内容\n */\nexport function CriticalTranslationPreloader() {\n  const currentLocale = useLocale();\n\n  useEffect(() => {\n    // 预加载关键翻译命名空间\n    const preloadCriticalTranslations = async () => {\n      const startTime = performance.now();\n\n      try {\n        // 预加载当前语言和英文回退\n        await preloadTranslations([currentLocale, 'en']);\n\n        const loadTime = performance.now() - startTime;\n        I18nPerformanceMonitor.recordLoadTime(loadTime);\n\n        // 记录缓存命中\n        I18nPerformanceMonitor.recordCacheHit();\n      } catch (error) {\n        logger.error('Critical translation preload failed', { error: error as Error });\n        I18nPerformanceMonitor.recordError();\n      }\n    };\n\n    // 使用高优先级预加载\n    if ('scheduler' in window && 'postTask' in (window as unknown).scheduler) {\n      (window as unknown).scheduler.postTask(preloadCriticalTranslations, {\n        priority: 'user-blocking',\n      });\n    } else {\n      // 回退到立即执行\n      preloadCriticalTranslations();\n    }\n  }, [currentLocale]);\n\n  return null;\n}\n\n/**\n * 智能预加载逻辑\n */\nasync function performSmartPreload(currentLocale: string) {\n  // 获取当前页面路径\n  const currentPath = window.location.pathname;\n\n  // 基于路径预测需要的翻译\n  const predictedNamespaces = getPredictedNamespaces(currentPath);\n\n  // 预加载预测的翻译内容\n  for (const namespace of predictedNamespaces) {\n    try {\n      await preloadTranslations([currentLocale]);\n    } catch (error) {\n      logger.warn(`Failed to preload namespace ${namespace}`, { error: error as Error });\n    }\n  }\n}\n\n/**\n * 调度智能预加载\n */\nfunction scheduleSmartPreload(preloadFn: () => Promise<void>) {\n  // 在浏览器空闲时执行智能预加载\n  if ('requestIdleCallback' in window) {\n    requestIdleCallback(preloadFn, { timeout: 2000 });\n  } else {\n    setTimeout(preloadFn, 500);\n  }\n}\n\n/**\n * 智能翻译预加载器\n * 基于用户行为和页面路由智能预加载翻译\n */\nexport function SmartTranslationPreloader() {\n  const currentLocale = useLocale();\n\n  useEffect(() => {\n    const smartPreload = () => performSmartPreload(currentLocale);\n    scheduleSmartPreload(smartPreload);\n  }, [currentLocale]);\n\n  return null;\n}\n\n/**\n * 根据页面路径预测需要的翻译命名空间\n */\nfunction getPredictedNamespaces(path: string): string[] {\n  const namespaceMap: Record<string, string[]> = {\n    '/': ['home', 'hero', 'features'],\n    '/about': ['about', 'team', 'company'],\n    '/guanyu': ['about', 'team', 'company'],\n    '/contact': ['contact', 'form', 'support'],\n    '/lianxi': ['contact', 'form', 'support'],\n    '/blog': ['blog', 'articles', 'content'],\n    '/products': ['products', 'catalog', 'pricing'],\n  };\n\n  // 获取基础路径（移除语言前缀）\n  const basePath = path.replace(/^\\/[a-z]{2}(?=\\/|$)/, '') || '/';\n\n  return namespaceMap[basePath] || ['common'];\n}\n\n/**\n * 性能监控预加载器\n * 专门用于监控翻译性能并优化预加载策略\n */\nexport function PerformanceMonitoringPreloader() {\n  useEffect(() => {\n    // 定期清理过期缓存\n    const cleanupInterval = setInterval(\n      () => {\n        // 这里可以添加缓存清理逻辑\n\n        logger.debug('Translation cache cleanup performed');\n      },\n      5 * MINUTE_MS,\n    ); // 每5分钟清理一次\n\n    // 定期报告性能指标\n    const reportingInterval = setInterval(() => {\n      const metrics = I18nPerformanceMonitor.getMetrics();\n\n      // 如果性能指标异常，记录警告\n      if (metrics.averageLoadTime > 200) {\n        logger.warn('Translation load time exceeds target', { metrics });\n      }\n\n      if (metrics.cacheHitRate < 90) {\n        logger.warn('Translation cache hit rate below target', { metrics });\n      }\n    }, MINUTE_MS); // 每分钟检查一次\n\n    return () => {\n      clearInterval(cleanupInterval);\n      clearInterval(reportingInterval);\n    };\n  }, []);\n\n  return null;\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/language-toggle.tsx","messages":[{"ruleId":"max-nested-callbacks","severity":2,"message":"Too many nested callbacks (3). Maximum allowed is 2.","line":33,"column":20,"nodeType":"ArrowFunctionExpression","messageId":"exceed","endLine":33,"endColumn":49}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { memo, useState, useTransition } from 'react';\nimport { Check, Languages, Loader2 } from 'lucide-react';\nimport { useLocale, useTranslations } from 'next-intl';\nimport { Button } from '@/components/ui/button';\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuTrigger,\n} from '@/components/ui/dropdown-menu';\nimport { Link, usePathname } from '@/i18n/routing';\n\nconst TRANSITION_TIMEOUT = 1000; // 1 second timeout for language switch\n\n// Custom hook for language switching logic\nconst useLanguageSwitch = () => {\n  const [switchingTo, setSwitchingTo] = useState<string | null>(null);\n  const [switchSuccess, setSwitchSuccess] = useState(false);\n  const [isPending, startTransition] = useTransition();\n\n  const handleLanguageSwitch = (newLocale: string) => {\n    setSwitchingTo(newLocale);\n    setSwitchSuccess(false);\n\n    startTransition(() => {\n      // The transition will be handled by the Link component\n      setTimeout(() => {\n        setSwitchingTo(null);\n        setSwitchSuccess(true);\n        // Hide success indicator after 2 seconds\n        setTimeout(() => setSwitchSuccess(false), 2000);\n      }, TRANSITION_TIMEOUT);\n    });\n  };\n\n  return {\n    switchingTo,\n    switchSuccess,\n    isPending,\n    handleLanguageSwitch,\n  };\n};\n\nexport const LanguageToggle = memo(() => {\n  const t = useTranslations('language');\n  const locale = useLocale();\n  const pathname = usePathname();\n  const { switchingTo, isPending, handleLanguageSwitch } = useLanguageSwitch();\n\n  return (\n    <DropdownMenu data-testid='language-dropdown-menu'>\n      <DropdownMenuTrigger\n        asChild\n        data-testid='language-dropdown-trigger'\n      >\n        <Button\n          variant='outline'\n          size='icon'\n          disabled={isPending}\n          data-testid='language-toggle-button'\n        >\n          {isPending ? (\n            <Loader2 className='h-[1.2rem] w-[1.2rem] animate-spin' />\n          ) : (\n            <Languages\n              className='h-[1.2rem] w-[1.2rem]'\n              data-testid='languages-icon'\n            />\n          )}\n          <span className='sr-only'>{t('toggle')}</span>\n        </Button>\n      </DropdownMenuTrigger>\n      <DropdownMenuContent\n        align='end'\n        data-testid='language-dropdown-content'\n      >\n        <DropdownMenuItem\n          asChild\n          data-testid='language-dropdown-item'\n        >\n          <Link\n            href={pathname}\n            locale='en'\n            className='flex items-center'\n            onClick={() => handleLanguageSwitch('en')}\n            data-testid='language-link-en'\n            data-locale='en'\n            role='menuitem'\n          >\n            <span className='bg-muted mr-2 rounded px-1.5 py-0.5 font-mono text-xs'>\n              EN\n            </span>\n            <span>{t('english')}</span>\n            {switchingTo === 'en' && (\n              <Loader2 className='ml-auto h-4 w-4 animate-spin' />\n            )}\n            {locale === 'en' && switchingTo !== 'en' && (\n              <Check\n                className='ml-auto h-4 w-4 text-green-500'\n                data-testid='check-icon'\n              />\n            )}\n          </Link>\n        </DropdownMenuItem>\n        <DropdownMenuItem\n          asChild\n          data-testid='language-dropdown-item'\n        >\n          <Link\n            href={pathname}\n            locale='zh'\n            className='flex items-center'\n            onClick={() => handleLanguageSwitch('zh')}\n            data-testid='language-link-zh'\n            data-locale='zh'\n            role='menuitem'\n          >\n            <span className='bg-muted mr-2 rounded px-1.5 py-0.5 font-mono text-xs'>\n              ZH\n            </span>\n            <span>{t('chinese')}</span>\n            {switchingTo === 'zh' && (\n              <Loader2 className='ml-auto h-4 w-4 animate-spin' />\n            )}\n            {locale === 'zh' && switchingTo !== 'zh' && (\n              <Check\n                className='ml-auto h-4 w-4 text-green-500'\n                data-testid='check-icon'\n              />\n            )}\n          </Link>\n        </DropdownMenuItem>\n      </DropdownMenuContent>\n    </DropdownMenu>\n  );\n});\n\nLanguageToggle.displayName = 'LanguageToggle';\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/layout/__tests__/header.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/layout/__tests__/language-switcher/setup.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/layout/__tests__/main-navigation.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/layout/__tests__/mobile-navigation-basic-core.test.tsx","messages":[],"suppressedMessages":[{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":51,"column":10,"nodeType":"MemberExpression","endLine":51,"endColumn":27,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/layout/__tests__/mobile-navigation-basic.test.tsx","messages":[],"suppressedMessages":[{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":56,"column":10,"nodeType":"MemberExpression","endLine":56,"endColumn":27,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/layout/__tests__/mobile-navigation-edge-cases-advanced.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/layout/__tests__/mobile-navigation-edge-cases-core.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/layout/__tests__/mobile-navigation-items-accessibility-core.test.tsx","messages":[],"suppressedMessages":[{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":47,"column":10,"nodeType":"MemberExpression","endLine":47,"endColumn":27,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/layout/__tests__/mobile-navigation-items-accessibility.test.tsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Declaration or statement expected.","line":113,"column":4}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @vitest-environment jsdom\n */\n\nimport { render, screen } from '@testing-library/react';\nimport userEvent from '@testing-library/user-event';\nimport { usePathname } from 'next/navigation';\nimport { useTranslations } from 'next-intl';\nimport React from 'react';\nimport { beforeEach, describe, expect, it, vi } from 'vitest';\nimport { MobileNavigation } from '../mobile-navigation';\n\n// Mock next-intl\nvi.mock('next-intl', () => ({\n  useTranslations: vi.fn(),\n}));\n\n// Mock next/navigation\nvi.mock('next/navigation', () => ({\n  usePathname: vi.fn(),\n}));\n\n// Mock Lucide React icons\nvi.mock('lucide-react', () => ({\n  Menu: () => <span data-testid='menu-icon'>☰</span>,\n  X: () => <span data-testid='close-icon'>✕</span>,\n}));\n\ndescribe('Mobile Navigation - Advanced Integration Tests', () => {\n  let user: ReturnType<typeof userEvent.setup>;\n\n  beforeEach(() => {\n    user = userEvent.setup();\n    vi.clearAllMocks();\n\n    // Setup default mocks\n    (useTranslations as ReturnType<typeof vi.fn>).mockReturnValue((key: string) => {\n      const translations: Record<string, string> = {\n        'navigation.home': 'Home',\n        'navigation.about': 'About',\n        'navigation.services': 'Services',\n        'navigation.contact': 'Contact',\n        'navigation.menu': 'Menu',\n        'navigation.close': 'Close',\n      };\n      // eslint-disable-next-line security/detect-object-injection\n  return translations[key] || key; // key 来自测试数据，安全\n    });\n\n    (usePathname as ReturnType<typeof vi.fn>).mockReturnValue('/');\n  });\n\n  describe('Complex Accessibility Scenarios', () => {\n    it('should handle complex keyboard navigation patterns', async () => {\n      render(<MobileNavigation />);\n\n      const toggleButton = screen.getByRole('button', { name: /menu/i });\n      await user.click(toggleButton);\n\n      // Test complex keyboard navigation\n      const navigation = screen.getByRole('navigation');\n      const links = screen.getAllByRole('link');\n\n      // Tab through all links\n      for (const link of links) {\n        await user.tab();\n        expect(link).toHaveFocus();\n      }\n\n      // Escape should close menu\n      await user.keyboard('{Escape}');\n      expect(screen.queryByRole('navigation')).not.toBeInTheDocument();\n    });\n\n    it('should handle advanced screen reader scenarios', async () => {\n      render(<MobileNavigation />);\n\n      const toggleButton = screen.getByRole('button', { name: /menu/i });\n\n      // Test ARIA live regions and announcements\n      expect(toggleButton).toHaveAttribute('aria-expanded', 'false');\n\n      await user.click(toggleButton);\n      expect(toggleButton).toHaveAttribute('aria-expanded', 'true');\n\n      // Test navigation landmark\n      const navigation = screen.getByRole('navigation');\n      expect(navigation).toHaveAttribute('aria-label');\n    });\n\n    it('should handle performance optimization in complex scenarios', async () => {\n      // Test multiple rapid interactions\n      render(<MobileNavigation />);\n\n      const toggleButton = screen.getByRole('button', { name: /menu/i });\n\n      // Rapid open/close cycles\n      for (let i = 0; i < 3; i++) {\n        await user.click(toggleButton);\n        expect(screen.getByRole('navigation')).toBeInTheDocument();\n\n        await user.click(toggleButton);\n        expect(screen.queryByRole('navigation')).not.toBeInTheDocument();\n      }\n    });\n  });\n});\n\n      const homeLink = screen.getByRole('link', { name: 'Home' });\n      await user.click(homeLink);\n\n      expect(trigger).toHaveAttribute('aria-expanded', 'false');\n    });\n\n    it('supports keyboard navigation between items', async () => {\n      render(<MobileNavigation />);\n\n      const trigger = screen.getByRole('button');\n      await user.click(trigger);\n\n      const homeLink = screen.getByRole('link', { name: 'Home' });\n      const aboutLink = screen.getByRole('link', { name: 'About' });\n\n      homeLink.focus();\n      expect(homeLink).toHaveFocus();\n\n      await user.tab();\n      expect(aboutLink).toHaveFocus();\n    });\n\n    it('handles missing translations gracefully', async () => {\n      (useTranslations as ReturnType<typeof vi.fn>).mockReturnValue((key: string) => key);\n\n      render(<MobileNavigation />);\n\n      const trigger = screen.getByRole('button');\n      await user.click(trigger);\n\n      // Should still render with fallback keys\n      expect(screen.getByText('navigation.home')).toBeInTheDocument();\n      expect(screen.getByText('navigation.about')).toBeInTheDocument();\n    });\n\n    it('renders navigation items in correct order', async () => {\n      render(<MobileNavigation />);\n\n      const trigger = screen.getByRole('button');\n      await user.click(trigger);\n\n      const links = screen.getAllByRole('link');\n      const linkTexts = links.map(link => link.textContent);\n\n      expect(linkTexts).toEqual(['Home', 'About', 'Services', 'Contact']);\n    });\n\n    it('applies consistent styling to navigation items', async () => {\n      render(<MobileNavigation />);\n\n      const trigger = screen.getByRole('button');\n      await user.click(trigger);\n\n      const links = screen.getAllByRole('link');\n\n      links.forEach(link => {\n        expect(link).toHaveClass('block', 'px-4', 'py-2');\n      });\n    });\n\n    it('supports custom navigation item styling', async () => {\n      render(<MobileNavigation className='custom-nav' />);\n\n      const trigger = screen.getByRole('button');\n      await user.click(trigger);\n\n      const homeLink = screen.getByRole('link', { name: 'Home' });\n      expect(homeLink).toBeInTheDocument();\n    });\n\n    it('handles long navigation item text', async () => {\n      (useTranslations as ReturnType<typeof vi.fn>).mockReturnValue((key: string) => {\n        const translations: Record<string, string> = {\n          'navigation.home': 'Very Long Home Page Title',\n          'navigation.about': 'About Us and Our Company',\n          'navigation.services': 'Our Professional Services',\n          'navigation.contact': 'Contact Information',\n          'navigation.menu': 'Menu',\n          'navigation.close': 'Close',\n        };\n        // eslint-disable-next-line security/detect-object-injection\n  return translations[key] || key; // key 来自测试数据，安全\n      });\n\n      render(<MobileNavigation />);\n\n      const trigger = screen.getByRole('button');\n      await user.click(trigger);\n\n      expect(screen.getByText('Very Long Home Page Title')).toBeInTheDocument();\n      expect(screen.getByText('About Us and Our Company')).toBeInTheDocument();\n    });\n  });\n\n  describe('Accessibility', () => {\n    it('has proper button attributes', () => {\n      render(<MobileNavigation />);\n\n      const trigger = screen.getByRole('button');\n      expect(trigger).toHaveAttribute('type', 'button');\n      expect(trigger).toHaveAttribute('aria-label', 'Menu');\n      expect(trigger).toHaveAttribute('aria-expanded', 'false');\n    });\n\n    it('updates ARIA attributes when menu opens', async () => {\n      render(<MobileNavigation />);\n\n      const trigger = screen.getByRole('button');\n      await user.click(trigger);\n\n      expect(trigger).toHaveAttribute('aria-expanded', 'true');\n      expect(trigger).toHaveAttribute('aria-label', 'Close');\n    });\n\n    it('provides proper navigation landmark', () => {\n      render(<MobileNavigation />);\n\n      const nav = screen.getByRole('navigation');\n      expect(nav).toBeInTheDocument();\n    });\n\n    it('supports screen reader navigation', async () => {\n      render(<MobileNavigation />);\n\n      const trigger = screen.getByRole('button');\n      await user.click(trigger);\n\n      const nav = screen.getByRole('navigation');\n      const links = screen.getAllByRole('link');\n\n      expect(nav).toBeInTheDocument();\n      expect(links.length).toBeGreaterThan(0);\n    });\n\n    it('handles focus management correctly', async () => {\n      render(<MobileNavigation />);\n\n      const trigger = screen.getByRole('button');\n\n      // Focus should be manageable\n      trigger.focus();\n      expect(trigger).toHaveFocus();\n\n      await user.click(trigger);\n      expect(trigger).toHaveFocus();\n    });\n\n    it('supports keyboard navigation', async () => {\n      render(<MobileNavigation />);\n\n      const trigger = screen.getByRole('button');\n\n      // Tab to trigger\n      await user.tab();\n      expect(trigger).toHaveFocus();\n\n      // Activate with Enter\n      await user.keyboard('{Enter}');\n      expect(trigger).toHaveAttribute('aria-expanded', 'true');\n\n      // Close with Escape\n      await user.keyboard('{Escape}');\n      expect(trigger).toHaveAttribute('aria-expanded', 'false');\n    });\n\n    it('provides proper focus indicators', () => {\n      render(<MobileNavigation />);\n\n      const trigger = screen.getByRole('button');\n      expect(trigger).toHaveClass('focus:outline-none', 'focus:ring-2');\n    });\n\n    it('supports high contrast mode', () => {\n      render(<MobileNavigation className='forced-colors:border-[ButtonText]' />);\n\n      const trigger = screen.getByRole('button');\n      expect(trigger).toHaveClass('forced-colors:border-[ButtonText]');\n    });\n\n    it('handles reduced motion preferences', () => {\n      render(<MobileNavigation className='motion-reduce:transition-none' />);\n\n      const trigger = screen.getByRole('button');\n      expect(trigger).toHaveClass('motion-reduce:transition-none');\n    });\n\n    it('provides adequate touch targets', () => {\n      render(<MobileNavigation />);\n\n      const trigger = screen.getByRole('button');\n      expect(trigger).toHaveClass('h-10', 'w-10');\n    });\n\n    it('supports voice control', () => {\n      render(<MobileNavigation />);\n\n      const trigger = screen.getByRole('button');\n\n      // Should have proper semantic structure for voice control\n      expect(trigger).toHaveAttribute('type', 'button');\n      expect(trigger).toHaveAttribute('aria-label');\n    });\n\n    it('handles aria-current for navigation items', async () => {\n      (usePathname as ReturnType<typeof vi.fn>).mockReturnValue('/contact');\n\n      render(<MobileNavigation />);\n\n      const trigger = screen.getByRole('button');\n      await user.click(trigger);\n\n      const contactLink = screen.getByRole('link', { name: 'Contact' });\n      expect(contactLink).toHaveAttribute('aria-current', 'page');\n\n      const homeLink = screen.getByRole('link', { name: 'Home' });\n      expect(homeLink).not.toHaveAttribute('aria-current');\n    });\n\n    it('provides proper link semantics', async () => {\n      render(<MobileNavigation />);\n\n      const trigger = screen.getByRole('button');\n      await user.click(trigger);\n\n      const links = screen.getAllByRole('link');\n\n      links.forEach(link => {\n        expect(link).toHaveAttribute('href');\n      });\n    });\n\n    it('supports internationalization', async () => {\n      (useTranslations as ReturnType<typeof vi.fn>).mockReturnValue((key: string) => {\n        const translations: Record<string, string> = {\n          'navigation.home': '首页',\n          'navigation.about': '关于我们',\n          'navigation.services': '服务',\n          'navigation.contact': '联系我们',\n          'navigation.menu': '菜单',\n          'navigation.close': '关闭',\n        };\n        // eslint-disable-next-line security/detect-object-injection\n  return translations[key] || key; // key 来自测试数据，安全\n      });\n\n      render(<MobileNavigation />);\n\n      const trigger = screen.getByRole('button');\n      expect(trigger).toHaveAttribute('aria-label', '菜单');\n\n      await user.click(trigger);\n      expect(trigger).toHaveAttribute('aria-label', '关闭');\n\n      expect(screen.getByText('首页')).toBeInTheDocument();\n      expect(screen.getByText('关于我们')).toBeInTheDocument();\n    });\n\n    it('handles complex accessibility scenarios', async () => {\n      render(<MobileNavigation />);\n\n      const trigger = screen.getByRole('button');\n      const nav = screen.getByRole('navigation');\n\n      // Initial state\n      expect(trigger).toHaveAttribute('aria-expanded', 'false');\n      expect(nav).toBeInTheDocument();\n\n      // Open menu\n      await user.click(trigger);\n      expect(trigger).toHaveAttribute('aria-expanded', 'true');\n\n      // Navigate to link\n      const homeLink = screen.getByRole('link', { name: 'Home' });\n      homeLink.focus();\n      expect(homeLink).toHaveFocus();\n\n      // Close menu\n      await user.keyboard('{Escape}');\n      expect(trigger).toHaveAttribute('aria-expanded', 'false');\n      expect(trigger).toHaveFocus();\n    });\n\n    it('maintains accessibility during state changes', async () => {\n      render(<MobileNavigation />);\n\n      const trigger = screen.getByRole('button');\n\n      // Test multiple state changes\n      for (let i = 0; i < 3; i++) {\n        await user.click(trigger);\n        expect(trigger).toHaveAttribute('aria-expanded', 'true');\n\n        await user.click(trigger);\n        expect(trigger).toHaveAttribute('aria-expanded', 'false');\n      }\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/layout/__tests__/mobile-navigation-responsive-basic.test.tsx","messages":[],"suppressedMessages":[{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":56,"column":10,"nodeType":"MemberExpression","endLine":56,"endColumn":27,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/layout/__tests__/mobile-navigation-responsive-edge-cases.test.tsx","messages":[],"suppressedMessages":[{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":58,"column":10,"nodeType":"MemberExpression","endLine":58,"endColumn":27,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/layout/__tests__/mobile-navigation-responsive.test.tsx","messages":[],"suppressedMessages":[{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":58,"column":10,"nodeType":"MemberExpression","endLine":58,"endColumn":27,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/layout/__tests__/mobile-navigation.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/layout/__tests__/test-utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/layout/footer.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/layout/header.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/layout/index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/layout/language-switcher.tsx","messages":[{"ruleId":"max-nested-callbacks","severity":2,"message":"Too many nested callbacks (3). Maximum allowed is 2.","line":96,"column":48,"nodeType":"ArrowFunctionExpression","messageId":"exceed","endLine":98,"endColumn":10}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Language Switcher Component\n *\n * Enhanced language switching component for the navigation bar.\n * Features smooth transitions, loading states, and accessibility.\n */\n'use client';\n\nimport { memo, useEffect, useRef, useState, useTransition } from 'react';\nimport { Check, Globe, Languages, Loader2 } from 'lucide-react';\nimport { useLocale, useTranslations } from 'next-intl';\nimport { NAVIGATION_ARIA } from '@/lib/navigation';\nimport { cn } from '@/lib/utils';\nimport { Button } from '@/components/ui/button';\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuTrigger,\n} from '@/components/ui/dropdown-menu';\nimport { LOCALES_CONFIG } from '@/config/paths';\nimport { UI_TIMINGS } from '@/constants/i18n-constants';\nimport { Link, usePathname } from '@/i18n/routing';\n\n/**\n * Language Switcher Component\n *\n * Enhanced language switching component for the navigation bar.\n * Features smooth transitions, loading states, and accessibility.\n */\n\n// Use centralized timing constants to avoid magic numbers\nconst TRANSITION_DIVISOR = 2;\nconst TRANSITION_TIMEOUT =\n  UI_TIMINGS.LANGUAGE_SWITCH_ANIMATION / TRANSITION_DIVISOR; // 1 second for transition\nconst SUCCESS_INDICATOR_TIMEOUT = UI_TIMINGS.SUCCESS_DISPLAY_DURATION; // 2 seconds for success indicator\n\n// Language configuration - using centralized config to avoid hardcoding\nconst LANGUAGES = [\n  {\n    code: 'en' as const,\n    name: 'English',\n    nativeName: LOCALES_CONFIG.displayNames.en,\n    flag: '🇺🇸',\n  },\n  {\n    code: 'zh' as const,\n    name: 'Chinese',\n    nativeName: LOCALES_CONFIG.displayNames.zh,\n    flag: '🇨🇳',\n  },\n] as const;\n\n// Custom hook for language switching logic\nconst useLanguageSwitch = () => {\n  const [switchingTo, setSwitchingTo] = useState<string | null>(null);\n  const [switchSuccess, setSwitchSuccess] = useState(false);\n  const [isPending, startTransition] = useTransition();\n  const timersRef = useRef<{\n    transition?: ReturnType<typeof setTimeout>;\n    success?: ReturnType<typeof setTimeout>;\n  }>({});\n\n  // Cleanup timers on unmount\n  useEffect(() => {\n    const timers = timersRef.current;\n    return () => {\n      if (timers.transition) {\n        clearTimeout(timers.transition);\n      }\n      if (timers.success) {\n        clearTimeout(timers.success);\n      }\n    };\n  }, []);\n\n  const handleLanguageSwitch = (newLocale: string) => {\n    // Clear any existing timers\n    if (timersRef.current.transition) {\n      clearTimeout(timersRef.current.transition);\n    }\n    if (timersRef.current.success) {\n      clearTimeout(timersRef.current.success);\n    }\n\n    setSwitchingTo(newLocale);\n    setSwitchSuccess(false);\n\n    startTransition(() => {\n      // The transition will be handled by the Link component\n      timersRef.current.transition = setTimeout(() => {\n        setSwitchingTo(null);\n        setSwitchSuccess(true);\n\n        // Hide success indicator after timeout\n        timersRef.current.success = setTimeout(() => {\n          setSwitchSuccess(false);\n        }, SUCCESS_INDICATOR_TIMEOUT);\n      }, TRANSITION_TIMEOUT);\n    });\n  };\n\n  return {\n    switchingTo,\n    switchSuccess,\n    isPending,\n    handleLanguageSwitch,\n  };\n};\n\ninterface LanguageSwitcherProps {\n  className?: string;\n  variant?: 'default' | 'compact';\n  showLabel?: boolean;\n}\n\nexport const LanguageSwitcher = memo(\n  ({\n    className,\n    variant = 'default',\n    showLabel = false,\n  }: LanguageSwitcherProps) => {\n    const t = useTranslations('language');\n    const locale = useLocale();\n    const pathname = usePathname();\n    const { switchingTo, isPending, handleLanguageSwitch } =\n      useLanguageSwitch();\n\n    const currentLanguage = LANGUAGES.find((lang) => lang.code === locale);\n    const isCompact = variant === 'compact';\n\n    return (\n      <DropdownMenu>\n        <DropdownMenuTrigger asChild>\n          <Button\n            variant='ghost'\n            size={isCompact ? 'sm' : 'icon'}\n            disabled={isPending}\n            className={cn(\n              'transition-colors duration-200',\n              isCompact && 'gap-1 px-2',\n              className,\n            )}\n            aria-label={NAVIGATION_ARIA.languageSelector}\n          >\n            {isPending ? (\n              <Loader2 className='h-4 w-4 animate-spin' />\n            ) : isCompact ? (\n              <Globe className='h-4 w-4' />\n            ) : (\n              <Languages className='h-4 w-4' />\n            )}\n\n            {isCompact && currentLanguage && (\n              <span className='text-xs font-medium'>\n                {currentLanguage.code.toUpperCase()}\n              </span>\n            )}\n\n            {showLabel && <span className='ml-1 text-sm'>{t('toggle')}</span>}\n\n            <span className='sr-only'>{t('toggle')}</span>\n          </Button>\n        </DropdownMenuTrigger>\n\n        <DropdownMenuContent\n          align='end'\n          className='w-48'\n          aria-label={t('selectLanguage')}\n        >\n          {LANGUAGES.map((language) => {\n            const isActive = locale === language.code;\n            const isSwitching = switchingTo === language.code;\n\n            return (\n              <DropdownMenuItem\n                key={language.code}\n                asChild\n              >\n                <Link\n                  href={pathname}\n                  locale={language.code as 'en' | 'zh'}\n                  className={cn(\n                    'flex w-full cursor-pointer items-center',\n                    isActive && 'bg-accent',\n                  )}\n                  onClick={() => handleLanguageSwitch(language.code)}\n                >\n                  <span\n                    className='mr-2 text-base'\n                    role='img'\n                    aria-hidden='true'\n                  >\n                    {language.flag}\n                  </span>\n\n                  <div className='flex flex-1 flex-col'>\n                    <span className='font-medium'>{language.nativeName}</span>\n                    <span className='text-muted-foreground text-xs'>\n                      {language.name}\n                    </span>\n                  </div>\n\n                  {isSwitching && (\n                    <Loader2 className='ml-auto h-4 w-4 animate-spin' />\n                  )}\n\n                  {isActive && !isSwitching && (\n                    <Check className='ml-auto h-4 w-4 text-green-500' />\n                  )}\n                </Link>\n              </DropdownMenuItem>\n            );\n          })}\n        </DropdownMenuContent>\n      </DropdownMenu>\n    );\n  },\n);\n\nLanguageSwitcher.displayName = 'LanguageSwitcher';\n\n// Compact version for mobile or space-constrained areas\nexport const LanguageSwitcherCompact = memo(\n  ({ className }: { className?: string }) => {\n    const props = {\n      variant: 'compact' as const,\n      ...(className && { className }),\n    };\n\n    return <LanguageSwitcher {...props} />;\n  },\n);\n\nLanguageSwitcherCompact.displayName = 'LanguageSwitcherCompact';\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/layout/logo.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/layout/main-navigation.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/layout/mobile-navigation.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/loading-spinner.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/monitoring/enterprise-analytics.tsx","messages":[{"ruleId":"func-names","severity":1,"message":"Unexpected unnamed function.","line":121,"column":23,"nodeType":"FunctionExpression","messageId":"unnamed","endLine":121,"endColumn":32},{"ruleId":"func-names","severity":1,"message":"Unexpected unnamed function.","line":126,"column":26,"nodeType":"FunctionExpression","messageId":"unnamed","endLine":126,"endColumn":35}],"suppressedMessages":[{"ruleId":"no-console","severity":2,"message":"Unexpected console statement.","line":14,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":14,"endColumn":19,"suggestions":[{"fix":{"range":[356,387],"text":""},"messageId":"removeConsole","data":{"propertyName":"warn"},"desc":"Remove the console.warn()."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-console","severity":2,"message":"Unexpected console statement.","line":20,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":20,"endColumn":20,"suggestions":[{"fix":{"range":[552,584],"text":""},"messageId":"removeConsole","data":{"propertyName":"error"},"desc":"Remove the console.error()."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { Analytics } from '@vercel/analytics/react';\nimport { useLocale } from 'next-intl';\nimport React, { useEffect } from 'react';\n\n/**\n * 安全的日志系统 - 仅在开发环境输出console\n */\nconst logger = {\n  warn: (message: string, ...args: unknown[]) => {\n    if (process.env.NODE_ENV === 'development') {\n      // eslint-disable-next-line no-console\n      console.warn(message, ...args);\n    }\n  },\n  error: (message: string, ...args: unknown[]) => {\n    if (process.env.NODE_ENV === 'development') {\n      // eslint-disable-next-line no-console\n      console.error(message, ...args);\n    }\n    // 生产环境可以发送到错误监控服务\n  },\n};\n\ninterface AnalyticsConfig {\n  enableWebVitals: boolean;\n  enableI18nTracking: boolean;\n  enablePerformanceMonitoring: boolean;\n}\n\nconst defaultConfig: AnalyticsConfig = {\n  enableWebVitals: true,\n  enableI18nTracking: true,\n  enablePerformanceMonitoring: true,\n};\n\nexport function EnterpriseAnalytics({\n  children,\n  config = defaultConfig,\n}: {\n  children: React.ReactNode;\n  config?: AnalyticsConfig;\n}) {\n  const locale = useLocale();\n\n  useEffect(() => {\n    // 初始化企业级监控\n    if (typeof window === 'undefined') return;\n\n    // Web Vitals监控\n    if (config.enableWebVitals) {\n      initWebVitals(locale);\n    }\n\n    // i18n性能监控\n    if (config.enableI18nTracking) {\n      initI18nTracking(locale);\n    }\n\n    // 性能监控\n    if (config.enablePerformanceMonitoring) {\n      initPerformanceMonitoring(locale);\n    }\n  }, [locale, config]);\n\n  return (\n    <>\n      {children}\n      <Analytics />\n    </>\n  );\n}\n\nfunction initWebVitals(locale: string): void {\n  // 动态导入web-vitals\n  import('web-vitals')\n    .then(({ onCLS, onFCP, onLCP, onTTFB, onINP }) => {\n      const reportVital = (metric: {\n        name: string;\n        value: number;\n        rating: string;\n      }) => {\n        // 开发环境日志\n        logger.warn(\n          `[Web Vitals] ${metric.name}: ${metric.value} (${metric.rating}) - Locale: ${locale}`,\n        );\n\n        // 发送到Vercel Analytics\n        if ('va' in window) {\n          try {\n\n            (window as unknown).va('track', 'Web Vital', {\n              metric_name: metric.name,\n              metric_value: metric.value,\n              metric_rating: metric.rating,\n              locale,\n            });\n          } catch (error) {\n            logger.error('Failed to send to Vercel Analytics:', error);\n          }\n        }\n      };\n\n      onCLS(reportVital);\n      onFCP(reportVital);\n      onLCP(reportVital);\n      onTTFB(reportVital);\n      onINP(reportVital);\n    })\n    .catch((error) => {\n      logger.error('Failed to load web-vitals:', error);\n    });\n}\n\nfunction initI18nTracking(locale: string): void {\n  // 监控语言切换\n  const originalPushState = history.pushState;\n  const originalReplaceState = history.replaceState;\n\n  history.pushState = function (...args) {\n    trackNavigation(locale);\n    return originalPushState.apply(this, args);\n  };\n\n  history.replaceState = function (...args) {\n    trackNavigation(locale);\n    return originalReplaceState.apply(this, args);\n  };\n\n  window.addEventListener('popstate', () => {\n    trackNavigation(locale);\n  });\n}\n\nfunction trackNavigation(locale: string): void {\n  logger.warn(\n    `[I18n Navigation] Locale: ${locale}, URL: ${window.location.href}`,\n  );\n\n  // 发送导航事件\n  if ('va' in window) {\n    try {\n\n      (window as unknown).va('track', 'Navigation', {\n        locale,\n        url: window.location.href,\n      });\n    } catch (error) {\n      logger.error('Failed to send navigation event:', error);\n    }\n  }\n}\n\nfunction initPerformanceMonitoring(locale: string): void {\n  // 监控页面加载性能\n  window.addEventListener('load', () => {\n    setTimeout(() => {\n      const navigation = performance.getEntriesByType(\n        'navigation',\n      )[0] as PerformanceNavigationTiming;\n\n      if (navigation) {\n        const metrics = {\n          dns: navigation.domainLookupEnd - navigation.domainLookupStart,\n          tcp: navigation.connectEnd - navigation.connectStart,\n          request: navigation.responseStart - navigation.requestStart,\n          response: navigation.responseEnd - navigation.responseStart,\n          dom: navigation.domContentLoadedEventEnd - navigation.responseEnd,\n          load: navigation.loadEventEnd - navigation.loadEventStart,\n          total: navigation.loadEventEnd - navigation.fetchStart,\n        };\n\n        logger.warn(`[Performance] Locale: ${locale}`, metrics);\n\n        // 发送性能指标\n        if ('va' in window) {\n          try {\n\n            (window as unknown).va('track', 'Performance', {\n              ...metrics,\n              locale,\n            });\n          } catch (error) {\n            logger.error('Failed to send performance metrics:', error);\n          }\n        }\n      }\n    }, 0);\n  });\n\n  // 监控资源加载\n  const observer = new PerformanceObserver((list) => {\n    const entries = list.getEntries();\n\n    for (const entry of entries) {\n      if (entry.entryType === 'resource') {\n        const resourceEntry = entry as PerformanceResourceTiming;\n\n        // 特别关注i18n相关资源\n        if (\n          resourceEntry.name.includes('/messages/') ||\n          resourceEntry.name.includes('locale') ||\n          resourceEntry.name.includes('i18n')\n        ) {\n          logger.warn(\n            `[I18n Resource] ${resourceEntry.name}: ${resourceEntry.duration}ms (${resourceEntry.transferSize} bytes) - Locale: ${locale}`,\n          );\n        }\n      }\n    }\n  });\n\n  observer.observe({ entryTypes: ['resource'] });\n}\n\n// 导出用于手动追踪的函数\nexport const enterpriseAnalytics = {\n  trackEvent: (eventName: string, properties: Record<string, unknown> = {}) => {\n    if (typeof window === 'undefined') return;\n\n    logger.warn(`[Analytics Event] ${eventName}:`, properties);\n\n    if ('va' in window) {\n      try {\n\n        (window as unknown).va('track', eventName, properties);\n      } catch (error) {\n        logger.error('Failed to send to Vercel Analytics:', error);\n      }\n    }\n\n    if ('gtag' in window) {\n      try {\n\n        (window as unknown).gtag('event', eventName, properties);\n      } catch (error) {\n        logger.error('Failed to send to Google Analytics:', error);\n      }\n    }\n  },\n\n  trackError: (error: Error, context: Record<string, unknown> = {}) => {\n    if (typeof window === 'undefined') return;\n\n    logger.error('[Tracked Error]', error, context);\n\n    enterpriseAnalytics.trackEvent('Error', {\n      error_message: error.message,\n      error_name: error.name,\n      error_stack: error.stack,\n      ...context,\n    });\n  },\n\n  trackI18nEvent: (eventType: string, data: Record<string, unknown> = {}) => {\n    if (typeof window === 'undefined') return;\n\n    logger.warn(`[I18n Event] ${eventType}:`, data);\n\n    enterpriseAnalytics.trackEvent(`I18n ${eventType}`, data);\n  },\n\n  trackLocaleChange: (fromLocale: string, toLocale: string) => {\n    enterpriseAnalytics.trackI18nEvent('Locale Change', {\n      from_locale: fromLocale,\n      to_locale: toLocale,\n      source: 'user_action',\n    });\n  },\n\n  trackPerformance: (metric: string, value: number, locale: string) => {\n    enterpriseAnalytics.trackEvent('Performance Metric', {\n      metric,\n      value,\n      locale,\n    });\n  },\n};\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/performance/web-vitals-indicator.tsx","messages":[{"ruleId":"no-undef","severity":2,"message":"'useDevToolsLayout' is not defined.","line":104,"column":56,"nodeType":"Identifier","messageId":"undef","endLine":104,"endColumn":73}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useEffect, useState } from 'react';\nimport {\n  webVitalsMonitor,\n  type WebVitalsMetrics,\n} from '@/lib/web-vitals-monitor';\nimport {\n  MONITORING_INTERVALS,\n  WEB_VITALS_THRESHOLDS,\n} from '@/constants/performance-constants';\n\n// 工具函数：获取指标颜色\nconst getMetricColor = (value: number, good: number, poor: number): string => {\n  if (value <= good) return 'text-green-600';\n  if (value <= poor) return 'text-yellow-600';\n  return 'text-red-600';\n};\n\n// 工具函数：格式化指标值\nconst formatMetric = (value: number | undefined, unit: string): string => {\n  if (value === undefined) return 'N/A';\n  return `${Math.round(value)}${unit}`;\n};\n\n// 指标行组件\ninterface MetricRowProps {\n  label: string;\n  value: number | undefined;\n  unit: string;\n  good: number;\n  poor: number;\n}\n\nfunction MetricRow({ label, value, unit, good, poor }: MetricRowProps) {\n  if (value === undefined) return null;\n\n  return (\n    <div className='flex justify-between gap-4'>\n      <span>{label}:</span>\n      <span className={getMetricColor(value, good, poor)}>\n        {formatMetric(value, unit)}\n      </span>\n    </div>\n  );\n}\n\n// 性能监控钩子\nfunction useWebVitalsMonitoring() {\n  const [metrics, setMetrics] = useState<WebVitalsMetrics | null>(null);\n  const [isVisible] = useState(() => process.env.NODE_ENV === 'development');\n\n  useEffect(() => {\n    // 定期更新指标（每3秒）\n    const updateInterval = setInterval(() => {\n      const summary = webVitalsMonitor.getPerformanceSummary();\n      setMetrics(summary.metrics);\n    }, MONITORING_INTERVALS.METRICS_UPDATE);\n\n    // 定期发送性能报告（每5分钟）\n    const reportInterval = setInterval(() => {\n      webVitalsMonitor.sendReport();\n    }, MONITORING_INTERVALS.REPORT_SEND);\n\n    // 页面可见性变化时发送报告\n    const handleVisibilityChange = () => {\n      if (document.visibilityState === 'hidden') {\n        webVitalsMonitor.sendReport();\n      }\n    };\n\n    // 页面卸载前发送最终报告\n    const handleBeforeUnload = () => {\n      webVitalsMonitor.sendReport();\n    };\n\n    // 添加事件监听器\n    document.addEventListener('visibilitychange', handleVisibilityChange);\n    window.addEventListener('beforeunload', handleBeforeUnload);\n\n    // 组件挂载时发送初始报告\n    webVitalsMonitor.sendReport();\n\n    // 清理函数\n    return () => {\n      clearInterval(updateInterval);\n      clearInterval(reportInterval);\n      document.removeEventListener('visibilitychange', handleVisibilityChange);\n      window.removeEventListener('beforeunload', handleBeforeUnload);\n      webVitalsMonitor.sendReport();\n    };\n  }, []);\n\n  return { metrics, isVisible };\n}\n\n/**\n * Web Vitals 性能指示器组件\n *\n * 基于现有性能监控组件模式，在开发环境显示性能指标，\n * 生产环境静默收集数据并定期发送报告。\n */\nexport function WebVitalsIndicator() {\n  const { registerTool, unregisterTool, getClasses } = useDevToolsLayout();\n  const { metrics, isVisible } = useWebVitalsMonitoring();\n\n  // 注册工具到布局管理器\n  useEffect(() => {\n    if (isVisible) {\n      registerTool('webVitalsIndicator');\n      return () => unregisterTool('webVitalsIndicator');\n    }\n    return undefined; // 明确返回 undefined 当不需要清理时\n  }, [isVisible, registerTool, unregisterTool]);\n\n  // 生产环境不渲染任何UI\n  if (!isVisible || !metrics) {\n    return null;\n  }\n\n  return (\n    <div\n      className={`${getClasses('webVitalsIndicator')} rounded-lg bg-black/80 p-3 text-xs text-white shadow-lg backdrop-blur-sm`}\n    >\n      <div className='mb-2 font-semibold'>🚀 Web Vitals</div>\n      <div className='space-y-1'>\n        <MetricRow\n          label='CLS'\n          value={metrics.cls}\n          unit=''\n          good={WEB_VITALS_THRESHOLDS.CLS.GOOD}\n          poor={WEB_VITALS_THRESHOLDS.CLS.POOR}\n        />\n        <MetricRow\n          label='FID'\n          value={metrics.fid}\n          unit='ms'\n          good={WEB_VITALS_THRESHOLDS.FID.GOOD}\n          poor={WEB_VITALS_THRESHOLDS.FID.POOR}\n        />\n        <MetricRow\n          label='LCP'\n          value={metrics.lcp}\n          unit='ms'\n          good={WEB_VITALS_THRESHOLDS.LCP.GOOD}\n          poor={WEB_VITALS_THRESHOLDS.LCP.POOR}\n        />\n        <MetricRow\n          label='FCP'\n          value={metrics.fcp}\n          unit='ms'\n          good={WEB_VITALS_THRESHOLDS.FCP.GOOD}\n          poor={WEB_VITALS_THRESHOLDS.FCP.POOR}\n        />\n        <MetricRow\n          label='TTFB'\n          value={metrics.ttfb}\n          unit='ms'\n          good={WEB_VITALS_THRESHOLDS.TTFB.GOOD}\n          poor={WEB_VITALS_THRESHOLDS.TTFB.POOR}\n        />\n      </div>\n\n      {/* 性能评分 */}\n      <div className='mt-2 border-t border-white/20 pt-2'>\n        <div className='flex justify-between gap-4'>\n          <span>Score:</span>\n          <span className='font-semibold'>\n            {Math.round(webVitalsMonitor.getPerformanceSummary().score)}/100\n          </span>\n        </div>\n      </div>\n\n      {/* 说明文字 */}\n      <div className='mt-2 text-[10px] text-white/60'>\n        Dev only • Updates every 3s\n      </div>\n    </div>\n  );\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/performance/web-vitals-monitor.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/responsive-layout.tsx","messages":[{"ruleId":"max-params","severity":2,"message":"Function 'generateResponsiveClasses' has too many parameters (4). Maximum allowed is 3.","line":77,"column":1,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":77,"endColumn":35}],"suppressedMessages":[{"ruleId":"react-you-might-not-need-an-effect/no-initialize-state","severity":2,"message":"Avoid initializing state in an effect. Instead, pass \"mounted\"'s initial value to its `useState`.","line":12,"column":5,"nodeType":"CallExpression","messageId":"avoidInitializingState","endLine":12,"endColumn":21,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { ReactNode, useEffect, useState } from 'react';\nimport { useBreakpoint } from '@/hooks/use-breakpoint';\n\n// 自定义hook处理hydration\nfunction useMounted() {\n  const [mounted, setMounted] = useState(false);\n\n  useEffect(() => {\n    // eslint-disable-next-line react-you-might-not-need-an-effect/no-initialize-state\n    setMounted(true);\n  }, []);\n\n  return mounted;\n}\n\ninterface ResponsiveLayoutProps {\n  'children': ReactNode;\n  'className'?: string;\n  'mobileLayout'?: ReactNode;\n  'tabletLayout'?: ReactNode;\n  'desktopLayout'?: ReactNode;\n  // Additional props for testing and flexibility\n  'mobileNavigation'?: ReactNode;\n  'tabletSidebar'?: ReactNode;\n  'desktopSidebar'?: ReactNode;\n  'onTouchStart'?: () => void;\n  'onTouchEnd'?: () => void;\n  'onMouseEnter'?: () => void;\n  'onMouseLeave'?: () => void;\n  'onLayoutChange'?: (_layout: string) => void;\n  'role'?: string;\n  'aria-label'?: string;\n  'data-testid'?: string;\n  'tabIndex'?: number;\n}\n\n// 获取当前布局类型的辅助函数\nfunction getCurrentLayoutType(\n  isMobile: boolean,\n  isTablet: boolean,\n): 'mobile' | 'tablet' | 'desktop' {\n  if (isMobile) return 'mobile';\n  if (isTablet) return 'tablet';\n  return 'desktop';\n}\n\n// 布局内容配置接口\ninterface LayoutContentConfig {\n  mobileLayout?: ReactNode;\n  mobileNavigation?: ReactNode;\n  tabletLayout?: ReactNode;\n  tabletSidebar?: ReactNode;\n  desktopLayout?: ReactNode;\n  desktopSidebar?: ReactNode;\n}\n\n// 获取特定布局内容的辅助函数\nfunction getSpecificLayoutContent(\n  layoutType: 'mobile' | 'tablet' | 'desktop',\n  config: LayoutContentConfig,\n): ReactNode | null {\n  switch (layoutType) {\n    case 'mobile':\n      return config.mobileLayout || config.mobileNavigation || null;\n    case 'tablet':\n      return config.tabletLayout || config.tabletSidebar || null;\n    case 'desktop':\n      return config.desktopLayout || config.desktopSidebar || null;\n    default:\n      return null;\n  }\n}\n\n// 生成响应式CSS类名的辅助函数\nfunction generateResponsiveClasses(\n  className: string,\n  isMobile: boolean,\n  isTablet: boolean,\n  isDesktop: boolean,\n): string {\n  const classes = [className];\n\n  if (isMobile) classes.push('responsive-mobile');\n  if (isTablet) classes.push('responsive-tablet');\n  if (isDesktop) classes.push('responsive-desktop');\n\n  return classes.filter(Boolean).join(' ').trim();\n}\n\nexport function ResponsiveLayout({\n  children,\n  className = '',\n  mobileLayout,\n  tabletLayout,\n  desktopLayout,\n  mobileNavigation,\n  tabletSidebar,\n  desktopSidebar,\n  onTouchStart,\n  onTouchEnd,\n  onMouseEnter,\n  onMouseLeave,\n  onLayoutChange,\n  role,\n  'aria-label': ariaLabel,\n  'data-testid': dataTestId,\n  tabIndex,\n}: ResponsiveLayoutProps) {\n  const { currentBreakpoint, isBelow, isAbove } = useBreakpoint();\n\n  // 使用自定义hook处理hydration\n  const mounted = useMounted();\n\n  // Prevent hydration mismatch\n  if (!mounted) {\n    return <div className={className}>{children}</div>;\n  }\n\n  const isMobile = isBelow('md');\n  const isTablet = currentBreakpoint === 'md' || currentBreakpoint === 'lg';\n  const isDesktop = isAbove('lg');\n\n  const layoutType = getCurrentLayoutType(isMobile, isTablet);\n  const specificContent = getSpecificLayoutContent(layoutType, {\n    mobileLayout,\n    mobileNavigation,\n    tabletLayout,\n    tabletSidebar,\n    desktopLayout,\n    desktopSidebar,\n  });\n\n  // Use specific layouts if provided\n  if (specificContent) {\n    return <div className={className}>{specificContent}</div>;\n  }\n\n  // Notify layout change\n  if (onLayoutChange) {\n    onLayoutChange(layoutType);\n  }\n\n  // Default responsive behavior\n  const responsiveClasses = generateResponsiveClasses(\n    className,\n    isMobile,\n    isTablet,\n    isDesktop,\n  );\n\n  return (\n    <div\n      className={responsiveClasses}\n      onTouchStart={onTouchStart}\n      onTouchEnd={onTouchEnd}\n      onMouseEnter={onMouseEnter}\n      onMouseLeave={onMouseLeave}\n      role={role}\n      aria-label={ariaLabel}\n      data-testid={dataTestId}\n      tabIndex={tabIndex}\n    >\n      {children}\n    </div>\n  );\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/security/__tests__/turnstile.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/security/turnstile.tsx","messages":[],"suppressedMessages":[{"ruleId":"no-console","severity":2,"message":"Unexpected console statement.","line":14,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":14,"endColumn":19,"suggestions":[{"fix":{"range":[344,375],"text":""},"messageId":"removeConsole","data":{"propertyName":"warn"},"desc":"Remove the console.warn()."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-console","severity":2,"message":"Unexpected console statement.","line":20,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":20,"endColumn":20,"suggestions":[{"fix":{"range":[540,572],"text":""},"messageId":"removeConsole","data":{"propertyName":"error"},"desc":"Remove the console.error()."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/shared/__tests__/animated-icon.test.tsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'args' is defined but never used. Allowed unused args must match /^_/u.","line":13,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":15,"suggestions":[{"messageId":"removeVar","data":{"varName":"args"},"fix":{"range":[391,409],"text":""},"desc":"Remove unused variable 'args'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'args' is defined but never used. Allowed unused args must match /^_/u.","line":13,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":13,"endColumn":15},{"ruleId":"no-undef","severity":2,"message":"'classes' is not defined.","line":13,"column":31,"nodeType":"Identifier","messageId":"undef","endLine":13,"endColumn":38}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { render, screen } from '@testing-library/react';\nimport { describe, expect, it, vi } from 'vitest';\nimport { AnimatedIcon } from '../animated-icon';\n\n// Mock the useReducedMotion hook\nconst mockUseReducedMotion = vi.fn();\nvi.mock('@/hooks/use-reduced-motion', () => ({\n  useReducedMotion: () => mockUseReducedMotion(),\n}));\n\n// Mock cn utility\nvi.mock('@/lib/utils', () => ({\n  cn: (...args: unknown[]) => classes.filter(Boolean).join(' '),\n}));\n\ndescribe('AnimatedIcon', () => {\n  beforeEach(() => {\n    vi.clearAllMocks();\n    mockUseReducedMotion.mockReturnValue(false);\n  });\n\n  describe('Basic Rendering', () => {\n    it('renders construction variant by default', () => {\n      render(<AnimatedIcon />);\n\n      const icon = screen.getByRole('img');\n      expect(icon).toBeInTheDocument();\n      expect(icon).toHaveAttribute('aria-label', 'Construction icon');\n\n      // Check for construction icon path\n      const path = icon.querySelector('path');\n      expect(path).toHaveAttribute('d', expect.stringContaining('14.7 6.3'));\n    });\n\n    it('renders with default size (lg)', () => {\n      render(<AnimatedIcon />);\n\n      // Find the outermost container div\n      const container = screen\n        .getByRole('img')\n        .closest('div[class*=\"relative\"]');\n      expect(container).toHaveClass('w-16', 'h-16');\n    });\n\n    it('applies custom className', () => {\n      render(<AnimatedIcon className='custom-class' />);\n\n      // Find the outermost container div\n      const container = screen\n        .getByRole('img')\n        .closest('div[class*=\"relative\"]');\n      expect(container).toHaveClass('custom-class');\n    });\n  });\n\n  describe('Size Variants', () => {\n    it('renders small size correctly', () => {\n      render(<AnimatedIcon size='sm' />);\n\n      const container = screen\n        .getByRole('img')\n        .closest('div[class*=\"relative\"]');\n      expect(container).toHaveClass('w-8', 'h-8');\n    });\n\n    it('renders medium size correctly', () => {\n      render(<AnimatedIcon size='md' />);\n\n      const container = screen\n        .getByRole('img')\n        .closest('div[class*=\"relative\"]');\n      expect(container).toHaveClass('w-12', 'h-12');\n    });\n\n    it('renders large size correctly', () => {\n      render(<AnimatedIcon size='lg' />);\n\n      const container = screen\n        .getByRole('img')\n        .closest('div[class*=\"relative\"]');\n      expect(container).toHaveClass('w-16', 'h-16');\n    });\n\n    it('renders extra large size correctly', () => {\n      render(<AnimatedIcon size='xl' />);\n\n      const container = screen\n        .getByRole('img')\n        .closest('div[class*=\"relative\"]');\n      expect(container).toHaveClass('w-24', 'h-24');\n    });\n\n    it('falls back to large size for invalid size', () => {\n      // @ts-expect-error Testing invalid size\n      render(<AnimatedIcon size='invalid' />);\n\n      const container = screen\n        .getByRole('img')\n        .closest('div[class*=\"relative\"]');\n      expect(container).toHaveClass('w-16', 'h-16');\n    });\n  });\n\n  describe('Construction Variant', () => {\n    it('renders construction variant correctly', () => {\n      render(<AnimatedIcon variant='construction' />);\n\n      const svg = screen.getByRole('img');\n      expect(svg).toHaveClass('text-primary', 'h-full', 'w-full');\n      expect(svg).toHaveAttribute('aria-label', 'Construction icon');\n\n      const path = svg.querySelector('path');\n      expect(path).toHaveAttribute('d', expect.stringContaining('14.7 6.3'));\n    });\n\n    it('applies pulse animation when motion is not reduced', () => {\n      mockUseReducedMotion.mockReturnValue(false);\n      render(<AnimatedIcon variant='construction' />);\n\n      const animatedDiv = screen.getByRole('img').parentElement;\n      expect(animatedDiv).toHaveClass('animate-pulse');\n    });\n\n    it('does not apply pulse animation when motion is reduced', () => {\n      mockUseReducedMotion.mockReturnValue(true);\n      render(<AnimatedIcon variant='construction' />);\n\n      const animatedDiv = screen.getByRole('img').parentElement;\n      expect(animatedDiv).not.toHaveClass('animate-pulse');\n    });\n  });\n\n  describe('Loading Variant', () => {\n    it('renders loading variant correctly', () => {\n      render(<AnimatedIcon variant='loading' />);\n\n      const svg = screen.getByRole('img');\n      expect(svg).toHaveClass('text-primary', 'h-full', 'w-full');\n      expect(svg).toHaveAttribute('aria-label', 'Loading icon');\n\n      const path = svg.querySelector('path');\n      expect(path).toHaveAttribute('d', 'M21 12a9 9 0 11-6.219-8.56');\n    });\n\n    it('applies spin animation when motion is not reduced', () => {\n      mockUseReducedMotion.mockReturnValue(false);\n      render(<AnimatedIcon variant='loading' />);\n\n      const animatedDiv = screen.getByRole('img').parentElement;\n      expect(animatedDiv).toHaveClass('animate-spin');\n    });\n\n    it('does not apply spin animation when motion is reduced', () => {\n      mockUseReducedMotion.mockReturnValue(true);\n      render(<AnimatedIcon variant='loading' />);\n\n      const animatedDiv = screen.getByRole('img').parentElement;\n      expect(animatedDiv).not.toHaveClass('animate-spin');\n    });\n\n    it('has correct container structure for loading variant', () => {\n      render(<AnimatedIcon variant='loading' />);\n\n      const container = screen.getByRole('img').parentElement?.parentElement;\n      expect(container).toHaveClass('relative');\n\n      const animatedDiv = screen.getByRole('img').parentElement;\n      expect(animatedDiv).toHaveClass('absolute', 'inset-0');\n    });\n  });\n\n  describe('Gear Variant', () => {\n    it('renders gear variant correctly', () => {\n      render(<AnimatedIcon variant='gear' />);\n\n      const svg = screen.getByRole('img');\n      expect(svg).toHaveClass('text-primary', 'h-full', 'w-full');\n      expect(svg).toHaveAttribute('aria-label', 'Gear icon');\n\n      const circle = svg.querySelector('circle');\n      expect(circle).toHaveAttribute('cx', '12');\n      expect(circle).toHaveAttribute('cy', '12');\n      expect(circle).toHaveAttribute('r', '3');\n\n      const path = svg.querySelector('path');\n      expect(path).toHaveAttribute(\n        'd',\n        expect.stringContaining('M12 1v6m0 6v6'),\n      );\n    });\n\n    it('applies spin animation when motion is not reduced', () => {\n      mockUseReducedMotion.mockReturnValue(false);\n      render(<AnimatedIcon variant='gear' />);\n\n      const animatedDiv = screen.getByRole('img').parentElement;\n      expect(animatedDiv).toHaveClass('animate-spin');\n    });\n\n    it('does not apply spin animation when motion is reduced', () => {\n      mockUseReducedMotion.mockReturnValue(true);\n      render(<AnimatedIcon variant='gear' />);\n\n      const animatedDiv = screen.getByRole('img').parentElement;\n      expect(animatedDiv).not.toHaveClass('animate-spin');\n    });\n\n    it('has correct container structure for gear variant', () => {\n      render(<AnimatedIcon variant='gear' />);\n\n      const container = screen.getByRole('img').parentElement?.parentElement;\n      expect(container).toHaveClass('relative');\n\n      const animatedDiv = screen.getByRole('img').parentElement;\n      expect(animatedDiv).toHaveClass('absolute', 'inset-0');\n    });\n  });\n\n  describe('SVG Properties', () => {\n    it('applies correct SVG attributes for all variants', () => {\n      const variants = ['construction', 'loading', 'gear'] as const;\n\n      variants.forEach((variant) => {\n        const { unmount } = render(<AnimatedIcon variant={variant} />);\n\n        const svg = screen.getByRole('img');\n        expect(svg).toHaveAttribute('viewBox', '0 0 24 24');\n        expect(svg).toHaveAttribute('fill', 'none');\n        expect(svg).toHaveAttribute('stroke', 'currentColor');\n        expect(svg).toHaveAttribute('stroke-width', '2');\n        expect(svg).toHaveAttribute('stroke-linecap', 'round');\n        expect(svg).toHaveAttribute('stroke-linejoin', 'round');\n\n        unmount();\n      });\n    });\n  });\n\n  describe('Motion Preferences', () => {\n    it('respects reduced motion preference for construction variant', () => {\n      mockUseReducedMotion.mockReturnValue(true);\n      render(<AnimatedIcon variant='construction' />);\n\n      const animatedDiv = screen.getByRole('img').parentElement;\n      expect(animatedDiv).not.toHaveClass('animate-pulse');\n      expect(animatedDiv?.className).toBe('');\n    });\n\n    it('respects reduced motion preference for loading variant', () => {\n      mockUseReducedMotion.mockReturnValue(true);\n      render(<AnimatedIcon variant='loading' />);\n\n      const animatedDiv = screen.getByRole('img').parentElement;\n      expect(animatedDiv).not.toHaveClass('animate-spin');\n      expect(animatedDiv).toHaveClass('absolute', 'inset-0');\n    });\n\n    it('respects reduced motion preference for gear variant', () => {\n      mockUseReducedMotion.mockReturnValue(true);\n      render(<AnimatedIcon variant='gear' />);\n\n      const animatedDiv = screen.getByRole('img').parentElement;\n      expect(animatedDiv).not.toHaveClass('animate-spin');\n      expect(animatedDiv).toHaveClass('absolute', 'inset-0');\n    });\n  });\n\n  describe('Component Composition', () => {\n    it('combines size, variant, and className correctly', () => {\n      render(\n        <AnimatedIcon\n          size='sm'\n          variant='loading'\n          className='custom-class'\n        />,\n      );\n\n      const container = screen.getByRole('img').parentElement?.parentElement;\n      expect(container).toHaveClass('relative', 'w-8', 'h-8', 'custom-class');\n    });\n\n    it('handles all combinations of size and variant', () => {\n      const sizes = ['sm', 'md', 'lg', 'xl'] as const;\n      const variants = ['construction', 'loading', 'gear'] as const;\n\n      sizes.forEach((size) => {\n        variants.forEach((variant) => {\n          const { unmount } = render(\n            <AnimatedIcon\n              size={size}\n              variant={variant}\n            />,\n          );\n\n          const container =\n            screen.getByRole('img').parentElement?.parentElement;\n          expect(container).toBeInTheDocument();\n\n          unmount();\n        });\n      });\n    });\n  });\n\n  describe('Edge Cases', () => {\n    it('returns null for invalid variant', () => {\n      // @ts-expect-error Testing invalid variant\n      const { container } = render(<AnimatedIcon variant='invalid' />);\n\n      expect(container.firstChild).toBeNull();\n    });\n\n    it('handles undefined props gracefully', () => {\n      render(<AnimatedIcon />);\n\n      const container = screen.getByRole('img').parentElement;\n      expect(container).toBeInTheDocument();\n    });\n  });\n\n  describe('Memoization', () => {\n    it('is memoized component', () => {\n      expect(AnimatedIcon.displayName).toBe('AnimatedIcon');\n    });\n\n    it('renders consistently with same props', () => {\n      const props = { size: 'md' as const, variant: 'loading' as const };\n\n      const { rerender } = render(<AnimatedIcon {...props} />);\n      const firstRender = screen.getByRole('img');\n\n      rerender(<AnimatedIcon {...props} />);\n      const secondRender = screen.getByRole('img');\n\n      expect(firstRender.outerHTML).toBe(secondRender.outerHTML);\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/shared/__tests__/progress-indicator-advanced.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/shared/__tests__/progress-indicator-core.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/shared/__tests__/progress-indicator-performance.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/shared/__tests__/progress-indicator.test.tsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'args' is defined but never used. Allowed unused args must match /^_/u.","line":13,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":15,"suggestions":[{"messageId":"removeVar","data":{"varName":"args"},"fix":{"range":[363,381],"text":""},"desc":"Remove unused variable 'args'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'args' is defined but never used. Allowed unused args must match /^_/u.","line":13,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":13,"endColumn":15},{"ruleId":"no-undef","severity":2,"message":"'classes' is not defined.","line":16,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":16,"endColumn":12},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":218,"column":51,"nodeType":"MemberExpression","endLine":218,"endColumn":72}],"suppressedMessages":[{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":46,"column":10,"nodeType":"MemberExpression","endLine":46,"endColumn":27,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { render, screen } from '@testing-library/react';\nimport { describe, expect, it, vi } from 'vitest';\nimport { ProgressIndicator } from '../progress-indicator';\n\n// Mock next-intl\nconst mockUseTranslations = vi.fn();\nvi.mock('next-intl', () => ({\n  useTranslations: () => mockUseTranslations,\n}));\n\n// Mock cn utility\nvi.mock('@/lib/utils', () => ({\n  cn: (...args: unknown[]) => {\n    const result: string[] = [];\n\n    classes.forEach((cls) => {\n      if (typeof cls === 'string') {\n        result.push(cls);\n      } else if (typeof cls === 'object' && cls !== null) {\n        // Handle conditional classes object\n        Object.entries(cls).forEach(([key, value]) => {\n          if (value) {\n            result.push(key);\n          }\n        });\n      }\n    });\n\n    return result.filter(Boolean).join(' ');\n  },\n}));\n\ndescribe('ProgressIndicator', () => {\n  beforeEach(() => {\n    vi.clearAllMocks();\n    mockUseTranslations.mockImplementation((key: string) => {\n      const translations: Record<string, string> = {\n        planning: '规划阶段',\n        development: '开发阶段',\n        testing: '测试阶段',\n        launch: '发布阶段',\n        status: '进行中',\n        nearCompletion: '即将完成',\n      };\n      // eslint-disable-next-line security/detect-object-injection\n  return translations[key] || key; // key 来自测试数据，安全\n    });\n  });\n\n  describe('Basic Rendering', () => {\n    it('renders progress indicator with default step', () => {\n      render(<ProgressIndicator />);\n\n      expect(screen.getByText('规划阶段')).toBeInTheDocument();\n      expect(screen.getByText('开发阶段')).toBeInTheDocument();\n      expect(screen.getByText('测试阶段')).toBeInTheDocument();\n      expect(screen.getByText('发布阶段')).toBeInTheDocument();\n    });\n\n    it('renders with custom className', () => {\n      const { container } = render(\n        <ProgressIndicator className='custom-class' />,\n      );\n\n      expect(container.firstChild).toHaveClass('custom-class');\n    });\n\n    it('renders all four steps', () => {\n      render(<ProgressIndicator />);\n\n      const stepNumbers = screen.getAllByText(/[1-4]/);\n      expect(stepNumbers).toHaveLength(4);\n    });\n  });\n\n  describe('Step States - Planning (Step 0)', () => {\n    it('shows planning as current step when currentStep is 0', () => {\n      render(<ProgressIndicator currentStep={0} />);\n\n      // Find the current step circle (should have animate-pulse)\n      const currentStepCircle = document.querySelector('.animate-pulse');\n      expect(currentStepCircle).toBeTruthy();\n\n      // Check that planning step label has correct styling\n      const planningLabel = screen.getByText('规划阶段');\n      expect(planningLabel.className).toContain('text-primary');\n    });\n\n    it('shows correct progress percentage for step 0', () => {\n      render(<ProgressIndicator currentStep={0} />);\n\n      expect(screen.getByText('0%')).toBeInTheDocument();\n      expect(screen.getByText('进行中')).toBeInTheDocument();\n    });\n  });\n\n  describe('Step States - Development (Step 1)', () => {\n    it('shows development as current step when currentStep is 1', () => {\n      render(<ProgressIndicator currentStep={1} />);\n\n      // Should have one completed step (SVG checkmark)\n      const svgs = document.querySelectorAll('svg');\n      expect(svgs.length).toBe(1);\n\n      // Development should be current (has animate-pulse)\n      const currentStepCircle = document.querySelector('.animate-pulse');\n      expect(currentStepCircle).toBeTruthy();\n\n      // Development label should be highlighted\n      const developmentLabel = screen.getByText('开发阶段');\n      expect(developmentLabel.className).toContain('text-primary');\n    });\n\n    it('shows checkmark for completed planning step', () => {\n      render(<ProgressIndicator currentStep={1} />);\n\n      const svg = document.querySelector('svg');\n      expect(svg).toBeInTheDocument();\n      expect(svg?.querySelector('path')).toHaveAttribute('d', 'M5 13l4 4L19 7');\n    });\n\n    it('shows correct progress percentage for step 1', () => {\n      render(<ProgressIndicator currentStep={1} />);\n\n      expect(screen.getByText('33%')).toBeInTheDocument();\n      expect(screen.getByText('进行中')).toBeInTheDocument();\n    });\n  });\n\n  describe('Step States - Testing (Step 2)', () => {\n    it('shows testing as current step when currentStep is 2', () => {\n      render(<ProgressIndicator currentStep={2} />);\n\n      // First two steps should be completed (2 SVG checkmarks)\n      const svgs = document.querySelectorAll('svg');\n      expect(svgs).toHaveLength(2);\n\n      // Testing should be current (has animate-pulse)\n      const currentStepCircle = document.querySelector('.animate-pulse');\n      expect(currentStepCircle).toBeTruthy();\n\n      // Testing label should be highlighted\n      const testingLabel = screen.getByText('测试阶段');\n      expect(testingLabel.className).toContain('text-primary');\n    });\n\n    it('shows correct progress percentage for step 2', () => {\n      render(<ProgressIndicator currentStep={2} />);\n\n      expect(screen.getByText('67%')).toBeInTheDocument();\n      expect(screen.getByText('进行中')).toBeInTheDocument();\n    });\n  });\n\n  describe('Step States - Launch (Step 3)', () => {\n    it('shows launch as current step when currentStep is 3', () => {\n      render(<ProgressIndicator currentStep={3} />);\n\n      // First three steps should be completed (3 SVG checkmarks)\n      const svgs = document.querySelectorAll('svg');\n      expect(svgs).toHaveLength(3);\n\n      // Launch should be current (has animate-pulse)\n      const currentStepCircle = document.querySelector('.animate-pulse');\n      expect(currentStepCircle).toBeTruthy();\n\n      // Launch label should be highlighted\n      const launchLabel = screen.getByText('发布阶段');\n      expect(launchLabel.className).toContain('text-primary');\n    });\n\n    it('shows correct progress percentage for step 3', () => {\n      render(<ProgressIndicator currentStep={3} />);\n\n      expect(screen.getByText('100%')).toBeInTheDocument();\n      expect(screen.getByText('即将完成')).toBeInTheDocument();\n    });\n  });\n\n  describe('Step States - Completed (Step 4)', () => {\n    it('shows all steps as completed when currentStep is 4', () => {\n      render(<ProgressIndicator currentStep={4} />);\n\n      // All steps should show checkmarks (4 SVGs)\n      const svgs = document.querySelectorAll('svg');\n      expect(svgs).toHaveLength(4);\n\n      // All step labels should be highlighted\n      expect(screen.getByText('规划阶段').className).toContain('text-primary');\n      expect(screen.getByText('开发阶段').className).toContain('text-primary');\n      expect(screen.getByText('测试阶段').className).toContain('text-primary');\n      expect(screen.getByText('发布阶段').className).toContain('text-primary');\n    });\n\n    it('shows 100% completion for step 4', () => {\n      render(<ProgressIndicator currentStep={4} />);\n\n      // Should show percentage over 100% since step 4 is beyond the max (3)\n      expect(screen.getByText(/\\d+%/)).toBeInTheDocument();\n      expect(screen.getByText('即将完成')).toBeInTheDocument();\n    });\n  });\n\n  describe('Progress Bar', () => {\n    it('shows correct progress bar width for different steps', () => {\n      const steps = [0, 1, 2, 3];\n      const expectedWidths = [\n        '0%',\n        '33.33333333333333%',\n        '66.66666666666666%',\n        '100%',\n      ];\n\n      steps.forEach((step, index) => {\n        const { unmount } = render(<ProgressIndicator currentStep={step} />);\n\n        const progressBar = document.querySelector('.bg-primary.h-full');\n        expect(progressBar).toHaveStyle(`width: ${expectedWidths[index]}`);\n\n        unmount();\n      });\n    });\n\n    it('has correct progress bar structure', () => {\n      render(<ProgressIndicator currentStep={1} />);\n\n      const progressContainer = document.querySelector('.bg-muted.absolute');\n      expect(progressContainer).toHaveClass(\n        'top-4',\n        'right-4',\n        'left-4',\n        'h-0.5',\n      );\n\n      const progressBar = document.querySelector('.bg-primary.h-full');\n      expect(progressBar).toHaveClass(\n        'transition-all',\n        'duration-500',\n        'ease-out',\n      );\n    });\n  });\n\n  describe('Accessibility', () => {\n    it('provides proper SVG accessibility attributes', () => {\n      render(<ProgressIndicator currentStep={2} />);\n\n      const svgs = document.querySelectorAll('svg');\n      expect(svgs.length).toBeGreaterThan(0);\n\n      svgs.forEach((svg) => {\n        expect(svg).toHaveAttribute('fill', 'none');\n        expect(svg).toHaveAttribute('stroke', 'currentColor');\n        expect(svg).toHaveAttribute('viewBox', '0 0 24 24');\n      });\n    });\n\n    it('has proper step circle structure', () => {\n      render(<ProgressIndicator currentStep={1} />);\n\n      const stepCircles = document.querySelectorAll('.rounded-full');\n      stepCircles.forEach((circle) => {\n        expect(circle).toHaveClass(\n          'flex',\n          'h-8',\n          'w-8',\n          'items-center',\n          'justify-center',\n          'text-sm',\n          'font-medium',\n        );\n      });\n    });\n  });\n\n  describe('Animations and Transitions', () => {\n    it('applies transition classes to step circles', () => {\n      render(<ProgressIndicator currentStep={1} />);\n\n      const stepCircles = document.querySelectorAll('.rounded-full');\n      stepCircles.forEach((circle) => {\n        expect(circle).toHaveClass('transition-all', 'duration-300');\n      });\n    });\n\n    it('applies pulse animation to current step', () => {\n      render(<ProgressIndicator currentStep={1} />);\n\n      // Find the step circle that should have pulse animation\n      const stepCircles = document.querySelectorAll('.rounded-full');\n      const currentStepCircle = Array.from(stepCircles).find((circle) =>\n        circle.classList.contains('animate-pulse'),\n      );\n      expect(currentStepCircle).toBeTruthy();\n    });\n\n    it('applies transition to step labels', () => {\n      render(<ProgressIndicator currentStep={1} />);\n\n      const stepLabels = document.querySelectorAll('.text-xs');\n      stepLabels.forEach((label) => {\n        expect(label).toHaveClass('transition-colors', 'duration-300');\n      });\n    });\n  });\n\n  describe('Internationalization', () => {\n    it('calls useTranslations hook', () => {\n      render(<ProgressIndicator />);\n\n      // The hook is called, but we're mocking the return function\n      expect(mockUseTranslations).toHaveBeenCalled();\n    });\n\n    it('translates all step labels', () => {\n      render(<ProgressIndicator />);\n\n      expect(mockUseTranslations).toHaveBeenCalledWith('planning');\n      expect(mockUseTranslations).toHaveBeenCalledWith('development');\n      expect(mockUseTranslations).toHaveBeenCalledWith('testing');\n      expect(mockUseTranslations).toHaveBeenCalledWith('launch');\n    });\n\n    it('translates status messages', () => {\n      render(<ProgressIndicator currentStep={1} />);\n\n      expect(mockUseTranslations).toHaveBeenCalledWith('status');\n\n      const { rerender } = render(<ProgressIndicator currentStep={3} />);\n      rerender(<ProgressIndicator currentStep={3} />);\n\n      expect(mockUseTranslations).toHaveBeenCalledWith('nearCompletion');\n    });\n  });\n\n  describe('Edge Cases', () => {\n    it('handles negative currentStep gracefully', () => {\n      render(<ProgressIndicator currentStep={-1} />);\n\n      // Should show no completed steps (no SVG checkmarks)\n      const svgs = document.querySelectorAll('svg');\n      expect(svgs).toHaveLength(0);\n\n      // Should show negative percentage (component doesn't clamp to 0)\n      expect(screen.getByText(/-\\d+%/)).toBeInTheDocument();\n    });\n\n    it('handles currentStep beyond maximum gracefully', () => {\n      render(<ProgressIndicator currentStep={10} />);\n\n      // All steps should be completed (4 SVG checkmarks)\n      const svgs = document.querySelectorAll('svg');\n      expect(svgs).toHaveLength(4);\n\n      // Should show percentage beyond 100%\n      expect(screen.getByText(/\\d+%/)).toBeInTheDocument();\n    });\n\n    it('handles missing translations gracefully', () => {\n      mockUseTranslations.mockImplementation((key: string) => key);\n\n      render(<ProgressIndicator />);\n\n      expect(screen.getByText('planning')).toBeInTheDocument();\n      expect(screen.getByText('development')).toBeInTheDocument();\n      expect(screen.getByText('testing')).toBeInTheDocument();\n      expect(screen.getByText('launch')).toBeInTheDocument();\n    });\n  });\n\n  describe('Memoization', () => {\n    it('is memoized component', () => {\n      // Check that the component is memoized by verifying it's a React.memo component\n      expect(ProgressIndicator).toBeDefined();\n      // React.memo components are objects with a $$typeof property\n      expect(ProgressIndicator).toHaveProperty('$$typeof');\n    });\n\n    it('renders consistently with same props', () => {\n      const props = { currentStep: 2 };\n\n      const { rerender } = render(<ProgressIndicator {...props} />);\n      const firstRender = screen.getByText('67%');\n\n      rerender(<ProgressIndicator {...props} />);\n      const secondRender = screen.getByText('67%');\n\n      expect(firstRender).toBeInTheDocument();\n      expect(secondRender).toBeInTheDocument();\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/shared/animated-icon.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/shared/animation-examples.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/shared/animations/card-button.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/shared/animations/form-status.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/shared/animations/icon-title.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/shared/animations/showcase-config.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/shared/animations/social-interactive.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/shared/dynamic-imports-base.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/shared/dynamic-imports-core.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/shared/dynamic-imports.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/shared/dynamic-imports/exports.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/shared/dynamic-imports/high-priority.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/shared/dynamic-imports/ui-components.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/shared/progress-indicator.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/shared/under-construction-v2-components.tsx","messages":[{"ruleId":"no-underscore-dangle","severity":2,"message":"Unexpected dangling '_' in '_t'.","line":22,"column":9,"nodeType":"VariableDeclarator","messageId":"unexpectedUnderscore","endLine":22,"endColumn":50},{"ruleId":"no-underscore-dangle","severity":2,"message":"Unexpected dangling '_' in '_t'.","line":96,"column":9,"nodeType":"VariableDeclarator","messageId":"unexpectedUnderscore","endLine":96,"endColumn":50},{"ruleId":"no-underscore-dangle","severity":2,"message":"Unexpected dangling '_' in '_t'.","line":130,"column":9,"nodeType":"VariableDeclarator","messageId":"unexpectedUnderscore","endLine":130,"endColumn":50},{"ruleId":"no-underscore-dangle","severity":2,"message":"Unexpected dangling '_' in '_t'.","line":168,"column":9,"nodeType":"VariableDeclarator","messageId":"unexpectedUnderscore","endLine":168,"endColumn":50},{"ruleId":"no-underscore-dangle","severity":2,"message":"Unexpected dangling '_' in '_t'.","line":210,"column":9,"nodeType":"VariableDeclarator","messageId":"unexpectedUnderscore","endLine":210,"endColumn":50},{"ruleId":"no-unused-vars","severity":2,"message":"'pageType' is defined but never used. Allowed unused args must match /^_/u.","line":228,"column":34,"nodeType":"Identifier","messageId":"unusedVar","endLine":228,"endColumn":42,"suggestions":[{"messageId":"removeVar","data":{"varName":"pageType"},"fix":{"range":[7049,7082],"text":""},"desc":"Remove unused variable 'pageType'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'pageType' is defined but never used. Allowed unused args must match /^_/u.","line":228,"column":34,"nodeType":null,"messageId":"unusedVar","endLine":228,"endColumn":42},{"ruleId":"no-underscore-dangle","severity":2,"message":"Unexpected dangling '_' in '_t'.","line":229,"column":9,"nodeType":"VariableDeclarator","messageId":"unexpectedUnderscore","endLine":229,"endColumn":50}],"suppressedMessages":[],"errorCount":8,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Input } from '@/components/ui/input';\nimport { Link } from '@/i18n/routing';\n// cn utility is imported but not used in this file\n// import { cn } from '@/lib/utils';\nimport { ArrowRight, Bell, CheckCircle, Clock, Github, Linkedin, Mail, Twitter, Users, Zap } from 'lucide-react';\nimport { useTranslations } from 'next-intl';\nimport React, { useState } from 'react';\nimport { logger } from '@/lib/logger';\nimport { AnimatedIcon } from './animated-icon';\nimport { ProgressIndicator } from './progress-indicator';\n\ninterface EmailSubscriptionProps {\n  showEmailSubscription: boolean;\n}\n\nexport function EmailSubscription({ showEmailSubscription }: EmailSubscriptionProps) {\n  const _t = useTranslations('underConstruction');\n  const [email, setEmail] = useState('');\n  const [isSubscribed, setIsSubscribed] = useState(false);\n\n  const handleEmailSubscription = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!email) return;\n\n    try {\n      const response = await fetch('/api/subscribe', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({ email }),\n      });\n\n      const data = await response.json();\n\n      if (data.success) {\n        setIsSubscribed(true);\n        setEmail('');\n      }\n    } catch (error) {\n      logger.error('Subscription error', { error: error as Error });\n    }\n  };\n\n  if (!showEmailSubscription) return null;\n\n  return (\n    <Card className=\"w-full max-w-md mx-auto\">\n      <CardHeader className=\"text-center\">\n        <CardTitle className=\"flex items-center justify-center gap-2\">\n          <Bell className=\"h-5 w-5\" />\n          {_t('emailSubscription.title')}\n        </CardTitle>\n        <CardDescription>\n          {_t('emailSubscription.description')}\n        </CardDescription>\n      </CardHeader>\n      <CardContent>\n        {isSubscribed ? (\n          <div className=\"text-center space-y-2\">\n            <CheckCircle className=\"h-8 w-8 text-green-500 mx-auto\" />\n            <p className=\"text-sm text-muted-foreground\">\n              {_t('emailSubscription.success')}\n            </p>\n          </div>\n        ) : (\n          <form onSubmit={handleEmailSubscription} className=\"space-y-4\">\n            <Input\n              type=\"email\"\n              placeholder={_t('emailSubscription.placeholder')}\n              value={email}\n              onChange={(e) => setEmail(e.target.value)}\n              required\n            />\n            <Button type=\"submit\" className=\"w-full\">\n              {_t('emailSubscription.button')}\n              <ArrowRight className=\"ml-2 h-4 w-4\" />\n            </Button>\n          </form>\n        )}\n      </CardContent>\n    </Card>\n  );\n}\n\ninterface SocialLinksProps {\n  showSocialLinks: boolean;\n}\n\nexport function SocialLinks({ showSocialLinks }: SocialLinksProps) {\n  const _t = useTranslations('underConstruction');\n\n  const socialLinks = [\n    { icon: Twitter, href: '#', label: 'Twitter' },\n    { icon: Github, href: '#', label: 'GitHub' },\n    { icon: Linkedin, href: '#', label: 'LinkedIn' },\n  ];\n\n  if (!showSocialLinks) return null;\n\n  return (\n    <div className=\"flex justify-center space-x-4\">\n      {socialLinks.map((social) => (\n        <Button\n          key={social.label}\n          variant=\"outline\"\n          size=\"icon\"\n          asChild\n          className=\"hover:scale-110 transition-transform\"\n        >\n          <Link href={social.href} aria-label={social.label}>\n            <social.icon className=\"h-4 w-4\" />\n          </Link>\n        </Button>\n      ))}\n    </div>\n  );\n}\n\ninterface FeaturePreviewProps {\n  showFeaturePreview: boolean;\n}\n\nexport function FeaturePreview({ showFeaturePreview }: FeaturePreviewProps) {\n  const _t = useTranslations('underConstruction');\n\n  const features = [\n    { icon: Zap, title: _t('features.performance'), description: _t('features.performanceDesc') },\n    { icon: Users, title: _t('features.collaboration'), description: _t('features.collaborationDesc') },\n    { icon: CheckCircle, title: _t('features.quality'), description: _t('features.qualityDesc') },\n  ];\n\n  if (!showFeaturePreview) return null;\n\n  return (\n    <div className=\"w-full max-w-4xl mx-auto\">\n      <h3 className=\"text-xl font-semibold text-center mb-8\">\n        {_t('features.title')}\n      </h3>\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n        {features.map((feature, index) => (\n          <Card key={index} className=\"text-center hover:shadow-lg transition-shadow\">\n            <CardHeader>\n              <feature.icon className=\"h-8 w-8 mx-auto text-primary\" />\n              <CardTitle className=\"text-lg\">{feature.title}</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <CardDescription>{feature.description}</CardDescription>\n            </CardContent>\n          </Card>\n        ))}\n      </div>\n    </div>\n  );\n}\n\ninterface HeaderSectionProps {\n  pageType: 'products' | 'blog' | 'about' | 'contact';\n  expectedDate: string;\n}\n\nexport function HeaderSection({ pageType, expectedDate }: HeaderSectionProps) {\n  const _t = useTranslations('underConstruction');\n  const tPage = useTranslations(`underConstruction.pages.${pageType}`);\n\n  return (\n    <div className=\"text-center space-y-6\">\n      <div className=\"space-y-4\">\n        <AnimatedIcon\n          variant=\"construction\"\n          size=\"xl\"\n          className=\"text-primary drop-shadow-lg\"\n        />\n        <div className=\"space-y-2\">\n          <h1 className=\"text-4xl md:text-6xl font-bold bg-gradient-to-r from-primary to-primary/60 bg-clip-text text-transparent\">\n            {tPage('title')}\n          </h1>\n          <p className=\"text-xl md:text-2xl text-muted-foreground max-w-2xl mx-auto\">\n            {tPage('subtitle')}\n          </p>\n        </div>\n      </div>\n\n      <div className=\"flex flex-col sm:flex-row items-center justify-center gap-4\">\n        <Badge variant=\"secondary\" className=\"text-sm px-4 py-2\">\n          <Clock className=\"mr-2 h-4 w-4\" />\n          {_t('expectedLaunch')}: {expectedDate}\n        </Badge>\n        <Button asChild variant=\"outline\">\n          <Link href=\"/\">\n            {_t('backToHome')}\n          </Link>\n        </Button>\n      </div>\n    </div>\n  );\n}\n\ninterface ProgressSectionProps {\n  showProgress: boolean;\n  currentStep: number;\n}\n\nexport function ProgressSection({ showProgress, currentStep }: ProgressSectionProps) {\n  const _t = useTranslations('underConstruction');\n\n  if (!showProgress) return null;\n\n  return (\n    <div className=\"w-full max-w-2xl mx-auto\">\n      <h3 className=\"text-lg font-semibold text-center mb-6\">\n        {_t('progress.title')}\n      </h3>\n      <ProgressIndicator currentStep={currentStep} />\n    </div>\n  );\n}\n\ninterface ContactSectionProps {\n  pageType: 'products' | 'blog' | 'about' | 'contact';\n}\n\nexport function ContactSection({ pageType }: ContactSectionProps) {\n  const _t = useTranslations('underConstruction');\n\n  return (\n    <Card className=\"w-full max-w-md mx-auto\">\n      <CardHeader className=\"text-center\">\n        <CardTitle className=\"flex items-center justify-center gap-2\">\n          <Mail className=\"h-5 w-5\" />\n          {_t('contact.title')}\n        </CardTitle>\n        <CardDescription>\n          {_t('contact.description')}\n        </CardDescription>\n      </CardHeader>\n      <CardContent className=\"text-center\">\n        <Button asChild className=\"w-full\">\n          <Link href=\"/contact\">\n            {_t('contact.button')}\n            <ArrowRight className=\"ml-2 h-4 w-4\" />\n          </Link>\n        </Button>\n      </CardContent>\n    </Card>\n  );\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/shared/under-construction-v2.tsx","messages":[{"ruleId":"react/jsx-no-undef","severity":2,"message":"'HeaderSection' is not defined.","line":44,"column":12,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":44,"endColumn":25},{"ruleId":"no-undef","severity":2,"message":"'HeaderSection' is not defined.","line":44,"column":12,"nodeType":"JSXIdentifier","messageId":"undef","endLine":44,"endColumn":25},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'ProgressSection' is not defined.","line":47,"column":12,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":47,"endColumn":27},{"ruleId":"no-undef","severity":2,"message":"'ProgressSection' is not defined.","line":47,"column":12,"nodeType":"JSXIdentifier","messageId":"undef","endLine":47,"endColumn":27},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'FeaturePreview' is not defined.","line":50,"column":12,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":50,"endColumn":26},{"ruleId":"no-undef","severity":2,"message":"'FeaturePreview' is not defined.","line":50,"column":12,"nodeType":"JSXIdentifier","messageId":"undef","endLine":50,"endColumn":26},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'EmailSubscription' is not defined.","line":53,"column":12,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":53,"endColumn":29},{"ruleId":"no-undef","severity":2,"message":"'EmailSubscription' is not defined.","line":53,"column":12,"nodeType":"JSXIdentifier","messageId":"undef","endLine":53,"endColumn":29},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'ContactSection' is not defined.","line":56,"column":12,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":56,"endColumn":26},{"ruleId":"no-undef","severity":2,"message":"'ContactSection' is not defined.","line":56,"column":12,"nodeType":"JSXIdentifier","messageId":"undef","endLine":56,"endColumn":26},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'SocialLinks' is not defined.","line":59,"column":12,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":59,"endColumn":23},{"ruleId":"no-undef","severity":2,"message":"'SocialLinks' is not defined.","line":59,"column":12,"nodeType":"JSXIdentifier","messageId":"undef","endLine":59,"endColumn":23}],"suppressedMessages":[],"errorCount":12,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { cn } from '@/lib/utils';\n\ninterface UnderConstructionV2Props {\n  pageType: 'products' | 'blog' | 'about' | 'contact';\n  className?: string;\n  showProgress?: boolean;\n  currentStep?: number;\n  expectedDate?: string;\n  showEmailSubscription?: boolean;\n  showSocialLinks?: boolean;\n  showFeaturePreview?: boolean;\n}\n\nexport function UnderConstructionV2({\n  pageType,\n  className,\n  showProgress = true,\n  currentStep = 1,\n  expectedDate = '2024年第二季度',\n  showEmailSubscription = true,\n  showSocialLinks = true,\n  showFeaturePreview = true,\n}: UnderConstructionV2Props) {\n  return (\n    <div\n      className={cn(\n        'relative min-h-screen overflow-hidden',\n        'bg-gradient-to-br from-background via-background to-muted/30',\n        className,\n      )}\n    >\n      {/* 背景装饰 */}\n      <div className=\"pointer-events-none absolute inset-0 overflow-hidden\">\n        <div className=\"absolute -top-40 -right-40 h-80 w-80 rounded-full bg-primary/5 blur-3xl\" />\n        <div className=\"absolute -bottom-40 -left-40 h-80 w-80 rounded-full bg-secondary/5 blur-3xl\" />\n        <div className=\"absolute top-1/2 left-1/2 h-64 w-64 -translate-x-1/2 -translate-y-1/2 rounded-full bg-accent/5 blur-3xl\" />\n      </div>\n\n      <div className=\"relative z-10 flex min-h-screen flex-col items-center justify-center px-4 py-16\">\n        <div className=\"mx-auto w-full max-w-4xl space-y-12 text-center\">\n          {/* 头部区域 */}\n          <HeaderSection pageType={pageType} expectedDate={expectedDate} />\n\n          {/* 进度指示器 */}\n          <ProgressSection showProgress={showProgress} currentStep={currentStep} />\n\n          {/* 功能预览 */}\n          <FeaturePreview showFeaturePreview={showFeaturePreview} />\n\n          {/* 邮件订阅 */}\n          <EmailSubscription showEmailSubscription={showEmailSubscription} />\n\n          {/* 联系方式 */}\n          <ContactSection pageType={pageType} />\n\n          {/* 社交链接 */}\n          <SocialLinks showSocialLinks={showSocialLinks} />\n        </div>\n      </div>\n    </div>\n  );\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/shared/under-construction-v3.tsx","messages":[{"ruleId":"no-underscore-dangle","severity":2,"message":"Unexpected dangling '_' in '_t'.","line":20,"column":9,"nodeType":"VariableDeclarator","messageId":"unexpectedUnderscore","endLine":20,"endColumn":50}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { cn } from '@/lib/utils';\nimport { logger } from '@/lib/logger';\nimport { useTranslations } from 'next-intl';\nimport React, { useState } from 'react';\nimport { PageHeader } from './under-construction-v3/page-header';\nimport { SocialLinks } from './under-construction-v3/social-links';\nimport { SubscriptionForm } from './under-construction-v3/subscription-form';\n\ninterface UnderConstructionV3Props {\n  pageType: 'products' | 'blog' | 'about' | 'contact';\n  className?: string;\n}\n\nexport function UnderConstructionV3({\n  pageType,\n  className,\n}: UnderConstructionV3Props) {\n  const _t = useTranslations('underConstruction');\n  const tPage = useTranslations(`underConstruction.pages.${pageType}`);\n  const [email, setEmail] = useState('');\n  const [isSubscribed, setIsSubscribed] = useState(false);\n  const [isSubmitting, setIsSubmitting] = useState(false);\n\n  const handleEmailSubscription = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!email || isSubmitting) return;\n\n    setIsSubmitting(true);\n\n    try {\n      const response = await fetch('/api/subscribe', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ email, pageType }),\n      });\n\n      const data = await response.json();\n\n      if (data.success) {\n        setIsSubscribed(true);\n        setEmail('');\n      } else {\n        logger.error('订阅失败', { message: data.message });\n      }\n    } catch (_error) {\n    // 忽略错误变量\n      logger.error('订阅请求失败', { error: _error as Error });\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n\n\n  return (\n    <div\n      className={cn(\n        'relative min-h-screen overflow-hidden bg-background',\n        className,\n      )}\n    >\n      <div className=\"relative z-10 flex min-h-screen flex-col items-center justify-center px-4 py-16\">\n        <div className=\"mx-auto w-full max-w-xl space-y-12 text-center\">\n\n          {/* 主要信息区 - 极简版 */}\n          <PageHeader\n            title={tPage('title')}\n            description={tPage('description')}\n          />\n\n          {/* 邮件订阅 - 简化版 */}\n          <SubscriptionForm\n            email={email}\n            setEmail={setEmail}\n            isSubscribed={isSubscribed}\n            isSubmitting={isSubmitting}\n            onSubmit={handleEmailSubscription}\n            tPage={tPage}\n          />\n\n          {/* 社交媒体链接 - 精简版 */}\n          <SocialLinks />\n        </div>\n      </div>\n    </div>\n  );\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/shared/under-construction-v3/page-header.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/shared/under-construction-v3/social-links.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/shared/under-construction-v3/subscription-form.tsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'email' is defined but never used. Allowed unused args must match /^_/u.","line":11,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":27,"suggestions":[{"messageId":"removeVar","data":{"varName":"email"},"fix":{"range":[323,336],"text":""},"desc":"Remove unused variable 'email'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'e' is defined but never used. Allowed unused args must match /^_/u.","line":14,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":32,"suggestions":[{"messageId":"removeVar","data":{"varName":"e"},"fix":{"range":[410,428],"text":""},"desc":"Remove unused variable 'e'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'key' is defined but never used. Allowed unused args must match /^_/u.","line":15,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":22,"suggestions":[{"messageId":"removeVar","data":{"varName":"key"},"fix":{"range":[449,460],"text":""},"desc":"Remove unused variable 'key'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'tPage' is defined but never used. Allowed unused args must match /^_/u.","line":24,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":8,"suggestions":[{"messageId":"removeVar","data":{"varName":"tPage"},"fix":{"range":[574,583],"text":""},"desc":"Remove unused variable 'tPage'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'tPage' is defined but never used. Allowed unused args must match /^_/u.","line":24,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":24,"endColumn":8}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent } from '@/components/ui/card';\nimport { Input } from '@/components/ui/input';\nimport { ArrowRight, CheckCircle, Mail } from 'lucide-react';\nimport React from 'react';\n\ninterface SubscriptionFormProps {\n  email: string;\n  setEmail: (email: string) => void;\n  isSubscribed: boolean;\n  isSubmitting: boolean;\n  onSubmit: (e: React.FormEvent) => void;\n  tPage: (key: string) => string;\n}\n\nexport function SubscriptionForm({\n  email,\n  setEmail,\n  isSubscribed,\n  isSubmitting,\n  onSubmit,\n  tPage,\n}: SubscriptionFormProps) {\n  if (isSubscribed) {\n    return (\n      <Card className=\"mx-auto max-w-md\">\n        <CardContent className=\"p-6\">\n          <div className=\"flex items-center justify-center space-x-3 text-green-600\">\n            <CheckCircle className=\"h-6 w-6\" />\n            <span className=\"font-medium\">订阅成功！</span>\n          </div>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  return (\n    <Card className=\"mx-auto max-w-md\">\n      <CardContent className=\"p-6\">\n        <div className=\"space-y-4\">\n          <div className=\"flex items-center justify-center space-x-2 text-muted-foreground\">\n            <Mail className=\"h-5 w-5\" />\n            <span className=\"text-sm font-medium\">邮件订阅</span>\n          </div>\n\n          <form onSubmit={onSubmit} className=\"space-y-3\">\n            <Input\n              type=\"email\"\n              placeholder=\"请输入您的邮箱地址\"\n              value={email}\n              onChange={(e) => setEmail(e.target.value)}\n              disabled={isSubmitting}\n              className=\"w-full\"\n              required\n            />\n            <Button\n              type=\"submit\"\n              disabled={isSubmitting || !email}\n              className=\"w-full\"\n              size=\"sm\"\n            >\n              {isSubmitting ? (\n                '订阅中...'\n              ) : (\n                <>\n                  订阅更新\n                  <ArrowRight className=\"ml-2 h-4 w-4\" />\n                </>\n              )}\n            </Button>\n          </form>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/shared/under-construction.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/theme-provider.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/theme-toggle.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/theme/__tests__/theme-menu-item-interactions-basic-core.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/theme/__tests__/theme-menu-item-interactions-basic.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/theme/__tests__/theme-menu-item-interactions.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/theme/__tests__/theme-menu-item-rendering.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/theme/__tests__/theme-menu-item.test.tsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'currentTheme' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":412,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":412,"endColumn":27,"suggestions":[{"messageId":"removeVar","data":{"varName":"currentTheme"},"fix":{"range":[11489,11502],"text":""},"desc":"Remove unused variable 'currentTheme'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'currentTheme' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":412,"column":15,"nodeType":null,"messageId":"unusedVar","endLine":412,"endColumn":27}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { fireEvent, render, screen } from '@testing-library/react';\nimport { Monitor, Moon, Sun } from 'lucide-react';\nimport { describe, expect, it, vi } from 'vitest';\nimport { ThemeMenuItem } from '../theme-menu-item';\n\n// Mock DropdownMenuItem\nvi.mock('@/components/ui/dropdown-menu', () => ({\n  DropdownMenuItem: ({\n    children,\n    className,\n    onClick,\n    onKeyDown,\n    role,\n    ...props\n  }: React.ComponentProps<\"div\">) => (\n    <div\n      role={role}\n      className={className}\n      onClick={onClick}\n      onKeyDown={onKeyDown}\n      {...props}\n    >\n      {children}\n    </div>\n  ),\n}));\n\ndescribe('ThemeMenuItem', () => {\n  const defaultProps = {\n    theme: 'light',\n    currentTheme: 'dark',\n    label: 'Light Mode',\n    ariaLabel: 'Switch to light mode',\n    icon: Sun,\n    supportsViewTransitions: false,\n    prefersReducedMotion: false,\n    onClick: vi.fn(),\n    onKeyDown: vi.fn(),\n  };\n\n  beforeEach(() => {\n    vi.clearAllMocks();\n  });\n\n  describe('Basic Rendering', () => {\n    it('renders theme menu item with correct label', () => {\n      render(<ThemeMenuItem {...defaultProps} />);\n\n      expect(screen.getByText('Light Mode')).toBeInTheDocument();\n    });\n\n    it('renders with correct icon', () => {\n      render(<ThemeMenuItem {...defaultProps} />);\n\n      // Sun icon should be rendered\n      const icon = screen.getByRole('menuitem').querySelector('svg');\n      expect(icon).toBeInTheDocument();\n      expect(icon).toHaveClass('mr-2', 'h-4', 'w-4');\n      expect(icon).toHaveAttribute('aria-hidden', 'true');\n    });\n\n    it('applies correct role and aria-label', () => {\n      render(<ThemeMenuItem {...defaultProps} />);\n\n      const menuItem = screen.getByRole('menuitem');\n      expect(menuItem).toHaveAttribute('aria-label', 'Switch to light mode');\n    });\n\n    it('renders with different icons correctly', () => {\n      const { rerender } = render(\n        <ThemeMenuItem\n          {...defaultProps}\n          icon={Moon}\n        />,\n      );\n      expect(screen.getByRole('menuitem')).toBeInTheDocument();\n\n      rerender(\n        <ThemeMenuItem\n          {...defaultProps}\n          icon={Monitor}\n        />,\n      );\n      expect(screen.getByRole('menuitem')).toBeInTheDocument();\n    });\n  });\n\n  describe('Selection State', () => {\n    it('shows selected indicator when theme matches currentTheme', () => {\n      render(\n        <ThemeMenuItem\n          {...defaultProps}\n          theme='light'\n          currentTheme='light'\n        />,\n      );\n\n      const selectedIndicator = screen.getByLabelText('当前选中');\n      expect(selectedIndicator).toBeInTheDocument();\n      expect(selectedIndicator).toHaveTextContent('●');\n      expect(selectedIndicator).toHaveClass('ml-auto', 'text-xs');\n    });\n\n    it('does not show selected indicator when theme does not match currentTheme', () => {\n      render(\n        <ThemeMenuItem\n          {...defaultProps}\n          theme='light'\n          currentTheme='dark'\n        />,\n      );\n\n      expect(screen.queryByLabelText('当前选中')).not.toBeInTheDocument();\n      expect(screen.queryByText('●')).not.toBeInTheDocument();\n    });\n\n    it('applies selected styling when theme matches currentTheme', () => {\n      render(\n        <ThemeMenuItem\n          {...defaultProps}\n          theme='dark'\n          currentTheme='dark'\n        />,\n      );\n\n      const menuItem = screen.getByRole('menuitem');\n      expect(menuItem).toHaveClass('bg-accent', 'text-accent-foreground');\n    });\n\n    it('does not apply selected styling when theme does not match', () => {\n      render(\n        <ThemeMenuItem\n          {...defaultProps}\n          theme='light'\n          currentTheme='dark'\n        />,\n      );\n\n      const menuItem = screen.getByRole('menuitem');\n      expect(menuItem).not.toHaveClass('bg-accent');\n      expect(menuItem).not.toHaveClass('text-accent-foreground');\n    });\n  });\n\n  describe('View Transitions Support', () => {\n    it('shows view transitions indicator when supportsViewTransitions is true', () => {\n      render(\n        <ThemeMenuItem\n          {...defaultProps}\n          supportsViewTransitions={true}\n        />,\n      );\n\n      const transitionsIndicator = screen.getByText('✨');\n      expect(transitionsIndicator).toBeInTheDocument();\n      expect(transitionsIndicator).toHaveClass(\n        'text-muted-foreground',\n        'ml-auto',\n        'text-xs',\n      );\n      expect(transitionsIndicator).toHaveAttribute('aria-hidden', 'true');\n    });\n\n    it('does not show view transitions indicator when supportsViewTransitions is false', () => {\n      render(\n        <ThemeMenuItem\n          {...defaultProps}\n          supportsViewTransitions={false}\n        />,\n      );\n\n      expect(screen.queryByText('✨')).not.toBeInTheDocument();\n    });\n\n    it('applies transition classes when supportsViewTransitions is true and prefersReducedMotion is false', () => {\n      render(\n        <ThemeMenuItem\n          {...defaultProps}\n          supportsViewTransitions={true}\n          prefersReducedMotion={false}\n        />,\n      );\n\n      const menuItem = screen.getByRole('menuitem');\n      expect(menuItem).toHaveClass(\n        'hover:bg-accent',\n        'transition-all',\n        'duration-200',\n      );\n    });\n\n    it('does not apply transition classes when prefersReducedMotion is true', () => {\n      render(\n        <ThemeMenuItem\n          {...defaultProps}\n          supportsViewTransitions={true}\n          prefersReducedMotion={true}\n        />,\n      );\n\n      const menuItem = screen.getByRole('menuitem');\n      expect(menuItem).not.toHaveClass('hover:bg-accent');\n      expect(menuItem).not.toHaveClass('transition-all');\n      expect(menuItem).not.toHaveClass('duration-200');\n    });\n\n    it('does not apply transition classes when supportsViewTransitions is false', () => {\n      render(\n        <ThemeMenuItem\n          {...defaultProps}\n          supportsViewTransitions={false}\n          prefersReducedMotion={false}\n        />,\n      );\n\n      const menuItem = screen.getByRole('menuitem');\n      expect(menuItem).not.toHaveClass('hover:bg-accent');\n      expect(menuItem).not.toHaveClass('transition-all');\n    });\n  });\n\n  describe('Event Handling', () => {\n    it('calls onClick handler when clicked', () => {\n      const handleClick = vi.fn();\n      render(\n        <ThemeMenuItem\n          {...defaultProps}\n          onClick={handleClick}\n        />,\n      );\n\n      const menuItem = screen.getByRole('menuitem');\n      fireEvent.click(menuItem);\n\n      expect(handleClick).toHaveBeenCalledTimes(1);\n      expect(handleClick).toHaveBeenCalledWith(expect.any(Object));\n    });\n\n    it('calls onKeyDown handler when key is pressed', () => {\n      const handleKeyDown = vi.fn();\n      render(\n        <ThemeMenuItem\n          {...defaultProps}\n          onKeyDown={handleKeyDown}\n        />,\n      );\n\n      const menuItem = screen.getByRole('menuitem');\n      fireEvent.keyDown(menuItem, { key: 'Enter' });\n\n      expect(handleKeyDown).toHaveBeenCalledTimes(1);\n      expect(handleKeyDown).toHaveBeenCalledWith(expect.any(Object));\n    });\n\n    it('handles keyboard navigation with Space key', () => {\n      const handleKeyDown = vi.fn();\n      render(\n        <ThemeMenuItem\n          {...defaultProps}\n          onKeyDown={handleKeyDown}\n        />,\n      );\n\n      const menuItem = screen.getByRole('menuitem');\n      fireEvent.keyDown(menuItem, { key: ' ' });\n\n      expect(handleKeyDown).toHaveBeenCalledWith(\n        expect.objectContaining({ key: ' ' }),\n      );\n    });\n  });\n\n  describe('Accessibility', () => {\n    it('applies focus styles', () => {\n      render(<ThemeMenuItem {...defaultProps} />);\n\n      const menuItem = screen.getByRole('menuitem');\n      expect(menuItem).toHaveClass(\n        'focus:bg-accent',\n        'focus:text-accent-foreground',\n      );\n    });\n\n    it('has proper icon accessibility attributes', () => {\n      render(<ThemeMenuItem {...defaultProps} />);\n\n      const icon = screen.getByRole('menuitem').querySelector('svg');\n      expect(icon).toHaveAttribute('aria-hidden', 'true');\n    });\n\n    it('provides accessible selected state information', () => {\n      render(\n        <ThemeMenuItem\n          {...defaultProps}\n          theme='light'\n          currentTheme='light'\n        />,\n      );\n\n      const selectedIndicator = screen.getByLabelText('当前选中');\n      expect(selectedIndicator).toBeInTheDocument();\n    });\n  });\n\n  describe('Different Theme Configurations', () => {\n    it('renders light theme configuration correctly', () => {\n      render(\n        <ThemeMenuItem\n          {...defaultProps}\n          theme='light'\n          currentTheme='light'\n          label='浅色模式'\n          ariaLabel='切换到浅色模式'\n          icon={Sun}\n        />,\n      );\n\n      expect(screen.getByText('浅色模式')).toBeInTheDocument();\n      expect(screen.getByRole('menuitem')).toHaveAttribute(\n        'aria-label',\n        '切换到浅色模式',\n      );\n      expect(screen.getByLabelText('当前选中')).toBeInTheDocument();\n    });\n\n    it('renders dark theme configuration correctly', () => {\n      render(\n        <ThemeMenuItem\n          {...defaultProps}\n          theme='dark'\n          currentTheme='dark'\n          label='深色模式'\n          ariaLabel='切换到深色模式'\n          icon={Moon}\n        />,\n      );\n\n      expect(screen.getByText('深色模式')).toBeInTheDocument();\n      expect(screen.getByRole('menuitem')).toHaveAttribute(\n        'aria-label',\n        '切换到深色模式',\n      );\n      expect(screen.getByLabelText('当前选中')).toBeInTheDocument();\n    });\n\n    it('renders system theme configuration correctly', () => {\n      render(\n        <ThemeMenuItem\n          {...defaultProps}\n          theme='system'\n          currentTheme='system'\n          label='跟随系统'\n          ariaLabel='跟随系统主题'\n          icon={Monitor}\n        />,\n      );\n\n      expect(screen.getByText('跟随系统')).toBeInTheDocument();\n      expect(screen.getByRole('menuitem')).toHaveAttribute(\n        'aria-label',\n        '跟随系统主题',\n      );\n      expect(screen.getByLabelText('当前选中')).toBeInTheDocument();\n    });\n  });\n\n  describe('Complex State Combinations', () => {\n    it('handles selected item with view transitions correctly', () => {\n      render(\n        <ThemeMenuItem\n          {...defaultProps}\n          theme='light'\n          currentTheme='light'\n          supportsViewTransitions={true}\n          prefersReducedMotion={false}\n        />,\n      );\n\n      const menuItem = screen.getByRole('menuitem');\n      expect(menuItem).toHaveClass('bg-accent', 'text-accent-foreground');\n      expect(menuItem).toHaveClass(\n        'hover:bg-accent',\n        'transition-all',\n        'duration-200',\n      );\n      expect(screen.getByText('●')).toBeInTheDocument();\n      expect(screen.getByText('✨')).toBeInTheDocument();\n    });\n\n    it('handles non-selected item with reduced motion correctly', () => {\n      render(\n        <ThemeMenuItem\n          {...defaultProps}\n          theme='light'\n          currentTheme='dark'\n          supportsViewTransitions={true}\n          prefersReducedMotion={true}\n        />,\n      );\n\n      const menuItem = screen.getByRole('menuitem');\n      expect(menuItem).not.toHaveClass('bg-accent');\n      expect(menuItem).not.toHaveClass('transition-all');\n      expect(screen.queryByText('●')).not.toBeInTheDocument();\n      expect(screen.getByText('✨')).toBeInTheDocument();\n    });\n  });\n\n  describe('Edge Cases', () => {\n    it('handles undefined currentTheme gracefully', () => {\n      const { currentTheme, ...propsWithoutCurrentTheme } = defaultProps;\n      render(<ThemeMenuItem {...propsWithoutCurrentTheme} />);\n\n      expect(screen.queryByLabelText('当前选中')).not.toBeInTheDocument();\n      const menuItem = screen.getByRole('menuitem');\n      expect(menuItem).not.toHaveClass('bg-accent');\n    });\n\n    it('handles empty label gracefully', () => {\n      render(\n        <ThemeMenuItem\n          {...defaultProps}\n          label=''\n        />,\n      );\n\n      const menuItem = screen.getByRole('menuitem');\n      expect(menuItem).toBeInTheDocument();\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/theme/__tests__/theme-toggle-button.test.tsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'onClick' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":291,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":291,"endColumn":22,"suggestions":[{"messageId":"removeVar","data":{"varName":"onClick"},"fix":{"range":[8525,8533],"text":""},"desc":"Remove unused variable 'onClick'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'onClick' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":291,"column":15,"nodeType":null,"messageId":"unusedVar","endLine":291,"endColumn":22}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { fireEvent, render, screen } from '@testing-library/react';\nimport { describe, expect, it, vi } from 'vitest';\nimport { ThemeToggleButton } from '../theme-toggle-button';\n\n// Mock lucide-react icons\nvi.mock('lucide-react', () => ({\n  Sun: ({ className, ...props }: React.ComponentProps<\"div\">) => (\n    <div\n      data-testid='sun-icon'\n      className={className}\n      {...props}\n    />\n  ),\n  Moon: ({ className, ...props }: React.ComponentProps<\"div\">) => (\n    <div\n      data-testid='moon-icon'\n      className={className}\n      {...props}\n    />\n  ),\n}));\n\ndescribe('ThemeToggleButton', () => {\n  const defaultProps = {\n    ariaAttributes: {\n      'aria-label': 'Toggle theme',\n      'aria-pressed': 'false',\n    },\n    prefersHighContrast: false,\n    prefersReducedMotion: false,\n    onKeyDown: vi.fn(),\n    onClick: vi.fn(),\n  };\n\n  beforeEach(() => {\n    vi.clearAllMocks();\n  });\n\n  describe('Basic Rendering', () => {\n    it('renders theme toggle button with default props', () => {\n      render(<ThemeToggleButton {...defaultProps} />);\n\n      const button = screen.getByRole('button');\n      expect(button).toBeInTheDocument();\n      expect(button).toHaveAttribute('aria-label', 'Toggle theme');\n      expect(button).toHaveAttribute('aria-pressed', 'false');\n    });\n\n    it('renders both sun and moon icons', () => {\n      render(<ThemeToggleButton {...defaultProps} />);\n\n      expect(screen.getByTestId('sun-icon')).toBeInTheDocument();\n      expect(screen.getByTestId('moon-icon')).toBeInTheDocument();\n    });\n\n    it('renders screen reader text', () => {\n      render(<ThemeToggleButton {...defaultProps} />);\n\n      expect(screen.getByText('主题切换按钮')).toBeInTheDocument();\n      expect(screen.getByText('主题切换按钮')).toHaveClass('sr-only');\n    });\n\n    it('applies correct button variant and size', () => {\n      render(<ThemeToggleButton {...defaultProps} />);\n\n      const button = screen.getByRole('button');\n      // Check for classes that indicate outline variant and icon size\n      expect(button).toHaveClass('border'); // outline variant has border\n      expect(button).toHaveClass('size-9'); // icon size\n    });\n  });\n\n  describe('Accessibility Features', () => {\n    it('applies all aria attributes correctly', () => {\n      const ariaAttributes = {\n        'aria-label': 'Switch to dark mode',\n        'aria-pressed': 'true',\n        'aria-describedby': 'theme-description',\n      };\n\n      render(\n        <ThemeToggleButton\n          {...defaultProps}\n          ariaAttributes={ariaAttributes}\n        />,\n      );\n\n      const button = screen.getByRole('button');\n      expect(button).toHaveAttribute('aria-label', 'Switch to dark mode');\n      expect(button).toHaveAttribute('aria-pressed', 'true');\n      expect(button).toHaveAttribute('aria-describedby', 'theme-description');\n    });\n\n    it('applies high contrast styles when prefersHighContrast is true', () => {\n      render(\n        <ThemeToggleButton\n          {...defaultProps}\n          prefersHighContrast={true}\n        />,\n      );\n\n      const button = screen.getByRole('button');\n      expect(button).toHaveClass('border-foreground', 'border-2');\n    });\n\n    it('does not apply high contrast styles when prefersHighContrast is false', () => {\n      render(\n        <ThemeToggleButton\n          {...defaultProps}\n          prefersHighContrast={false}\n        />,\n      );\n\n      const button = screen.getByRole('button');\n      expect(button).not.toHaveClass('border-foreground');\n      expect(button).not.toHaveClass('border-2');\n    });\n\n    it('applies focus ring styles', () => {\n      render(<ThemeToggleButton {...defaultProps} />);\n\n      const button = screen.getByRole('button');\n      expect(button).toHaveClass(\n        'focus:ring-ring',\n        'focus:ring-2',\n        'focus:ring-offset-2',\n      );\n    });\n  });\n\n  describe('Motion Preferences', () => {\n    it('applies transition classes when prefersReducedMotion is false', () => {\n      render(\n        <ThemeToggleButton\n          {...defaultProps}\n          prefersReducedMotion={false}\n        />,\n      );\n\n      const button = screen.getByRole('button');\n      const sunIcon = screen.getByTestId('sun-icon');\n      const moonIcon = screen.getByTestId('moon-icon');\n\n      expect(button).toHaveClass('transition-all', 'duration-200');\n      expect(sunIcon).toHaveClass('transition-all');\n      expect(moonIcon).toHaveClass('transition-all');\n    });\n\n    it('does not apply transition classes when prefersReducedMotion is true', () => {\n      render(\n        <ThemeToggleButton\n          {...defaultProps}\n          prefersReducedMotion={true}\n        />,\n      );\n\n      const button = screen.getByRole('button');\n      const sunIcon = screen.getByTestId('sun-icon');\n      const moonIcon = screen.getByTestId('moon-icon');\n\n      // Check that our custom duration class is not applied when reduced motion is preferred\n      expect(button).not.toHaveClass('duration-200');\n      // Icons should not have our custom transition-all class\n      expect(sunIcon).not.toHaveClass('transition-all');\n      expect(moonIcon).not.toHaveClass('transition-all');\n    });\n  });\n\n  describe('Icon Styling', () => {\n    it('applies correct classes to sun icon', () => {\n      render(<ThemeToggleButton {...defaultProps} />);\n\n      const sunIcon = screen.getByTestId('sun-icon');\n      expect(sunIcon).toHaveClass(\n        'h-[1.2rem]',\n        'w-[1.2rem]',\n        'scale-100',\n        'rotate-0',\n        'dark:scale-0',\n        'dark:-rotate-90',\n      );\n      expect(sunIcon).toHaveAttribute('aria-hidden', 'true');\n    });\n\n    it('applies correct classes to moon icon', () => {\n      render(<ThemeToggleButton {...defaultProps} />);\n\n      const moonIcon = screen.getByTestId('moon-icon');\n      expect(moonIcon).toHaveClass(\n        'absolute',\n        'h-[1.2rem]',\n        'w-[1.2rem]',\n        'scale-0',\n        'rotate-90',\n        'dark:scale-100',\n        'dark:rotate-0',\n      );\n      expect(moonIcon).toHaveAttribute('aria-hidden', 'true');\n    });\n  });\n\n  describe('Event Handling', () => {\n    it('calls onClick handler when button is clicked', () => {\n      const handleClick = vi.fn();\n      render(\n        <ThemeToggleButton\n          {...defaultProps}\n          onClick={handleClick}\n        />,\n      );\n\n      const button = screen.getByRole('button');\n      fireEvent.click(button);\n\n      expect(handleClick).toHaveBeenCalledTimes(1);\n      expect(handleClick).toHaveBeenCalledWith(expect.any(Object));\n    });\n\n    it('calls onKeyDown handler when key is pressed', () => {\n      const handleKeyDown = vi.fn();\n      render(\n        <ThemeToggleButton\n          {...defaultProps}\n          onKeyDown={handleKeyDown}\n        />,\n      );\n\n      const button = screen.getByRole('button');\n      fireEvent.keyDown(button, { key: 'Enter' });\n\n      expect(handleKeyDown).toHaveBeenCalledTimes(1);\n      expect(handleKeyDown).toHaveBeenCalledWith(expect.any(Object));\n    });\n\n    it('handles keyboard navigation with Space key', () => {\n      const handleKeyDown = vi.fn();\n      render(\n        <ThemeToggleButton\n          {...defaultProps}\n          onKeyDown={handleKeyDown}\n        />,\n      );\n\n      const button = screen.getByRole('button');\n      fireEvent.keyDown(button, { key: ' ' });\n\n      expect(handleKeyDown).toHaveBeenCalledWith(\n        expect.objectContaining({ key: ' ' }),\n      );\n    });\n  });\n\n  describe('Forward Ref', () => {\n    it('forwards ref to button element', () => {\n      const ref = React.createRef<HTMLButtonElement>();\n      render(\n        <ThemeToggleButton\n          {...defaultProps}\n          ref={ref}\n        />,\n      );\n\n      expect(ref.current).toBeInstanceOf(HTMLButtonElement);\n      expect(ref.current).toBe(screen.getByRole('button'));\n    });\n\n    it('has correct display name', () => {\n      expect(ThemeToggleButton.displayName).toBe('ThemeToggleButton');\n    });\n  });\n\n  describe('Props Spreading', () => {\n    it('spreads additional props to button element', () => {\n      render(\n        <ThemeToggleButton\n          {...defaultProps}\n          data-testid='custom-theme-button'\n          title='Custom title'\n        />,\n      );\n\n      const button = screen.getByRole('button');\n      expect(button).toHaveAttribute('data-testid', 'custom-theme-button');\n      expect(button).toHaveAttribute('title', 'Custom title');\n    });\n  });\n\n  describe('Edge Cases', () => {\n    it('handles missing onClick handler gracefully', () => {\n      const { onClick, ...propsWithoutClick } = defaultProps;\n      render(<ThemeToggleButton {...propsWithoutClick} />);\n\n      const button = screen.getByRole('button');\n      expect(() => fireEvent.click(button)).not.toThrow();\n    });\n\n    it('handles empty aria attributes', () => {\n      render(\n        <ThemeToggleButton\n          {...defaultProps}\n          ariaAttributes={{}}\n        />,\n      );\n\n      const button = screen.getByRole('button');\n      expect(button).toBeInTheDocument();\n    });\n\n    it('combines all accessibility and motion preferences correctly', () => {\n      render(\n        <ThemeToggleButton\n          {...defaultProps}\n          prefersHighContrast={true}\n          prefersReducedMotion={true}\n          ariaAttributes={{\n            'aria-label': 'Toggle dark mode',\n            'aria-pressed': 'true',\n          }}\n        />,\n      );\n\n      const button = screen.getByRole('button');\n      expect(button).toHaveAttribute('aria-label', 'Toggle dark mode');\n      expect(button).toHaveAttribute('aria-pressed', 'true');\n      expect(button).toHaveClass('border-foreground', 'border-2');\n      // Check that our custom duration class is not applied when reduced motion is preferred\n      expect(button).not.toHaveClass('duration-200');\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/theme/__tests__/theme-toggle.browser.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/theme/horizontal-theme-toggle-simple.tsx","messages":[{"ruleId":"react-you-might-not-need-an-effect/no-initialize-state","severity":2,"message":"Avoid initializing state in an effect. Instead, pass \"mounted\"'s initial value to its `useState`.","line":88,"column":5,"nodeType":"CallExpression","messageId":"avoidInitializingState","endLine":88,"endColumn":21}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { cn } from '@/lib/utils';\nimport { Monitor, Moon, Sun } from 'lucide-react';\nimport { useTranslations } from 'next-intl';\nimport { useTheme } from 'next-themes';\nimport React, { useEffect, useState } from 'react';\n\n/**\n * 主题选项配置\n */\nconst THEME_OPTIONS = [\n  {\n    value: 'light',\n    icon: Sun,\n    labelKey: 'theme.light',\n    ariaLabelKey: 'theme.switchToLight'\n  },\n  {\n    value: 'dark',\n    icon: Moon,\n    labelKey: 'theme.dark',\n    ariaLabelKey: 'theme.switchToDark'\n  },\n  {\n    value: 'system',\n    icon: Monitor,\n    labelKey: 'theme.system',\n    ariaLabelKey: 'theme.switchToSystem'\n  }\n] as const;\n\n/**\n * 组件属性接口\n */\nexport interface HorizontalThemeToggleProps {\n  /** 是否显示文字标签 */\n  showLabels?: boolean;\n  /** 组件尺寸 */\n  size?: 'sm' | 'default' | 'lg';\n  /** 自定义样式类名 */\n  className?: string;\n  /** 测试ID */\n  'data-testid'?: string;\n}\n\n/**\n * 获取尺寸相关的样式类\n */\nconst getSizeClasses = (size: 'sm' | 'default' | 'lg') => {\n  switch (size) {\n    case 'sm':\n      return {\n        container: 'p-0.5',\n        button: 'px-2 py-1 text-xs gap-1.5',\n        icon: 'h-3 w-3'\n      };\n    case 'lg':\n      return {\n        container: 'p-1',\n        button: 'px-4 py-2 text-base gap-2',\n        icon: 'h-5 w-5'\n      };\n    default:\n      return {\n        container: 'p-0.5',\n        button: 'px-3 py-1.5 text-sm gap-2',\n        icon: 'h-4 w-4'\n      };\n  }\n};\n\n/**\n * 水平主题切换组件 - 简化版\n */\nexport function HorizontalThemeToggle({\n  showLabels = false,\n  size = 'default',\n  className,\n  'data-testid': testId = 'horizontal-theme-toggle',\n}: HorizontalThemeToggleProps) {\n  const { theme, setTheme } = useTheme();\n  const [mounted, setMounted] = useState(false);\n  const t = useTranslations();\n\n  // 防止 hydration mismatch\n  useEffect(() => {\n    setMounted(true);\n  }, []);\n\n  const sizeClasses = getSizeClasses(size);\n\n  // 加载状态的骨架屏\n  if (!mounted) {\n    return (\n      <div\n        className={cn(\n          'inline-flex items-center rounded-lg border bg-background',\n          sizeClasses.container,\n          className\n        )}\n        data-testid={testId}\n      >\n        {THEME_OPTIONS.map((option) => (\n          <div\n            key={option.value}\n            className={cn(\n              'flex items-center justify-center rounded-md transition-colors',\n              sizeClasses.button,\n              'bg-muted animate-pulse'\n            )}\n          >\n            <div className={cn('rounded', sizeClasses.icon, 'bg-muted-foreground/20')} />\n            {showLabels && (\n              <div className=\"h-4 w-12 rounded bg-muted-foreground/20\" />\n            )}\n          </div>\n        ))}\n      </div>\n    );\n  }\n\n  return (\n    <div\n      className={cn(\n        'inline-flex items-center rounded-lg border bg-background',\n        sizeClasses.container,\n        className\n      )}\n      role=\"radiogroup\"\n      aria-label={t('theme.toggleLabel')}\n      data-testid={testId}\n    >\n      {THEME_OPTIONS.map((themeOption) => {\n        const Icon = themeOption.icon;\n        const isActive = theme === themeOption.value;\n        const label = t(themeOption.labelKey);\n        const ariaLabel = t(themeOption.ariaLabelKey);\n\n        return (\n          <button\n            key={themeOption.value}\n            className={cn(\n              'flex items-center justify-center rounded-md transition-colors',\n              'hover:bg-muted focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring',\n              sizeClasses.button,\n              isActive && 'bg-primary text-primary-foreground hover:bg-primary/90'\n            )}\n            onClick={() => setTheme(themeOption.value)}\n            aria-label={ariaLabel}\n            role=\"radio\"\n            aria-checked={isActive}\n            type=\"button\"\n          >\n            <Icon className={cn(sizeClasses.icon)} />\n            {showLabels && (\n              <span className=\"font-medium\">{label}</span>\n            )}\n          </button>\n        );\n      })}\n    </div>\n  );\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/theme/horizontal-theme-toggle.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/theme/horizontal-theme-toggle/animation-utils.ts","messages":[{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2.","line":8,"column":46,"nodeType":"Literal","messageId":"noMagic","endLine":8,"endColumn":47},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2.","line":9,"column":46,"nodeType":"Literal","messageId":"noMagic","endLine":9,"endColumn":47},{"ruleId":"no-unused-vars","severity":2,"message":"'theme' is defined but never used. Allowed unused args must match /^_/u.","line":45,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":45,"endColumn":27,"suggestions":[{"messageId":"removeVar","data":{"varName":"theme"},"fix":{"range":[1201,1214],"text":""},"desc":"Remove unused variable 'theme'."}]},{"ruleId":"max-params","severity":2,"message":"Arrow function has too many parameters (5). Maximum allowed is 3.","line":46,"column":3,"nodeType":"ArrowFunctionExpression","messageId":"exceed","endLine":46,"endColumn":5}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 主题切换动画工具函数\n */\nexport const createCircleBlurAnimation = (buttonElement: HTMLElement | null) => {\n  if (!buttonElement) return '';\n\n  const rect = buttonElement.getBoundingClientRect();\n  const centerX = ((rect.left + rect.width / 2) / window.innerWidth) * 100;\n  const centerY = ((rect.top + rect.height / 2) / window.innerHeight) * 100;\n\n  return `\n    @supports (view-transition-name: root) {\n      ::view-transition-old(root) {\n        animation: none;\n      }\n      ::view-transition-new(root) {\n        animation: circle-blur-expand 0.6s cubic-bezier(0.4, 0, 0.2, 1);\n        transform-origin: ${centerX}% ${centerY}%;\n      }\n      @keyframes circle-blur-expand {\n        from {\n          clip-path: circle(0% at ${centerX}% ${centerY}%);\n          filter: blur(8px);\n        }\n        50% {\n          filter: blur(4px);\n        }\n        to {\n          clip-path: circle(150% at ${centerX}% ${centerY}%);\n          filter: blur(0);\n        }\n      }\n    }\n  `;\n};\n\n/**\n * 应用主题切换动画\n */\nexport const applyThemeAnimation = (\n  newTheme: string,\n  buttonElement: HTMLButtonElement | null,\n  animationVariant: 'circle-blur' | 'framer-motion',\n  shouldDisableAnimations: boolean,\n  setTheme: (theme: string) => void\n) => {\n  // 确定使用的动画变体\n  const shouldUseCircleBlur = animationVariant === 'circle-blur' &&\n                             !shouldDisableAnimations &&\n                             'startViewTransition' in document;\n\n  if (shouldUseCircleBlur && buttonElement) {\n    // 创建动画样式\n    const styleId = `theme-transition-${Date.now()}`;\n    const style = document.createElement('style');\n    style.id = styleId;\n    style.textContent = createCircleBlurAnimation(buttonElement);\n    document.head.appendChild(style);\n\n    // 使用 View Transition API\n    (document as unknown).startViewTransition(() => {\n      setTheme(newTheme);\n    });\n\n    // 清理动画样式\n    setTimeout(() => {\n      const styleEl = document.getElementById(styleId);\n      if (styleEl) {\n        styleEl.remove();\n      }\n    }, 1000);\n  } else {\n    // 直接切换主题，不使用动画\n    setTheme(newTheme);\n  }\n};\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/theme/horizontal-theme-toggle/keyboard-handler.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'newTheme' is defined but never used. Allowed unused args must match /^_/u.","line":8,"column":23,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":39,"suggestions":[{"messageId":"removeVar","data":{"varName":"newTheme"},"fix":{"range":[157,174],"text":""},"desc":"Remove unused variable 'newTheme'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'buttonElement' is defined but never used. Allowed unused args must match /^_/u.","line":8,"column":41,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":74,"suggestions":[{"messageId":"removeVar","data":{"varName":"buttonElement"},"fix":{"range":[173,208],"text":""},"desc":"Remove unused variable 'buttonElement'."}]},{"ruleId":"max-statements","severity":2,"message":"Arrow function has too many statements (26). Maximum allowed is 20.","line":10,"column":10,"nodeType":"ArrowFunctionExpression","messageId":"exceed","endLine":56,"endColumn":4},{"ruleId":"no-undef","severity":2,"message":"'React' is not defined.","line":11,"column":12,"nodeType":"Identifier","messageId":"undef","endLine":11,"endColumn":17},{"ruleId":"default-case","severity":2,"message":"Expected a default case.","line":18,"column":5,"nodeType":"SwitchStatement","messageId":"missingDefaultCase","endLine":55,"endColumn":6},{"ruleId":"security/detect-object-injection","severity":2,"message":"Variable Assigned to Object Injection Sink","line":23,"column":28,"nodeType":"MemberExpression","endLine":23,"endColumn":52},{"ruleId":"security/detect-object-injection","severity":2,"message":"Variable Assigned to Object Injection Sink","line":33,"column":28,"nodeType":"MemberExpression","endLine":33,"endColumn":52}],"suppressedMessages":[],"errorCount":7,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { THEME_OPTIONS } from './theme-config';\n\n/**\n * 处理键盘导航\n */\nexport const createKeyboardHandler = (\n  theme: string | undefined,\n  handleThemeChange: (newTheme: string, buttonElement?: HTMLButtonElement) => void\n) => {\n  return (\n    event: React.KeyboardEvent<HTMLButtonElement>,\n    _themeValue: string\n  ) => {\n    const currentIndex = THEME_OPTIONS.findIndex(option => option.value === theme);\n    let nextIndex = currentIndex;\n    const buttonElement = event.currentTarget;\n\n    switch (event.key) {\n      case 'ArrowLeft':\n      case 'ArrowUp': {\n        event.preventDefault();\n        nextIndex = currentIndex > 0 ? currentIndex - 1 : THEME_OPTIONS.length - 1;\n        const prevOption = THEME_OPTIONS[nextIndex];\n        if (prevOption) {\n          handleThemeChange(prevOption.value, buttonElement);\n        }\n        break;\n      }\n      case 'ArrowRight':\n      case 'ArrowDown': {\n        event.preventDefault();\n        nextIndex = currentIndex < THEME_OPTIONS.length - 1 ? currentIndex + 1 : 0;\n        const nextOption = THEME_OPTIONS[nextIndex];\n        if (nextOption) {\n          handleThemeChange(nextOption.value, buttonElement);\n        }\n        break;\n      }\n      case 'Home': {\n        event.preventDefault();\n        const firstOption = THEME_OPTIONS[0];\n        if (firstOption) {\n          handleThemeChange(firstOption.value, buttonElement);\n        }\n        break;\n      }\n      case 'End': {\n        event.preventDefault();\n        const lastOption = THEME_OPTIONS[THEME_OPTIONS.length - 1];\n        if (lastOption) {\n          handleThemeChange(lastOption.value, buttonElement);\n        }\n        break;\n      }\n    }\n  };\n};\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/theme/horizontal-theme-toggle/theme-config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/theme/theme-menu-item.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/theme/theme-performance-monitor.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/theme/theme-toggle-button.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/theme/vercel-theme-toggle-simple.tsx","messages":[{"ruleId":"react-you-might-not-need-an-effect/no-initialize-state","severity":2,"message":"Avoid initializing state in an effect. Instead, pass \"mounted\"'s initial value to its `useState`.","line":59,"column":5,"nodeType":"CallExpression","messageId":"avoidInitializingState","endLine":59,"endColumn":21}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { cn } from '@/lib/utils';\nimport { Monitor, Moon, Sun } from 'lucide-react';\nimport { useTranslations } from 'next-intl';\nimport { useTheme } from 'next-themes';\nimport React, { useEffect, useState } from 'react';\n\n/**\n * 主题选项配置\n */\nconst THEME_OPTIONS = [\n  {\n    value: 'system',\n    icon: Monitor,\n    labelKey: 'theme.system',\n    ariaLabelKey: 'theme.switchToSystem'\n  },\n  {\n    value: 'light',\n    icon: Sun,\n    labelKey: 'theme.light',\n    ariaLabelKey: 'theme.switchToLight'\n  },\n  {\n    value: 'dark',\n    icon: Moon,\n    labelKey: 'theme.dark',\n    ariaLabelKey: 'theme.switchToDark'\n  }\n] as const;\n\n/**\n * 组件属性接口\n */\nexport interface VercelThemeToggleProps {\n  /** 自定义样式类名 */\n  className?: string;\n  /** 是否显示标题 */\n  showTitle?: boolean;\n  /** 自定义测试ID */\n  'data-testid'?: string;\n}\n\n/**\n * Vercel 风格主题切换组件 - 简化版\n */\nexport function VercelThemeToggle({\n  className,\n  showTitle = true,\n  'data-testid': testId = 'vercel-theme-toggle',\n}: VercelThemeToggleProps) {\n  const { theme, setTheme } = useTheme();\n  const [mounted, setMounted] = useState(false);\n  const t = useTranslations();\n\n  // 防止 hydration mismatch\n  useEffect(() => {\n    setMounted(true);\n  }, []);\n\n  // 加载状态的骨架屏\n  if (!mounted) {\n    return (\n      <div className={cn('space-y-3', className)} data-testid={`${testId}-skeleton`}>\n        {showTitle && (\n          <div className=\"h-5 w-16 animate-pulse bg-muted rounded\" />\n        )}\n        <div className=\"flex gap-2\">\n          {THEME_OPTIONS.map((_, index) => (\n            <div\n              key={index}\n              className=\"flex items-center gap-2 p-2 rounded-md border animate-pulse\"\n            >\n              <div className=\"h-4 w-4 bg-muted rounded\" />\n              <div className=\"h-4 w-12 bg-muted rounded\" />\n            </div>\n          ))}\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className={cn('space-y-3', className)} data-testid={testId}>\n      {showTitle && (\n        <h3 className=\"text-sm font-medium text-foreground\">\n          {t('theme.title')}\n        </h3>\n      )}\n      \n      <div className=\"flex gap-2\" role=\"radiogroup\" aria-label={t('theme.selectTheme')}>\n        {THEME_OPTIONS.map((themeOption) => {\n          const Icon = themeOption.icon;\n          const isActive = theme === themeOption.value;\n          const label = t(themeOption.labelKey);\n          const ariaLabel = t(themeOption.ariaLabelKey);\n\n          return (\n            <button\n              key={themeOption.value}\n              className={cn(\n                'flex items-center gap-2 px-3 py-2 text-sm rounded-md border transition-colors',\n                'hover:bg-muted focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring',\n                isActive\n                  ? 'bg-primary text-primary-foreground border-primary'\n                  : 'bg-background text-muted-foreground border-border hover:text-foreground'\n              )}\n              onClick={() => setTheme(themeOption.value)}\n              aria-label={ariaLabel}\n              role=\"radio\"\n              aria-checked={isActive}\n              type=\"button\"\n              data-testid={`${testId}-${themeOption.value}`}\n            >\n              <Icon className=\"h-4 w-4\" />\n              <span className=\"font-medium\">{label}</span>\n            </button>\n          );\n        })}\n      </div>\n    </div>\n  );\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/theme/vercel-theme-toggle.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/animated-counter-accessibility.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/animated-counter-animation.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/animated-counter-basic.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/animated-counter-formatters.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/animated-counter-performance.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/animated-counter.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/badge-accessibility-interactions.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/badge-basic-rendering.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/badge-basic-variants.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/badge-content-basic.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/badge-content-special.test.tsx","messages":[{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":66,"column":29,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[1847,1870],"text":"Quotes: &quot;Hello\" 'World'"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[1847,1870],"text":"Quotes: &ldquo;Hello\" 'World'"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[1847,1870],"text":"Quotes: &#34;Hello\" 'World'"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[1847,1870],"text":"Quotes: &rdquo;Hello\" 'World'"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":66,"column":35,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[1847,1870],"text":"Quotes: \"Hello&quot; 'World'"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[1847,1870],"text":"Quotes: \"Hello&ldquo; 'World'"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[1847,1870],"text":"Quotes: \"Hello&#34; 'World'"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[1847,1870],"text":"Quotes: \"Hello&rdquo; 'World'"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":66,"column":37,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[1847,1870],"text":"Quotes: \"Hello\" &apos;World'"},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[1847,1870],"text":"Quotes: \"Hello\" &lsquo;World'"},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[1847,1870],"text":"Quotes: \"Hello\" &#39;World'"},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[1847,1870],"text":"Quotes: \"Hello\" &rsquo;World'"},"desc":"Replace with `&rsquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":66,"column":43,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[1847,1870],"text":"Quotes: \"Hello\" 'World&apos;"},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[1847,1870],"text":"Quotes: \"Hello\" 'World&lsquo;"},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[1847,1870],"text":"Quotes: \"Hello\" 'World&#39;"},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[1847,1870],"text":"Quotes: \"Hello\" 'World&rsquo;"},"desc":"Replace with `&rsquo;`."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @vitest-environment jsdom\n */\n\n/**\n * Badge Content - Special Characters Tests\n *\n * 专门测试特殊字符内容渲染，包括：\n * - 特殊字符\n * - Unicode字符\n * - HTML实体\n * - 数学符号\n * - 货币符号\n */\n\nimport React from 'react';\nimport { render, screen } from '@testing-library/react';\nimport { describe, expect, it } from 'vitest';\nimport { Badge } from '../badge';\n\ndescribe('Badge Content - Special Characters Tests', () => {\n  describe('特殊字符渲染', () => {\n    it('renders special characters', () => {\n      render(<Badge>Special: @#$%^&*()</Badge>);\n\n      const badge = screen.getByText('Special: @#$%^&*()');\n      expect(badge).toHaveTextContent('Special: @#$%^&*()');\n    });\n\n    it('renders unicode characters', () => {\n      render(<Badge>Unicode: 🎉 ✨ 🚀</Badge>);\n\n      const badge = screen.getByText('Unicode: 🎉 ✨ 🚀');\n      expect(badge).toHaveTextContent('Unicode: 🎉 ✨ 🚀');\n    });\n\n    it('renders HTML entities correctly', () => {\n      render(<Badge>&lt;HTML&gt; &amp; Entities</Badge>);\n\n      const badge = screen.getByText('<HTML> & Entities');\n      expect(badge).toHaveTextContent('<HTML> & Entities');\n    });\n\n    it('renders mathematical symbols', () => {\n      render(<Badge>Math: ∑ ∫ ∞ ≠ ≤ ≥</Badge>);\n\n      const badge = screen.getByText('Math: ∑ ∫ ∞ ≠ ≤ ≥');\n      expect(badge).toHaveTextContent('Math: ∑ ∫ ∞ ≠ ≤ ≥');\n    });\n\n    it('renders currency symbols', () => {\n      render(<Badge>Currency: $ € £ ¥ ₹</Badge>);\n\n      const badge = screen.getByText('Currency: $ € £ ¥ ₹');\n      expect(badge).toHaveTextContent('Currency: $ € £ ¥ ₹');\n    });\n\n    it('renders punctuation marks', () => {\n      render(<Badge>Punctuation: .,;:!?</Badge>);\n\n      const badge = screen.getByText('Punctuation: .,;:!?');\n      expect(badge).toHaveTextContent('Punctuation: .,;:!?');\n    });\n\n    it('renders quotation marks', () => {\n      render(<Badge>Quotes: \"Hello\" 'World'</Badge>);\n\n      const badge = screen.getByText('Quotes: \"Hello\" \\'World\\'');\n      expect(badge).toHaveTextContent('Quotes: \"Hello\" \\'World\\'');\n    });\n\n    it('renders brackets and parentheses', () => {\n      render(<Badge>Brackets: [] {} ()</Badge>);\n\n      const badge = screen.getByText('Brackets: [] {} ()');\n      expect(badge).toHaveTextContent('Brackets: [] {} ()');\n    });\n\n    it('renders operators', () => {\n      render(<Badge>Operators: + - * / = %</Badge>);\n\n      const badge = screen.getByText('Operators: + - * / = %');\n      expect(badge).toHaveTextContent('Operators: + - * / = %');\n    });\n\n    it('renders comparison operators', () => {\n      render(<Badge>Compare: &lt; &gt; &lt;= &gt;=</Badge>);\n\n      const badge = screen.getByText('Compare: < > <= >=');\n      expect(badge).toHaveTextContent('Compare: < > <= >=');\n    });\n  });\n\n  describe('国际化字符', () => {\n    it('renders Chinese characters', () => {\n      render(<Badge>中文测试</Badge>);\n\n      const badge = screen.getByText('中文测试');\n      expect(badge).toHaveTextContent('中文测试');\n    });\n\n    it('renders Japanese characters', () => {\n      render(<Badge>日本語テスト</Badge>);\n\n      const badge = screen.getByText('日本語テスト');\n      expect(badge).toHaveTextContent('日本語テスト');\n    });\n\n    it('renders Korean characters', () => {\n      render(<Badge>한국어 테스트</Badge>);\n\n      const badge = screen.getByText('한국어 테스트');\n      expect(badge).toHaveTextContent('한국어 테스트');\n    });\n\n    it('renders Arabic characters', () => {\n      render(<Badge>اختبار عربي</Badge>);\n\n      const badge = screen.getByText('اختبار عربي');\n      expect(badge).toHaveTextContent('اختبار عربي');\n    });\n\n    it('renders Hebrew characters', () => {\n      render(<Badge>בדיקה עברית</Badge>);\n\n      const badge = screen.getByText('בדיקה עברית');\n      expect(badge).toHaveTextContent('בדיקה עברית');\n    });\n\n    it('renders Russian characters', () => {\n      render(<Badge>Русский тест</Badge>);\n\n      const badge = screen.getByText('Русский тест');\n      expect(badge).toHaveTextContent('Русский тест');\n    });\n\n    it('renders Greek characters', () => {\n      render(<Badge>Ελληνικό τεστ</Badge>);\n\n      const badge = screen.getByText('Ελληνικό τεστ');\n      expect(badge).toHaveTextContent('Ελληνικό τεστ');\n    });\n\n    it('renders accented characters', () => {\n      render(<Badge>Café résumé naïve</Badge>);\n\n      const badge = screen.getByText('Café résumé naïve');\n      expect(badge).toHaveTextContent('Café résumé naïve');\n    });\n\n    it('renders mixed languages', () => {\n      render(<Badge>Hello 世界 мир</Badge>);\n\n      const badge = screen.getByText('Hello 世界 мир');\n      expect(badge).toHaveTextContent('Hello 世界 мир');\n    });\n  });\n\n  describe('符号和图标', () => {\n    it('renders arrow symbols', () => {\n      render(<Badge>Arrows: ← → ↑ ↓ ↔</Badge>);\n\n      const badge = screen.getByText('Arrows: ← → ↑ ↓ ↔');\n      expect(badge).toHaveTextContent('Arrows: ← → ↑ ↓ ↔');\n    });\n\n    it('renders geometric shapes', () => {\n      render(<Badge>Shapes: ■ ● ▲ ◆ ★</Badge>);\n\n      const badge = screen.getByText('Shapes: ■ ● ▲ ◆ ★');\n      expect(badge).toHaveTextContent('Shapes: ■ ● ▲ ◆ ★');\n    });\n\n    it('renders checkmarks and crosses', () => {\n      render(<Badge>Marks: ✓ ✗ ✔ ✘ ☑</Badge>);\n\n      const badge = screen.getByText('Marks: ✓ ✗ ✔ ✘ ☑');\n      expect(badge).toHaveTextContent('Marks: ✓ ✗ ✔ ✘ ☑');\n    });\n\n    it('renders weather symbols', () => {\n      render(<Badge>Weather: ☀ ☁ ☂ ❄ ⚡</Badge>);\n\n      const badge = screen.getByText('Weather: ☀ ☁ ☂ ❄ ⚡');\n      expect(badge).toHaveTextContent('Weather: ☀ ☁ ☂ ❄ ⚡');\n    });\n\n    it('renders music symbols', () => {\n      render(<Badge>Music: ♪ ♫ ♬ ♭ ♯</Badge>);\n\n      const badge = screen.getByText('Music: ♪ ♫ ♬ ♭ ♯');\n      expect(badge).toHaveTextContent('Music: ♪ ♫ ♬ ♭ ♯');\n    });\n\n    it('renders card suits', () => {\n      render(<Badge>Cards: ♠ ♥ ♦ ♣</Badge>);\n\n      const badge = screen.getByText('Cards: ♠ ♥ ♦ ♣');\n      expect(badge).toHaveTextContent('Cards: ♠ ♥ ♦ ♣');\n    });\n\n    it('renders zodiac symbols', () => {\n      render(<Badge>Zodiac: ♈ ♉ ♊ ♋ ♌</Badge>);\n\n      const badge = screen.getByText('Zodiac: ♈ ♉ ♊ ♋ ♌');\n      expect(badge).toHaveTextContent('Zodiac: ♈ ♉ ♊ ♋ ♌');\n    });\n\n    it('renders miscellaneous symbols', () => {\n      render(<Badge>Misc: © ® ™ § ¶</Badge>);\n\n      const badge = screen.getByText('Misc: © ® ™ § ¶');\n      expect(badge).toHaveTextContent('Misc: © ® ™ § ¶');\n    });\n  });\n\n  describe('技术符号', () => {\n    it('renders programming symbols', () => {\n      render(<Badge>Code: {} [] () &lt;&gt;</Badge>);\n\n      const badge = screen.getByText('Code: {} [] () <>');\n      expect(badge).toHaveTextContent('Code: {} [] () <>');\n    });\n\n    it('renders network symbols', () => {\n      render(<Badge>Network: @ # $ %</Badge>);\n\n      const badge = screen.getByText('Network: @ # $ %');\n      expect(badge).toHaveTextContent('Network: @ # $ %');\n    });\n\n    it('renders file path separators', () => {\n      render(<Badge>Path: / \\\\ | :</Badge>);\n\n      const badge = screen.getByText('Path: / \\\\ | :');\n      expect(badge).toHaveTextContent('Path: / \\\\ | :');\n    });\n\n    it('renders escape sequences', () => {\n      render(<Badge>Escape: \\\\n \\\\t \\\\r \\\\&quot;</Badge>);\n\n      const badge = screen.getByText('Escape: \\\\n \\\\t \\\\r \\\\\"');\n      expect(badge).toHaveTextContent('Escape: \\\\n \\\\t \\\\r \\\\\"');\n    });\n\n    it('renders regex patterns', () => {\n      render(<Badge>Regex: ^$ .* +? [a-z]</Badge>);\n\n      const badge = screen.getByText('Regex: ^$ .* +? [a-z]');\n      expect(badge).toHaveTextContent('Regex: ^$ .* +? [a-z]');\n    });\n\n    it('renders SQL operators', () => {\n      render(<Badge>SQL: = != &lt;&gt; LIKE IN</Badge>);\n\n      const badge = screen.getByText('SQL: = != <> LIKE IN');\n      expect(badge).toHaveTextContent('SQL: = != <> LIKE IN');\n    });\n\n    it('renders markdown syntax', () => {\n      render(<Badge>Markdown: # ** __ ~~</Badge>);\n\n      const badge = screen.getByText('Markdown: # ** __ ~~');\n      expect(badge).toHaveTextContent('Markdown: # ** __ ~~');\n    });\n\n    it('renders URL components', () => {\n      render(<Badge>URL: :// ? & = #</Badge>);\n\n      const badge = screen.getByText('URL: :// ? & = #');\n      expect(badge).toHaveTextContent('URL: :// ? & = #');\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/badge-custom-props-core.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/badge-custom-props.test.tsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Declaration or statement expected.","line":74,"column":4}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @vitest-environment jsdom\n */\n\n/**\n * Badge Custom Props Tests\n *\n * Tests for Badge component custom properties including:\n * - Custom className handling\n * - HTML attributes support\n * - Style prop support\n * - Event handlers\n * - Ref forwarding\n * - Accessibility attributes\n * - Data attributes\n * - Boolean attributes\n */\n\nimport { fireEvent, render, screen } from '@testing-library/react';\nimport React, { createRef } from 'react';\nimport { describe, expect, it, vi } from 'vitest';\nimport { Badge } from '../badge';\n\ndescribe('Badge Custom Props - Advanced Tests', () => {\n  describe('Advanced Custom Properties', () => {\n    it('handles complex className combinations with variants', () => {\n      render(\n        <Badge className='custom-class advanced-style' variant='destructive'>\n          Advanced Badge\n        </Badge>\n      );\n\n      const badge = screen.getByText('Advanced Badge');\n      expect(badge).toHaveClass('custom-class', 'advanced-style');\n    });\n\n    it('handles performance optimization with complex prop combinations', () => {\n      const complexProps = {\n        className: 'perf-test-1 perf-test-2 perf-test-3',\n        'data-performance': 'test',\n        'aria-label': 'Performance test badge',\n        style: {\n          backgroundColor: 'rgba(255, 0, 0, 0.1)',\n          border: '1px solid red',\n          borderRadius: '8px'\n        },\n        variant: 'outline' as const,\n        _onClick: () => console.log('Performance test clicked')\n      };\n\n      render(<Badge {...complexProps}>Performance Test</Badge>);\n\n      const badge = screen.getByText('Performance Test');\n      expect(badge).toHaveClass('perf-test-1', 'perf-test-2', 'perf-test-3');\n      expect(badge).toHaveAttribute('data-performance', 'test');\n      expect(badge).toHaveAttribute('aria-label', 'Performance test badge');\n    });\n  });\n});\n\n      render(\n        <Badge onMouseEnter={handleMouseEnter} onMouseLeave={handleMouseLeave}>\n          Hover Badge\n        </Badge>\n      );\n\n      const badge = screen.getByText('Hover Badge');\n\n      fireEvent.mouseEnter(badge);\n      expect(handleMouseEnter).toHaveBeenCalledTimes(1);\n\n      fireEvent.mouseLeave(badge);\n      expect(handleMouseLeave).toHaveBeenCalledTimes(1);\n    });\n\n    it('supports onFocus and onBlur handlers', () => {\n      const handleFocus = vi.fn();\n      const handleBlur = vi.fn();\n\n      render(\n        <Badge onFocus={handleFocus} onBlur={handleBlur} tabIndex={0}>\n          Focus Badge\n        </Badge>\n      );\n\n      const badge = screen.getByText('Focus Badge');\n\n      badge.focus();\n      expect(handleFocus).toHaveBeenCalledTimes(1);\n\n      badge.blur();\n      expect(handleBlur).toHaveBeenCalledTimes(1);\n    });\n\n    it('forwards ref correctly', () => {\n      const ref = createRef<HTMLDivElement>();\n      render(<Badge ref={ref}>Ref Badge</Badge>);\n\n      expect(ref.current).toBeInstanceOf(HTMLDivElement);\n      expect(ref.current).toHaveTextContent('Ref Badge');\n    });\n\n    it('supports tabIndex for keyboard navigation', () => {\n      render(<Badge tabIndex={0}>Focusable Badge</Badge>);\n\n      const badge = screen.getByText('Focusable Badge');\n      expect(badge).toHaveAttribute('tabIndex', '0');\n    });\n\n    it('supports ARIA attributes for accessibility', () => {\n      render(\n        <Badge\n          aria-describedby='description'\n          aria-live='polite'\n          aria-atomic='true'\n        >\n          ARIA Badge\n        </Badge>\n      );\n\n      const badge = screen.getByText('ARIA Badge');\n      expect(badge).toHaveAttribute('aria-describedby', 'description');\n      expect(badge).toHaveAttribute('aria-live', 'polite');\n      expect(badge).toHaveAttribute('aria-atomic', 'true');\n    });\n\n    it('supports custom data attributes', () => {\n      render(\n        <Badge\n          data-testid='custom-badge'\n          data-category='status'\n          data-priority='high'\n        >\n          Data Badge\n        </Badge>\n      );\n\n      const badge = screen.getByTestId('custom-badge');\n      expect(badge).toHaveAttribute('data-category', 'status');\n      expect(badge).toHaveAttribute('data-priority', 'high');\n    });\n\n    it('handles boolean attributes correctly', () => {\n      render(\n        <Badge\n          hidden={false}\n          disabled={false}\n          contentEditable={false}\n        >\n          Boolean Badge\n        </Badge>\n      );\n\n      const badge = screen.getByText('Boolean Badge');\n      expect(badge).not.toHaveAttribute('hidden');\n      expect(badge).not.toHaveAttribute('disabled');\n      expect(badge).toHaveAttribute('contentEditable', 'false');\n    });\n\n    it('supports title attribute for tooltips', () => {\n      render(<Badge title='This is a tooltip'>Tooltip Badge</Badge>);\n\n      const badge = screen.getByText('Tooltip Badge');\n      expect(badge).toHaveAttribute('title', 'This is a tooltip');\n    });\n\n    it('supports multiple className values', () => {\n      render(<Badge className='class1 class2 class3'>Multiple Classes</Badge>);\n\n      const badge = screen.getByText('Multiple Classes');\n      expect(badge).toHaveClass('class1', 'class2', 'class3');\n    });\n\n    it('supports conditional className', () => {\n      const isActive = true;\n      render(\n        <Badge className={isActive ? 'active' : 'inactive'}>\n          Conditional Class\n        </Badge>\n      );\n\n      const badge = screen.getByText('Conditional Class');\n      expect(badge).toHaveClass('active');\n      expect(badge).not.toHaveClass('inactive');\n    });\n\n    it('supports className as array', () => {\n      const classes = ['array-class-1', 'array-class-2'];\n      render(<Badge className={classes.join(' ')}>Array Classes</Badge>);\n\n      const badge = screen.getByText('Array Classes');\n      expect(badge).toHaveClass('array-class-1', 'array-class-2');\n    });\n\n    it('supports dynamic style updates', () => {\n      const DynamicBadge = ({ color }: { color: string }) => (\n        <Badge style={{ color }}>Dynamic Style</Badge>\n      );\n\n      const { rerender } = render(<DynamicBadge color='red' />);\n\n      let badge = screen.getByText('Dynamic Style');\n      expect(badge).toHaveStyle({ color: 'red' });\n\n      rerender(<DynamicBadge color='blue' />);\n\n      badge = screen.getByText('Dynamic Style');\n      expect(badge).toHaveStyle({ color: 'blue' });\n    });\n\n    it('supports complex style objects', () => {\n      const complexStyle = {\n        backgroundColor: 'linear-gradient(45deg, red, blue)',\n        border: '2px solid black',\n        borderRadius: '8px',\n        padding: '10px',\n        margin: '5px'\n      };\n\n      render(<Badge style={complexStyle}>Complex Style</Badge>);\n\n      const badge = screen.getByText('Complex Style');\n      expect(badge).toHaveStyle(complexStyle);\n    });\n\n    it('supports CSS custom properties', () => {\n      render(\n        <Badge style={{ '--custom-color': 'purple', color: 'var(--custom-color)' } as React.CSSProperties}>\n          CSS Variables\n        </Badge>\n      );\n\n      const badge = screen.getByText('CSS Variables');\n      expect(badge).toHaveStyle({ '--custom-color': 'purple' });\n    });\n\n    it('handles event propagation correctly', () => {\n      const parentClick = vi.fn();\n      const badgeClick = vi.fn();\n\n      render(\n        <div _onClick={parentClick}>\n          <Badge _onClick={badgeClick}>Event Badge</Badge>\n        </div>\n      );\n\n      const badge = screen.getByText('Event Badge');\n      badge.click();\n\n      expect(badgeClick).toHaveBeenCalledTimes(1);\n      expect(parentClick).toHaveBeenCalledTimes(1);\n    });\n\n    it('supports keyboard event handlers', () => {\n      const handleKeyDown = vi.fn();\n      const handleKeyUp = vi.fn();\n\n      render(\n        <Badge onKeyDown={handleKeyDown} onKeyUp={handleKeyUp} tabIndex={0}>\n          Keyboard Badge\n        </Badge>\n      );\n\n      const badge = screen.getByText('Keyboard Badge');\n\n      fireEvent.keyDown(badge, { key: 'Enter' });\n      expect(handleKeyDown).toHaveBeenCalledTimes(1);\n\n      fireEvent.keyUp(badge, { key: 'Enter' });\n      expect(handleKeyUp).toHaveBeenCalledTimes(1);\n    });\n\n    it('supports form-related attributes', () => {\n      render(\n        <Badge\n          form='test-form'\n          name='badge-name'\n          value='badge-value'\n        >\n          Form Badge\n        </Badge>\n      );\n\n      const badge = screen.getByText('Form Badge');\n      expect(badge).toHaveAttribute('form', 'test-form');\n      expect(badge).toHaveAttribute('name', 'badge-name');\n      expect(badge).toHaveAttribute('value', 'badge-value');\n    });\n\n    it('supports drag and drop attributes', () => {\n      render(\n        <Badge\n          draggable={true}\n          onDragStart={vi.fn()}\n          onDrop={vi.fn()}\n        >\n          Draggable Badge\n        </Badge>\n      );\n\n      const badge = screen.getByText('Draggable Badge');\n      expect(badge).toHaveAttribute('draggable', 'true');\n    });\n\n    it('supports internationalization attributes', () => {\n      render(\n        <Badge\n          lang='es'\n          dir='ltr'\n          translate='yes'\n        >\n          i18n Badge\n        </Badge>\n      );\n\n      const badge = screen.getByText('i18n Badge');\n      expect(badge).toHaveAttribute('lang', 'es');\n      expect(badge).toHaveAttribute('dir', 'ltr');\n      expect(badge).toHaveAttribute('translate', 'yes');\n    });\n\n    it('supports microdata attributes', () => {\n      render(\n        <Badge\n          itemScope\n          itemType='https://schema.org/Thing'\n          itemProp='name'\n        >\n          Microdata Badge\n        </Badge>\n      );\n\n      const badge = screen.getByText('Microdata Badge');\n      expect(badge).toHaveAttribute('itemscope');\n      expect(badge).toHaveAttribute('itemtype', 'https://schema.org/Thing');\n      expect(badge).toHaveAttribute('itemprop', 'name');\n    });\n\n    it('supports spellcheck attribute', () => {\n      render(<Badge spellCheck={false}>Spellcheck Badge</Badge>);\n\n      const badge = screen.getByText('Spellcheck Badge');\n      expect(badge).toHaveAttribute('spellcheck', 'false');\n    });\n\n    it('supports autocomplete attribute', () => {\n      render(<Badge autoComplete='off'>Autocomplete Badge</Badge>);\n\n      const badge = screen.getByText('Autocomplete Badge');\n      expect(badge).toHaveAttribute('autocomplete', 'off');\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/badge.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/button.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/card-accessibility-features-core.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/card-accessibility-features.test.tsx","messages":[{"ruleId":"jsx-a11y/aria-proptypes","severity":1,"message":"The value for aria-invalid must be a single token from the following: grammar,false,spelling,true.","line":297,"column":17,"nodeType":"JSXAttribute","endLine":297,"endColumn":45}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @vitest-environment jsdom\n */\n\n/**\n * Card Accessibility Features - Main Tests\n *\n * 主要可访问性测试，包括：\n * - 核心可访问性验证\n * - 基本可访问性测试\n * - 错误处理验证\n *\n * 详细测试请参考：\n * - card-accessibility-features-core.test.tsx - 核心可访问性测试\n */\n\nimport { render, screen } from '@testing-library/react';\nimport { describe, expect, it } from 'vitest';\nimport {\n    Card,\n    CardContent,\n    CardDescription,\n    CardFooter,\n    CardHeader,\n    CardTitle,\n} from '../card';\n\ndescribe('Card Accessibility Features - Main Tests', () => {\n  describe('核心可访问性验证', () => {\n    it('supports semantic HTML structure', () => {\n      render(\n        <Card role='article'>\n          <CardHeader>\n            <CardTitle>Accessible Card</CardTitle>\n            <CardDescription>This card follows accessibility best practices</CardDescription>\n          </CardHeader>\n          <CardContent>\n            <p>Main content goes here</p>\n          </CardContent>\n          <CardFooter>\n            <button type='button'>Action</button>\n          </CardFooter>\n        </Card>\n      );\n\n      const card = screen.getByRole('article');\n      const title = screen.getByText('Accessible Card');\n      const footer = screen.getByRole('button', { name: 'Action' });\n\n      expect(card).toBeInTheDocument();\n      expect(title).toBeInTheDocument();\n      expect(footer).toBeInTheDocument();\n    });\n\n    it('supports ARIA attributes', () => {\n      render(\n        <Card aria-labelledby='card-title' aria-describedby='card-description'>\n          <CardHeader>\n            <CardTitle id='card-title'>Card with ARIA</CardTitle>\n            <CardDescription id='card-description'>Description for screen readers</CardDescription>\n          </CardHeader>\n        </Card>\n      );\n\n      const card = screen.getByLabelText('Card with ARIA');\n      expect(card).toHaveAttribute('aria-describedby', 'card-description');\n    });\n\n    it('maintains focus management', () => {\n      render(\n        <Card>\n          <CardHeader>\n            <CardTitle>Focusable Card</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <button type='button'>Button 1</button>\n            <button type='button'>Button 2</button>\n          </CardContent>\n        </Card>\n      );\n\n      const buttons = screen.getAllByRole('button');\n\n      buttons.forEach(button => {\n        expect(button).toBeVisible();\n      });\n    });\n\n    it('supports keyboard navigation', () => {\n      render(\n        <Card tabIndex={0}>\n          <CardHeader>\n            <CardTitle>Keyboard Accessible Card</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <a href='#'>Link</a>\n            <button type='button'>Button</button>\n          </CardContent>\n        </Card>\n      );\n\n      const card = screen.getByRole('generic');\n      const link = screen.getByRole('link');\n      const button = screen.getByRole('button');\n\n      expect(card).toBeInTheDocument();\n      expect(link).toBeInTheDocument();\n      expect(button).toBeInTheDocument();\n    });\n\n    it('provides proper heading hierarchy', () => {\n      render(\n        <div>\n          <h1>Page Title</h1>\n          <Card>\n            <CardHeader>\n              <CardTitle as='h2'>Card Title</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <h3>Subsection</h3>\n            </CardContent>\n          </Card>\n        </div>\n      );\n\n      const pageTitle = screen.getByRole('heading', { level: 1 });\n      const cardTitle = screen.getByRole('heading', { level: 2 });\n      const subsection = screen.getByRole('heading', { level: 3 });\n\n      expect(pageTitle).toBeInTheDocument();\n      expect(cardTitle).toBeInTheDocument();\n      expect(subsection).toBeInTheDocument();\n    });\n\n    it('supports screen reader announcements', () => {\n      render(\n        <Card aria-live='polite'>\n          <CardHeader>\n            <CardTitle>Live Region Card</CardTitle>\n          </CardHeader>\n        </Card>\n      );\n\n      const card = screen.getByText('Live Region Card').closest('[aria-live=\"polite\"]');\n      expect(card).toBeInTheDocument();\n    });\n\n    it('handles high contrast mode', () => {\n      render(\n        <Card className='high-contrast'>\n          <CardHeader>\n            <CardTitle>High Contrast Card</CardTitle>\n          </CardHeader>\n        </Card>\n      );\n\n      const card = screen.getByText('High Contrast Card').closest('.high-contrast');\n      expect(card).toBeInTheDocument();\n    });\n\n    it('supports reduced motion preferences', () => {\n      render(\n        <Card className='reduce-motion'>\n          <CardHeader>\n            <CardTitle>Motion Reduced Card</CardTitle>\n          </CardHeader>\n        </Card>\n      );\n\n      const card = screen.getByText('Motion Reduced Card').closest('.reduce-motion');\n      expect(card).toBeInTheDocument();\n    });\n\n    it('provides alternative text for images', () => {\n      render(\n        <Card>\n          <CardHeader>\n            <CardTitle>Image Card</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <img src='/profile.jpg' alt='User profile picture' />\n          </CardContent>\n        </Card>\n      );\n\n      const image = screen.getByAltText('User profile picture');\n      expect(image).toBeInTheDocument();\n    });\n\n    it('supports internationalization', () => {\n      render(\n        <Card lang='es' dir='ltr'>\n          <CardHeader>\n            <CardTitle>Tarjeta en Español</CardTitle>\n            <CardDescription>Esta es una descripción en español</CardDescription>\n          </CardHeader>\n        </Card>\n      );\n\n      const card = screen.getByText('Tarjeta en Español').closest('[lang=\"es\"]');\n      expect(card).toHaveAttribute('dir', 'ltr');\n    });\n\n\n\n    it('supports color contrast requirements', () => {\n      render(\n        <Card className='high-contrast-text'>\n          <CardHeader>\n            <CardTitle>High Contrast Text</CardTitle>\n          </CardHeader>\n        </Card>\n      );\n\n      const card = screen.getByText('High Contrast Text').closest('.high-contrast-text');\n      expect(card).toBeInTheDocument();\n    });\n\n    it('provides skip links for complex cards', () => {\n      render(\n        <Card>\n          <a href='#card-content' className='skip-link'>\n            Skip to card content\n          </a>\n          <CardHeader>\n            <CardTitle>Complex Card</CardTitle>\n          </CardHeader>\n          <CardContent id='card-content'>\n            Main content\n          </CardContent>\n        </Card>\n      );\n\n      const skipLink = screen.getByText('Skip to card content');\n      const content = screen.getByText('Main content');\n\n      expect(skipLink).toHaveAttribute('href', '#card-content');\n      expect(content.closest('#card-content')).toBeInTheDocument();\n    });\n\n    it('supports voice control commands', () => {\n      render(\n        <Card>\n          <CardHeader>\n            <CardTitle>Voice Control Card</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <button type='button' aria-label='Edit item'>Edit</button>\n            <button type='button' aria-label='Delete item'>Delete</button>\n          </CardContent>\n        </Card>\n      );\n\n      const editButton = screen.getByLabelText('Edit item');\n      const deleteButton = screen.getByLabelText('Delete item');\n\n      expect(editButton).toBeInTheDocument();\n      expect(deleteButton).toBeInTheDocument();\n    });\n\n    it('provides status updates for dynamic content', () => {\n      render(\n        <Card>\n          <CardHeader>\n            <CardTitle>Status Update Card</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div role='status' aria-live='polite'>\n              Loading complete\n            </div>\n          </CardContent>\n        </Card>\n      );\n\n      const status = screen.getByRole('status');\n      expect(status).toHaveAttribute('aria-live', 'polite');\n      expect(status).toHaveTextContent('Loading complete');\n    });\n  });\n\n  describe('错误处理验证', () => {\n    it('handles missing accessibility attributes gracefully', () => {\n      expect(() => {\n        render(\n          <Card>\n            <CardHeader>\n              <CardTitle>Card without accessibility attributes</CardTitle>\n            </CardHeader>\n          </Card>\n        );\n      }).not.toThrow();\n    });\n\n    it('handles invalid ARIA attributes gracefully', () => {\n      expect(() => {\n        render(\n          <Card aria-invalid='invalid-value'>\n            <CardHeader>\n              <CardTitle>Card with invalid ARIA</CardTitle>\n            </CardHeader>\n          </Card>\n        );\n      }).not.toThrow();\n    });\n\n    it('handles conflicting accessibility attributes gracefully', () => {\n      expect(() => {\n        render(\n          <Card role='button' aria-disabled='true' tabIndex={0}>\n            <CardHeader>\n              <CardTitle>Card with conflicting attributes</CardTitle>\n            </CardHeader>\n          </Card>\n        );\n      }).not.toThrow();\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/card-basic-components.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/card-integration-scenarios.test.tsx","messages":[{"ruleId":"@next/next/no-html-link-for-pages","severity":2,"message":"Do not use an `<a>` element to navigate to `/home/`. Use `<Link />` from `next/link` instead. See: https://nextjs.org/docs/messages/no-html-link-for-pages","line":136,"column":21,"nodeType":"JSXOpeningElement","endLine":136,"endColumn":37},{"ruleId":"@next/next/no-html-link-for-pages","severity":2,"message":"Do not use an `<a>` element to navigate to `/about/`. Use `<Link />` from `next/link` instead. See: https://nextjs.org/docs/messages/no-html-link-for-pages","line":137,"column":21,"nodeType":"JSXOpeningElement","endLine":137,"endColumn":38},{"ruleId":"@next/next/no-html-link-for-pages","severity":2,"message":"Do not use an `<a>` element to navigate to `/contact/`. Use `<Link />` from `next/link` instead. See: https://nextjs.org/docs/messages/no-html-link-for-pages","line":138,"column":21,"nodeType":"JSXOpeningElement","endLine":138,"endColumn":40}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @vitest-environment jsdom\n */\n\n/**\n * Card Integration Scenarios Tests\n *\n * Tests for Card component integration scenarios including:\n * - Form elements integration\n * - Other UI components integration\n * - Responsive design support\n * - Complex interaction patterns\n * - Real-world usage scenarios\n */\n\nimport { render, screen } from '@testing-library/react';\nimport React from 'react';\nimport { describe, expect, it } from 'vitest';\nimport {\n  Card,\n  CardContent,\n  CardDescription,\n  CardFooter,\n  CardHeader,\n  CardTitle,\n} from '../card';\n\ndescribe('Card Integration Scenarios Tests', () => {\n  describe('Component Integration', () => {\n    it('works with form elements', () => {\n      render(\n        <Card>\n          <CardHeader>\n            <CardTitle>Form Card</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <form>\n              <label htmlFor='name'>Name:</label>\n              <input id='name' type='text' />\n              <label htmlFor='email'>Email:</label>\n              <input id='email' type='email' />\n            </form>\n          </CardContent>\n          <CardFooter>\n            <button type='submit'>Submit</button>\n          </CardFooter>\n        </Card>\n      );\n\n      expect(screen.getByLabelText('Name:')).toBeInTheDocument();\n      expect(screen.getByLabelText('Email:')).toBeInTheDocument();\n      expect(screen.getByRole('button', { name: 'Submit' })).toBeInTheDocument();\n    });\n\n    it('integrates with other UI components', () => {\n      render(\n        <Card>\n          <CardHeader>\n            <CardTitle>Component Integration</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className='space-y-4'>\n              <div className='flex items-center space-x-2'>\n                <input type='checkbox' id='option1' />\n                <label htmlFor='option1'>Option 1</label>\n              </div>\n              <div className='flex items-center space-x-2'>\n                <input type='radio' id='radio1' name='group' />\n                <label htmlFor='radio1'>Radio 1</label>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n      );\n\n      expect(screen.getByLabelText('Option 1')).toBeInTheDocument();\n      expect(screen.getByLabelText('Radio 1')).toBeInTheDocument();\n    });\n\n    it('supports responsive design', () => {\n      render(\n        <Card className='w-full max-w-md mx-auto'>\n          <CardHeader className='text-center sm:text-left'>\n            <CardTitle className='text-lg sm:text-xl'>Responsive Card</CardTitle>\n          </CardHeader>\n          <CardContent className='px-4 sm:px-6'>\n            <p className='text-sm sm:text-base'>Responsive content</p>\n          </CardContent>\n        </Card>\n      );\n\n      const card = screen.getByText('Responsive Card').closest('.w-full');\n      const title = screen.getByText('Responsive Card');\n      const content = screen.getByText('Responsive content');\n\n      expect(card).toHaveClass('max-w-md', 'mx-auto');\n      expect(title).toHaveClass('text-lg', 'sm:text-xl');\n      expect(content).toHaveClass('text-sm', 'sm:text-base');\n    });\n\n    it('works with data visualization components', () => {\n      render(\n        <Card>\n          <CardHeader>\n            <CardTitle>Chart Card</CardTitle>\n            <CardDescription>Data visualization example</CardDescription>\n          </CardHeader>\n          <CardContent>\n            <div className='chart-container'>\n              <svg width='200' height='100' data-testid='chart'>\n                <rect x='10' y='10' width='50' height='80' fill='blue' />\n                <rect x='70' y='30' width='50' height='60' fill='red' />\n                <rect x='130' y='20' width='50' height='70' fill='green' />\n              </svg>\n            </div>\n          </CardContent>\n          <CardFooter>\n            <button>Export Chart</button>\n          </CardFooter>\n        </Card>\n      );\n\n      expect(screen.getByTestId('chart')).toBeInTheDocument();\n      expect(screen.getByText('Export Chart')).toBeInTheDocument();\n    });\n\n    it('integrates with navigation components', () => {\n      render(\n        <Card>\n          <CardHeader>\n            <CardTitle>Navigation Card</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <nav>\n              <ul>\n                <li><a href='/home'>Home</a></li>\n                <li><a href='/about'>About</a></li>\n                <li><a href='/contact'>Contact</a></li>\n              </ul>\n            </nav>\n          </CardContent>\n        </Card>\n      );\n\n      expect(screen.getByRole('navigation')).toBeInTheDocument();\n      expect(screen.getByRole('link', { name: 'Home' })).toBeInTheDocument();\n      expect(screen.getByRole('link', { name: 'About' })).toBeInTheDocument();\n      expect(screen.getByRole('link', { name: 'Contact' })).toBeInTheDocument();\n    });\n\n    it('supports media content integration', () => {\n      render(\n        <Card>\n          <CardHeader>\n            <CardTitle>Media Card</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className='media-container'>\n              <video controls width='300' data-testid='video'>\n                <source src='/sample-video.mp4' type='video/mp4' />\n                Your browser does not support the video tag.\n              </video>\n              <audio controls data-testid='audio'>\n                <source src='/sample-audio.mp3' type='audio/mpeg' />\n                Your browser does not support the audio element.\n              </audio>\n            </div>\n          </CardContent>\n        </Card>\n      );\n\n      expect(screen.getByTestId('video')).toBeInTheDocument();\n      expect(screen.getByTestId('audio')).toBeInTheDocument();\n    });\n\n    it('works with table components', () => {\n      render(\n        <Card>\n          <CardHeader>\n            <CardTitle>Data Table Card</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <table>\n              <thead>\n                <tr>\n                  <th>Name</th>\n                  <th>Age</th>\n                  <th>City</th>\n                </tr>\n              </thead>\n              <tbody>\n                <tr>\n                  <td>John Doe</td>\n                  <td>30</td>\n                  <td>New York</td>\n                </tr>\n                <tr>\n                  <td>Jane Smith</td>\n                  <td>25</td>\n                  <td>Los Angeles</td>\n                </tr>\n              </tbody>\n            </table>\n          </CardContent>\n        </Card>\n      );\n\n      expect(screen.getByRole('table')).toBeInTheDocument();\n      expect(screen.getByRole('columnheader', { name: 'Name' })).toBeInTheDocument();\n      expect(screen.getByRole('cell', { name: 'John Doe' })).toBeInTheDocument();\n    });\n\n    it('integrates with modal and dialog components', () => {\n      render(\n        <div>\n          <Card>\n            <CardHeader>\n              <CardTitle>Modal Trigger Card</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <button data-modal-target='example-modal'>Open Modal</button>\n            </CardContent>\n          </Card>\n          <div id='example-modal' role='dialog' aria-hidden='true'>\n            <Card>\n              <CardHeader>\n                <CardTitle>Modal Card</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <p>This card is inside a modal</p>\n              </CardContent>\n              <CardFooter>\n                <button>Close</button>\n              </CardFooter>\n            </Card>\n          </div>\n        </div>\n      );\n\n      expect(screen.getByText('Open Modal')).toBeInTheDocument();\n      expect(screen.getByRole('dialog')).toBeInTheDocument();\n      expect(screen.getByText('Modal Card')).toBeInTheDocument();\n    });\n\n    it('supports accordion-style interactions', () => {\n      const AccordionCard = () => {\n        const [isExpanded, setIsExpanded] = React.useState(false);\n\n        return (\n          <Card>\n            <CardHeader>\n              <CardTitle>\n                <button\n                  _onClick={() => setIsExpanded(!isExpanded)}\n                  aria-expanded={isExpanded}\n                >\n                  Expandable Card {isExpanded ? '▼' : '▶'}\n                </button>\n              </CardTitle>\n            </CardHeader>\n            {isExpanded && (\n              <CardContent>\n                <p>This content is conditionally rendered</p>\n              </CardContent>\n            )}\n          </Card>\n        );\n      };\n\n      render(<AccordionCard />);\n\n      const toggleButton = screen.getByRole('button');\n      expect(toggleButton).toHaveAttribute('aria-expanded', 'false');\n      expect(screen.queryByText('This content is conditionally rendered')).not.toBeInTheDocument();\n    });\n\n    it('works with drag and drop interfaces', () => {\n      render(\n        <Card draggable data-testid='draggable-card'>\n          <CardHeader>\n            <CardTitle>Draggable Card</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <p>This card can be dragged and dropped</p>\n            <div className='drag-handle' data-testid='drag-handle'>\n              ⋮⋮\n            </div>\n          </CardContent>\n        </Card>\n      );\n\n      const card = screen.getByTestId('draggable-card');\n      const dragHandle = screen.getByTestId('drag-handle');\n\n      expect(card).toHaveAttribute('draggable', 'true');\n      expect(dragHandle).toBeInTheDocument();\n    });\n\n    it('integrates with search and filter components', () => {\n      render(\n        <Card>\n          <CardHeader>\n            <CardTitle>Search Results</CardTitle>\n            <div className='search-controls'>\n              <input type='search' placeholder='Search...' />\n              <select>\n                <option value='all'>All Categories</option>\n                <option value='tech'>Technology</option>\n                <option value='design'>Design</option>\n              </select>\n            </div>\n          </CardHeader>\n          <CardContent>\n            <div className='results'>\n              <p>Search result 1</p>\n              <p>Search result 2</p>\n            </div>\n          </CardContent>\n        </Card>\n      );\n\n      expect(screen.getByPlaceholderText('Search...')).toBeInTheDocument();\n      expect(screen.getByDisplayValue('All Categories')).toBeInTheDocument();\n      expect(screen.getByText('Search result 1')).toBeInTheDocument();\n    });\n\n    it('supports notification and alert patterns', () => {\n      render(\n        <Card className='alert-card' role='alert'>\n          <CardHeader>\n            <CardTitle>⚠️ Warning</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <p>This is an important notification</p>\n          </CardContent>\n          <CardFooter>\n            <button>Dismiss</button>\n            <button>Learn More</button>\n          </CardFooter>\n        </Card>\n      );\n\n      const alertCard = screen.getByRole('alert');\n      expect(alertCard).toHaveClass('alert-card');\n      expect(screen.getByText('⚠️ Warning')).toBeInTheDocument();\n      expect(screen.getByText('Dismiss')).toBeInTheDocument();\n    });\n\n    it('works with loading and skeleton states', () => {\n      const LoadingCard = ({ isLoading }: { isLoading: boolean }) => (\n        <Card>\n          <CardHeader>\n            <CardTitle>\n              {isLoading ? (\n                <div className='skeleton-title' data-testid='skeleton'>Loading...</div>\n              ) : (\n                'Loaded Content'\n              )}\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            {isLoading ? (\n              <div className='skeleton-content' data-testid='skeleton-content'>\n                <div className='skeleton-line'></div>\n                <div className='skeleton-line'></div>\n              </div>\n            ) : (\n              <p>Actual content here</p>\n            )}\n          </CardContent>\n        </Card>\n      );\n\n      const { rerender } = render(<LoadingCard isLoading={true} />);\n\n      expect(screen.getByTestId('skeleton')).toBeInTheDocument();\n      expect(screen.getByTestId('skeleton-content')).toBeInTheDocument();\n\n      rerender(<LoadingCard isLoading={false} />);\n\n      expect(screen.getByText('Loaded Content')).toBeInTheDocument();\n      expect(screen.getByText('Actual content here')).toBeInTheDocument();\n    });\n\n    it('integrates with pagination components', () => {\n      render(\n        <Card>\n          <CardHeader>\n            <CardTitle>Paginated Content</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className='content-list'>\n              <p>Item 1</p>\n              <p>Item 2</p>\n              <p>Item 3</p>\n            </div>\n          </CardContent>\n          <CardFooter>\n            <nav aria-label='Pagination'>\n              <button disabled>Previous</button>\n              <span>Page 1 of 5</span>\n              <button>Next</button>\n            </nav>\n          </CardFooter>\n        </Card>\n      );\n\n      expect(screen.getByLabelText('Pagination')).toBeInTheDocument();\n      expect(screen.getByText('Previous')).toBeDisabled();\n      expect(screen.getByText('Next')).toBeEnabled();\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/card-structure-accessibility-core.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/card-structure-accessibility.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/card-structure-components.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/card.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/dropdown-menu-accessibility.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/dropdown-menu-advanced.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/dropdown-menu-basic.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/dropdown-menu-complex.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/dropdown-menu-layout.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/dropdown-menu-radio.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/input-basic.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/input-file-edge-cases.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/input-props-events.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/input-states-accessibility.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/input.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/label-accessibility.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/label-basic.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/label-component-composition.test.tsx","messages":[{"ruleId":"react/display-name","severity":2,"message":"Component definition is missing display name","line":270,"column":28,"nodeType":"CallExpression","messageId":"noDisplayName","endLine":279,"endColumn":9}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @vitest-environment jsdom\n */\n\n/**\n * Label Component Composition Tests\n *\n * Tests for Label component composition with other UI components including:\n * - Integration with other UI components\n * - Modal/dialog contexts\n * - Nested component structures\n * - Conditional rendering scenarios\n * - Dynamic content handling\n */\n\nimport { render, screen } from '@testing-library/react';\nimport userEvent from '@testing-library/user-event';\nimport React from 'react';\nimport { beforeEach, describe, expect, it } from 'vitest';\nimport { Label } from '../label';\n\ndescribe('Label Component Composition Tests', () => {\n  let user: ReturnType<typeof userEvent.setup>;\n\n  beforeEach(() => {\n    user = userEvent.setup();\n  });\n\n  describe('Component Composition', () => {\n    it('works with other UI components', () => {\n      const Card = ({ children }: { children: React.ReactNode }) => (\n        <div className='card'>{children}</div>\n      );\n\n      const Button = ({ children, ...props }: React.ButtonHTMLAttributes<HTMLButtonElement>) => (\n        <button className='btn' {...props}>{children}</button>\n      );\n\n      render(\n        <Card>\n          <form>\n            <div>\n              <Label htmlFor='card-input'>Card Input</Label>\n              <input id='card-input' type='text' />\n            </div>\n            <Button type='submit'>Submit</Button>\n          </form>\n        </Card>\n      );\n\n      expect(screen.getByText('Card Input')).toBeInTheDocument();\n      expect(screen.getByText('Submit')).toHaveClass('btn');\n    });\n\n    it('works in modal/dialog contexts', () => {\n      const Modal = ({ children }: { children: React.ReactNode }) => (\n        <div role='dialog' aria-modal='true' className='modal'>\n          {children}\n        </div>\n      );\n\n      render(\n        <Modal>\n          <form>\n            <Label htmlFor='modal-input'>Modal Input</Label>\n            <input id='modal-input' type='text' />\n          </form>\n        </Modal>\n      );\n\n      const dialog = screen.getByRole('dialog');\n      const label = screen.getByText('Modal Input');\n\n      expect(dialog).toContainElement(label);\n    });\n\n    it('handles nested component structures', () => {\n      const FieldGroup = ({ children }: { children: React.ReactNode }) => (\n        <div className='field-group'>{children}</div>\n      );\n\n      const FieldWrapper = ({ children }: { children: React.ReactNode }) => (\n        <div className='field-wrapper'>{children}</div>\n      );\n\n      render(\n        <FieldGroup>\n          <FieldWrapper>\n            <Label htmlFor='nested-input'>Nested Input</Label>\n            <input id='nested-input' type='text' />\n          </FieldWrapper>\n        </FieldGroup>\n      );\n\n      const label = screen.getByText('Nested Input');\n      expect(label.closest('.field-group')).toBeInTheDocument();\n      expect(label.closest('.field-wrapper')).toBeInTheDocument();\n    });\n\n    it('works with conditional rendering', () => {\n      const ConditionalForm = ({ showEmail }: { showEmail: boolean }) => (\n        <form>\n          <div>\n            <Label htmlFor='always-name'>Name</Label>\n            <input id='always-name' type='text' />\n          </div>\n          {showEmail && (\n            <div>\n              <Label htmlFor='conditional-email'>Email</Label>\n              <input id='conditional-email' type='email' />\n            </div>\n          )}\n        </form>\n      );\n\n      const { rerender } = render(<ConditionalForm showEmail={false} />);\n\n      expect(screen.getByText('Name')).toBeInTheDocument();\n      expect(screen.queryByText('Email')).not.toBeInTheDocument();\n\n      rerender(<ConditionalForm showEmail={true} />);\n\n      expect(screen.getByText('Name')).toBeInTheDocument();\n      expect(screen.getByText('Email')).toBeInTheDocument();\n    });\n\n    it('handles dynamic label content', () => {\n      const DynamicLabel = ({ count }: { count: number }) => (\n        <Label htmlFor='dynamic-input'>\n          Items ({count})\n        </Label>\n      );\n\n      const { rerender } = render(\n        <div>\n          <DynamicLabel count={0} />\n          <input id='dynamic-input' type='number' />\n        </div>\n      );\n\n      expect(screen.getByText('Items (0)')).toBeInTheDocument();\n\n      rerender(\n        <div>\n          <DynamicLabel count={5} />\n          <input id='dynamic-input' type='number' />\n        </div>\n      );\n\n      expect(screen.getByText('Items (5)')).toBeInTheDocument();\n    });\n\n    it('works with complex form layouts', () => {\n      const FormSection = ({ title, children }: { title: string; children: React.ReactNode }) => (\n        <section>\n          <h3>{title}</h3>\n          {children}\n        </section>\n      );\n\n      const FormRow = ({ children }: { children: React.ReactNode }) => (\n        <div className='form-row'>{children}</div>\n      );\n\n      const FormColumn = ({ children }: { children: React.ReactNode }) => (\n        <div className='form-column'>{children}</div>\n      );\n\n      render(\n        <form>\n          <FormSection title='Personal Information'>\n            <FormRow>\n              <FormColumn>\n                <Label htmlFor='first-name'>First Name</Label>\n                <input id='first-name' type='text' />\n              </FormColumn>\n              <FormColumn>\n                <Label htmlFor='last-name'>Last Name</Label>\n                <input id='last-name' type='text' />\n              </FormColumn>\n            </FormRow>\n          </FormSection>\n          <FormSection title='Contact Information'>\n            <FormRow>\n              <FormColumn>\n                <Label htmlFor='email'>Email</Label>\n                <input id='email' type='email' />\n              </FormColumn>\n              <FormColumn>\n                <Label htmlFor='phone'>Phone</Label>\n                <input id='phone' type='tel' />\n              </FormColumn>\n            </FormRow>\n          </FormSection>\n        </form>\n      );\n\n      expect(screen.getByText('Personal Information')).toBeInTheDocument();\n      expect(screen.getByText('Contact Information')).toBeInTheDocument();\n      expect(screen.getByLabelText('First Name')).toBeInTheDocument();\n      expect(screen.getByLabelText('Last Name')).toBeInTheDocument();\n      expect(screen.getByLabelText('Email')).toBeInTheDocument();\n      expect(screen.getByLabelText('Phone')).toBeInTheDocument();\n    });\n\n    it('works with custom form components', async () => {\n      const CustomFormField = ({\n        id,\n        label,\n        type = 'text'\n      }: {\n        id: string;\n        label: string;\n        type?: string;\n      }) => (\n        <div className='form-field'>\n          <Label htmlFor={id} className='form-label'>\n            {label}\n          </Label>\n          <input id={id} type={type} className='form-input' />\n        </div>\n      );\n\n      render(\n        <form>\n          <CustomFormField id='custom1' label='Custom Field 1' />\n          <CustomFormField id='custom2' label='Custom Field 2' type='email' />\n        </form>\n      );\n\n      const label1 = screen.getByText('Custom Field 1');\n      const label2 = screen.getByText('Custom Field 2');\n\n      expect(label1).toHaveClass('form-label');\n      expect(label2).toHaveClass('form-label');\n\n      await user.click(label1);\n      expect(screen.getByDisplayValue('')).toHaveFocus();\n    });\n\n    it('handles component composition with styling', () => {\n      const StyledFormGroup = ({ children }: { children: React.ReactNode }) => (\n        <div className='styled-form-group'>{children}</div>\n      );\n\n      render(\n        <form>\n          <StyledFormGroup>\n            <Label htmlFor='styled-input' className='styled-label'>\n              Styled Input\n            </Label>\n            <input id='styled-input' type='text' className='styled-input' />\n          </StyledFormGroup>\n        </form>\n      );\n\n      const label = screen.getByText('Styled Input');\n      expect(label).toHaveClass('styled-label');\n      expect(label.closest('.styled-form-group')).toBeInTheDocument();\n    });\n\n    it('works with component libraries integration', () => {\n      // Simulate integration with component libraries\n      const LibraryCard = ({ children }: { children: React.ReactNode }) => (\n        <div className='lib-card' data-testid='library-card'>\n          {children}\n        </div>\n      );\n\n      const LibraryInput = React.forwardRef<\n        HTMLInputElement,\n        React.InputHTMLAttributes<HTMLInputElement>\n      >(({ className, ...props }, ref) => (\n        <input\n          ref={ref}\n          className={`lib-input ${className || ''}`}\n          {...props}\n        />\n      ));\n\n      render(\n        <LibraryCard>\n          <form>\n            <div>\n              <Label htmlFor='lib-input'>Library Input</Label>\n              <LibraryInput id='lib-input' type='text' />\n            </div>\n          </form>\n        </LibraryCard>\n      );\n\n      const card = screen.getByTestId('library-card');\n      const label = screen.getByText('Library Input');\n      const input = screen.getByLabelText('Library Input');\n\n      expect(card).toContainElement(label);\n      expect(input).toHaveClass('lib-input');\n    });\n\n    it('handles portal/teleport scenarios', () => {\n      // Simulate portal rendering (like tooltips, dropdowns)\n      const PortalContent = ({ children }: { children: React.ReactNode }) => (\n        <div id='portal-root' data-testid='portal-content'>\n          {children}\n        </div>\n      );\n\n      render(\n        <div>\n          <form>\n            <Label htmlFor='portal-trigger'>Portal Trigger</Label>\n            <input id='portal-trigger' type='text' />\n          </form>\n          <PortalContent>\n            <div>Portal content with label reference</div>\n          </PortalContent>\n        </div>\n      );\n\n      const label = screen.getByText('Portal Trigger');\n      const input = screen.getByLabelText('Portal Trigger');\n      const portalContent = screen.getByTestId('portal-content');\n\n      expect(label).toBeInTheDocument();\n      expect(input).toBeInTheDocument();\n      expect(portalContent).toBeInTheDocument();\n    });\n\n    it('works with error boundary contexts', () => {\n      const ErrorBoundary = ({ children }: { children: React.ReactNode }) => {\n        try {\n          return <div className='error-boundary'>{children}</div>;\n        } catch {\n          return <div>Error occurred</div>;\n        }\n      };\n\n      render(\n        <ErrorBoundary>\n          <form>\n            <Label htmlFor='error-boundary-input'>Error Boundary Input</Label>\n            <input id='error-boundary-input' type='text' />\n          </form>\n        </ErrorBoundary>\n      );\n\n      const label = screen.getByText('Error Boundary Input');\n      expect(label.closest('.error-boundary')).toBeInTheDocument();\n    });\n\n    it('handles theme provider contexts', () => {\n      const ThemeProvider = ({ \n        theme, \n        children \n      }: { \n        theme: string; \n        children: React.ReactNode;\n      }) => (\n        <div className={`theme-${theme}`} data-theme={theme}>\n          {children}\n        </div>\n      );\n\n      render(\n        <ThemeProvider theme='dark'>\n          <form>\n            <Label htmlFor='themed-input'>Themed Input</Label>\n            <input id='themed-input' type='text' />\n          </form>\n        </ThemeProvider>\n      );\n\n      const label = screen.getByText('Themed Input');\n      const themeContainer = label.closest('[data-theme]');\n      \n      expect(themeContainer).toHaveAttribute('data-theme', 'dark');\n      expect(themeContainer).toHaveClass('theme-dark');\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/label-edge-cases-basic.test.tsx","messages":[{"ruleId":"no-constant-binary-expression","severity":2,"message":"Unexpected constant truthiness on the left-hand side of a `&&` expression.","line":132,"column":22,"nodeType":"Literal","messageId":"constantShortCircuit","endLine":132,"endColumn":26},{"ruleId":"no-unused-vars","severity":2,"message":"'ErrorComponent' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":284,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":284,"endColumn":27,"suggestions":[{"messageId":"removeVar","data":{"varName":"ErrorComponent"},"fix":{"range":[7992,8070],"text":""},"desc":"Remove unused variable 'ErrorComponent'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ErrorComponent' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":284,"column":13,"nodeType":null,"messageId":"unusedVar","endLine":284,"endColumn":27}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @vitest-environment jsdom\n */\n\n/**\n * Label Edge Cases - Basic Tests\n *\n * 专门测试基本边缘情况，包括：\n * - 空内容处理\n * - 特殊字符处理\n * - 内容类型处理\n * - 性能测试\n */\n\nimport { render, screen } from '@testing-library/react';\nimport userEvent from '@testing-library/user-event';\nimport React from 'react';\nimport { beforeEach, describe, expect, it } from 'vitest';\nimport { Label } from '../label';\n\ndescribe('Label Edge Cases - Basic Tests', () => {\n  let user: ReturnType<typeof userEvent.setup>;\n\n  beforeEach(() => {\n    user = userEvent.setup();\n  });\n\n  describe('空内容处理', () => {\n    it('renders empty label', () => {\n      render(<Label data-testid='empty-label'></Label>);\n\n      const label = screen.getByTestId('empty-label');\n      expect(label).toBeInTheDocument();\n      expect(label).toBeEmptyDOMElement();\n    });\n\n    it('handles zero as text content', () => {\n      render(<Label data-testid='zero-content'>{0}</Label>);\n\n      const label = screen.getByTestId('zero-content');\n      expect(label).toHaveTextContent('0');\n    });\n\n    it('handles false as text content', () => {\n      render(<Label data-testid='false-content'>{false}</Label>);\n\n      const label = screen.getByTestId('false-content');\n      expect(label).toBeEmptyDOMElement();\n    });\n\n    it('handles null as text content', () => {\n      render(<Label data-testid='null-content'>{null}</Label>);\n\n      const label = screen.getByTestId('null-content');\n      expect(label).toBeEmptyDOMElement();\n    });\n\n    it('handles undefined as text content', () => {\n      render(<Label data-testid='undefined-content'>{undefined}</Label>);\n\n      const label = screen.getByTestId('undefined-content');\n      expect(label).toBeEmptyDOMElement();\n    });\n\n    it('handles empty string as text content', () => {\n      render(<Label data-testid='empty-string'>{''}  </Label>);\n\n      const label = screen.getByTestId('empty-string');\n      expect(label).toHaveTextContent('  ');\n    });\n\n    it('handles whitespace-only content', () => {\n      render(<Label data-testid='whitespace'>   </Label>);\n\n      const label = screen.getByTestId('whitespace');\n      expect(label).toHaveTextContent('   ');\n    });\n  });\n\n  describe('特殊字符处理', () => {\n    it('handles very long text content', () => {\n      const longText = 'A'.repeat(1000);\n      render(<Label data-testid='long-text'>{longText}</Label>);\n\n      const label = screen.getByTestId('long-text');\n      expect(label).toHaveTextContent(longText);\n    });\n\n    it('handles special characters and unicode', () => {\n      const specialText = '🚀 Special chars: @#$%^&*()_+ 中文 العربية';\n      render(<Label>{specialText}</Label>);\n\n      const label = screen.getByText(specialText);\n      expect(label).toHaveTextContent(specialText);\n    });\n\n    it('handles newlines and tabs in content', () => {\n      render(<Label data-testid='newlines'>{'Line 1\\nLine 2\\tTabbed'}</Label>);\n\n      const label = screen.getByTestId('newlines');\n      expect(label).toHaveTextContent('Line 1\\nLine 2\\tTabbed');\n    });\n\n    it('handles HTML entities in content', () => {\n      render(<Label data-testid='entities'>&lt;div&gt; &amp; &quot;quotes&quot;</Label>);\n\n      const label = screen.getByTestId('entities');\n      expect(label).toHaveTextContent('<div> & \"quotes\"');\n    });\n  });\n\n  describe('内容类型处理', () => {\n    it('handles null and undefined props gracefully', () => {\n      render(\n        <Label\n          className={undefined}\n          style={null as React.CSSProperties | null}\n          _onClick={undefined}\n          data-testid='null-props'\n        >\n          Content\n        </Label>\n      );\n\n      const label = screen.getByTestId('null-props');\n      expect(label).toBeInTheDocument();\n    });\n\n    it('handles mixed content types', () => {\n      render(\n        <Label data-testid='mixed-content'>\n          Text {42} {true && 'conditional'} <span>JSX</span>\n        </Label>\n      );\n\n      const label = screen.getByTestId('mixed-content');\n      expect(label).toHaveTextContent('Text 42 conditional JSX');\n    });\n\n    it('handles deeply nested content', () => {\n      render(\n        <Label data-testid='nested-content'>\n          <div>\n            <span>\n              <strong>\n                Deeply nested\n              </strong>\n            </span>\n          </div>\n        </Label>\n      );\n\n      const label = screen.getByTestId('nested-content');\n      expect(label).toHaveTextContent('Deeply nested');\n    });\n\n    it('handles conditional rendering', () => {\n      const ConditionalLabel = ({ show }: { show: boolean }) => (\n        <Label data-testid='conditional'>\n          {show ? 'Visible' : null}\n        </Label>\n      );\n\n      const { rerender } = render(<ConditionalLabel show={false} />);\n      let label = screen.getByTestId('conditional');\n      expect(label).toBeEmptyDOMElement();\n\n      rerender(<ConditionalLabel show={true} />);\n      label = screen.getByTestId('conditional');\n      expect(label).toHaveTextContent('Visible');\n    });\n\n    it('handles array of elements', () => {\n      const items = ['Item 1', 'Item 2', 'Item 3'];\n      render(\n        <Label data-testid='array-content'>\n          {items.map((item, index) => (\n            <span key={index}>{item} </span>\n          ))}\n        </Label>\n      );\n\n      const label = screen.getByTestId('array-content');\n      expect(label).toHaveTextContent('Item 1 Item 2 Item 3 ');\n    });\n\n    it('handles fragments', () => {\n      render(\n        <Label data-testid='fragment-content'>\n          <>\n            <span>Fragment 1</span>\n            <span>Fragment 2</span>\n          </>\n        </Label>\n      );\n\n      const label = screen.getByTestId('fragment-content');\n      expect(label).toHaveTextContent('Fragment 1Fragment 2');\n    });\n  });\n\n  describe('性能测试', () => {\n    it('handles rapid state changes', async () => {\n      const StateChangingLabel = () => {\n        const [count, setCount] = React.useState(0);\n\n        return (\n          <Label\n            data-testid='state-changing'\n            _onClick={() => setCount(c => c + 1)}\n          >\n            Count: {count}\n          </Label>\n        );\n      };\n\n      render(<StateChangingLabel />);\n      const label = screen.getByTestId('state-changing');\n\n      // Rapidly change state\n      for (let i = 0; i < 10; i++) {\n        await user.click(label);\n      }\n\n      expect(label).toHaveTextContent('Count: 10');\n    });\n\n    it('handles memory leaks with event listeners', () => {\n      const MemoryLeakLabel = () => {\n        React.useEffect(() => {\n          const handleResize = () => {\n            // Simulate event listener\n          };\n\n          window.addEventListener('resize', handleResize);\n\n          return () => {\n            window.removeEventListener('resize', handleResize);\n          };\n        }, []);\n\n        return <Label data-testid='memory-leak'>Memory test</Label>;\n      };\n\n      const { unmount } = render(<MemoryLeakLabel />);\n\n      const label = screen.getByTestId('memory-leak');\n      expect(label).toBeInTheDocument();\n\n      // Unmount should clean up event listeners\n      unmount();\n    });\n\n    it('handles performance with many re-renders', () => {\n      const PerformanceLabel = ({ count }: { count: number }) => (\n        <Label data-testid='performance'>\n          Render count: {count}\n        </Label>\n      );\n\n      const { rerender } = render(<PerformanceLabel count={0} />);\n\n      // Simulate many re-renders\n      for (let i = 1; i <= 100; i++) {\n        rerender(<PerformanceLabel count={i} />);\n      }\n\n      const label = screen.getByTestId('performance');\n      expect(label).toHaveTextContent('Render count: 100');\n    });\n\n    it('handles portal content', () => {\n      render(\n        <Label data-testid='portal-content'>\n          Regular content\n        </Label>\n      );\n\n      const label = screen.getByTestId('portal-content');\n      expect(label).toHaveTextContent('Regular content');\n    });\n\n    it('handles error boundaries gracefully', () => {\n      const ErrorComponent = () => {\n        throw new Error('Test error');\n      };\n\n      // This would normally be wrapped in an error boundary in a real app\n      render(\n        <Label data-testid='error-boundary'>\n          Safe content\n        </Label>\n      );\n\n      const label = screen.getByTestId('error-boundary');\n      expect(label).toHaveTextContent('Safe content');\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/label-edge-cases.test.tsx","messages":[{"ruleId":"no-constant-binary-expression","severity":2,"message":"Unexpected constant truthiness on the left-hand side of a `&&` expression.","line":155,"column":22,"nodeType":"Literal","messageId":"constantShortCircuit","endLine":155,"endColumn":26}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @vitest-environment jsdom\n */\n\n/**\n * Label Edge Cases - Main Tests\n *\n * 主要边缘情况集成测试，包括：\n * - 核心边缘情况验证\n * - 基本边缘情况测试\n * - 错误处理验证\n *\n * 详细测试请参考：\n * - label-edge-cases-basic.test.tsx - 基本边缘情况测试\n */\n\nimport { render, screen } from '@testing-library/react';\nimport userEvent from '@testing-library/user-event';\nimport React from 'react';\nimport { beforeEach, describe, expect, it } from 'vitest';\nimport { Label } from '../label';\n\ndescribe('Label Edge Cases - Main Tests', () => {\n  let user: ReturnType<typeof userEvent.setup>;\n\n  beforeEach(() => {\n    user = userEvent.setup();\n  });\n\n  describe('核心边缘情况验证', () => {\n    it('renders empty label', () => {\n      render(<Label data-testid='empty-label'></Label>);\n\n      const label = screen.getByTestId('empty-label');\n      expect(label).toBeInTheDocument();\n      expect(label).toBeEmptyDOMElement();\n    });\n\n    it('handles very long text content', () => {\n      const longText = 'A'.repeat(1000);\n      render(<Label data-testid='long-text'>{longText}</Label>);\n\n      const label = screen.getByTestId('long-text');\n      expect(label).toHaveTextContent(longText);\n    });\n\n    it('handles special characters and unicode', () => {\n      const specialText = '🚀 Special chars: @#$%^&*()_+ 中文 العربية';\n      render(<Label>{specialText}</Label>);\n\n      const label = screen.getByText(specialText);\n      expect(label).toHaveTextContent(specialText);\n    });\n\n    it('handles rapid state changes', async () => {\n      const StateChangingLabel = () => {\n        const [count, setCount] = React.useState(0);\n\n        return (\n          <Label\n            data-testid='state-changing'\n            _onClick={() => setCount(c => c + 1)}\n          >\n            Count: {count}\n          </Label>\n        );\n      };\n\n      render(<StateChangingLabel />);\n      const label = screen.getByTestId('state-changing');\n\n      // Rapidly change state\n      for (let i = 0; i < 10; i++) {\n        await user.click(label);\n      }\n\n      expect(label).toHaveTextContent('Count: 10');\n    });\n\n    it('handles null and undefined props gracefully', () => {\n      render(\n        <Label\n          className={undefined}\n          style={null as React.CSSProperties | null}\n          _onClick={undefined}\n          data-testid='null-props'\n        >\n          Content\n        </Label>\n      );\n\n      const label = screen.getByTestId('null-props');\n      expect(label).toBeInTheDocument();\n    });\n\n    it('handles zero as text content', () => {\n      render(<Label data-testid='zero-content'>{0}</Label>);\n\n      const label = screen.getByTestId('zero-content');\n      expect(label).toHaveTextContent('0');\n    });\n\n    it('handles false as text content', () => {\n      render(<Label data-testid='false-content'>{false}</Label>);\n\n      const label = screen.getByTestId('false-content');\n      expect(label).toBeEmptyDOMElement();\n    });\n\n    it('handles null as text content', () => {\n      render(<Label data-testid='null-content'>{null}</Label>);\n\n      const label = screen.getByTestId('null-content');\n      expect(label).toBeEmptyDOMElement();\n    });\n\n    it('handles undefined as text content', () => {\n      render(<Label data-testid='undefined-content'>{undefined}</Label>);\n\n      const label = screen.getByTestId('undefined-content');\n      expect(label).toBeEmptyDOMElement();\n    });\n\n    it('handles empty string as text content', () => {\n      render(<Label data-testid='empty-string'>{''}  </Label>);\n\n      const label = screen.getByTestId('empty-string');\n      expect(label).toHaveTextContent('  ');\n    });\n\n    it('handles whitespace-only content', () => {\n      render(<Label data-testid='whitespace'>   </Label>);\n\n      const label = screen.getByTestId('whitespace');\n      expect(label).toHaveTextContent('   ');\n    });\n\n    it('handles newlines and tabs in content', () => {\n      render(<Label data-testid='newlines'>{'Line 1\\nLine 2\\tTabbed'}</Label>);\n\n      const label = screen.getByTestId('newlines');\n      expect(label).toHaveTextContent('Line 1\\nLine 2\\tTabbed');\n    });\n\n    it('handles HTML entities in content', () => {\n      render(<Label data-testid='entities'>&lt;div&gt; &amp; &quot;quotes&quot;</Label>);\n\n      const label = screen.getByTestId('entities');\n      expect(label).toHaveTextContent('<div> & \"quotes\"');\n    });\n\n    it('handles mixed content types', () => {\n      render(\n        <Label data-testid='mixed-content'>\n          Text {42} {true && 'conditional'} <span>JSX</span>\n        </Label>\n      );\n\n      const label = screen.getByTestId('mixed-content');\n      expect(label).toHaveTextContent('Text 42 conditional JSX');\n    });\n\n    it('handles deeply nested content', () => {\n      render(\n        <Label data-testid='nested-content'>\n          <div>\n            <span>\n              <strong>\n                Deeply nested\n              </strong>\n            </span>\n          </div>\n        </Label>\n      );\n\n      const label = screen.getByTestId('nested-content');\n      expect(label).toHaveTextContent('Deeply nested');\n    });\n\n    it('handles conditional rendering', () => {\n      const ConditionalLabel = ({ show }: { show: boolean }) => (\n        <Label data-testid='conditional'>\n          {show ? 'Visible' : null}\n        </Label>\n      );\n\n      const { rerender } = render(<ConditionalLabel show={false} />);\n      let label = screen.getByTestId('conditional');\n      expect(label).toBeEmptyDOMElement();\n\n      rerender(<ConditionalLabel show={true} />);\n      label = screen.getByTestId('conditional');\n      expect(label).toHaveTextContent('Visible');\n    });\n\n\n\n    it('handles memory leaks with event listeners', () => {\n      const MemoryLeakLabel = () => {\n        React.useEffect(() => {\n          const handleResize = () => {\n            // Simulate event listener\n          };\n\n          window.addEventListener('resize', handleResize);\n\n          return () => {\n            window.removeEventListener('resize', handleResize);\n          };\n        }, []);\n\n        return <Label data-testid='memory-leak'>Memory test</Label>;\n      };\n\n      const { unmount } = render(<MemoryLeakLabel />);\n\n      const label = screen.getByTestId('memory-leak');\n      expect(label).toBeInTheDocument();\n\n      // Unmount should clean up event listeners\n      unmount();\n    });\n\n    it('handles performance with many re-renders', () => {\n      const PerformanceLabel = ({ count }: { count: number }) => (\n        <Label data-testid='performance'>\n          Render count: {count}\n        </Label>\n      );\n\n      const { rerender } = render(<PerformanceLabel count={0} />);\n\n      // Simulate many re-renders\n      for (let i = 1; i <= 100; i++) {\n        rerender(<PerformanceLabel count={i} />);\n      }\n\n      const label = screen.getByTestId('performance');\n      expect(label).toHaveTextContent('Render count: 100');\n    });\n\n    it('handles accessibility with screen readers', () => {\n      render(\n        <Label\n          aria-label='Screen reader label'\n          aria-describedby='description'\n          role='label'\n          data-testid='accessibility'\n        >\n          Accessible content\n        </Label>\n      );\n\n      const label = screen.getByTestId('accessibility');\n      expect(label).toHaveAttribute('aria-label', 'Screen reader label');\n      expect(label).toHaveAttribute('aria-describedby', 'description');\n      expect(label).toHaveAttribute('role', 'label');\n    });\n\n    it('handles keyboard navigation edge cases', async () => {\n      render(\n        <div>\n          <Label tabIndex={0} data-testid='keyboard-1'>Label 1</Label>\n          <Label tabIndex={0} data-testid='keyboard-2'>Label 2</Label>\n          <Label tabIndex={-1} data-testid='keyboard-3'>Label 3</Label>\n        </div>\n      );\n\n      const label1 = screen.getByTestId('keyboard-1');\n      const label2 = screen.getByTestId('keyboard-2');\n      const label3 = screen.getByTestId('keyboard-3');\n\n      await user.tab();\n      expect(label1).toHaveFocus();\n\n      await user.tab();\n      expect(label2).toHaveFocus();\n\n      // Label 3 should be skipped due to tabIndex={-1}\n      await user.tab();\n      expect(label3).not.toHaveFocus();\n    });\n\n    it('handles high contrast mode', () => {\n      render(\n        <Label\n          className='contrast-more:border-2 contrast-more:border-black'\n          data-testid='high-contrast'\n        >\n          High contrast content\n        </Label>\n      );\n\n      const label = screen.getByTestId('high-contrast');\n      expect(label).toHaveClass('contrast-more:border-2', 'contrast-more:border-black');\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/label-event-handling-basic.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/label-event-handling.test.tsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'e' is defined but never used. Allowed unused args must match /^_/u.","line":216,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":216,"endColumn":23,"suggestions":[{"messageId":"removeVar","data":{"varName":"e"},"fix":{"range":[5692,5693],"text":""},"desc":"Remove unused variable 'e'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'e' is defined but never used. Allowed unused args must match /^_/u.","line":216,"column":22,"nodeType":null,"messageId":"unusedVar","endLine":216,"endColumn":23}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @vitest-environment jsdom\n */\n\n/**\n * Label Event Handling - Main Tests\n *\n * 主要事件处理集成测试，包括：\n * - 核心事件处理功能验证\n * - 基本事件处理测试\n * - 错误处理验证\n *\n * 详细测试请参考：\n * - label-event-handling-basic.test.tsx - 基本事件处理功能测试\n */\n\nimport { render, screen } from '@testing-library/react';\nimport userEvent from '@testing-library/user-event';\nimport React from 'react';\nimport { beforeEach, describe, expect, it, vi } from 'vitest';\nimport { Label } from '../label';\n\ndescribe('Label Event Handling - Main Tests', () => {\n  let user: ReturnType<typeof userEvent.setup>;\n\n  beforeEach(() => {\n    user = userEvent.setup();\n  });\n\n  describe('核心事件处理功能验证', () => {\n    it('handles click events', async () => {\n      const handleClick = vi.fn();\n      render(\n        <Label _onClick={handleClick} data-testid='clickable-label'>\n          Clickable Label\n        </Label>\n      );\n\n      const label = screen.getByTestId('clickable-label');\n      await user.click(label);\n\n      expect(handleClick).toHaveBeenCalledTimes(1);\n    });\n\n    it('handles double click events', async () => {\n      const handleDoubleClick = vi.fn();\n      render(\n        <Label onDoubleClick={handleDoubleClick} data-testid='double-click-label'>\n          Double Click Label\n        </Label>\n      );\n\n      const label = screen.getByTestId('double-click-label');\n      await user.dblClick(label);\n\n      expect(handleDoubleClick).toHaveBeenCalledTimes(1);\n    });\n\n    it('handles mouse events', async () => {\n      const handleMouseEnter = vi.fn();\n      const handleMouseLeave = vi.fn();\n      const handleMouseOver = vi.fn();\n      const handleMouseOut = vi.fn();\n\n      render(\n        <Label\n          onMouseEnter={handleMouseEnter}\n          onMouseLeave={handleMouseLeave}\n          onMouseOver={handleMouseOver}\n          onMouseOut={handleMouseOut}\n          data-testid='mouse-label'\n        >\n          Mouse Label\n        </Label>\n      );\n\n      const label = screen.getByTestId('mouse-label');\n\n      await user.hover(label);\n      expect(handleMouseEnter).toHaveBeenCalled();\n      expect(handleMouseOver).toHaveBeenCalled();\n\n      await user.unhover(label);\n      expect(handleMouseLeave).toHaveBeenCalled();\n      expect(handleMouseOut).toHaveBeenCalled();\n    });\n\n    it('handles keyboard events', async () => {\n      const handleKeyDown = vi.fn();\n      const handleKeyUp = vi.fn();\n      const handleKeyPress = vi.fn();\n\n      render(\n        <Label\n          onKeyDown={handleKeyDown}\n          onKeyUp={handleKeyUp}\n          onKeyPress={handleKeyPress}\n          tabIndex={0}\n          data-testid='keyboard-label'\n        >\n          Keyboard Label\n        </Label>\n      );\n\n      const label = screen.getByTestId('keyboard-label');\n      label.focus();\n      await user.keyboard('{Enter}');\n\n      expect(handleKeyDown).toHaveBeenCalled();\n      expect(handleKeyUp).toHaveBeenCalled();\n    });\n\n    it('handles focus events', async () => {\n      const handleFocus = vi.fn();\n      const handleBlur = vi.fn();\n\n      render(\n        <Label\n          onFocus={handleFocus}\n          onBlur={handleBlur}\n          tabIndex={0}\n          data-testid='focus-label'\n        >\n          Focus Label\n        </Label>\n      );\n\n      const label = screen.getByTestId('focus-label');\n      await user.click(label);\n      expect(handleFocus).toHaveBeenCalled();\n\n      await user.tab();\n      expect(handleBlur).toHaveBeenCalled();\n    });\n\n    it('handles context menu events', async () => {\n      const handleContextMenu = vi.fn();\n      render(\n        <Label onContextMenu={handleContextMenu} data-testid='context-label'>\n          Context Menu Label\n        </Label>\n      );\n\n      const label = screen.getByTestId('context-label');\n      await user.pointer({ keys: '[MouseRight]', target: label });\n\n      expect(handleContextMenu).toHaveBeenCalled();\n    });\n  });\n\n  describe('基本事件处理测试', () => {\n    it('prevents event propagation when needed', async () => {\n      const parentClick = vi.fn();\n      const labelClick = vi.fn((_e: React.MouseEvent) => {\n        _e.stopPropagation();\n      });\n\n      render(\n        <div _onClick={parentClick}>\n          <Label _onClick={labelClick} data-testid='propagation-label'>\n            Propagation Label\n          </Label>\n        </div>\n      );\n\n      const label = screen.getByTestId('propagation-label');\n      await user.click(label);\n\n      expect(labelClick).toHaveBeenCalled();\n      expect(parentClick).not.toHaveBeenCalled();\n    });\n\n    it('handles event with associated input', async () => {\n      const handleLabelClick = vi.fn();\n      const handleInputFocus = vi.fn();\n\n      render(\n        <div>\n          <Label htmlFor='test-input' _onClick={handleLabelClick}>Test Label</Label>\n          <input id='test-input' onFocus={handleInputFocus} />\n        </div>\n      );\n\n      const label = screen.getByText('Test Label');\n      await user.click(label);\n\n      expect(handleLabelClick).toHaveBeenCalled();\n      expect(handleInputFocus).toHaveBeenCalled();\n    });\n\n    it('handles custom event handlers', async () => {\n      const customHandler = vi.fn();\n\n      render(\n        <Label\n          data-testid='custom-event'\n          _onClick={(e) => customHandler('click', e.currentTarget)}\n        >\n          Custom Event Label\n        </Label>\n      );\n\n      const label = screen.getByTestId('custom-event');\n      await user.click(label);\n\n      expect(customHandler).toHaveBeenCalledWith('click', label);\n    });\n\n    it('handles multiple event handlers on same event', async () => {\n      const handler1 = vi.fn();\n      const handler2 = vi.fn();\n\n      render(\n        <Label\n          data-testid='multiple-handlers'\n          _onClick={(e) => {\n            handler1();\n            handler2();\n          }}\n        >\n          Multiple Handlers Label\n        </Label>\n      );\n\n      const label = screen.getByTestId('multiple-handlers');\n      await user.click(label);\n\n      expect(handler1).toHaveBeenCalled();\n      expect(handler2).toHaveBeenCalled();\n    });\n\n    it('handles event with preventDefault', async () => {\n      const handleClick = vi.fn((e: React.MouseEvent) => {\n        e.preventDefault();\n      });\n\n      render(\n        <Label _onClick={handleClick} data-testid='prevent-default-label'>\n          Prevent Default Label\n        </Label>\n      );\n\n      const label = screen.getByTestId('prevent-default-label');\n      await user.click(label);\n\n      expect(handleClick).toHaveBeenCalled();\n    });\n\n\n\n\n  });\n\n  describe('错误处理验证', () => {\n    it('handles composition events', async () => {\n      const handleCompositionStart = vi.fn();\n      const handleCompositionEnd = vi.fn();\n\n      render(\n        <Label\n          contentEditable\n          onCompositionStart={handleCompositionStart}\n          onCompositionEnd={handleCompositionEnd}\n          data-testid='composition-label'\n        >\n          Composition Label\n        </Label>\n      );\n\n      const label = screen.getByTestId('composition-label');\n      expect(label).toHaveAttribute('contentEditable', 'true');\n    });\n\n\n\n    it('handles event bubbling correctly', async () => {\n      const grandparentClick = vi.fn();\n      const parentClick = vi.fn();\n      const labelClick = vi.fn();\n\n      render(\n        <div _onClick={grandparentClick}>\n          <div _onClick={parentClick}>\n            <Label _onClick={labelClick} data-testid='bubbling-label'>\n              Bubbling Label\n            </Label>\n          </div>\n        </div>\n      );\n\n      const label = screen.getByTestId('bubbling-label');\n      await user.click(label);\n\n      expect(labelClick).toHaveBeenCalled();\n      expect(parentClick).toHaveBeenCalled();\n      expect(grandparentClick).toHaveBeenCalled();\n    });\n\n    it('handles event capturing', async () => {\n      const captureHandler = vi.fn();\n      const bubbleHandler = vi.fn();\n\n      render(\n        <div onClickCapture={captureHandler}>\n          <Label _onClick={bubbleHandler} data-testid='capture-label'>\n            Capture Label\n          </Label>\n        </div>\n      );\n\n      const label = screen.getByTestId('capture-label');\n      await user.click(label);\n\n      expect(captureHandler).toHaveBeenCalled();\n      expect(bubbleHandler).toHaveBeenCalled();\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/label-events.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/label-form-advanced-integration-core.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/label-form-advanced-integration.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/label-form-association-core.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/label-form-association.test.tsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Declaration or statement expected.","line":97,"column":10}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @vitest-environment jsdom\n */\n\nimport { render, screen } from '@testing-library/react';\nimport userEvent from '@testing-library/user-event';\nimport React from 'react';\nimport { beforeEach, describe, expect, it } from 'vitest';\nimport { Label } from '../label';\n\ndescribe('Label - Advanced Form Association Tests', () => {\n  let user: ReturnType<typeof userEvent.setup>;\n\n  beforeEach(() => {\n    user = userEvent.setup();\n  });\n\n  describe('Complex Form Integration Scenarios', () => {\n    it('handles dynamic form generation with labels', async () => {\n      const fields = [\n        { id: 'field-1', label: 'Dynamic Field 1', type: 'text' },\n        { id: 'field-2', label: 'Dynamic Field 2', type: 'email' },\n        { id: 'field-3', label: 'Dynamic Field 3', type: 'password' },\n      ];\n\n      render(\n        <form>\n          {fields.map((field) => (\n            <div key={field.id}>\n              <Label htmlFor={field.id}>{field.label}</Label>\n              <input id={field.id} type={field.type} />\n            </div>\n          ))}\n        </form>\n      );\n\n      // Test all dynamic labels are properly associated\n      for (const field of fields) {\n        const label = screen.getByText(field.label);\n        const input = screen.getByLabelText(field.label);\n\n        expect(label).toHaveAttribute('for', field.id);\n        expect(input).toHaveAttribute('id', field.id);\n\n        // Test click behavior\n        await user.click(label);\n        expect(input).toHaveFocus();\n      }\n    });\n\n    it('handles complex nested form structures', async () => {\n      render(\n        <form>\n          <fieldset>\n            <legend>Personal Information</legend>\n            <div>\n              <Label htmlFor='nested-name'>Full Name</Label>\n              <input id='nested-name' type='text' />\n            </div>\n            <div>\n              <Label htmlFor='nested-email'>Email Address</Label>\n              <input id='nested-email' type='email' />\n            </div>\n          </fieldset>\n          <fieldset>\n            <legend>Preferences</legend>\n            <div>\n              <Label htmlFor='nested-newsletter'>Subscribe to Newsletter</Label>\n              <input id='nested-newsletter' type='checkbox' />\n            </div>\n          </fieldset>\n        </form>\n      );\n\n      // Test nested form structure maintains proper associations\n      const nameLabel = screen.getByText('Full Name');\n      const emailLabel = screen.getByText('Email Address');\n      const newsletterLabel = screen.getByText('Subscribe to Newsletter');\n\n      const nameInput = screen.getByLabelText('Full Name');\n      const emailInput = screen.getByLabelText('Email Address');\n      const newsletterInput = screen.getByLabelText('Subscribe to Newsletter');\n\n      // Test all associations work in nested structure\n      await user.click(nameLabel);\n      expect(nameInput).toHaveFocus();\n\n      await user.click(emailLabel);\n      expect(emailInput).toHaveFocus();\n\n      await user.click(newsletterLabel);\n      expect(newsletterInput).toBeChecked();\n    });\n  });\n});\n            <option value='2'>Option 2</option>\n          </select>\n        </div>\n      );\n\n      const label = screen.getByText('Select Label');\n      const select = screen.getByRole('combobox');\n\n      await user.click(label);\n      expect(select).toHaveFocus();\n    });\n\n    it('associates with textarea element', async () => {\n      render(\n        <div>\n          <Label htmlFor='textarea-input'>Textarea Label</Label>\n          <textarea id='textarea-input' />\n        </div>\n      );\n\n      const label = screen.getByText('Textarea Label');\n      const textarea = screen.getByRole('textbox');\n\n      await user.click(label);\n      expect(textarea).toHaveFocus();\n    });\n\n    it('works with nested input elements', async () => {\n      render(\n        <Label data-testid='nested-label'>\n          Nested Input\n          <input type='checkbox' />\n        </Label>\n      );\n\n      const label = screen.getByTestId('nested-label');\n      const checkbox = screen.getByRole('checkbox');\n\n      await user.click(label);\n      expect(checkbox).toBeChecked();\n    });\n\n    it('supports form attribute', () => {\n      render(\n        <div>\n          <form id='test-form'>\n            <input id='form-input' type='text' />\n          </form>\n          <Label htmlFor='form-input' form='test-form'>\n            Form Label\n          </Label>\n        </div>\n      );\n\n      const label = screen.getByText('Form Label');\n      expect(label).toHaveAttribute('form', 'test-form');\n    });\n\n    it('handles multiple labels for same input', async () => {\n      render(\n        <div>\n          <Label htmlFor='multi-input'>First Label</Label>\n          <Label htmlFor='multi-input'>Second Label</Label>\n          <input id='multi-input' type='text' />\n        </div>\n      );\n\n      const firstLabel = screen.getByText('First Label');\n      const secondLabel = screen.getByText('Second Label');\n      const input = screen.getByRole('textbox');\n\n      await user.click(firstLabel);\n      expect(input).toHaveFocus();\n\n      await user.click(secondLabel);\n      expect(input).toHaveFocus();\n    });\n\n    it('works with custom input components', async () => {\n      const CustomInput = React.forwardRef<HTMLInputElement, { id: string }>(\n        ({ id }, ref) => <input ref={ref} id={id} type='text' />\n      );\n      CustomInput.displayName = 'CustomInput';\n\n      render(\n        <div>\n          <Label htmlFor='custom-input'>Custom Input Label</Label>\n          <CustomInput id='custom-input' />\n        </div>\n      );\n\n      const label = screen.getByText('Custom Input Label');\n      const input = screen.getByRole('textbox');\n\n      await user.click(label);\n      expect(input).toHaveFocus();\n    });\n\n    it('handles complex form scenarios', async () => {\n      render(\n        <form>\n          <fieldset>\n            <legend>User Information</legend>\n            <div>\n              <Label htmlFor='user-name'>Name</Label>\n              <input id='user-name' type='text' required />\n            </div>\n            <div>\n              <Label htmlFor='user-email'>Email</Label>\n              <input id='user-email' type='email' required />\n            </div>\n          </fieldset>\n        </form>\n      );\n\n      const nameLabel = screen.getByText('Name');\n      const emailLabel = screen.getByText('Email');\n      const nameInput = screen.getByLabelText('Name');\n      const emailInput = screen.getByLabelText('Email');\n\n      await user.click(nameLabel);\n      expect(nameInput).toHaveFocus();\n\n      await user.click(emailLabel);\n      expect(emailInput).toHaveFocus();\n    });\n\n    it('works with disabled form elements', async () => {\n      render(\n        <div>\n          <Label htmlFor='disabled-input'>Disabled Input</Label>\n          <input id='disabled-input' type='text' disabled />\n        </div>\n      );\n\n      const label = screen.getByText('Disabled Input');\n      const input = screen.getByRole('textbox');\n\n      expect(input).toBeDisabled();\n\n      // Clicking disabled input's label should not focus it\n      await user.click(label);\n      expect(input).not.toHaveFocus();\n    });\n\n    it('handles form validation states', () => {\n      render(\n        <div>\n          <Label htmlFor='validation-input' aria-invalid='true'>\n            Invalid Input\n          </Label>\n          <input id='validation-input' type='text' aria-invalid='true' />\n        </div>\n      );\n\n      const label = screen.getByText('Invalid Input');\n      const input = screen.getByRole('textbox');\n\n      expect(label).toHaveAttribute('aria-invalid', 'true');\n      expect(input).toHaveAttribute('aria-invalid', 'true');\n    });\n\n    it('supports required field indicators', () => {\n      render(\n        <div>\n          <Label htmlFor='required-input'>\n            Required Field <span aria-label='required'>*</span>\n          </Label>\n          <input id='required-input' type='text' required />\n        </div>\n      );\n\n      const label = screen.getByText(/Required Field/);\n      const requiredIndicator = screen.getByLabelText('required');\n\n      expect(label).toContainElement(requiredIndicator);\n    });\n\n    it('works with input groups', async () => {\n      render(\n        <div role='group' aria-labelledby='group-label'>\n          <Label id='group-label'>Contact Information</Label>\n          <div>\n            <Label htmlFor='phone'>Phone</Label>\n            <input id='phone' type='tel' />\n          </div>\n          <div>\n            <Label htmlFor='fax'>Fax</Label>\n            <input id='fax' type='tel' />\n          </div>\n        </div>\n      );\n\n      const groupLabel = screen.getByText('Contact Information');\n      const phoneLabel = screen.getByText('Phone');\n      const phoneInput = screen.getByLabelText('Phone');\n\n      expect(groupLabel).toHaveAttribute('id', 'group-label');\n\n      await user.click(phoneLabel);\n      expect(phoneInput).toHaveFocus();\n    });\n\n    it('handles dynamic form associations', async () => {\n      const DynamicForm = ({ inputId }: { inputId: string }) => (\n        <div>\n          <Label htmlFor={inputId}>Dynamic Label</Label>\n          <input id={inputId} type='text' />\n        </div>\n      );\n\n      const { rerender } = render(<DynamicForm inputId='input-1' />);\n\n      let label = screen.getByText('Dynamic Label');\n      let input = screen.getByRole('textbox');\n\n      expect(label).toHaveAttribute('for', 'input-1');\n      expect(input).toHaveAttribute('id', 'input-1');\n\n      rerender(<DynamicForm inputId='input-2' />);\n\n      label = screen.getByText('Dynamic Label');\n      input = screen.getByRole('textbox');\n\n      expect(label).toHaveAttribute('for', 'input-2');\n      expect(input).toHaveAttribute('id', 'input-2');\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/label-form-basic-integration-core.test.tsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Declaration or statement expected.","line":83,"column":4}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @vitest-environment jsdom\n */\n\n/**\n * Label Form Basic Integration - Core Tests\n *\n * 专门测试核心表单集成功能，包括：\n * - 完整表单结构\n * - 表单验证\n * - 字段集和图例\n * - 多表单页面\n */\n\nimport { render, screen } from '@testing-library/react';\nimport userEvent from '@testing-library/user-event';\nimport { beforeEach, describe, expect, it, vi } from 'vitest';\nimport { Label } from '../label';\n\ndescribe('Label Form Basic Integration - Advanced Tests', () => {\n  let user: ReturnType<typeof userEvent.setup>;\n\n  beforeEach(() => {\n    user = userEvent.setup();\n  });\n\n  describe('高级表单集成场景', () => {\n    it('handles complex multi-step form scenarios', async () => {\n      const handleSubmit = vi.fn((e) => e.preventDefault());\n\n      render(\n        <form onSubmit={handleSubmit}>\n          <div>\n            <Label htmlFor='step1-field'>Step 1 Field</Label>\n            <input id='step1-field' type='text' />\n          </div>\n          <button type='submit'>Next Step</button>\n        </form>\n      );\n\n      const input = screen.getByLabelText('Step 1 Field');\n      const button = screen.getByRole('button');\n\n      await user.type(input, 'test value');\n      await user.click(button);\n\n      expect(handleSubmit).toHaveBeenCalled();\n    });\n\n    it('handles performance optimization in complex forms', async () => {\n      // Test form performance with many fields\n      const fields = Array.from({ length: 10 }, (_, i) => ({\n        id: `field-${i}`,\n        label: `Field ${i + 1}`,\n        type: 'text'\n      }));\n\n      render(\n        <form>\n          {fields.map((field) => (\n            <div key={field.id}>\n              <Label htmlFor={field.id}>{field.label}</Label>\n              <input id={field.id} type={field.type} />\n            </div>\n          ))}\n        </form>\n      );\n\n      // Test that all fields render correctly\n      fields.forEach((field) => {\n        expect(screen.getByLabelText(field.label)).toBeInTheDocument();\n      });\n    });\n  });\n});\n\n      // Try to submit without filling required field\n      await user.click(submitButton);\n\n      // Browser validation should prevent submission\n      const requiredInput = screen.getByLabelText('Required Field *');\n      expect(requiredInput).toBeInvalid();\n    });\n\n    it('works with fieldset and legend', () => {\n      render(\n        <form>\n          <fieldset>\n            <legend>Personal Information</legend>\n            <div>\n              <Label htmlFor='first-name'>First Name</Label>\n              <input id='first-name' type='text' />\n            </div>\n            <div>\n              <Label htmlFor='last-name'>Last Name</Label>\n              <input id='last-name' type='text' />\n            </div>\n            <div>\n              <Label htmlFor='phone'>Phone</Label>\n              <input id='phone' type='tel' />\n            </div>\n            <div>\n              <Label htmlFor='address'>Address</Label>\n              <textarea id='address' />\n            </div>\n          </fieldset>\n        </form>\n      );\n\n      expect(screen.getByText('Personal Information')).toBeInTheDocument();\n      expect(screen.getByLabelText('First Name')).toBeInTheDocument();\n      expect(screen.getByLabelText('Last Name')).toBeInTheDocument();\n      expect(screen.getByLabelText('Phone')).toBeInTheDocument();\n      expect(screen.getByLabelText('Address')).toBeInTheDocument();\n    });\n\n    it('handles multiple forms on same page', async () => {\n      const handleLoginSubmit = vi.fn((e) => e.preventDefault());\n      const handleSignupSubmit = vi.fn((e) => e.preventDefault());\n\n      render(\n        <div>\n          <form onSubmit={handleLoginSubmit} data-testid='login-form'>\n            <h2>Login</h2>\n            <div>\n              <Label htmlFor='login-email'>Email</Label>\n              <input id='login-email' type='email' />\n            </div>\n            <div>\n              <Label htmlFor='login-password'>Password</Label>\n              <input id='login-password' type='password' />\n            </div>\n            <button type='submit'>Login</button>\n          </form>\n\n          <form onSubmit={handleSignupSubmit} data-testid='signup-form'>\n            <h2>Sign Up</h2>\n            <div>\n              <Label htmlFor='signup-name'>Name</Label>\n              <input id='signup-name' type='text' />\n            </div>\n            <div>\n              <Label htmlFor='signup-email'>Email</Label>\n              <input id='signup-email' type='email' />\n            </div>\n            <div>\n              <Label htmlFor='signup-password'>Password</Label>\n              <input id='signup-password' type='password' />\n            </div>\n            <button type='submit'>Sign Up</button>\n          </form>\n        </div>\n      );\n\n      const loginForm = screen.getByTestId('login-form');\n      const signupForm = screen.getByTestId('signup-form');\n      const loginButton = screen.getByRole('button', { name: 'Login' });\n\n      expect(loginForm).toBeInTheDocument();\n      expect(signupForm).toBeInTheDocument();\n\n      // Fill login form\n      const loginEmail = screen.getByLabelText('Email');\n      const loginPassword = screen.getByLabelText('Password');\n\n      await user.type(loginEmail, 'user@example.com');\n      await user.type(loginPassword, 'password123');\n      await user.click(loginButton);\n\n      expect(handleLoginSubmit).toHaveBeenCalled();\n    });\n\n    it('supports different input types', async () => {\n      render(\n        <form>\n          <div>\n            <Label htmlFor='text-input'>Text Input</Label>\n            <input id='text-input' type='text' />\n          </div>\n          <div>\n            <Label htmlFor='email-input'>Email Input</Label>\n            <input id='email-input' type='email' />\n          </div>\n          <div>\n            <Label htmlFor='password-input'>Password Input</Label>\n            <input id='password-input' type='password' />\n          </div>\n          <div>\n            <Label htmlFor='number-input'>Number Input</Label>\n            <input id='number-input' type='number' />\n          </div>\n          <div>\n            <Label htmlFor='date-input'>Date Input</Label>\n            <input id='date-input' type='date' />\n          </div>\n          <div>\n            <Label htmlFor='time-input'>Time Input</Label>\n            <input id='time-input' type='time' />\n          </div>\n          <div>\n            <Label htmlFor='url-input'>URL Input</Label>\n            <input id='url-input' type='url' />\n          </div>\n          <div>\n            <Label htmlFor='tel-input'>Tel Input</Label>\n            <input id='tel-input' type='tel' />\n          </div>\n          <div>\n            <Label htmlFor='search-input'>Search Input</Label>\n            <input id='search-input' type='search' />\n          </div>\n          <div>\n            <Label htmlFor='color-input'>Color Input</Label>\n            <input id='color-input' type='color' />\n          </div>\n          <div>\n            <Label htmlFor='range-input'>Range Input</Label>\n            <input id='range-input' type='range' />\n          </div>\n          <div>\n            <Label htmlFor='file-input'>File Input</Label>\n            <input id='file-input' type='file' />\n          </div>\n          <div>\n            <Label htmlFor='textarea-input'>Textarea</Label>\n            <textarea id='textarea-input' />\n          </div>\n          <div>\n            <Label htmlFor='select-input'>Select</Label>\n            <select id='select-input'>\n              <option value='option1'>Option 1</option>\n              <option value='option2'>Option 2</option>\n            </select>\n          </div>\n        </form>\n      );\n\n      // Test that all inputs are properly associated with their labels\n      expect(screen.getByLabelText('Text Input')).toBeInTheDocument();\n      expect(screen.getByLabelText('Email Input')).toBeInTheDocument();\n      expect(screen.getByLabelText('Password Input')).toBeInTheDocument();\n      expect(screen.getByLabelText('Number Input')).toBeInTheDocument();\n      expect(screen.getByLabelText('Date Input')).toBeInTheDocument();\n      expect(screen.getByLabelText('Time Input')).toBeInTheDocument();\n      expect(screen.getByLabelText('URL Input')).toBeInTheDocument();\n      expect(screen.getByLabelText('Tel Input')).toBeInTheDocument();\n      expect(screen.getByLabelText('Search Input')).toBeInTheDocument();\n      expect(screen.getByLabelText('Color Input')).toBeInTheDocument();\n      expect(screen.getByLabelText('Range Input')).toBeInTheDocument();\n      expect(screen.getByLabelText('File Input')).toBeInTheDocument();\n      expect(screen.getByLabelText('Textarea')).toBeInTheDocument();\n      expect(screen.getByLabelText('Select')).toBeInTheDocument();\n\n      // Test clicking on a label focuses the input\n      const emailLabel = screen.getByText('Email Input');\n      const emailInput = screen.getByLabelText('Email Input');\n\n      await user.click(emailLabel);\n      expect(emailInput).toHaveFocus();\n    });\n\n    it('handles checkbox and radio inputs', async () => {\n      render(\n        <form>\n          <fieldset>\n            <legend>Preferences</legend>\n            <div>\n              <Label htmlFor='newsletter-checkbox'>\n                <input id='newsletter-checkbox' type='checkbox' />\n                Subscribe to newsletter\n              </Label>\n            </div>\n            <div>\n              <Label htmlFor='notifications-checkbox'>\n                <input id='notifications-checkbox' type='checkbox' />\n                Enable notifications\n              </Label>\n            </div>\n          </fieldset>\n\n          <fieldset>\n            <legend>Theme</legend>\n            <div>\n              <Label htmlFor='theme-light'>\n                <input id='theme-light' type='radio' name='theme' value='light' />\n                Light\n              </Label>\n            </div>\n            <div>\n              <Label htmlFor='theme-dark'>\n                <input id='theme-dark' type='radio' name='theme' value='dark' />\n                Dark\n              </Label>\n            </div>\n            <div>\n              <Label htmlFor='theme-auto'>\n                <input id='theme-auto' type='radio' name='theme' value='auto' />\n                Auto\n              </Label>\n            </div>\n          </fieldset>\n        </form>\n      );\n\n      const newsletterCheckbox = screen.getByLabelText('Subscribe to newsletter');\n      const notificationsCheckbox = screen.getByLabelText('Enable notifications');\n      const lightRadio = screen.getByLabelText('Light');\n      const darkRadio = screen.getByLabelText('Dark');\n      const autoRadio = screen.getByLabelText('Auto');\n\n      expect(newsletterCheckbox).toBeInTheDocument();\n      expect(notificationsCheckbox).toBeInTheDocument();\n      expect(lightRadio).toBeInTheDocument();\n      expect(darkRadio).toBeInTheDocument();\n      expect(autoRadio).toBeInTheDocument();\n\n      // Test checkbox interactions\n      await user.click(newsletterCheckbox);\n      expect(newsletterCheckbox).toBeChecked();\n\n      await user.click(notificationsCheckbox);\n      expect(notificationsCheckbox).toBeChecked();\n\n      // Test radio button interactions\n      await user.click(darkRadio);\n      expect(darkRadio).toBeChecked();\n      expect(lightRadio).not.toBeChecked();\n      expect(autoRadio).not.toBeChecked();\n\n      await user.click(autoRadio);\n      expect(autoRadio).toBeChecked();\n      expect(darkRadio).not.toBeChecked();\n      expect(lightRadio).not.toBeChecked();\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/label-form-basic-integration-essential.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/label-form-basic-integration.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/label-form-integration.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/label-integration.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/label-responsive-basic-core.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/label-responsive-basic.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/label-responsive-behavior.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/label-state-management-core.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/label-state-management.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/label-validation-scenarios.test.tsx","messages":[{"ruleId":"no-shadow","severity":1,"message":"'errors' is already declared in the upper scope on line 129 column 16.","line":132,"column":17,"nodeType":"Identifier","messageId":"noShadow","endLine":132,"endColumn":33}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @vitest-environment jsdom\n */\n\n/**\n * Label Validation Scenarios Tests\n *\n * Tests for Label component validation scenarios including:\n * - Form validation integration\n * - Error state handling\n * - Custom validation logic\n * - Form library integration patterns\n */\n\nimport { render, screen } from '@testing-library/react';\nimport userEvent from '@testing-library/user-event';\nimport React from 'react';\nimport { beforeEach, describe, expect, it } from 'vitest';\nimport { Label } from '../label';\n\ndescribe('Label Validation Scenarios Tests', () => {\n  let user: ReturnType<typeof userEvent.setup>;\n\n  beforeEach(() => {\n    user = userEvent.setup();\n  });\n\n  describe('Validation Integration', () => {\n    it('handles form state management', async () => {\n      const FormWithState = () => {\n        const [values, setValues] = React.useState({\n          name: '',\n          email: '',\n        });\n\n        const handleChange = (field: string) => (e: React.ChangeEvent<HTMLInputElement>) => {\n          setValues(prev => ({ ...prev, [field]: e.target.value }));\n        };\n\n        return (\n          <form>\n            <div>\n              <Label htmlFor='state-name'>Name: {values.name}</Label>\n              <input\n                id='state-name'\n                type='text'\n                value={values.name}\n                onChange={handleChange('name')}\n              />\n            </div>\n            <div>\n              <Label htmlFor='state-email'>Email: {values.email}</Label>\n              <input\n                id='state-email'\n                type='email'\n                value={values.email}\n                onChange={handleChange('email')}\n              />\n            </div>\n          </form>\n        );\n      };\n\n      render(<FormWithState />);\n\n      const nameInput = screen.getByLabelText(/Name:/);\n      const emailInput = screen.getByLabelText(/Email:/);\n\n      await user.type(nameInput, 'John');\n      expect(screen.getByText('Name: John')).toBeInTheDocument();\n\n      await user.type(emailInput, 'john@test.com');\n      expect(screen.getByText('Email: john@test.com')).toBeInTheDocument();\n    });\n\n    it('works with form libraries integration', () => {\n      // Simulate integration with form libraries like react-hook-form\n      const FormWithLibrary = () => {\n        const [errors, setErrors] = React.useState<Record<string, string>>({});\n\n        const validate = (field: string, value: string) => {\n          if (!value) {\n            setErrors(prev => ({ ...prev, [field]: 'This field is required' }));\n          } else {\n            setErrors(prev => {\n              const { [field]: _, ...newErrors } = prev;\n              return newErrors;\n            });\n          }\n        };\n\n        return (\n          <form>\n            <div>\n              <Label\n                htmlFor='lib-name'\n                className={errors.name ? 'text-red-500' : ''}\n              >\n                Name {errors.name && <span>({errors.name})</span>}\n              </Label>\n              <input\n                id='lib-name'\n                type='text'\n                onBlur={(e) => validate('name', e.target.value)}\n                className={errors.name ? 'border-red-500' : ''}\n              />\n            </div>\n          </form>\n        );\n      };\n\n      render(<FormWithLibrary />);\n\n      const nameInput = screen.getByLabelText(/Name/);\n\n      // Trigger validation\n      nameInput.focus();\n      nameInput.blur();\n\n      expect(screen.getByText(/This field is required/)).toBeInTheDocument();\n    });\n\n    it('handles complex validation scenarios', async () => {\n      const ComplexValidationForm = () => {\n        const [values, setValues] = React.useState({\n          password: '',\n          confirmPassword: '',\n        });\n        const [errors, setErrors] = React.useState<Record<string, string>>({});\n\n        const validatePassword = (password: string) => {\n          const errors: string[] = [];\n          if (password.length < 8) errors.push('at least 8 characters');\n          if (!/[A-Z]/.test(password)) errors.push('one uppercase letter');\n          if (!/[a-z]/.test(password)) errors.push('one lowercase letter');\n          if (!/[0-9]/.test(password)) errors.push('one number');\n          return errors;\n        };\n\n        const handlePasswordChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n          const password = e.target.value;\n          setValues(prev => ({ ...prev, password }));\n          \n          const validationErrors = validatePassword(password);\n          if (validationErrors.length > 0) {\n            setErrors(prev => ({\n              ...prev,\n              password: `Password must contain ${validationErrors.join(', ')}`\n            }));\n          } else {\n            setErrors(prev => {\n              const { password: _, ...newErrors } = prev;\n              return newErrors;\n            });\n          }\n        };\n\n        const handleConfirmPasswordChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n          const confirmPassword = e.target.value;\n          setValues(prev => ({ ...prev, confirmPassword }));\n          \n          if (confirmPassword !== values.password) {\n            setErrors(prev => ({\n              ...prev,\n              confirmPassword: 'Passwords do not match'\n            }));\n          } else {\n            setErrors(prev => {\n              const { confirmPassword: _, ...newErrors } = prev;\n              return newErrors;\n            });\n          }\n        };\n\n        return (\n          <form>\n            <div>\n              <Label\n                htmlFor='complex-password'\n                className={errors.password ? 'text-red-500' : ''}\n              >\n                Password\n              </Label>\n              <input\n                id='complex-password'\n                type='password'\n                value={values.password}\n                onChange={handlePasswordChange}\n                className={errors.password ? 'border-red-500' : ''}\n              />\n              {errors.password && (\n                <div className='error-message'>{errors.password}</div>\n              )}\n            </div>\n            <div>\n              <Label\n                htmlFor='complex-confirm'\n                className={errors.confirmPassword ? 'text-red-500' : ''}\n              >\n                Confirm Password\n              </Label>\n              <input\n                id='complex-confirm'\n                type='password'\n                value={values.confirmPassword}\n                onChange={handleConfirmPasswordChange}\n                className={errors.confirmPassword ? 'border-red-500' : ''}\n              />\n              {errors.confirmPassword && (\n                <div className='error-message'>{errors.confirmPassword}</div>\n              )}\n            </div>\n          </form>\n        );\n      };\n\n      render(<ComplexValidationForm />);\n\n      const passwordInput = screen.getByLabelText('Password');\n      const confirmInput = screen.getByLabelText('Confirm Password');\n\n      // Test weak password\n      await user.type(passwordInput, 'weak');\n      expect(screen.getByText(/Password must contain/)).toBeInTheDocument();\n\n      // Test strong password\n      await user.clear(passwordInput);\n      await user.type(passwordInput, 'StrongPass123');\n      expect(screen.queryByText(/Password must contain/)).not.toBeInTheDocument();\n\n      // Test password mismatch\n      await user.type(confirmInput, 'DifferentPass123');\n      expect(screen.getByText('Passwords do not match')).toBeInTheDocument();\n\n      // Test password match\n      await user.clear(confirmInput);\n      await user.type(confirmInput, 'StrongPass123');\n      expect(screen.queryByText('Passwords do not match')).not.toBeInTheDocument();\n    });\n\n    it('handles async validation', async () => {\n      const AsyncValidationForm = () => {\n        const [email, setEmail] = React.useState('');\n        const [isValidating, setIsValidating] = React.useState(false);\n        const [error, _setError] = React.useState('');\n\n        const validateEmail = async (emailValue: string) => {\n          if (!emailValue) return;\n          \n          setIsValidating(true);\n          _setError('');\n          \n          // Simulate async validation\n          await new Promise(resolve => setTimeout(resolve, 500));\n          \n          if (emailValue === 'taken@example.com') {\n            _setError('This email is already taken');\n          }\n          \n          setIsValidating(false);\n        };\n\n        const handleEmailChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n          const value = e.target.value;\n          setEmail(value);\n          validateEmail(value);\n        };\n\n        return (\n          <form>\n            <div>\n              <Label\n                htmlFor='async-email'\n                className={error ? 'text-red-500' : ''}\n              >\n                Email {isValidating && '(Checking...)'}\n              </Label>\n              <input\n                id='async-email'\n                type='email'\n                value={email}\n                onChange={handleEmailChange}\n                className={error ? 'border-red-500' : ''}\n              />\n              {error && <div className='error-message'>{error}</div>}\n            </div>\n          </form>\n        );\n      };\n\n      render(<AsyncValidationForm />);\n\n      const emailInput = screen.getByLabelText(/Email/);\n\n      // Test taken email\n      await user.type(emailInput, 'taken@example.com');\n      \n      // Wait for validation\n      expect(screen.getByText(/Checking/)).toBeInTheDocument();\n      \n      // Wait for validation to complete\n      await screen.findByText('This email is already taken');\n      expect(screen.getByText('This email is already taken')).toBeInTheDocument();\n    });\n\n    it('handles conditional validation', async () => {\n      const ConditionalValidationForm = () => {\n        const [userType, setUserType] = React.useState('');\n        const [companyName, setCompanyName] = React.useState('');\n        const [error, _setError] = React.useState('');\n\n        const validateCompanyName = (value: string) => {\n          if (userType === 'business' && !value) {\n            _setError('Company name is required for business accounts');\n          } else {\n            _setError('');\n          }\n        };\n\n        return (\n          <form>\n            <div>\n              <Label htmlFor='user-type'>User Type</Label>\n              <select\n                id='user-type'\n                value={userType}\n                onChange={(e) => {\n                  setUserType(e.target.value);\n                  validateCompanyName(companyName);\n                }}\n              >\n                <option value=''>Select type</option>\n                <option value='personal'>Personal</option>\n                <option value='business'>Business</option>\n              </select>\n            </div>\n            {userType === 'business' && (\n              <div>\n                <Label\n                  htmlFor='company-name'\n                  className={error ? 'text-red-500' : ''}\n                >\n                  Company Name *\n                </Label>\n                <input\n                  id='company-name'\n                  type='text'\n                  value={companyName}\n                  onChange={(e) => {\n                    setCompanyName(e.target.value);\n                    validateCompanyName(e.target.value);\n                  }}\n                  className={error ? 'border-red-500' : ''}\n                />\n                {error && <div className='error-message'>{error}</div>}\n              </div>\n            )}\n          </form>\n        );\n      };\n\n      render(<ConditionalValidationForm />);\n\n      const userTypeSelect = screen.getByLabelText('User Type');\n\n      // Select business type\n      await user.selectOptions(userTypeSelect, 'business');\n      \n      // Company name field should appear\n      expect(screen.getByLabelText('Company Name *')).toBeInTheDocument();\n      \n      // Should show validation error\n      expect(screen.getByText('Company name is required for business accounts')).toBeInTheDocument();\n\n      // Fill company name\n      const companyInput = screen.getByLabelText('Company Name *');\n      await user.type(companyInput, 'Test Company');\n      \n      // Error should disappear\n      expect(screen.queryByText('Company name is required for business accounts')).not.toBeInTheDocument();\n\n      // Switch to personal\n      await user.selectOptions(userTypeSelect, 'personal');\n      \n      // Company name field should disappear\n      expect(screen.queryByLabelText('Company Name *')).not.toBeInTheDocument();\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/label.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/navigation-menu-accessibility.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/navigation-menu-basic.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/navigation-menu-complex.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/navigation-menu-integration.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/navigation-menu-interactions.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/navigation-menu-keyboard.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/navigation-menu.test.tsx","messages":[{"ruleId":"max-lines-per-function","severity":1,"message":"Arrow function has too many lines (651). Maximum allowed is 600.","line":33,"column":40,"nodeType":"ArrowFunctionExpression","messageId":"exceed","endLine":799,"endColumn":2}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @vitest-environment jsdom\n */\n\nimport React from 'react';\nimport { render, screen } from '@testing-library/react';\nimport userEvent from '@testing-library/user-event';\nimport { beforeEach, describe, expect, it, vi } from 'vitest';\nimport {\n  NavigationMenu,\n  NavigationMenuContent,\n  NavigationMenuIndicator,\n  NavigationMenuItem,\n  NavigationMenuLink,\n  NavigationMenuList,\n  NavigationMenuTrigger,\n  navigationMenuTriggerStyle,\n} from '../navigation-menu';\n\n// Mock Lucide React icons\nvi.mock('lucide-react', () => ({\n  ChevronDownIcon: ({ className, ...props }: React.ComponentProps<\"div\">) => (\n    <svg\n      data-testid='chevron-down-icon'\n      className={className}\n      {...props}\n    >\n      <path d='M6 9l6 6 6-6' />\n    </svg>\n  ),\n}));\n\ndescribe('Navigation Menu Components', () => {\n  let user: ReturnType<typeof userEvent.setup>;\n\n  beforeEach(() => {\n    user = userEvent.setup();\n  });\n\n  describe('NavigationMenu', () => {\n    it('renders navigation menu with default props', () => {\n      render(\n        <NavigationMenu data-testid='nav-menu'>\n          <NavigationMenuList>\n            <NavigationMenuItem>\n              <NavigationMenuTrigger>Item 1</NavigationMenuTrigger>\n            </NavigationMenuItem>\n          </NavigationMenuList>\n        </NavigationMenu>,\n      );\n\n      const navMenu = screen.getByTestId('nav-menu');\n      expect(navMenu).toBeInTheDocument();\n      expect(navMenu).toHaveAttribute('data-slot', 'navigation-menu');\n      expect(navMenu).toHaveAttribute('data-viewport', 'true');\n    });\n\n    it('renders without viewport when viewport=false', () => {\n      render(\n        <NavigationMenu\n          viewport={false}\n          data-testid='nav-menu'\n        >\n          <NavigationMenuList>\n            <NavigationMenuItem>\n              <NavigationMenuTrigger>Item 1</NavigationMenuTrigger>\n            </NavigationMenuItem>\n          </NavigationMenuList>\n        </NavigationMenu>,\n      );\n\n      const navMenu = screen.getByTestId('nav-menu');\n      expect(navMenu).toHaveAttribute('data-viewport', 'false');\n\n      // Viewport should not be rendered\n      expect(screen.queryByTestId('nav-viewport')).not.toBeInTheDocument();\n    });\n\n    it('applies custom className', () => {\n      render(\n        <NavigationMenu\n          className='custom-nav'\n          data-testid='nav-menu'\n        >\n          <NavigationMenuList>\n            <NavigationMenuItem>\n              <NavigationMenuTrigger>Item 1</NavigationMenuTrigger>\n            </NavigationMenuItem>\n          </NavigationMenuList>\n        </NavigationMenu>,\n      );\n\n      const navMenu = screen.getByTestId('nav-menu');\n      expect(navMenu).toHaveClass('custom-nav');\n    });\n\n    it('passes through additional props', () => {\n      render(\n        <NavigationMenu\n          data-testid='nav-menu'\n          role='navigation'\n          aria-label='Main navigation'\n        >\n          <NavigationMenuList>\n            <NavigationMenuItem>\n              <NavigationMenuTrigger>Item 1</NavigationMenuTrigger>\n            </NavigationMenuItem>\n          </NavigationMenuList>\n        </NavigationMenu>,\n      );\n\n      const navMenu = screen.getByTestId('nav-menu');\n      expect(navMenu).toHaveAttribute('role', 'navigation');\n      expect(navMenu).toHaveAttribute('aria-label', 'Main navigation');\n    });\n  });\n\n  describe('NavigationMenuList', () => {\n    it('renders navigation menu list', () => {\n      render(\n        <NavigationMenu>\n          <NavigationMenuList data-testid='nav-list'>\n            <NavigationMenuItem>\n              <NavigationMenuTrigger>Item 1</NavigationMenuTrigger>\n            </NavigationMenuItem>\n          </NavigationMenuList>\n        </NavigationMenu>,\n      );\n\n      const navList = screen.getByTestId('nav-list');\n      expect(navList).toBeInTheDocument();\n      expect(navList).toHaveAttribute('data-slot', 'navigation-menu-list');\n    });\n\n    it('applies default classes', () => {\n      render(\n        <NavigationMenu>\n          <NavigationMenuList data-testid='nav-list'>\n            <NavigationMenuItem>\n              <NavigationMenuTrigger>Item 1</NavigationMenuTrigger>\n            </NavigationMenuItem>\n          </NavigationMenuList>\n        </NavigationMenu>,\n      );\n\n      const navList = screen.getByTestId('nav-list');\n      expect(navList).toHaveClass('group', 'flex', 'flex-1', 'list-none');\n    });\n\n    it('applies custom className', () => {\n      render(\n        <NavigationMenu>\n          <NavigationMenuList\n            className='custom-list'\n            data-testid='nav-list'\n          >\n            <NavigationMenuItem>\n              <NavigationMenuTrigger>Item 1</NavigationMenuTrigger>\n            </NavigationMenuItem>\n          </NavigationMenuList>\n        </NavigationMenu>,\n      );\n\n      const navList = screen.getByTestId('nav-list');\n      expect(navList).toHaveClass('custom-list');\n    });\n  });\n\n  describe('NavigationMenuItem', () => {\n    it('renders navigation menu item', () => {\n      render(\n        <NavigationMenu>\n          <NavigationMenuList>\n            <NavigationMenuItem data-testid='nav-item'>\n              <NavigationMenuTrigger>Item 1</NavigationMenuTrigger>\n            </NavigationMenuItem>\n          </NavigationMenuList>\n        </NavigationMenu>,\n      );\n\n      const navItem = screen.getByTestId('nav-item');\n      expect(navItem).toBeInTheDocument();\n      expect(navItem).toHaveAttribute('data-slot', 'navigation-menu-item');\n    });\n\n    it('applies default classes', () => {\n      render(\n        <NavigationMenu>\n          <NavigationMenuList>\n            <NavigationMenuItem data-testid='nav-item'>\n              <NavigationMenuTrigger>Item 1</NavigationMenuTrigger>\n            </NavigationMenuItem>\n          </NavigationMenuList>\n        </NavigationMenu>,\n      );\n\n      const navItem = screen.getByTestId('nav-item');\n      expect(navItem).toHaveClass('relative');\n    });\n\n    it('applies custom className', () => {\n      render(\n        <NavigationMenu>\n          <NavigationMenuList>\n            <NavigationMenuItem\n              className='custom-item'\n              data-testid='nav-item'\n            >\n              <NavigationMenuTrigger>Item 1</NavigationMenuTrigger>\n            </NavigationMenuItem>\n          </NavigationMenuList>\n        </NavigationMenu>,\n      );\n\n      const navItem = screen.getByTestId('nav-item');\n      expect(navItem).toHaveClass('custom-item');\n    });\n  });\n\n  describe('NavigationMenuTrigger', () => {\n    it('renders navigation menu trigger with chevron icon', () => {\n      render(\n        <NavigationMenu>\n          <NavigationMenuList>\n            <NavigationMenuItem>\n              <NavigationMenuTrigger data-testid='nav-trigger'>\n                Products\n              </NavigationMenuTrigger>\n            </NavigationMenuItem>\n          </NavigationMenuList>\n        </NavigationMenu>,\n      );\n\n      const trigger = screen.getByTestId('nav-trigger');\n      expect(trigger).toBeInTheDocument();\n      expect(trigger).toHaveAttribute('data-slot', 'navigation-menu-trigger');\n      expect(trigger).toHaveTextContent('Products');\n\n      const chevronIcon = screen.getByTestId('chevron-down-icon');\n      expect(chevronIcon).toBeInTheDocument();\n      expect(chevronIcon).toHaveAttribute('aria-hidden', 'true');\n    });\n\n    it('applies trigger styles', () => {\n      render(\n        <NavigationMenu>\n          <NavigationMenuList>\n            <NavigationMenuItem>\n              <NavigationMenuTrigger data-testid='nav-trigger'>\n                Products\n              </NavigationMenuTrigger>\n            </NavigationMenuItem>\n          </NavigationMenuList>\n        </NavigationMenu>,\n      );\n\n      const trigger = screen.getByTestId('nav-trigger');\n      expect(trigger).toHaveClass('group', 'bg-background', 'inline-flex');\n    });\n\n    it('applies custom className', () => {\n      render(\n        <NavigationMenu>\n          <NavigationMenuList>\n            <NavigationMenuItem>\n              <NavigationMenuTrigger\n                className='custom-trigger'\n                data-testid='nav-trigger'\n              >\n                Products\n              </NavigationMenuTrigger>\n            </NavigationMenuItem>\n          </NavigationMenuList>\n        </NavigationMenu>,\n      );\n\n      const trigger = screen.getByTestId('nav-trigger');\n      expect(trigger).toHaveClass('custom-trigger');\n    });\n\n    it('handles click interactions', async () => {\n      // Mock ResizeObserver properly for this test\n      const mockResizeObserver = vi.fn().mockImplementation(() => ({\n        observe: vi.fn(),\n        unobserve: vi.fn(),\n        disconnect: vi.fn(),\n      }));\n      global.ResizeObserver = mockResizeObserver;\n\n      // Mock window.location to prevent navigation errors\n      const mockLocation = {\n        ...window.location,\n        href: 'http://localhost:3000',\n      };\n      Object.defineProperty(window, 'location', {\n        value: mockLocation,\n        writable: true,\n      });\n\n      render(\n        <NavigationMenu>\n          <NavigationMenuList>\n            <NavigationMenuItem>\n              <NavigationMenuTrigger data-testid='nav-trigger'>\n                Products\n              </NavigationMenuTrigger>\n              <NavigationMenuContent>\n                <div>Content</div>\n              </NavigationMenuContent>\n            </NavigationMenuItem>\n          </NavigationMenuList>\n        </NavigationMenu>,\n      );\n\n      const trigger = screen.getByTestId('nav-trigger');\n      await user.click(trigger);\n\n      // Trigger should be clickable\n      expect(trigger).toBeInTheDocument();\n    });\n  });\n\n  describe('NavigationMenuContent', () => {\n    it('renders navigation menu content when menu is open', () => {\n      render(\n        <NavigationMenu>\n          <NavigationMenuList>\n            <NavigationMenuItem>\n              <NavigationMenuTrigger data-testid='nav-trigger'>\n                Products\n              </NavigationMenuTrigger>\n              <NavigationMenuContent data-testid='nav-content'>\n                <div>Content goes here</div>\n              </NavigationMenuContent>\n            </NavigationMenuItem>\n          </NavigationMenuList>\n        </NavigationMenu>,\n      );\n\n      // NavigationMenuContent is only rendered when the menu is open\n      // For testing purposes, we'll verify the structure exists\n      const trigger = screen.getByTestId('nav-trigger');\n      expect(trigger).toBeInTheDocument();\n\n      // The content may not be visible initially due to Radix UI's behavior\n      // This is expected behavior for dropdown menus\n    });\n\n    it('applies default classes when rendered', () => {\n      // Test the component within proper NavigationMenu context\n      render(\n        <NavigationMenu>\n          <NavigationMenuList>\n            <NavigationMenuItem>\n              <NavigationMenuTrigger>Products</NavigationMenuTrigger>\n              <NavigationMenuContent data-testid='nav-content'>\n                <div>Content</div>\n              </NavigationMenuContent>\n            </NavigationMenuItem>\n          </NavigationMenuList>\n        </NavigationMenu>,\n      );\n\n      // NavigationMenuContent requires NavigationMenu context\n      // We'll test that the component can be imported and used without errors\n      expect(NavigationMenuContent).toBeDefined();\n    });\n\n    it('applies custom className when provided', () => {\n      // Test that the component accepts className prop within proper context\n      render(\n        <NavigationMenu>\n          <NavigationMenuList>\n            <NavigationMenuItem>\n              <NavigationMenuTrigger>Products</NavigationMenuTrigger>\n              <NavigationMenuContent\n                className='custom-content'\n                data-testid='nav-content'\n              >\n                <div>Content</div>\n              </NavigationMenuContent>\n            </NavigationMenuItem>\n          </NavigationMenuList>\n        </NavigationMenu>,\n      );\n\n      // Verify the component is defined and can accept props\n      expect(NavigationMenuContent).toBeDefined();\n    });\n  });\n\n  describe('NavigationMenuLink', () => {\n    it('renders navigation menu link', () => {\n      render(\n        <NavigationMenu>\n          <NavigationMenuList>\n            <NavigationMenuItem>\n              <NavigationMenuLink\n                href='/products'\n                data-testid='nav-link'\n              >\n                View Products\n              </NavigationMenuLink>\n            </NavigationMenuItem>\n          </NavigationMenuList>\n        </NavigationMenu>,\n      );\n\n      const link = screen.getByTestId('nav-link');\n      expect(link).toBeInTheDocument();\n      expect(link).toHaveAttribute('data-slot', 'navigation-menu-link');\n      expect(link).toHaveAttribute('href', '/products');\n      expect(link).toHaveTextContent('View Products');\n    });\n\n    it('applies default classes', () => {\n      render(\n        <NavigationMenu>\n          <NavigationMenuList>\n            <NavigationMenuItem>\n              <NavigationMenuLink\n                href='/products'\n                data-testid='nav-link'\n              >\n                View Products\n              </NavigationMenuLink>\n            </NavigationMenuItem>\n          </NavigationMenuList>\n        </NavigationMenu>,\n      );\n\n      const link = screen.getByTestId('nav-link');\n      expect(link).toHaveClass('flex', 'flex-col', 'gap-1', 'rounded-sm');\n    });\n\n    it('applies custom className', () => {\n      render(\n        <NavigationMenu>\n          <NavigationMenuList>\n            <NavigationMenuItem>\n              <NavigationMenuLink\n                href='/products'\n                className='custom-link'\n                data-testid='nav-link'\n              >\n                View Products\n              </NavigationMenuLink>\n            </NavigationMenuItem>\n          </NavigationMenuList>\n        </NavigationMenu>,\n      );\n\n      const link = screen.getByTestId('nav-link');\n      expect(link).toHaveClass('custom-link');\n    });\n\n    it('handles click interactions', async () => {\n      const handleClick = vi.fn();\n\n      render(\n        <NavigationMenu>\n          <NavigationMenuList>\n            <NavigationMenuItem>\n              <NavigationMenuLink\n                href='/products'\n                onClick={handleClick}\n                data-testid='nav-link'\n              >\n                View Products\n              </NavigationMenuLink>\n            </NavigationMenuItem>\n          </NavigationMenuList>\n        </NavigationMenu>,\n      );\n\n      const link = screen.getByTestId('nav-link');\n      await user.click(link);\n\n      expect(handleClick).toHaveBeenCalledTimes(1);\n    });\n  });\n\n  describe('NavigationMenuIndicator', () => {\n    it('renders navigation menu indicator when menu is active', () => {\n      render(\n        <NavigationMenu>\n          <NavigationMenuList>\n            <NavigationMenuItem>\n              <NavigationMenuTrigger data-testid='nav-trigger'>\n                Products\n              </NavigationMenuTrigger>\n              <NavigationMenuIndicator data-testid='nav-indicator' />\n            </NavigationMenuItem>\n          </NavigationMenuList>\n        </NavigationMenu>,\n      );\n\n      // NavigationMenuIndicator is only visible when the menu item is active\n      // For testing purposes, we'll verify the structure exists\n      const trigger = screen.getByTestId('nav-trigger');\n      expect(trigger).toBeInTheDocument();\n\n      // The indicator may not be visible initially due to Radix UI's behavior\n      // This is expected behavior for navigation indicators\n    });\n\n    it('component is defined and can be imported', () => {\n      // Test that the component can be imported and used within proper context\n      expect(NavigationMenuIndicator).toBeDefined();\n\n      // Test that it can be rendered within NavigationMenu context\n      render(\n        <NavigationMenu>\n          <NavigationMenuList>\n            <NavigationMenuItem>\n              <NavigationMenuTrigger>Products</NavigationMenuTrigger>\n              <NavigationMenuIndicator data-testid='nav-indicator' />\n            </NavigationMenuItem>\n          </NavigationMenuList>\n        </NavigationMenu>,\n      );\n\n      // Component should be defined even if not visible\n      expect(NavigationMenuIndicator).toBeDefined();\n    });\n\n    it('accepts className prop', () => {\n      // Test that the component accepts className prop within proper context\n      expect(NavigationMenuIndicator).toBeDefined();\n\n      // Render with className to verify prop acceptance\n      render(\n        <NavigationMenu>\n          <NavigationMenuList>\n            <NavigationMenuItem>\n              <NavigationMenuTrigger>Products</NavigationMenuTrigger>\n              <NavigationMenuIndicator\n                className='custom-indicator'\n                data-testid='nav-indicator'\n              />\n            </NavigationMenuItem>\n          </NavigationMenuList>\n        </NavigationMenu>,\n      );\n\n      // Verify component can accept props\n      expect(NavigationMenuIndicator).toBeDefined();\n    });\n\n    it('can be used within navigation menu structure', () => {\n      // Test that the component can be used within the proper structure\n      render(\n        <NavigationMenu>\n          <NavigationMenuList>\n            <NavigationMenuItem>\n              <NavigationMenuTrigger>Products</NavigationMenuTrigger>\n              <NavigationMenuIndicator />\n            </NavigationMenuItem>\n          </NavigationMenuList>\n        </NavigationMenu>,\n      );\n\n      // Verify the navigation structure renders without errors\n      const trigger = screen.getByText('Products');\n      expect(trigger).toBeInTheDocument();\n    });\n  });\n\n  describe('navigationMenuTriggerStyle', () => {\n    it('returns trigger style classes', () => {\n      const styles = navigationMenuTriggerStyle();\n      expect(styles).toContain('group');\n      expect(styles).toContain('bg-background');\n      expect(styles).toContain('hover:bg-accent');\n      expect(styles).toContain('inline-flex');\n    });\n\n    it('accepts variant options', () => {\n      // Test that the cva function works\n      const styles = navigationMenuTriggerStyle();\n      expect(typeof styles).toBe('string');\n      expect(styles.length).toBeGreaterThan(0);\n    });\n  });\n\n  describe('Accessibility', () => {\n    it('supports keyboard navigation', async () => {\n      // Mock ResizeObserver to prevent errors during keyboard navigation\n      const mockResizeObserver = vi.fn().mockImplementation(() => ({\n        observe: vi.fn(),\n        unobserve: vi.fn(),\n        disconnect: vi.fn(),\n      }));\n      global.ResizeObserver = mockResizeObserver;\n\n      render(\n        <NavigationMenu>\n          <NavigationMenuList>\n            <NavigationMenuItem>\n              <NavigationMenuTrigger data-testid='nav-trigger'>\n                Products\n              </NavigationMenuTrigger>\n              <NavigationMenuContent>\n                <NavigationMenuLink\n                  href='/product1'\n                  data-testid='nav-link-1'\n                >\n                  Product 1\n                </NavigationMenuLink>\n                <NavigationMenuLink\n                  href='/product2'\n                  data-testid='nav-link-2'\n                >\n                  Product 2\n                </NavigationMenuLink>\n              </NavigationMenuContent>\n            </NavigationMenuItem>\n          </NavigationMenuList>\n        </NavigationMenu>,\n      );\n\n      const trigger = screen.getByTestId('nav-trigger');\n\n      // Focus the trigger\n      trigger.focus();\n      expect(trigger).toHaveFocus();\n\n      // Press Enter to activate - just verify no errors occur\n      await user.keyboard('{Enter}');\n      expect(trigger).toBeInTheDocument();\n    });\n\n    it('provides proper ARIA attributes', () => {\n      render(\n        <NavigationMenu>\n          <NavigationMenuList>\n            <NavigationMenuItem>\n              <NavigationMenuTrigger data-testid='nav-trigger'>\n                Products\n              </NavigationMenuTrigger>\n              <NavigationMenuContent data-testid='nav-content'>\n                <NavigationMenuLink\n                  href='/products'\n                  data-testid='nav-link'\n                >\n                  View All Products\n                </NavigationMenuLink>\n              </NavigationMenuContent>\n            </NavigationMenuItem>\n          </NavigationMenuList>\n        </NavigationMenu>,\n      );\n\n      const trigger = screen.getByTestId('nav-trigger');\n      const chevronIcon = screen.getByTestId('chevron-down-icon');\n\n      expect(chevronIcon).toHaveAttribute('aria-hidden', 'true');\n      expect(trigger).toBeInTheDocument();\n    });\n\n    it('handles focus management', async () => {\n      render(\n        <NavigationMenu>\n          <NavigationMenuList>\n            <NavigationMenuItem>\n              <NavigationMenuTrigger data-testid='nav-trigger'>\n                Products\n              </NavigationMenuTrigger>\n              <NavigationMenuContent>\n                <NavigationMenuLink\n                  href='/product1'\n                  data-testid='nav-link-1'\n                >\n                  Product 1\n                </NavigationMenuLink>\n              </NavigationMenuContent>\n            </NavigationMenuItem>\n          </NavigationMenuList>\n        </NavigationMenu>,\n      );\n\n      const trigger = screen.getByTestId('nav-trigger');\n\n      // Tab to the trigger\n      await user.tab();\n      expect(trigger).toHaveFocus();\n    });\n  });\n\n  describe('Integration', () => {\n    it('works with complex navigation structure', () => {\n      render(\n        <NavigationMenu data-testid='main-nav'>\n          <NavigationMenuList>\n            <NavigationMenuItem>\n              <NavigationMenuTrigger>Products</NavigationMenuTrigger>\n              <NavigationMenuContent>\n                <NavigationMenuLink href='/product1'>\n                  Product 1\n                </NavigationMenuLink>\n                <NavigationMenuLink href='/product2'>\n                  Product 2\n                </NavigationMenuLink>\n              </NavigationMenuContent>\n            </NavigationMenuItem>\n            <NavigationMenuItem>\n              <NavigationMenuTrigger>Services</NavigationMenuTrigger>\n              <NavigationMenuContent>\n                <NavigationMenuLink href='/service1'>\n                  Service 1\n                </NavigationMenuLink>\n                <NavigationMenuLink href='/service2'>\n                  Service 2\n                </NavigationMenuLink>\n              </NavigationMenuContent>\n            </NavigationMenuItem>\n            <NavigationMenuItem>\n              <NavigationMenuLink href='/about'>About</NavigationMenuLink>\n            </NavigationMenuItem>\n          </NavigationMenuList>\n        </NavigationMenu>,\n      );\n\n      const mainNav = screen.getByTestId('main-nav');\n      expect(mainNav).toBeInTheDocument();\n\n      expect(screen.getByText('Products')).toBeInTheDocument();\n      expect(screen.getByText('Services')).toBeInTheDocument();\n      expect(screen.getByText('About')).toBeInTheDocument();\n    });\n\n    it('handles multiple navigation items', () => {\n      render(\n        <NavigationMenu>\n          <NavigationMenuList>\n            {['Home', 'Products', 'Services', 'Contact'].map((item) => (\n              <NavigationMenuItem key={item}>\n                <NavigationMenuLink href={`/${item.toLowerCase()}`}>\n                  {item}\n                </NavigationMenuLink>\n              </NavigationMenuItem>\n            ))}\n          </NavigationMenuList>\n        </NavigationMenu>,\n      );\n\n      expect(screen.getByText('Home')).toBeInTheDocument();\n      expect(screen.getByText('Products')).toBeInTheDocument();\n      expect(screen.getByText('Services')).toBeInTheDocument();\n      expect(screen.getByText('Contact')).toBeInTheDocument();\n    });\n  });\n\n  describe('Edge Cases', () => {\n    it('handles empty navigation menu', () => {\n      render(\n        <NavigationMenu data-testid='empty-nav'>\n          <NavigationMenuList />\n        </NavigationMenu>,\n      );\n\n      const nav = screen.getByTestId('empty-nav');\n      expect(nav).toBeInTheDocument();\n    });\n\n    it('handles navigation without viewport', () => {\n      render(\n        <NavigationMenu\n          viewport={false}\n          data-testid='no-viewport-nav'\n        >\n          <NavigationMenuList>\n            <NavigationMenuItem>\n              <NavigationMenuTrigger>Item</NavigationMenuTrigger>\n            </NavigationMenuItem>\n          </NavigationMenuList>\n        </NavigationMenu>,\n      );\n\n      const nav = screen.getByTestId('no-viewport-nav');\n      expect(nav).toHaveAttribute('data-viewport', 'false');\n    });\n\n    it('handles missing children gracefully', () => {\n      render(\n        <NavigationMenu data-testid='minimal-nav'>\n          <NavigationMenuList>\n            <NavigationMenuItem>\n              <NavigationMenuTrigger />\n            </NavigationMenuItem>\n          </NavigationMenuList>\n        </NavigationMenu>,\n      );\n\n      const nav = screen.getByTestId('minimal-nav');\n      expect(nav).toBeInTheDocument();\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/separator.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/sheet-accessibility.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/sheet-basic.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/sheet-content.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/sheet-edge-cases.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/sheet-integration.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/sheet-text-components.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/social-icons-accessibility-basic.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/social-icons-accessibility-features.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/social-icons-accessibility-i18n.test.tsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'user' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":20,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":47},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'user' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":20,"column":7,"nodeType":null,"messageId":"unusedVar","endLine":20,"endColumn":11}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Social Icons Accessibility - Internationalization Tests\n *\n * 专门测试国际化可访问性功能，包括：\n * - 多语言支持\n * - 右到左语言\n * - 语言特定的ARIA标签\n * - 文化适应性\n */\n\nimport { render, screen } from '@testing-library/react';\nimport userEvent from '@testing-library/user-event';\nimport { beforeEach, describe, expect, it } from 'vitest';\n\nimport {\n  SocialIconLink,\n} from '../social-icons';\n\ndescribe('Social Icons Accessibility - Internationalization Tests', () => {\n  let user: ReturnType<typeof userEvent.setup>;\n\n  beforeEach(() => {\n    user = userEvent.setup();\n  });\n\n  describe('多语言支持', () => {\n    it('supports internationalization', () => {\n      render(\n        <div lang='es'>\n          <SocialIconLink\n            href='https://twitter.com/example'\n            platform='twitter'\n            aria-label='Síguenos en Twitter'\n            data-testid='social-link'\n          />\n        </div>\n      );\n\n      const link = screen.getByTestId('social-link');\n      expect(link).toHaveAttribute('aria-label', 'Síguenos en Twitter');\n    });\n\n    it('supports French language labels', () => {\n      render(\n        <div lang='fr'>\n          <SocialIconLink\n            href='https://twitter.com/example'\n            platform='twitter'\n            aria-label='Suivez-nous sur Twitter'\n            data-testid='social-link'\n          />\n        </div>\n      );\n\n      const link = screen.getByTestId('social-link');\n      expect(link).toHaveAttribute('aria-label', 'Suivez-nous sur Twitter');\n    });\n\n    it('supports German language labels', () => {\n      render(\n        <div lang='de'>\n          <SocialIconLink\n            href='https://twitter.com/example'\n            platform='twitter'\n            aria-label='Folgen Sie uns auf Twitter'\n            data-testid='social-link'\n          />\n        </div>\n      );\n\n      const link = screen.getByTestId('social-link');\n      expect(link).toHaveAttribute('aria-label', 'Folgen Sie uns auf Twitter');\n    });\n\n    it('supports Japanese language labels', () => {\n      render(\n        <div lang='ja'>\n          <SocialIconLink\n            href='https://twitter.com/example'\n            platform='twitter'\n            aria-label='Twitterでフォロー'\n            data-testid='social-link'\n          />\n        </div>\n      );\n\n      const link = screen.getByTestId('social-link');\n      expect(link).toHaveAttribute('aria-label', 'Twitterでフォロー');\n    });\n\n    it('supports Chinese language labels', () => {\n      render(\n        <div lang='zh'>\n          <SocialIconLink\n            href='https://twitter.com/example'\n            platform='twitter'\n            aria-label='在Twitter上关注我们'\n            data-testid='social-link'\n          />\n        </div>\n      );\n\n      const link = screen.getByTestId('social-link');\n      expect(link).toHaveAttribute('aria-label', '在Twitter上关注我们');\n    });\n\n    it('supports Korean language labels', () => {\n      render(\n        <div lang='ko'>\n          <SocialIconLink\n            href='https://twitter.com/example'\n            platform='twitter'\n            aria-label='트위터에서 팔로우하기'\n            data-testid='social-link'\n          />\n        </div>\n      );\n\n      const link = screen.getByTestId('social-link');\n      expect(link).toHaveAttribute('aria-label', '트위터에서 팔로우하기');\n    });\n\n    it('supports Portuguese language labels', () => {\n      render(\n        <div lang='pt'>\n          <SocialIconLink\n            href='https://twitter.com/example'\n            platform='twitter'\n            aria-label='Siga-nos no Twitter'\n            data-testid='social-link'\n          />\n        </div>\n      );\n\n      const link = screen.getByTestId('social-link');\n      expect(link).toHaveAttribute('aria-label', 'Siga-nos no Twitter');\n    });\n\n    it('supports Italian language labels', () => {\n      render(\n        <div lang='it'>\n          <SocialIconLink\n            href='https://twitter.com/example'\n            platform='twitter'\n            aria-label='Seguici su Twitter'\n            data-testid='social-link'\n          />\n        </div>\n      );\n\n      const link = screen.getByTestId('social-link');\n      expect(link).toHaveAttribute('aria-label', 'Seguici su Twitter');\n    });\n\n    it('supports Russian language labels', () => {\n      render(\n        <div lang='ru'>\n          <SocialIconLink\n            href='https://twitter.com/example'\n            platform='twitter'\n            aria-label='Подписывайтесь на нас в Twitter'\n            data-testid='social-link'\n          />\n        </div>\n      );\n\n      const link = screen.getByTestId('social-link');\n      expect(link).toHaveAttribute('aria-label', 'Подписывайтесь на нас в Twitter');\n    });\n\n    it('supports Dutch language labels', () => {\n      render(\n        <div lang='nl'>\n          <SocialIconLink\n            href='https://twitter.com/example'\n            platform='twitter'\n            aria-label='Volg ons op Twitter'\n            data-testid='social-link'\n          />\n        </div>\n      );\n\n      const link = screen.getByTestId('social-link');\n      expect(link).toHaveAttribute('aria-label', 'Volg ons op Twitter');\n    });\n  });\n\n  describe('右到左语言', () => {\n    it('handles right-to-left languages', () => {\n      render(\n        <div dir='rtl' lang='ar'>\n          <SocialIconLink\n            href='https://twitter.com/example'\n            platform='twitter'\n            aria-label='تويتر'\n            data-testid='social-link'\n          />\n        </div>\n      );\n\n      const container = screen.getByTestId('social-link').closest('div');\n      const link = screen.getByTestId('social-link');\n\n      expect(container).toHaveAttribute('dir', 'rtl');\n      expect(container).toHaveAttribute('lang', 'ar');\n      expect(link).toHaveAttribute('aria-label', 'تويتر');\n    });\n\n    it('supports Hebrew RTL layout', () => {\n      render(\n        <div dir='rtl' lang='he'>\n          <SocialIconLink\n            href='https://twitter.com/example'\n            platform='twitter'\n            aria-label='עקבו אחרינו בטוויטר'\n            data-testid='social-link'\n          />\n        </div>\n      );\n\n      const container = screen.getByTestId('social-link').closest('div');\n      const link = screen.getByTestId('social-link');\n\n      expect(container).toHaveAttribute('dir', 'rtl');\n      expect(container).toHaveAttribute('lang', 'he');\n      expect(link).toHaveAttribute('aria-label', 'עקבו אחרינו בטוויטר');\n    });\n\n    it('supports Persian RTL layout', () => {\n      render(\n        <div dir='rtl' lang='fa'>\n          <SocialIconLink\n            href='https://twitter.com/example'\n            platform='twitter'\n            aria-label='ما را در توییتر دنبال کنید'\n            data-testid='social-link'\n          />\n        </div>\n      );\n\n      const container = screen.getByTestId('social-link').closest('div');\n      const link = screen.getByTestId('social-link');\n\n      expect(container).toHaveAttribute('dir', 'rtl');\n      expect(container).toHaveAttribute('lang', 'fa');\n      expect(link).toHaveAttribute('aria-label', 'ما را در توییتر دنبال کنید');\n    });\n\n    it('supports Urdu RTL layout', () => {\n      render(\n        <div dir='rtl' lang='ur'>\n          <SocialIconLink\n            href='https://twitter.com/example'\n            platform='twitter'\n            aria-label='ٹویٹر پر ہمیں فالو کریں'\n            data-testid='social-link'\n          />\n        </div>\n      );\n\n      const container = screen.getByTestId('social-link').closest('div');\n      const link = screen.getByTestId('social-link');\n\n      expect(container).toHaveAttribute('dir', 'rtl');\n      expect(container).toHaveAttribute('lang', 'ur');\n      expect(link).toHaveAttribute('aria-label', 'ٹویٹر پر ہمیں فالو کریں');\n    });\n  });\n\n  describe('语言特定的ARIA标签', () => {\n    it('provides platform-specific labels in different languages', () => {\n      render(\n        <div>\n          <div lang='es'>\n            <SocialIconLink\n              href='https://linkedin.com/in/example'\n              platform='linkedin'\n              aria-label='Conéctate en LinkedIn'\n              data-testid='linkedin-es'\n            />\n          </div>\n          <div lang='fr'>\n            <SocialIconLink\n              href='https://linkedin.com/in/example'\n              platform='linkedin'\n              aria-label='Connectez-vous sur LinkedIn'\n              data-testid='linkedin-fr'\n            />\n          </div>\n        </div>\n      );\n\n      const linkedinEs = screen.getByTestId('linkedin-es');\n      const linkedinFr = screen.getByTestId('linkedin-fr');\n\n      expect(linkedinEs).toHaveAttribute('aria-label', 'Conéctate en LinkedIn');\n      expect(linkedinFr).toHaveAttribute('aria-label', 'Connectez-vous sur LinkedIn');\n    });\n\n    it('supports multiple social platforms in different languages', () => {\n      render(\n        <div lang='de'>\n          <SocialIconLink\n            href='https://twitter.com/example'\n            platform='twitter'\n            aria-label='Twitter folgen'\n            data-testid='twitter-de'\n          />\n          <SocialIconLink\n            href='https://linkedin.com/in/example'\n            platform='linkedin'\n            aria-label='LinkedIn verbinden'\n            data-testid='linkedin-de'\n          />\n        </div>\n      );\n\n      const twitterDe = screen.getByTestId('twitter-de');\n      const linkedinDe = screen.getByTestId('linkedin-de');\n\n      expect(twitterDe).toHaveAttribute('aria-label', 'Twitter folgen');\n      expect(linkedinDe).toHaveAttribute('aria-label', 'LinkedIn verbinden');\n    });\n  });\n\n  describe('文化适应性', () => {\n    it('adapts to cultural reading patterns', () => {\n      render(\n        <div dir='rtl' lang='ar' className='text-right'>\n          <SocialIconLink\n            href='https://twitter.com/example'\n            platform='twitter'\n            aria-label='تابعونا على تويتر'\n            data-testid='social-link'\n          />\n        </div>\n      );\n\n      const container = screen.getByTestId('social-link').closest('div');\n      expect(container).toHaveClass('text-right');\n    });\n\n    it('supports locale-specific formatting', () => {\n      render(\n        <div lang='ja' className='font-japanese'>\n          <SocialIconLink\n            href='https://twitter.com/example'\n            platform='twitter'\n            aria-label='Twitterをフォロー'\n            data-testid='social-link'\n          />\n        </div>\n      );\n\n      const container = screen.getByTestId('social-link').closest('div');\n      expect(container).toHaveClass('font-japanese');\n    });\n\n    it('handles mixed language content', () => {\n      render(\n        <div>\n          <div lang='en'>\n            <SocialIconLink\n              href='https://twitter.com/example'\n              platform='twitter'\n              aria-label='Follow us on Twitter'\n              data-testid='twitter-en'\n            />\n          </div>\n          <div lang='zh'>\n            <SocialIconLink\n              href='https://twitter.com/example'\n              platform='twitter'\n              aria-label='在Twitter上关注我们'\n              data-testid='twitter-zh'\n            />\n          </div>\n        </div>\n      );\n\n      const twitterEn = screen.getByTestId('twitter-en');\n      const twitterZh = screen.getByTestId('twitter-zh');\n\n      expect(twitterEn).toHaveAttribute('aria-label', 'Follow us on Twitter');\n      expect(twitterZh).toHaveAttribute('aria-label', '在Twitter上关注我们');\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/social-icons-accessibility-integration-core.test.tsx","messages":[{"ruleId":"security/detect-object-injection","severity":2,"message":"Variable Assigned to Object Injection Sink","line":318,"column":35,"nodeType":"MemberExpression","endLine":318,"endColumn":47}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @vitest-environment jsdom\n */\n\n/**\n * Social Icons Accessibility & Integration - Core Tests\n *\n * 核心可访问性和集成测试，包括：\n * - 基本可访问性功能\n * - 核心集成场景\n * - 基础交互测试\n */\n\nimport { render, screen } from '@testing-library/react';\nimport userEvent from '@testing-library/user-event';\nimport { beforeEach, describe, expect, it, vi } from 'vitest';\nimport {\n  ExternalLinkIcon,\n  LinkedInIcon,\n  SocialIconLink,\n  SocialIconMapper,\n  TwitterIcon,\n} from '../social-icons';\n\ndescribe('Social Icons Accessibility & Integration - Core Tests', () => {\n  let user: ReturnType<typeof userEvent.setup>;\n\n  beforeEach(() => {\n    user = userEvent.setup();\n  });\n\n  describe('Basic Accessibility Features', () => {\n    it('provides accessible names for social links', () => {\n      render(\n        <div>\n          <SocialIconLink href='https://twitter.com/test' platform='twitter'>\n            <TwitterIcon />\n          </SocialIconLink>\n          <SocialIconLink href='https://linkedin.com/in/test' platform='linkedin'>\n            <LinkedInIcon />\n          </SocialIconLink>\n        </div>\n      );\n\n      const twitterLink = screen.getByRole('link', { name: /twitter/i });\n      const linkedinLink = screen.getByRole('link', { name: /linkedin/i });\n\n      expect(twitterLink).toBeInTheDocument();\n      expect(linkedinLink).toBeInTheDocument();\n    });\n\n    it('has proper ARIA attributes', () => {\n      render(\n        <SocialIconLink href='https://twitter.com/test' platform='twitter'>\n          <TwitterIcon />\n        </SocialIconLink>\n      );\n\n      const link = screen.getByRole('link');\n      expect(link).toHaveAttribute('href', 'https://twitter.com/test');\n      expect(link).toHaveAttribute('target', '_blank');\n      expect(link).toHaveAttribute('rel', 'noopener noreferrer');\n    });\n\n    it('supports keyboard navigation', async () => {\n      render(\n        <div>\n          <SocialIconLink href='https://twitter.com/test' platform='twitter'>\n            <TwitterIcon />\n          </SocialIconLink>\n          <SocialIconLink href='https://linkedin.com/in/test' platform='linkedin'>\n            <LinkedInIcon />\n          </SocialIconLink>\n        </div>\n      );\n\n      const twitterLink = screen.getByRole('link', { name: /twitter/i });\n      const linkedinLink = screen.getByRole('link', { name: /linkedin/i });\n\n      // Test tab navigation\n      twitterLink.focus();\n      expect(twitterLink).toHaveFocus();\n\n      await user.tab();\n      expect(linkedinLink).toHaveFocus();\n    });\n\n    it('handles external link indicators', () => {\n      render(\n        <SocialIconLink href='https://external.com' platform='external'>\n          <ExternalLinkIcon />\n        </SocialIconLink>\n      );\n\n      const link = screen.getByRole('link');\n      expect(link).toHaveAttribute('target', '_blank');\n      expect(link).toHaveAttribute('rel', 'noopener noreferrer');\n    });\n  });\n\n  describe('Core Integration Scenarios', () => {\n    it('works with SocialIconMapper', () => {\n      const socialLinks = [\n        { platform: 'twitter', url: 'https://twitter.com/test' },\n        { platform: 'linkedin', url: 'https://linkedin.com/in/test' },\n      ];\n\n      render(\n        <div>\n          {socialLinks.map((link) => (\n            <SocialIconMapper\n              key={link.platform}\n              platform={link.platform}\n              href={link.url}\n            />\n          ))}\n        </div>\n      );\n\n      expect(screen.getByRole('link', { name: /twitter/i })).toBeInTheDocument();\n      expect(screen.getByRole('link', { name: /linkedin/i })).toBeInTheDocument();\n    });\n\n    it('handles multiple social icons in navigation', () => {\n      render(\n        <nav aria-label='Social Media Links'>\n          <SocialIconLink href='https://twitter.com/test' platform='twitter'>\n            <TwitterIcon />\n          </SocialIconLink>\n          <SocialIconLink href='https://linkedin.com/in/test' platform='linkedin'>\n            <LinkedInIcon />\n          </SocialIconLink>\n        </nav>\n      );\n\n      const navigation = screen.getByRole('navigation', { name: 'Social Media Links' });\n      expect(navigation).toBeInTheDocument();\n\n      const links = screen.getAllByRole('link');\n      expect(links).toHaveLength(2);\n    });\n\n    it('works in footer context', () => {\n      render(\n        <footer>\n          <div>\n            <h3>Follow Us</h3>\n            <SocialIconLink href='https://twitter.com/test' platform='twitter'>\n              <TwitterIcon />\n            </SocialIconLink>\n            <SocialIconLink href='https://linkedin.com/in/test' platform='linkedin'>\n              <LinkedInIcon />\n            </SocialIconLink>\n          </div>\n        </footer>\n      );\n\n      const footer = screen.getByRole('contentinfo');\n      expect(footer).toBeInTheDocument();\n\n      const heading = screen.getByRole('heading', { name: 'Follow Us' });\n      expect(heading).toBeInTheDocument();\n\n      const links = screen.getAllByRole('link');\n      expect(links).toHaveLength(2);\n    });\n\n    it('handles responsive layout integration', () => {\n      render(\n        <div className='flex flex-wrap gap-4'>\n          <SocialIconLink href='https://twitter.com/test' platform='twitter'>\n            <TwitterIcon />\n          </SocialIconLink>\n          <SocialIconLink href='https://linkedin.com/in/test' platform='linkedin'>\n            <LinkedInIcon />\n          </SocialIconLink>\n        </div>\n      );\n\n      const container = screen.getByRole('generic');\n      expect(container).toHaveClass('flex', 'flex-wrap', 'gap-4');\n\n      const links = screen.getAllByRole('link');\n      expect(links).toHaveLength(2);\n    });\n  });\n\n  describe('Interactive Behavior', () => {\n    it('handles click events', async () => {\n      const mockOpen = vi.fn();\n      Object.defineProperty(window, 'open', {\n        writable: true,\n        value: mockOpen,\n      });\n\n      render(\n        <SocialIconLink href='https://twitter.com/test' platform='twitter'>\n          <TwitterIcon />\n        </SocialIconLink>\n      );\n\n      const link = screen.getByRole('link');\n      await user.click(link);\n\n      // Note: In real browser, this would open a new tab\n      // In test environment, we just verify the link is clickable\n      expect(link).toBeInTheDocument();\n    });\n\n    it('handles keyboard activation', async () => {\n      render(\n        <SocialIconLink href='https://twitter.com/test' platform='twitter'>\n          <TwitterIcon />\n        </SocialIconLink>\n      );\n\n      const link = screen.getByRole('link');\n      link.focus();\n\n      await user.keyboard('{Enter}');\n      expect(link).toBeInTheDocument();\n    });\n\n    it('provides hover states', async () => {\n      render(\n        <SocialIconLink href='https://twitter.com/test' platform='twitter'>\n          <TwitterIcon />\n        </SocialIconLink>\n      );\n\n      const link = screen.getByRole('link');\n      \n      await user.hover(link);\n      expect(link).toBeInTheDocument();\n\n      await user.unhover(link);\n      expect(link).toBeInTheDocument();\n    });\n  });\n\n  describe('Error Handling', () => {\n    it('handles missing href gracefully', () => {\n      render(\n        <SocialIconLink href='' platform='twitter'>\n          <TwitterIcon />\n        </SocialIconLink>\n      );\n\n      const link = screen.getByRole('link');\n      expect(link).toHaveAttribute('href', '');\n    });\n\n    it('handles unknown platform gracefully', () => {\n      render(\n        <SocialIconLink href='https://example.com' platform='unknown'>\n          <ExternalLinkIcon />\n        </SocialIconLink>\n      );\n\n      const link = screen.getByRole('link');\n      expect(link).toBeInTheDocument();\n    });\n\n    it('handles missing children gracefully', () => {\n      render(\n        <SocialIconLink href='https://twitter.com/test' platform='twitter'>\n          {/* No children */}\n        </SocialIconLink>\n      );\n\n      const link = screen.getByRole('link');\n      expect(link).toBeInTheDocument();\n    });\n  });\n\n  describe('Theme Integration', () => {\n    it('applies theme classes correctly', () => {\n      render(\n        <div className='dark'>\n          <SocialIconLink href='https://twitter.com/test' platform='twitter'>\n            <TwitterIcon />\n          </SocialIconLink>\n        </div>\n      );\n\n      const container = screen.getByRole('generic');\n      expect(container).toHaveClass('dark');\n\n      const link = screen.getByRole('link');\n      expect(link).toBeInTheDocument();\n    });\n\n    it('handles light theme', () => {\n      render(\n        <div className='light'>\n          <SocialIconLink href='https://twitter.com/test' platform='twitter'>\n            <TwitterIcon />\n          </SocialIconLink>\n        </div>\n      );\n\n      const container = screen.getByRole('generic');\n      expect(container).toHaveClass('light');\n\n      const link = screen.getByRole('link');\n      expect(link).toBeInTheDocument();\n    });\n  });\n\n  describe('Performance Considerations', () => {\n    it('renders multiple icons efficiently', () => {\n      const platforms = ['twitter', 'linkedin', 'external'];\n      const icons = [TwitterIcon, LinkedInIcon, ExternalLinkIcon];\n\n      render(\n        <div>\n          {platforms.map((platform, index) => {\n            const IconComponent = icons[index];\n            return (\n              <SocialIconLink\n                key={platform}\n                href={`https://${platform}.com/test`}\n                platform={platform}\n              >\n                <IconComponent />\n              </SocialIconLink>\n            );\n          })}\n        </div>\n      );\n\n      const links = screen.getAllByRole('link');\n      expect(links).toHaveLength(3);\n    });\n\n    it('handles re-renders without issues', () => {\n      const { rerender } = render(\n        <SocialIconLink href='https://twitter.com/test' platform='twitter'>\n          <TwitterIcon />\n        </SocialIconLink>\n      );\n\n      expect(screen.getByRole('link')).toBeInTheDocument();\n\n      rerender(\n        <SocialIconLink href='https://twitter.com/updated' platform='twitter'>\n          <TwitterIcon />\n        </SocialIconLink>\n      );\n\n      const link = screen.getByRole('link');\n      expect(link).toHaveAttribute('href', 'https://twitter.com/updated');\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/social-icons-accessibility-integration.test.tsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Declaration or statement expected.","line":121,"column":2}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @vitest-environment jsdom\n */\n\n/**\n * Social Icons Accessibility & Integration Tests - Index\n *\n * Basic integration tests for the Social Icons component accessibility and integration.\n * For comprehensive testing, see:\n * - social-icons-accessibility-features.test.tsx - Accessibility features tests\n * - social-icons-integration-scenarios.test.tsx - Integration scenarios tests\n */\n\nimport { render, screen } from '@testing-library/react';\nimport userEvent from '@testing-library/user-event';\nimport { beforeEach, describe, expect, it, vi } from 'vitest';\nimport {\n  ExternalLinkIcon,\n  LinkedInIcon,\n  SocialIconLink,\n  SocialIconMapper,\n  TwitterIcon,\n} from '../social-icons';\n\ndescribe('Social Icons Accessibility & Integration - Advanced Tests', () => {\n  let user: ReturnType<typeof userEvent.setup>;\n\n  beforeEach(() => {\n    user = userEvent.setup();\n  });\n\n  describe('Complex Integration Scenarios', () => {\n    it('handles advanced accessibility patterns with screen readers', async () => {\n      render(\n        <section aria-labelledby='social-heading'>\n          <h2 id='social-heading'>Connect With Us</h2>\n          <div role='list' aria-label='Social media links'>\n            <div role='listitem'>\n              <SocialIconLink href='https://twitter.com/test' platform='twitter'>\n                <TwitterIcon />\n              </SocialIconLink>\n            </div>\n            <div role='listitem'>\n              <SocialIconLink href='https://linkedin.com/in/test' platform='linkedin'>\n                <LinkedInIcon />\n              </SocialIconLink>\n            </div>\n          </div>\n        </section>\n      );\n\n      const section = screen.getByRole('region');\n      const heading = screen.getByRole('heading', { name: 'Connect With Us' });\n      const socialList = screen.getByRole('list', { name: 'Social media links' });\n      const listItems = screen.getAllByRole('listitem');\n\n      expect(section).toHaveAttribute('aria-labelledby', 'social-heading');\n      expect(heading).toBeInTheDocument();\n      expect(socialList).toBeInTheDocument();\n      expect(listItems).toHaveLength(2);\n\n      // Test keyboard navigation through the list\n      const links = screen.getAllByRole('link');\n      for (const link of links) {\n        link.focus();\n        expect(link).toHaveFocus();\n        await user.tab();\n      }\n    });\n\n    it('handles complex dynamic social media integration', async () => {\n      const socialPlatforms = [\n        { name: 'twitter', url: 'https://twitter.com/company', icon: TwitterIcon },\n        { name: 'linkedin', url: 'https://linkedin.com/company/test', icon: LinkedInIcon },\n        { name: 'external', url: 'https://blog.company.com', icon: ExternalLinkIcon },\n      ];\n\n      render(\n        <div>\n          <h3>Follow Our Journey</h3>\n          <div className='social-grid'>\n            {socialPlatforms.map(({ name, url, icon: IconComponent }) => (\n              <div key={name} className='social-item'>\n                <SocialIconLink href={url} platform={name}>\n                  <IconComponent />\n                </SocialIconLink>\n                <span className='platform-name'>{name}</span>\n              </div>\n            ))}\n          </div>\n        </div>\n      );\n\n      // Test all platforms are rendered\n      const links = screen.getAllByRole('link');\n      expect(links).toHaveLength(3);\n\n      // Test each platform has correct attributes\n      socialPlatforms.forEach(({ name, url }) => {\n        const link = screen.getByRole('link', { name: new RegExp(name, 'i') });\n        expect(link).toHaveAttribute('href', url);\n        expect(link).toHaveAttribute('target', '_blank');\n      });\n    });\n  });\n});\n    render(\n      <SocialIconLink\n        href='https://twitter.com/example'\n        platform='twitter'\n        aria-label='Twitter'\n        target='_blank'\n        rel='noopener noreferrer'\n        data-testid='external-link'\n      />\n    );\n\n    const link = screen.getByTestId('external-link');\n    expect(link).toHaveAttribute('target', '_blank');\n    expect(link).toHaveAttribute('rel', 'noopener noreferrer');\n  });\n\n  it('supports keyboard navigation between links', async () => {\n    render(\n      <div>\n        <SocialIconLink\n          href='https://twitter.com/example'\n          platform='twitter'\n          aria-label='Twitter profile'\n          data-testid='twitter-link'\n        />\n        <SocialIconLink\n          href='https://linkedin.com/in/example'\n          platform='linkedin'\n          aria-label='LinkedIn profile'\n          data-testid='linkedin-link'\n        />\n      </div>\n    );\n\n    const twitterLink = screen.getByTestId('twitter-link');\n    const linkedinLink = screen.getByTestId('linkedin-link');\n\n    // Should be able to tab between links\n    await user.tab();\n    expect(twitterLink).toHaveFocus();\n\n    await user.tab();\n    expect(linkedinLink).toHaveFocus();\n  });\n\n  it('supports high contrast mode', () => {\n    render(\n      <TwitterIcon\n        className='forced-colors:text-[ButtonText]'\n        data-testid='twitter'\n      />\n    );\n\n    const icon = screen.getByTestId('twitter');\n    expect(icon).toHaveClass('forced-colors:text-[ButtonText]');\n  });\n\n  it('supports reduced motion preferences', () => {\n    render(\n      <SocialIconLink\n        href='https://twitter.com/example'\n        platform='twitter'\n        aria-label='Twitter'\n        className='motion-reduce:transition-none'\n        data-testid='social-link'\n      />\n    );\n\n    const link = screen.getByTestId('social-link');\n    expect(link).toHaveClass('motion-reduce:transition-none');\n  });\n\n  it('provides proper focus indicators', () => {\n    render(\n      <SocialIconLink\n        href='https://twitter.com/example'\n        platform='twitter'\n        aria-label='Twitter'\n        className='focus:ring-2 focus:ring-offset-2'\n        data-testid='social-link'\n      />\n    );\n\n    const link = screen.getByTestId('social-link');\n    expect(link).toHaveClass('focus:ring-2', 'focus:ring-offset-2');\n  });\n\n  it('handles keyboard activation', async () => {\n    const handleClick = vi.fn();\n    render(\n      <SocialIconLink\n        href='https://twitter.com/example'\n        platform='twitter'\n        aria-label='Twitter'\n        _onClick={handleClick}\n        data-testid='social-link'\n      />\n    );\n\n    const link = screen.getByTestId('social-link');\n\n    await user.tab();\n    expect(link).toHaveFocus();\n\n    await user.keyboard('{Enter}');\n    expect(handleClick).toHaveBeenCalled();\n  });\n\n  it('supports internationalization', () => {\n    render(\n      <div lang='es'>\n        <SocialIconLink\n          href='https://twitter.com/example'\n          platform='twitter'\n          aria-label='Síguenos en Twitter'\n          data-testid='social-link'\n        />\n      </div>\n    );\n\n    const link = screen.getByTestId('social-link');\n    expect(link).toHaveAttribute('aria-label', 'Síguenos en Twitter');\n  });\n\n  it('works in navigation menus', () => {\n    render(\n      <nav aria-label='Social media links'>\n        <ul>\n          <li>\n            <SocialIconLink\n              href='https://twitter.com/example'\n              platform='twitter'\n              aria-label='Twitter'\n              data-testid='nav-twitter'\n            />\n          </li>\n          <li>\n            <SocialIconLink\n              href='https://linkedin.com/in/example'\n              platform='linkedin'\n              aria-label='LinkedIn'\n              data-testid='nav-linkedin'\n            />\n          </li>\n        </ul>\n      </nav>\n    );\n\n    const nav = screen.getByRole('navigation');\n    expect(nav).toHaveAttribute('aria-label', 'Social media links');\n\n    const twitterLink = screen.getByTestId('nav-twitter');\n    const linkedinLink = screen.getByTestId('nav-linkedin');\n\n    expect(twitterLink).toBeInTheDocument();\n    expect(linkedinLink).toBeInTheDocument();\n  });\n\n  it('works in footer sections', () => {\n    render(\n      <footer>\n        <section aria-labelledby='social-heading'>\n          <h3 id='social-heading'>Follow Us</h3>\n          <div className='flex space-x-4'>\n            <SocialIconLink\n              href='https://twitter.com/example'\n              platform='twitter'\n              aria-label='Twitter'\n              data-testid='footer-twitter'\n            />\n            <SocialIconLink\n              href='https://linkedin.com/in/example'\n              platform='linkedin'\n              aria-label='LinkedIn'\n              data-testid='footer-linkedin'\n            />\n          </div>\n        </section>\n      </footer>\n    );\n\n    const section = screen.getByRole('region');\n    expect(section).toHaveAttribute('aria-labelledby', 'social-heading');\n\n    const heading = screen.getByText('Follow Us');\n    expect(heading).toBeInTheDocument();\n\n    const twitterLink = screen.getByTestId('footer-twitter');\n    const linkedinLink = screen.getByTestId('footer-linkedin');\n\n    expect(twitterLink).toBeInTheDocument();\n    expect(linkedinLink).toBeInTheDocument();\n  });\n\n  it('works with dynamic platform mapping', () => {\n    const platforms = ['twitter', 'linkedin', 'unknown'];\n\n    render(\n      <div>\n        {platforms.map(platform => (\n          <SocialIconMapper\n            key={platform}\n            platform={platform}\n            data-testid={`dynamic-${platform}`}\n          />\n        ))}\n      </div>\n    );\n\n    platforms.forEach(platform => {\n      const icon = screen.getByTestId(`dynamic-${platform}`);\n      expect(icon).toBeInTheDocument();\n    });\n  });\n\n  it('handles responsive layouts', () => {\n    render(\n      <div className='flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-4'>\n        <SocialIconLink\n          href='https://twitter.com/example'\n          platform='twitter'\n          aria-label='Twitter'\n          className='w-full sm:w-auto'\n          data-testid='responsive-twitter'\n        />\n        <SocialIconLink\n          href='https://linkedin.com/in/example'\n          platform='linkedin'\n          aria-label='LinkedIn'\n          className='w-full sm:w-auto'\n          data-testid='responsive-linkedin'\n        />\n      </div>\n    );\n\n    const twitterLink = screen.getByTestId('responsive-twitter');\n    const linkedinLink = screen.getByTestId('responsive-linkedin');\n\n    expect(twitterLink).toHaveClass('w-full', 'sm:w-auto');\n    expect(linkedinLink).toHaveClass('w-full', 'sm:w-auto');\n  });\n\n  it('supports theming and customization', () => {\n    render(\n      <div className='dark'>\n        <SocialIconLink\n          href='https://twitter.com/example'\n          platform='twitter'\n          aria-label='Twitter'\n          className='text-gray-600 dark:text-gray-300 hover:text-blue-500 dark:hover:text-blue-400'\n          data-testid='themed-link'\n        />\n      </div>\n    );\n\n    const link = screen.getByTestId('themed-link');\n    expect(link).toHaveClass(\n      'text-gray-600',\n      'dark:text-gray-300',\n      'hover:text-blue-500',\n      'dark:hover:text-blue-400'\n    );\n  });\n\n  it('works with form integration', () => {\n    render(\n      <form>\n        <fieldset>\n          <legend>Social Media Profiles</legend>\n          <div>\n            <label htmlFor='twitter-url'>Twitter URL</label>\n            <input id='twitter-url' type='url' />\n            <SocialIconMapper platform='twitter' className='ml-2' />\n          </div>\n          <div>\n            <label htmlFor='linkedin-url'>LinkedIn URL</label>\n            <input id='linkedin-url' type='url' />\n            <SocialIconMapper platform='linkedin' className='ml-2' />\n          </div>\n        </fieldset>\n      </form>\n    );\n\n    const twitterInput = screen.getByLabelText('Twitter URL');\n    const linkedinInput = screen.getByLabelText('LinkedIn URL');\n\n    expect(twitterInput).toBeInTheDocument();\n    expect(linkedinInput).toBeInTheDocument();\n  });\n\n  it('handles error states gracefully', () => {\n    // Test with invalid props\n    expect(() => {\n      render(\n        <div>\n          <SocialIconMapper platform={undefined as string | undefined} />\n          <SocialIconLink\n            href=''\n            platform='twitter'\n            aria-label='Twitter'\n          />\n        </div>\n      );\n    }).not.toThrow();\n  });\n\n  it('supports server-side rendering', () => {\n    // Test that components render without client-side JavaScript\n    const { container } = render(\n      <div>\n        <TwitterIcon />\n        <LinkedInIcon />\n        <ExternalLinkIcon />\n        <SocialIconMapper platform='twitter' />\n        <SocialIconLink\n          href='https://twitter.com/example'\n          platform='twitter'\n          aria-label='Twitter'\n        />\n      </div>\n    );\n\n    expect(container.innerHTML).toBeTruthy();\n    expect(container.querySelectorAll('svg')).toHaveLength(5);\n  });\n\n  it('maintains performance with many icons', () => {\n    const manyIcons = Array.from({ length: 50 }, (_, i) => (\n      <SocialIconMapper\n        key={i}\n        platform={i % 2 === 0 ? 'twitter' : 'linkedin'}\n        data-testid={`icon-${i}`}\n      />\n    ));\n\n    const _startTime = performance.now();\n    render(<div>{manyIcons}</div>);\n    const endTime = performance.now();\n\n    // Should render quickly (less than 100ms for 50 icons)\n    expect(endTime - _startTime).toBeLessThan(100);\n\n    // All icons should be present\n    expect(screen.getAllByTestId(/^icon-/)).toHaveLength(50);\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/social-icons-basic.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/social-icons-integration-scenarios-basic-core.test.tsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'GitHubIcon' is defined but never used. Allowed unused vars must match /^_/u.","line":18,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":13,"suggestions":[{"messageId":"removeVar","data":{"varName":"GitHubIcon"},"fix":{"range":[296,307],"text":""},"desc":"Remove unused variable 'GitHubIcon'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'GitHubIcon' is defined but never used. Allowed unused vars must match /^_/u.","line":18,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":18,"endColumn":13},{"ruleId":"no-unused-vars","severity":2,"message":"'LinkedInIcon' is defined but never used. Allowed unused vars must match /^_/u.","line":19,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":15,"suggestions":[{"messageId":"removeVar","data":{"varName":"LinkedInIcon"},"fix":{"range":[306,322],"text":""},"desc":"Remove unused variable 'LinkedInIcon'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'LinkedInIcon' is defined but never used. Allowed unused vars must match /^_/u.","line":19,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":19,"endColumn":15},{"ruleId":"no-unused-vars","severity":2,"message":"'TwitterIcon' is defined but never used. Allowed unused vars must match /^_/u.","line":22,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":14,"suggestions":[{"messageId":"removeVar","data":{"varName":"TwitterIcon"},"fix":{"range":[360,375],"text":""},"desc":"Remove unused variable 'TwitterIcon'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'TwitterIcon' is defined but never used. Allowed unused vars must match /^_/u.","line":22,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":22,"endColumn":14}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @vitest-environment jsdom\n */\n\n/**\n * Social Icons Integration Scenarios - Core Basic Tests\n *\n * 核心基本集成测试，专注于最重要的功能：\n * - 基本导航菜单集成\n * - 核心页脚集成\n * - 基本平台映射\n * - 基础响应式布局\n */\n\nimport { render, screen } from '@testing-library/react';\nimport { describe, expect, it } from 'vitest';\nimport {\n  GitHubIcon,\n  LinkedInIcon,\n  SocialIconLink,\n  SocialIconMapper,\n  TwitterIcon,\n} from '../social-icons';\n\ndescribe('Social Icons Integration Scenarios - Core Basic Tests', () => {\n  describe('核心导航菜单集成', () => {\n    it('works in basic navigation menus', () => {\n      render(\n        <nav aria-label='Social media links'>\n          <ul>\n            <li>\n              <SocialIconLink\n                href='https://twitter.com/example'\n                platform='twitter'\n                aria-label='Twitter'\n                data-testid='nav-twitter'\n              />\n            </li>\n            <li>\n              <SocialIconLink\n                href='https://linkedin.com/in/example'\n                platform='linkedin'\n                aria-label='LinkedIn'\n                data-testid='nav-linkedin'\n              />\n            </li>\n          </ul>\n        </nav>\n      );\n\n      const twitterLink = screen.getByTestId('nav-twitter');\n      const linkedinLink = screen.getByTestId('nav-linkedin');\n\n      expect(twitterLink).toBeInTheDocument();\n      expect(linkedinLink).toBeInTheDocument();\n      expect(twitterLink).toHaveAttribute('href', 'https://twitter.com/example');\n      expect(linkedinLink).toHaveAttribute('href', 'https://linkedin.com/in/example');\n    });\n\n    it('maintains accessibility in navigation context', () => {\n      render(\n        <nav aria-label='Social media links'>\n          <SocialIconLink\n            href='https://github.com/example'\n            platform='github'\n            aria-label='GitHub Profile'\n            data-testid='nav-github'\n          />\n        </nav>\n      );\n\n      const githubLink = screen.getByTestId('nav-github');\n      expect(githubLink).toHaveAttribute('aria-label', 'GitHub Profile');\n      expect(githubLink).toHaveAttribute('role', 'link');\n    });\n  });\n\n  describe('核心页脚集成', () => {\n    it('works in basic footer layouts', () => {\n      render(\n        <footer>\n          <div className=\"social-links\">\n            <SocialIconLink\n              href='https://twitter.com/company'\n              platform='twitter'\n              size='sm'\n              data-testid='footer-twitter'\n            />\n            <SocialIconLink\n              href='https://github.com/company'\n              platform='github'\n              size='sm'\n              data-testid='footer-github'\n            />\n          </div>\n        </footer>\n      );\n\n      const twitterLink = screen.getByTestId('footer-twitter');\n      const githubLink = screen.getByTestId('footer-github');\n\n      expect(twitterLink).toBeInTheDocument();\n      expect(githubLink).toBeInTheDocument();\n      expect(twitterLink).toHaveClass('h-4', 'w-4');\n      expect(githubLink).toHaveClass('h-4', 'w-4');\n    });\n\n    it('handles footer responsive sizing', () => {\n      render(\n        <footer>\n          <SocialIconLink\n            href='https://linkedin.com/company/example'\n            platform='linkedin'\n            size='lg'\n            className='md:h-8 md:w-8'\n            data-testid='footer-linkedin'\n          />\n        </footer>\n      );\n\n      const linkedinLink = screen.getByTestId('footer-linkedin');\n      expect(linkedinLink).toHaveClass('h-6', 'w-6', 'md:h-8', 'md:w-8');\n    });\n  });\n\n  describe('核心平台映射', () => {\n    it('maps basic platforms correctly', () => {\n      const platforms = ['twitter', 'github', 'linkedin'] as const;\n      \n      platforms.forEach(platform => {\n        render(\n          <SocialIconMapper\n            platform={platform}\n            data-testid={`mapper-${platform}`}\n          />\n        );\n\n        const icon = screen.getByTestId(`mapper-${platform}`);\n        expect(icon).toBeInTheDocument();\n      });\n    });\n\n    it('handles unknown platforms gracefully', () => {\n      render(\n        <SocialIconMapper\n          platform='unknown' as unknown\n          data-testid='mapper-unknown'\n        />\n      );\n\n      const icon = screen.getByTestId('mapper-unknown');\n      expect(icon).toBeInTheDocument();\n    });\n  });\n\n  describe('基础响应式布局', () => {\n    it('applies responsive classes correctly', () => {\n      render(\n        <div className=\"flex space-x-2 md:space-x-4\">\n          <SocialIconLink\n            href='https://twitter.com/example'\n            platform='twitter'\n            size='sm'\n            className='md:h-6 md:w-6'\n            data-testid='responsive-twitter'\n          />\n          <SocialIconLink\n            href='https://github.com/example'\n            platform='github'\n            size='sm'\n            className='md:h-6 md:w-6'\n            data-testid='responsive-github'\n          />\n        </div>\n      );\n\n      const twitterLink = screen.getByTestId('responsive-twitter');\n      const githubLink = screen.getByTestId('responsive-github');\n\n      expect(twitterLink).toHaveClass('h-4', 'w-4', 'md:h-6', 'md:w-6');\n      expect(githubLink).toHaveClass('h-4', 'w-4', 'md:h-6', 'md:w-6');\n    });\n\n    it('maintains layout structure in responsive containers', () => {\n      render(\n        <div className=\"grid grid-cols-3 gap-2 md:flex md:space-x-4\">\n          <SocialIconLink\n            href='https://twitter.com/example'\n            platform='twitter'\n            data-testid='grid-twitter'\n          />\n          <SocialIconLink\n            href='https://github.com/example'\n            platform='github'\n            data-testid='grid-github'\n          />\n          <SocialIconLink\n            href='https://linkedin.com/in/example'\n            platform='linkedin'\n            data-testid='grid-linkedin'\n          />\n        </div>\n      );\n\n      const twitterLink = screen.getByTestId('grid-twitter');\n      const githubLink = screen.getByTestId('grid-github');\n      const linkedinLink = screen.getByTestId('grid-linkedin');\n\n      expect(twitterLink).toBeInTheDocument();\n      expect(githubLink).toBeInTheDocument();\n      expect(linkedinLink).toBeInTheDocument();\n    });\n  });\n\n  describe('基础主题定制', () => {\n    it('applies custom theme classes', () => {\n      render(\n        <SocialIconLink\n          href='https://twitter.com/example'\n          platform='twitter'\n          className='text-blue-500 hover:text-blue-600'\n          data-testid='themed-twitter'\n        />\n      );\n\n      const twitterLink = screen.getByTestId('themed-twitter');\n      expect(twitterLink).toHaveClass('text-blue-500', 'hover:text-blue-600');\n    });\n\n    it('supports dark mode classes', () => {\n      render(\n        <SocialIconLink\n          href='https://github.com/example'\n          platform='github'\n          className='text-gray-600 dark:text-gray-300'\n          data-testid='dark-github'\n        />\n      );\n\n      const githubLink = screen.getByTestId('dark-github');\n      expect(githubLink).toHaveClass('text-gray-600', 'dark:text-gray-300');\n    });\n  });\n\n  describe('边缘情况测试', () => {\n    it('handles empty href gracefully', () => {\n      render(\n        <SocialIconLink\n          href=''\n          platform='twitter'\n          data-testid='empty-href'\n        />\n      );\n\n      const link = screen.getByTestId('empty-href');\n      expect(link).toBeInTheDocument();\n      expect(link).toHaveAttribute('href', '');\n    });\n\n    it('handles missing platform gracefully', () => {\n      render(\n        <SocialIconLink\n          href='https://example.com'\n          platform={undefined as unknown}\n          data-testid='missing-platform'\n        />\n      );\n\n      const link = screen.getByTestId('missing-platform');\n      expect(link).toBeInTheDocument();\n    });\n\n    it('handles invalid size values', () => {\n      render(\n        <SocialIconLink\n          href='https://twitter.com/example'\n          platform='twitter'\n          size={'invalid' as unknown}\n          data-testid='invalid-size'\n        />\n      );\n\n      const link = screen.getByTestId('invalid-size');\n      expect(link).toBeInTheDocument();\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/social-icons-integration-scenarios-basic.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/social-icons-integration-scenarios.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/social-icons-link-basic.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/social-icons-link.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/social-icons-mapper-links.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/social-icons-mapper.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/social-icons.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/tabs-accessibility.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/tabs-basic.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/tabs-content.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/tabs-integration.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/__tests__/tabs-trigger.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/animated-counter-helpers.tsx","messages":[],"suppressedMessages":[{"ruleId":"security/detect-unsafe-regex","severity":2,"message":"Unsafe Regular Expression","line":73,"column":33,"nodeType":"Literal","endLine":73,"endColumn":56,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/animated-counter.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/badge.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/button.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/carousel.tsx","messages":[],"suppressedMessages":[{"ruleId":"react-you-might-not-need-an-effect/no-pass-data-to-parent","severity":2,"message":"Avoid passing data to parents in an effect. Instead, let the parent fetch the data itself and pass it down to the child as a prop.","line":106,"column":7,"nodeType":"CallExpression","messageId":"avoidPassingDataToParent","endLine":106,"endColumn":18,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/checkbox.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/dropdown-menu.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/input.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/label.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/navigation-menu.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/progress.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/prose.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/separator.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/sheet.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/skeleton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/social-icons.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/tabs.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/textarea.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/components/ui/toaster.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/config/__tests__/paths.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/config/__tests__/security.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/config/paths.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/config/paths/locales-config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/config/paths/paths-config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/config/paths/site-config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/config/paths/types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/config/paths/utils.ts","messages":[],"suppressedMessages":[{"ruleId":"security/detect-object-injection","severity":2,"message":"Variable Assigned to Object Injection Sink","line":27,"column":22,"nodeType":"MemberExpression","endLine":27,"endColumn":44,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":31,"column":10,"nodeType":"MemberExpression","endLine":31,"endColumn":28,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":79,"column":7,"nodeType":"MemberExpression","endLine":79,"endColumn":20,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"security/detect-object-injection","severity":2,"message":"Variable Assigned to Object Injection Sink","line":112,"column":22,"nodeType":"MemberExpression","endLine":112,"endColumn":35,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":115,"column":11,"nodeType":"MemberExpression","endLine":115,"endColumn":32,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":122,"column":11,"nodeType":"MemberExpression","endLine":122,"endColumn":32,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"security/detect-object-injection","severity":2,"message":"Variable Assigned to Object Injection Sink","line":132,"column":22,"nodeType":"MemberExpression","endLine":132,"endColumn":35,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/config/security.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/constants/__tests__/app-constants.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/constants/__tests__/index.test.ts","messages":[{"ruleId":"@next/next/no-assign-module-variable","severity":2,"message":"Do not assign to the variable `module`. See: https://nextjs.org/docs/messages/no-assign-module-variable","line":94,"column":11,"nodeType":"VariableDeclaration","endLine":94,"endColumn":51},{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":96,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":96,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":96,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":96,"endColumn":23},{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":112,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":112,"endColumn":21},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":112,"column":16,"nodeType":null,"messageId":"unusedVar","endLine":112,"endColumn":21}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @vitest-environment jsdom\n */\n\nimport { describe, expect, it } from 'vitest';\n\ndescribe('Constants Index Module', () => {\n  describe('Module Exports', () => {\n    it('should be able to import the constants index module', async () => {\n      expect(async () => {\n        await import('../index');\n      }).not.toThrow();\n    });\n\n    it('should export all constant modules', async () => {\n      const constantsModule = await import('../index');\n      expect(constantsModule).toBeDefined();\n    });\n  });\n\n  describe('Re-exported Constants', () => {\n    it('should re-export APP_CONSTANTS', async () => {\n      const { APP_CONSTANTS } = await import('../index');\n      expect(APP_CONSTANTS).toBeDefined();\n      expect(typeof APP_CONSTANTS).toBe('object');\n    });\n\n    it('should re-export SECURITY_CONSTANTS', async () => {\n      const { SECURITY_CONSTANTS } = await import('../index');\n      expect(SECURITY_CONSTANTS).toBeDefined();\n      expect(typeof SECURITY_CONSTANTS).toBe('object');\n    });\n\n    it('should re-export SEO_CONSTANTS', async () => {\n      const { SEO_CONSTANTS } = await import('../index');\n      expect(SEO_CONSTANTS).toBeDefined();\n      expect(typeof SEO_CONSTANTS).toBe('object');\n    });\n\n    it('should re-export TEST_CONSTANTS', async () => {\n      const { TEST_CONSTANTS } = await import('../index');\n      expect(TEST_CONSTANTS).toBeDefined();\n      expect(typeof TEST_CONSTANTS).toBe('object');\n    });\n  });\n\n  describe('Module Structure', () => {\n    it('should have proper module structure', () => {\n      const fs = require('fs');\n      const path = require('path');\n      const indexPath = path.join(__dirname, '../index.ts');\n      const content = fs.readFileSync(indexPath, 'utf8');\n\n      // 验证包含所有必要的导出\n      expect(content).toContain(\"export * from './i18n-constants'\");\n      expect(content).toContain(\"export * from './app-constants'\");\n      expect(content).toContain(\"export * from './test-constants'\");\n      expect(content).toContain(\"export * from './security-constants'\");\n      expect(content).toContain(\"export * from './seo-constants'\");\n    });\n\n    it('should have re-export statements', () => {\n      const fs = require('fs');\n      const path = require('path');\n      const indexPath = path.join(__dirname, '../index.ts');\n      const content = fs.readFileSync(indexPath, 'utf8');\n\n      expect(content).toContain('export { APP_CONSTANTS }');\n      expect(content).toContain('export { SECURITY_CONSTANTS }');\n      expect(content).toContain('export { SEO_CONSTANTS }');\n      expect(content).toContain('export { TEST_CONSTANTS }');\n    });\n  });\n\n  describe('TypeScript Compilation', () => {\n    it('should compile without TypeScript errors', async () => {\n      expect(async () => {\n        await import('../index');\n      }).not.toThrow();\n    });\n\n    it('should import all modules successfully', async () => {\n      // 测试所有模块都可以被成功导入\n      const modules = [\n        '../i18n-constants',\n        '../app-constants',\n        '../test-constants',\n        '../security-constants',\n        '../seo-constants',\n      ];\n\n      for (const modulePath of modules) {\n        try {\n          const module = await import(modulePath);\n          expect(module).toBeDefined();\n        } catch (error) {\n          // 如果模块不存在，这是预期的，不应该导致测试失败\n          console.warn(`Module ${modulePath} not found, skipping test`);\n        }\n      }\n    });\n  });\n\n  describe('Constants Availability', () => {\n    it('should make constants available through index', async () => {\n      try {\n        const constantsModule = await import('../index');\n\n        // 验证至少有一些导出\n        const exports = Object.keys(constantsModule);\n        expect(exports.length).toBeGreaterThan(0);\n      } catch (error) {\n        // 如果某些常量模块不存在，这是可以接受的\n        console.warn('Some constants modules may not exist yet');\n      }\n    });\n\n    it('should provide centralized access to all constants', () => {\n      // 验证索引文件的目的：提供集中访问点\n      const fs = require('fs');\n      const path = require('path');\n      const indexPath = path.join(__dirname, '../index.ts');\n      const content = fs.readFileSync(indexPath, 'utf8');\n\n      // 验证文件包含适当的注释说明其用途\n      expect(content).toContain('常量模块统一导出');\n      expect(content).toContain('提供项目中所有常量的集中访问点');\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/constants/app-constants.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/constants/dev-tools.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/constants/i18n-constants.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/constants/index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/constants/performance-constants.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/constants/performance.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/constants/react-scan.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/constants/security-constants.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/constants/seo-constants.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/constants/test-app-constants.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/constants/test-base-constants.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/constants/test-constants.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/constants/test-performance-constants.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/constants/test-ui-constants.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/constants/test-web-vitals-constants.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/constants/units.ts","messages":[{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 60.","line":5,"column":26,"nodeType":"Literal","messageId":"noMagic","endLine":5,"endColumn":28},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 60.","line":6,"column":24,"nodeType":"Literal","messageId":"noMagic","endLine":6,"endColumn":26},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 1024.","line":8,"column":19,"nodeType":"Literal","messageId":"noMagic","endLine":8,"endColumn":23},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 1024.","line":9,"column":19,"nodeType":"Literal","messageId":"noMagic","endLine":9,"endColumn":23}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 通用时间与容量单位常量\n */\nexport const SECOND_MS = 1000 as const;\nexport const MINUTE_MS = 60 * SECOND_MS as const;\nexport const HOUR_MS = 60 * MINUTE_MS as const;\n\nexport const KB = 1024 as const;\nexport const MB = 1024 * KB as const;\n\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/features/auth/index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/features/dashboard/index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/hooks/__tests__/use-breakpoint.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/hooks/__tests__/use-enhanced-theme.performance.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/hooks/__tests__/use-enhanced-theme.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/hooks/__tests__/use-enhanced-translations.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/hooks/__tests__/use-intersection-observer.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/hooks/__tests__/use-keyboard-navigation-advanced.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/hooks/__tests__/use-keyboard-navigation-basic.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/hooks/__tests__/use-keyboard-navigation-dom.test.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'buttons' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":215,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":215,"endColumn":20},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'buttons' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":215,"column":13,"nodeType":null,"messageId":"unusedVar","endLine":215,"endColumn":20}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @vitest-environment jsdom\n */\n\nimport { act, renderHook } from '@testing-library/react';\nimport { afterEach, beforeEach, describe, expect, it, vi } from 'vitest';\nimport { useKeyboardNavigation } from '../use-keyboard-navigation';\n\n// Mock focus method\nconst mockFocus = vi.fn();\n\ndescribe('useKeyboardNavigation DOM Tests', () => {\n  beforeEach(() => {\n    // Mock HTMLElement.prototype.focus\n    Object.defineProperty(HTMLElement.prototype, 'focus', {\n      value: mockFocus,\n      writable: true,\n    });\n  });\n\n  afterEach(() => {\n    vi.restoreAllMocks();\n    // Clean up DOM\n    document.body.innerHTML = '';\n  });\n\n  describe('实际DOM交互测试', () => {\n    beforeEach(() => {\n      // Setup DOM with actual focusable elements\n      document.body.innerHTML = `\n        <div id=\"container\">\n          <button id=\"btn1\">Button 1</button>\n          <button id=\"btn2\">Button 2</button>\n          <button id=\"btn3\">Button 3</button>\n          <input id=\"input1\" type=\"text\" />\n          <a href=\"#\" id=\"link1\">Link 1</a>\n        </div>\n      `;\n    });\n\n    it('should work with real DOM elements', () => {\n      const { result } = renderHook(() => useKeyboardNavigation());\n\n      // Set the container ref to the actual DOM element\n      const container = document.getElementById('container');\n      if (container && result.current.containerRef) {\n        Object.defineProperty(result.current.containerRef, 'current', {\n          value: container,\n          writable: true,\n        });\n      }\n\n      expect(result.current.containerRef).toBeDefined();\n      expect(container).toBeInTheDocument();\n    });\n\n    it('should find focusable elements in container', () => {\n      const { result } = renderHook(() => useKeyboardNavigation());\n\n      const container = document.getElementById('container');\n      if (container && result.current.containerRef) {\n        Object.defineProperty(result.current.containerRef, 'current', {\n          value: container,\n          writable: true,\n        });\n      }\n\n      // Test navigation methods\n      act(() => {\n        result.current.focusNext();\n      });\n\n      expect(result.current.getCurrentFocusIndex()).toBeGreaterThanOrEqual(-1);\n    });\n\n    it('should handle focus on different element types', () => {\n      const { result } = renderHook(() => useKeyboardNavigation());\n\n      const container = document.getElementById('container');\n      if (container && result.current.containerRef) {\n        Object.defineProperty(result.current.containerRef, 'current', {\n          value: container,\n          writable: true,\n        });\n      }\n\n      // Test focusing different types of elements\n      act(() => {\n        result.current.focusIndex(0); // Button\n      });\n\n      act(() => {\n        result.current.focusIndex(3); // Input\n      });\n\n      act(() => {\n        result.current.focusIndex(4); // Link\n      });\n\n      expect(result.current.getCurrentFocusIndex()).toBeGreaterThanOrEqual(-1);\n    });\n  });\n\n  describe('键盘事件模拟测试', () => {\n    let realContainer: HTMLElement;\n    let originalFocus: typeof HTMLElement.prototype.focus;\n\n    beforeEach(() => {\n      // 保存原始的focus方法\n      originalFocus = HTMLElement.prototype.focus;\n\n      // 创建真实的DOM结构\n      document.body.innerHTML = `\n        <div id=\"test-container\">\n          <button id=\"btn1\">Button 1</button>\n          <button id=\"btn2\">Button 2</button>\n          <button id=\"btn3\">Button 3</button>\n        </div>\n      `;\n\n      realContainer = document.getElementById('test-container')!;\n    });\n\n    afterEach(() => {\n      // 恢复原始的focus方法\n      HTMLElement.prototype.focus = originalFocus;\n    });\n\n    it('should handle real keyboard events', () => {\n      const mockOnNavigate = vi.fn();\n      \n      const { result } = renderHook(() =>\n        useKeyboardNavigation({\n          enabled: true,\n          onNavigate: mockOnNavigate,\n        }),\n      );\n\n      // 设置容器引用\n      if (result.current.containerRef) {\n        Object.defineProperty(result.current.containerRef, 'current', {\n          value: realContainer,\n          writable: true,\n        });\n      }\n\n      const buttons = realContainer.querySelectorAll('button');\n      expect(buttons).toHaveLength(3);\n\n      // 模拟键盘事件\n      const arrowDownEvent = new KeyboardEvent('keydown', {\n        key: 'ArrowDown',\n        bubbles: true,\n      });\n\n      act(() => {\n        result.current.handleKeyDown(arrowDownEvent);\n      });\n\n      expect(result.current.getCurrentFocusIndex()).toBeGreaterThanOrEqual(-1);\n    });\n\n    it('should navigate through elements with arrow keys', () => {\n      const { result } = renderHook(() =>\n        useKeyboardNavigation({ enabled: true }),\n      );\n\n      if (result.current.containerRef) {\n        Object.defineProperty(result.current.containerRef, 'current', {\n          value: realContainer,\n          writable: true,\n        });\n      }\n\n      // 测试向下导航\n      act(() => {\n        result.current.focusNext();\n      });\n\n      // 测试向上导航\n      act(() => {\n        result.current.focusPrevious();\n      });\n\n      // 测试跳转到第一个\n      act(() => {\n        result.current.focusFirst();\n      });\n\n      // 测试跳转到最后一个\n      act(() => {\n        result.current.focusLast();\n      });\n\n      expect(result.current.getCurrentFocusIndex()).toBeGreaterThanOrEqual(-1);\n    });\n\n    it('should handle direct focus by index', () => {\n      const mockOnNavigate = vi.fn();\n      \n      const { result } = renderHook(() =>\n        useKeyboardNavigation({\n          enabled: true,\n          onNavigate: mockOnNavigate,\n        }),\n      );\n\n      if (result.current.containerRef) {\n        Object.defineProperty(result.current.containerRef, 'current', {\n          value: realContainer,\n          writable: true,\n        });\n      }\n\n      const buttons = realContainer.querySelectorAll('button');\n\n      // 直接聚焦到第二个按钮\n      act(() => {\n        result.current.focusIndex(1);\n      });\n\n      // 直接聚焦到第三个按钮\n      act(() => {\n        result.current.focusIndex(2);\n      });\n\n      expect(result.current.getCurrentFocusIndex()).toBeGreaterThanOrEqual(-1);\n    });\n  });\n\n  describe('动态DOM变化测试', () => {\n    it('should handle dynamically added elements', () => {\n      const { result } = renderHook(() => useKeyboardNavigation());\n\n      // 初始DOM\n      document.body.innerHTML = `\n        <div id=\"dynamic-container\">\n          <button>Button 1</button>\n        </div>\n      `;\n\n      const container = document.getElementById('dynamic-container')!;\n      if (result.current.containerRef) {\n        Object.defineProperty(result.current.containerRef, 'current', {\n          value: container,\n          writable: true,\n        });\n      }\n\n      // 动态添加元素\n      const newButton = document.createElement('button');\n      newButton.textContent = 'Button 2';\n      container.appendChild(newButton);\n\n      act(() => {\n        result.current.focusNext();\n      });\n\n      expect(result.current.getCurrentFocusIndex()).toBeGreaterThanOrEqual(-1);\n    });\n\n    it('should handle dynamically removed elements', () => {\n      const { result } = renderHook(() => useKeyboardNavigation());\n\n      // 初始DOM\n      document.body.innerHTML = `\n        <div id=\"dynamic-container\">\n          <button id=\"btn1\">Button 1</button>\n          <button id=\"btn2\">Button 2</button>\n        </div>\n      `;\n\n      const container = document.getElementById('dynamic-container')!;\n      if (result.current.containerRef) {\n        Object.defineProperty(result.current.containerRef, 'current', {\n          value: container,\n          writable: true,\n        });\n      }\n\n      // 移除一个元素\n      const btn2 = document.getElementById('btn2');\n      if (btn2) {\n        btn2.remove();\n      }\n\n      act(() => {\n        result.current.focusNext();\n      });\n\n      expect(result.current.getCurrentFocusIndex()).toBeGreaterThanOrEqual(-1);\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/hooks/__tests__/use-keyboard-navigation-events.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/hooks/__tests__/use-performance-monitor.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/hooks/__tests__/use-reduced-motion.test.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'event' is defined but never used. Allowed unused args must match /^_/u.","line":240,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":240,"endColumn":38,"suggestions":[{"messageId":"removeVar","data":{"varName":"event"},"fix":{"range":[6487,6499],"text":""},"desc":"Remove unused variable 'event'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { act, renderHook } from '@testing-library/react';\nimport { afterEach, beforeEach, describe, expect, it, vi } from 'vitest';\nimport { TEST_BASE_NUMBERS } from '@/constants/test-constants';\nimport { useReducedMotion } from '../use-reduced-motion';\n\n// Mock matchMedia\nconst mockMatchMedia = vi.fn();\n\n// Mock window object\nObject.defineProperty(global, 'window', {\n  writable: true,\n  value: {\n    matchMedia: mockMatchMedia,\n  },\n});\n\ndescribe('useReducedMotion', () => {\n  beforeEach(() => {\n    // Reset mocks\n    vi.clearAllMocks();\n\n    // Ensure window.matchMedia is available (safe access)\n    if (global.window) {\n      global.window.matchMedia = mockMatchMedia;\n    }\n  });\n\n  afterEach(() => {\n    vi.restoreAllMocks();\n  });\n\n  it('should return false by default when reduced motion is not preferred', () => {\n    const mockMediaQuery = {\n      matches: false,\n      addEventListener: vi.fn(),\n      removeEventListener: vi.fn(),\n    };\n\n    mockMatchMedia.mockReturnValue(mockMediaQuery);\n\n    const { result } = renderHook(() => useReducedMotion());\n\n    expect(result.current).toBe(false);\n    expect(mockMatchMedia).toHaveBeenCalledWith(\n      '(prefers-reduced-motion: reduce)',\n    );\n    expect(mockMediaQuery.addEventListener).toHaveBeenCalledWith(\n      'change',\n      expect.any(Function),\n    );\n  });\n\n  it('should return true when reduced motion is preferred', () => {\n    const mockMediaQuery = {\n      matches: true,\n      addEventListener: vi.fn(),\n      removeEventListener: vi.fn(),\n    };\n\n    mockMatchMedia.mockReturnValue(mockMediaQuery);\n\n    const { result } = renderHook(() => useReducedMotion());\n\n    expect(result.current).toBe(true);\n  });\n\n  it('should update when media query changes', () => {\n    let changeHandler: ((_event: MediaQueryListEvent) => void) | null = null;\n\n    const mockMediaQuery = {\n      matches: false,\n      addEventListener: vi.fn((_event, handler) => {\n        if (_event === 'change') {\n          changeHandler = handler;\n        }\n      }),\n      removeEventListener: vi.fn(),\n    };\n\n    mockMatchMedia.mockReturnValue(mockMediaQuery);\n\n    const { result } = renderHook(() => useReducedMotion());\n\n    // Initial state\n    expect(result.current).toBe(false);\n\n    // Simulate media query change\n    act(() => {\n      if (changeHandler) {\n        changeHandler({ matches: true } as MediaQueryListEvent);\n      }\n    });\n\n    expect(result.current).toBe(true);\n\n    // Simulate another change\n    act(() => {\n      if (changeHandler) {\n        changeHandler({ matches: false } as MediaQueryListEvent);\n      }\n    });\n\n    expect(result.current).toBe(false);\n  });\n\n  it('should clean up event listener on unmount', () => {\n    const mockMediaQuery = {\n      matches: false,\n      addEventListener: vi.fn(),\n      removeEventListener: vi.fn(),\n    };\n\n    mockMatchMedia.mockReturnValue(mockMediaQuery);\n\n    const { unmount } = renderHook(() => useReducedMotion());\n\n    expect(mockMediaQuery.addEventListener).toHaveBeenCalled();\n\n    unmount();\n\n    expect(mockMediaQuery.removeEventListener).toHaveBeenCalledWith(\n      'change',\n      expect.any(Function),\n    );\n  });\n\n  it('should handle server-side rendering gracefully', () => {\n    // Mock matchMedia to return null (SSR behavior)\n    const originalMatchMedia = global.window.matchMedia;\n    global.window.matchMedia = vi.fn(() => null as unknown);\n\n    const { result } = renderHook(() => useReducedMotion());\n\n    // Should default to false in SSR\n    expect(result.current).toBe(false);\n\n    // Restore original matchMedia\n    global.window.matchMedia = originalMatchMedia;\n  });\n\n  it('should handle missing matchMedia gracefully', () => {\n    // Store original matchMedia\n    const originalMatchMedia = global.window.matchMedia;\n\n    // Mock window without matchMedia\n    global.window.matchMedia = undefined as unknown;\n\n    const { result } = renderHook(() => useReducedMotion());\n\n    // Should default to false when matchMedia is not available\n    expect(result.current).toBe(false);\n\n    // Restore original matchMedia\n    global.window.matchMedia = originalMatchMedia;\n  });\n\n  it('should handle multiple rapid changes correctly', () => {\n    let changeHandler: ((_event: MediaQueryListEvent) => void) | null = null;\n\n    const mockMediaQuery = {\n      matches: false,\n      addEventListener: vi.fn((_event, handler) => {\n        if (_event === 'change') {\n          changeHandler = handler;\n        }\n      }),\n      removeEventListener: vi.fn(),\n    };\n\n    mockMatchMedia.mockReturnValue(mockMediaQuery);\n\n    const { result } = renderHook(() => useReducedMotion());\n\n    // Simulate rapid changes\n    act(() => {\n      if (changeHandler) {\n        changeHandler({ matches: true } as MediaQueryListEvent);\n        changeHandler({ matches: false } as MediaQueryListEvent);\n        changeHandler({ matches: true } as MediaQueryListEvent);\n      }\n    });\n\n    expect(result.current).toBe(true);\n  });\n\n  it('should maintain consistent state across re-renders', () => {\n    const mockMediaQuery = {\n      matches: true,\n      addEventListener: vi.fn(),\n      removeEventListener: vi.fn(),\n    };\n\n    mockMatchMedia.mockReturnValue(mockMediaQuery);\n\n    const { result, rerender } = renderHook(() => useReducedMotion());\n\n    expect(result.current).toBe(true);\n\n    // Re-render the hook\n    rerender();\n\n    expect(result.current).toBe(true);\n    // matchMedia is called in both useState initializer and useEffect\n    expect(mockMatchMedia).toHaveBeenCalledTimes(TEST_BASE_NUMBERS.SMALL_COUNT);\n  });\n\n  it('should handle edge case where addEventListener is not available', () => {\n    const mockMediaQuery = {\n      matches: false,\n      addEventListener: undefined,\n      removeEventListener: vi.fn(),\n    };\n\n    mockMatchMedia.mockReturnValue(mockMediaQuery);\n\n    // Should not throw when addEventListener is not available\n    expect(() => {\n      renderHook(() => useReducedMotion());\n    }).not.toThrow();\n  });\n\n  it('should handle edge case where removeEventListener is not available', () => {\n    const mockMediaQuery = {\n      matches: false,\n      addEventListener: vi.fn(),\n      removeEventListener: undefined,\n    };\n\n    mockMatchMedia.mockReturnValue(mockMediaQuery);\n\n    const { unmount } = renderHook(() => useReducedMotion());\n\n    // Should not throw when unmounting\n    expect(() => {\n      unmount();\n    }).not.toThrow();\n  });\n\n  it('should handle malformed MediaQueryListEvent', () => {\n    let changeHandler: ((event: Event) => void) | null = null;\n\n    const mockMediaQuery = {\n      matches: false,\n      addEventListener: vi.fn((_event, handler) => {\n        changeHandler = handler;\n      }),\n      removeEventListener: vi.fn(),\n    };\n\n    mockMatchMedia.mockReturnValue(mockMediaQuery);\n\n    const { result } = renderHook(() => useReducedMotion());\n\n    // Simulate malformed event\n    act(() => {\n      if (changeHandler) {\n        changeHandler({} as unknown); // Empty object instead of proper MediaQueryListEvent\n      }\n    });\n\n    // Should handle gracefully\n    expect(result.current).toBe(false);\n  });\n\n  it('should handle null MediaQueryList', () => {\n    mockMatchMedia.mockReturnValue(null);\n\n    expect(() => {\n      renderHook(() => useReducedMotion());\n    }).not.toThrow();\n  });\n\n  it('should handle MediaQueryList with missing properties', () => {\n    const incompleteMediaQuery = {\n      matches: true,\n      // Missing addEventListener and removeEventListener\n    };\n\n    mockMatchMedia.mockReturnValue(incompleteMediaQuery as unknown);\n\n    expect(() => {\n      renderHook(() => useReducedMotion());\n    }).not.toThrow();\n  });\n\n  it('should handle window object being undefined', () => {\n    // Create a minimal window mock that simulates SSR environment\n    const originalWindow = global.window;\n\n    try {\n      // Create a minimal window object without matchMedia to simulate SSR\n      Object.defineProperty(global, 'window', {\n        value: {\n          // Minimal properties that React Testing Library might need\n          document: {},\n          location: {},\n          navigator: {},\n          // Explicitly no matchMedia to simulate SSR\n        },\n        writable: true,\n        configurable: true,\n      });\n\n      const { result } = renderHook(() => useReducedMotion());\n\n      // Should default to false in SSR-like environment\n      expect(result.current).toBe(false);\n    } finally {\n      // Restore original window\n      global.window = originalWindow;\n    }\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/hooks/__tests__/use-theme-toggle.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/hooks/__tests__/use-web-vitals-diagnostics.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/hooks/performance-monitor-measurements.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'PERFORMANCE_CONSTANTS' is defined but never used. Allowed unused vars must match /^_/u.","line":9,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":24,"suggestions":[{"messageId":"removeVar","data":{"varName":"PERFORMANCE_CONSTANTS"},"fix":{"range":[189,211],"text":""},"desc":"Remove unused variable 'PERFORMANCE_CONSTANTS'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'PERFORMANCE_CONSTANTS' is defined but never used. Allowed unused vars must match /^_/u.","line":9,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":9,"endColumn":24},{"ruleId":"no-unused-vars","severity":2,"message":"'checkPerformanceThresholds' is defined but never used. Allowed unused vars must match /^_/u.","line":11,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":29,"suggestions":[{"messageId":"removeVar","data":{"varName":"checkPerformanceThresholds"},"fix":{"range":[235,265],"text":""},"desc":"Remove unused variable 'checkPerformanceThresholds'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'checkPerformanceThresholds' is defined but never used. Allowed unused vars must match /^_/u.","line":11,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":11,"endColumn":29},{"ruleId":"max-params","severity":2,"message":"Function 'usePerformanceMeasurements' has too many parameters (5). Maximum allowed is 3.","line":18,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":18,"endColumn":43},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (4). Maximum allowed is 3.","line":38,"column":11,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":44,"endColumn":12},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 10000.","line":212,"column":12,"nodeType":"Literal","messageId":"noMagic","endLine":212,"endColumn":17},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 10000.","line":248,"column":12,"nodeType":"Literal","messageId":"noMagic","endLine":248,"endColumn":17}],"suppressedMessages":[],"errorCount":8,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport type {\n  PerformanceAlert,\n  PerformanceAlertThresholds,\n  PerformanceMetrics,\n  PerformanceMeasurements,\n} from './performance-monitor-types';\nimport {\n  PERFORMANCE_CONSTANTS,\n  checkMemoryUsageAlert,\n  checkPerformanceThresholds,\n} from './performance-monitor-utils';\nimport { logger } from '@/lib/logger';\n\n/**\n * 创建性能测量函数的辅助函数\n */\nexport function usePerformanceMeasurements(\n  enableAlerts: boolean,\n  alertThresholds: Required<PerformanceAlertThresholds>,\n  addAlert: (_alert: Omit<PerformanceAlert, 'id' | 'timestamp'>) => void,\n  setMetrics: React.Dispatch<React.SetStateAction<PerformanceMetrics | null>>,\n  startTime: React.MutableRefObject<number>,\n): PerformanceMeasurements {\n\n  const measureLoadTime = React.useCallback(() => {\n    try {\n      if (typeof window !== 'undefined' && window.performance) {\n        const navigation = performance.getEntriesByType('navigation')[0] as PerformanceNavigationTiming;\n        if (navigation) {\n          const loadTime = navigation.loadEventEnd - navigation.navigationStart;\n\n          setMetrics(prev => ({\n            ...prev,\n            loadTime,\n          }));\n\n          if (enableAlerts && loadTime > alertThresholds.loadTime) {\n            addAlert({\n              level: 'warning',\n              message: `Slow page load detected: ${Math.round(loadTime)}ms`,\n              data: { loadTime },\n            });\n          }\n        }\n      }\n    } catch (error) {\n      logger.warn('Failed to measure load time', { error: error as Error });\n    }\n  }, [enableAlerts, alertThresholds.loadTime, addAlert, setMetrics]);\n\n  const measureRenderTime = React.useCallback(() => {\n    try {\n      if (startTime.current !== null) {\n        const renderTime = performance.now() - startTime.current;\n\n        setMetrics(prev => ({\n          ...prev,\n          renderTime,\n        }));\n\n        if (enableAlerts && renderTime > alertThresholds.renderTime) {\n          addAlert({\n            level: 'warning',\n            message: `Slow render detected: ${Math.round(renderTime)}ms`,\n            data: { renderTime },\n          });\n        }\n      }\n    } catch (error) {\n      logger.warn('Failed to measure render time', { error: error as Error });\n    }\n  }, [enableAlerts, alertThresholds.renderTime, addAlert, setMetrics, startTime]);\n\n  const measureMemoryUsage = React.useCallback(() => {\n    try {\n      if (typeof window !== 'undefined' && window.performance?.memory) {\n        const memoryUsage = window.performance.memory.usedJSHeapSize;\n\n        setMetrics(prev => ({\n          ...prev,\n          memoryUsage,\n        }));\n\n        if (enableAlerts) {\n          checkMemoryUsageAlert(memoryUsage, alertThresholds.memoryUsage, addAlert);\n        }\n      }\n    } catch (error) {\n      logger.warn('Failed to measure memory usage', { error: error as Error });\n    }\n  }, [enableAlerts, alertThresholds.memoryUsage, addAlert, setMetrics]);\n\n  return {\n    measureLoadTime,\n    measureRenderTime,\n    measureMemoryUsage,\n  };\n}\n\n/**\n * 测量网络延迟\n */\nexport const measureNetworkLatency = async (): Promise<number | null> => {\n  try {\n    if (typeof window !== 'undefined' && navigator.connection) {\n      // 使用 Network Information API (如果可用)\n      const connection = navigator.connection as { rtt?: number; effectiveType?: string; downlink?: number };\n      if (connection.rtt) {\n        return connection.rtt;\n      }\n    }\n\n    // 回退到简单的ping测试\n    const startTime = performance.now();\n    await fetch('/api/ping', {\n      method: 'HEAD',\n      cache: 'no-cache',\n    });\n    const endTime = performance.now();\n\n    return endTime - startTime;\n  } catch (error) {\n    logger.warn('Failed to measure network latency', { error: error as Error });\n    return null;\n  }\n};\n\n/**\n * 测量首次内容绘制 (FCP)\n */\nexport const measureFirstContentfulPaint = (): number | null => {\n  try {\n    if (typeof window !== 'undefined' && window.performance) {\n      const paintEntries = performance.getEntriesByType('paint');\n      const fcpEntry = paintEntries.find(entry => entry.name === 'first-contentful-paint');\n      return fcpEntry ? fcpEntry.startTime : null;\n    }\n    return null;\n  } catch (error) {\n    logger.warn('Failed to measure FCP', { error: error as Error });\n    return null;\n  }\n};\n\n/**\n * 测量最大内容绘制 (LCP)\n */\nexport const measureLargestContentfulPaint = (): Promise<number | null> => {\n  return new Promise((resolve) => {\n    try {\n      if (typeof window !== 'undefined' && 'PerformanceObserver' in window) {\n        const observer = new PerformanceObserver((list) => {\n          const entries = list.getEntries();\n          const lastEntry = entries[entries.length - 1];\n          resolve(lastEntry ? lastEntry.startTime : null);\n          observer.disconnect();\n        });\n\n        observer.observe({ entryTypes: ['largest-contentful-paint'] });\n\n        // 超时处理\n        setTimeout(() => {\n          observer.disconnect();\n          resolve(null);\n        }, 5000);\n      } else {\n        resolve(null);\n      }\n    } catch (error) {\n      logger.warn('Failed to measure LCP', { error: error as Error });\n      resolve(null);\n    }\n  });\n};\n\n/**\n * 测量累积布局偏移 (CLS)\n */\nexport const measureCumulativeLayoutShift = (): Promise<number | null> => {\n  return new Promise((resolve) => {\n    try {\n      if (typeof window !== 'undefined' && 'PerformanceObserver' in window) {\n        let clsValue = 0;\n\n        const observer = new PerformanceObserver((list) => {\n          for (const entry of list.getEntries()) {\n            if (!(entry as { hadRecentInput?: boolean; value: number }).hadRecentInput) {\n              clsValue += (entry as { hadRecentInput?: boolean; value: number }).value;\n            }\n          }\n        });\n\n        observer.observe({ entryTypes: ['layout-shift'] });\n\n        // 在页面隐藏时返回结果\n        const handleVisibilityChange = () => {\n          if (document.visibilityState === 'hidden') {\n            observer.disconnect();\n            document.removeEventListener('visibilitychange', handleVisibilityChange);\n            resolve(clsValue);\n          }\n        };\n\n        document.addEventListener('visibilitychange', handleVisibilityChange);\n\n        // 超时处理\n        setTimeout(() => {\n          observer.disconnect();\n          document.removeEventListener('visibilitychange', handleVisibilityChange);\n          resolve(clsValue);\n        }, 10000);\n      } else {\n        resolve(null);\n      }\n    } catch (error) {\n      logger.warn('Failed to measure CLS', { error: error as Error });\n      resolve(null);\n    }\n  });\n};\n\n/**\n * 测量首次输入延迟 (FID)\n */\nexport const measureFirstInputDelay = (): Promise<number | null> => {\n  return new Promise((resolve) => {\n    try {\n      if (typeof window !== 'undefined' && 'PerformanceObserver' in window) {\n        const observer = new PerformanceObserver((list) => {\n          const entries = list.getEntries();\n          const firstEntry = entries[0];\n          if (firstEntry) {\n            const fid = (firstEntry as { processingStart: number; startTime: number }).processingStart - firstEntry.startTime;\n            resolve(fid);\n          } else {\n            resolve(null);\n          }\n          observer.disconnect();\n        });\n\n        observer.observe({ entryTypes: ['first-input'] });\n\n        // 超时处理\n        setTimeout(() => {\n          observer.disconnect();\n          resolve(null);\n        }, 10000);\n      } else {\n        resolve(null);\n      }\n    } catch (error) {\n      logger.warn('Failed to measure FID', { error: error as Error });\n      resolve(null);\n    }\n  });\n};\n\n/**\n * 综合性能测量函数\n */\nexport const measureComprehensivePerformance = async (): Promise<Partial<PerformanceMetrics>> => {\n  const metrics: Partial<PerformanceMetrics> = {};\n\n  try {\n    // 测量基本指标\n    if (typeof window !== 'undefined' && window.performance) {\n      // 加载时间\n      const navigation = performance.getEntriesByType('navigation')[0] as PerformanceNavigationTiming;\n      if (navigation) {\n        metrics.loadTime = navigation.loadEventEnd - navigation.navigationStart;\n      }\n\n      // 内存使用\n      if (window.performance.memory) {\n        metrics.memoryUsage = window.performance.memory.usedJSHeapSize;\n      }\n    }\n\n    // 网络延迟\n    const networkLatency = await measureNetworkLatency();\n    if (networkLatency !== null) {\n      metrics.networkLatency = networkLatency;\n    }\n\n    return metrics;\n  } catch (error) {\n    logger.warn('Failed to measure comprehensive performance', { error: error as Error });\n    return {};\n  }\n};\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/hooks/performance-monitor-types.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'React' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":13,"suggestions":[{"messageId":"removeVar","data":{"varName":"React"},"fix":{"range":[7,18],"text":""},"desc":"Remove unused variable 'React'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'React' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":8,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":13}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\n\n/**\n * 性能监控相关类型定义\n */\n\n// 扩展Performance接口以包含memory属性\ndeclare global {\n  interface Performance {\n    memory?: {\n      usedJSHeapSize: number;\n      totalJSHeapSize: number;\n      jsHeapSizeLimit: number;\n    };\n  }\n}\n\n/**\n * 性能指标接口\n */\nexport interface PerformanceMetrics {\n  loadTime: number;\n  renderTime: number;\n  memoryUsage?: number;\n  networkLatency?: number;\n}\n\n/**\n * 性能警告接口\n */\nexport interface PerformanceAlert {\n  id: string;\n  level: 'info' | 'warning' | 'error';\n  message: string;\n  timestamp: number;\n  data?: Record<string, string | number | boolean>;\n}\n\n/**\n * 性能警告系统接口\n */\nexport interface PerformanceAlertSystem {\n  addAlert: (_alert: Omit<PerformanceAlert, 'id' | 'timestamp'>) => void;\n  getAlerts: () => PerformanceAlert[];\n  getAlertHistory: () => PerformanceAlert[];\n  clearAlerts: () => void;\n}\n\n/**\n * 性能警告阈值接口\n */\nexport interface PerformanceAlertThresholds {\n  loadTime?: number;\n  renderTime?: number;\n  memoryUsage?: number;\n}\n\n/**\n * 性能监控选项接口\n */\nexport interface UsePerformanceMonitorOptions {\n  enableAlerts?: boolean;\n  alertThresholds?: {\n    loadTime?: number;\n    renderTime?: number;\n    memoryUsage?: number;\n  };\n  monitoringInterval?: number;\n  enableMemoryMonitoring?: boolean;\n  enableNetworkMonitoring?: boolean;\n  enableRenderTimeMonitoring?: boolean;\n  enableLoadTimeMonitoring?: boolean;\n  enableAutoBaseline?: boolean;\n  maxAlerts?: number;\n  autoBaseline?: boolean;\n}\n\n/**\n * 性能监控返回值参数接口\n */\nexport interface PerformanceMonitorReturnParams {\n  isMonitoring: boolean;\n  metrics: PerformanceMetrics | null;\n  alerts: PerformanceAlert[];\n  error: string | null;\n  getMetrics: () => PerformanceMetrics | null;\n  startMonitoring: () => void;\n  stopMonitoring: () => void;\n  resetMetrics: () => void;\n  measureLoadTime: () => void;\n  measureRenderTime: () => void;\n  refreshMetrics: () => void;\n  clearAlerts: () => void;\n  performanceAlertSystem: PerformanceAlertSystem;\n}\n\n/**\n * 性能监控状态接口\n */\nexport interface PerformanceMonitorState {\n  enableAlerts: boolean;\n  alertThresholds: Required<PerformanceAlertThresholds>;\n  monitoringInterval: number;\n  enableMemoryMonitoring: boolean;\n  enableNetworkMonitoring: boolean;\n  enableRenderTimeMonitoring: boolean;\n  enableLoadTimeMonitoring: boolean;\n  enableAutoBaseline: boolean;\n  maxAlerts: number;\n}\n\n/**\n * 性能测量函数接口\n */\nexport interface PerformanceMeasurements {\n  measureLoadTime: () => void;\n  measureRenderTime: () => void;\n  measureMemoryUsage: () => void;\n}\n\n/**\n * 监控控制函数接口\n */\nexport interface MonitoringControls {\n  startMonitoring: () => void;\n  stopMonitoring: () => void;\n  resetMetrics: () => void;\n  refreshMetrics: () => void;\n}\n\n/**\n * 性能监控Hook返回值类型\n */\nexport type UsePerformanceMonitorReturn = {\n  isMonitoring: boolean;\n  metrics: PerformanceMetrics | null;\n  alerts: PerformanceAlert[];\n  error: string | null;\n  getMetrics: () => PerformanceMetrics | null;\n  startMonitoring: () => void;\n  stopMonitoring: () => void;\n  resetMetrics: () => void;\n  measureLoadTime: () => void;\n  measureRenderTime: () => void;\n  refreshMetrics: () => void;\n  clearAlerts: () => void;\n  performanceAlertSystem: PerformanceAlertSystem;\n};\n\n/**\n * 性能基准数据接口\n */\nexport interface PerformanceBaseline {\n  loadTime: number;\n  renderTime: number;\n  memoryUsage: number;\n  timestamp: number;\n}\n\n/**\n * 性能趋势数据接口\n */\nexport interface PerformanceTrend {\n  metric: keyof PerformanceMetrics;\n  values: number[];\n  timestamps: number[];\n  trend: 'improving' | 'degrading' | 'stable';\n}\n\n/**\n * 性能报告接口\n */\nexport interface PerformanceReport {\n  summary: PerformanceMetrics;\n  baseline?: PerformanceBaseline;\n  trends: PerformanceTrend[];\n  alerts: PerformanceAlert[];\n  recommendations: string[];\n  timestamp: number;\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/hooks/performance-monitor-utils.ts","messages":[{"ruleId":"max-params","severity":2,"message":"Arrow function has too many parameters (4). Maximum allowed is 3.","line":58,"column":27,"nodeType":"ArrowFunctionExpression","messageId":"exceed","endLine":58,"endColumn":29},{"ruleId":"max-params","severity":2,"message":"Arrow function has too many parameters (4). Maximum allowed is 3.","line":76,"column":23,"nodeType":"ArrowFunctionExpression","messageId":"exceed","endLine":76,"endColumn":25},{"ruleId":"complexity","severity":2,"message":"Arrow function has a complexity of 22. Maximum allowed is 15.","line":139,"column":43,"nodeType":"ArrowFunctionExpression","messageId":"complex","endLine":200,"endColumn":2},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 36.","line":206,"column":56,"nodeType":"Literal","messageId":"noMagic","endLine":206,"endColumn":58},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2.","line":206,"column":67,"nodeType":"Literal","messageId":"noMagic","endLine":206,"endColumn":68},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 9.","line":206,"column":70,"nodeType":"Literal","messageId":"noMagic","endLine":206,"endColumn":71},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2.","line":214,"column":24,"nodeType":"Literal","messageId":"noMagic","endLine":214,"endColumn":25},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2.","line":222,"column":36,"nodeType":"Literal","messageId":"noMagic","endLine":222,"endColumn":37},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2.","line":224,"column":43,"nodeType":"Literal","messageId":"noMagic","endLine":224,"endColumn":44}],"suppressedMessages":[],"errorCount":9,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport type {\n  PerformanceAlert,\n  PerformanceAlertSystem,\n  PerformanceAlertThresholds,\n  PerformanceMetrics,\n  PerformanceMonitorReturnParams,\n  UsePerformanceMonitorOptions,\n  PerformanceMonitorState,\n  MonitoringControls,\n} from './performance-monitor-types';\n\n/**\n * 性能监控常量\n */\nexport const PERFORMANCE_CONSTANTS = {\n  MEMORY_THRESHOLD_MB: 50,\n  MEMORY_BYTES_PER_MB: 1048576, // 1024 * 1024\n  TIME_CALCULATION_FACTOR: 36,\n  CALCULATION_DIVISOR: 2,\n  CALCULATION_MULTIPLIER: 9,\n} as const;\n\n/**\n * 默认性能警告阈值\n */\nexport const DEFAULT_ALERT_THRESHOLDS: Required<PerformanceAlertThresholds> = {\n  loadTime: 3000, // 3秒\n  renderTime: 16, // 16毫秒 (60fps)\n  memoryUsage: PERFORMANCE_CONSTANTS.MEMORY_THRESHOLD_MB * PERFORMANCE_CONSTANTS.MEMORY_BYTES_PER_MB,\n};\n\n/**\n * 辅助函数：检查内存使用并生成警告\n */\nexport const checkMemoryUsageAlert = (\n  memoryUsage: number,\n  threshold: number,\n  addAlert: (_alert: Omit<PerformanceAlert, 'id' | 'timestamp'>) => void,\n) => {\n  if (memoryUsage > threshold) {\n    addAlert({\n      level: 'error',\n      message: `High memory usage detected: ${Math.round(memoryUsage / PERFORMANCE_CONSTANTS.MEMORY_BYTES_PER_MB)}MB`,\n      data: { memoryUsage },\n    });\n  }\n};\n\n/**\n * 辅助函数：创建性能警告系统\n */\nexport const createPerformanceAlertSystem = (\n  alerts: PerformanceAlert[],\n  alertHistory: React.MutableRefObject<PerformanceAlert[]>,\n  addAlert: (_alert: Omit<PerformanceAlert, 'id' | 'timestamp'>) => void,\n  setAlerts: React.Dispatch<React.SetStateAction<PerformanceAlert[]>>,\n): PerformanceAlertSystem => ({\n  addAlert,\n  getAlerts: () => alerts,\n  getAlertHistory: () => alertHistory.current,\n  clearAlerts: () => {\n    setAlerts([]);\n    alertHistory.current = [];\n  },\n});\n\n/**\n * 辅助函数：创建监控控制函数\n */\nexport const createMonitoringControls = (\n  setIsMonitoring: React.Dispatch<React.SetStateAction<boolean>>,\n  _setError: React.Dispatch<React.SetStateAction<string | null>>,\n  startTime: React.MutableRefObject<number | null>,\n  setMetrics: React.Dispatch<React.SetStateAction<PerformanceMetrics | null>>,\n): MonitoringControls => ({\n  startMonitoring: () => {\n    setIsMonitoring(true);\n    startTime.current = performance.now();\n    _setError(null);\n  },\n  stopMonitoring: () => {\n    setIsMonitoring(false);\n    startTime.current = null;\n  },\n  resetMetrics: () => {\n    setMetrics(null);\n    startTime.current = null;\n    _setError(null);\n  },\n  refreshMetrics: () => {\n    // 刷新当前指标\n    _setError(null);\n  },\n});\n\n/**\n * 辅助函数：创建返回对象\n */\nexport const createPerformanceMonitorReturn = (\n  params: PerformanceMonitorReturnParams,\n) => {\n  const {\n    isMonitoring,\n    metrics,\n    alerts,\n    error,\n    getMetrics,\n    startMonitoring,\n    stopMonitoring,\n    resetMetrics,\n    measureLoadTime,\n    measureRenderTime,\n    refreshMetrics,\n    clearAlerts,\n    performanceAlertSystem,\n  } = params;\n\n  return {\n    isMonitoring,\n    metrics,\n    alerts,\n    error,\n    getMetrics,\n    startMonitoring,\n    stopMonitoring,\n    resetMetrics,\n    measureLoadTime,\n    measureRenderTime,\n    refreshMetrics,\n    clearAlerts,\n    performanceAlertSystem,\n  };\n};\n\n/**\n * 验证和清理选项的辅助函数\n */\nexport const validateAndSanitizeOptions = (\n  options: UsePerformanceMonitorOptions,\n): PerformanceMonitorState => {\n  // Validate and sanitize options to handle null/undefined/invalid values\n  const safeOptions = options || {};\n\n  const {\n    enableAlerts = false,\n    alertThresholds = {},\n    monitoringInterval = 1000,\n    enableMemoryMonitoring = true,\n    enableNetworkMonitoring = false,\n    enableRenderTimeMonitoring = true,\n    enableLoadTimeMonitoring = true,\n    enableAutoBaseline = false,\n    maxAlerts = 100,\n  } = safeOptions;\n\n  // Validate alertThresholds with proper fallbacks\n  const safeAlertThresholds = alertThresholds || {};\n  const validatedAlertThresholds: Required<PerformanceAlertThresholds> = {\n    loadTime:\n      typeof safeAlertThresholds.loadTime === 'number' &&\n      safeAlertThresholds.loadTime > 0\n        ? safeAlertThresholds.loadTime\n        : DEFAULT_ALERT_THRESHOLDS.loadTime,\n    renderTime:\n      typeof safeAlertThresholds.renderTime === 'number' &&\n      safeAlertThresholds.renderTime > 0\n        ? safeAlertThresholds.renderTime\n        : DEFAULT_ALERT_THRESHOLDS.renderTime,\n    memoryUsage:\n      typeof safeAlertThresholds.memoryUsage === 'number' &&\n      safeAlertThresholds.memoryUsage > 0\n        ? safeAlertThresholds.memoryUsage\n        : DEFAULT_ALERT_THRESHOLDS.memoryUsage,\n  };\n\n  // Validate monitoringInterval\n  const validMonitoringInterval =\n    typeof monitoringInterval === 'number' && monitoringInterval > 0\n      ? Math.max(100, monitoringInterval) // Minimum 100ms\n      : 1000;\n\n  // Validate maxAlerts\n  const validMaxAlerts =\n    typeof maxAlerts === 'number' && maxAlerts > 0\n      ? Math.min(1000, Math.max(1, maxAlerts)) // Between 1 and 1000\n      : 100;\n\n  return {\n    enableAlerts: Boolean(enableAlerts),\n    alertThresholds: validatedAlertThresholds,\n    enableMemoryMonitoring: Boolean(enableMemoryMonitoring),\n    enableNetworkMonitoring: Boolean(enableNetworkMonitoring),\n    enableRenderTimeMonitoring: Boolean(enableRenderTimeMonitoring),\n    enableLoadTimeMonitoring: Boolean(enableLoadTimeMonitoring),\n    enableAutoBaseline: Boolean(enableAutoBaseline),\n    maxAlerts: validMaxAlerts,\n    monitoringInterval: validMonitoringInterval,\n  };\n};\n\n/**\n * 生成唯一ID的辅助函数\n */\nexport const generateAlertId = (): string => {\n  return `alert_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n};\n\n/**\n * 格式化内存使用量的辅助函数\n */\nexport const formatMemoryUsage = (bytes: number): string => {\n  const mb = bytes / PERFORMANCE_CONSTANTS.MEMORY_BYTES_PER_MB;\n  return `${mb.toFixed(2)}MB`;\n};\n\n/**\n * 格式化时间的辅助函数\n */\nexport const formatTime = (milliseconds: number): string => {\n  if (milliseconds < 1000) {\n    return `${milliseconds.toFixed(2)}ms`;\n  }\n  return `${(milliseconds / 1000).toFixed(2)}s`;\n};\n\n/**\n * 检查性能指标是否超过阈值\n */\nexport const checkPerformanceThresholds = (\n  metrics: PerformanceMetrics,\n  thresholds: Required<PerformanceAlertThresholds>,\n  addAlert: (_alert: Omit<PerformanceAlert, 'id' | 'timestamp'>) => void,\n): void => {\n  // 检查加载时间\n  if (metrics.loadTime > thresholds.loadTime) {\n    addAlert({\n      level: 'warning',\n      message: `Slow load time detected: ${formatTime(metrics.loadTime)}`,\n      data: { loadTime: metrics.loadTime, threshold: thresholds.loadTime },\n    });\n  }\n\n  // 检查渲染时间\n  if (metrics.renderTime > thresholds.renderTime) {\n    addAlert({\n      level: 'warning',\n      message: `Slow render time detected: ${formatTime(metrics.renderTime)}`,\n      data: { renderTime: metrics.renderTime, threshold: thresholds.renderTime },\n    });\n  }\n\n  // 检查内存使用\n  if (metrics.memoryUsage && metrics.memoryUsage > thresholds.memoryUsage) {\n    addAlert({\n      level: 'error',\n      message: `High memory usage detected: ${formatMemoryUsage(metrics.memoryUsage)}`,\n      data: { memoryUsage: metrics.memoryUsage, threshold: thresholds.memoryUsage },\n    });\n  }\n};\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/hooks/theme-transition-core.ts","messages":[{"ruleId":"max-params","severity":2,"message":"Function 'executeThemeTransition' has too many parameters (5). Maximum allowed is 3.","line":20,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":20,"endColumn":39},{"ruleId":"max-statements","severity":2,"message":"Function 'executeThemeTransition' has too many statements (24). Maximum allowed is 20.","line":20,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":126,"endColumn":2},{"ruleId":"max-params","severity":2,"message":"Function 'executeCircularThemeTransition' has too many parameters (4). Maximum allowed is 3.","line":142,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":142,"endColumn":47}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { logger } from '@/lib/logger';\nimport { themeAnalytics } from '@/lib/theme-analytics';\nimport type {\n  ViewTransition,\n  ViewTransitionAPI,\n  ThemeTransitionConfig\n} from './theme-transition-types';\nimport {\n  DEFAULT_CONFIG,\n  supportsViewTransitions,\n  getClickCoordinates,\n  calculateEndRadius,\n  recordThemeTransition,\n} from './theme-transition-utils';\n\n/**\n * 执行主题切换的核心逻辑\n */\nexport function executeThemeTransition(\n  originalSetTheme: (_theme: string) => void,\n  newTheme: string,\n  _currentTheme: string = 'unknown',\n  _config: ThemeTransitionConfig = DEFAULT_CONFIG,\n  _animationSetup?: (_transition: ViewTransition) => void,\n): void {\n  const startTime = performance.now();\n\n  try {\n    // 记录主题偏好\n    themeAnalytics.recordThemePreference(newTheme);\n\n    // 标记性能开始点\n    if (typeof window !== 'undefined' && window.performance) {\n      performance.mark(`theme-transition-${_currentTheme}-start`);\n    }\n\n    // 检查是否支持 View Transitions API\n    if (!supportsViewTransitions()) {\n      logger.debug('View Transitions API not supported, using fallback');\n      originalSetTheme(newTheme);\n\n      recordThemeTransition({\n        fromTheme: _currentTheme,\n        toTheme: newTheme,\n        startTime,\n        endTime: performance.now(),\n        hasViewTransition: false,\n      });\n      return;\n    }\n\n    // 使用 View Transitions API\n    try {\n      const documentWithTransition = document as Document & ViewTransitionAPI;\n      const transition = documentWithTransition.startViewTransition(() => {\n        originalSetTheme(newTheme);\n      });\n\n      // 如果提供了动画设置函数，则调用它\n      if (_animationSetup) {\n        _animationSetup(transition);\n      }\n\n      // 监听转换完成\n      transition.finished\n        .then(() => {\n          recordThemeTransition({\n            fromTheme: _currentTheme,\n            toTheme: newTheme,\n            startTime,\n            endTime: performance.now(),\n            hasViewTransition: true,\n          });\n        })\n        .catch((error: Error) => {\n          logger.error('View transition failed', { error, newTheme });\n          recordThemeTransition({\n            fromTheme: _currentTheme,\n            toTheme: newTheme,\n            startTime,\n            endTime: performance.now(),\n            hasViewTransition: true,\n            error,\n          });\n        });\n    } catch (transitionError) {\n      logger.error('Failed to start view transition', {\n        error: transitionError,\n        newTheme,\n      });\n\n      // 降级到普通切换\n      originalSetTheme(newTheme);\n      recordThemeTransition({\n        fromTheme: _currentTheme,\n        toTheme: newTheme,\n        startTime,\n        endTime: performance.now(),\n        hasViewTransition: false,\n        error: transitionError as Error,\n      });\n    }\n  } catch (error) {\n    logger.error('Theme transition failed', { error, newTheme });\n\n    // 确保主题仍然被设置，即使出现错误\n    try {\n      originalSetTheme(newTheme);\n    } catch (setThemeError) {\n      logger.error('Failed to set theme as fallback', {\n        error: setThemeError,\n        newTheme,\n      });\n    }\n\n    recordThemeTransition({\n      fromTheme: _currentTheme,\n      toTheme: newTheme,\n      startTime,\n      endTime: performance.now(),\n      hasViewTransition: false,\n      error: error as Error,\n    });\n  }\n}\n\n/**\n * 执行基础主题切换\n */\nexport function executeBasicThemeTransition(\n  originalSetTheme: (_theme: string) => void,\n  newTheme: string,\n  _currentTheme?: string,\n): void {\n  executeThemeTransition(originalSetTheme, newTheme, _currentTheme);\n}\n\n/**\n * 执行圆形动画主题切换\n */\nexport function executeCircularThemeTransition(\n  originalSetTheme: (_theme: string) => void,\n  newTheme: string,\n  _currentTheme?: string,\n  _clickEvent?: React.MouseEvent<HTMLElement>,\n): void {\n  const { x, y } = getClickCoordinates(_clickEvent);\n  const endRadius = calculateEndRadius(x, y);\n\n  const animationSetup = (transition: ViewTransition) => {\n    // 设置圆形展开动画\n    transition.ready.then(() => {\n      const clipPath = [\n        `circle(0px at ${x}px ${y}px)`,\n        `circle(${endRadius}px at ${x}px ${y}px)`,\n      ];\n\n      document.documentElement.animate(\n        {\n          clipPath,\n        },\n        {\n          duration: DEFAULT_CONFIG.animationDuration,\n          easing: DEFAULT_CONFIG.easing,\n          pseudoElement: '::view-transition-new(root)',\n        },\n      );\n    }).catch((error: Error) => {\n      logger.warn('Failed to setup circular animation', { error });\n    });\n  };\n\n  executeThemeTransition(\n    originalSetTheme,\n    newTheme,\n    _currentTheme,\n    DEFAULT_CONFIG,\n    animationSetup,\n  );\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/hooks/theme-transition-types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/hooks/theme-transition-utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/hooks/use-breakpoint.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/hooks/use-enhanced-theme.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'ThemeTransitionOptions' is defined but never used. Allowed unused vars must match /^_/u.","line":7,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"ThemeTransitionOptions"},"fix":{"range":[149,175],"text":""},"desc":"Remove unused variable 'ThemeTransitionOptions'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ThemeTransitionOptions' is defined but never used. Allowed unused vars must match /^_/u.","line":7,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":25}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport React, { useCallback, useMemo, useRef } from 'react';\nimport { useTheme } from 'next-themes';\nimport type {\n  EnhancedThemeHook,\n  ThemeTransitionOptions\n} from './theme-transition-types';\nimport {\n  DEFAULT_CONFIG,\n  createDebounce\n} from './theme-transition-utils';\nimport {\n  executeBasicThemeTransition,\n  executeCircularThemeTransition,\n} from './theme-transition-core';\n\n/**\n * 增强的主题切换 Hook\n *\n * 提供以下功能：\n * - 基础主题切换（带防抖）\n * - 圆形动画主题切换（基于点击位置）\n * - View Transitions API 支持\n * - 自动降级到普通切换\n * - 防抖机制防止快速连续切换\n * - 缓存 View Transitions API 支持检测结果\n * - 统一的错误处理和性能监控\n * - 类型安全的 API 设计\n */\nexport function useEnhancedTheme(): EnhancedThemeHook {\n  const { theme, setTheme: originalSetTheme, ...rest } = useTheme();\n\n  // 使用 ref 来存储防抖函数，避免重复创建\n  const debouncedSetThemeRef = useRef<((_theme: string) => void) | null>(null);\n  const debouncedSetCircularThemeRef = useRef<\n    ((_theme: string, _clickEvent?: React.MouseEvent<HTMLElement>) => void) | null\n  >(null);\n\n  // 创建防抖的基础主题切换函数\n  const setTheme = useCallback(\n    (newTheme: string) => {\n      if (!debouncedSetThemeRef.current) {\n        debouncedSetThemeRef.current = createDebounce(\n          (themeToSet: string) => {\n            executeBasicThemeTransition(originalSetTheme, themeToSet, theme);\n          },\n          DEFAULT_CONFIG.debounceDelay,\n        );\n      }\n      debouncedSetThemeRef.current(newTheme);\n    },\n    [originalSetTheme, theme],\n  );\n\n  // 创建防抖的圆形动画主题切换函数\n  const setCircularTheme = useCallback(\n    (newTheme: string, clickEvent?: React.MouseEvent<HTMLElement>) => {\n      if (!debouncedSetCircularThemeRef.current) {\n        debouncedSetCircularThemeRef.current = createDebounce(\n          (themeToSet: string, event?: React.MouseEvent<HTMLElement>) => {\n            executeCircularThemeTransition(originalSetTheme, themeToSet, theme, event);\n          },\n          DEFAULT_CONFIG.debounceDelay,\n        );\n      }\n      debouncedSetCircularThemeRef.current(newTheme, clickEvent);\n    },\n    [originalSetTheme, theme],\n  );\n\n  // 返回增强的主题 Hook\n  return useMemo(\n    () => ({\n      theme,\n      setTheme,\n      setCircularTheme,\n      ...rest,\n    }),\n    [theme, setTheme, setCircularTheme, rest],\n  );\n}\n\n/**\n * 导出配置常量供外部使用\n */\nexport { DEFAULT_CONFIG as THEME_TRANSITION_CONFIG } from './theme-transition-utils';\n\n/**\n * 导出类型定义\n */\nexport type {\n  EnhancedThemeHook,\n  ThemeTransitionOptions,\n  ThemeTransitionConfig,\n  ViewTransition,\n  ViewTransitionAPI,\n} from './theme-transition-types';\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/hooks/use-enhanced-translations.ts","messages":[{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from '@typescript-eslint/no-explicit-any').","line":3,"column":1,"severity":1,"nodeType":null,"fix":{"range":[55,91],"text":""}},{"ruleId":"max-params","severity":2,"message":"Arrow function has too many parameters (4). Maximum allowed is 3.","line":94,"column":7,"nodeType":"ArrowFunctionExpression","messageId":"exceed","endLine":94,"endColumn":9}],"suppressedMessages":[{"ruleId":"max-lines-per-function","severity":2,"message":"Function 'useEnhancedTranslations' has too many lines (158). Maximum allowed is 120.","line":15,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":202,"endColumn":2,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":78,"column":11,"nodeType":"MemberExpression","endLine":78,"endColumn":19,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-unused-vars","severity":2,"message":"'chunks' is defined but never used. Allowed unused args must match /^_/u.","line":104,"column":35,"nodeType":"Identifier","messageId":"unusedVar","endLine":104,"endColumn":58,"suggestions":[{"messageId":"removeVar","data":{"varName":"chunks"},"fix":{"range":[2586,2609],"text":""},"desc":"Remove unused variable 'chunks'."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-undef","severity":2,"message":"'React' is not defined.","line":104,"column":43,"nodeType":"Identifier","messageId":"undef","endLine":104,"endColumn":48,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-undef","severity":2,"message":"'React' is not defined.","line":104,"column":63,"nodeType":"Identifier","messageId":"undef","endLine":104,"endColumn":68,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-shadow","severity":2,"message":"'options' is already declared in the upper scope on line 16 column 3.","line":132,"column":21,"nodeType":"Identifier","messageId":"noShadow","endLine":132,"endColumn":55,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-shadow","severity":2,"message":"'options' is already declared in the upper scope on line 16 column 3.","line":144,"column":18,"nodeType":"Identifier","messageId":"noShadow","endLine":144,"endColumn":54,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":1,"source":"'use client';\n\n/* eslint-disable max-lines-per-function, @typescript-eslint/no-explicit-any, no-unused-vars, security/detect-object-injection, no-undef, no-shadow */\nimport { useCallback, useMemo } from 'react';\nimport { useLocale, useTranslations } from 'next-intl';\nimport { I18nPerformanceMonitor } from '@/lib/i18n-performance';\n\ninterface UseEnhancedTranslationsOptions {\n  namespace?: string;\n  fallback?: boolean;\n  analytics?: boolean;\n  preload?: string[];\n}\n\nexport function useEnhancedTranslations(\n  options: UseEnhancedTranslationsOptions = {},\n) {\n  const {\n    namespace,\n    fallback = true,\n    analytics = true,\n    preload = [],\n  } = options;\n  const t = useTranslations(namespace);\n  const locale = useLocale();\n\n  // 预加载指定的翻译键 - 使用useMemo避免effect中的数据传递\n  useMemo(() => {\n    if (preload.length > 0) {\n      preload.forEach((key) => {\n        try {\n          t(key);\n        } catch {\n          // 忽略预加载错误\n        }\n      });\n    }\n    return null;\n  }, [preload, t]);\n\n  // 增强的翻译函数\n  const enhancedT = useCallback(\n    (key: string, values?: Record<string, string | number | boolean | Record<string, unknown> | unknown[]>) => {\n      const startTime = performance.now();\n\n      try {\n        const result = t(key, values);\n\n        // 记录加载时间\n        if (analytics) {\n          const loadTime = performance.now() - startTime;\n          I18nPerformanceMonitor.recordLoadTime(loadTime);\n        }\n\n        // 检查是否使用了回退\n        if (result === key && fallback) {\n          return `[${locale.toUpperCase()}] ${key}`;\n        }\n\n        return result;\n      } catch {\n        // 记录翻译错误\n        if (analytics) {\n          I18nPerformanceMonitor.recordError();\n        }\n\n        return fallback ? `[ERROR] ${key}` : key;\n      }\n    },\n    [t, locale, fallback, analytics],\n  );\n\n  // 批量翻译函数\n  const batchT = useCallback(\n    (keys: string[], values?: Record<string, string | number | boolean | Record<string, unknown> | unknown[]>) => {\n      return keys.reduce(\n        (acc, key) => {\n          acc[key] = enhancedT(key, values);\n          return acc;\n        },\n        {} as Record<string, string>,\n      );\n    },\n    [enhancedT],\n  );\n\n  // 条件翻译函数\n  const conditionalT = useCallback(\n    (\n      condition: boolean,\n      trueKey: string,\n      falseKey: string,\n      values?: Record<string, string | number | boolean | Record<string, unknown> | unknown[]>,\n    ) => {\n      return enhancedT(condition ? trueKey : falseKey, values);\n    },\n    [enhancedT],\n  );\n\n  // 富文本翻译函数\n  const richT = useCallback(\n    (\n      key: string,\n      components: Record<string, (chunks: React.ReactNode) => React.ReactNode>,\n    ) => {\n      try {\n        return t.rich(key, components);\n      } catch {\n        if (analytics) {\n          I18nPerformanceMonitor.recordError();\n        }\n        return fallback ? `[RICH ERROR] ${key}` : key;\n      }\n    },\n    [t, fallback, analytics],\n  );\n\n  // 翻译存在检查\n  const hasTranslation = useCallback(\n    (key: string) => {\n      try {\n        return t.has(key);\n      } catch {\n        return false;\n      }\n    },\n    [t],\n  );\n\n  // 格式化数字\n  const formatNumber = useCallback(\n    (value: number, options?: Intl.NumberFormatOptions) => {\n      try {\n        return new Intl.NumberFormat(locale, options).format(value);\n      } catch {\n        return value.toString();\n      }\n    },\n    [locale],\n  );\n\n  // 格式化日期\n  const formatDate = useCallback(\n    (date: Date, options?: Intl.DateTimeFormatOptions) => {\n      try {\n        return new Intl.DateTimeFormat(locale, options).format(date);\n      } catch {\n        return date.toISOString();\n      }\n    },\n    [locale],\n  );\n\n  // 格式化相对时间\n  const formatRelativeTime = useCallback(\n    (value: number, unit: Intl.RelativeTimeFormatUnit) => {\n      try {\n        return new Intl.RelativeTimeFormat(locale, { numeric: 'auto' }).format(\n          value,\n          unit,\n        );\n      } catch {\n        return `${value} ${unit}`;\n      }\n    },\n    [locale],\n  );\n\n  // 获取性能指标\n  const getPerformanceMetrics = useCallback(() => {\n    return I18nPerformanceMonitor.getMetrics();\n  }, []);\n\n  return useMemo(\n    () => ({\n      t: enhancedT,\n      batchT,\n      conditionalT,\n      richT,\n      hasTranslation,\n      formatNumber,\n      formatDate,\n      formatRelativeTime,\n      getPerformanceMetrics,\n      locale,\n      namespace,\n    }),\n    [\n      enhancedT,\n      batchT,\n      conditionalT,\n      richT,\n      hasTranslation,\n      formatNumber,\n      formatDate,\n      formatRelativeTime,\n      getPerformanceMetrics,\n      locale,\n      namespace,\n    ],\n  );\n}\n\n// 性能监控Hook\nexport function useI18nPerformance() {\n  const getMetrics = useCallback(() => {\n    return I18nPerformanceMonitor.getMetrics();\n  }, []);\n\n  const resetMetrics = useCallback(() => {\n    I18nPerformanceMonitor.reset();\n  }, []);\n\n  return {\n    getMetrics,\n    resetMetrics,\n  };\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/hooks/use-intersection-observer.ts","messages":[{"ruleId":"max-params","severity":2,"message":"Function 'setVisibilityState' has too many parameters (4). Maximum allowed is 3.","line":77,"column":1,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":77,"endColumn":28},{"ruleId":"max-params","severity":2,"message":"Function 'createObserver' has too many parameters (4). Maximum allowed is 3.","line":91,"column":1,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":91,"endColumn":24}],"suppressedMessages":[{"ruleId":"react-you-might-not-need-an-effect/no-event-handler","severity":2,"message":"Avoid using state and effects as an event handler. Instead, call the event handling code directly when the event occurs.","line":178,"column":9,"nodeType":"UnaryExpression","messageId":"avoidEventHandler","endLine":178,"endColumn":17,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useCallback, useEffect, useRef, useState } from 'react';\nimport { AccessibilityManager } from '@/lib/accessibility';\nimport { logger } from '@/lib/logger';\n\n/**\n * Intersection Observer Hook 配置选项\n */\nexport interface IntersectionObserverOptions {\n  /** 触发阈值，0-1之间的数值 */\n  threshold?: number;\n  /** 根元素的外边距 */\n  rootMargin?: string;\n  /** 是否只触发一次 */\n  triggerOnce?: boolean;\n  /** 根元素，默认为视口 */\n  root?: Element | null;\n}\n\n/**\n * Hook 返回值类型\n */\nexport interface IntersectionObserverHookReturn<\n  T extends HTMLElement = HTMLElement,\n> {\n  /** 要观察的元素引用 - 回调函数形式 */\n  ref: (_node: T | null) => void;\n  /** 当前是否可见 */\n  isVisible: boolean;\n  /** 是否曾经可见过 */\n  hasBeenVisible: boolean;\n}\n\n/**\n * 默认配置\n */\nconst DEFAULT_OPTIONS: Required<Omit<IntersectionObserverOptions, 'root'>> = {\n  threshold: 0.1,\n  rootMargin: '0px',\n  triggerOnce: true,\n};\n\n/**\n * 滚动触发动画Hook\n *\n * 基于原生Intersection Observer API，为组件提供滚动触发的可见性检测。\n * 集成可访问性支持，遵循项目现有Hook模式。\n *\n * @param options - 配置选项\n * @returns Hook返回值，包含ref、可见性状态等\n *\n * @example\n * ```tsx\n * function AnimatedComponent() {\n *   const { ref, isVisible } = useIntersectionObserver({\n *     threshold: 0.2,\n *     triggerOnce: true\n *   });\n *\n *   return (\n *     <div\n *       ref={ref}\n *       className={`transition-all duration-700 ${\n *         isVisible ? 'opacity-100 translate-y-0' : 'opacity-0 translate-y-8'\n *       }`}\n *     >\n *       Content\n *     </div>\n *   );\n * }\n * ```\n */\n/**\n * 处理可见性状态的辅助函数\n */\nfunction setVisibilityState(\n  setIsVisible: (_visible: boolean) => void,\n  setHasBeenVisible: (_visible: boolean) => void,\n  hasBeenVisibleRef: { current: boolean },\n  visible: boolean,\n) {\n  setIsVisible(visible);\n  setHasBeenVisible(visible);\n  hasBeenVisibleRef.current = visible;\n}\n\n/**\n * 创建 IntersectionObserver 的辅助函数\n */\nfunction createObserver(\n  element: HTMLElement,\n  handleIntersection: (\n    _entries: IntersectionObserverEntry[],\n    _observer: IntersectionObserver,\n  ) => void,\n  config: IntersectionObserverOptions & {\n    threshold: number;\n    rootMargin: string;\n    triggerOnce: boolean;\n  },\n  fallbackToVisible: () => void,\n): (() => void) | null {\n  try {\n    const observer = new IntersectionObserver(\n      (entries) => {\n        handleIntersection(entries, observer);\n      },\n      {\n        threshold: config.threshold,\n        rootMargin: config.rootMargin,\n        root: config.root || null,\n      },\n    );\n\n    observer.observe(element);\n\n    return () => {\n      observer.unobserve(element);\n      observer.disconnect();\n    };\n  } catch (error) {\n    logger.warn('IntersectionObserver error', {\n      error: error instanceof Error ? error.message : String(error),\n      threshold: config.threshold,\n      rootMargin: config.rootMargin,\n    });\n    fallbackToVisible();\n    return null;\n  }\n}\n\nexport function useIntersectionObserver<T extends HTMLElement = HTMLElement>(\n  options: IntersectionObserverOptions = {},\n): IntersectionObserverHookReturn<T> {\n  const ref = useRef<T | null>(null);\n  const [isVisible, setIsVisible] = useState(false);\n  const [hasBeenVisible, setHasBeenVisible] = useState(false);\n  const [element, setElement] = useState<T | null>(null);\n  const hasBeenVisibleRef = useRef(false);\n\n  // 提取所有配置值，避免依赖整个config对象\n  const threshold = options.threshold ?? DEFAULT_OPTIONS.threshold;\n  const rootMargin = options.rootMargin ?? DEFAULT_OPTIONS.rootMargin;\n  const triggerOnce = options.triggerOnce ?? DEFAULT_OPTIONS.triggerOnce;\n  const root = options.root ?? null;\n\n  const prefersReducedMotion = AccessibilityManager.prefersReducedMotion();\n\n  const callbackRef = useCallback((node: T | null) => {\n    ref.current = node;\n    setElement(node);\n  }, []);\n\n  const handleIntersection = useCallback(\n    (entries: IntersectionObserverEntry[], observer: IntersectionObserver) => {\n      const entry = entries.length > 0 ? entries[0] : null;\n      if (!entry) return;\n\n      const isCurrentlyVisible = entry.isIntersecting;\n      setIsVisible(isCurrentlyVisible);\n\n      if (isCurrentlyVisible && !hasBeenVisibleRef.current) {\n        hasBeenVisibleRef.current = true;\n        setHasBeenVisible(true);\n      }\n\n      // 只有在 triggerOnce 为 true 且元素当前可见时才停止观察\n      if (triggerOnce && isCurrentlyVisible && entry.target) {\n        observer.unobserve(entry.target);\n      }\n    },\n    [triggerOnce],\n  );\n\n  useEffect(() => {\n    // eslint-disable-next-line react-you-might-not-need-an-effect/no-event-handler\n    if (!element) return undefined;\n\n    const fallbackToVisible = () =>\n      setVisibilityState(\n        setIsVisible,\n        setHasBeenVisible,\n        hasBeenVisibleRef,\n        true,\n      );\n\n    if (\n      prefersReducedMotion ||\n      typeof window === 'undefined' ||\n      !window.IntersectionObserver\n    ) {\n      fallbackToVisible();\n      return undefined;\n    }\n\n    // 创建配置对象，使用提取的稳定值\n    const config = {\n      threshold,\n      rootMargin,\n      triggerOnce,\n      root,\n    };\n\n    return (\n      createObserver(element, handleIntersection, config, fallbackToVisible) ||\n      undefined\n    );\n  }, [\n    element,\n    threshold,\n    rootMargin,\n    triggerOnce,\n    root,\n    handleIntersection,\n    prefersReducedMotion,\n  ]);\n\n  return {\n    ref: callbackRef,\n    isVisible,\n    hasBeenVisible,\n  };\n}\n\n/**\n * 带延迟的滚动触发Hook\n *\n * 在基础Hook的基础上添加延迟功能，用于实现stagger动画效果\n *\n * @param options - 配置选项\n * @param delay - 延迟时间（毫秒）\n * @returns Hook返回值\n */\nexport function useIntersectionObserverWithDelay(\n  options: IntersectionObserverOptions = {},\n  delay = 0,\n): IntersectionObserverHookReturn {\n  const {\n    ref,\n    isVisible: baseIsVisible,\n    hasBeenVisible,\n  } = useIntersectionObserver(options);\n  const [isVisible, setIsVisible] = useState(false);\n\n  useEffect(() => {\n    if (baseIsVisible && delay > 0) {\n      const timer = setTimeout(() => {\n        setIsVisible(true);\n      }, delay);\n\n      return () => clearTimeout(timer);\n    } else if (baseIsVisible) {\n      setIsVisible(true);\n    } else {\n      setIsVisible(false);\n    }\n\n    return undefined;\n  }, [baseIsVisible, delay]);\n\n  return {\n    ref,\n    isVisible,\n    hasBeenVisible,\n  };\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/hooks/use-keyboard-navigation.ts","messages":[{"ruleId":"max-params","severity":2,"message":"Function 'handleTabKey' has too many parameters (4). Maximum allowed is 3.","line":86,"column":1,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":86,"endColumn":22},{"ruleId":"max-params","severity":2,"message":"Function 'useNavigationActions' has too many parameters (4). Maximum allowed is 3.","line":151,"column":1,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":151,"endColumn":30},{"ruleId":"max-params","severity":2,"message":"Function 'useKeyboardHandler' has too many parameters (4). Maximum allowed is 3.","line":201,"column":1,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":201,"endColumn":28}],"suppressedMessages":[{"ruleId":"no-empty-function","severity":2,"message":"Unexpected empty method 'onNavigate'.","line":32,"column":21,"nodeType":"ArrowFunctionExpression","messageId":"unexpected","endLine":32,"endColumn":23,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport React, { useCallback, useEffect, useMemo, useRef } from 'react';\n\nexport interface KeyboardNavigationOptions {\n  enabled?: boolean;\n  loop?: boolean;\n  orientation?: 'horizontal' | 'vertical' | 'both';\n  selector?: string;\n  onNavigate?: (_element: HTMLElement, _direction: string) => void;\n}\n\nexport interface UseKeyboardNavigationReturn {\n  containerRef: React.RefObject<HTMLElement | null>;\n  focusFirst: () => void;\n  focusLast: () => void;\n  focusNext: () => void;\n  focusPrevious: () => void;\n  getCurrentFocusIndex: () => number;\n  setFocusIndex: (_index: number) => void;\n}\n\nexport type KeyboardNavigationConfig = Required<KeyboardNavigationOptions>;\n\nconst defaultOptions: Required<KeyboardNavigationOptions> = {\n  enabled: true,\n  loop: true,\n  orientation: 'both',\n  selector:\n    '[tabindex]:not([tabindex=\"-1\"]), button:not([disabled]), input:not([disabled]), select:not([disabled]), textarea:not([disabled]), a[href], [contenteditable=\"true\"]',\n  // eslint-disable-next-line no-empty-function\n  onNavigate: () => {},\n};\n\n// 箭头键处理配置接口\ninterface ArrowKeyConfig {\n  key: string;\n  isHorizontal: boolean;\n  isVertical: boolean;\n  event: KeyboardEvent;\n  focusNext: () => void;\n  focusPrevious: () => void;\n}\n\n// 处理箭头键导航的辅助函数\nfunction handleArrowKey(config: ArrowKeyConfig): boolean {\n  const { key, isHorizontal, isVertical, event, focusNext, focusPrevious } =\n    config;\n  switch (key) {\n    case 'ArrowRight':\n      if (isHorizontal) {\n        event.preventDefault();\n        focusNext();\n        return true;\n      }\n      break;\n    case 'ArrowLeft':\n      if (isHorizontal) {\n        event.preventDefault();\n        focusPrevious();\n        return true;\n      }\n      break;\n    case 'ArrowDown':\n      if (isVertical) {\n        event.preventDefault();\n        focusNext();\n        return true;\n      }\n      break;\n    case 'ArrowUp':\n      if (isVertical) {\n        event.preventDefault();\n        focusPrevious();\n        return true;\n      }\n      break;\n    default:\n      // 不处理其他按键\n      break;\n  }\n  return false;\n}\n\n// 处理Tab键的辅助函数\nfunction handleTabKey(\n  event: KeyboardEvent,\n  config: KeyboardNavigationConfig,\n  getFocusableElements: () => HTMLElement[],\n  getCurrentFocusIndex: () => number,\n): boolean {\n  const direction = event.shiftKey ? 'previous' : 'next';\n  const elements = getFocusableElements();\n  const currentIndex = getCurrentFocusIndex();\n  const targetElement = event.shiftKey\n    ? elements[currentIndex - 1]\n    : elements[currentIndex + 1];\n\n  if (targetElement) {\n    config.onNavigate(targetElement, direction);\n    return true;\n  }\n  return false;\n}\n\n/**\n * 创建焦点管理函数\n */\nfunction useFocusManagement(\n  containerRef: React.RefObject<HTMLElement | null>,\n  config: KeyboardNavigationConfig,\n) {\n  const getFocusableElements = useCallback((): HTMLElement[] => {\n    if (!containerRef.current) return [];\n\n    const elements = containerRef.current.querySelectorAll(config.selector);\n    return Array.from(elements) as HTMLElement[];\n  }, [containerRef, config.selector]);\n\n  const getCurrentFocusIndex = useCallback((): number => {\n    const elements = getFocusableElements();\n    const activeElement = document.activeElement as HTMLElement;\n    return elements.indexOf(activeElement);\n  }, [getFocusableElements]);\n\n  const setFocusIndex = useCallback(\n    (index: number): void => {\n      const elements = getFocusableElements();\n      // 安全的数组访问，避免对象注入\n      if (index >= 0 && index < elements.length && Array.isArray(elements)) {\n        const element = elements.at(index);\n        if (element) {\n          element.focus();\n          config.onNavigate(element, 'direct');\n        }\n      }\n    },\n    [getFocusableElements, config],\n  );\n\n  return {\n    getFocusableElements,\n    getCurrentFocusIndex,\n    setFocusIndex,\n  };\n}\n\n/**\n * 创建导航函数\n */\nfunction useNavigationActions(\n  getFocusableElements: () => HTMLElement[],\n  getCurrentFocusIndex: () => number,\n  setFocusIndex: (_index: number) => void,\n  config: KeyboardNavigationConfig,\n) {\n  const focusFirst = useCallback((): void => {\n    setFocusIndex(0);\n  }, [setFocusIndex]);\n\n  const focusLast = useCallback((): void => {\n    const elements = getFocusableElements();\n    setFocusIndex(elements.length - 1);\n  }, [getFocusableElements, setFocusIndex]);\n\n  const focusNext = useCallback((): void => {\n    const elements = getFocusableElements();\n    const currentIndex = getCurrentFocusIndex();\n    let nextIndex = currentIndex + 1;\n\n    if (nextIndex >= elements.length) {\n      nextIndex = config.loop ? 0 : elements.length - 1;\n    }\n\n    setFocusIndex(nextIndex);\n  }, [getFocusableElements, getCurrentFocusIndex, setFocusIndex, config.loop]);\n\n  const focusPrevious = useCallback((): void => {\n    const elements = getFocusableElements();\n    const currentIndex = getCurrentFocusIndex();\n    let prevIndex = currentIndex - 1;\n\n    if (prevIndex < 0) {\n      prevIndex = config.loop ? elements.length - 1 : 0;\n    }\n\n    setFocusIndex(prevIndex);\n  }, [getFocusableElements, getCurrentFocusIndex, setFocusIndex, config.loop]);\n\n  return {\n    focusFirst,\n    focusLast,\n    focusNext,\n    focusPrevious,\n  };\n}\n\n/**\n * 创建键盘事件处理器\n */\nfunction useKeyboardHandler(\n  config: KeyboardNavigationConfig,\n  navigationActions: {\n    focusNext: () => void;\n    focusPrevious: () => void;\n    focusFirst: () => void;\n    focusLast: () => void;\n  },\n  getFocusableElements: () => HTMLElement[],\n  getCurrentFocusIndex: () => number,\n) {\n  const handleKeyDown = useCallback(\n    (event: KeyboardEvent): void => {\n      if (!config.enabled) return;\n\n      const { key } = event;\n      const isHorizontal =\n        config.orientation === 'horizontal' || config.orientation === 'both';\n      const isVertical =\n        config.orientation === 'vertical' || config.orientation === 'both';\n\n      // 处理箭头键\n      const arrowHandled = handleArrowKey({\n        key,\n        isHorizontal,\n        isVertical,\n        event,\n        focusNext: navigationActions.focusNext,\n        focusPrevious: navigationActions.focusPrevious,\n      });\n\n      if (arrowHandled) return;\n\n      // 处理Tab键\n      const tabHandled = handleTabKey(\n        event,\n        config,\n        getFocusableElements,\n        getCurrentFocusIndex,\n      );\n      if (tabHandled) return;\n\n      // 处理Home/End键\n      if (key === 'Home') {\n        event.preventDefault();\n        navigationActions.focusFirst();\n      } else if (key === 'End') {\n        event.preventDefault();\n        navigationActions.focusLast();\n      }\n    },\n    [config, navigationActions, getFocusableElements, getCurrentFocusIndex],\n  );\n\n  return { handleKeyDown };\n}\n\nexport function useKeyboardNavigation(\n  options: KeyboardNavigationOptions = {},\n): UseKeyboardNavigationReturn {\n  const config = useMemo(() => ({ ...defaultOptions, ...options }), [options]);\n  const containerRef = useRef<HTMLElement | null>(null);\n\n  const { getFocusableElements, getCurrentFocusIndex, setFocusIndex } =\n    useFocusManagement(containerRef, config);\n\n  const navigationActions = useNavigationActions(\n    getFocusableElements,\n    getCurrentFocusIndex,\n    setFocusIndex,\n    config,\n  );\n\n  const { handleKeyDown } = useKeyboardHandler(\n    config,\n    navigationActions,\n    getFocusableElements,\n    getCurrentFocusIndex,\n  );\n\n  useEffect(() => {\n    const container = containerRef.current;\n    if (!container || !config.enabled) return undefined;\n\n    container.addEventListener('keydown', handleKeyDown);\n    return () => container.removeEventListener('keydown', handleKeyDown);\n  }, [handleKeyDown, config.enabled]);\n\n  return {\n    containerRef,\n    ...navigationActions,\n    getCurrentFocusIndex,\n    setFocusIndex,\n  };\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/hooks/use-performance-monitor.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'React' is defined but never used. Allowed unused vars must match /^_/u.","line":3,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":13,"suggestions":[{"messageId":"removeVar","data":{"varName":"React"},"fix":{"range":[22,28],"text":""},"desc":"Remove unused variable 'React'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'React' is defined but never used. Allowed unused vars must match /^_/u.","line":3,"column":8,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":13},{"ruleId":"no-unused-vars","severity":2,"message":"'PerformanceAlertSystem' is defined but never used. Allowed unused vars must match /^_/u.","line":6,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"PerformanceAlertSystem"},"fix":{"range":[120,146],"text":""},"desc":"Remove unused variable 'PerformanceAlertSystem'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'PerformanceAlertSystem' is defined but never used. Allowed unused vars must match /^_/u.","line":6,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":25},{"ruleId":"max-lines-per-function","severity":2,"message":"Function 'usePerformanceMonitor' has too many lines (121). Maximum allowed is 120.","line":30,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":182,"endColumn":2},{"ruleId":"no-undef","severity":2,"message":"'NodeJS' is not defined.","line":54,"column":40,"nodeType":"Identifier","messageId":"undef","endLine":54,"endColumn":46},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2.","line":76,"column":53,"nodeType":"Literal","messageId":"noMagic","endLine":76,"endColumn":54},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2.","line":77,"column":72,"nodeType":"Literal","messageId":"noMagic","endLine":77,"endColumn":73},{"ruleId":"consistent-return","severity":2,"message":"Expected to return a value at the end of arrow function.","line":130,"column":16,"nodeType":"ArrowFunctionExpression","messageId":"missingReturn","endLine":130,"endColumn":18},{"ruleId":"react-you-might-not-need-an-effect/no-event-handler","severity":2,"message":"Avoid using state and effects as an event handler. Instead, call the event handling code directly when the event occurs.","line":131,"column":9,"nodeType":"Identifier","messageId":"avoidEventHandler","endLine":131,"endColumn":21},{"ruleId":"consistent-return","severity":2,"message":"Expected to return a value at the end of arrow function.","line":155,"column":16,"nodeType":"ArrowFunctionExpression","messageId":"missingReturn","endLine":155,"endColumn":18}],"suppressedMessages":[],"errorCount":11,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport React, { useCallback, useEffect, useRef, useState } from 'react';\nimport type {\n  PerformanceAlert,\n  PerformanceAlertSystem,\n  PerformanceMetrics,\n  UsePerformanceMonitorOptions,\n  UsePerformanceMonitorReturn,\n} from './performance-monitor-types';\nimport {\n  createPerformanceAlertSystem,\n  createMonitoringControls,\n  createPerformanceMonitorReturn,\n  validateAndSanitizeOptions,\n  generateAlertId,\n} from './performance-monitor-utils';\nimport { usePerformanceMeasurements } from './performance-monitor-measurements';\n\n/**\n * 性能监控 Hook\n *\n * 提供全面的性能监控功能，包括：\n * - 加载时间监控\n * - 渲染时间监控\n * - 内存使用监控\n * - 性能警告系统\n * - 实时性能指标\n */\nexport function usePerformanceMonitor(\n  options: UsePerformanceMonitorOptions = {},\n): UsePerformanceMonitorReturn {\n  // 验证和清理选项\n  const state = validateAndSanitizeOptions(options);\n  const {\n    enableAlerts,\n    alertThresholds,\n    monitoringInterval,\n    enableMemoryMonitoring,\n    enableRenderTimeMonitoring,\n    enableLoadTimeMonitoring,\n    maxAlerts,\n  } = state;\n\n  // 状态管理\n  const [isMonitoring, setIsMonitoring] = useState(false);\n  const [metrics, setMetrics] = useState<PerformanceMetrics | null>(null);\n  const [alerts, setAlerts] = useState<PerformanceAlert[]>([]);\n  const [error, setError] = useState<string | null>(null);\n\n  // Refs\n  const startTime = useRef<number | null>(null);\n  const alertHistory = useRef<PerformanceAlert[]>([]);\n  const monitoringIntervalRef = useRef<NodeJS.Timeout | null>(null);\n\n  // 添加警告的函数\n  const addAlert = useCallback(\n    (alert: Omit<PerformanceAlert, 'id' | 'timestamp'>) => {\n      const newAlert: PerformanceAlert = {\n        ...alert,\n        id: generateAlertId(),\n        timestamp: Date.now(),\n      };\n\n      setAlerts(prev => {\n        const updated = [...prev, newAlert];\n        // 限制警告数量\n        if (updated.length > maxAlerts) {\n          return updated.slice(-maxAlerts);\n        }\n        return updated;\n      });\n\n      // 添加到历史记录\n      alertHistory.current.push(newAlert);\n      if (alertHistory.current.length > maxAlerts * 2) {\n        alertHistory.current = alertHistory.current.slice(-maxAlerts * 2);\n      }\n    },\n    [maxAlerts],\n  );\n\n  // 性能测量函数\n  const measurements = usePerformanceMeasurements(\n    enableAlerts,\n    alertThresholds,\n    addAlert,\n    setMetrics,\n    startTime,\n  );\n\n  // 监控控制函数\n  const controls = createMonitoringControls(\n    setIsMonitoring,\n    setError,\n    startTime,\n    setMetrics,\n  );\n\n  // 性能警告系统\n  const performanceAlertSystem = createPerformanceAlertSystem(\n    alerts,\n    alertHistory,\n    addAlert,\n    setAlerts,\n  );\n\n  // 获取当前指标\n  const getMetrics = useCallback(() => metrics, [metrics]);\n\n  // 刷新指标\n  const refreshMetrics = useCallback(() => {\n    if (enableLoadTimeMonitoring) {\n      measurements.measureLoadTime();\n    }\n    if (enableRenderTimeMonitoring) {\n      measurements.measureRenderTime();\n    }\n    if (enableMemoryMonitoring) {\n      measurements.measureMemoryUsage();\n    }\n  }, [\n    enableLoadTimeMonitoring,\n    enableRenderTimeMonitoring,\n    enableMemoryMonitoring,\n    measurements,\n  ]);\n\n  // 自动监控效果\n  useEffect(() => {\n    if (isMonitoring) {\n      monitoringIntervalRef.current = setInterval(() => {\n        refreshMetrics();\n      }, monitoringInterval);\n\n      return () => {\n        if (monitoringIntervalRef.current) {\n          clearInterval(monitoringIntervalRef.current);\n          monitoringIntervalRef.current = null;\n        }\n      };\n    }\n  }, [isMonitoring, monitoringInterval, refreshMetrics]);\n\n  // 组件卸载时清理\n  useEffect(() => {\n    return () => {\n      if (monitoringIntervalRef.current) {\n        clearInterval(monitoringIntervalRef.current);\n      }\n    };\n  }, []);\n\n  // 初始化时测量加载时间\n  useEffect(() => {\n    if (enableLoadTimeMonitoring) {\n      // 延迟测量以确保页面完全加载\n      const timer = setTimeout(() => {\n        measurements.measureLoadTime();\n      }, 100);\n\n      return () => clearTimeout(timer);\n    }\n  }, [enableLoadTimeMonitoring, measurements]);\n\n  // 返回性能监控接口\n  return createPerformanceMonitorReturn({\n    isMonitoring,\n    metrics,\n    alerts,\n    error,\n    getMetrics,\n    startMonitoring: controls.startMonitoring,\n    stopMonitoring: controls.stopMonitoring,\n    resetMetrics: controls.resetMetrics,\n    measureLoadTime: measurements.measureLoadTime,\n    measureRenderTime: measurements.measureRenderTime,\n    refreshMetrics,\n    clearAlerts: performanceAlertSystem.clearAlerts,\n    performanceAlertSystem,\n  });\n}\n\n/**\n * 导出类型定义\n */\nexport type {\n  PerformanceMetrics,\n  PerformanceAlert,\n  PerformanceAlertSystem,\n  UsePerformanceMonitorOptions,\n  UsePerformanceMonitorReturn,\n} from './performance-monitor-types';\n\n/**\n * 导出工具函数\n */\nexport {\n  PERFORMANCE_CONSTANTS,\n  formatMemoryUsage,\n  formatTime,\n  checkPerformanceThresholds,\n} from './performance-monitor-utils';\n\n/**\n * 导出测量函数\n */\nexport {\n  measureNetworkLatency,\n  measureFirstContentfulPaint,\n  measureLargestContentfulPaint,\n  measureCumulativeLayoutShift,\n  measureFirstInputDelay,\n  measureComprehensivePerformance,\n} from './performance-monitor-measurements';\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/hooks/use-reduced-motion.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/hooks/use-theme-toggle.ts","messages":[{"ruleId":"max-params","severity":2,"message":"Function 'createThemeChangeHandler' has too many parameters (5). Maximum allowed is 3.","line":27,"column":1,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":27,"endColumn":34}],"suppressedMessages":[{"ruleId":"no-empty-function","severity":2,"message":"Unexpected empty arrow function.","line":17,"column":20,"nodeType":"ArrowFunctionExpression","messageId":"unexpected","endLine":17,"endColumn":22,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport React, { useCallback, useState } from 'react';\nimport { useAccessibility } from '@/lib/accessibility';\nimport { useEnhancedTheme } from './use-enhanced-theme';\n\n/**\n * 检查组件是否已挂载的hook\n * 使用useSyncExternalStore来避免SSR/CSR水合不匹配问题\n * 这是React 18+推荐的处理客户端状态的方式\n */\nfunction useMounted() {\n  return React.useSyncExternalStore(\n    () => {\n      // subscribe - 返回空的清理函数，因为mounted状态不会改变\n      // eslint-disable-next-line no-empty-function\n      return () => {};\n    },\n    () => true, // getSnapshot - 客户端总是返回true\n    () => false, // getServerSnapshot - 服务端总是返回false\n  );\n}\n\n/**\n * 创建主题切换处理函数\n */\nfunction createThemeChangeHandler(\n  setThemeWithCircularTransition: (\n    _theme: string,\n    _event?: React.MouseEvent<HTMLElement>,\n  ) => void,\n  announceSwitching: () => void,\n  announceThemeChange: (_theme: string) => void,\n  prefersReducedMotion: boolean,\n  setIsOpen: (_open: boolean) => void,\n) {\n  return (newTheme: string, event?: React.MouseEvent<HTMLElement>) => {\n    // 播报切换状态\n    announceSwitching();\n\n    // 执行主题切换\n    setThemeWithCircularTransition(newTheme, event);\n\n    // 延迟播报完成状态\n    const reducedMotionDelay = 50;\n    const normalDelay = 400;\n    setTimeout(\n      () => {\n        announceThemeChange(newTheme);\n      },\n      prefersReducedMotion ? reducedMotionDelay : normalDelay,\n    );\n\n    // 关闭下拉菜单\n    setIsOpen(false);\n  };\n}\n\n/**\n * 主题切换逻辑的自定义hook\n * 封装主题切换、无障碍性支持和状态管理\n */\nexport function useThemeToggle() {\n  const { theme, setThemeWithCircularTransition, supportsViewTransitions } =\n    useEnhancedTheme();\n  const [isOpen, setIsOpenState] = useState(false);\n  const mounted = useMounted();\n\n  const setIsOpen = setIsOpenState;\n  const {\n    announceThemeChange,\n    announceSwitching,\n    prefersReducedMotion,\n    prefersHighContrast,\n    handleKeyboardNavigation,\n    getAriaAttributes,\n  } = useAccessibility();\n\n  // 处理主题切换\n  const handleThemeChange = useCallback(\n    (newTheme: string, event?: React.MouseEvent<HTMLElement>) => {\n      const handler = createThemeChangeHandler(\n        setThemeWithCircularTransition,\n        announceSwitching,\n        announceThemeChange,\n        prefersReducedMotion,\n        setIsOpen,\n      );\n      handler(newTheme, event);\n    },\n    [\n      setThemeWithCircularTransition,\n      announceSwitching,\n      announceThemeChange,\n      prefersReducedMotion,\n      setIsOpen,\n    ],\n  );\n\n  // 处理键盘导航\n  const handleKeyDown = useCallback(\n    (event: React.KeyboardEvent, action: () => void) => {\n      handleKeyboardNavigation(event.nativeEvent, action, () =>\n        setIsOpen(false),\n      );\n    },\n    [handleKeyboardNavigation, setIsOpen],\n  );\n\n  // 获取当前主题的ARIA属性\n  // 在组件挂载前使用 'system' 作为默认值以避免 SSR/CSR 不一致\n  const currentTheme = mounted ? theme || 'system' : 'system';\n  const ariaAttributes = getAriaAttributes(currentTheme, isOpen);\n\n  return {\n    // 状态\n    theme,\n    isOpen,\n    setIsOpen,\n    supportsViewTransitions,\n    prefersReducedMotion,\n    prefersHighContrast,\n\n    // 处理函数\n    handleThemeChange,\n    handleKeyDown,\n\n    // ARIA属性\n    ariaAttributes,\n  };\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/hooks/use-toast.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/hooks/use-web-vitals-diagnostics.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'TEST_APP_CONSTANTS' is defined but never used. Allowed unused vars must match /^_/u.","line":5,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":28,"suggestions":[{"messageId":"removeVar","data":{"varName":"TEST_APP_CONSTANTS"},"fix":{"range":[152,216],"text":""},"desc":"Remove unused variable 'TEST_APP_CONSTANTS'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'TEST_APP_CONSTANTS' is defined but never used. Allowed unused vars must match /^_/u.","line":5,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":28},{"ruleId":"no-unused-vars","severity":2,"message":"'PageComparison' is defined but never used. Allowed unused vars must match /^_/u.","line":10,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":22,"suggestions":[{"messageId":"removeVar","data":{"varName":"PageComparison"},"fix":{"range":[306,329],"text":""},"desc":"Remove unused variable 'PageComparison'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'PageComparison' is defined but never used. Allowed unused vars must match /^_/u.","line":10,"column":8,"nodeType":null,"messageId":"unusedVar","endLine":10,"endColumn":22},{"ruleId":"no-unused-vars","severity":2,"message":"'PerformanceTrend' is defined but never used. Allowed unused vars must match /^_/u.","line":11,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":24,"suggestions":[{"messageId":"removeVar","data":{"varName":"PerformanceTrend"},"fix":{"range":[329,354],"text":""},"desc":"Remove unused variable 'PerformanceTrend'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'PerformanceTrend' is defined but never used. Allowed unused vars must match /^_/u.","line":11,"column":8,"nodeType":null,"messageId":"unusedVar","endLine":11,"endColumn":24},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0.1.","line":64,"column":42,"nodeType":"Literal","messageId":"noMagic","endLine":64,"endColumn":45},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2000.","line":65,"column":49,"nodeType":"Literal","messageId":"noMagic","endLine":65,"endColumn":53},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 800.","line":67,"column":26,"nodeType":"Literal","messageId":"noMagic","endLine":67,"endColumn":29},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 1200.","line":67,"column":48,"nodeType":"Literal","messageId":"noMagic","endLine":67,"endColumn":52},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 800.","line":68,"column":50,"nodeType":"Literal","messageId":"noMagic","endLine":68,"endColumn":53},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 85.","line":69,"column":25,"nodeType":"Literal","messageId":"noMagic","endLine":69,"endColumn":27},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 15.","line":69,"column":46,"nodeType":"Literal","messageId":"noMagic","endLine":69,"endColumn":48},{"ruleId":"require-await","severity":2,"message":"Async arrow function has no 'await' expression.","line":73,"column":51,"nodeType":"ArrowFunctionExpression","messageId":"missingAwait","endLine":73,"endColumn":53,"suggestions":[{"messageId":"removeAsync","fix":{"range":[2122,2128],"text":""},"desc":"Remove 'async'."}]},{"ruleId":"no-empty-function","severity":2,"message":"Unexpected empty async arrow function.","line":153,"column":86,"nodeType":"ArrowFunctionExpression","messageId":"unexpected","endLine":153,"endColumn":88}],"suppressedMessages":[],"errorCount":15,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport React, { useCallback, useEffect, useState } from 'react';\nimport { enhancedWebVitalsCollector } from '@/lib/enhanced-web-vitals';\nimport { TEST_APP_CONSTANTS } from '@/constants/test-constants';\nimport {\n  calculatePageComparison,\n  calculatePerformanceTrends,\n  type DiagnosticReport,\n  type PageComparison,\n  type PerformanceTrend,\n} from './web-vitals-diagnostics-utils';\nimport type {\n  WebVitalsDiagnosticsState,\n  DiagnosticsReturnParams,\n  UseWebVitalsDiagnosticsReturn,\n} from './web-vitals-diagnostics-types';\nimport {\n  useWebVitalsDataPersistence,\n  useWebVitalsInitialization,\n} from './web-vitals-diagnostics-persistence';\nimport { useReportExport } from './web-vitals-diagnostics-export';\n\n/**\n * 创建诊断Hook的返回对象\n */\nconst createDiagnosticsReturn = (params: DiagnosticsReturnParams): UseWebVitalsDiagnosticsReturn => {\n  const {\n    state,\n    refreshDiagnostics,\n    getPerformanceTrends,\n    getPageComparison,\n    exportReport,\n    clearHistory,\n  } = params;\n\n  return {\n    currentReport: state.currentReport,\n    historicalReports: state.historicalReports,\n    isLoading: state.isLoading,\n    error: state.error,\n    refreshDiagnostics,\n    getPerformanceTrends,\n    getPageComparison,\n    exportReport,\n    clearHistory,\n  };\n};\n\n/**\n * 辅助Hook：处理诊断刷新逻辑\n */\nconst useWebVitalsRefresh = (\n  setState: React.Dispatch<React.SetStateAction<WebVitalsDiagnosticsState>>,\n  loadHistoricalData: () => DiagnosticReport[],\n  saveToStorage: (_reports: DiagnosticReport[]) => void,\n) => {\n  const generateReport = useCallback((): DiagnosticReport => {\n    const vitals = enhancedWebVitalsCollector.getMetrics();\n\n    return {\n      timestamp: Date.now(),\n      url: typeof window !== 'undefined' ? window.location.href : 'test-url',\n      cls: vitals.cls || Math.random() * 0.1,\n      lcp: vitals.lcp || 1000 + Math.random() * 2000,\n      fid: vitals.fid || Math.random() * 100,\n      fcp: vitals.fcp || 800 + Math.random() * 1200,\n      ttfb: vitals.ttfb || 200 + Math.random() * 800,\n      performanceScore: 85 + Math.random() * 15,\n    };\n  }, []);\n\n  const refreshDiagnostics = useCallback(async () => {\n    setState(prev => ({ ...prev, isLoading: true, error: null }));\n\n    try {\n      const newReport = generateReport();\n      const historicalReports = loadHistoricalData();\n      const updatedReports = [...historicalReports, newReport];\n\n      setState(prev => ({\n        ...prev,\n        currentReport: newReport,\n        historicalReports: updatedReports,\n        isLoading: false,\n      }));\n\n      saveToStorage(updatedReports);\n    } catch (error) {\n      setState(prev => ({\n        ...prev,\n        isLoading: false,\n        error: error instanceof Error ? error.message : 'Unknown error',\n      }));\n    }\n  }, [generateReport, loadHistoricalData, saveToStorage, setState]);\n\n  return { refreshDiagnostics };\n};\n\n/**\n * 分析功能Hook\n */\nfunction useAnalysisFunctions(state: WebVitalsDiagnosticsState) {\n  const getPerformanceTrends = useCallback(() => {\n    return calculatePerformanceTrends(state.historicalReports);\n  }, [state.historicalReports]);\n\n  const getPageComparison = useCallback(() => {\n    return calculatePageComparison(state.historicalReports);\n  }, [state.historicalReports]);\n\n  return { getPerformanceTrends, getPageComparison };\n}\n\n/**\n * 数据管理功能Hook\n */\nfunction useDataManagement(\n  setState: React.Dispatch<React.SetStateAction<WebVitalsDiagnosticsState>>,\n) {\n  const clearHistory = useCallback(() => {\n    setState((prev) => ({\n      ...prev,\n      historicalReports: [],\n      currentReport: null,\n    }));\n    localStorage.removeItem('webVitalsDiagnostics');\n  }, [setState]);\n\n  return { clearHistory };\n}\n\n/**\n * Web Vitals 诊断 Hook\n *\n * 提供 Web Vitals 性能指标的收集、分析和诊断功能\n */\nexport function useWebVitalsDiagnostics(): UseWebVitalsDiagnosticsReturn {\n  const isTestEnvironment = process.env.NODE_ENV === 'test';\n\n  // 所有 Hooks 都在顶层调用\n  const { loadHistoricalData, saveToStorage } = useWebVitalsDataPersistence();\n\n  const [state, setState] = useState<WebVitalsDiagnosticsState>({\n    currentReport: null,\n    historicalReports: [],\n    isLoading: false,\n    error: null,\n  });\n\n  // 初始化数据\n  const { initialData } = useWebVitalsInitialization(loadHistoricalData, async () => {});\n\n  // 获取功能函数\n  const { refreshDiagnostics } = useWebVitalsRefresh(setState, loadHistoricalData, saveToStorage);\n  const { getPerformanceTrends, getPageComparison } = useAnalysisFunctions(state);\n  const { exportReport } = useReportExport(state, getPerformanceTrends, getPageComparison);\n  const { clearHistory } = useDataManagement(setState);\n\n  // 初始化历史数据\n  useEffect(() => {\n    setState(prev => ({\n      ...prev,\n      historicalReports: initialData.historicalReports,\n    }));\n\n    if (initialData.shouldRefresh && !isTestEnvironment) {\n      refreshDiagnostics();\n    }\n  }, [initialData, refreshDiagnostics, isTestEnvironment]);\n\n  return createDiagnosticsReturn({\n    state,\n    refreshDiagnostics,\n    getPerformanceTrends,\n    getPageComparison,\n    exportReport,\n    clearHistory,\n  });\n}\n\n/**\n * 导出类型定义\n */\nexport type {\n  WebVitalsDiagnosticsState,\n  UseWebVitalsDiagnosticsReturn,\n  ExportFormat,\n} from './web-vitals-diagnostics-types';\n\n/**\n * 导出工具函数\n */\nexport {\n  exportJsonReport,\n  exportCsvReport,\n  exportExcelReport,\n} from './web-vitals-diagnostics-export';\n\n/**\n * 导出持久化函数\n */\nexport {\n  validateDiagnosticReport,\n  cleanupExpiredData,\n  mergeHistoricalData,\n  getStorageUsage,\n} from './web-vitals-diagnostics-persistence';\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/hooks/web-vitals-diagnostics-analyzer.ts","messages":[{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 3.","line":67,"column":58,"nodeType":"Literal","messageId":"noMagic","endLine":67,"endColumn":59},{"ruleId":"security/detect-object-injection","severity":2,"message":"Variable Assigned to Object Injection Sink","line":101,"column":21,"nodeType":"MemberExpression","endLine":101,"endColumn":49},{"ruleId":"security/detect-object-injection","severity":2,"message":"Variable Assigned to Object Injection Sink","line":102,"column":22,"nodeType":"MemberExpression","endLine":102,"endColumn":51},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":107,"column":5,"nodeType":"MemberExpression","endLine":107,"endColumn":30},{"ruleId":"prefer-template","severity":2,"message":"Unexpected string concatenation.","line":147,"column":9,"nodeType":"BinaryExpression","messageId":"unexpectedStringConcatenation","endLine":147,"endColumn":82,"fix":{"range":[4215,4288],"text":"`${report.pageUrl.substring(0, WEB_VITALS_CONSTANTS.MAX_PATH_LENGTH)  }...`"}},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2.","line":242,"column":24,"nodeType":"Literal","messageId":"noMagic","endLine":242,"endColumn":25},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: -5.","line":244,"column":38,"nodeType":"UnaryExpression","messageId":"noMagic","endLine":244,"endColumn":40},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: -10.","line":245,"column":40,"nodeType":"UnaryExpression","messageId":"noMagic","endLine":245,"endColumn":43},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: -5.","line":245,"column":45,"nodeType":"UnaryExpression","messageId":"noMagic","endLine":245,"endColumn":47}],"suppressedMessages":[],"errorCount":9,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"/**\n * Web Vitals 诊断分析器\n * Web Vitals diagnostics analyzer functions\n */\n\nimport type { DetailedWebVitals } from '@/lib/enhanced-web-vitals';\nimport { \n  WEB_VITALS_CONSTANTS, \n  type DiagnosticReport, \n  type PageComparison,\n  type ExportData,\n  type PagePerformanceGroup\n} from './web-vitals-diagnostics-constants';\nimport { calculatePercentageChange } from './web-vitals-diagnostics-calculator';\n\n/**\n * 生成诊断建议\n */\nexport const generateRecommendations = (\n  vitals: DetailedWebVitals,\n): string[] => {\n  const recommendations: string[] = [];\n\n  if (vitals.lcp && vitals.lcp > WEB_VITALS_CONSTANTS.LCP_GOOD) {\n    recommendations.push('优化最大内容绘制(LCP): 考虑优化图片加载、减少服务器响应时间');\n  }\n\n  if (vitals.fid && vitals.fid > WEB_VITALS_CONSTANTS.FID_GOOD) {\n    recommendations.push('改善首次输入延迟(FID): 减少JavaScript执行时间、优化第三方脚本');\n  }\n\n  if (vitals.cls && vitals.cls > WEB_VITALS_CONSTANTS.CLS_GOOD) {\n    recommendations.push('减少累积布局偏移(CLS): 为图片和广告设置尺寸、避免动态内容插入');\n  }\n\n  if (vitals.fcp && vitals.fcp > WEB_VITALS_CONSTANTS.FCP_GOOD) {\n    recommendations.push('优化首次内容绘制(FCP): 减少阻塞渲染的资源、优化关键CSS');\n  }\n\n  if (vitals.ttfb && vitals.ttfb > WEB_VITALS_CONSTANTS.TTFB_GOOD) {\n    recommendations.push('改善首字节时间(TTFB): 优化服务器配置、使用CDN、减少重定向');\n  }\n\n  return recommendations;\n};\n\n/**\n * 识别性能问题\n */\nexport const identifyPerformanceIssues = (\n  vitals: DetailedWebVitals,\n): string[] => {\n  const issues: string[] = [];\n\n  if (vitals.lcp && vitals.lcp > WEB_VITALS_CONSTANTS.LCP_GOOD) {\n    const severity = vitals.lcp > WEB_VITALS_CONSTANTS.LCP_POOR ? '严重' : '中等';\n    issues.push(`LCP ${severity}问题: ${vitals.lcp.toFixed(0)}ms (建议 < ${WEB_VITALS_CONSTANTS.LCP_GOOD}ms)`);\n  }\n\n  if (vitals.fid && vitals.fid > WEB_VITALS_CONSTANTS.FID_GOOD) {\n    const severity = vitals.fid > WEB_VITALS_CONSTANTS.FID_POOR ? '严重' : '中等';\n    issues.push(`FID ${severity}问题: ${vitals.fid.toFixed(0)}ms (建议 < ${WEB_VITALS_CONSTANTS.FID_GOOD}ms)`);\n  }\n\n  if (vitals.cls && vitals.cls > WEB_VITALS_CONSTANTS.CLS_GOOD) {\n    const severity = vitals.cls > WEB_VITALS_CONSTANTS.CLS_POOR ? '严重' : '中等';\n    issues.push(`CLS ${severity}问题: ${vitals.cls.toFixed(3)} (建议 < ${WEB_VITALS_CONSTANTS.CLS_GOOD})`);\n  }\n\n  if (vitals.fcp && vitals.fcp > WEB_VITALS_CONSTANTS.FCP_GOOD) {\n    issues.push(`FCP 问题: ${vitals.fcp.toFixed(0)}ms (建议 < ${WEB_VITALS_CONSTANTS.FCP_GOOD}ms)`);\n  }\n\n  if (vitals.ttfb && vitals.ttfb > WEB_VITALS_CONSTANTS.TTFB_GOOD) {\n    issues.push(`TTFB 问题: ${vitals.ttfb.toFixed(0)}ms (建议 < ${WEB_VITALS_CONSTANTS.TTFB_GOOD}ms)`);\n  }\n\n  return issues;\n};\n\n/**\n * 比较页面性能\n */\nexport const comparePagePerformance = (\n  currentReport: DiagnosticReport,\n  comparedReport: DiagnosticReport,\n): PageComparison => {\n  const metrics: (keyof DetailedWebVitals)[] = [\n    'lcp',\n    'fid',\n    'cls',\n    'fcp',\n    'ttfb',\n  ];\n\n  const metricsComparison: PageComparison['metrics'] = {} as PageComparison['metrics'];\n  const betterMetrics: string[] = [];\n  const worseMetrics: string[] = [];\n\n  metrics.forEach((metric) => {\n    const current = currentReport.vitals[metric];\n    const compared = comparedReport.vitals[metric];\n    \n    const difference = current && compared ? current - compared : 0;\n    const percentageChange = current && compared ? calculatePercentageChange(current, compared) : 0;\n\n    metricsComparison[metric] = {\n      current,\n      compared,\n      difference,\n      percentageChange,\n    };\n\n    // 对于性能指标，值越小越好\n    if (current && compared) {\n      if (current < compared) {\n        betterMetrics.push(metric);\n      } else if (current > compared) {\n        worseMetrics.push(metric);\n      }\n    }\n  });\n\n  return {\n    currentPage: currentReport.pageUrl,\n    comparedPage: comparedReport.pageUrl,\n    scoreDifference: currentReport.score - comparedReport.score,\n    betterMetrics,\n    worseMetrics,\n    metrics: metricsComparison,\n  };\n};\n\n/**\n * 计算页面对比数据\n */\nexport const calculatePageComparison = (\n  historicalReports: DiagnosticReport[],\n): PagePerformanceGroup[] => {\n  // 使用Map避免对象注入安全问题\n  const pageGroups = new Map<string, DiagnosticReport[]>();\n\n  // 按页面URL分组\n  historicalReports.forEach((report) => {\n    // 安全地处理URL，避免过长的路径\n    const safeUrl = report.pageUrl.length > WEB_VITALS_CONSTANTS.MAX_PATH_LENGTH \n      ? report.pageUrl.substring(0, WEB_VITALS_CONSTANTS.MAX_PATH_LENGTH) + '...'\n      : report.pageUrl;\n    \n    const existing = pageGroups.get(safeUrl);\n    if (existing) {\n      existing.push(report);\n    } else {\n      pageGroups.set(safeUrl, [report]);\n    }\n  });\n\n  // 转换为数组并计算统计信息\n  return Array.from(pageGroups.entries())\n    .map(([url, reports]) => {\n      // 按时间戳排序，最新的在前\n      const sortedReports = reports.sort((a, b) => b.timestamp - a.timestamp);\n      \n      // 计算平均分数\n      const averageScore = reports.reduce((sum, report) => sum + report.score, 0) / reports.length;\n      \n      return {\n        url,\n        reports: sortedReports,\n        averageScore: Number(averageScore.toFixed(1)),\n        latestReport: sortedReports[0],\n      };\n    })\n    .sort((a, b) => b.averageScore - a.averageScore); // 按平均分数降序排列\n};\n\n/**\n * 导出报告数据\n */\nexport const exportReportData = (reports: DiagnosticReport[]): ExportData => {\n  return {\n    exportDate: new Date().toISOString(),\n    totalReports: reports.length,\n    reports: reports.map((report) => ({\n      timestamp: report.timestamp,\n      pageUrl: report.pageUrl,\n      score: report.score,\n      vitals: {\n        lcp: report.vitals.lcp,\n        fid: report.vitals.fid,\n        cls: report.vitals.cls,\n        fcp: report.vitals.fcp,\n        ttfb: report.vitals.ttfb,\n      },\n      issues: report.issues,\n      recommendations: report.recommendations,\n    })),\n  };\n};\n\n/**\n * 生成CSV格式的报告数据\n */\nexport const generateCSVData = (reports: DiagnosticReport[]): string => {\n  const headers = [\n    'Timestamp',\n    'Page URL',\n    'Score',\n    'LCP (ms)',\n    'FID (ms)',\n    'CLS',\n    'FCP (ms)',\n    'TTFB (ms)',\n    'Issues Count',\n    'Recommendations Count'\n  ];\n\n  const rows = reports.map(report => [\n    new Date(report.timestamp).toISOString(),\n    report.pageUrl,\n    report.score.toString(),\n    report.vitals.lcp?.toString() || '',\n    report.vitals.fid?.toString() || '',\n    report.vitals.cls?.toString() || '',\n    report.vitals.fcp?.toString() || '',\n    report.vitals.ttfb?.toString() || '',\n    report.issues.length.toString(),\n    report.recommendations.length.toString()\n  ]);\n\n  return [headers, ...rows]\n    .map(row => row.map(cell => `\"${cell}\"`).join(','))\n    .join('\\n');\n};\n\n/**\n * 分析性能趋势总体状况\n */\nexport const analyzeOverallTrend = (\n  reports: DiagnosticReport[]\n): 'improving' | 'declining' | 'stable' => {\n  if (reports.length < 2) return 'stable';\n\n  const recentScores = reports.slice(-5).map(r => r.score);\n  const previousScores = reports.slice(-10, -5).map(r => r.score);\n\n  if (previousScores.length === 0) return 'stable';\n\n  const recentAvg = recentScores.reduce((sum, score) => sum + score, 0) / recentScores.length;\n  const previousAvg = previousScores.reduce((sum, score) => sum + score, 0) / previousScores.length;\n\n  const change = recentAvg - previousAvg;\n  const threshold = 5; // 5分的变化阈值\n\n  if (Math.abs(change) < threshold) return 'stable';\n  return change > 0 ? 'improving' : 'declining';\n};\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/hooks/web-vitals-diagnostics-calculator.ts","messages":[{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":40,"column":24,"nodeType":"MemberExpression","endLine":40,"endColumn":45},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":44,"column":24,"nodeType":"MemberExpression","endLine":44,"endColumn":45},{"ruleId":"max-statements","severity":2,"message":"Arrow function has too many statements (21). Maximum allowed is 20.","line":89,"column":42,"nodeType":"ArrowFunctionExpression","messageId":"exceed","endLine":133,"endColumn":2},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2.","line":162,"column":45,"nodeType":"Literal","messageId":"noMagic","endLine":162,"endColumn":46},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2.","line":164,"column":23,"nodeType":"Literal","messageId":"noMagic","endLine":164,"endColumn":24},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":165,"column":42,"nodeType":"MemberExpression","endLine":165,"endColumn":56},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2.","line":165,"column":60,"nodeType":"Literal","messageId":"noMagic","endLine":165,"endColumn":61},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":168,"column":17,"nodeType":"MemberExpression","endLine":168,"endColumn":31},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0.95.","line":178,"column":43,"nodeType":"Literal","messageId":"noMagic","endLine":178,"endColumn":47},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 90.","line":212,"column":16,"nodeType":"Literal","messageId":"noMagic","endLine":212,"endColumn":18},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 80.","line":213,"column":16,"nodeType":"Literal","messageId":"noMagic","endLine":213,"endColumn":18},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 70.","line":214,"column":16,"nodeType":"Literal","messageId":"noMagic","endLine":214,"endColumn":18},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 60.","line":215,"column":16,"nodeType":"Literal","messageId":"noMagic","endLine":215,"endColumn":18}],"suppressedMessages":[],"errorCount":13,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Web Vitals 诊断计算器\n * Web Vitals diagnostics calculator functions\n */\n\nimport type { DetailedWebVitals } from '@/lib/enhanced-web-vitals';\nimport { \n  WEB_VITALS_CONSTANTS, \n  type DiagnosticReport, \n  type PerformanceTrend \n} from './web-vitals-diagnostics-constants';\n\n/**\n * 计算性能趋势\n */\nexport const calculatePerformanceTrends = (\n  historicalReports: DiagnosticReport[],\n): PerformanceTrend[] | null => {\n  if (historicalReports.length < WEB_VITALS_CONSTANTS.SCORE_DIVISOR)\n    return null;\n\n  const recentReports = historicalReports.slice(-WEB_VITALS_CONSTANTS.TREND_THRESHOLD);\n  const previousReports = historicalReports.slice(\n    -WEB_VITALS_CONSTANTS.SCORE_MULTIPLIER_10,\n    -WEB_VITALS_CONSTANTS.TREND_THRESHOLD,\n  );\n\n  if (previousReports.length === 0) return null;\n\n  const metrics: (keyof DetailedWebVitals)[] = [\n    'lcp',\n    'fid',\n    'cls',\n    'fcp',\n    'ttfb',\n  ];\n\n  return metrics.map((metric) => {\n    const recentValues = recentReports\n      .map((report) => report.vitals[metric])\n      .filter((value): value is number => value !== undefined);\n\n    const previousValues = previousReports\n      .map((report) => report.vitals[metric])\n      .filter((value): value is number => value !== undefined);\n\n    if (recentValues.length === 0 || previousValues.length === 0) {\n      return {\n        metric,\n        trend: 'stable' as const,\n        change: 0,\n        recent: 0,\n        previous: 0,\n      };\n    }\n\n    const recentAvg =\n      recentValues.reduce((sum, val) => sum + val, 0) / recentValues.length;\n    const previousAvg =\n      previousValues.reduce((sum, val) => sum + val, 0) / previousValues.length;\n\n    const change = recentAvg - previousAvg;\n    const percentageChange = Math.abs(change / previousAvg) * 100;\n\n    let trend: 'improving' | 'declining' | 'stable';\n\n    // 对于CLS，值越小越好；对于其他指标，值越小也越好\n    if (percentageChange < WEB_VITALS_CONSTANTS.TREND_THRESHOLD) {\n      trend = 'stable';\n    } else if (change < 0) {\n      trend = 'improving'; // 值减少是改善\n    } else {\n      trend = 'declining'; // 值增加是恶化\n    }\n\n    return {\n      metric,\n      trend,\n      change: Number(change.toFixed(WEB_VITALS_CONSTANTS.DECIMAL_PLACES)),\n      recent: Number(recentAvg.toFixed(WEB_VITALS_CONSTANTS.DECIMAL_PLACES)),\n      previous: Number(previousAvg.toFixed(WEB_VITALS_CONSTANTS.DECIMAL_PLACES)),\n    };\n  });\n};\n\n/**\n * 计算性能分数\n */\nexport const calculatePerformanceScore = (\n  vitals: DetailedWebVitals,\n): number => {\n  const PERFECT_SCORE = 100;\n  const LCP_THRESHOLD_GOOD = 1200;\n  const FID_THRESHOLD_GOOD = 50;\n  const CLS_THRESHOLD_GOOD = 0.05;\n\n  let score = PERFECT_SCORE;\n\n  // LCP评分 (权重40%)\n  if (vitals.lcp) {\n    if (vitals.lcp > WEB_VITALS_CONSTANTS.LCP_POOR) {\n      score -= WEB_VITALS_CONSTANTS.SCORE_DEDUCTION_MAJOR;\n    } else if (vitals.lcp > WEB_VITALS_CONSTANTS.LCP_GOOD) {\n      score -= WEB_VITALS_CONSTANTS.SCORE_DEDUCTION_MINOR;\n    } else if (vitals.lcp > LCP_THRESHOLD_GOOD) {\n      score -= WEB_VITALS_CONSTANTS.SCORE_DEDUCTION_TINY;\n    }\n  }\n\n  // FID评分 (权重30%)\n  if (vitals.fid) {\n    if (vitals.fid > WEB_VITALS_CONSTANTS.FID_POOR) {\n      score -= WEB_VITALS_CONSTANTS.SCORE_DEDUCTION_MINOR;\n    } else if (vitals.fid > WEB_VITALS_CONSTANTS.FID_GOOD) {\n      score -= WEB_VITALS_CONSTANTS.SCORE_DEDUCTION_SMALL;\n    } else if (vitals.fid > FID_THRESHOLD_GOOD) {\n      score -= WEB_VITALS_CONSTANTS.SCORE_DEDUCTION_TINY;\n    }\n  }\n\n  // CLS评分 (权重30%)\n  if (vitals.cls) {\n    if (vitals.cls > WEB_VITALS_CONSTANTS.CLS_POOR) {\n      score -= WEB_VITALS_CONSTANTS.SCORE_DEDUCTION_MINOR;\n    } else if (vitals.cls > WEB_VITALS_CONSTANTS.CLS_GOOD) {\n      score -= WEB_VITALS_CONSTANTS.SCORE_DEDUCTION_SMALL;\n    } else if (vitals.cls > CLS_THRESHOLD_GOOD) {\n      score -= WEB_VITALS_CONSTANTS.SCORE_DEDUCTION_TINY;\n    }\n  }\n\n  return Math.max(0, score);\n};\n\n/**\n * 计算指标差异百分比\n */\nexport const calculatePercentageChange = (\n  current: number,\n  previous: number,\n): number => {\n  if (previous === 0) return current > 0 ? 100 : 0;\n  return Number(((current - previous) / previous * 100).toFixed(WEB_VITALS_CONSTANTS.DECIMAL_PLACES));\n};\n\n/**\n * 计算平均值\n */\nexport const calculateAverage = (values: number[]): number => {\n  if (values.length === 0) return 0;\n  const sum = values.reduce((acc, val) => acc + val, 0);\n  return Number((sum / values.length).toFixed(WEB_VITALS_CONSTANTS.DECIMAL_PLACES));\n};\n\n/**\n * 计算中位数\n */\nexport const calculateMedian = (values: number[]): number => {\n  if (values.length === 0) return 0;\n  \n  const sorted = [...values].sort((a, b) => a - b);\n  const middle = Math.floor(sorted.length / 2);\n  \n  if (sorted.length % 2 === 0) {\n    return Number(((sorted[middle - 1] + sorted[middle]) / 2).toFixed(WEB_VITALS_CONSTANTS.DECIMAL_PLACES));\n  }\n  \n  return Number(sorted[middle].toFixed(WEB_VITALS_CONSTANTS.DECIMAL_PLACES));\n};\n\n/**\n * 计算第95百分位数\n */\nexport const calculateP95 = (values: number[]): number => {\n  if (values.length === 0) return 0;\n  \n  const sorted = [...values].sort((a, b) => a - b);\n  const index = Math.ceil(sorted.length * 0.95) - 1;\n  \n  return Number(sorted[Math.max(0, index)].toFixed(WEB_VITALS_CONSTANTS.DECIMAL_PLACES));\n};\n\n/**\n * 计算性能指标统计信息\n */\nexport const calculateMetricStats = (values: number[]) => {\n  if (values.length === 0) {\n    return {\n      average: 0,\n      median: 0,\n      p95: 0,\n      min: 0,\n      max: 0,\n      count: 0,\n    };\n  }\n\n  return {\n    average: calculateAverage(values),\n    median: calculateMedian(values),\n    p95: calculateP95(values),\n    min: Number(Math.min(...values).toFixed(WEB_VITALS_CONSTANTS.DECIMAL_PLACES)),\n    max: Number(Math.max(...values).toFixed(WEB_VITALS_CONSTANTS.DECIMAL_PLACES)),\n    count: values.length,\n  };\n};\n\n/**\n * 计算性能等级\n */\nexport const calculatePerformanceGrade = (score: number): string => {\n  if (score >= 90) return 'A';\n  if (score >= 80) return 'B';\n  if (score >= 70) return 'C';\n  if (score >= 60) return 'D';\n  return 'F';\n};\n\n/**\n * 计算改善潜力\n */\nexport const calculateImprovementPotential = (vitals: DetailedWebVitals): number => {\n  let potential = 0;\n  \n  if (vitals.lcp && vitals.lcp > WEB_VITALS_CONSTANTS.LCP_GOOD) {\n    potential += WEB_VITALS_CONSTANTS.SCORE_WEIGHT_LCP;\n  }\n  \n  if (vitals.fid && vitals.fid > WEB_VITALS_CONSTANTS.FID_GOOD) {\n    potential += WEB_VITALS_CONSTANTS.SCORE_WEIGHT_FID;\n  }\n  \n  if (vitals.cls && vitals.cls > WEB_VITALS_CONSTANTS.CLS_GOOD) {\n    potential += WEB_VITALS_CONSTANTS.SCORE_WEIGHT_CLS;\n  }\n  \n  return potential;\n};\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/hooks/web-vitals-diagnostics-constants.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/hooks/web-vitals-diagnostics-export.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'React' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":13,"suggestions":[{"messageId":"removeVar","data":{"varName":"React"},"fix":{"range":[7,13],"text":""},"desc":"Remove unused variable 'React'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'React' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":8,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":13},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 3.","line":50,"column":24,"nodeType":"Literal","messageId":"noMagic","endLine":50,"endColumn":25},{"ruleId":"max-statements","severity":2,"message":"Function 'generateInsights' has too many statements (25). Maximum allowed is 20.","line":174,"column":1,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":226,"endColumn":2},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0.25.","line":184,"column":22,"nodeType":"Literal","messageId":"noMagic","endLine":184,"endColumn":26},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0.1.","line":186,"column":29,"nodeType":"Literal","messageId":"noMagic","endLine":186,"endColumn":32},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 4000.","line":191,"column":22,"nodeType":"Literal","messageId":"noMagic","endLine":191,"endColumn":26},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2500.","line":193,"column":29,"nodeType":"Literal","messageId":"noMagic","endLine":193,"endColumn":33},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 300.","line":198,"column":22,"nodeType":"Literal","messageId":"noMagic","endLine":198,"endColumn":25},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 5.","line":205,"column":25,"nodeType":"Literal","messageId":"noMagic","endLine":205,"endColumn":26},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: -5.","line":206,"column":34,"nodeType":"UnaryExpression","messageId":"noMagic","endLine":206,"endColumn":36},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: -5.","line":207,"column":36,"nodeType":"UnaryExpression","messageId":"noMagic","endLine":207,"endColumn":38},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 3.","line":254,"column":26,"nodeType":"Literal","messageId":"noMagic","endLine":254,"endColumn":27},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 90.","line":285,"column":16,"nodeType":"Literal","messageId":"noMagic","endLine":285,"endColumn":18},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 75.","line":286,"column":16,"nodeType":"Literal","messageId":"noMagic","endLine":286,"endColumn":18},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 50.","line":287,"column":16,"nodeType":"Literal","messageId":"noMagic","endLine":287,"endColumn":18}],"suppressedMessages":[],"errorCount":16,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useCallback } from 'react';\nimport { TEST_COUNT_CONSTANTS } from '@/constants/test-constants';\nimport type {\n  DiagnosticReport,\n  WebVitalsDiagnosticsState,\n  WebVitalsReportExport,\n  ExportFormat,\n} from './web-vitals-diagnostics-types';\n\n/**\n * Web Vitals 报告导出功能\n */\n\n/**\n * 导出JSON格式报告\n */\nexport function exportJsonReport(data: Record<string, unknown>): void {\n  const blob = new Blob(\n    [JSON.stringify(data, null, TEST_COUNT_CONSTANTS.SMALL)],\n    { type: 'application/json' },\n  );\n  const url = URL.createObjectURL(blob);\n  const link = document.createElement('a');\n  link.href = url;\n  link.download = `web-vitals-report-${Date.now()}.json`;\n  document.body.appendChild(link);\n  link.click();\n  document.body.removeChild(link);\n  URL.revokeObjectURL(url);\n}\n\n/**\n * 导出CSV格式报告\n */\nexport function exportCsvReport(historicalReports: DiagnosticReport[]): void {\n  const csvHeaders = [\n    'Timestamp',\n    'URL',\n    'CLS',\n    'LCP',\n    'FID',\n    'FCP',\n    'TTFB',\n    'Performance Score',\n  ];\n\n  const csvRows = historicalReports.map(report => [\n    new Date(report.timestamp).toISOString(),\n    report.url,\n    report.cls.toFixed(3),\n    report.lcp.toFixed(0),\n    report.fid.toFixed(0),\n    report.fcp.toFixed(0),\n    report.ttfb.toFixed(0),\n    report.performanceScore?.toFixed(1) || 'N/A',\n  ]);\n\n  const csvContent = [csvHeaders, ...csvRows]\n    .map(row => row.map(cell => `\"${cell}\"`).join(','))\n    .join('\\n');\n\n  const blob = new Blob([csvContent], { type: 'text/csv' });\n  const url = URL.createObjectURL(blob);\n  const link = document.createElement('a');\n  link.href = url;\n  link.download = `web-vitals-report-${Date.now()}.csv`;\n  document.body.appendChild(link);\n  link.click();\n  document.body.removeChild(link);\n  URL.revokeObjectURL(url);\n}\n\n/**\n * 报告导出逻辑Hook\n */\nexport function useReportExport(\n  state: WebVitalsDiagnosticsState,\n  getPerformanceTrends: () => unknown,\n  getPageComparison: () => unknown,\n): WebVitalsReportExport {\n  const exportReport = useCallback(\n    (format: ExportFormat = 'json') => {\n      if (format === 'csv') {\n        exportCsvReport(state.historicalReports);\n      } else {\n        const exportData = {\n          currentReport: state.currentReport,\n          historicalReports: state.historicalReports,\n          performanceTrends: getPerformanceTrends(),\n          pageComparison: getPageComparison(),\n          exportTimestamp: Date.now(),\n          exportVersion: '1.0.0',\n        };\n        exportJsonReport(exportData);\n      }\n    },\n    [state.currentReport, state.historicalReports, getPerformanceTrends, getPageComparison],\n  );\n\n  return { exportReport };\n}\n\n/**\n * 生成详细的报告数据\n */\nexport function generateDetailedReport(\n  state: WebVitalsDiagnosticsState,\n  performanceTrends: unknown,\n  pageComparison: unknown,\n): Record<string, unknown> {\n  return {\n    summary: {\n      totalReports: state.historicalReports.length,\n      latestReport: state.currentReport,\n      averageMetrics: calculateAverageMetrics(state.historicalReports),\n      exportTimestamp: Date.now(),\n    },\n    currentReport: state.currentReport,\n    historicalReports: state.historicalReports,\n    analysis: {\n      performanceTrends,\n      pageComparison,\n      insights: generateInsights(state.historicalReports),\n    },\n    metadata: {\n      version: '1.0.0',\n      userAgent: typeof navigator !== 'undefined' ? navigator.userAgent : 'Unknown',\n      url: typeof window !== 'undefined' ? window.location.href : 'Unknown',\n    },\n  };\n}\n\n/**\n * 计算平均指标\n */\nfunction calculateAverageMetrics(reports: DiagnosticReport[]): Record<string, number> {\n  if (reports.length === 0) {\n    return {\n      cls: 0,\n      lcp: 0,\n      fid: 0,\n      fcp: 0,\n      ttfb: 0,\n      performanceScore: 0,\n    };\n  }\n\n  const totals = reports.reduce(\n    (acc, report) => ({\n      cls: acc.cls + report.cls,\n      lcp: acc.lcp + report.lcp,\n      fid: acc.fid + report.fid,\n      fcp: acc.fcp + report.fcp,\n      ttfb: acc.ttfb + report.ttfb,\n      performanceScore: acc.performanceScore + (report.performanceScore || 0),\n    }),\n    { cls: 0, lcp: 0, fid: 0, fcp: 0, ttfb: 0, performanceScore: 0 },\n  );\n\n  const count = reports.length;\n  return {\n    cls: totals.cls / count,\n    lcp: totals.lcp / count,\n    fid: totals.fid / count,\n    fcp: totals.fcp / count,\n    ttfb: totals.ttfb / count,\n    performanceScore: totals.performanceScore / count,\n  };\n}\n\n/**\n * 生成性能洞察\n */\nfunction generateInsights(reports: DiagnosticReport[]): string[] {\n  const insights: string[] = [];\n  \n  if (reports.length === 0) {\n    return ['No data available for analysis'];\n  }\n\n  const averages = calculateAverageMetrics(reports);\n  \n  // CLS 分析\n  if (averages.cls > 0.25) {\n    insights.push('High Cumulative Layout Shift detected. Consider optimizing layout stability.');\n  } else if (averages.cls > 0.1) {\n    insights.push('Moderate Cumulative Layout Shift. Room for improvement in layout stability.');\n  }\n\n  // LCP 分析\n  if (averages.lcp > 4000) {\n    insights.push('Slow Largest Contentful Paint. Consider optimizing loading performance.');\n  } else if (averages.lcp > 2500) {\n    insights.push('Moderate Largest Contentful Paint. Some optimization opportunities exist.');\n  }\n\n  // FID 分析\n  if (averages.fid > 300) {\n    insights.push('High First Input Delay. Consider optimizing JavaScript execution.');\n  } else if (averages.fid > 100) {\n    insights.push('Moderate First Input Delay. Some interactivity improvements possible.');\n  }\n\n  // 趋势分析\n  if (reports.length >= 5) {\n    const recent = reports.slice(-5);\n    const older = reports.slice(0, -5);\n    \n    if (older.length > 0) {\n      const recentAvg = calculateAverageMetrics(recent);\n      const olderAvg = calculateAverageMetrics(older);\n      \n      if (recentAvg.performanceScore > olderAvg.performanceScore) {\n        insights.push('Performance is improving over time.');\n      } else if (recentAvg.performanceScore < olderAvg.performanceScore) {\n        insights.push('Performance is declining over time. Consider investigating recent changes.');\n      }\n    }\n  }\n\n  if (insights.length === 0) {\n    insights.push('Performance metrics are within acceptable ranges.');\n  }\n\n  return insights;\n}\n\n/**\n * 导出为Excel格式（XLSX）\n */\nexport function exportExcelReport(historicalReports: DiagnosticReport[]): void {\n  // 创建简化的Excel格式（实际上是CSV，但可以被Excel打开）\n  const headers = [\n    'Date',\n    'Time',\n    'URL',\n    'CLS',\n    'LCP (ms)',\n    'FID (ms)',\n    'FCP (ms)',\n    'TTFB (ms)',\n    'Performance Score',\n    'Status',\n  ];\n\n  const rows = historicalReports.map(report => {\n    const date = new Date(report.timestamp);\n    const status = getPerformanceStatus(report);\n    \n    return [\n      date.toLocaleDateString(),\n      date.toLocaleTimeString(),\n      report.url,\n      report.cls.toFixed(3),\n      report.lcp.toFixed(0),\n      report.fid.toFixed(0),\n      report.fcp.toFixed(0),\n      report.ttfb.toFixed(0),\n      report.performanceScore?.toFixed(1) || 'N/A',\n      status,\n    ];\n  });\n\n  const csvContent = [headers, ...rows]\n    .map(row => row.map(cell => `\"${cell}\"`).join(','))\n    .join('\\n');\n\n  const blob = new Blob([csvContent], { type: 'application/vnd.ms-excel' });\n  const url = URL.createObjectURL(blob);\n  const link = document.createElement('a');\n  link.href = url;\n  link.download = `web-vitals-report-${Date.now()}.xlsx`;\n  document.body.appendChild(link);\n  link.click();\n  document.body.removeChild(link);\n  URL.revokeObjectURL(url);\n}\n\n/**\n * 获取性能状态\n */\nfunction getPerformanceStatus(report: DiagnosticReport): string {\n  const score = report.performanceScore || 0;\n  \n  if (score >= 90) return 'Excellent';\n  if (score >= 75) return 'Good';\n  if (score >= 50) return 'Needs Improvement';\n  return 'Poor';\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/hooks/web-vitals-diagnostics-persistence.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'React' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":13,"suggestions":[{"messageId":"removeVar","data":{"varName":"React"},"fix":{"range":[7,13],"text":""},"desc":"Remove unused variable 'React'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'React' is defined but never used. Allowed unused vars must match /^_/u.","line":1,"column":8,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":13},{"ruleId":"no-unused-vars","severity":2,"message":"'WebVitalsDiagnosticsState' is defined but never used. Allowed unused vars must match /^_/u.","line":5,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":28,"suggestions":[{"messageId":"removeVar","data":{"varName":"WebVitalsDiagnosticsState"},"fix":{"range":[124,153],"text":""},"desc":"Remove unused variable 'WebVitalsDiagnosticsState'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'WebVitalsDiagnosticsState' is defined but never used. Allowed unused vars must match /^_/u.","line":5,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":28},{"ruleId":"no-unused-vars","severity":2,"message":"'refreshDiagnostics' is defined but never used. Allowed unused args must match /^_/u.","line":75,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":75,"endColumn":42,"suggestions":[{"messageId":"removeVar","data":{"varName":"refreshDiagnostics"},"fix":{"range":[1855,1898],"text":""},"desc":"Remove unused variable 'refreshDiagnostics'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'refreshDiagnostics' is defined but never used. Allowed unused args must match /^_/u.","line":75,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":75,"endColumn":21},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 300000.","line":84,"column":81,"nodeType":"Literal","messageId":"noMagic","endLine":84,"endColumn":87},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 7.","line":121,"column":20,"nodeType":"Literal","messageId":"noMagic","endLine":121,"endColumn":21},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 24.","line":121,"column":24,"nodeType":"Literal","messageId":"noMagic","endLine":121,"endColumn":26},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 60.","line":121,"column":29,"nodeType":"Literal","messageId":"noMagic","endLine":121,"endColumn":31},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 60.","line":121,"column":34,"nodeType":"Literal","messageId":"noMagic","endLine":121,"endColumn":36},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2.","line":159,"column":55,"nodeType":"Literal","messageId":"noMagic","endLine":159,"endColumn":56},{"ruleId":"no-unused-vars","severity":2,"message":"'data' is defined but never used. Allowed unused args must match /^_/u.","line":180,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":180,"endColumn":39,"suggestions":[{"messageId":"removeVar","data":{"varName":"data"},"fix":{"range":[4319,4343],"text":""},"desc":"Remove unused variable 'data'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used. Allowed unused args must match /^_/u.","line":181,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":181,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"error"},"fix":{"range":[4366,4378],"text":""},"desc":"Remove unused variable 'error'."}]},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 5.","line":220,"column":23,"nodeType":"Literal","messageId":"noMagic","endLine":220,"endColumn":24},{"ruleId":"no-undef","severity":2,"message":"'MB' is not defined.","line":220,"column":27,"nodeType":"Identifier","messageId":"undef","endLine":220,"endColumn":29},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 10.","line":238,"column":25,"nodeType":"Literal","messageId":"noMagic","endLine":238,"endColumn":27}],"suppressedMessages":[],"errorCount":17,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useCallback, useMemo } from 'react';\nimport { logger } from '@/lib/logger';\nimport type {\n  DiagnosticReport,\n  WebVitalsDiagnosticsState,\n  WebVitalsDataPersistence,\n  WebVitalsInitializationData,\n} from './web-vitals-diagnostics-types';\n\n/**\n * Web Vitals 数据持久化相关功能\n */\n\n/**\n * 本地存储键名\n */\nconst STORAGE_KEY = 'webVitalsDiagnostics';\n\n/**\n * 最大历史记录数量\n */\nconst MAX_HISTORY_SIZE = 100;\n\n/**\n * 辅助Hook：处理数据持久化\n */\nexport function useWebVitalsDataPersistence(): WebVitalsDataPersistence {\n  const loadHistoricalData = useCallback(() => {\n    try {\n      const stored = localStorage.getItem(STORAGE_KEY);\n      if (!stored) return [];\n\n      const parsed = JSON.parse(stored) as DiagnosticReport[];\n      \n      // 验证数据格式\n      if (!Array.isArray(parsed)) {\n        logger.warn('Invalid stored data format, clearing storage');\n        localStorage.removeItem(STORAGE_KEY);\n        return [];\n      }\n\n      // 限制历史记录数量\n      if (parsed.length > MAX_HISTORY_SIZE) {\n        const trimmed = parsed.slice(-MAX_HISTORY_SIZE);\n        localStorage.setItem(STORAGE_KEY, JSON.stringify(trimmed));\n        return trimmed;\n      }\n\n      return parsed;\n    } catch (error) {\n      logger.error('Failed to load historical data', { error: error as Error });\n      localStorage.removeItem(STORAGE_KEY);\n      return [];\n    }\n  }, []);\n\n  const saveToStorage = useCallback((reports: DiagnosticReport[]) => {\n    try {\n      // 限制存储的数据量\n      const trimmedReports = reports.slice(-MAX_HISTORY_SIZE);\n      localStorage.setItem(STORAGE_KEY, JSON.stringify(trimmedReports));\n    } catch (error) {\n      logger.error('Failed to save to storage', { error: error as Error });\n    }\n  }, []);\n\n  return { loadHistoricalData, saveToStorage };\n}\n\n/**\n * 辅助Hook：处理初始化逻辑\n */\nexport function useWebVitalsInitialization(\n  loadHistoricalData: () => DiagnosticReport[],\n  refreshDiagnostics: () => Promise<void>,\n): WebVitalsInitializationData {\n  // 返回初始化数据，让调用者决定如何使用\n  const initialData = useMemo(() => {\n    const historicalReports = loadHistoricalData();\n    \n    // 检查是否需要刷新数据\n    const shouldRefresh = historicalReports.length === 0 || \n      (historicalReports.length > 0 && \n       Date.now() - historicalReports[historicalReports.length - 1].timestamp > 300000); // 5分钟\n\n    return {\n      historicalReports,\n      shouldRefresh,\n    };\n  }, [loadHistoricalData]);\n\n  return { initialData };\n}\n\n/**\n * 数据验证函数\n */\nexport function validateDiagnosticReport(report: unknown): report is DiagnosticReport {\n  if (!report || typeof report !== 'object') {\n    return false;\n  }\n\n  const r = report as Record<string, unknown>;\n  \n  return (\n    typeof r.timestamp === 'number' &&\n    typeof r.url === 'string' &&\n    typeof r.cls === 'number' &&\n    typeof r.lcp === 'number' &&\n    typeof r.fid === 'number' &&\n    typeof r.fcp === 'number' &&\n    typeof r.ttfb === 'number'\n  );\n}\n\n/**\n * 清理过期数据\n */\nexport function cleanupExpiredData(\n  reports: DiagnosticReport[],\n  maxAge: number = 7 * 24 * 60 * 60 * 1000, // 7天\n): DiagnosticReport[] {\n  const cutoffTime = Date.now() - maxAge;\n  return reports.filter(report => report.timestamp > cutoffTime);\n}\n\n/**\n * 合并历史数据\n */\nexport function mergeHistoricalData(\n  existing: DiagnosticReport[],\n  newReports: DiagnosticReport[],\n): DiagnosticReport[] {\n  const combined = [...existing, ...newReports];\n  \n  // 去重（基于时间戳和URL）\n  const unique = combined.filter((report, index, array) => {\n    return array.findIndex(r => \n      r.timestamp === report.timestamp && r.url === report.url\n    ) === index;\n  });\n\n  // 按时间戳排序\n  unique.sort((a, b) => a.timestamp - b.timestamp);\n\n  // 限制数量\n  return unique.slice(-MAX_HISTORY_SIZE);\n}\n\n/**\n * 导出数据到文件\n */\nexport function exportDataToFile(\n  data: unknown,\n  filename: string,\n  mimeType: string,\n): void {\n  try {\n    const blob = new Blob([JSON.stringify(data, null, 2)], { type: mimeType });\n    const url = URL.createObjectURL(blob);\n    \n    const link = document.createElement('a');\n    link.href = url;\n    link.download = filename;\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n    \n    URL.revokeObjectURL(url);\n  } catch (error) {\n    logger.error('Failed to export data', { error: error as Error });\n  }\n}\n\n/**\n * 从文件导入数据\n */\nexport function importDataFromFile(\n  file: File,\n  onSuccess: (data: DiagnosticReport[]) => void,\n  onError: (error: Error) => void,\n): void {\n  const reader = new FileReader();\n  \n  reader.onload = (event) => {\n    try {\n      const content = event.target?.result as string;\n      const data = JSON.parse(content);\n      \n      if (Array.isArray(data) && data.every(validateDiagnosticReport)) {\n        onSuccess(data);\n      } else {\n        onError(new Error('Invalid file format'));\n      }\n    } catch (error) {\n      onError(error as Error);\n    }\n  };\n  \n  reader.onerror = () => {\n    onError(new Error('Failed to read file'));\n  };\n  \n  reader.readAsText(file);\n}\n\n/**\n * 获取存储使用情况\n */\nexport function getStorageUsage(): {\n  used: number;\n  available: number;\n  percentage: number;\n} {\n  try {\n    const data = localStorage.getItem(STORAGE_KEY);\n    const used = data ? new Blob([data]).size : 0;\n    \n    // 估算可用空间（大多数浏览器限制为5-10MB）\n    const estimated = 5 * MB; // 5MB\n    const available = Math.max(0, estimated - used);\n    const percentage = (used / estimated) * 100;\n    \n    return { used, available, percentage };\n  } catch (error) {\n    logger.error('Failed to get storage usage', { error: error as Error });\n    return { used: 0, available: 0, percentage: 0 };\n  }\n}\n\n/**\n * 压缩历史数据\n */\nexport function compressHistoricalData(\n  reports: DiagnosticReport[],\n  compressionRatio: number = 0.5,\n): DiagnosticReport[] {\n  if (reports.length <= 10) {\n    return reports;\n  }\n  \n  const targetSize = Math.floor(reports.length * compressionRatio);\n  const step = reports.length / targetSize;\n  \n  const compressed: DiagnosticReport[] = [];\n  for (let i = 0; i < reports.length; i += step) {\n    compressed.push(reports[Math.floor(i)]);\n  }\n  \n  return compressed;\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/hooks/web-vitals-diagnostics-types.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'event' is defined but never used. Allowed unused args must match /^_/u.","line":155,"column":45,"nodeType":"Identifier","messageId":"unusedVar","endLine":155,"endColumn":77,"suggestions":[{"messageId":"removeVar","data":{"varName":"event"},"fix":{"range":[3084,3116],"text":""},"desc":"Remove unused variable 'event'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import type {\n  DiagnosticReport,\n  PageComparison,\n  PerformanceTrend,\n} from './web-vitals-diagnostics-utils';\n\n/**\n * Web Vitals 诊断相关类型定义\n */\n\n/**\n * Web Vitals 诊断状态接口\n */\nexport interface WebVitalsDiagnosticsState {\n  currentReport: DiagnosticReport | null;\n  historicalReports: DiagnosticReport[];\n  isLoading: boolean;\n  error: string | null;\n}\n\n/**\n * 诊断Hook返回参数接口\n */\nexport interface DiagnosticsReturnParams {\n  state: WebVitalsDiagnosticsState;\n  refreshDiagnostics: () => Promise<void>;\n  getPerformanceTrends: () => PerformanceTrend[] | null;\n  getPageComparison: () => PageComparison[];\n  exportReport: (_format?: 'json' | 'csv') => void;\n  clearHistory: () => void;\n}\n\n/**\n * Web Vitals 诊断Hook返回值类型\n */\nexport interface UseWebVitalsDiagnosticsReturn {\n  currentReport: DiagnosticReport | null;\n  historicalReports: DiagnosticReport[];\n  isLoading: boolean;\n  error: string | null;\n  refreshDiagnostics: () => Promise<void>;\n  getPerformanceTrends: () => PerformanceTrend[] | null;\n  getPageComparison: () => PageComparison[];\n  exportReport: (_format?: 'json' | 'csv') => void;\n  clearHistory: () => void;\n}\n\n/**\n * 数据持久化接口\n */\nexport interface WebVitalsDataPersistence {\n  loadHistoricalData: () => DiagnosticReport[];\n  saveToStorage: (_reports: DiagnosticReport[]) => void;\n}\n\n/**\n * 分析功能接口\n */\nexport interface WebVitalsAnalysisFunctions {\n  getPerformanceTrends: () => PerformanceTrend[] | null;\n  getPageComparison: () => PageComparison[];\n}\n\n/**\n * 报告导出功能接口\n */\nexport interface WebVitalsReportExport {\n  exportReport: (_format?: 'json' | 'csv') => void;\n}\n\n/**\n * 数据管理功能接口\n */\nexport interface WebVitalsDataManagement {\n  clearHistory: () => void;\n}\n\n/**\n * 诊断刷新功能接口\n */\nexport interface WebVitalsRefresh {\n  refreshDiagnostics: () => Promise<void>;\n}\n\n/**\n * 初始化数据接口\n */\nexport interface WebVitalsInitializationData {\n  initialData: {\n    historicalReports: DiagnosticReport[];\n    shouldRefresh: boolean;\n  };\n}\n\n/**\n * 测试环境诊断返回值接口\n */\nexport interface TestWebVitalsDiagnosticsReturn {\n  refreshDiagnostics: () => Promise<void>;\n  getPerformanceTrends: () => PerformanceTrend[] | null;\n  getPageComparison: () => PageComparison[];\n  exportReport: (_format?: 'json' | 'csv') => void;\n  clearHistory: () => void;\n}\n\n/**\n * 导出格式类型\n */\nexport type ExportFormat = 'json' | 'csv';\n\n/**\n * 诊断配置选项接口\n */\nexport interface WebVitalsDiagnosticsOptions {\n  enableAutoRefresh?: boolean;\n  refreshInterval?: number;\n  maxHistorySize?: number;\n  enablePersistence?: boolean;\n  enableExport?: boolean;\n}\n\n/**\n * 诊断错误类型\n */\nexport interface WebVitalsDiagnosticsError {\n  code: string;\n  message: string;\n  timestamp: number;\n  context?: Record<string, unknown>;\n}\n\n/**\n * 诊断事件类型\n */\nexport type WebVitalsDiagnosticsEventType = \n  | 'report-generated'\n  | 'data-loaded'\n  | 'data-saved'\n  | 'export-completed'\n  | 'history-cleared'\n  | 'error-occurred';\n\n/**\n * 诊断事件接口\n */\nexport interface WebVitalsDiagnosticsEvent {\n  type: WebVitalsDiagnosticsEventType;\n  timestamp: number;\n  data?: Record<string, unknown>;\n}\n\n/**\n * 诊断监听器类型\n */\nexport type WebVitalsDiagnosticsListener = (event: WebVitalsDiagnosticsEvent) => void;\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/hooks/web-vitals-diagnostics-utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/i18n/__tests__/enhanced-request.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/i18n/__tests__/request.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/i18n/__tests__/routing.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/i18n/enhanced-request.ts","messages":[{"ruleId":"max-params","severity":2,"message":"Function 'createEnhancedResponse' has too many parameters (4). Maximum allowed is 3.","line":61,"column":1,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":61,"endColumn":32}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { getRequestConfig } from 'next-intl/server';\nimport {\n  getCachedMessages,\n  I18nPerformanceMonitor,\n  TranslationCache,\n} from '@/lib/i18n-performance';\nimport { routing } from './routing';\n\n// 重用 request.ts 中的辅助函数\nfunction getEnhancedFormats(locale: string) {\n  return {\n    dateTime: {\n      short: {\n        day: 'numeric' as const,\n        month: 'short' as const,\n        year: 'numeric' as const,\n      },\n      long: {\n        day: 'numeric' as const,\n        month: 'long' as const,\n        year: 'numeric' as const,\n        weekday: 'long' as const,\n      },\n    },\n    number: {\n      precise: {\n        maximumFractionDigits: 5,\n      },\n      currency: {\n        style: 'currency' as const,\n        currency: locale === 'zh' ? 'CNY' : 'USD',\n      },\n      percentage: {\n        style: 'percent' as const,\n        minimumFractionDigits: 1,\n      },\n    },\n    list: {\n      enumeration: {\n        style: 'long' as const,\n        type: 'conjunction' as const,\n      },\n    },\n  };\n}\n\nfunction handleEnhancedCacheMetrics(locale: string, loadTime: number) {\n  I18nPerformanceMonitor.recordLoadTime(loadTime);\n\n  const cache = TranslationCache.getInstance();\n  const cached = cache.get(`messages-${locale}`);\n  if (cached) {\n    I18nPerformanceMonitor.recordCacheHit();\n  } else {\n    I18nPerformanceMonitor.recordCacheMiss();\n  }\n\n  return Boolean(cached);\n}\n\nfunction createEnhancedResponse(\n  locale: string,\n  messages: Record<string, unknown>,\n  loadTime: number,\n  cacheUsed: boolean,\n) {\n  return {\n    locale,\n    messages,\n    timeZone: locale === 'zh' ? 'Asia/Shanghai' : 'UTC',\n    now: new Date(),\n    formats: getEnhancedFormats(locale),\n    metadata: {\n      loadTime,\n      cacheUsed,\n      timestamp: Date.now(),\n    },\n  };\n}\n\nfunction createEnhancedFallbackResponse(locale: string, startTime: number) {\n  return {\n    locale,\n    messages: {},\n    timeZone: locale === 'zh' ? 'Asia/Shanghai' : 'UTC',\n    now: new Date(),\n    formats: getEnhancedFormats(locale),\n    metadata: {\n      loadTime: performance.now() - startTime,\n      cacheUsed: false,\n      error: true,\n      timestamp: Date.now(),\n    },\n  };\n}\n\nexport default getRequestConfig(async ({ requestLocale }) => {\n  const startTime = performance.now();\n  let locale = await requestLocale;\n\n  if (!locale || !routing.locales.includes(locale as 'en' | 'zh')) {\n    locale = routing.defaultLocale;\n  }\n\n  try {\n    const messages = await getCachedMessages(locale);\n    const loadTime = performance.now() - startTime;\n    const cacheUsed = handleEnhancedCacheMetrics(locale, loadTime);\n\n    return createEnhancedResponse(locale, messages, loadTime, cacheUsed);\n  } catch {\n    I18nPerformanceMonitor.recordError();\n    return createEnhancedFallbackResponse(locale, startTime);\n  }\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/i18n/request.ts","messages":[{"ruleId":"max-params","severity":2,"message":"Function 'createSuccessResponse' has too many parameters (4). Maximum allowed is 3.","line":64,"column":1,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":64,"endColumn":31}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { headers } from 'next/headers';\nimport { getRequestConfig } from 'next-intl/server';\nimport {\n  getCachedMessages,\n  I18nPerformanceMonitor,\n  TranslationCache,\n} from '@/lib/i18n-performance';\nimport { routing } from './routing';\n\n// 辅助函数：获取格式配置\nfunction getFormats(locale: string) {\n  return {\n    dateTime: {\n      short: {\n        day: 'numeric' as const,\n        month: 'short' as const,\n        year: 'numeric' as const,\n      },\n      long: {\n        day: 'numeric' as const,\n        month: 'long' as const,\n        year: 'numeric' as const,\n        weekday: 'long' as const,\n      },\n    },\n    number: {\n      precise: {\n        maximumFractionDigits: 5,\n      },\n      currency: {\n        style: 'currency' as const,\n        currency: locale === 'zh' ? 'CNY' : 'USD',\n      },\n      percentage: {\n        style: 'percent' as const,\n        minimumFractionDigits: 1,\n      },\n    },\n    list: {\n      enumeration: {\n        style: 'long' as const,\n        type: 'conjunction' as const,\n      },\n    },\n  };\n}\n\n// 辅助函数：处理缓存性能监控\nfunction handleCacheMetrics(locale: string, loadTime: number) {\n  I18nPerformanceMonitor.recordLoadTime(loadTime);\n\n  const cache = TranslationCache.getInstance();\n  const cached = cache.get(`messages-${locale}`);\n  if (cached) {\n    I18nPerformanceMonitor.recordCacheHit();\n  } else {\n    I18nPerformanceMonitor.recordCacheMiss();\n  }\n\n  return Boolean(cached);\n}\n\n// 辅助函数：创建成功响应\nfunction createSuccessResponse(\n  locale: string,\n  messages: Record<string, unknown>,\n  loadTime: number,\n  cacheUsed: boolean,\n) {\n  return {\n    locale,\n    messages,\n    timeZone: locale === 'zh' ? 'Asia/Shanghai' : 'UTC',\n    now: new Date(),\n    formats: getFormats(locale),\n    strictMessageTypeSafety: true,\n    metadata: {\n      loadTime,\n      cacheUsed,\n      timestamp: Date.now(),\n    },\n  };\n}\n\n// 辅助函数：创建错误回退响应\nasync function createFallbackResponse(locale: string, startTime: number) {\n  return {\n    locale,\n    messages: (await import(`../../messages/${locale}.json`)).default,\n    timeZone: locale === 'zh' ? 'Asia/Shanghai' : 'UTC',\n    now: new Date(),\n    formats: getFormats(locale),\n    metadata: {\n      loadTime: performance.now() - startTime,\n      cacheUsed: false,\n      error: true,\n      timestamp: Date.now(),\n    },\n  };\n}\n\nexport default getRequestConfig(async ({ requestLocale }) => {\n  const startTime = performance.now();\n  let locale = await requestLocale;\n\n  // 获取智能检测信息\n  const headersList = await headers();\n  const detectedLocale = headersList.get('x-detected-locale');\n  const detectionSource = headersList.get('x-detection-source');\n  const detectionConfidence = headersList.get('x-detection-confidence');\n\n  // 如果没有明确的语言偏好，使用智能检测结果\n  if (!locale || !routing.locales.includes(locale as 'en' | 'zh')) {\n    if (\n      detectedLocale &&\n      routing.locales.includes(detectedLocale as 'en' | 'zh')\n    ) {\n      locale = detectedLocale;\n    } else {\n      locale = routing.defaultLocale;\n    }\n  }\n\n  try {\n    const messages = await getCachedMessages(locale);\n    const loadTime = performance.now() - startTime;\n    const cacheUsed = handleCacheMetrics(locale, loadTime);\n\n    // 创建增强的响应，包含检测信息\n    const response = createSuccessResponse(\n      locale,\n      messages,\n      loadTime,\n      cacheUsed,\n    );\n\n    // 添加智能检测元数据\n    if (detectedLocale && detectionSource && detectionConfidence) {\n      (\n        response as typeof response & { metadata: Record<string, unknown> }\n      ).metadata = {\n        ...response.metadata,\n        smartDetection: {\n          detectedLocale,\n          source: detectionSource,\n          confidence: parseFloat(detectionConfidence),\n          applied: locale === detectedLocale,\n        },\n      };\n    }\n\n    return response;\n  } catch {\n    I18nPerformanceMonitor.recordError();\n    return createFallbackResponse(locale, startTime);\n  }\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/i18n/routing.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/i18n/test-config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/accessibility-manager-core.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/accessibility-manager-exports.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/accessibility-manager-static-methods.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/accessibility/setup.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/airtable-advanced.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/airtable-configuration.test.ts","messages":[{"ruleId":"@next/next/no-assign-module-variable","severity":2,"message":"Do not assign to the variable `module`. See: https://nextjs.org/docs/messages/no-assign-module-variable","line":67,"column":5,"nodeType":"VariableDeclaration","endLine":67,"endColumn":71}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Airtable Service - Configuration Tests\n *\n * 专门测试配置功能，包括：\n * - 环境变量配置\n * - 服务初始化\n * - 配置验证\n * - 默认值处理\n */\n\nimport type { AirtableServicePrivate, DynamicImportModule } from '@/types/test-types';\nimport { afterEach, beforeEach, describe, expect, it, vi } from 'vitest';\n\n// Mock Airtable\nconst mockCreate = vi.fn();\nconst mockSelect = vi.fn();\nconst mockUpdate = vi.fn();\nconst mockDestroy = vi.fn();\nconst mockTable = vi.fn().mockReturnValue({\n  create: mockCreate,\n  select: mockSelect,\n  update: mockUpdate,\n  destroy: mockDestroy,\n});\nconst mockBase = vi.fn().mockReturnValue({\n  table: mockTable,\n});\nconst mockConfigure = vi.fn();\n\nvi.mock('airtable', () => ({\n  default: {\n    configure: mockConfigure,\n    base: mockBase,\n  },\n}));\n\n// Use TypeScript Mock modules to bypass Vite's special handling\nvi.mock('@/../env.mjs', async () => {\n  const mockEnv = await import('./mocks/airtable-env');\n  return mockEnv;\n});\n\nvi.mock('./logger', async () => {\n  const mockLogger = await import('./mocks/logger');\n  return mockLogger;\n});\n\nvi.mock('./validations', async () => {\n  const mockValidations = await import('./mocks/airtable-validations');\n  return mockValidations;\n});\n\ndescribe('Airtable Service - Configuration Tests', () => {\n  let AirtableService: typeof import('../airtable');\n\n  beforeEach(async () => {\n    // Clear mocks but preserve the mock functions\n    mockCreate.mockReset();\n    mockSelect.mockReset();\n    mockUpdate.mockReset();\n    mockDestroy.mockReset();\n    mockTable.mockClear();\n    mockBase.mockClear();\n    mockConfigure.mockClear();\n\n    // Dynamically import the module to ensure fresh instance\n    const module = await import('../airtable') as DynamicImportModule;\n    AirtableService = module.AirtableService;\n  });\n\n  afterEach(() => {\n    vi.clearAllMocks();\n  });\n\n  describe('环境变量配置', () => {\n    it('should configure Airtable with valid environment variables', async () => {\n      vi.doMock('@/../env.mjs', () => ({\n        env: {\n          AIRTABLE_API_KEY: 'test-api-key',\n          AIRTABLE_BASE_ID: 'test-base-id',\n          AIRTABLE_TABLE_NAME: 'test-table',\n        },\n      }));\n\n      const { AirtableService: ServiceClass } = await import('../airtable');\n      const service = new ServiceClass();\n\n      expect(service).toBeDefined();\n    });\n\n    it('should use default table name when not provided', async () => {\n      vi.doMock('@/../env.mjs', () => ({\n        env: {\n          AIRTABLE_API_KEY: 'test-api-key',\n          AIRTABLE_BASE_ID: 'test-base-id',\n          // Missing AIRTABLE_TABLE_NAME\n        },\n      }));\n\n      const { AirtableService: ServiceClass } = await import('../airtable');\n      const service = new ServiceClass();\n\n      expect(service).toBeDefined();\n    });\n\n    it('should handle missing API key gracefully', async () => {\n      vi.doMock('@/../env.mjs', () => ({\n        env: {\n          // Missing AIRTABLE_API_KEY\n          AIRTABLE_BASE_ID: 'test-base-id',\n          AIRTABLE_TABLE_NAME: 'test-table',\n        },\n      }));\n\n      const { AirtableService: ServiceClass } = await import('../airtable');\n      const service = new ServiceClass();\n\n      expect(service.isReady()).toBe(false);\n    });\n\n    it('should handle missing base ID gracefully', async () => {\n      vi.doMock('@/../env.mjs', () => ({\n        env: {\n          AIRTABLE_API_KEY: 'test-api-key',\n          // Missing AIRTABLE_BASE_ID\n          AIRTABLE_TABLE_NAME: 'test-table',\n        },\n      }));\n\n      const { AirtableService: ServiceClass } = await import('../airtable');\n      const service = new ServiceClass();\n\n      expect(service.isReady()).toBe(false);\n    });\n\n    it('should handle empty environment variables', async () => {\n      vi.doMock('@/../env.mjs', () => ({\n        env: {\n          AIRTABLE_API_KEY: '',\n          AIRTABLE_BASE_ID: '',\n          AIRTABLE_TABLE_NAME: '',\n        },\n      }));\n\n      const { AirtableService: ServiceClass } = await import('../airtable');\n      const service = new ServiceClass();\n\n      expect(service.isReady()).toBe(false);\n    });\n  });\n\n  describe('服务初始化', () => {\n    it('should initialize service with proper configuration', async () => {\n      vi.doMock('@/../env.mjs', () => ({\n        env: {\n          AIRTABLE_API_KEY: 'test-api-key',\n          AIRTABLE_BASE_ID: 'test-base-id',\n          AIRTABLE_TABLE_NAME: 'test-table',\n        },\n      }));\n\n      const { AirtableService: ServiceClass } = await import('../airtable');\n      const service = new ServiceClass();\n\n      expect(service).toBeInstanceOf(ServiceClass);\n      expect(mockConfigure).toHaveBeenCalledWith({\n        apiKey: 'test-api-key',\n      });\n    });\n\n    it('should create base instance correctly', async () => {\n      vi.doMock('@/../env.mjs', () => ({\n        env: {\n          AIRTABLE_API_KEY: 'test-api-key',\n          AIRTABLE_BASE_ID: 'test-base-id',\n          AIRTABLE_TABLE_NAME: 'test-table',\n        },\n      }));\n\n      const { AirtableService: ServiceClass } = await import('../airtable');\n      const service = new ServiceClass();\n\n      // Access private property for testing\n      const privateService = service as unknown as AirtableServicePrivate;\n      expect(privateService.base).toBeDefined();\n    });\n\n    it('should handle initialization errors gracefully', async () => {\n      // Mock Airtable to throw error during configuration\n      mockConfigure.mockImplementation(() => {\n        throw new Error('Configuration failed');\n      });\n\n      vi.doMock('@/../env.mjs', () => ({\n        env: {\n          AIRTABLE_API_KEY: 'test-api-key',\n          AIRTABLE_BASE_ID: 'test-base-id',\n          AIRTABLE_TABLE_NAME: 'test-table',\n        },\n      }));\n\n      expect(() => {\n        const { AirtableService: ServiceClass } = require('../airtable');\n        new ServiceClass();\n      }).not.toThrow();\n    });\n  });\n\n  describe('配置验证', () => {\n    it('should validate required configuration fields', () => {\n      const service = new AirtableService();\n\n      // Test with missing configuration\n      (service as unknown as AirtableServicePrivate).isConfigured = false;\n      expect(service.isReady()).toBe(false);\n\n      // Test with valid configuration\n      (service as unknown as AirtableServicePrivate).isConfigured = true;\n      (service as unknown as AirtableServicePrivate).base = {\n        table: mockTable,\n      };\n      expect(service.isReady()).toBe(true);\n    });\n\n    it('should check base instance availability', () => {\n      const service = new AirtableService();\n\n      // Test with null base\n      (service as unknown as AirtableServicePrivate).isConfigured = true;\n      (service as unknown as AirtableServicePrivate).base = null;\n      expect(service.isReady()).toBe(false);\n\n      // Test with valid base\n      (service as unknown as AirtableServicePrivate).base = {\n        table: mockTable,\n      };\n      expect(service.isReady()).toBe(true);\n    });\n\n    it('should validate table instance', () => {\n      const service = new AirtableService();\n\n      (service as unknown as AirtableServicePrivate).isConfigured = true;\n      (service as unknown as AirtableServicePrivate).base = {\n        table: mockTable,\n      };\n\n      expect(service.isReady()).toBe(true);\n      expect(mockTable).toBeDefined();\n    });\n  });\n\n  describe('默认值处理', () => {\n    it('should use default table name when not specified', async () => {\n      vi.doMock('@/../env.mjs', () => ({\n        env: {\n          AIRTABLE_API_KEY: 'test-api-key',\n          AIRTABLE_BASE_ID: 'test-base-id',\n          // AIRTABLE_TABLE_NAME not provided\n        },\n      }));\n\n      const { AirtableService: ServiceClass } = await import('../airtable');\n      const service = new ServiceClass();\n\n      expect(service).toBeDefined();\n      // Should use default table name\n    });\n\n    it('should handle undefined environment variables', async () => {\n      vi.doMock('@/../env.mjs', () => ({\n        env: {\n          AIRTABLE_API_KEY: undefined,\n          AIRTABLE_BASE_ID: undefined,\n          AIRTABLE_TABLE_NAME: undefined,\n        },\n      }));\n\n      const { AirtableService: ServiceClass } = await import('../airtable');\n      const service = new ServiceClass();\n\n      expect(service.isReady()).toBe(false);\n    });\n\n    it('should handle null environment variables', async () => {\n      vi.doMock('@/../env.mjs', () => ({\n        env: {\n          AIRTABLE_API_KEY: null,\n          AIRTABLE_BASE_ID: null,\n          AIRTABLE_TABLE_NAME: null,\n        },\n      }));\n\n      const { AirtableService: ServiceClass } = await import('../airtable');\n      const service = new ServiceClass();\n\n      expect(service.isReady()).toBe(false);\n    });\n  });\n\n  describe('错误处理', () => {\n    it('should handle configuration errors gracefully', () => {\n      mockConfigure.mockImplementation(() => {\n        throw new Error('Invalid API key');\n      });\n\n      expect(() => {\n        new AirtableService();\n      }).not.toThrow();\n    });\n\n    it('should handle base creation errors', () => {\n      mockBase.mockImplementation(() => {\n        throw new Error('Invalid base ID');\n      });\n\n      expect(() => {\n        new AirtableService();\n      }).not.toThrow();\n    });\n\n    it('should handle table creation errors', () => {\n      mockTable.mockImplementation(() => {\n        throw new Error('Invalid table name');\n      });\n\n      expect(() => {\n        new AirtableService();\n      }).not.toThrow();\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/airtable-create-operations.test.ts","messages":[{"ruleId":"@next/next/no-assign-module-variable","severity":2,"message":"Do not assign to the variable `module`. See: https://nextjs.org/docs/messages/no-assign-module-variable","line":67,"column":5,"nodeType":"VariableDeclaration","endLine":67,"endColumn":71}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Airtable Service - Create Operations Tests\n *\n * 专门测试创建操作功能，包括：\n * - 创建联系人记录\n * - 可选字段处理\n * - 错误处理\n * - 空数据处理\n */\n\nimport type { AirtableServicePrivate, DynamicImportModule } from '@/types/test-types';\nimport { afterEach, beforeEach, describe, expect, it, vi } from 'vitest';\n\n// Mock Airtable\nconst mockCreate = vi.fn();\nconst mockSelect = vi.fn();\nconst mockUpdate = vi.fn();\nconst mockDestroy = vi.fn();\nconst mockTable = vi.fn().mockReturnValue({\n  create: mockCreate,\n  select: mockSelect,\n  update: mockUpdate,\n  destroy: mockDestroy,\n});\nconst mockBase = vi.fn().mockReturnValue({\n  table: mockTable,\n});\nconst mockConfigure = vi.fn();\n\nvi.mock('airtable', () => ({\n  default: {\n    configure: mockConfigure,\n    base: mockBase,\n  },\n}));\n\n// Use TypeScript Mock modules to bypass Vite's special handling\nvi.mock('@/../env.mjs', async () => {\n  const mockEnv = await import('./mocks/airtable-env');\n  return mockEnv;\n});\n\nvi.mock('./logger', async () => {\n  const mockLogger = await import('./mocks/logger');\n  return mockLogger;\n});\n\nvi.mock('./validations', async () => {\n  const mockValidations = await import('./mocks/airtable-validations');\n  return mockValidations;\n});\n\ndescribe('Airtable Service - Create Operations Tests', () => {\n  let AirtableService: typeof import('../airtable');\n\n  beforeEach(async () => {\n    // Clear mocks but preserve the mock functions\n    mockCreate.mockReset();\n    mockSelect.mockReset();\n    mockUpdate.mockReset();\n    mockDestroy.mockReset();\n    mockTable.mockClear();\n    mockBase.mockClear();\n    mockConfigure.mockClear();\n\n    // Dynamically import the module to ensure fresh instance\n    const module = await import('../airtable') as DynamicImportModule;\n    AirtableService = module.AirtableService;\n  });\n\n  afterEach(() => {\n    vi.clearAllMocks();\n  });\n\n  const validFormData = {\n    firstName: 'John',\n    lastName: 'Doe',\n    email: 'john.doe@example.com',\n    company: 'Test Company',\n    message: 'This is a test message',\n    acceptPrivacy: true,\n    website: '',\n  };\n\n  describe('创建联系人记录', () => {\n    it('should create contact record successfully', async () => {\n      const service = new AirtableService();\n\n      // Override service configuration to make it ready\n      (service as AirtableServicePrivate).isConfigured = true;\n      (service as AirtableServicePrivate).base = {\n        table: mockTable,\n      };\n\n      // Mock successful creation\n      mockCreate.mockResolvedValue([\n        {\n          id: 'rec123456',\n          fields: {\n            'First Name': 'John',\n            'Last Name': 'Doe',\n            Email: 'john.doe@example.com',\n            Company: 'Test Company',\n            Message: 'This is a test message',\n            'Accept Privacy': true,\n          },\n          createdTime: '2023-01-01T00:00:00Z',\n        },\n      ]);\n\n      const result = await service.createContact(validFormData);\n\n      expect(result).toEqual({ id: 'rec123456' });\n      expect(mockCreate).toHaveBeenCalledWith([\n        {\n          fields: {\n            'First Name': 'John',\n            'Last Name': 'Doe',\n            Email: 'john.doe@example.com',\n            Company: 'Test Company',\n            Message: 'This is a test message',\n            'Accept Privacy': true,\n            Website: '',\n          },\n        },\n      ]);\n    });\n\n    it('should include optional fields when provided', async () => {\n      const service = new AirtableService();\n\n      // Override service configuration to make it ready\n      (service as AirtableServicePrivate).isConfigured = true;\n      (service as AirtableServicePrivate).base = {\n        table: mockTable,\n      };\n\n      const formDataWithOptionals = {\n        ...validFormData,\n        phone: '+1234567890',\n        website: 'https://example.com',\n      };\n\n      mockCreate.mockResolvedValue([\n        {\n          id: 'rec123456',\n          fields: formDataWithOptionals,\n          createdTime: '2023-01-01T00:00:00Z',\n        },\n      ]);\n\n      await service.createContact(formDataWithOptionals);\n\n      expect(mockCreate).toHaveBeenCalledWith([\n        {\n          fields: {\n            'First Name': 'John',\n            'Last Name': 'Doe',\n            Email: 'john.doe@example.com',\n            Company: 'Test Company',\n            Message: 'This is a test message',\n            'Accept Privacy': true,\n            Phone: '+1234567890',\n            Website: 'https://example.com',\n          },\n        },\n      ]);\n    });\n\n    it('should throw error when service is not configured', async () => {\n      const service = new AirtableService();\n\n      // Ensure service is not configured\n      (service as AirtableServicePrivate).isConfigured = false;\n      (service as AirtableServicePrivate).base = null;\n\n      await expect(service.createContact(validFormData)).rejects.toThrow(\n        'Airtable service is not configured',\n      );\n    });\n\n    it('should handle creation errors gracefully', async () => {\n      const service = new AirtableService();\n\n      (service as AirtableServicePrivate).isConfigured = true;\n      (service as AirtableServicePrivate).base = {\n        table: mockTable,\n      };\n\n      mockCreate.mockRejectedValue(new Error('Creation failed'));\n\n      await expect(service.createContact(validFormData)).rejects.toThrow(\n        'Creation failed',\n      );\n    });\n\n    it('should handle empty form data', async () => {\n      const service = new AirtableService();\n\n      (service as AirtableServicePrivate).isConfigured = true;\n      (service as AirtableServicePrivate).base = {\n        table: mockTable,\n      };\n\n      const emptyFormData = {\n        firstName: '',\n        lastName: '',\n        email: '',\n        company: '',\n        message: '',\n        acceptPrivacy: false,\n        website: '',\n      };\n\n      mockCreate.mockResolvedValue([\n        {\n          id: 'rec123456',\n          fields: emptyFormData,\n          createdTime: '2023-01-01T00:00:00Z',\n        },\n      ]);\n\n      const result = await service.createContact(emptyFormData);\n\n      expect(result).toEqual({ id: 'rec123456' });\n    });\n\n    it('should handle special characters in form data', async () => {\n      const service = new AirtableService();\n\n      (service as AirtableServicePrivate).isConfigured = true;\n      (service as AirtableServicePrivate).base = {\n        table: mockTable,\n      };\n\n      const specialFormData = {\n        firstName: 'José',\n        lastName: 'García-López',\n        email: 'josé@example.com',\n        company: 'Test & Co.',\n        message: 'Message with \"quotes\" and special chars: @#$%',\n        acceptPrivacy: true,\n        website: 'https://example.com/path?param=value&other=test',\n      };\n\n      mockCreate.mockResolvedValue([\n        {\n          id: 'rec123456',\n          fields: specialFormData,\n          createdTime: '2023-01-01T00:00:00Z',\n        },\n      ]);\n\n      const result = await service.createContact(specialFormData);\n\n      expect(result).toEqual({ id: 'rec123456' });\n      expect(mockCreate).toHaveBeenCalledWith([\n        {\n          fields: {\n            'First Name': 'José',\n            'Last Name': 'García-López',\n            Email: 'josé@example.com',\n            Company: 'Test & Co.',\n            Message: 'Message with \"quotes\" and special chars: @#$%',\n            'Accept Privacy': true,\n            Website: 'https://example.com/path?param=value&other=test',\n          },\n        },\n      ]);\n    });\n\n    it('should handle long text content', async () => {\n      const service = new AirtableService();\n\n      (service as AirtableServicePrivate).isConfigured = true;\n      (service as AirtableServicePrivate).base = {\n        table: mockTable,\n      };\n\n      const longMessage = 'A'.repeat(1000); // Very long message\n      const longFormData = {\n        ...validFormData,\n        message: longMessage,\n      };\n\n      mockCreate.mockResolvedValue([\n        {\n          id: 'rec123456',\n          fields: longFormData,\n          createdTime: '2023-01-01T00:00:00Z',\n        },\n      ]);\n\n      const result = await service.createContact(longFormData);\n\n      expect(result).toEqual({ id: 'rec123456' });\n      expect(mockCreate).toHaveBeenCalledWith([\n        {\n          fields: {\n            'First Name': 'John',\n            'Last Name': 'Doe',\n            Email: 'john.doe@example.com',\n            Company: 'Test Company',\n            Message: longMessage,\n            'Accept Privacy': true,\n            Website: '',\n          },\n        },\n      ]);\n    });\n\n    it('should handle network timeout errors', async () => {\n      const service = new AirtableService();\n\n      (service as AirtableServicePrivate).isConfigured = true;\n      (service as AirtableServicePrivate).base = {\n        table: mockTable,\n      };\n\n      const timeoutError = new Error('Request timeout');\n      timeoutError.name = 'TimeoutError';\n      mockCreate.mockRejectedValue(timeoutError);\n\n      await expect(service.createContact(validFormData)).rejects.toThrow(\n        'Request timeout',\n      );\n    });\n\n    it('should handle rate limiting errors', async () => {\n      const service = new AirtableService();\n\n      (service as AirtableServicePrivate).isConfigured = true;\n      (service as AirtableServicePrivate).base = {\n        table: mockTable,\n      };\n\n      const rateLimitError = new Error('Rate limit exceeded');\n      rateLimitError.name = 'RateLimitError';\n      mockCreate.mockRejectedValue(rateLimitError);\n\n      await expect(service.createContact(validFormData)).rejects.toThrow(\n        'Rate limit exceeded',\n      );\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/airtable-error-handling.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/airtable-operations.test.ts","messages":[{"ruleId":"@next/next/no-assign-module-variable","severity":2,"message":"Do not assign to the variable `module`. See: https://nextjs.org/docs/messages/no-assign-module-variable","line":70,"column":5,"nodeType":"VariableDeclaration","endLine":70,"endColumn":71}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Airtable Service - Main Operations Tests\n *\n * 主要操作集成测试，包括：\n * - 核心服务导出验证\n * - 基本操作集成测试\n * - 错误处理验证\n * \n * 详细测试请参考：\n * - airtable-crud.test.ts - CRUD操作专门测试\n * - airtable-configuration.test.ts - 配置功能测试\n */\n\nimport type { AirtableServicePrivate, DynamicImportModule } from '@/types/test-types';\nimport { afterEach, beforeEach, describe, expect, it, vi } from 'vitest';\n\n// Mock Airtable\nconst mockCreate = vi.fn();\nconst mockSelect = vi.fn();\nconst mockUpdate = vi.fn();\nconst mockDestroy = vi.fn();\nconst mockTable = vi.fn().mockReturnValue({\n  create: mockCreate,\n  select: mockSelect,\n  update: mockUpdate,\n  destroy: mockDestroy,\n});\nconst mockBase = vi.fn().mockReturnValue({\n  table: mockTable,\n});\nconst mockConfigure = vi.fn();\n\nvi.mock('airtable', () => ({\n  default: {\n    configure: mockConfigure,\n    base: mockBase,\n  },\n}));\n\n// Use TypeScript Mock modules to bypass Vite's special handling\nvi.mock('@/../env.mjs', async () => {\n  const mockEnv = await import('./mocks/airtable-env');\n  return mockEnv;\n});\n\nvi.mock('./logger', async () => {\n  const mockLogger = await import('./mocks/logger');\n  return mockLogger;\n});\n\nvi.mock('./validations', async () => {\n  const mockValidations = await import('./mocks/airtable-validations');\n  return mockValidations;\n});\n\ndescribe('Airtable Service - Main Operations Tests', () => {\n  let AirtableService: typeof import('../airtable');\n\n  beforeEach(async () => {\n    // Clear mocks but preserve the mock functions\n    mockCreate.mockReset();\n    mockSelect.mockReset();\n    mockUpdate.mockReset();\n    mockDestroy.mockReset();\n    mockTable.mockClear();\n    mockBase.mockClear();\n    mockConfigure.mockClear();\n\n    // Dynamically import the module to ensure fresh instance\n    const module = await import('../airtable') as DynamicImportModule;\n    AirtableService = module.AirtableService;\n  });\n\n  afterEach(() => {\n    vi.clearAllMocks();\n  });\n\n  const validFormData = {\n    firstName: 'John',\n    lastName: 'Doe',\n    email: 'john.doe@example.com',\n    company: 'Test Company',\n    message: 'This is a test message',\n    acceptPrivacy: true,\n    website: '',\n  };\n\n  describe('核心服务导出验证', () => {\n    it('should export AirtableService class', () => {\n      expect(AirtableService).toBeDefined();\n      expect(typeof AirtableService).toBe('function');\n    });\n\n    it('should create AirtableService instance', () => {\n      const service = new AirtableService();\n      expect(service).toBeInstanceOf(AirtableService);\n    });\n  });\n\n  describe('基本操作集成测试', () => {\n    it('should handle basic contact creation', async () => {\n      const service = new AirtableService();\n\n      // Override service configuration to make it ready\n      (service as AirtableServicePrivate).isConfigured = true;\n      (service as AirtableServicePrivate).base = {\n        table: mockTable,\n      };\n\n      // Mock successful creation\n      mockCreate.mockResolvedValue([\n        {\n          id: 'rec123456',\n          fields: validFormData,\n          createdTime: '2023-01-01T00:00:00Z',\n        },\n      ]);\n\n      const result = await service.createContact(validFormData);\n\n      expect(result).toEqual({ id: 'rec123456' });\n      expect(mockCreate).toHaveBeenCalled();\n    });\n\n    it('should handle basic contact retrieval', async () => {\n      const service = new AirtableService();\n\n      // Override service configuration to make it ready\n      (service as unknown as AirtableServicePrivate).isConfigured = true;\n      (service as unknown as AirtableServicePrivate).base = {\n        table: mockTable,\n      };\n\n      const mockRecords = [\n        {\n          id: 'rec123456',\n          fields: { 'First Name': 'John', 'Last Name': 'Doe' },\n          createdTime: '2023-01-01T00:00:00Z',\n        },\n      ];\n\n      mockSelect.mockReturnValue({\n        all: vi.fn().mockResolvedValue(mockRecords),\n      });\n\n      const result = await service.getContacts();\n\n      expect(result).toEqual(mockRecords);\n      expect(mockSelect).toHaveBeenCalled();\n    });\n\n    it('should handle contact status updates', async () => {\n      const service = new AirtableService();\n\n      (service as unknown as AirtableServicePrivate).isConfigured = true;\n      (service as unknown as AirtableServicePrivate).base = {\n        table: mockTable,\n      };\n\n      mockUpdate.mockResolvedValue([\n        {\n          id: 'rec123456',\n          fields: { Status: 'Contacted' },\n          createdTime: '2023-01-01T00:00:00Z',\n        },\n      ]);\n\n      const result = await service.updateContactStatus('rec123456', 'Contacted');\n\n      expect(result).toEqual({ id: 'rec123456' });\n      expect(mockUpdate).toHaveBeenCalled();\n    });\n\n    it('should handle contact deletion', async () => {\n      const service = new AirtableService();\n\n      (service as unknown as AirtableServicePrivate).isConfigured = true;\n      (service as unknown as AirtableServicePrivate).base = {\n        table: mockTable,\n      };\n\n      mockDestroy.mockResolvedValue([{ id: 'rec123456', deleted: true }]);\n\n      const result = await service.deleteContact('rec123456');\n\n      expect(result).toEqual({ id: 'rec123456', deleted: true });\n      expect(mockDestroy).toHaveBeenCalledWith(['rec123456']);\n    });\n\n    it('should check service readiness correctly', () => {\n      const service = new AirtableService();\n\n      // Test with missing configuration\n      (service as unknown as AirtableServicePrivate).isConfigured = false;\n      expect(service.isReady()).toBe(false);\n\n      // Test with valid configuration\n      (service as unknown as AirtableServicePrivate).isConfigured = true;\n      (service as unknown as AirtableServicePrivate).base = {\n        table: mockTable,\n      };\n      expect(service.isReady()).toBe(true);\n    });\n  });\n\n  describe('错误处理验证', () => {\n    it('should handle missing configuration gracefully', async () => {\n      const service = new AirtableService();\n\n      // Ensure service is not configured\n      (service as AirtableServicePrivate).isConfigured = false;\n      (service as AirtableServicePrivate).base = null;\n\n      await expect(service.createContact(validFormData)).rejects.toThrow(\n        'Airtable service is not configured',\n      );\n    });\n\n    it('should handle API errors gracefully', async () => {\n      const service = new AirtableService();\n\n      (service as AirtableServicePrivate).isConfigured = true;\n      (service as AirtableServicePrivate).base = {\n        table: mockTable,\n      };\n\n      mockCreate.mockRejectedValue(new Error('API Error'));\n\n      await expect(service.createContact(validFormData)).rejects.toThrow(\n        'API Error',\n      );\n    });\n\n    it('should handle retrieval errors gracefully', async () => {\n      const service = new AirtableService();\n\n      (service as unknown as AirtableServicePrivate).isConfigured = true;\n      (service as unknown as AirtableServicePrivate).base = {\n        table: mockTable,\n      };\n\n      mockSelect.mockReturnValue({\n        all: vi.fn().mockRejectedValue(new Error('Retrieval failed')),\n      });\n\n      await expect(service.getContacts()).rejects.toThrow('Retrieval failed');\n    });\n\n    it('should handle update errors gracefully', async () => {\n      const service = new AirtableService();\n\n      (service as unknown as AirtableServicePrivate).isConfigured = true;\n      (service as unknown as AirtableServicePrivate).base = {\n        table: mockTable,\n      };\n\n      mockUpdate.mockRejectedValue(new Error('Update failed'));\n\n      await expect(\n        service.updateContactStatus('rec123456', 'Contacted'),\n      ).rejects.toThrow('Update failed');\n    });\n\n    it('should handle deletion errors gracefully', async () => {\n      const service = new AirtableService();\n\n      (service as unknown as AirtableServicePrivate).isConfigured = true;\n      (service as unknown as AirtableServicePrivate).base = {\n        table: mockTable,\n      };\n\n      mockDestroy.mockRejectedValue(new Error('Deletion failed'));\n\n      await expect(service.deleteContact('rec123456')).rejects.toThrow(\n        'Deletion failed',\n      );\n    });\n  });\n\n  describe('Mock验证', () => {\n    it('should have proper mock setup', () => {\n      expect(mockCreate).toBeDefined();\n      expect(mockSelect).toBeDefined();\n      expect(mockUpdate).toBeDefined();\n      expect(mockDestroy).toBeDefined();\n      expect(mockTable).toBeDefined();\n      expect(mockBase).toBeDefined();\n      expect(mockConfigure).toBeDefined();\n    });\n\n    it('should reset mocks between tests', () => {\n      expect(mockCreate).not.toHaveBeenCalled();\n      expect(mockSelect).not.toHaveBeenCalled();\n      expect(mockUpdate).not.toHaveBeenCalled();\n      expect(mockDestroy).not.toHaveBeenCalled();\n    });\n  });\n\n  describe('服务状态检查', () => {\n    it('should return true when properly configured', () => {\n      const service = new AirtableService();\n\n      // Override service configuration to make it ready\n      (service as unknown as AirtableServicePrivate).isConfigured = true;\n      (service as unknown as AirtableServicePrivate).base = {\n        table: mockTable,\n      };\n\n      expect(service.isReady()).toBe(true);\n    });\n\n    it('should return false when not configured', async () => {\n      const service = new AirtableService();\n\n      // Ensure service is not configured\n      (service as unknown as AirtableServicePrivate).isConfigured = false;\n      (service as unknown as AirtableServicePrivate).base = null;\n\n      expect(service.isReady()).toBe(false);\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/airtable-read-operations.test.ts","messages":[{"ruleId":"@next/next/no-assign-module-variable","severity":2,"message":"Do not assign to the variable `module`. See: https://nextjs.org/docs/messages/no-assign-module-variable","line":67,"column":5,"nodeType":"VariableDeclaration","endLine":67,"endColumn":71}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Airtable Service - Read Operations Tests\n *\n * 专门测试读取操作功能，包括：\n * - 获取联系人记录\n * - 查询选项处理\n * - 错误处理\n * - 空结果处理\n */\n\nimport type { AirtableServicePrivate, DynamicImportModule } from '@/types/test-types';\nimport { afterEach, beforeEach, describe, expect, it, vi } from 'vitest';\n\n// Mock Airtable\nconst mockCreate = vi.fn();\nconst mockSelect = vi.fn();\nconst mockUpdate = vi.fn();\nconst mockDestroy = vi.fn();\nconst mockTable = vi.fn().mockReturnValue({\n  create: mockCreate,\n  select: mockSelect,\n  update: mockUpdate,\n  destroy: mockDestroy,\n});\nconst mockBase = vi.fn().mockReturnValue({\n  table: mockTable,\n});\nconst mockConfigure = vi.fn();\n\nvi.mock('airtable', () => ({\n  default: {\n    configure: mockConfigure,\n    base: mockBase,\n  },\n}));\n\n// Use TypeScript Mock modules to bypass Vite's special handling\nvi.mock('@/../env.mjs', async () => {\n  const mockEnv = await import('./mocks/airtable-env');\n  return mockEnv;\n});\n\nvi.mock('./logger', async () => {\n  const mockLogger = await import('./mocks/logger');\n  return mockLogger;\n});\n\nvi.mock('./validations', async () => {\n  const mockValidations = await import('./mocks/airtable-validations');\n  return mockValidations;\n});\n\ndescribe('Airtable Service - Read Operations Tests', () => {\n  let AirtableService: typeof import('../airtable');\n\n  beforeEach(async () => {\n    // Clear mocks but preserve the mock functions\n    mockCreate.mockReset();\n    mockSelect.mockReset();\n    mockUpdate.mockReset();\n    mockDestroy.mockReset();\n    mockTable.mockClear();\n    mockBase.mockClear();\n    mockConfigure.mockClear();\n\n    // Dynamically import the module to ensure fresh instance\n    const module = await import('../airtable') as DynamicImportModule;\n    AirtableService = module.AirtableService;\n  });\n\n  afterEach(() => {\n    vi.clearAllMocks();\n  });\n\n  describe('获取联系人记录', () => {\n    it('should retrieve contact records successfully', async () => {\n      const service = new AirtableService();\n\n      // Override service configuration to make it ready\n      (service as unknown as AirtableServicePrivate).isConfigured = true;\n      (service as unknown as AirtableServicePrivate).base = {\n        table: mockTable,\n      };\n\n      const mockRecords = [\n        {\n          id: 'rec123456',\n          fields: { 'First Name': 'John', 'Last Name': 'Doe' },\n          createdTime: '2023-01-01T00:00:00Z',\n        },\n      ];\n\n      mockSelect.mockReturnValue({\n        all: vi.fn().mockResolvedValue(mockRecords),\n      });\n\n      const result = await service.getContacts();\n\n      expect(result).toEqual(mockRecords);\n      expect(mockSelect).toHaveBeenCalled();\n    });\n\n    it('should handle query options', async () => {\n      const service = new AirtableService();\n\n      // Override service configuration to make it ready\n      (service as unknown as AirtableServicePrivate).isConfigured = true;\n      (service as unknown as AirtableServicePrivate).base = {\n        table: mockTable,\n      };\n\n      const options = {\n        maxRecords: 10,\n        sort: [{ field: 'Created Time', direction: 'desc' as const }],\n      };\n\n      mockSelect.mockReturnValue({\n        all: vi.fn().mockResolvedValue([]),\n      });\n\n      await service.getContacts(options);\n\n      expect(mockSelect).toHaveBeenCalledWith(options);\n    });\n\n    it('should throw error when service is not configured', async () => {\n      const service = new AirtableService();\n\n      // Ensure service is not configured\n      (service as unknown as AirtableServicePrivate).isConfigured = false;\n      (service as unknown as AirtableServicePrivate).base = null;\n\n      await expect(service.getContacts()).rejects.toThrow(\n        'Airtable service is not configured',\n      );\n    });\n\n    it('should handle retrieval errors gracefully', async () => {\n      const service = new AirtableService();\n\n      (service as unknown as AirtableServicePrivate).isConfigured = true;\n      (service as unknown as AirtableServicePrivate).base = {\n        table: mockTable,\n      };\n\n      mockSelect.mockReturnValue({\n        all: vi.fn().mockRejectedValue(new Error('Retrieval failed')),\n      });\n\n      await expect(service.getContacts()).rejects.toThrow('Retrieval failed');\n    });\n\n    it('should handle empty results', async () => {\n      const service = new AirtableService();\n\n      (service as unknown as AirtableServicePrivate).isConfigured = true;\n      (service as unknown as AirtableServicePrivate).base = {\n        table: mockTable,\n      };\n\n      mockSelect.mockReturnValue({\n        all: vi.fn().mockResolvedValue([]),\n      });\n\n      const result = await service.getContacts();\n\n      expect(result).toEqual([]);\n    });\n\n    it('should handle complex query options', async () => {\n      const service = new AirtableService();\n\n      (service as unknown as AirtableServicePrivate).isConfigured = true;\n      (service as unknown as AirtableServicePrivate).base = {\n        table: mockTable,\n      };\n\n      const complexOptions = {\n        maxRecords: 50,\n        sort: [\n          { field: 'Created Time', direction: 'desc' as const },\n          { field: 'First Name', direction: 'asc' as const },\n        ],\n        filterByFormula: \"AND({Status} = 'New', {Email} != '')\",\n        fields: ['First Name', 'Last Name', 'Email', 'Company'],\n      };\n\n      mockSelect.mockReturnValue({\n        all: vi.fn().mockResolvedValue([]),\n      });\n\n      await service.getContacts(complexOptions);\n\n      expect(mockSelect).toHaveBeenCalledWith(complexOptions);\n    });\n\n    it('should handle large result sets', async () => {\n      const service = new AirtableService();\n\n      (service as unknown as AirtableServicePrivate).isConfigured = true;\n      (service as unknown as AirtableServicePrivate).base = {\n        table: mockTable,\n      };\n\n      // Create a large mock dataset\n      const largeDataset = Array.from({ length: 1000 }, (_, index) => ({\n        id: `rec${index.toString().padStart(6, '0')}`,\n        fields: {\n          'First Name': `User${index}`,\n          'Last Name': `Test${index}`,\n          Email: `user${index}@example.com`,\n        },\n        createdTime: '2023-01-01T00:00:00Z',\n      }));\n\n      mockSelect.mockReturnValue({\n        all: vi.fn().mockResolvedValue(largeDataset),\n      });\n\n      const result = await service.getContacts();\n\n      expect(result).toHaveLength(1000);\n      expect(result[0].fields['First Name']).toBe('User0');\n      expect(result[999].fields['First Name']).toBe('User999');\n    });\n\n    it('should handle pagination options', async () => {\n      const service = new AirtableService();\n\n      (service as unknown as AirtableServicePrivate).isConfigured = true;\n      (service as unknown as AirtableServicePrivate).base = {\n        table: mockTable,\n      };\n\n      const paginationOptions = {\n        maxRecords: 100,\n        pageSize: 20,\n        offset: 'recABC123',\n      };\n\n      mockSelect.mockReturnValue({\n        all: vi.fn().mockResolvedValue([]),\n      });\n\n      await service.getContacts(paginationOptions);\n\n      expect(mockSelect).toHaveBeenCalledWith(paginationOptions);\n    });\n\n    it('should handle network timeout during retrieval', async () => {\n      const service = new AirtableService();\n\n      (service as unknown as AirtableServicePrivate).isConfigured = true;\n      (service as unknown as AirtableServicePrivate).base = {\n        table: mockTable,\n      };\n\n      const timeoutError = new Error('Request timeout');\n      timeoutError.name = 'TimeoutError';\n\n      mockSelect.mockReturnValue({\n        all: vi.fn().mockRejectedValue(timeoutError),\n      });\n\n      await expect(service.getContacts()).rejects.toThrow('Request timeout');\n    });\n\n    it('should handle API rate limiting during retrieval', async () => {\n      const service = new AirtableService();\n\n      (service as unknown as AirtableServicePrivate).isConfigured = true;\n      (service as unknown as AirtableServicePrivate).base = {\n        table: mockTable,\n      };\n\n      const rateLimitError = new Error('Rate limit exceeded');\n      rateLimitError.name = 'RateLimitError';\n\n      mockSelect.mockReturnValue({\n        all: vi.fn().mockRejectedValue(rateLimitError),\n      });\n\n      await expect(service.getContacts()).rejects.toThrow('Rate limit exceeded');\n    });\n\n    it('should handle malformed response data', async () => {\n      const service = new AirtableService();\n\n      (service as unknown as AirtableServicePrivate).isConfigured = true;\n      (service as unknown as AirtableServicePrivate).base = {\n        table: mockTable,\n      };\n\n      // Mock malformed data (missing required fields)\n      const malformedData = [\n        {\n          // Missing id field\n          fields: { 'First Name': 'John' },\n          createdTime: '2023-01-01T00:00:00Z',\n        },\n        {\n          id: 'rec123456',\n          // Missing fields property\n          createdTime: '2023-01-01T00:00:00Z',\n        },\n      ];\n\n      mockSelect.mockReturnValue({\n        all: vi.fn().mockResolvedValue(malformedData),\n      });\n\n      const result = await service.getContacts();\n\n      // Should still return the data as-is, letting the caller handle validation\n      expect(result).toEqual(malformedData);\n    });\n\n    it('should handle view-based queries', async () => {\n      const service = new AirtableService();\n\n      (service as unknown as AirtableServicePrivate).isConfigured = true;\n      (service as unknown as AirtableServicePrivate).base = {\n        table: mockTable,\n      };\n\n      const viewOptions = {\n        view: 'Grid view',\n        maxRecords: 25,\n      };\n\n      mockSelect.mockReturnValue({\n        all: vi.fn().mockResolvedValue([]),\n      });\n\n      await service.getContacts(viewOptions);\n\n      expect(mockSelect).toHaveBeenCalledWith(viewOptions);\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/airtable.test.ts","messages":[{"ruleId":"@next/next/no-assign-module-variable","severity":2,"message":"Do not assign to the variable `module`. See: https://nextjs.org/docs/messages/no-assign-module-variable","line":86,"column":7,"nodeType":"VariableDeclaration","endLine":86,"endColumn":50},{"ruleId":"@next/next/no-assign-module-variable","severity":2,"message":"Do not assign to the variable `module`. See: https://nextjs.org/docs/messages/no-assign-module-variable","line":102,"column":7,"nodeType":"VariableDeclaration","endLine":102,"endColumn":50}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Airtable Tests - Index\n *\n * Basic integration tests for Airtable service functionality.\n * For comprehensive testing, see:\n * - airtable-basic.test.ts - Basic CRUD operations\n * - airtable-advanced.test.ts - Advanced functionality and error handling\n */\n\nimport type { AirtableServicePrivate, DynamicImportModule } from '@/types/test-types';\nimport { afterEach, beforeEach, describe, expect, it, vi } from 'vitest';\n\n// Mock Airtable\nconst mockCreate = vi.fn();\nconst mockSelect = vi.fn();\nconst mockUpdate = vi.fn();\nconst mockDestroy = vi.fn();\nconst mockTable = vi.fn().mockReturnValue({\n  create: mockCreate,\n  select: mockSelect,\n  update: mockUpdate,\n  destroy: mockDestroy,\n});\nconst mockBase = vi.fn().mockReturnValue({\n  table: mockTable,\n});\nconst mockConfigure = vi.fn();\n\nvi.mock('airtable', () => ({\n  default: {\n    configure: mockConfigure,\n    base: mockBase,\n  },\n}));\n\n// Use TypeScript Mock modules to bypass Vite's special handling\nvi.mock('@/../env.mjs', async () => {\n  const mockEnv = await import('./mocks/airtable-env');\n  return mockEnv;\n});\n\nvi.mock('./logger', async () => {\n  const mockLogger = await import('./mocks/logger');\n  return mockLogger;\n});\n\nvi.mock('./validations', async () => {\n  const mockValidations = await import('./mocks/airtable-validations');\n  return mockValidations;\n});\n\ndescribe('Airtable Tests - Index', () => {\n  let AirtableService: typeof import('../airtable');\n\n  beforeEach(async () => {\n    // Clear mocks but preserve the mock functions\n    mockCreate.mockReset();\n    mockSelect.mockReset();\n    mockUpdate.mockReset();\n    mockDestroy.mockReset();\n    mockTable.mockClear();\n    mockBase.mockClear();\n    mockConfigure.mockClear();\n\n    // Reset modules to ensure fresh imports\n    vi.resetModules();\n\n    // Import the service fresh for each test\n    AirtableService = await import('../airtable');\n  });\n\n  afterEach(() => {\n    vi.clearAllMocks();\n  });\n\n  describe('Basic Configuration', () => {\n    it('should configure Airtable with valid environment variables', async () => {\n      vi.doMock('@/../env.mjs', () => ({\n        env: {\n          AIRTABLE_API_KEY: 'test-api-key',\n          AIRTABLE_BASE_ID: 'test-base-id',\n          AIRTABLE_TABLE_NAME: 'test-table',\n        },\n      }));\n\n      const module = await import('../airtable');\n      const ServiceClass = (module as DynamicImportModule).default || module.AirtableService;\n      const service = new ServiceClass();\n\n      expect(service).toBeDefined();\n    });\n\n    it('should use default table name when not provided', async () => {\n      vi.doMock('@/../env.mjs', () => ({\n        env: {\n          AIRTABLE_API_KEY: 'test-api-key',\n          AIRTABLE_BASE_ID: 'test-base-id',\n          // Missing AIRTABLE_TABLE_NAME\n        },\n      }));\n\n      const module = await import('../airtable');\n      const ServiceClass = (module as DynamicImportModule).default || module.AirtableService;\n      const service = new ServiceClass();\n\n      expect(service).toBeDefined();\n    });\n  });\n\n  describe('Basic createContact', () => {\n    const validFormData = {\n      firstName: 'John',\n      lastName: 'Doe',\n      email: 'john.doe@example.com',\n      company: 'Test Company',\n      message: 'This is a test message',\n      acceptPrivacy: true,\n      website: '',\n    };\n\n    it('should create contact record successfully', async () => {\n      const service = new AirtableService();\n\n      // Override service configuration to make it ready\n      (service as AirtableServicePrivate).isConfigured = true;\n      (service as AirtableServicePrivate).base = {\n        table: vi.fn().mockReturnValue({\n          create: mockCreate,\n        }),\n      };\n\n      const mockRecord = {\n        id: 'rec123456',\n        fields: {\n          'First Name': 'John',\n          'Last Name': 'Doe',\n          'Email': 'john.doe@example.com',\n          'Company': 'Test Company',\n          'Message': 'This is a test message',\n          'Status': 'New',\n        },\n        get: vi.fn().mockReturnValue('2023-01-01T00:00:00Z'),\n      };\n\n      mockCreate.mockClear();\n      mockCreate.mockResolvedValue([mockRecord]);\n\n      const result = await service.createContact(validFormData);\n\n      expect(result).toEqual({\n        id: 'rec123456',\n        fields: mockRecord.fields,\n        createdTime: '2023-01-01T00:00:00Z',\n      });\n\n      expect(mockCreate).toHaveBeenCalledWith([\n        expect.objectContaining({\n          fields: expect.objectContaining({\n            'First Name': 'John',\n            'Last Name': 'Doe',\n            'Email': 'john.doe@example.com',\n            'Company': 'Test Company',\n            'Message': 'This is a test message',\n            'Status': 'New',\n            'Source': 'Website Contact Form',\n          }),\n        }),\n      ]);\n    });\n\n    it('should throw error when service is not configured', async () => {\n      const service = new AirtableService();\n\n      // Ensure service is not configured\n      (service as AirtableServicePrivate).isConfigured = false;\n      (service as AirtableServicePrivate).base = null;\n\n      await expect(service.createContact(validFormData)).rejects.toThrow(\n        'Airtable service is not configured',\n      );\n    });\n  });\n\n  describe('Basic getContacts', () => {\n    it('should retrieve contact records successfully', async () => {\n      const service = new AirtableService();\n\n      // Override service configuration to make it ready\n      (service as unknown as AirtableServicePrivate).isConfigured = true;\n      (service as unknown as AirtableServicePrivate).base = {\n        table: vi.fn().mockReturnValue({\n          select: mockSelect,\n        }),\n      };\n\n      const mockRecords = [\n        {\n          id: 'rec1',\n          fields: { 'First Name': 'John', 'Last Name': 'Doe' },\n          get: vi.fn().mockReturnValue('2023-01-01T00:00:00Z'),\n        },\n        {\n          id: 'rec2',\n          fields: { 'First Name': 'Jane', 'Last Name': 'Smith' },\n          get: vi.fn().mockReturnValue('2023-01-02T00:00:00Z'),\n        },\n      ];\n\n      const mockSelectChain = {\n        all: vi.fn().mockResolvedValue(mockRecords),\n      };\n      mockSelect.mockClear();\n      mockSelect.mockReturnValue(mockSelectChain);\n\n      const result = await service.getContacts();\n\n      expect(result).toHaveLength(2);\n      expect(result[0]).toEqual({\n        id: 'rec1',\n        fields: { 'First Name': 'John', 'Last Name': 'Doe' },\n        createdTime: '2023-01-01T00:00:00Z',\n      });\n    });\n\n    it('should throw error when service is not configured', async () => {\n      const service = new AirtableService();\n\n      // Ensure service is not configured\n      (service as unknown as AirtableServicePrivate).isConfigured = false;\n      (service as unknown as AirtableServicePrivate).base = null;\n\n      await expect(service.getContacts()).rejects.toThrow(\n        'Airtable service is not configured',\n      );\n    });\n  });\n\n  describe('Basic updateContactStatus', () => {\n    it('should update contact status successfully', async () => {\n      const service = new AirtableService();\n\n      // Override service configuration to make it ready\n      (service as unknown as AirtableServicePrivate).isConfigured = true;\n      (service as unknown as AirtableServicePrivate).base = {\n        table: vi.fn().mockReturnValue({\n          update: mockUpdate,\n        }),\n      };\n\n      mockUpdate.mockClear();\n      mockUpdate.mockResolvedValue([\n        {\n          id: 'rec123456',\n          fields: { Status: 'Contacted' },\n          get: vi.fn().mockReturnValue('2023-01-01T00:00:00Z'),\n        },\n      ]);\n\n      const result = await service.updateContactStatus('rec123456', 'Contacted');\n\n      expect(result).toEqual({\n        id: 'rec123456',\n        fields: { Status: 'Contacted' },\n        createdTime: '2023-01-01T00:00:00Z',\n      });\n\n      expect(mockUpdate).toHaveBeenCalledWith([\n        {\n          id: 'rec123456',\n          fields: { Status: 'Contacted' },\n        },\n      ]);\n    });\n\n    it('should throw error when service is not configured', async () => {\n      const service = new AirtableService();\n\n      // Ensure service is not configured\n      (service as unknown as AirtableServicePrivate).isConfigured = false;\n      (service as unknown as AirtableServicePrivate).base = null;\n\n      await expect(service.updateContactStatus('rec123456', 'Contacted')).rejects.toThrow(\n        'Airtable service is not configured',\n      );\n    });\n  });\n\n  describe('Basic deleteContact', () => {\n    it('should delete contact successfully', async () => {\n      const service = new AirtableService();\n\n      // Override service configuration to make it ready\n      (service as unknown as AirtableServicePrivate).isConfigured = true;\n      (service as unknown as AirtableServicePrivate).base = {\n        table: vi.fn().mockReturnValue({\n          destroy: mockDestroy,\n        }),\n      };\n\n      mockDestroy.mockClear();\n      mockDestroy.mockResolvedValue([{ id: 'rec123456', deleted: true }]);\n\n      await service.deleteContact('rec123456');\n\n      expect(mockDestroy).toHaveBeenCalledWith(['rec123456']);\n    });\n\n    it('should throw error when service is not configured', async () => {\n      const service = new AirtableService();\n\n      // Ensure service is not configured\n      (service as unknown as AirtableServicePrivate).isConfigured = false;\n      (service as unknown as AirtableServicePrivate).base = null;\n\n      await expect(service.deleteContact('rec123456')).rejects.toThrow(\n        'Airtable service is not configured',\n      );\n    });\n  });\n\n  describe('Basic isReady', () => {\n    it('should return true when properly configured', () => {\n      const service = new AirtableService();\n\n      // Override service configuration to make it ready\n      (service as unknown as AirtableServicePrivate).isConfigured = true;\n      (service as unknown as AirtableServicePrivate).base = {\n        table: vi.fn().mockReturnValue({\n          create: mockCreate,\n          select: mockSelect,\n          update: mockUpdate,\n          destroy: mockDestroy,\n        }),\n      };\n\n      expect(service.isReady()).toBe(true);\n    });\n\n    it('should return false when not configured', async () => {\n      const service = new AirtableService();\n\n      // Ensure service is not configured\n      (service as unknown as AirtableServicePrivate).isConfigured = false;\n      (service as unknown as AirtableServicePrivate).base = null;\n\n      expect(service.isReady()).toBe(false);\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/colors-contrast-compliance.test.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'TEST_CONSTANTS' is defined but never used. Allowed unused vars must match /^_/u.","line":10,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":24,"suggestions":[{"messageId":"removeVar","data":{"varName":"TEST_CONSTANTS"},"fix":{"range":[226,286],"text":""},"desc":"Remove unused variable 'TEST_CONSTANTS'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'TEST_CONSTANTS' is defined but never used. Allowed unused vars must match /^_/u.","line":10,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":10,"endColumn":24}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Color Contrast and Compliance Tests\n *\n * Tests for color contrast compliance and accessibility standards including:\n * - WCAG AA/AAA compliance checking\n * - CSS variable generation\n * - Theme contrast validation\n */\n\nimport { TEST_CONSTANTS } from '@/constants/test-constants';\nimport {\n  checkContrastCompliance,\n  generateCSSVariables,\n  lightThemeColors,\n  darkThemeColors,\n  validateThemeContrast,\n  type OKLCHColor,\n} from '../colors';\n\ndescribe('Color Contrast and Compliance Tests', () => {\n  describe('checkContrastCompliance', () => {\n    it('should pass AA compliance for high contrast colors', () => {\n      const white: OKLCHColor = { l: 1, c: 0, h: 0 };\n      const black: OKLCHColor = { l: 0, c: 0, h: 0 };\n\n      expect(checkContrastCompliance(white, black, 'AA')).toBe(true);\n    });\n\n    it('should pass AAA compliance for very high contrast colors', () => {\n      const white: OKLCHColor = { l: 1, c: 0, h: 0 };\n      const black: OKLCHColor = { l: 0, c: 0, h: 0 };\n\n      expect(checkContrastCompliance(white, black, 'AAA')).toBe(true);\n    });\n\n    it('should fail AA compliance for low contrast colors', () => {\n      const lightGray: OKLCHColor = { l: 0.8, c: 0, h: 0 };\n      const mediumGray: OKLCHColor = { l: 0.75, c: 0, h: 0 };\n\n      expect(checkContrastCompliance(lightGray, mediumGray, 'AA')).toBe(false);\n    });\n\n    it('should fail AAA compliance for medium contrast colors', () => {\n      const color1: OKLCHColor = { l: 0.7, c: 0.1, h: 120 };\n      const color2: OKLCHColor = { l: 0.4, c: 0.1, h: 120 };\n\n      // This might pass AA but should fail AAA\n      expect(checkContrastCompliance(color1, color2, 'AAA')).toBe(false);\n    });\n\n    it('should handle edge case contrast ratios', () => {\n      // Create colors that are right at the AA threshold\n      const color1: OKLCHColor = { l: 0.6, c: 0, h: 0 };\n      const color2: OKLCHColor = { l: 0.3, c: 0, h: 0 };\n\n      const aaResult = checkContrastCompliance(color1, color2, 'AA');\n      const aaaResult = checkContrastCompliance(color1, color2, 'AAA');\n\n      expect(typeof aaResult).toBe('boolean');\n      expect(typeof aaaResult).toBe('boolean');\n    });\n\n    it('should be symmetric (order independent)', () => {\n      const color1: OKLCHColor = { l: 0.8, c: 0.1, h: 60 };\n      const color2: OKLCHColor = { l: 0.2, c: 0.1, h: 240 };\n\n      const result1 = checkContrastCompliance(color1, color2, 'AA');\n      const result2 = checkContrastCompliance(color2, color1, 'AA');\n\n      expect(result1).toBe(result2);\n    });\n\n    it('should handle identical colors', () => {\n      const color: OKLCHColor = { l: 0.5, c: 0.1, h: 180 };\n\n      expect(checkContrastCompliance(color, color, 'AA')).toBe(false);\n      expect(checkContrastCompliance(color, color, 'AAA')).toBe(false);\n    });\n\n    it('should handle colors with alpha values', () => {\n      const color1: OKLCHColor = { l: 0.9, c: 0, h: 0, alpha: 0.8 };\n      const color2: OKLCHColor = { l: 0.1, c: 0, h: 0, alpha: 0.9 };\n\n      const result = checkContrastCompliance(color1, color2, 'AA');\n      expect(typeof result).toBe('boolean');\n    });\n\n    it('should handle extreme lightness values', () => {\n      const extremeLight: OKLCHColor = { l: 2, c: 0, h: 0 };\n      const extremeDark: OKLCHColor = { l: -0.5, c: 0, h: 0 };\n\n      expect(() => checkContrastCompliance(extremeLight, extremeDark, 'AA')).not.toThrow();\n    });\n\n    it('should handle NaN and Infinity values', () => {\n      const nanColor: OKLCHColor = { l: NaN, c: 0, h: 0 };\n      const infiniteColor: OKLCHColor = { l: Infinity, c: 0, h: 0 };\n      const normalColor: OKLCHColor = { l: 0.5, c: 0, h: 0 };\n\n      expect(() => checkContrastCompliance(nanColor, normalColor, 'AA')).not.toThrow();\n      expect(() => checkContrastCompliance(infiniteColor, normalColor, 'AA')).not.toThrow();\n    });\n\n    it('should handle very precise color values', () => {\n      const preciseColor1: OKLCHColor = {\n        l: 0.123456789,\n        c: 0.987654321,\n        h: 359.999999,\n      };\n      const preciseColor2: OKLCHColor = {\n        l: 0.876543211,\n        c: 0.012345679,\n        h: 0.000001,\n      };\n\n      expect(() =>\n        checkContrastCompliance(preciseColor1, preciseColor2, 'AAA'),\n      ).not.toThrow();\n    });\n  });\n\n  describe('generateCSSVariables', () => {\n    it('should generate CSS variables with correct naming', () => {\n      const testColors = {\n        background: { l: 1, c: 0, h: 0 },\n        foreground: { l: 0, c: 0, h: 0 },\n        primaryForeground: { l: 1, c: 0, h: 0 },\n      };\n\n      const result = generateCSSVariables(testColors);\n\n      expect(result).toHaveProperty('--background');\n      expect(result).toHaveProperty('--foreground');\n      expect(result).toHaveProperty('--primary-foreground');\n    });\n\n    it('should convert camelCase to kebab-case for CSS variables', () => {\n      const testColors = {\n        primaryBackground: { l: 0.9, c: 0.05, h: 200 },\n        secondaryForeground: { l: 0.1, c: 0.1, h: 120 },\n      };\n\n      const result = generateCSSVariables(testColors);\n\n      expect(result).toHaveProperty('--primary-background');\n      expect(result).toHaveProperty('--secondary-foreground');\n    });\n\n    it('should generate valid OKLCH CSS values', () => {\n      const testColors = {\n        primary: { l: 0.6, c: 0.2, h: 240 },\n        secondary: { l: 0.8, c: 0.1, h: 120, alpha: 0.9 },\n      };\n\n      const result = generateCSSVariables(testColors);\n\n      expect(result['--primary']).toBe('oklch(0.6 0.2 240)');\n      expect(result['--secondary']).toBe('oklch(0.8 0.1 120 / 0.9)');\n    });\n\n    it('should handle empty color object', () => {\n      const result = generateCSSVariables({});\n\n      expect(result).toEqual({});\n    });\n\n    it('should handle colors with alpha values', () => {\n      const testColors = {\n        overlay: { l: 0.5, c: 0, h: 0, alpha: 0.8 },\n      };\n\n      const result = generateCSSVariables(testColors);\n\n      expect(result).toEqual({\n        '--overlay': 'oklch(0.5 0 0 / 0.8)',\n      });\n    });\n  });\n\n  describe('validateThemeContrast', () => {\n    it('should validate light theme contrast compliance', () => {\n      const validation = validateThemeContrast(lightThemeColors);\n\n      expect(validation).toHaveProperty('compliant');\n      expect(validation).toHaveProperty('issues');\n      expect(Array.isArray(validation.issues)).toBe(true);\n    });\n\n    it('should validate dark theme contrast compliance', () => {\n      const validation = validateThemeContrast(darkThemeColors);\n\n      expect(validation).toHaveProperty('compliant');\n      expect(validation).toHaveProperty('issues');\n      expect(Array.isArray(validation.issues)).toBe(true);\n    });\n\n    it('should identify contrast issues in problematic theme', () => {\n      const problematicTheme = {\n        background: { l: 0.9, c: 0, h: 0 },\n        foreground: { l: 0.85, c: 0, h: 0 }, // Too similar to background\n        primary: { l: 0.5, c: 0.2, h: 240 },\n        primaryForeground: { l: 0.45, c: 0.1, h: 240 }, // Too similar to primary\n      };\n\n      const validation = validateThemeContrast(problematicTheme);\n\n      expect(validation.compliant).toBe(false);\n      expect(validation.issues.length).toBeGreaterThan(0);\n    });\n\n    it('should pass validation for high contrast theme', () => {\n      const highContrastTheme = {\n        background: { l: 1, c: 0, h: 0 },\n        foreground: { l: 0, c: 0, h: 0 },\n        primary: { l: 0.3, c: 0.2, h: 240 },\n        primaryForeground: { l: 1, c: 0, h: 0 },\n      };\n\n      const validation = validateThemeContrast(highContrastTheme);\n\n      expect(validation.compliant).toBe(true);\n      expect(validation.issues).toHaveLength(0);\n    });\n\n    it('should handle theme with missing color pairs', () => {\n      const incompleteTheme = {\n        background: { l: 1, c: 0, h: 0 },\n        primary: { l: 0.5, c: 0.2, h: 240 },\n        // Missing foreground and primaryForeground\n      };\n\n      const validation = validateThemeContrast(incompleteTheme);\n\n      expect(validation).toHaveProperty('compliant');\n      expect(validation).toHaveProperty('issues');\n    });\n\n    it('should provide detailed issue descriptions', () => {\n      const problematicTheme = {\n        background: { l: 0.5, c: 0, h: 0 },\n        foreground: { l: 0.48, c: 0, h: 0 }, // Very low contrast\n      };\n\n      const validation = validateThemeContrast(problematicTheme);\n\n      if (validation.issues.length > 0) {\n        expect(validation.issues[0]).toMatch(/需要 ≥4\\.5:1/);\n      }\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/colors-oklch-conversion.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/colors-theme-validation.test.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'key' is defined but never used. Allowed unused args must match /^_/u.","line":45,"column":50,"nodeType":"Identifier","messageId":"unusedVar","endLine":45,"endColumn":53,"suggestions":[{"messageId":"removeVar","data":{"varName":"key"},"fix":{"range":[1401,1404],"text":""},"desc":"Remove unused variable 'key'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'key' is defined but never used. Allowed unused args must match /^_/u.","line":45,"column":50,"nodeType":null,"messageId":"unusedVar","endLine":45,"endColumn":53},{"ruleId":"no-unused-vars","severity":2,"message":"'key' is defined but never used. Allowed unused args must match /^_/u.","line":63,"column":49,"nodeType":"Identifier","messageId":"unusedVar","endLine":63,"endColumn":52,"suggestions":[{"messageId":"removeVar","data":{"varName":"key"},"fix":{"range":[2048,2051],"text":""},"desc":"Remove unused variable 'key'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'key' is defined but never used. Allowed unused args must match /^_/u.","line":63,"column":49,"nodeType":null,"messageId":"unusedVar","endLine":63,"endColumn":52},{"ruleId":"no-unused-vars","severity":2,"message":"'key' is defined but never used. Allowed unused args must match /^_/u.","line":83,"column":43,"nodeType":"Identifier","messageId":"unusedVar","endLine":83,"endColumn":46,"suggestions":[{"messageId":"removeVar","data":{"varName":"key"},"fix":{"range":[2754,2757],"text":""},"desc":"Remove unused variable 'key'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'key' is defined but never used. Allowed unused args must match /^_/u.","line":83,"column":43,"nodeType":null,"messageId":"unusedVar","endLine":83,"endColumn":46},{"ruleId":"no-unused-vars","severity":2,"message":"'key' is defined but never used. Allowed unused args must match /^_/u.","line":94,"column":43,"nodeType":"Identifier","messageId":"unusedVar","endLine":94,"endColumn":46,"suggestions":[{"messageId":"removeVar","data":{"varName":"key"},"fix":{"range":[3194,3197],"text":""},"desc":"Remove unused variable 'key'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'key' is defined but never used. Allowed unused args must match /^_/u.","line":94,"column":43,"nodeType":null,"messageId":"unusedVar","endLine":94,"endColumn":46}],"suppressedMessages":[],"errorCount":8,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Color Theme Validation and Edge Cases Tests\n *\n * Tests for color theme validation, ColorSystem utilities, and edge case handling including:\n * - ColorSystem utility class functionality\n * - Theme color definition validation\n * - Edge case handling for extreme values\n */\n\nimport {\n  ColorSystem,\n  darkThemeColors,\n  generateCSSVariables,\n  lightThemeColors,\n  oklchToCSS,\n  validateThemeContrast,\n  type OKLCHColor,\n} from '../colors';\n\ndescribe('Color Theme Validation and Edge Cases Tests', () => {\n  describe('ColorSystem工具类', () => {\n    it('should provide access to light theme colors', () => {\n      expect(ColorSystem.light).toBe(lightThemeColors);\n    });\n\n    it('should provide access to dark theme colors', () => {\n      expect(ColorSystem.dark).toBe(darkThemeColors);\n    });\n\n    it('should provide utility functions', () => {\n      expect(ColorSystem.generateVariables).toBe(generateCSSVariables);\n      expect(ColorSystem.validate).toBe(validateThemeContrast);\n    });\n  });\n\n  describe('主题颜色定义验证', () => {\n    it('should have consistent color keys between light and dark themes', () => {\n      const lightKeys = Object.keys(lightThemeColors).sort();\n      const darkKeys = Object.keys(darkThemeColors).sort();\n\n      expect(lightKeys).toEqual(darkKeys);\n    });\n\n    it('should have valid OKLCH values in light theme', () => {\n      Object.entries(lightThemeColors).forEach(([key, color]) => {\n        expect(color).toHaveProperty('l');\n        expect(color).toHaveProperty('c');\n        expect(color).toHaveProperty('h');\n\n        expect(typeof color.l).toBe('number');\n        expect(typeof color.c).toBe('number');\n        expect(typeof color.h).toBe('number');\n\n        // Basic sanity checks\n        expect(color.l).toBeGreaterThanOrEqual(0);\n        expect(color.c).toBeGreaterThanOrEqual(0);\n        expect(color.h).toBeGreaterThanOrEqual(0);\n        expect(color.h).toBeLessThan(360);\n      });\n    });\n\n    it('should have valid OKLCH values in dark theme', () => {\n      Object.entries(darkThemeColors).forEach(([key, color]) => {\n        expect(color).toHaveProperty('l');\n        expect(color).toHaveProperty('c');\n        expect(color).toHaveProperty('h');\n\n        expect(typeof color.l).toBe('number');\n        expect(typeof color.c).toBe('number');\n        expect(typeof color.h).toBe('number');\n\n        // Basic sanity checks\n        expect(color.l).toBeGreaterThanOrEqual(0);\n        expect(color.c).toBeGreaterThanOrEqual(0);\n        expect(color.h).toBeGreaterThanOrEqual(0);\n        expect(color.h).toBeLessThan(360);\n      });\n    });\n\n    it('should have reasonable lightness values', () => {\n      const allColors = { ...lightThemeColors, ...darkThemeColors };\n\n      Object.entries(allColors).forEach(([key, color]) => {\n        // Lightness should typically be between 0 and 1\n        expect(color.l).toBeLessThanOrEqual(1);\n        expect(color.l).toBeGreaterThanOrEqual(0);\n      });\n    });\n\n    it('should have reasonable chroma values', () => {\n      const allColors = { ...lightThemeColors, ...darkThemeColors };\n      const maxReasonableChroma = 0.5; // Most colors should have chroma <= 0.5\n\n      Object.entries(allColors).forEach(([key, color]) => {\n        expect(color.c).toBeLessThanOrEqual(maxReasonableChroma);\n      });\n    });\n  });\n\n  describe('边缘情况处理', () => {\n    it('should handle extreme lightness values', () => {\n      const extremeLight: OKLCHColor = { l: 1, c: 0, h: 0 };\n      const extremeDark: OKLCHColor = { l: 0, c: 0, h: 0 };\n\n      expect(() => oklchToCSS(extremeLight)).not.toThrow();\n      expect(() => oklchToCSS(extremeDark)).not.toThrow();\n    });\n\n    it('should handle extreme chroma values', () => {\n      const highChroma: OKLCHColor = { l: 0.5, c: 1, h: 180 };\n      const zeroChroma: OKLCHColor = { l: 0.5, c: 0, h: 180 };\n\n      expect(() => oklchToCSS(highChroma)).not.toThrow();\n      expect(() => oklchToCSS(zeroChroma)).not.toThrow();\n    });\n\n    it('should handle extreme hue values', () => {\n      const negativeHue: OKLCHColor = { l: 0.5, c: 0.2, h: -180 };\n      const largeHue: OKLCHColor = { l: 0.5, c: 0.2, h: 720 };\n\n      expect(() => oklchToCSS(negativeHue)).not.toThrow();\n      expect(() => oklchToCSS(largeHue)).not.toThrow();\n    });\n\n    it('should handle fractional alpha values', () => {\n      const colors = [\n        { l: 0.5, c: 0.1, h: 180, alpha: 0.1 },\n        { l: 0.5, c: 0.1, h: 180, alpha: 0.5 },\n        { l: 0.5, c: 0.1, h: 180, alpha: 0.99 },\n      ];\n\n      colors.forEach((color) => {\n        expect(() => oklchToCSS(color)).not.toThrow();\n      });\n    });\n\n    it('should handle very small numeric values', () => {\n      const tinyColor: OKLCHColor = {\n        l: 0.000001,\n        c: 0.000001,\n        h: 0.000001,\n        alpha: 0.000001,\n      };\n\n      expect(() => oklchToCSS(tinyColor)).not.toThrow();\n    });\n\n    it('should handle very large numeric values', () => {\n      const hugeColor: OKLCHColor = {\n        l: 999999,\n        c: 999999,\n        h: 999999,\n        alpha: 999999,\n      };\n\n      expect(() => oklchToCSS(hugeColor)).not.toThrow();\n    });\n\n    it('should handle scientific notation values', () => {\n      const scientificColor: OKLCHColor = {\n        l: 1e-10,\n        c: 1e-5,\n        h: 1e2,\n        alpha: 1e-1,\n      };\n\n      expect(() => oklchToCSS(scientificColor)).not.toThrow();\n    });\n\n    it('should handle mixed extreme values', () => {\n      const mixedColor: OKLCHColor = {\n        l: Infinity,\n        c: 0,\n        h: NaN,\n        alpha: -Infinity,\n      };\n\n      expect(() => oklchToCSS(mixedColor)).not.toThrow();\n    });\n\n    it('should handle undefined properties gracefully', () => {\n      const partialColor = { l: 0.5, c: 0.1 } as OKLCHColor;\n\n      expect(() => oklchToCSS(partialColor)).not.toThrow();\n    });\n\n    it('should handle null and undefined color objects', () => {\n      expect(() => oklchToCSS(null as unknown)).toThrow();\n      expect(() => oklchToCSS(undefined as unknown)).toThrow();\n    });\n\n    it('should handle empty color object', () => {\n      const emptyColor = {} as OKLCHColor;\n\n      expect(() => oklchToCSS(emptyColor)).not.toThrow();\n    });\n\n    it('should handle color object with extra properties', () => {\n      const extendedColor = {\n        l: 0.5,\n        c: 0.1,\n        h: 180,\n        alpha: 0.8,\n        extraProperty: 'should be ignored',\n        anotherExtra: 123,\n      } as OKLCHColor;\n\n      expect(() => oklchToCSS(extendedColor)).not.toThrow();\n    });\n\n    it('should handle string values in numeric properties', () => {\n      const stringColor = {\n        l: '0.5' as unknown,\n        c: '0.1' as unknown,\n        h: '180' as unknown,\n        alpha: '0.8' as unknown,\n      };\n\n      expect(() => oklchToCSS(stringColor)).not.toThrow();\n    });\n\n    it('should handle boolean values in numeric properties', () => {\n      const booleanColor = {\n        l: true as unknown,\n        c: false as unknown,\n        h: true as unknown,\n        alpha: false as unknown,\n      };\n\n      expect(() => oklchToCSS(booleanColor)).not.toThrow();\n    });\n\n    it('should handle array values in numeric properties', () => {\n      const arrayColor = {\n        l: [0.5] as unknown,\n        c: [0.1, 0.2] as unknown,\n        h: [] as unknown,\n        alpha: [0.8] as unknown,\n      };\n\n      expect(() => oklchToCSS(arrayColor)).not.toThrow();\n    });\n\n    it('should handle object values in numeric properties', () => {\n      const objectColor = {\n        l: { value: 0.5 } as unknown,\n        c: { nested: { value: 0.1 } } as unknown,\n        h: { toString: () => '180' } as unknown,\n        alpha: { valueOf: () => 0.8 } as unknown,\n      };\n\n      expect(() => oklchToCSS(objectColor)).not.toThrow();\n    });\n\n    it('should handle function values in numeric properties', () => {\n      const functionColor = {\n        l: (() => 0.5) as unknown,\n        c: Math.sin as unknown,\n        h: parseInt as unknown,\n        alpha: parseFloat as unknown,\n      };\n\n      expect(() => oklchToCSS(functionColor)).not.toThrow();\n    });\n\n    it('should handle Symbol values in numeric properties', () => {\n      const symbolColor = {\n        l: Symbol('lightness') as unknown,\n        c: Symbol.iterator as unknown,\n        h: Symbol.for('hue') as unknown,\n        alpha: Symbol.toPrimitive as unknown,\n      };\n\n      expect(() => oklchToCSS(symbolColor)).not.toThrow();\n    });\n\n    it('should handle BigInt values in numeric properties', () => {\n      const bigintColor = {\n        l: BigInt(1) as unknown,\n        c: BigInt(0) as unknown,\n        h: BigInt(180) as unknown,\n        alpha: BigInt(1) as unknown,\n      };\n\n      expect(() => oklchToCSS(bigintColor)).not.toThrow();\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/colors.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/content-parser.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/content-utils.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/content-validation-advanced.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/content-validation-basic.test.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'TEST_CONTENT_LIMITS' is defined but never used. Allowed unused vars must match /^_/u.","line":11,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":22,"suggestions":[{"messageId":"removeVar","data":{"varName":"TEST_CONTENT_LIMITS"},"fix":{"range":[110,130],"text":""},"desc":"Remove unused variable 'TEST_CONTENT_LIMITS'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'TEST_CONTENT_LIMITS' is defined but never used. Allowed unused vars must match /^_/u.","line":11,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":11,"endColumn":22},{"ruleId":"no-unused-vars","severity":2,"message":"'TEST_COUNT_CONSTANTS' is defined but never used. Allowed unused vars must match /^_/u.","line":12,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":23,"suggestions":[{"messageId":"removeVar","data":{"varName":"TEST_COUNT_CONSTANTS"},"fix":{"range":[129,153],"text":""},"desc":"Remove unused variable 'TEST_COUNT_CONSTANTS'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'TEST_COUNT_CONSTANTS' is defined but never used. Allowed unused vars must match /^_/u.","line":12,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":12,"endColumn":23},{"ruleId":"no-unused-vars","severity":2,"message":"'ContentType' is defined but never used. Allowed unused vars must match /^_/u.","line":14,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"ContentType"},"fix":{"range":[192,238],"text":""},"desc":"Remove unused variable 'ContentType'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ContentType' is defined but never used. Allowed unused vars must match /^_/u.","line":14,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":14,"endColumn":21}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Content Validation - Basic Tests\n *\n * 测试基本验证功能：\n * - 必填字段验证\n * - 日期格式验证\n * - 基本数据类型验证\n */\n\nimport {\n  TEST_CONTENT_LIMITS,\n  TEST_COUNT_CONSTANTS,\n} from '@/constants/test-constants';\nimport { ContentType } from '@/types/content';\nimport { describe, expect, it } from 'vitest';\nimport { validateContentMetadata } from '../content-validation';\n\ndescribe('Content Validation - Basic Tests', () => {\n  describe('validateContentMetadata - Basic Validation', () => {\n    const validMetadata = {\n      title: 'Test Article',\n      publishedAt: '2024-01-01T00:00:00Z',\n      updatedAt: '2024-01-02T00:00:00Z',\n      excerpt: 'This is a test excerpt',\n      tags: ['test', 'article'],\n      seo: {\n        title: 'SEO Title',\n        description: 'SEO description for the article',\n      },\n    };\n\n    describe('required fields validation', () => {\n      it('should pass validation with all required fields', () => {\n        const result = validateContentMetadata(validMetadata, 'post');\n\n        expect(result.isValid).toBe(true);\n        expect(result.errors).toHaveLength(0);\n      });\n\n      it('should fail validation when title is missing', () => {\n        const { title: _title, ...metadataWithoutTitle } = validMetadata;\n\n        const result = validateContentMetadata(metadataWithoutTitle, 'post');\n\n        expect(result.isValid).toBe(false);\n        expect(result.errors).toContain('Title is required');\n      });\n\n      it('should fail validation when publishedAt is missing', () => {\n        const { publishedAt: _publishedAt, ...metadataWithoutPublishedAt } =\n          validMetadata;\n\n        const result = validateContentMetadata(\n          metadataWithoutPublishedAt,\n          'post',\n        );\n\n        expect(result.isValid).toBe(false);\n        expect(result.errors).toContain('Published date is required');\n      });\n\n      it('should fail validation when updatedAt is missing', () => {\n        const { updatedAt: _updatedAt, ...metadataWithoutUpdatedAt } =\n          validMetadata;\n\n        const result = validateContentMetadata(\n          metadataWithoutUpdatedAt,\n          'post',\n        );\n\n        expect(result.isValid).toBe(false);\n        expect(result.errors).toContain('Updated date is required');\n      });\n\n      it('should fail validation when title is empty string', () => {\n        const metadataWithEmptyTitle = {\n          ...validMetadata,\n          title: '',\n        };\n\n        const result = validateContentMetadata(metadataWithEmptyTitle, 'post');\n\n        expect(result.isValid).toBe(false);\n        expect(result.errors).toContain('Title is required');\n      });\n\n      it('should fail validation when title is only whitespace', () => {\n        const metadataWithWhitespaceTitle = {\n          ...validMetadata,\n          title: '   ',\n        };\n\n        const result = validateContentMetadata(\n          metadataWithWhitespaceTitle,\n          'post',\n        );\n\n        expect(result.isValid).toBe(false);\n        expect(result.errors).toContain('Title is required');\n      });\n\n      it('should fail validation when multiple required fields are missing', () => {\n        const {\n          title: _title,\n          publishedAt: _publishedAt,\n          ...metadataWithoutMultiple\n        } = validMetadata;\n\n        const result = validateContentMetadata(metadataWithoutMultiple, 'post');\n\n        expect(result.isValid).toBe(false);\n        expect(result.errors).toContain('Title is required');\n        expect(result.errors).toContain('Published date is required');\n      });\n    });\n\n    describe('date validation', () => {\n      it('should pass validation with valid ISO date strings', () => {\n        const metadata = {\n          ...validMetadata,\n          publishedAt: '2024-01-01T00:00:00Z',\n          updatedAt: '2024-01-02T12:30:45Z',\n        };\n\n        const result = validateContentMetadata(metadata, 'post');\n\n        expect(result.isValid).toBe(true);\n        expect(result.errors).toHaveLength(0);\n      });\n\n      it('should fail validation with invalid publishedAt date format', () => {\n        const metadata = {\n          ...validMetadata,\n          publishedAt: 'invalid-date',\n        };\n\n        const result = validateContentMetadata(metadata, 'post');\n\n        expect(result.isValid).toBe(false);\n        expect(result.errors).toContain('Published date must be a valid ISO date');\n      });\n\n      it('should fail validation with invalid updatedAt date format', () => {\n        const metadata = {\n          ...validMetadata,\n          updatedAt: 'not-a-date',\n        };\n\n        const result = validateContentMetadata(metadata, 'post');\n\n        expect(result.isValid).toBe(false);\n        expect(result.errors).toContain('Updated date must be a valid ISO date');\n      });\n\n      it('should fail validation when updatedAt is before publishedAt', () => {\n        const metadata = {\n          ...validMetadata,\n          publishedAt: '2024-01-02T00:00:00Z',\n          updatedAt: '2024-01-01T00:00:00Z',\n        };\n\n        const result = validateContentMetadata(metadata, 'post');\n\n        expect(result.isValid).toBe(false);\n        expect(result.errors).toContain(\n          'Updated date must be after published date',\n        );\n      });\n\n      it('should pass validation when updatedAt equals publishedAt', () => {\n        const metadata = {\n          ...validMetadata,\n          publishedAt: '2024-01-01T00:00:00Z',\n          updatedAt: '2024-01-01T00:00:00Z',\n        };\n\n        const result = validateContentMetadata(metadata, 'post');\n\n        expect(result.isValid).toBe(true);\n        expect(result.errors).toHaveLength(0);\n      });\n\n      it('should handle dates with different timezone formats', () => {\n        const metadata = {\n          ...validMetadata,\n          publishedAt: '2024-01-01T00:00:00+00:00',\n          updatedAt: '2024-01-02T00:00:00-05:00',\n        };\n\n        const result = validateContentMetadata(metadata, 'post');\n\n        expect(result.isValid).toBe(true);\n        expect(result.errors).toHaveLength(0);\n      });\n\n\n\n      it('should fail validation with timestamp numbers', () => {\n        const metadata = {\n          ...validMetadata,\n          publishedAt: 1704067200000 as unknown as string, // timestamp\n        };\n\n        const result = validateContentMetadata(metadata, 'post');\n\n        expect(result.isValid).toBe(false);\n        expect(result.errors).toContain('Published date must be a valid ISO date');\n      });\n    });\n\n    describe('basic data type validation', () => {\n      it('should fail validation when title is not a string', () => {\n        const metadata = {\n          ...validMetadata,\n          title: 123 as unknown as string,\n        };\n\n        const result = validateContentMetadata(metadata, 'post');\n\n        expect(result.isValid).toBe(false);\n        expect(result.errors).toContain('Title must be a string');\n      });\n\n      it('should fail validation when tags is not an array', () => {\n        const metadata = {\n          ...validMetadata,\n          tags: 'not-an-array' as unknown as string[],\n        };\n\n        const result = validateContentMetadata(metadata, 'post');\n\n        expect(result.isValid).toBe(false);\n        expect(result.errors).toContain('Tags must be an array');\n      });\n\n      it('should fail validation when excerpt is not a string', () => {\n        const metadata = {\n          ...validMetadata,\n          excerpt: 456 as unknown as string,\n        };\n\n        const result = validateContentMetadata(metadata, 'post');\n\n        expect(result.isValid).toBe(false);\n        expect(result.errors).toContain('Excerpt must be a string');\n      });\n\n\n\n      it('should validate array elements in tags', () => {\n        const metadata = {\n          ...validMetadata,\n          tags: ['valid-tag', 123, 'another-valid-tag'] as unknown as string[],\n        };\n\n        const result = validateContentMetadata(metadata, 'post');\n\n        expect(result.isValid).toBe(false);\n        expect(result.errors).toContain('All tags must be strings');\n      });\n\n      it('should handle empty arrays in tags', () => {\n        const metadata = {\n          ...validMetadata,\n          tags: [],\n        };\n\n        const result = validateContentMetadata(metadata, 'post');\n\n        // Empty tags array should be valid\n        expect(result.isValid).toBe(true);\n        expect(result.errors).toHaveLength(0);\n      });\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/content-validation.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/enhanced-web-vitals-core.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/enhanced-web-vitals.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/footer-config.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/i18n-cache-advanced.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/i18n-cache-basic.test.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'Locale' is defined but never used. Allowed unused vars must match /^_/u.","line":11,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"Locale"},"fix":{"range":[184,227],"text":""},"desc":"Remove unused variable 'Locale'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Locale' is defined but never used. Allowed unused vars must match /^_/u.","line":11,"column":15,"nodeType":null,"messageId":"unusedVar","endLine":11,"endColumn":21},{"ruleId":"no-unused-vars","severity":2,"message":"'WEB_VITALS_CONSTANTS' is defined but never used. Allowed unused vars must match /^_/u.","line":12,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":30,"suggestions":[{"messageId":"removeVar","data":{"varName":"WEB_VITALS_CONSTANTS"},"fix":{"range":[228,294],"text":""},"desc":"Remove unused variable 'WEB_VITALS_CONSTANTS'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'WEB_VITALS_CONSTANTS' is defined but never used. Allowed unused vars must match /^_/u.","line":12,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":12,"endColumn":30}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * I18n Cache Manager - Basic Functionality Tests\n *\n * 测试基本功能：\n * - 初始化和配置\n * - 消息加载和缓存\n * - 基本缓存操作\n */\n\nimport { afterEach, beforeEach, describe, expect, it, vi } from 'vitest';\nimport type { Locale } from '@/types/i18n';\nimport { WEB_VITALS_CONSTANTS } from '@/constants/test-constants';\nimport { i18nCache, I18nCacheManager } from '../i18n-cache';\n\n// Mock localStorage\nconst mockLocalStorage = {\n  getItem: vi.fn(),\n  setItem: vi.fn(),\n  removeItem: vi.fn(),\n  clear: vi.fn(),\n};\n\n// Mock dynamic imports - need to mock the actual import paths used by I18nCacheManager\nconst mockEnMessages = {\n  common: {\n    hello: 'Hello',\n    goodbye: 'Goodbye',\n  },\n  navigation: {\n    home: 'Home',\n    about: 'About',\n  },\n};\n\nconst mockZhMessages = {\n  common: {\n    hello: '你好',\n    goodbye: '再见',\n  },\n  navigation: {\n    home: '首页',\n    about: '关于',\n  },\n};\n\n// Mock the dynamic import function used by I18nCacheManager\nvi.mock('../../messages/en.json', () => ({\n  default: mockEnMessages,\n}));\n\nvi.mock('../../messages/zh.json', () => ({\n  default: mockZhMessages,\n}));\n\n// Mock constants\nvi.mock('@/constants/i18n-constants', () => ({\n  CACHE_DURATIONS: {\n    PERFORMANCE_CACHE: 300000, // 5 minutes\n  },\n  CACHE_LIMITS: {\n    MAX_CACHE_ENTRIES: 100,\n  },\n}));\n\ndescribe('I18nCacheManager - Basic Functionality', () => {\n  let cacheManager: I18nCacheManager;\n\n  beforeEach(() => {\n    vi.clearAllMocks();\n    vi.useFakeTimers();\n\n    // Reset localStorage mock\n    mockLocalStorage.getItem.mockReturnValue(null);\n    mockLocalStorage.setItem.mockImplementation(() => {});\n    mockLocalStorage.removeItem.mockImplementation(() => {});\n    mockLocalStorage.clear.mockImplementation(() => {});\n\n    // Mock window and localStorage properly\n    Object.defineProperty(global, 'window', {\n      value: {\n        localStorage: mockLocalStorage,\n      },\n      writable: true,\n    });\n\n    // Also set global localStorage for direct access\n    Object.defineProperty(global, 'localStorage', {\n      value: mockLocalStorage,\n      writable: true,\n    });\n\n    // Create cache manager with persistence disabled for consistent testing\n    cacheManager = new I18nCacheManager({ enablePersistence: false });\n  });\n\n  afterEach(() => {\n    vi.useRealTimers();\n    vi.restoreAllMocks();\n  });\n\n  describe('initialization', () => {\n    it('should create cache manager with default config', () => {\n      expect(cacheManager).toBeDefined();\n      expect(cacheManager.getCacheStats().size).toBe(0);\n    });\n\n    it('should create cache manager with custom config', () => {\n      const customConfig = {\n        maxSize: 50,\n        ttl: 60000,\n        enablePersistence: false,\n      };\n\n      const customCacheManager = new I18nCacheManager(customConfig);\n      expect(customCacheManager).toBeDefined();\n    });\n\n    it('should initialize metrics with default values', () => {\n      const metrics = cacheManager.getMetrics();\n\n      expect(metrics.loadTime).toBe(0);\n      expect(metrics.cacheHitRate).toBe(0);\n      expect(metrics.errorRate).toBe(0);\n      expect(metrics.translationCoverage).toBe(0);\n      expect(metrics.localeUsage).toEqual({ en: 0, zh: 0 });\n    });\n  });\n\n  describe('message loading and caching', () => {\n    it('should load and cache English messages', async () => {\n      const messages = await cacheManager.getMessages('en');\n\n      // Verify the structure and some key properties from real messages\n      expect(messages).toBeDefined();\n      expect(messages.common).toBeDefined();\n      expect(messages.navigation).toBeDefined();\n      expect(messages.common.loading).toBe('Loading...');\n      expect(messages.common.error).toBe('An error occurred');\n      expect(messages.navigation.home).toBe('Home');\n\n      // Verify caching\n      const stats = cacheManager.getCacheStats();\n      expect(stats.size).toBe(1);\n    });\n\n    it('should load and cache Chinese messages', async () => {\n      const messages = await cacheManager.getMessages('zh');\n\n      // Verify the structure and some key properties from real messages\n      expect(messages).toBeDefined();\n      expect(messages.common).toBeDefined();\n      expect(messages.navigation).toBeDefined();\n      expect(messages.common.loading).toBe('加载中…');\n      expect(messages.common.error).toBe('发生错误');\n      expect(messages.navigation.home).toBe('首页');\n\n      // Verify caching\n      const stats = cacheManager.getCacheStats();\n      expect(stats.size).toBe(1);\n    });\n\n    it('should return cached messages on subsequent calls', async () => {\n      // First call - should load from source\n      const messages1 = await cacheManager.getMessages('en');\n      expect(messages1).toBeDefined();\n\n      // Second call - should return from cache\n      const messages2 = await cacheManager.getMessages('en');\n      expect(messages2).toBe(messages1); // Should be the same object reference\n\n      // Cache should still have only one entry\n      const stats = cacheManager.getCacheStats();\n      expect(stats.size).toBe(1);\n    });\n\n    it('should handle multiple locales independently', async () => {\n      const enMessages = await cacheManager.getMessages('en');\n      const zhMessages = await cacheManager.getMessages('zh');\n\n      expect(enMessages).toBeDefined();\n      expect(zhMessages).toBeDefined();\n      expect(enMessages).not.toBe(zhMessages);\n\n      // Should have two cache entries\n      const stats = cacheManager.getCacheStats();\n      expect(stats.size).toBe(2);\n\n      // Verify cache hit rate calculation\n      const metrics = cacheManager.getMetrics();\n      expect(metrics.cacheHitRate).toBeLessThan(1); // Should have at least one miss\n    });\n  });\n\n  describe('basic cache operations', () => {\n    it('should provide cache statistics', async () => {\n      await cacheManager.getMessages('en');\n      await cacheManager.getMessages('zh');\n\n      const stats = cacheManager.getCacheStats();\n      expect(stats.size).toBe(2);\n      expect(stats.maxSize).toBeGreaterThan(0);\n      expect(stats.hitRate).toBeGreaterThanOrEqual(0);\n      expect(stats.missRate).toBeGreaterThanOrEqual(0);\n    });\n\n    it('should clear cache when requested', async () => {\n      await cacheManager.getMessages('en');\n      await cacheManager.getMessages('zh');\n\n      expect(cacheManager.getCacheStats().size).toBe(2);\n\n      cacheManager.clearCache();\n\n      expect(cacheManager.getCacheStats().size).toBe(0);\n    });\n\n    it('should handle cache expiration with TTL', async () => {\n      const shortTtlManager = new I18nCacheManager({\n        ttl: 100, // 100ms TTL\n        enablePersistence: false,\n      });\n\n      await shortTtlManager.getMessages('en');\n      expect(shortTtlManager.getCacheStats().size).toBe(1);\n\n      // Fast-forward time beyond TTL\n      vi.advanceTimersByTime(150);\n\n      // Next access should reload from source\n      await shortTtlManager.getMessages('en');\n\n      const metrics = shortTtlManager.getMetrics();\n      expect(metrics.cacheHitRate).toBeLessThan(1);\n    });\n\n    it('should handle cache size limits with LRU eviction', async () => {\n      const smallCacheManager = new I18nCacheManager({ \n        maxSize: 1,\n        enablePersistence: false,\n      });\n\n      await smallCacheManager.getMessages('en');\n      expect(smallCacheManager.getCacheStats().size).toBe(1);\n\n      // Adding another locale should evict the first one\n      await smallCacheManager.getMessages('zh');\n      expect(smallCacheManager.getCacheStats().size).toBe(1);\n\n      // Verify that 'en' was evicted by checking if it needs to be reloaded\n      const stats = smallCacheManager.getCacheStats();\n      expect(stats.size).toBe(1);\n    });\n\n    it('should track performance metrics correctly', async () => {\n      const _startTime = Date.now();\n      \n      await cacheManager.getMessages('en');\n      await cacheManager.getMessages('zh');\n      await cacheManager.getMessages('en'); // Cache hit\n\n      const metrics = cacheManager.getMetrics();\n      \n      expect(metrics.loadTime).toBeGreaterThanOrEqual(0);\n      expect(metrics.cacheHitRate).toBeGreaterThan(0);\n      expect(metrics.errorRate).toBe(0);\n      expect(metrics.localeUsage.en).toBeGreaterThan(0);\n      expect(metrics.localeUsage.zh).toBeGreaterThan(0);\n    });\n\n    it('should reset metrics when requested', async () => {\n      await cacheManager.getMessages('en');\n      await cacheManager.getMessages('zh');\n\n      let metrics = cacheManager.getMetrics();\n      expect(metrics.localeUsage.en).toBeGreaterThan(0);\n      expect(metrics.localeUsage.zh).toBeGreaterThan(0);\n\n      cacheManager.resetMetrics();\n\n      metrics = cacheManager.getMetrics();\n      expect(metrics.loadTime).toBe(0);\n      expect(metrics.cacheHitRate).toBe(0);\n      expect(metrics.errorRate).toBe(0);\n      expect(metrics.translationCoverage).toBe(0);\n      expect(metrics.localeUsage).toEqual({ en: 0, zh: 0 });\n    });\n  });\n\n  describe('global instance', () => {\n    it('should provide global cache instance', () => {\n      expect(i18nCache).toBeDefined();\n      expect(i18nCache).toBeInstanceOf(I18nCacheManager);\n    });\n\n    it('should allow access to global cache methods', () => {\n      expect(() => {\n        i18nCache.getCacheStats();\n        i18nCache.getMetrics();\n      }).not.toThrow();\n    });\n\n    it('should maintain state across global instance calls', async () => {\n      await i18nCache.getMessages('en');\n      \n      const stats = i18nCache.getCacheStats();\n      expect(stats.size).toBeGreaterThan(0);\n      \n      const metrics = i18nCache.getMetrics();\n      expect(metrics.localeUsage.en).toBeGreaterThan(0);\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/i18n-cache-error-advanced.test.ts","messages":[{"ruleId":"no-loop-func","severity":2,"message":"Function declared in a loop contains unsafe references to variable(s) 'cacheManager'.","line":301,"column":20,"nodeType":"ArrowFunctionExpression","messageId":"unsafeRefs","endLine":301,"endColumn":56},{"ruleId":"no-loop-func","severity":2,"message":"Function declared in a loop contains unsafe references to variable(s) 'cacheManager'.","line":302,"column":20,"nodeType":"ArrowFunctionExpression","messageId":"unsafeRefs","endLine":302,"endColumn":56}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * I18n Cache Manager - Advanced Error Handling Tests\n *\n * 测试高级错误处理：\n * - 并发错误处理\n * - 内存和资源管理\n * - 压力测试\n */\n\nimport { afterEach, beforeEach, describe, expect, it, vi } from 'vitest';\nimport type { Locale } from '@/types/i18n';\nimport { I18nCacheManager } from '../i18n-cache';\n\n// Mock localStorage\nconst mockLocalStorage = {\n  getItem: vi.fn(),\n  setItem: vi.fn(),\n  removeItem: vi.fn(),\n  clear: vi.fn(),\n};\n\n// Mock constants\nvi.mock('@/constants/i18n-constants', () => ({\n  CACHE_DURATIONS: {\n    PERFORMANCE_CACHE: 300000, // 5 minutes\n  },\n  CACHE_LIMITS: {\n    MAX_CACHE_ENTRIES: 100,\n  },\n}));\n\ndescribe('I18nCacheManager - Advanced Error Handling', () => {\n  let cacheManager: I18nCacheManager;\n\n  beforeEach(() => {\n    vi.clearAllMocks();\n    vi.useFakeTimers();\n\n    // Reset localStorage mock\n    mockLocalStorage.getItem.mockReturnValue(null);\n    mockLocalStorage.setItem.mockImplementation(() => {});\n    mockLocalStorage.removeItem.mockImplementation(() => {});\n    mockLocalStorage.clear.mockImplementation(() => {});\n\n    // Mock window and localStorage properly\n    Object.defineProperty(global, 'window', {\n      value: {\n        localStorage: mockLocalStorage,\n      },\n      writable: true,\n    });\n\n    // Also set global localStorage for direct access\n    Object.defineProperty(global, 'localStorage', {\n      value: mockLocalStorage,\n      writable: true,\n    });\n\n    // Create cache manager with persistence disabled for consistent testing\n    cacheManager = new I18nCacheManager({ enablePersistence: false });\n  });\n\n  afterEach(() => {\n    vi.useRealTimers();\n    vi.restoreAllMocks();\n  });\n\n  describe('concurrent error handling', () => {\n    it('should handle concurrent failed requests', async () => {\n      const originalConsoleError = console.error;\n      console.error = vi.fn();\n\n      const promises = Array.from({ length: 5 }, () =>\n        cacheManager.getMessages('invalid' as Locale)\n      );\n\n      try {\n        const results = await Promise.all(promises);\n        expect(results.every((result) => result === null)).toBe(true);\n      } catch {\n        // Some promises may reject, which is acceptable\n      }\n\n      console.error = originalConsoleError;\n    });\n\n    it('should maintain cache integrity during errors', async () => {\n      // Load valid messages first\n      await cacheManager.getMessages('en');\n      expect(cacheManager.getCacheStats().size).toBe(1);\n\n      const originalConsoleError = console.error;\n      console.error = vi.fn();\n\n      // Try to load invalid messages\n      try {\n        await cacheManager.getMessages('invalid' as Locale);\n      } catch {\n        // Expected to fail\n      }\n\n      // Cache should still contain valid entries\n      expect(cacheManager.getCacheStats().size).toBe(1);\n\n      // Valid messages should still be accessible\n      const messages = await cacheManager.getMessages('en');\n      expect(messages).toBeDefined();\n\n      console.error = originalConsoleError;\n    });\n\n    it('should handle mixed success and failure scenarios', async () => {\n      const originalConsoleError = console.error;\n      console.error = vi.fn();\n\n      // Mix of valid and invalid requests\n      const promises = [\n        cacheManager.getMessages('en'),\n        cacheManager.getMessages('invalid' as Locale),\n        cacheManager.getMessages('zh'),\n        cacheManager.getMessages('another-invalid' as Locale),\n      ];\n\n      const results = await Promise.allSettled(promises);\n\n      // Should have some successes and some failures\n      const successes = results.filter(r => r.status === 'fulfilled');\n      const failures = results.filter(r => r.status === 'rejected');\n\n      expect(successes.length).toBeGreaterThan(0);\n      expect(failures.length).toBeGreaterThan(0);\n\n      console.error = originalConsoleError;\n    });\n\n    it('should handle rapid concurrent operations', async () => {\n      const operations = [];\n\n      // Create many concurrent operations\n      for (let i = 0; i < 20; i++) {\n        if (i % 3 === 0) {\n          operations.push(cacheManager.getMessages('en'));\n        } else if (i % 3 === 1) {\n          operations.push(cacheManager.getMessages('zh'));\n        } else {\n          operations.push(cacheManager.getMessages('invalid' as Locale));\n        }\n      }\n\n      const results = await Promise.allSettled(operations);\n      \n      // Should have a mix of successes and failures\n      const successes = results.filter(r => r.status === 'fulfilled');\n      expect(successes.length).toBeGreaterThan(0);\n      \n      // Cache should still be functional\n      const stats = cacheManager.getCacheStats();\n      expect(stats.size).toBeGreaterThan(0);\n    });\n  });\n\n  describe('memory and resource management', () => {\n    it('should handle memory pressure gracefully', async () => {\n      const largeCacheManager = new I18nCacheManager({\n        maxSize: 1000,\n        enablePersistence: false,\n      });\n\n      // Simulate memory pressure by creating many cache entries\n      const promises = Array.from({ length: 50 }, (_, i) =>\n        largeCacheManager.getMessages(i % 2 === 0 ? 'en' : 'zh')\n      );\n\n      await Promise.all(promises);\n\n      const stats = largeCacheManager.getCacheStats();\n      expect(stats.size).toBeLessThanOrEqual(2); // Should only cache valid locales\n    });\n\n    it('should clean up resources on cache clear', async () => {\n      await cacheManager.getMessages('en');\n      await cacheManager.getMessages('zh');\n\n      expect(cacheManager.getCacheStats().size).toBe(2);\n\n      cacheManager.clearCache();\n\n      expect(cacheManager.getCacheStats().size).toBe(0);\n      \n      // Metrics should be reset\n      const metrics = cacheManager.getMetrics();\n      expect(metrics.cacheHitRate).toBe(0);\n    });\n\n    it('should handle rapid cache operations', async () => {\n      const operations = [];\n\n      // Rapid fire operations\n      for (let i = 0; i < 20; i++) {\n        operations.push(cacheManager.getMessages('en'));\n        operations.push(cacheManager.clearCache());\n        operations.push(cacheManager.getMessages('zh'));\n        operations.push(cacheManager.resetMetrics());\n      }\n\n      // Should not throw errors\n      expect(async () => {\n        await Promise.all(operations);\n      }).not.toThrow();\n    });\n\n    it('should maintain consistency under stress', async () => {\n      const stressOperations = [];\n\n      // Mix of different operations\n      for (let i = 0; i < 100; i++) {\n        if (i % 10 === 0) {\n          stressOperations.push(cacheManager.clearCache());\n        } else if (i % 7 === 0) {\n          stressOperations.push(cacheManager.resetMetrics());\n        } else {\n          stressOperations.push(\n            cacheManager.getMessages(i % 2 === 0 ? 'en' : 'zh')\n          );\n        }\n      }\n\n      await Promise.allSettled(stressOperations);\n\n      // Cache should still be functional\n      const messages = await cacheManager.getMessages('en');\n      expect(messages).toBeDefined();\n\n      const stats = cacheManager.getCacheStats();\n      expect(stats).toBeDefined();\n      expect(typeof stats.size).toBe('number');\n    });\n\n    it('should handle resource cleanup during errors', async () => {\n      const originalConsoleError = console.error;\n      console.error = vi.fn();\n\n      // Load some valid data\n      await cacheManager.getMessages('en');\n      \n      // Try to cause errors while performing operations\n      const mixedOperations = [];\n      for (let i = 0; i < 10; i++) {\n        mixedOperations.push(cacheManager.getMessages('invalid' as Locale));\n        mixedOperations.push(cacheManager.clearCache());\n        mixedOperations.push(cacheManager.getMessages('en'));\n      }\n\n      await Promise.allSettled(mixedOperations);\n\n      // Should still be able to perform basic operations\n      const messages = await cacheManager.getMessages('en');\n      expect(messages).toBeDefined();\n\n      console.error = originalConsoleError;\n    });\n  });\n\n  describe('error propagation and isolation', () => {\n    it('should isolate errors between different cache instances', async () => {\n      const cacheManager1 = new I18nCacheManager({ enablePersistence: false });\n      const cacheManager2 = new I18nCacheManager({ enablePersistence: false });\n\n      // Load valid data in first instance\n      await cacheManager1.getMessages('en');\n      expect(cacheManager1.getCacheStats().size).toBe(1);\n\n      const originalConsoleError = console.error;\n      console.error = vi.fn();\n\n      // Cause error in second instance\n      try {\n        await cacheManager2.getMessages('invalid' as Locale);\n      } catch {\n        // Expected to fail\n      }\n\n      // First instance should be unaffected\n      const messages = await cacheManager1.getMessages('en');\n      expect(messages).toBeDefined();\n      expect(cacheManager1.getCacheStats().size).toBe(1);\n\n      console.error = originalConsoleError;\n    });\n\n    it('should handle error cascades gracefully', async () => {\n      const originalConsoleError = console.error;\n      console.error = vi.fn();\n\n      // Create a cascade of operations that might fail\n      const cascadeOperations = [];\n      \n      for (let i = 0; i < 5; i++) {\n        cascadeOperations.push(\n          cacheManager.getMessages('invalid' as Locale)\n            .catch(() => cacheManager.getMessages('en'))\n            .catch(() => cacheManager.getMessages('zh'))\n        );\n      }\n\n      const results = await Promise.allSettled(cascadeOperations);\n      \n      // At least some operations should succeed (fallback to valid locales)\n      const successes = results.filter(r => r.status === 'fulfilled');\n      expect(successes.length).toBeGreaterThan(0);\n\n      console.error = originalConsoleError;\n    });\n\n    it('should maintain error boundaries between operations', async () => {\n      const originalConsoleError = console.error;\n      console.error = vi.fn();\n\n      // Perform successful operation\n      await cacheManager.getMessages('en');\n      const initialStats = cacheManager.getCacheStats();\n      expect(initialStats.size).toBe(1);\n\n      // Perform failing operation\n      try {\n        await cacheManager.getMessages('invalid' as Locale);\n      } catch {\n        // Expected to fail\n      }\n\n      // Successful operation should still be accessible\n      const messages = await cacheManager.getMessages('en');\n      expect(messages).toBeDefined();\n\n      // Cache state should be preserved\n      const finalStats = cacheManager.getCacheStats();\n      expect(finalStats.size).toBe(1);\n\n      console.error = originalConsoleError;\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/i18n-cache-error-basic.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/i18n-cache-error-handling.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/i18n-cache.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/i18n-monitoring.test.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'_error' is defined but never used.","line":225,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":225,"endColumn":24},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_error' is defined but never used.","line":225,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":225,"endColumn":24},{"ruleId":"@next/next/no-assign-module-variable","severity":2,"message":"Do not assign to the variable `module`. See: https://nextjs.org/docs/messages/no-assign-module-variable","line":235,"column":7,"nodeType":"VariableDeclaration","endLine":235,"endColumn":57}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { beforeEach, describe, expect, it, vi } from 'vitest';\nimport { ErrorLevel, MonitoringEventType } from '../i18n-monitoring';\n\n// Mock constants\nvi.mock('@/constants/i18n-constants', () => ({\n  CACHE_LIMITS: { MAX_SIZE: 1000 },\n  MONITORING_CONFIG: {\n    ERROR_SAMPLE_RATE: 100,\n    PERFORMANCE_SAMPLE_RATE: 10,\n  },\n  PERFORMANCE_THRESHOLDS: {\n    TRANSLATION_LOAD_TIME: 1000,\n  },\n  REPORTING_THRESHOLDS: {\n    ERROR_RATE: 5,\n  },\n  TIME_UNITS: {\n    MINUTE: 60000,\n    HOUR: 3600000,\n  },\n}));\n\n// Mock types\nvi.mock('@/types/i18n', () => ({\n  // Mock type exports\n}));\n\n// Mock global objects\nconst mockFetch = vi.fn();\nconst mockConsole = {\n  error: vi.fn(),\n  warn: vi.fn(),\n  info: vi.fn(),\n  log: vi.fn(),\n};\n\nObject.defineProperty(global, 'fetch', {\n  value: mockFetch,\n  writable: true,\n});\n\nObject.defineProperty(global, 'console', {\n  value: mockConsole,\n  writable: true,\n});\n\nObject.defineProperty(global, 'navigator', {\n  value: { userAgent: 'Test Browser' },\n  writable: true,\n});\n\nObject.defineProperty(global, 'window', {\n  value: { location: { href: 'https://test.com' } },\n  writable: true,\n});\n\ndescribe('i18n-monitoring', () => {\n  beforeEach(() => {\n    vi.clearAllMocks();\n    mockFetch.mockResolvedValue({ ok: true });\n  });\n\n  describe('ErrorLevel enum', () => {\n    it('should define error levels', () => {\n      expect(ErrorLevel.INFO).toBe('info');\n      expect(ErrorLevel.WARNING).toBe('warning');\n      expect(ErrorLevel.ERROR).toBe('error');\n      expect(ErrorLevel.CRITICAL).toBe('critical');\n    });\n  });\n\n  describe('MonitoringEventType enum', () => {\n    it('should define monitoring event types', () => {\n      expect(MonitoringEventType.TRANSLATION_MISSING).toBe(\n        'translation_missing',\n      );\n      expect(MonitoringEventType.TRANSLATION_ERROR).toBe('translation_error');\n      expect(MonitoringEventType.LOCALE_SWITCH).toBe('locale_switch');\n      expect(MonitoringEventType.CACHE_MISS).toBe('cache_miss');\n      expect(MonitoringEventType.PERFORMANCE_ISSUE).toBe('performance_issue');\n      expect(MonitoringEventType.QUALITY_ISSUE).toBe('quality_issue');\n    });\n  });\n\n  describe('module imports', () => {\n    it('should import from constants', async () => {\n      const constants = await import('@/constants/i18n-constants');\n      expect(constants.MONITORING_CONFIG).toBeDefined();\n      expect(constants.PERFORMANCE_THRESHOLDS).toBeDefined();\n    });\n\n    it('should import from types', async () => {\n      // Test that types module can be imported\n      const types = await import('@/types/i18n');\n      expect(types).toBeDefined();\n    });\n  });\n\n  describe('EventCollector class', () => {\n    it('should be importable and instantiable', async () => {\n      // Since the class is not exported, we test the module structure\n      const monitoringModule = await import('../i18n-monitoring');\n      expect(monitoringModule.ErrorLevel).toBeDefined();\n      expect(monitoringModule.MonitoringEventType).toBeDefined();\n    });\n  });\n\n  describe('monitoring configuration', () => {\n    it('should handle monitoring config structure', () => {\n      const mockConfig = {\n        enabled: true,\n        enableConsoleLogging: true,\n        enableRemoteLogging: false,\n        enablePerformanceTracking: true,\n        enableQualityTracking: true,\n        performanceThresholds: {\n          translationLoadTime: 1000,\n          cacheHitRate: 90,\n          errorRate: 5,\n          memoryUsage: 100,\n        },\n        qualityThresholds: {\n          completeness: 95,\n          consistency: 90,\n          accuracy: 95,\n          freshness: 7,\n        },\n        maxEvents: 1000,\n        flushInterval: 30000,\n      };\n\n      expect(mockConfig.enabled).toBe(true);\n      expect(mockConfig.performanceThresholds.translationLoadTime).toBe(1000);\n      expect(mockConfig.qualityThresholds.completeness).toBe(95);\n    });\n  });\n\n  describe('monitoring event structure', () => {\n    it('should define monitoring event interface', () => {\n      const mockEvent = {\n        id: 'test-id',\n        type: MonitoringEventType.TRANSLATION_ERROR,\n        level: ErrorLevel.ERROR,\n        timestamp: Date.now(),\n        locale: 'en' as const,\n        message: 'Translation error occurred',\n        metadata: { key: 'test.key' },\n        stackTrace: 'Error stack trace',\n        userAgent: 'Test Browser',\n        url: 'https://test.com',\n      };\n\n      expect(mockEvent.type).toBe('translation_error');\n      expect(mockEvent.level).toBe('error');\n      expect(mockEvent.locale).toBe('en');\n      expect(mockEvent.message).toBe('Translation error occurred');\n    });\n  });\n\n  describe('performance thresholds', () => {\n    it('should define performance threshold structure', () => {\n      const mockThresholds = {\n        translationLoadTime: 1000,\n        cacheHitRate: 90,\n        errorRate: 5,\n        memoryUsage: 100,\n      };\n\n      expect(mockThresholds.translationLoadTime).toBe(1000);\n      expect(mockThresholds.cacheHitRate).toBe(90);\n      expect(mockThresholds.errorRate).toBe(5);\n      expect(mockThresholds.memoryUsage).toBe(100);\n    });\n  });\n\n  describe('quality thresholds', () => {\n    it('should define quality threshold structure', () => {\n      const mockThresholds = {\n        completeness: 95,\n        consistency: 90,\n        accuracy: 95,\n        freshness: 7,\n      };\n\n      expect(mockThresholds.completeness).toBe(95);\n      expect(mockThresholds.consistency).toBe(90);\n      expect(mockThresholds.accuracy).toBe(95);\n      expect(mockThresholds.freshness).toBe(7);\n    });\n  });\n\n  describe('browser environment handling', () => {\n    it('should handle navigator availability', () => {\n      expect(global.navigator.userAgent).toBe('Test Browser');\n    });\n\n    it('should handle window availability', () => {\n      expect(global.window.location.href).toBe('https://test.com');\n    });\n\n    it('should handle missing browser APIs gracefully', () => {\n      const originalNavigator = global.navigator;\n      delete (global as { navigator?: Navigator }).navigator;\n\n      // Should not throw when navigator is undefined\n      expect(() => {\n        const userAgent =\n          typeof navigator !== 'undefined' ? navigator.userAgent : 'unknown';\n        expect(userAgent).toBe('unknown');\n      }).not.toThrow();\n\n      // Restore navigator\n      global.navigator = originalNavigator;\n    });\n  });\n\n  describe('error handling', () => {\n    it('should handle fetch errors gracefully', async () => {\n      mockFetch.mockRejectedValueOnce(new Error('Network error'));\n\n      // Should not throw when fetch fails\n      expect(async () => {\n        try {\n          await fetch('/api/test');\n        } catch (_error) {\n          // Expected to catch error\n          // 忽略错误变量\n        }\n      }).not.toThrow();\n    });\n  });\n\n  describe('module structure', () => {\n    it('should export required enums', async () => {\n      const module = await import('../i18n-monitoring');\n\n      expect(module.ErrorLevel).toBeDefined();\n      expect(module.MonitoringEventType).toBeDefined();\n      expect(typeof module.ErrorLevel).toBe('object');\n      expect(typeof module.MonitoringEventType).toBe('object');\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/i18n-performance-cache.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/i18n-performance-monitor.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/i18n-performance.test.ts","messages":[{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":66,"column":16,"nodeType":"MemberExpression","endLine":66,"endColumn":35},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":108,"column":18,"nodeType":"MemberExpression","endLine":108,"endColumn":37}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * I18n Performance - Main Integration Tests\n *\n * 主要集成测试，包括：\n * - 核心函数导出验证\n * - 基本功能集成测试\n * - 真实使用场景测试\n *\n * 详细测试请参考：\n * - i18n-performance-cache.test.ts - 缓存功能测试\n * - i18n-performance-monitor.test.ts - 性能监控测试\n */\n\nimport { afterEach, beforeEach, describe, expect, it, vi } from 'vitest';\n// 导入需要测试的模块\nimport {\n  evaluatePerformance,\n  getCachedMessages,\n  getCachedTranslations,\n  I18nPerformanceMonitor,\n  preloadTranslations,\n  TranslationCache,\n} from '../i18n-performance';\n\n// 简化Mock数据 - 匹配测试期望\nconst mockEnTranslations = {\n  common: { hello: 'Hello' },\n  navigation: { home: 'Home' },\n};\n\nconst mockZhTranslations = {\n  common: { hello: '你好' },\n  navigation: { home: '首页' },\n};\n\n// Mock React cache\nvi.mock('react', () => ({\n  cache: (fn: (..._args: unknown[]) => unknown) => fn,\n}));\n\n// 使用vi.hoisted确保Mock函数在导入前定义\nconst { mockGetCachedMessages, mockGetCachedTranslations } = vi.hoisted(() => {\n  const hoistedMockGetCachedMessages = vi.fn();\n  const hoistedMockGetCachedTranslations = vi.fn();\n  return {\n    mockGetCachedMessages: hoistedMockGetCachedMessages,\n    mockGetCachedTranslations: hoistedMockGetCachedTranslations,\n  };\n});\n\n// Mock i18n-performance模块\nvi.mock('../i18n-performance', async (importOriginal) => {\n  const actual = await importOriginal<typeof import('../i18n-performance')>();\n\n  // 设置Mock实现\n  mockGetCachedMessages.mockImplementation(async (locale: string) => {\n    if (locale === 'en') return mockEnTranslations;\n    if (locale === 'zh') return mockZhTranslations;\n    return {};\n  });\n\n  mockGetCachedTranslations.mockImplementation(\n    async (locale: string, namespace?: string) => {\n      const messages = await mockGetCachedMessages(locale);\n      if (namespace) {\n        return messages[namespace] || {};\n      }\n      return messages;\n    },\n  );\n\n  return {\n    ...actual,\n    getCachedMessages: mockGetCachedMessages,\n    getCachedTranslations: mockGetCachedTranslations,\n  };\n});\n\ndescribe('I18n Performance - Main Integration Tests', () => {\n  beforeEach(() => {\n    vi.clearAllMocks();\n    vi.useFakeTimers();\n    // Reset singleton instance\n    (TranslationCache as { instance?: unknown }).instance = undefined;\n    I18nPerformanceMonitor.reset();\n\n    // 重新设置Mock实现\n    mockGetCachedMessages.mockImplementation(async (locale: string) => {\n      if (locale === 'en') return mockEnTranslations;\n      if (locale === 'zh') return mockZhTranslations;\n\n      // 对于无效的locale，模拟console.error调用并返回空对象\n      if (locale === 'invalid-locale') {\n        console.error(\n          `Failed to load messages for locale ${locale}:`,\n          new Error('Mock error'),\n        );\n        return {};\n      }\n\n      return {};\n    });\n\n    mockGetCachedTranslations.mockImplementation(\n      async (locale: string, namespace?: string) => {\n        const messages = await mockGetCachedMessages(locale);\n        if (namespace) {\n          return messages[namespace] || {};\n        }\n        return messages;\n      },\n    );\n  });\n\n  afterEach(() => {\n    vi.useRealTimers();\n  });\n\n  describe('核心函数导出验证', () => {\n    it('should export all required functions', () => {\n      expect(getCachedMessages).toBeDefined();\n      expect(getCachedTranslations).toBeDefined();\n      expect(preloadTranslations).toBeDefined();\n      expect(TranslationCache).toBeDefined();\n      expect(I18nPerformanceMonitor).toBeDefined();\n      expect(evaluatePerformance).toBeDefined();\n    });\n  });\n\n  describe('基本功能集成测试', () => {\n    it('should load and cache messages for locale', async () => {\n      const messages = await getCachedMessages('en');\n\n      expect(messages).toEqual({\n        common: { hello: 'Hello' },\n        navigation: { home: 'Home' },\n      });\n    });\n\n    it('should return cached messages on subsequent calls', async () => {\n      const messages1 = await getCachedMessages('en');\n      const messages2 = await getCachedMessages('en');\n\n      expect(messages1).toBe(messages2);\n    });\n\n    it('should get all translations for locale', async () => {\n      const translations = await getCachedTranslations('en');\n\n      expect(translations).toEqual({\n        common: { hello: 'Hello' },\n        navigation: { home: 'Home' },\n      });\n    });\n\n    it('should get specific namespace translations', async () => {\n      const translations = await getCachedTranslations('en', 'common');\n\n      expect(translations).toEqual({ hello: 'Hello' });\n    });\n\n    it('should preload translations for multiple locales', async () => {\n      await preloadTranslations(['en', 'zh']);\n\n      // Verify both locales are loaded by checking cache\n      const cache = TranslationCache.getInstance();\n      const enMessages = cache.get('messages-en');\n      const zhMessages = cache.get('messages-zh');\n\n      expect(enMessages).toBeDefined();\n      expect(zhMessages).toBeDefined();\n    });\n  });\n\n  describe('真实使用场景测试', () => {\n    it('should work with real-world usage pattern', async () => {\n      // Simulate loading translations\n      const _startTime = Date.now();\n      const messages = await getCachedMessages('en');\n      const loadTime = Date.now() - _startTime;\n\n      // Record performance metrics\n      I18nPerformanceMonitor.recordLoadTime(loadTime);\n      I18nPerformanceMonitor.recordCacheHit();\n\n      // Get performance evaluation\n      const metrics = I18nPerformanceMonitor.getMetrics();\n      const evaluation = evaluatePerformance(metrics);\n\n      expect(messages).toBeDefined();\n      expect(evaluation.grade).toMatch(/[A-F]/);\n    });\n\n    it('should handle cache warming scenario', async () => {\n      const locales = ['en', 'zh'];\n\n      // Preload translations\n      await preloadTranslations(locales);\n\n      // Verify all locales are cached\n      for (const locale of locales) {\n        const messages = await getCachedMessages(locale);\n        expect(messages).toBeDefined();\n      }\n    });\n\n    it('should handle error scenarios gracefully', async () => {\n      const consoleSpy = vi\n        .spyOn(console, 'error')\n        .mockImplementation(() => {});\n\n      const messages = await getCachedMessages('invalid-locale');\n\n      expect(messages).toEqual({});\n      expect(consoleSpy).toHaveBeenCalled();\n\n      consoleSpy.mockRestore();\n    });\n\n    it('should maintain performance under load', async () => {\n      const promises = [];\n\n      // Simulate concurrent requests\n      for (let i = 0; i < 50; i++) {\n        promises.push(getCachedMessages('en'));\n        promises.push(getCachedTranslations('zh', 'common'));\n      }\n\n      const results = await Promise.all(promises);\n\n      // All requests should succeed\n      expect(results).toHaveLength(100);\n      results.forEach((result) => {\n        expect(result).toBeDefined();\n      });\n    });\n\n    it('should integrate with performance monitoring', async () => {\n      // Load some translations and record metrics\n      await getCachedMessages('en');\n      I18nPerformanceMonitor.recordLoadTime(50);\n      I18nPerformanceMonitor.recordCacheHit();\n\n      await getCachedMessages('zh');\n      I18nPerformanceMonitor.recordLoadTime(75);\n      I18nPerformanceMonitor.recordCacheHit();\n\n      const metrics = I18nPerformanceMonitor.getMetrics();\n      expect(metrics.averageLoadTime).toBe(62.5);\n      expect(metrics.totalRequests).toBe(2);\n      expect(metrics.cacheHitRate).toBe(100);\n    });\n  });\n\n  describe('错误处理和边界情况', () => {\n    it('should handle empty locale array in preload', async () => {\n      await expect(preloadTranslations([])).resolves.toBeUndefined();\n    });\n\n    it('should return empty object for non-existent namespace', async () => {\n      const translations = await getCachedTranslations('en', 'non-existent');\n\n      expect(translations).toEqual({});\n    });\n\n    it('should handle missing locale gracefully', async () => {\n      const consoleSpy = vi\n        .spyOn(console, 'error')\n        .mockImplementation(() => {});\n\n      const messages = await getCachedMessages('invalid-locale');\n\n      expect(messages).toEqual({});\n      expect(consoleSpy).toHaveBeenCalledWith(\n        'Failed to load messages for locale invalid-locale:',\n        expect.any(Error),\n      );\n\n      consoleSpy.mockRestore();\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/i18n-validation-advanced-scenarios.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/i18n-validation-advanced.test.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'value' is defined but never used. Allowed unused args must match /^_/u.","line":213,"column":56,"nodeType":"Identifier","messageId":"unusedVar","endLine":213,"endColumn":61,"suggestions":[{"messageId":"removeVar","data":{"varName":"value"},"fix":{"range":[5576,5583],"text":""},"desc":"Remove unused variable 'value'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'value' is defined but never used. Allowed unused args must match /^_/u.","line":213,"column":56,"nodeType":null,"messageId":"unusedVar","endLine":213,"endColumn":61}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * I18n Validation - Advanced Tests Index\n *\n * 基本高级验证集成测试，包括：\n * - 核心高级验证功能测试\n * - 基本性能验证\n *\n * 详细测试请参考：\n * - i18n-validation-advanced-scenarios.test.ts - 高级验证场景测试\n * - i18n-validation-edge-cases.test.ts - 边界情况测试\n */\n\nimport { beforeEach, describe, expect, it, vi } from 'vitest';\nimport { validateTranslations } from '../i18n-validation';\nimport {\n  mockEnTranslations,\n  resetMockConfig,\n  setMockConfig,\n} from './mocks/translations';\n\n// Mock routing\nvi.mock('@/i18n/routing', () => ({\n  routing: {\n    locales: ['en', 'zh'],\n  },\n}));\n\ndescribe('I18n Validation - Advanced Tests Index', () => {\n  beforeEach(() => {\n    vi.clearAllMocks();\n    // 重置Mock配置为默认状态\n    resetMockConfig();\n  });\n\n  describe('Core Advanced Integration Tests', () => {\n    it('should handle complex nested structures', async () => {\n      // 设置复杂嵌套结构的翻译数据\n      setMockConfig({\n        en: {\n          ...mockEnTranslations,\n          complex: {\n            level1: {\n              level2: {\n                level3: {\n                  deepValue: 'Deep nested value',\n                },\n              },\n            },\n          },\n        },\n        zh: {\n          common: {\n            hello: '你好',\n            goodbye: '再见',\n            welcome: '欢迎来到{name}',\n          },\n          complex: {\n            level1: {\n              level2: {\n                level3: {\n                  deepValue: '深层嵌套值',\n                },\n              },\n            },\n          },\n        },\n      });\n\n      const result = await validateTranslations();\n\n      expect(result.isValid).toBe(true);\n      expect(result.errors).toHaveLength(0);\n      expect(result.coverage).toBeGreaterThan(0);\n    });\n\n    it('should validate complex parameter structures', async () => {\n      // 设置包含复杂参数的翻译数据\n      setMockConfig({\n        en: {\n          ...mockEnTranslations,\n          advanced: {\n            multipleParams: 'Hello {name}, you have {count} messages from {sender}',\n            nestedParams: 'Welcome to {location.city}, {location.country}',\n          },\n        },\n        zh: {\n          common: {\n            hello: '你好',\n            goodbye: '再见',\n            welcome: '欢迎来到{name}',\n          },\n          advanced: {\n            multipleParams: '你好{name}，你有{count}条来自{sender}的消息',\n            nestedParams: '欢迎来到{location.country}{location.city}',\n          },\n        },\n      });\n\n      const result = await validateTranslations();\n\n      expect(result.isValid).toBe(true);\n      expect(result.errors).toHaveLength(0);\n      expect(result.warnings).toHaveLength(0);\n    });\n\n    it('should detect parameter mismatches', async () => {\n      // 设置参数不匹配的翻译数据\n      setMockConfig({\n        en: {\n          ...mockEnTranslations,\n          advanced: {\n            multipleParams: 'Hello {name}, you have {count} messages from {sender}',\n          },\n        },\n        zh: {\n          common: {\n            hello: '你好',\n            goodbye: '再见',\n            welcome: '欢迎来到{name}',\n          },\n          advanced: {\n            multipleParams: '你好{name}，你有{count}条消息', // 缺少 {sender} 参数\n          },\n        },\n      });\n\n      const result = await validateTranslations();\n\n      expect(result.isValid).toBe(false);\n      expect(result.errors.length).toBeGreaterThan(0);\n      expect(result.errors.some(error => error.includes('sender'))).toBe(true);\n    });\n\n    it('should handle ICU message format', async () => {\n      // 设置包含ICU消息格式的翻译数据\n      setMockConfig({\n        en: {\n          ...mockEnTranslations,\n          icu: {\n            plural: '{count, plural, =0 {no items} =1 {one item} other {# items}}',\n            select: '{gender, select, male {He} female {She} other {They}} will arrive',\n          },\n        },\n        zh: {\n          common: {\n            hello: '你好',\n            goodbye: '再见',\n            welcome: '欢迎来到{name}',\n          },\n          icu: {\n            plural: '{count, plural, =0 {没有项目} =1 {一个项目} other {#个项目}}',\n            select: '{gender, select, male {他} female {她} other {他们}}将到达',\n          },\n        },\n      });\n\n      const result = await validateTranslations();\n\n      expect(result.isValid).toBe(true);\n      expect(result.errors).toHaveLength(0);\n      expect(result.warnings).toHaveLength(0);\n    });\n\n    it('should handle empty translation files', async () => {\n      // 设置空的翻译文件\n      setMockConfig({\n        en: {},\n        zh: {},\n      });\n\n      const result = await validateTranslations();\n\n      expect(result.isValid).toBe(true);\n      expect(result.errors).toHaveLength(0);\n      expect(result.coverage).toBe(0);\n    });\n\n    it('should handle missing locale files', async () => {\n      // 设置只有部分语言文件\n      setMockConfig({\n        en: mockEnTranslations,\n        // zh 文件缺失\n      });\n\n      const result = await validateTranslations();\n\n      expect(result.isValid).toBe(false);\n      expect(result.errors.length).toBeGreaterThan(0);\n      expect(result.errors.some(error => error.includes('zh'))).toBe(true);\n    });\n\n\n\n    it('should maintain performance with moderate datasets', async () => {\n      // 创建中等大小的数据集\n      const moderateDataset: Record<string, unknown> = {};\n      for (let i = 0; i < 100; i++) {\n        moderateDataset[`key_${i}`] = `Value ${i} with {param}`;\n      }\n\n      setMockConfig({\n        en: {\n          ...mockEnTranslations,\n          moderate: moderateDataset,\n        },\n        zh: {\n          common: {\n            hello: '你好',\n            goodbye: '再见',\n            welcome: '欢迎来到{name}',\n          },\n          moderate: Object.fromEntries(\n            Object.entries(moderateDataset).map(([key, value]) => [\n              key,\n              `值 ${key.split('_')[1]} 包含 {param}`,\n            ])\n          ),\n        },\n      });\n\n      const _startTime = Date.now();\n      const result = await validateTranslations();\n      const endTime = Date.now();\n\n      expect(result).toBeDefined();\n      expect(typeof result.coverage).toBe('number');\n      expect(endTime - _startTime).toBeLessThan(1000); // Should complete within 1 second\n    });\n\n    it('should handle mixed content types', async () => {\n      // 设置包含混合内容类型的翻译数据\n      setMockConfig({\n        en: {\n          ...mockEnTranslations,\n          mixed: {\n            stringValue: 'Simple string with {param}',\n            numberValue: 42,\n            booleanValue: true,\n            arrayValue: ['item1', 'item2'],\n            objectValue: {\n              nested: 'Nested string with {param}',\n              count: 10,\n            },\n          },\n        },\n        zh: {\n          common: {\n            hello: '你好',\n            goodbye: '再见',\n            welcome: '欢迎来到{name}',\n          },\n          mixed: {\n            stringValue: '包含{param}的简单字符串',\n            numberValue: 42,\n            booleanValue: true,\n            arrayValue: ['项目1', '项目2'],\n            objectValue: {\n              nested: '包含{param}的嵌套字符串',\n              count: 10,\n            },\n          },\n        },\n      });\n\n      const result = await validateTranslations();\n\n      expect(result.isValid).toBe(true);\n      expect(result.errors).toHaveLength(0);\n      expect(result.coverage).toBeGreaterThan(0);\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/i18n-validation-basic.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/i18n-validation-edge-cases.test.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'value' is defined but never used. Allowed unused args must match /^_/u.","line":336,"column":50,"nodeType":"Identifier","messageId":"unusedVar","endLine":336,"endColumn":55,"suggestions":[{"messageId":"removeVar","data":{"varName":"value"},"fix":{"range":[9028,9035],"text":""},"desc":"Remove unused variable 'value'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'value' is defined but never used. Allowed unused args must match /^_/u.","line":336,"column":50,"nodeType":null,"messageId":"unusedVar","endLine":336,"endColumn":55}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * I18n Validation - Edge Cases Tests\n *\n * 测试边界情况：\n * - 空翻译文件处理\n * - 异常数据结构处理\n * - 错误恢复测试\n */\n\nimport { beforeEach, describe, expect, it, vi } from 'vitest';\nimport { validateTranslations } from '../i18n-validation';\nimport {\n  mockEnTranslations,\n  resetMockConfig,\n  setMockConfig,\n} from './mocks/translations';\n\n// Mock routing\nvi.mock('@/i18n/routing', () => ({\n  routing: {\n    locales: ['en', 'zh'],\n  },\n}));\n\ndescribe('I18n Validation - Edge Cases Tests', () => {\n  beforeEach(() => {\n    vi.clearAllMocks();\n    // 重置Mock配置为默认状态\n    resetMockConfig();\n  });\n\n  describe('Edge cases', () => {\n    it('should handle empty translation files', async () => {\n      // 设置所有语言都为空对象\n      setMockConfig({\n        en: {},\n        zh: {},\n      });\n\n      const result = await validateTranslations();\n\n      expect(result.isValid).toBe(true);\n      expect(result.errors).toHaveLength(0);\n      expect(result.coverage).toBe(0);\n    });\n\n    it('should handle missing locale files', async () => {\n      // 设置只有部分语言文件\n      setMockConfig({\n        en: mockEnTranslations,\n        // zh 文件缺失\n      });\n\n      const result = await validateTranslations();\n\n      expect(result.isValid).toBe(false);\n      expect(result.errors.length).toBeGreaterThan(0);\n      expect(result.errors.some(error => error.includes('zh'))).toBe(true);\n    });\n\n    it('should handle malformed translation data', async () => {\n      // 设置格式错误的翻译数据\n      setMockConfig({\n        en: mockEnTranslations,\n        zh: 'invalid string instead of object' as unknown as Record<string, unknown>,\n      });\n\n      const result = await validateTranslations();\n\n      expect(result.isValid).toBe(false);\n      expect(result.errors.length).toBeGreaterThan(0);\n      expect(result.errors.some(error => \n        error.includes('malformed') || error.includes('invalid')\n      )).toBe(true);\n    });\n\n    it('should handle circular references', async () => {\n      // 创建包含循环引用的对象\n      const circularEn: Record<string, unknown> = {\n        ...mockEnTranslations,\n        circular: {},\n      };\n      circularEn.circular = circularEn; // 创建循环引用\n\n      const circularZh: Record<string, unknown> = {\n        common: {\n          hello: '你好',\n          goodbye: '再见',\n          welcome: '欢迎来到{name}',\n        },\n        circular: {},\n      };\n      circularZh.circular = circularZh; // 创建循环引用\n\n      setMockConfig({\n        en: circularEn,\n        zh: circularZh,\n      });\n\n      const result = await validateTranslations();\n\n      // 应该能够处理循环引用而不崩溃\n      expect(result).toBeDefined();\n      expect(typeof result.isValid).toBe('boolean');\n    });\n\n    it('should handle extremely deep nesting', async () => {\n      // 创建极深的嵌套结构\n      const createDeepNesting = (depth: number): Record<string, unknown> => {\n        if (depth === 0) return { value: 'deep value with {param}' };\n        return { [`level_${depth}`]: createDeepNesting(depth - 1) };\n      };\n\n      setMockConfig({\n        en: {\n          ...mockEnTranslations,\n          deep: createDeepNesting(50), // 50层深度\n        },\n        zh: {\n          common: {\n            hello: '你好',\n            goodbye: '再见',\n            welcome: '欢迎来到{name}',\n          },\n          deep: createDeepNesting(50), // 50层深度\n        },\n      });\n\n      const result = await validateTranslations();\n\n      expect(result).toBeDefined();\n      expect(typeof result.isValid).toBe('boolean');\n    });\n\n    it('should handle special characters and unicode', async () => {\n      // 设置包含特殊字符和Unicode的翻译数据\n      setMockConfig({\n        en: {\n          ...mockEnTranslations,\n          special: {\n            emoji: 'Hello 👋 {name}! Welcome to our app 🚀',\n            unicode: 'Special chars: àáâãäåæçèéêë {param} ñòóôõö',\n            symbols: 'Math: ∑∏∆∇∂∫ {value} ≤≥≠≈',\n            quotes: 'Quotes: \"double\" \\'single\\' `backtick` {text}',\n            newlines: 'Line 1\\nLine 2\\nLine 3 with {param}',\n            tabs: 'Tab\\tseparated\\tvalues with {data}',\n          },\n        },\n        zh: {\n          common: {\n            hello: '你好',\n            goodbye: '再见',\n            welcome: '欢迎来到{name}',\n          },\n          special: {\n            emoji: '你好 👋 {name}！欢迎使用我们的应用 🚀',\n            unicode: '特殊字符：中文测试 {param} 日本語テスト',\n            symbols: '数学：∑∏∆∇∂∫ {value} ≤≥≠≈',\n            quotes: '引号：\"双引号\" \\'单引号\\' `反引号` {text}',\n            newlines: '第一行\\n第二行\\n第三行包含 {param}',\n            tabs: '制表符\\t分隔\\t值包含 {data}',\n          },\n        },\n      });\n\n      const result = await validateTranslations();\n\n      expect(result.isValid).toBe(true);\n      expect(result.errors).toHaveLength(0);\n    });\n\n    it('should handle null and undefined values', async () => {\n      // 设置包含null和undefined值的翻译数据\n      setMockConfig({\n        en: {\n          ...mockEnTranslations,\n          nullish: {\n            nullValue: null,\n            undefinedValue: undefined,\n            emptyString: '',\n            zeroValue: 0,\n            falseValue: false,\n            validString: 'Valid string with {param}',\n          },\n        },\n        zh: {\n          common: {\n            hello: '你好',\n            goodbye: '再见',\n            welcome: '欢迎来到{name}',\n          },\n          nullish: {\n            nullValue: null,\n            undefinedValue: undefined,\n            emptyString: '',\n            zeroValue: 0,\n            falseValue: false,\n            validString: '包含{param}的有效字符串',\n          },\n        },\n      });\n\n      const result = await validateTranslations();\n\n      expect(result).toBeDefined();\n      expect(typeof result.isValid).toBe('boolean');\n    });\n\n    it('should handle very long translation strings', async () => {\n      // 创建非常长的翻译字符串\n      const longString = `${'A'.repeat(10000)  } with {param} at the end`;\n      const longStringZh = `${'中'.repeat(10000)  } 包含 {param} 在结尾`;\n\n      setMockConfig({\n        en: {\n          ...mockEnTranslations,\n          long: {\n            veryLongString: longString,\n          },\n        },\n        zh: {\n          common: {\n            hello: '你好',\n            goodbye: '再见',\n            welcome: '欢迎来到{name}',\n          },\n          long: {\n            veryLongString: longStringZh,\n          },\n        },\n      });\n\n      const result = await validateTranslations();\n\n      expect(result).toBeDefined();\n      expect(typeof result.isValid).toBe('boolean');\n    });\n\n    it('should handle mixed data types gracefully', async () => {\n      // 设置包含混合数据类型的翻译数据\n      setMockConfig({\n        en: {\n          ...mockEnTranslations,\n          mixed: {\n            string: 'String value with {param}',\n            number: 42,\n            boolean: true,\n            array: ['item1', 'item2', 'item3'],\n            object: {\n              nested: 'Nested string',\n              count: 5,\n            },\n            function: () => 'function result', // 函数类型\n            symbol: Symbol('test'), // Symbol类型\n            bigint: BigInt(123), // BigInt类型\n          },\n        },\n        zh: {\n          common: {\n            hello: '你好',\n            goodbye: '再见',\n            welcome: '欢迎来到{name}',\n          },\n          mixed: {\n            string: '包含{param}的字符串值',\n            number: 42,\n            boolean: true,\n            array: ['项目1', '项目2', '项目3'],\n            object: {\n              nested: '嵌套字符串',\n              count: 5,\n            },\n            function: () => '函数结果', // 函数类型\n            symbol: Symbol('测试'), // Symbol类型\n            bigint: BigInt(123), // BigInt类型\n          },\n        },\n      });\n\n      const result = await validateTranslations();\n\n      expect(result).toBeDefined();\n      expect(typeof result.isValid).toBe('boolean');\n    });\n\n    it('should handle concurrent validation calls', async () => {\n      // 设置正常的翻译数据\n      setMockConfig({\n        en: mockEnTranslations,\n        zh: {\n          common: {\n            hello: '你好',\n            goodbye: '再见',\n            welcome: '欢迎来到{name}',\n          },\n        },\n      });\n\n      // 并发调用验证函数\n      const promises = Array.from({ length: 10 }, () => validateTranslations());\n      const results = await Promise.all(promises);\n\n      // 所有结果应该一致\n      results.forEach(result => {\n        expect(result).toBeDefined();\n        expect(typeof result.isValid).toBe('boolean');\n        expect(result.isValid).toBe(results[0].isValid);\n      });\n    });\n\n    it('should handle memory pressure scenarios', async () => {\n      // 创建大量数据以测试内存压力\n      const largeData: Record<string, unknown> = {};\n      for (let i = 0; i < 5000; i++) {\n        largeData[`key_${i}`] = {\n          value: `Large value ${i} with {param}`,\n          nested: {\n            deep: `Deep value ${i}`,\n            array: Array.from({ length: 100 }, (_, j) => `item_${j}`),\n          },\n        };\n      }\n\n      setMockConfig({\n        en: {\n          ...mockEnTranslations,\n          large: largeData,\n        },\n        zh: {\n          common: {\n            hello: '你好',\n            goodbye: '再见',\n            welcome: '欢迎来到{name}',\n          },\n          large: Object.fromEntries(\n            Object.entries(largeData).map(([key, value]) => [\n              key,\n              {\n                value: `大值 ${key.split('_')[1]} 包含 {param}`,\n                nested: {\n                  deep: `深值 ${key.split('_')[1]}`,\n                  array: Array.from({ length: 100 }, (_, j) => `项目_${j}`),\n                },\n              },\n            ])\n          ),\n        },\n      });\n\n      const result = await validateTranslations();\n\n      expect(result).toBeDefined();\n      expect(typeof result.isValid).toBe('boolean');\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/i18n-validation.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/locale-detection-exports.test.ts","messages":[{"ruleId":"security/detect-object-injection","severity":2,"message":"Function Call Object Injection Sink","line":81,"column":14,"nodeType":"MemberExpression","endLine":81,"endColumn":63}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { describe, expect, it } from 'vitest';\n\ndescribe('locale-detection exports', () => {\n  it('should export all locale detection functionality', async () => {\n    // Test that the main export file works\n    const localeDetection = await import('@/lib/locale-detection');\n\n    // Verify that exports are available\n    expect(localeDetection).toBeDefined();\n    expect(typeof localeDetection).toBe('object');\n\n    // Check for key exports that should be available\n    expect(localeDetection).toHaveProperty('SmartLocaleDetector');\n    expect(localeDetection).toHaveProperty('SUPPORTED_LOCALES');\n    expect(localeDetection).toHaveProperty('DEFAULT_LOCALE');\n\n    // Verify SmartLocaleDetector is a constructor\n    expect(typeof localeDetection.SmartLocaleDetector).toBe('function');\n  });\n\n  it('should re-export locale constants', async () => {\n    const localeDetection = await import('@/lib/locale-detection');\n\n    // Test constants are exported\n    expect(localeDetection.SUPPORTED_LOCALES).toBeDefined();\n    expect(localeDetection.DEFAULT_LOCALE).toBeDefined();\n    expect(Array.isArray(localeDetection.SUPPORTED_LOCALES)).toBe(true);\n    expect(typeof localeDetection.DEFAULT_LOCALE).toBe('string');\n  });\n\n  it('should re-export locale detection types', async () => {\n    // This tests that the types module is properly exported\n    // We can't directly test TypeScript types at runtime, but we can test\n    // that the module doesn't throw when imported\n    expect(async () => {\n      await import('@/lib/locale-detection-types');\n    }).not.toThrow();\n  });\n\n  it('should re-export locale detection hooks', async () => {\n    // Test that hooks are exported\n    const hooks = await import('@/lib/locale-detection-hooks');\n    expect(hooks).toBeDefined();\n    expect(typeof hooks).toBe('object');\n  });\n\n  it('should re-export SmartLocaleDetector class', async () => {\n    const { SmartLocaleDetector } = await import('@/lib/locale-detection');\n\n    // Test that we can create an instance\n    expect(() => new SmartLocaleDetector()).not.toThrow();\n\n    // Test that instance has expected methods\n    const detector = new SmartLocaleDetector();\n    expect(typeof detector.detectFromBrowser).toBe('function');\n    expect(typeof detector.detectSmartLocale).toBe('function');\n  });\n\n  it('should handle module loading errors gracefully', async () => {\n    // Test that the main module can be imported without errors\n    let importError = null;\n\n    try {\n      await import('@/lib/locale-detection');\n    } catch (error) {\n      importError = error;\n    }\n\n    expect(importError).toBeNull();\n  });\n\n  it('should maintain consistent exports structure', async () => {\n    const localeDetection = await import('@/lib/locale-detection');\n\n    // Test that the export structure is consistent\n    const exportKeys = Object.keys(localeDetection);\n    expect(exportKeys.length).toBeGreaterThan(0);\n\n    // Verify no undefined exports\n    exportKeys.forEach((key) => {\n      expect((localeDetection as Record<string, unknown>)[key]).toBeDefined();\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/locale-detection-hooks.test.ts","messages":[{"ruleId":"no-undef","severity":2,"message":"'UnsafeLocaleCode' is not defined.","line":98,"column":22,"nodeType":"Identifier","messageId":"undef","endLine":98,"endColumn":38}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { beforeEach, describe, expect, it, vi } from 'vitest';\nimport { DEFAULT_LOCALE } from '../locale-constants';\nimport { useClientLocaleDetection } from '../locale-detection-hooks';\n\n// Mock配置 - 使用vi.hoisted确保Mock在模块导入前设置\nconst { mockLocaleStorageManager, mockNavigator } = vi.hoisted(() => ({\n  mockLocaleStorageManager: {\n    getUserOverride: vi.fn(),\n    saveUserPreference: vi.fn(),\n    getDetectionHistory: vi.fn(),\n    addDetectionRecord: vi.fn(),\n  },\n  mockNavigator: {\n    language: 'en-US',\n    languages: ['en-US', 'en'],\n  },\n}));\n\n// Mock外部依赖\nvi.mock('../locale-storage', () => ({\n  LocaleStorageManager: mockLocaleStorageManager,\n}));\n\n// Mock浏览器API\nObject.defineProperty(global, 'navigator', {\n  value: mockNavigator,\n  writable: true,\n});\n\n// 共享的useClientLocaleDetection测试设置\nconst setupClientLocaleDetectionTest = () => {\n  vi.clearAllMocks();\n\n  // Mock window.navigator\n  Object.defineProperty(window, 'navigator', {\n    value: {\n      language: 'en-US',\n      languages: ['en-US', 'en'],\n    },\n    writable: true,\n  });\n\n  // Mock localStorage\n  const mockLocalStorage = {\n    getItem: vi.fn(),\n    setItem: vi.fn(),\n    removeItem: vi.fn(),\n    clear: vi.fn(),\n  };\n  Object.defineProperty(window, 'localStorage', {\n    value: mockLocalStorage,\n    writable: true,\n  });\n\n  return mockLocalStorage;\n};\n\ndescribe('useClientLocaleDetection - User Override and Browser Detection', () => {\n  let detectClientLocale: () => { locale: string; details: Record<string, unknown> };\n\n  beforeEach(() => {\n    setupClientLocaleDetectionTest();\n\n    // 重置所有mock\n    mockLocaleStorageManager.getUserOverride.mockReturnValue(null);\n    mockLocaleStorageManager.saveUserPreference.mockReturnValue(undefined);\n    mockLocaleStorageManager.getDetectionHistory.mockReturnValue([]);\n    mockLocaleStorageManager.addDetectionRecord.mockReturnValue(undefined);\n\n    // 重置navigator mock\n    Object.defineProperty(global, 'navigator', {\n      value: {\n        language: 'en-US',\n        languages: ['en-US', 'en'],\n      },\n      writable: true,\n    });\n\n    // 获取hook函数\n    const hook = useClientLocaleDetection();\n    detectClientLocale = hook.detectClientLocale;\n  });\n\n  describe('用户覆盖检测', () => {\n    it('应该优先返回用户手动设置的语言', () => {\n      mockLocaleStorageManager.getUserOverride.mockReturnValue('zh');\n\n      const result = detectClientLocale();\n\n      expect(result.locale).toBe('zh');\n      expect(result.source).toBe('user');\n      expect(result.confidence).toBe(1.0);\n      expect(result.details.userOverride).toBe('zh');\n    });\n\n    it('应该忽略无效的用户设置语言', () => {\n      mockLocaleStorageManager.getUserOverride.mockReturnValue(\n        'invalid' as UnsafeLocaleCode,\n      );\n\n      const result = detectClientLocale();\n\n      expect(result.locale).not.toBe('invalid');\n      expect(result.source).not.toBe('user');\n    });\n  });\n\n  describe('浏览器语言检测', () => {\n    it('应该正确检测中文浏览器语言', () => {\n      mockLocaleStorageManager.getUserOverride.mockReturnValue(null);\n      Object.defineProperty(global, 'navigator', {\n        value: {\n          language: 'zh-CN',\n          languages: ['zh-CN', 'zh', 'en'],\n        },\n        writable: true,\n      });\n\n      const result = detectClientLocale();\n\n      expect(result.locale).toBe('zh');\n      expect(result.source).toBe('browser');\n      expect(result.confidence).toBeGreaterThan(0);\n    });\n\n    it('应该正确检测英文浏览器语言', () => {\n      mockLocaleStorageManager.getUserOverride.mockReturnValue(null);\n      Object.defineProperty(global, 'navigator', {\n        value: {\n          language: 'en-US',\n          languages: ['en-US', 'en'],\n        },\n        writable: true,\n      });\n\n      const result = detectClientLocale();\n\n      expect(result.locale).toBe('en');\n      expect(result.source).toBe('browser');\n      expect(result.confidence).toBeGreaterThan(0);\n    });\n\n    it('应该处理不支持的浏览器语言', () => {\n      mockLocaleStorageManager.getUserOverride.mockReturnValue(null);\n      Object.defineProperty(global, 'navigator', {\n        value: {\n          language: 'fr-FR',\n          languages: ['fr-FR', 'fr'],\n        },\n        writable: true,\n      });\n\n      const result = detectClientLocale();\n\n      expect(result.locale).toBe(DEFAULT_LOCALE);\n      expect(result.source).toBe('default');\n    });\n\n    it('应该处理空的浏览器语言列表', () => {\n      mockLocaleStorageManager.getUserOverride.mockReturnValue(null);\n      Object.defineProperty(global, 'navigator', {\n        value: {\n          language: '',\n          languages: [],\n        },\n        writable: true,\n      });\n\n      const result = detectClientLocale();\n\n      expect(result.locale).toBe(DEFAULT_LOCALE);\n      expect(result.source).toBe('default');\n    });\n\n    it('应该正确映射浏览器语言代码', () => {\n      mockLocaleStorageManager.getUserOverride.mockReturnValue(null);\n\n      const testCases = [\n        { input: ['zh-tw'], expected: 'zh' },\n        { input: ['zh-hk'], expected: 'zh' },\n        { input: ['en-gb'], expected: 'en' },\n        { input: ['en-ca'], expected: 'en' },\n      ];\n\n      testCases.forEach(({ input, expected }) => {\n        Object.defineProperty(global, 'navigator', {\n          value: {\n            language: input[0],\n            languages: input,\n          },\n          writable: true,\n        });\n\n        const result = detectClientLocale();\n        expect(result.locale).toBe(expected);\n      });\n    });\n  });\n});\n\ndescribe('useClientLocaleDetection - Navigator API and Security', () => {\n  let detectClientLocale: () => { locale: string; details: Record<string, unknown> };\n\n  beforeEach(() => {\n    setupClientLocaleDetectionTest();\n    detectClientLocale = useClientLocaleDetection();\n  });\n\n  describe('navigator API不可用的情况', () => {\n    it('应该处理navigator未定义的情况', () => {\n      mockLocaleStorageManager.getUserOverride.mockReturnValue(null);\n      Object.defineProperty(global, 'navigator', {\n        value: undefined,\n        writable: true,\n      });\n\n      const result = detectClientLocale();\n\n      expect(result.locale).toBe(DEFAULT_LOCALE);\n      expect(result.source).toBe('default');\n    });\n\n    it('应该处理navigator.languages未定义的情况', () => {\n      mockLocaleStorageManager.getUserOverride.mockReturnValue(null);\n      Object.defineProperty(global, 'navigator', {\n        value: {\n          language: 'zh-CN',\n          // languages 属性未定义\n        },\n        writable: true,\n      });\n\n      const result = detectClientLocale();\n\n      expect(result.locale).toBe('zh');\n      expect(result.source).toBe('browser');\n    });\n  });\n\n  describe('安全性测试', () => {\n    it('应该安全地处理对象注入攻击', () => {\n      mockLocaleStorageManager.getUserOverride.mockReturnValue(null);\n\n      // 尝试对象注入攻击\n      const maliciousLanguage = '__proto__';\n      Object.defineProperty(global, 'navigator', {\n        value: {\n          language: maliciousLanguage,\n          languages: [maliciousLanguage],\n        },\n        writable: true,\n      });\n\n      const result = detectClientLocale();\n\n      // 应该回退到默认语言，而不是被注入\n      expect(result.locale).toBe(DEFAULT_LOCALE);\n      expect(result.source).toBe('default');\n    });\n\n    it('应该安全地处理constructor注入', () => {\n      mockLocaleStorageManager.getUserOverride.mockReturnValue(null);\n\n      const maliciousLanguage = 'constructor';\n      Object.defineProperty(global, 'navigator', {\n        value: {\n          language: maliciousLanguage,\n          languages: [maliciousLanguage],\n        },\n        writable: true,\n      });\n\n      const result = detectClientLocale();\n\n      expect(result.locale).toBe(DEFAULT_LOCALE);\n      expect(result.source).toBe('default');\n    });\n  });\n});\n\ndescribe('useClientLocaleDetection - Confidence and Details', () => {\n  let detectClientLocale: () => { locale: string; details: Record<string, unknown> };\n\n  beforeEach(() => {\n    setupClientLocaleDetectionTest();\n    detectClientLocale = useClientLocaleDetection();\n  });\n\n  describe('置信度计算', () => {\n    it('用户覆盖应该有最高置信度', () => {\n      mockLocaleStorageManager.getUserOverride.mockReturnValue('zh');\n\n      const result = detectClientLocale();\n\n      expect(result.confidence).toBe(1.0);\n    });\n\n    it('浏览器检测应该有合理的置信度', () => {\n      mockLocaleStorageManager.getUserOverride.mockReturnValue(null);\n      Object.defineProperty(global, 'navigator', {\n        value: {\n          language: 'zh-CN',\n          languages: ['zh-CN', 'zh'],\n        },\n        writable: true,\n      });\n\n      const result = detectClientLocale();\n\n      expect(result.confidence).toBeGreaterThan(0.5);\n      expect(result.confidence).toBeLessThan(1.0);\n    });\n\n    it('默认回退应该有最低置信度', () => {\n      mockLocaleStorageManager.getUserOverride.mockReturnValue(null);\n      Object.defineProperty(global, 'navigator', {\n        value: {\n          language: 'unsupported',\n          languages: ['unsupported'],\n        },\n        writable: true,\n      });\n\n      const result = detectClientLocale();\n\n      expect(result.confidence).toBeLessThan(0.5);\n    });\n  });\n\n  describe('详细信息记录', () => {\n    it('应该记录用户覆盖详细信息', () => {\n      mockLocaleStorageManager.getUserOverride.mockReturnValue('zh');\n\n      const result = detectClientLocale();\n\n      expect(result.details).toHaveProperty('userOverride');\n      expect(result.details.userOverride).toBe('zh');\n    });\n\n    it('应该记录浏览器检测详细信息', () => {\n      mockLocaleStorageManager.getUserOverride.mockReturnValue(null);\n      Object.defineProperty(global, 'navigator', {\n        value: {\n          language: 'zh-CN',\n          languages: ['zh-CN', 'zh'],\n        },\n        writable: true,\n      });\n\n      const result = detectClientLocale();\n\n      expect(result.details).toHaveProperty('browserLocale');\n      expect(result.details.browserLocale).toBe('zh');\n    });\n\n    it('应该记录默认回退详细信息', () => {\n      mockLocaleStorageManager.getUserOverride.mockReturnValue(null);\n      Object.defineProperty(global, 'navigator', {\n        value: undefined,\n        writable: true,\n      });\n\n      const result = detectClientLocale();\n\n      expect(result.details).toHaveProperty('fallbackUsed');\n      expect(result.details.fallbackUsed).toBe(true);\n    });\n  });\n\n  describe('边界条件测试', () => {\n    it('应该处理null和undefined输入', () => {\n      mockLocaleStorageManager.getUserOverride.mockReturnValue(null);\n      Object.defineProperty(global, 'navigator', {\n        value: {\n          language: null,\n          languages: null,\n        },\n        writable: true,\n      });\n\n      expect(() => {\n        detectClientLocale();\n      }).not.toThrow();\n    });\n\n    it('应该处理空字符串语言代码', () => {\n      mockLocaleStorageManager.getUserOverride.mockReturnValue(null);\n      Object.defineProperty(global, 'navigator', {\n        value: {\n          language: '',\n          languages: [''],\n        },\n        writable: true,\n      });\n\n      const result = detectClientLocale();\n\n      expect(result.locale).toBe(DEFAULT_LOCALE);\n    });\n\n    it('应该处理格式错误的语言代码', () => {\n      mockLocaleStorageManager.getUserOverride.mockReturnValue(null);\n      Object.defineProperty(global, 'navigator', {\n        value: {\n          language: 'invalid-format-code',\n          languages: ['invalid-format-code'],\n        },\n        writable: true,\n      });\n\n      const result = detectClientLocale();\n\n      expect(result.locale).toBe(DEFAULT_LOCALE);\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/locale-detection.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/locale-detector.test.ts","messages":[{"ruleId":"no-undef","severity":2,"message":"'mockStorageManager' is not defined.","line":74,"column":3,"nodeType":"Identifier","messageId":"undef","endLine":74,"endColumn":21},{"ruleId":"no-undef","severity":2,"message":"'mockStorageManager' is not defined.","line":75,"column":3,"nodeType":"Identifier","messageId":"undef","endLine":75,"endColumn":21},{"ruleId":"no-undef","severity":2,"message":"'mockStorageManager' is not defined.","line":76,"column":3,"nodeType":"Identifier","messageId":"undef","endLine":76,"endColumn":21},{"ruleId":"no-undef","severity":2,"message":"'mockGeolocation' is not defined.","line":100,"column":12,"nodeType":"Identifier","messageId":"undef","endLine":100,"endColumn":27},{"ruleId":"no-undef","severity":2,"message":"'UnsafeLocaleCode' is not defined.","line":181,"column":22,"nodeType":"Identifier","messageId":"undef","endLine":181,"endColumn":38}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { beforeEach, describe, expect, it, vi } from 'vitest';\nimport { SmartLocaleDetector } from '../locale-detector';\n\n// Mock配置 - 使用vi.hoisted确保Mock在模块导入前设置\nconst { mockLocaleStorageManager, mockGeolocationAPI, mockNavigator } =\n  vi.hoisted(() => ({\n    mockLocaleStorageManager: {\n      getUserOverride: vi.fn(),\n      saveUserPreference: vi.fn(),\n      getDetectionHistory: vi.fn(),\n      addDetectionRecord: vi.fn(),\n    },\n    mockGeolocationAPI: {\n      getCurrentPosition: vi.fn(),\n    },\n    mockNavigator: {\n      language: 'en-US',\n      languages: ['en-US', 'en'],\n    },\n  }));\n\n// Mock外部依赖\nvi.mock('../locale-storage', () => ({\n  LocaleStorageManager: mockLocaleStorageManager,\n}));\n\n// Mock fetch API\nglobal.fetch = vi.fn().mockResolvedValue({\n  json: vi.fn().mockResolvedValue({\n    country: 'US',\n    country_code: 'US',\n  }),\n});\n\n// Mock浏览器API\nObject.defineProperty(global, 'navigator', {\n  value: {\n    ...mockNavigator,\n    geolocation: {\n      getCurrentPosition: vi\n        .fn()\n        .mockImplementation((success, _error, _options) => {\n          // 模拟成功的地理位置获取\n          setTimeout(() => {\n            success({\n              coords: {\n                latitude: 40.7128,\n                longitude: -74.006,\n              },\n            });\n          }, 10); // 快速响应，避免超时\n        }),\n    },\n  },\n  writable: true,\n});\n\nObject.defineProperty(global, 'Intl', {\n  value: {\n    DateTimeFormat: vi.fn().mockImplementation(() => ({\n      resolvedOptions: vi\n        .fn()\n        .mockReturnValue({ timeZone: 'America/New_York' }),\n    })),\n  },\n  writable: true,\n});\n\n// 共享的SmartLocaleDetector测试设置\nconst setupLocaleDetectorTest = () => {\n  vi.clearAllMocks();\n\n  // 重置所有mock\n  mockStorageManager.getUserPreference.mockReturnValue(null);\n  mockStorageManager.getDetectionHistory.mockReturnValue([]);\n  mockStorageManager.getUserOverride.mockReturnValue(null);\n\n  // 重置navigator mock\n  Object.defineProperty(navigator, 'language', {\n    writable: true,\n    value: 'en-US',\n  });\n\n  Object.defineProperty(navigator, 'languages', {\n    writable: true,\n    value: ['en-US', 'en'],\n  });\n\n  // 重置Intl.DateTimeFormat mock\n  vi.mocked(Intl.DateTimeFormat).mockImplementation(\n    () =>\n      ({\n        resolvedOptions: () => ({ timeZone: 'America/New_York' }),\n      }) as Intl.DateTimeFormat,\n  );\n\n  // 重置geolocation mock\n  Object.defineProperty(navigator, 'geolocation', {\n    writable: true,\n    value: mockGeolocation,\n  });\n\n  const detector = new SmartLocaleDetector();\n  return detector;\n};\n\nconst cleanupLocaleDetectorTest = () => {\n  vi.restoreAllMocks();\n};\n\ndescribe('SmartLocaleDetector - Initialization and Core Detection', () => {\n  let detector: SmartLocaleDetector;\n\n  beforeEach(() => {\n    detector = setupLocaleDetectorTest();\n\n    // 重置fetch mock\n    global.fetch = vi.fn().mockResolvedValue({\n      json: vi.fn().mockResolvedValue({\n        country: 'US',\n        country_code: 'US',\n      }),\n    });\n\n    // 重置navigator mock\n    Object.defineProperty(global, 'navigator', {\n      value: {\n        language: 'en-US',\n        languages: ['en-US', 'en'],\n        geolocation: {\n          getCurrentPosition: vi\n            .fn()\n            .mockImplementation((success, _error, _options) => {\n              setTimeout(() => {\n                success({\n                  coords: {\n                    latitude: 40.7128,\n                    longitude: -74.006,\n                  },\n                });\n              }, 10);\n            }),\n        },\n      },\n      writable: true,\n    });\n\n    // 重置默认Mock返回值\n    mockLocaleStorageManager.getUserOverride.mockReturnValue(null);\n    mockLocaleStorageManager.getDetectionHistory.mockReturnValue([]);\n  });\n\n  afterEach(() => {\n    cleanupLocaleDetectorTest();\n  });\n\n  describe('构造函数和初始化', () => {\n    it('应该正确初始化SmartLocaleDetector', () => {\n      expect(detector).toBeInstanceOf(SmartLocaleDetector);\n    });\n\n    it('应该有正确的默认配置', () => {\n      expect(detector).toBeDefined();\n    });\n  });\n\n  describe('detectSmartLocale', () => {\n    it('应该优先返回用户手动设置的语言', async () => {\n      mockLocaleStorageManager.getUserOverride.mockReturnValue('zh');\n\n      const result = await detector.detectSmartLocale();\n\n      expect(result.locale).toBe('zh');\n      expect(result.source).toBe('user');\n      expect(result.confidence).toBe(1.0);\n      expect(result.details).toEqual({ userOverride: 'zh' });\n    });\n\n    it('应该忽略无效的用户设置语言', async () => {\n      mockLocaleStorageManager.getUserOverride.mockReturnValue(\n        'invalid' as UnsafeLocaleCode,\n      );\n\n      // Mock detectFromGeolocation to return quickly\n      vi.spyOn(detector, 'detectFromGeolocation').mockResolvedValue('en');\n\n      const result = await detector.detectSmartLocale();\n\n      expect(result.locale).not.toBe('invalid');\n      expect(result.source).not.toBe('user');\n    }, 15000); // 增加超时时间\n\n    it('应该在没有用户设置时进行智能检测', async () => {\n      mockLocaleStorageManager.getUserOverride.mockReturnValue(null);\n\n      // Mock detectFromGeolocation to return quickly\n      vi.spyOn(detector, 'detectFromGeolocation').mockResolvedValue('en');\n\n      const result = await detector.detectSmartLocale();\n\n      expect(result).toBeDefined();\n      expect(result.locale).toBeDefined();\n      expect(result.source).toBeDefined();\n      expect(result.confidence).toBeGreaterThan(0);\n    }, 15000); // 增加超时时间\n  });\n});\n\ndescribe('SmartLocaleDetector - Browser and TimeZone Detection', () => {\n  let detector: SmartLocaleDetector;\n\n  beforeEach(() => {\n    detector = setupLocaleDetectorTest();\n  });\n\n  afterEach(() => {\n    cleanupLocaleDetectorTest();\n  });\n\n  describe('detectFromBrowser', () => {\n    it('应该正确检测浏览器语言偏好', () => {\n      // 重新设置navigator mock\n      Object.defineProperty(global, 'navigator', {\n        value: {\n          language: 'zh-CN',\n          languages: ['zh-CN', 'zh', 'en'],\n          geolocation: {\n            getCurrentPosition: vi\n              .fn()\n              .mockImplementation((success, _error, _options) => {\n                setTimeout(() => {\n                  success({\n                    coords: {\n                      latitude: 40.7128,\n                      longitude: -74.006,\n                    },\n                  });\n                }, 10);\n              }),\n          },\n        },\n        writable: true,\n      });\n\n      const result = detector.detectFromBrowser();\n\n      expect(result).toBe('zh');\n    });\n\n    it('应该处理不支持的浏览器语言', () => {\n      // 重新设置navigator mock为不支持的语言\n      Object.defineProperty(global, 'navigator', {\n        value: {\n          language: 'fr-FR',\n          languages: ['fr-FR', 'fr'],\n          geolocation: {\n            getCurrentPosition: vi\n              .fn()\n              .mockImplementation((success, _error, _options) => {\n                setTimeout(() => {\n                  success({\n                    coords: {\n                      latitude: 40.7128,\n                      longitude: -74.006,\n                    },\n                  });\n                }, 10);\n              }),\n          },\n        },\n        writable: true,\n      });\n\n      const result = detector.detectFromBrowser();\n\n      expect(result).toBe('en'); // 应该回退到默认语言\n    });\n\n    it('应该处理空的浏览器语言列表', () => {\n      // 重新设置navigator mock为空语言列表\n      Object.defineProperty(global, 'navigator', {\n        value: {\n          language: '',\n          languages: [],\n          geolocation: {\n            getCurrentPosition: vi\n              .fn()\n              .mockImplementation((success, _error, _options) => {\n                setTimeout(() => {\n                  success({\n                    coords: {\n                      latitude: 40.7128,\n                      longitude: -74.006,\n                    },\n                  });\n                }, 10);\n              }),\n          },\n        },\n        writable: true,\n      });\n\n      const result = detector.detectFromBrowser();\n\n      expect(result).toBe('en'); // 应该回退到默认语言\n    });\n\n    it('应该正确映射浏览器语言代码', () => {\n      // 重新设置navigator mock为英语\n      Object.defineProperty(global, 'navigator', {\n        value: {\n          language: 'en-US',\n          languages: ['en-US'],\n          geolocation: {\n            getCurrentPosition: vi\n              .fn()\n              .mockImplementation((success, _error, _options) => {\n                setTimeout(() => {\n                  success({\n                    coords: {\n                      latitude: 40.7128,\n                      longitude: -74.006,\n                    },\n                  });\n                }, 10);\n              }),\n          },\n        },\n        writable: true,\n      });\n\n      const result = detector.detectFromBrowser();\n\n      expect(result).toBe('en');\n    });\n  });\n\n  describe('detectFromTimeZone', () => {\n    it('应该根据时区检测语言', () => {\n      // Mock中国时区\n      Object.defineProperty(global, 'Intl', {\n        value: {\n          DateTimeFormat: vi.fn().mockImplementation(() => ({\n            resolvedOptions: vi\n              .fn()\n              .mockReturnValue({ timeZone: 'Asia/Shanghai' }),\n          })),\n        },\n        writable: true,\n      });\n\n      const result = detector.detectFromTimeZone();\n\n      expect(result).toBe('zh');\n    });\n\n    it('应该处理未知时区', () => {\n      Object.defineProperty(global, 'Intl', {\n        value: {\n          DateTimeFormat: vi.fn().mockImplementation(() => ({\n            resolvedOptions: vi\n              .fn()\n              .mockReturnValue({ timeZone: 'Unknown/Timezone' }),\n          })),\n        },\n        writable: true,\n      });\n\n      const result = detector.detectFromTimeZone();\n\n      expect(result).toBe('en'); // 应该回退到默认语言\n    });\n\n    it('应该处理Intl API不可用的情况', () => {\n      Object.defineProperty(global, 'Intl', {\n        value: undefined,\n        writable: true,\n      });\n\n      const result = detector.detectFromTimeZone();\n\n      expect(result).toBe('en'); // 应该回退到默认语言\n    });\n  });\n});\n\ndescribe('SmartLocaleDetector - Geolocation and Analysis', () => {\n  let detector: SmartLocaleDetector;\n\n  beforeEach(() => {\n    detector = setupLocaleDetectorTest();\n  });\n\n  afterEach(() => {\n    cleanupLocaleDetectorTest();\n  });\n\n  describe('detectFromGeolocation', () => {\n    it('应该处理地理位置检测成功', async () => {\n      const mockPosition = {\n        coords: {\n          latitude: 39.9042,\n          longitude: 116.4074, // 北京坐标\n        },\n      };\n\n      mockGeolocationAPI.getCurrentPosition.mockImplementation((success) => {\n        success(mockPosition);\n      });\n\n      // Mock geolocation API\n      Object.defineProperty(global, 'navigator', {\n        value: {\n          ...mockNavigator,\n          geolocation: mockGeolocationAPI,\n        },\n        writable: true,\n      });\n\n      const result = await detector.detectFromGeolocation();\n\n      expect(result).toBeDefined();\n    });\n\n    it('应该处理地理位置检测失败', async () => {\n      mockGeolocationAPI.getCurrentPosition.mockImplementation(\n        (_success, error) => {\n          error(new Error('Geolocation failed'));\n        },\n      );\n\n      Object.defineProperty(global, 'navigator', {\n        value: {\n          ...mockNavigator,\n          geolocation: mockGeolocationAPI,\n        },\n        writable: true,\n      });\n\n      const result = await detector.detectFromGeolocation();\n\n      expect(result).toBe('en'); // 应该回退到默认语言\n    });\n\n    it('应该处理地理位置API不可用', async () => {\n      Object.defineProperty(global, 'navigator', {\n        value: {\n          ...mockNavigator,\n          geolocation: undefined,\n        },\n        writable: true,\n      });\n\n      const result = await detector.detectFromGeolocation();\n\n      expect(result).toBe('en'); // 应该回退到默认语言\n    });\n\n    it('应该处理地理位置检测超时', async () => {\n      Object.defineProperty(global, 'navigator', {\n        value: {\n          ...mockNavigator,\n          geolocation: {\n            getCurrentPosition: vi\n              .fn()\n              .mockImplementation((_success, error, _options) => {\n                // 模拟超时，直接调用error回调\n                setTimeout(() => {\n                  error(new Error('Timeout'));\n                }, 10);\n              }),\n          },\n        },\n        writable: true,\n      });\n\n      const result = await detector.detectFromGeolocation();\n\n      expect(result).toBe('en'); // 应该回退到默认语言\n    }, 2000); // 增加超时时间\n  });\n\n  describe('analyzeDetectionConsistency', () => {\n    it('应该分析检测结果的一致性', () => {\n      // Detection results for test setup\n      const mockDetectionResults = [\n        { locale: 'zh', source: 'geo', weight: 0.8 },\n        { locale: 'zh', source: 'browser', weight: 0.7 },\n        { locale: 'en', source: 'timezone', weight: 0.6 },\n      ];\n\n      // 验证测试数据结构\n      expect(mockDetectionResults).toHaveLength(3);\n      expect(mockDetectionResults[0]).toHaveProperty('locale');\n\n      // 这个方法可能是私有的，我们测试其效果\n      const result = detector.detectFromBrowser();\n      expect(result).toBeDefined();\n    });\n  });\n});\n\ndescribe('SmartLocaleDetector - Error Handling and Performance', () => {\n  let detector: SmartLocaleDetector;\n\n  beforeEach(() => {\n    detector = setupLocaleDetectorTest();\n  });\n\n  afterEach(() => {\n    cleanupLocaleDetectorTest();\n  });\n\n  describe('错误处理', () => {\n    it('应该处理存储管理器错误', async () => {\n      mockLocaleStorageManager.getUserOverride.mockImplementation(() => {\n        throw new Error('Storage error');\n      });\n\n      // 应该抛出错误，因为没有适当的错误处理\n      await expect(detector.detectSmartLocale()).rejects.toThrow(\n        'Storage error',\n      );\n    });\n\n    it('应该处理检测过程中的异常', async () => {\n      // Mock一个会抛出异常的方法\n      vi.spyOn(detector, 'detectFromBrowser').mockImplementation(() => {\n        throw new Error('Detection error');\n      });\n\n      // Mock detectFromGeolocation to return quickly\n      vi.spyOn(detector, 'detectFromGeolocation').mockResolvedValue('en');\n\n      // 应该抛出错误，因为没有适当的错误处理\n      await expect(detector.detectSmartLocale()).rejects.toThrow();\n    }, 10000); // 增加超时时间\n  });\n\n  describe('性能测试', () => {\n    it('应该在合理时间内完成检测', async () => {\n      // Mock detectFromGeolocation to return quickly\n      vi.spyOn(detector, 'detectFromGeolocation').mockResolvedValue('en');\n\n      const _startTime = performance.now();\n\n      await detector.detectSmartLocale();\n\n      const endTime = performance.now();\n      const duration = endTime - _startTime;\n\n      // 检测应该在5000ms内完成（进一步放宽限制，适应测试环境）\n      expect(duration).toBeLessThan(5000);\n    }, 15000); // 设置更长的超时时间\n\n    it('应该缓存检测结果', async () => {\n      // Mock detectFromGeolocation to return quickly\n      vi.spyOn(detector, 'detectFromGeolocation').mockResolvedValue('en');\n\n      const result1 = await detector.detectSmartLocale();\n      const result2 = await detector.detectSmartLocale();\n\n      expect(result1).toEqual(result2);\n    }, 15000); // 设置更长的超时时间\n  });\n\n  describe('边界条件测试', () => {\n    it('应该处理null和undefined输入', () => {\n      expect(() => {\n        detector.detectFromBrowser();\n      }).not.toThrow();\n    });\n\n    it('应该处理空字符串语言代码', () => {\n      mockNavigator.language = '';\n\n      const result = detector.detectFromBrowser();\n\n      expect(result).toBe('en');\n    });\n\n    it('应该处理格式错误的语言代码', () => {\n      mockNavigator.language = 'invalid-format-code';\n\n      const result = detector.detectFromBrowser();\n\n      expect(result).toBe('en');\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/locale-storage.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/logger.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/metadata.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/mocks/airtable-env.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/mocks/airtable-validations.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/mocks/env.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/mocks/logger.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/mocks/translations.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/mocks/validations.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/navigation.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/performance-analytics.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/resend.test.ts","messages":[{"ruleId":"@next/next/no-assign-module-variable","severity":2,"message":"Do not assign to the variable `module`. See: https://nextjs.org/docs/messages/no-assign-module-variable","line":46,"column":3,"nodeType":"VariableDeclaration","endLine":46,"endColumn":44},{"ruleId":"@next/next/no-assign-module-variable","severity":2,"message":"Do not assign to the variable `module`. See: https://nextjs.org/docs/messages/no-assign-module-variable","line":94,"column":7,"nodeType":"VariableDeclaration","endLine":94,"endColumn":48}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { afterEach, beforeEach, describe, expect, it, vi } from 'vitest';\nimport type { ResendServicePrivate, DynamicImportModule } from '@/types/test-types';\n\n// Mock dependencies\nconst mockResendSend = vi.fn();\nconst mockResendInstance = {\n  emails: {\n    send: mockResendSend,\n  },\n};\nconst mockResend = vi.fn().mockImplementation(() => mockResendInstance);\n\nvi.mock('resend', () => ({\n  Resend: mockResend,\n}));\n\n// Use TypeScript Mock modules to bypass Vite's special handling\nvi.mock('@/../env.mjs', () => {\n  return {\n    env: {\n      RESEND_API_KEY: 'test-api-key',\n      EMAIL_FROM: 'test@tucsenberg.com',\n      EMAIL_REPLY_TO: 'contact@tucsenberg.com',\n      NODE_ENV: 'test',\n    },\n  };\n});\n\nvi.mock('./logger', async () => {\n  const mockLogger = await import('./mocks/logger');\n  return mockLogger;\n});\n\nvi.mock('./validations', async () => {\n  const mockValidations = await import('./mocks/validations');\n  return mockValidations;\n});\n\n// 共享的Resend测试设置\nconst setupResendTest = async () => {\n  // Clear mocks but preserve the mock functions\n  mockResendSend.mockReset();\n  mockResend.mockClear();\n\n  // Dynamic import to ensure mocks are applied\n  const module = await import('../resend');\n  const typedModule = module as DynamicImportModule;\n  const ResendService = typedModule.default || typedModule.ResendService;\n  return ResendService;\n};\n\nconst cleanupResendTest = () => {\n  vi.resetModules();\n};\n\ndescribe('resend - Service Initialization', () => {\n  let ResendService: typeof import('../resend');\n\n  beforeEach(async () => {\n    ResendService = await setupResendTest();\n  });\n\n  afterEach(() => {\n    cleanupResendTest();\n  });\n\n  describe('ResendService initialization', () => {\n    it('should initialize successfully with valid API key', async () => {\n      const service = new ResendService();\n      expect(service.isReady()).toBe(true);\n      expect(mockResend).toHaveBeenCalledWith('test-api-key');\n    });\n\n    it('should handle missing API key gracefully', async () => {\n      // Create a service instance and manually test the missing API key scenario\n      // Since we can'_t easily mock the environment after module load,\n      // we'll test the behavior by checking the service state\n      const service = new ResendService();\n\n      // The service should be created and ready with our test API key\n      expect(service).toBeDefined();\n      expect(typeof service.isReady).toBe('function');\n      // With our mock API key, the service should be ready\n      expect(service.isReady()).toBe(true);\n    });\n\n    it('should use default email configuration when env vars are missing', async () => {\n      // Mock environment with minimal configuration\n      vi.stubEnv('RESEND_API_KEY', 'test-api-key');\n      vi.stubEnv('EMAIL_FROM', '');\n      vi.stubEnv('EMAIL_REPLY_TO', '');\n      vi.resetModules();\n\n      const module = await import('../resend');\n      const typedModule = module as DynamicImportModule;\n      const ServiceClass = typedModule.default || typedModule.ResendService;\n      const service = new ServiceClass();\n\n      expect(service).toBeDefined();\n      expect(typeof service.sendContactFormEmail).toBe('function');\n      expect(typeof service.isReady).toBe('function');\n    });\n  });\n});\n\ndescribe('resend - Email Operations', () => {\n  let ResendService: typeof import('../resend');\n\n  beforeEach(async () => {\n    ResendService = await setupResendTest();\n  });\n\n  afterEach(() => {\n    cleanupResendTest();\n  });\n\n  describe('sendContactFormEmail', () => {\n    const validEmailData = {\n      firstName: 'John',\n      lastName: 'Doe',\n      email: 'john.doe@example.com',\n      company: 'Test Company',\n      message: 'This is a test message',\n      submittedAt: '2023-01-01T00:00:00Z',\n    };\n\n    it('should send contact form email successfully', async () => {\n      const service = new ResendService();\n\n      // Directly mock the service's resend instance\n      mockResendSend.mockClear();\n      mockResendSend.mockResolvedValue({\n        data: { id: 'test-message-id' },\n        error: null,\n      });\n\n      // Override the service's resend instance with our mock\n      (service as ResendServicePrivate).resend = mockResendInstance;\n\n      const result = await service.sendContactFormEmail(validEmailData);\n\n      expect(result).toBe('test-message-id');\n      expect(mockResendSend).toHaveBeenCalledWith(\n        expect.objectContaining({\n          from: 'test@tucsenberg.com',\n          to: ['contact@tucsenberg.com'],\n          replyTo: 'john.doe@example.com',\n          subject: expect.stringContaining('John Doe'),\n          html: expect.any(String),\n          text: expect.any(String),\n          tags: expect.arrayContaining([\n            { name: 'type', value: 'contact-form' },\n            { name: 'source', value: 'website' },\n          ]),\n        }),\n      );\n    });\n\n    it('should use custom subject when provided', async () => {\n      const service = new ResendService();\n      const dataWithSubject = { ...validEmailData, subject: 'Custom Subject' };\n\n      // Directly mock the service's resend instance\n      mockResendSend.mockClear();\n      mockResendSend.mockResolvedValue({\n        data: { id: 'test-message-id' },\n        error: null,\n      });\n\n      // Override the service's resend instance with our mock\n      (service as ResendServicePrivate).resend = mockResendInstance;\n\n      await service.sendContactFormEmail(dataWithSubject);\n\n      expect(mockResendSend).toHaveBeenCalledWith(\n        expect.objectContaining({\n          subject: 'Contact Form: Custom Subject',\n        }),\n      );\n    });\n\n    it('should throw error when service is not configured', async () => {\n      // Since we can'_t easily mock missing API key after module load,\n      // we'll test this by creating a service that fails due to other reasons\n      // and verify the error handling works correctly\n      const service = new ResendService();\n\n      // Mock the resend send to simulate service not configured scenario\n      mockResendSend.mockResolvedValue({\n        data: null,\n        error: { message: 'API key not configured' },\n      });\n\n      await expect(\n        service.sendContactFormEmail(validEmailData),\n      ).rejects.toThrow('Failed to send email');\n    });\n\n    it('should handle Resend API errors', async () => {\n      const service = new ResendService();\n      mockResendSend.mockResolvedValue({\n        data: null,\n        error: { message: 'API Error' },\n      });\n\n      await expect(\n        service.sendContactFormEmail(validEmailData),\n      ).rejects.toThrow('Failed to send email');\n    });\n\n    it('should handle network errors', async () => {\n      const service = new ResendService();\n      mockResendSend.mockRejectedValue(new Error('Network error'));\n\n      await expect(\n        service.sendContactFormEmail(validEmailData),\n      ).rejects.toThrow('Failed to send email');\n    });\n\n    it('should return unknown when message ID is not available', async () => {\n      const service = new ResendService();\n\n      // Directly mock the service's resend instance\n      mockResendSend.mockClear();\n      mockResendSend.mockResolvedValue({\n        data: null,\n        error: null,\n      });\n\n      // Override the service's resend instance with our mock\n      (service as ResendServicePrivate).resend = mockResendInstance;\n\n      const result = await service.sendContactFormEmail(validEmailData);\n      expect(result).toBe('unknown');\n    });\n  });\n});\n\ndescribe('resend - Confirmation and Validation', () => {\n  let ResendService: typeof import('../resend');\n\n  beforeEach(async () => {\n    ResendService = await setupResendTest();\n  });\n\n  afterEach(() => {\n    cleanupResendTest();\n  });\n\n  describe('sendConfirmationEmail', () => {\n    const validEmailData = {\n      firstName: 'John',\n      lastName: 'Doe',\n      email: 'john.doe@example.com',\n      company: 'Test Company',\n      message: 'This is a test message',\n      submittedAt: '2023-01-01T00:00:00Z',\n    };\n\n    it('should send confirmation email successfully', async () => {\n      const service = new ResendService();\n\n      // Directly mock the service's resend instance\n      mockResendSend.mockClear();\n      mockResendSend.mockResolvedValue({\n        data: { id: 'confirmation-message-id' },\n        error: null,\n      });\n\n      // Override the service's resend instance with our mock\n      (service as ResendServicePrivate).resend = mockResendInstance;\n\n      const result = await service.sendConfirmationEmail(validEmailData);\n\n      expect(result).toBe('confirmation-message-id');\n      expect(mockResendSend).toHaveBeenCalledWith(\n        expect.objectContaining({\n          from: 'test@tucsenberg.com',\n          to: ['john.doe@example.com'],\n          replyTo: 'contact@tucsenberg.com',\n          subject: 'Thank you for contacting us - Tucsenberg',\n          html: expect.any(String),\n          text: expect.any(String),\n          tags: expect.arrayContaining([\n            { name: 'type', value: 'confirmation' },\n          ]),\n        }),\n      );\n    });\n\n    it('should throw error when service is not configured', async () => {\n      // Test error handling by simulating API configuration error\n      const service = new ResendService();\n\n      // Mock the resend send to simulate service not configured scenario\n      mockResendSend.mockResolvedValue({\n        data: null,\n        error: { message: 'API key not configured' },\n      });\n\n      await expect(\n        service.sendConfirmationEmail(validEmailData),\n      ).rejects.toThrow('Failed to send confirmation email');\n    });\n\n    it('should handle confirmation email API errors', async () => {\n      const service = new ResendService();\n      mockResendSend.mockResolvedValue({\n        data: null,\n        error: { message: 'Confirmation API Error' },\n      });\n\n      await expect(\n        service.sendConfirmationEmail(validEmailData),\n      ).rejects.toThrow('Failed to send confirmation email');\n    });\n  });\n\n  describe('isReady', () => {\n    it('should return true when properly configured', () => {\n      const service = new ResendService();\n      expect(service.isReady()).toBe(true);\n    });\n\n    it('should return false when not configured', async () => {\n      // Since we can'_t easily mock missing API key after module load,\n      // we'll test that the service is ready with our test configuration\n      const service = new ResendService();\n\n      // With our mock API key, the service should be ready\n      expect(service.isReady()).toBe(true);\n    });\n  });\n\n  describe('Email content generation', () => {\n    it('should generate HTML and text content for contact emails', async () => {\n      const service = new ResendService();\n      const emailData = {\n        firstName: 'John',\n        lastName: 'Doe',\n        email: 'john@example.com',\n        company: 'Test Co',\n        message: 'Test message',\n        submittedAt: '2023-01-01T00:00:00Z',\n      };\n\n      // Directly mock the service's resend instance\n      mockResendSend.mockClear();\n      mockResendSend.mockResolvedValue({\n        data: { id: 'test-id' },\n        error: null,\n      });\n\n      // Override the service's resend instance with our mock\n      (service as ResendServicePrivate).resend = mockResendInstance;\n\n      await service.sendContactFormEmail(emailData);\n\n      const callArgs = mockResendSend.mock.calls[0]?.[0];\n      expect(callArgs.html).toBeDefined();\n      expect(callArgs.text).toBeDefined();\n      expect(typeof callArgs.html).toBe('string');\n      expect(typeof callArgs.text).toBe('string');\n    });\n\n    it('should generate HTML and text content for confirmation emails', async () => {\n      const service = new ResendService();\n      const emailData = {\n        firstName: 'John',\n        lastName: 'Doe',\n        email: 'john@example.com',\n        company: 'Test Co',\n        message: 'Test message',\n        submittedAt: '2023-01-01T00:00:00Z',\n      };\n\n      // Directly mock the service's resend instance\n      mockResendSend.mockClear();\n      mockResendSend.mockResolvedValue({\n        data: { id: 'test-id' },\n        error: null,\n      });\n\n      // Override the service's resend instance with our mock\n      (service as ResendServicePrivate).resend = mockResendInstance;\n\n      await service.sendConfirmationEmail(emailData);\n\n      const callArgs = mockResendSend.mock.calls[0]?.[0];\n      expect(callArgs.html).toBeDefined();\n      expect(callArgs.text).toBeDefined();\n      expect(typeof callArgs.html).toBe('string');\n      expect(typeof callArgs.text).toBe('string');\n    });\n  });\n\n  describe('Data validation and sanitization', () => {\n    it('should validate email data before sending', async () => {\n      const service = new ResendService();\n\n      // Directly mock the service's resend instance\n      mockResendSend.mockClear();\n      mockResendSend.mockResolvedValue({\n        data: { id: 'test-id' },\n        error: null,\n      });\n\n      // Override the service's resend instance with our mock\n      (service as ResendServicePrivate).resend = mockResendInstance;\n\n      const emailData = {\n        firstName: 'John',\n        lastName: 'Doe',\n        email: 'john@example.com',\n        company: 'Test Co',\n        message: 'Test message',\n        submittedAt: '2023-01-01T00:00:00Z',\n      };\n\n      // Test that the service successfully processes valid email data\n      // This implicitly tests that validation passes\n      const result = await service.sendContactFormEmail(emailData);\n\n      // Verify that the email was sent successfully (validation passed)\n      expect(result).toBe('test-id');\n      expect(mockResendSend).toHaveBeenCalledWith(\n        expect.objectContaining({\n          from: 'test@tucsenberg.com',\n          to: ['contact@tucsenberg.com'],\n          replyTo: 'john@example.com',\n        }),\n      );\n    });\n\n    it('should handle validation errors', async () => {\n      const service = new ResendService();\n      const { emailTemplateDataSchema } = await import('./mocks/validations');\n\n      // Use vi.mocked to properly mock the function\n      vi.mocked(emailTemplateDataSchema.parse).mockImplementation(() => {\n        throw new Error('Validation failed');\n      });\n\n      const emailData = {\n        firstName: 'John',\n        lastName: 'Doe',\n        email: 'invalid-email',\n        company: 'Test Co',\n        message: 'Test message',\n        submittedAt: '2023-01-01T00:00:00Z',\n      };\n\n      await expect(service.sendContactFormEmail(emailData)).rejects.toThrow(\n        'Failed to send email',\n      );\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/security.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/seo-metadata.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/site-config.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/structured-data.test.ts","messages":[{"ruleId":"max-lines-per-function","severity":1,"message":"Arrow function has too many lines (615). Maximum allowed is 600.","line":67,"column":40,"nodeType":"ArrowFunctionExpression","messageId":"exceed","endLine":800,"endColumn":2}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { afterEach, beforeEach, describe, expect, it, vi } from 'vitest';\n// Import after mocks\nimport {\n  generateArticleSchema,\n  generateBreadcrumbSchema,\n  generateFAQSchema,\n  generateJSONLD,\n  generateLocalBusinessSchema,\n  generateLocalizedStructuredData,\n  generateProductSchema,\n  generateStructuredData,\n} from '../structured-data';\n\n// 测试常量定义\nconst TEST_COUNTS = {\n  HOME_STRUCTURED_DATA: 2, // Organization + Website\n  BLOG_STRUCTURED_DATA: 3, // Organization + Website + Article\n  PRODUCTS_STRUCTURED_DATA: 3, // Organization + Website + Product\n  FALLBACK_STRUCTURED_DATA: 2, // Organization + Website (fallback)\n} as const;\n\n// Use vi.hoisted to ensure proper mock setup\nconst { mockGetTranslations, mockGenerateCanonicalURL, mockRecordError } =\n  vi.hoisted(() => ({\n    mockGetTranslations: vi.fn(),\n    mockGenerateCanonicalURL: vi.fn(),\n    mockRecordError: vi.fn(),\n  }));\n\nvi.mock('next-intl/server', () => ({\n  getTranslations: mockGetTranslations,\n}));\n\nvi.mock('@/services/url-generator', () => ({\n  generateCanonicalURL: mockGenerateCanonicalURL,\n}));\n\nvi.mock('@/lib/i18n-performance', () => ({\n  I18nPerformanceMonitor: {\n    getInstance: () => ({\n      trackTranslationUsage: vi.fn(),\n    }),\n    recordError: mockRecordError,\n  },\n}));\n\nvi.mock('@/i18n/routing', () => ({\n  routing: {\n    locales: ['en', 'zh'],\n    defaultLocale: 'en',\n  },\n}));\n\nvi.mock('@/config/paths', () => ({\n  SITE_CONFIG: {\n    name: 'Tucsenberg',\n    description: 'Modern Enterprise Platform',\n    baseUrl: 'https://tucsenberg.com',\n    author: 'Tucsenberg Team',\n    social: {\n      twitter: '@tucsenberg',\n      linkedin: 'company/tucsenberg',\n    },\n  },\n}));\n\ndescribe('Structured Data Generation', () => {\n  beforeEach(() => {\n    vi.clearAllMocks();\n\n    // Mock translation function\n    const mockT = vi.fn((key: string, options?: { defaultValue?: string }) => {\n      const translations: Record<string, string> = {\n        'organization.name': 'Tucsenberg',\n        'organization.description': 'Modern Enterprise Platform',\n        'website.name': 'Tucsenberg',\n        'website.description': 'Enterprise Solutions',\n        'breadcrumb.home': 'Home',\n        'breadcrumb.about': 'About',\n        'breadcrumb.contact': 'Contact',\n        'article.author': 'Tucsenberg Team',\n        'product.brand': 'Tucsenberg',\n        'faq.question1': 'What is Tucsenberg?',\n        'faq.answer1': 'A modern enterprise platform',\n        'business.name': 'Tucsenberg Inc.',\n        'business.address': '123 Business St, City, Country',\n        'business.phone': '+1-234-567-8900',\n      };\n      const safeTranslations = new Map(Object.entries(translations));\n      return safeTranslations.get(key) || options?.defaultValue || key;\n    });\n\n    mockGetTranslations.mockResolvedValue(mockT);\n    mockGenerateCanonicalURL.mockReturnValue('https://tucsenberg.com/test');\n  });\n\n  afterEach(() => {\n    vi.restoreAllMocks();\n  });\n\n  describe('generateLocalizedStructuredData - Organization', () => {\n    it('should generate valid organization schema', async () => {\n      const schema = await generateLocalizedStructuredData(\n        'en',\n        'Organization',\n        {},\n      );\n\n      expect(schema).toEqual({\n        '@context': 'https://schema.org',\n        '@type': 'Organization',\n        'name': 'Tucsenberg',\n        'description': 'Modern Enterprise Platform',\n        'url': 'https://tucsenberg.com',\n        'logo': 'https://tucsenberg.com/logo.png',\n        'contactPoint': {\n          '@type': 'ContactPoint',\n          'telephone': '+1-555-0123',\n          'contactType': 'customer service',\n          'availableLanguage': ['en', 'zh'],\n        },\n        'sameAs': [\n          'https://twitter.com/tucsenberg',\n          'https://linkedin.com/company/tucsenberg',\n          'https://github.com/tucsenberg',\n        ],\n      });\n    });\n\n    it('should handle different locales', async () => {\n      await generateLocalizedStructuredData('zh', 'Organization', {});\n\n      expect(mockGetTranslations).toHaveBeenCalledWith({\n        locale: 'zh',\n        namespace: 'structured-data',\n      });\n    });\n  });\n\n  describe('generateLocalizedStructuredData - WebSite', () => {\n    it('should generate valid website schema', async () => {\n      const schema = await generateLocalizedStructuredData('en', 'WebSite', {});\n\n      expect(schema).toEqual({\n        '@context': 'https://schema.org',\n        '@type': 'WebSite',\n        'name': 'Tucsenberg',\n        'description': 'Enterprise Solutions',\n        'url': 'https://tucsenberg.com',\n        'potentialAction': {\n          '@type': 'SearchAction',\n          'target': 'https://tucsenberg.com/search?q={search_term_string}',\n          'query-input': 'required name=search_term_string',\n        },\n        'inLanguage': ['en', 'zh'],\n      });\n    });\n  });\n\n  describe('generateBreadcrumbSchema', () => {\n    it('should generate breadcrumb schema for nested pages', async () => {\n      const breadcrumbs = [\n        { name: 'Home', url: 'https://tucsenberg.com/' },\n        { name: 'About', url: 'https://tucsenberg.com/about' },\n        { name: 'Contact', url: 'https://tucsenberg.com/contact' },\n      ];\n\n      const schema = await generateBreadcrumbSchema(breadcrumbs, 'en');\n\n      expect(schema).toEqual({\n        '@context': 'https://schema.org',\n        '@type': 'BreadcrumbList',\n        'itemListElement': [\n          {\n            '@type': 'ListItem',\n            'position': 1,\n            'name': 'Home',\n            'item': 'https://tucsenberg.com/',\n          },\n          {\n            '@type': 'ListItem',\n            'position': 2,\n            'name': 'About',\n            'item': 'https://tucsenberg.com/about',\n          },\n          {\n            '@type': 'ListItem',\n            'position': 3,\n            'name': 'Contact',\n            'item': 'https://tucsenberg.com/contact',\n          },\n        ],\n      });\n    });\n\n    it('should handle empty breadcrumbs', async () => {\n      const schema = await generateBreadcrumbSchema([], 'en');\n\n      expect(schema.itemListElement).toEqual([]);\n    });\n  });\n\n  describe('generateArticleSchema', () => {\n    it('should generate valid article schema', async () => {\n      const articleData = {\n        title: 'Test Article',\n        description: 'Test Description',\n        author: 'John Doe',\n        publishedTime: '2023-01-01T00:00:00Z',\n        modifiedTime: '2023-01-02T00:00:00Z',\n        image: '/test-image.jpg',\n        section: 'Technology',\n      };\n\n      const schema = await generateArticleSchema(articleData, 'en');\n\n      expect(schema).toEqual({\n        '@context': 'https://schema.org',\n        '@type': 'Article',\n        'headline': 'Test Article',\n        'description': 'Test Description',\n        'author': {\n          '@type': 'Person',\n          'name': 'John Doe',\n        },\n        'publisher': {\n          '@type': 'Organization',\n          'name': 'Tucsenberg',\n          'logo': {\n            '@type': 'ImageObject',\n            'url': 'https://tucsenberg.com/logo.png',\n          },\n        },\n        'datePublished': '2023-01-01T00:00:00Z',\n        'dateModified': '2023-01-02T00:00:00Z',\n        'image': {\n          '@type': 'ImageObject',\n          'url': '/test-image.jpg',\n        },\n        'section': 'Technology',\n        'inLanguage': 'en',\n        'mainEntityOfPage': {\n          '@type': 'WebPage',\n          '@id': 'https://tucsenberg.com/test',\n        },\n      });\n    });\n\n    it('should handle missing optional fields', async () => {\n      const articleData = {\n        title: 'Test Article',\n        description: 'Test Description',\n      };\n\n      const schema = await generateArticleSchema(articleData, 'en');\n\n      expect(schema.author).toEqual({\n        '@type': 'Person',\n        'name': 'Tucsenberg Team',\n      });\n      expect(schema.datePublished).toBeDefined();\n      expect(schema.dateModified).toBeDefined();\n    });\n  });\n\n  describe('generateProductSchema', () => {\n    it('should generate valid product schema', async () => {\n      const productData = {\n        name: 'Enterprise Solution',\n        description: 'Advanced business platform',\n        image: '/product-image.jpg',\n        price: '999.00',\n        currency: 'USD',\n        availability: 'InStock' as const,\n        brand: 'Tucsenberg',\n        sku: 'ENT-001',\n      };\n\n      const schema = await generateProductSchema(productData, 'en');\n\n      expect(schema).toEqual({\n        '@context': 'https://schema.org',\n        '@type': 'Product',\n        'name': 'Enterprise Solution',\n        'description': 'Advanced business platform',\n        'image': ['/product-image.jpg'],\n        'manufacturer': {\n          '@type': 'Organization',\n          'name': 'Tucsenberg',\n        },\n        'brand': {\n          '@type': 'Brand',\n          'name': 'Tucsenberg',\n        },\n        'sku': 'ENT-001',\n        'offers': {\n          '@type': 'Offer',\n          'price': 999,\n          'priceCurrency': 'USD',\n          'availability': 'InStock',\n        },\n      });\n    });\n\n    it('should generate product schema without offers when no price provided', async () => {\n      const productData = {\n        name: 'Free Tool',\n        description: 'Open source utility',\n        image: '/tool-image.jpg',\n        brand: 'Tucsenberg',\n        sku: 'FREE-001',\n        // No price provided\n      };\n\n      const schema = await generateProductSchema(productData, 'en');\n\n      expect(schema).toEqual({\n        '@context': 'https://schema.org',\n        '@type': 'Product',\n        'name': 'Free Tool',\n        'description': 'Open source utility',\n        'image': ['/tool-image.jpg'],\n        'manufacturer': {\n          '@type': 'Organization',\n          'name': 'Tucsenberg',\n        },\n        'brand': {\n          '@type': 'Brand',\n          'name': 'Tucsenberg',\n        },\n        'sku': 'FREE-001',\n        'offers': undefined, // This should cover the undefined case on line 170\n      });\n    });\n  });\n\n  describe('generateFAQSchema', () => {\n    it('should generate valid FAQ schema', async () => {\n      const faqData = [\n        {\n          question: 'What is Tucsenberg?',\n          answer: 'A modern enterprise platform',\n        },\n        {\n          question: 'How does it work?',\n          answer: 'Through advanced technology',\n        },\n      ];\n\n      const schema = await generateFAQSchema(faqData, 'en');\n\n      expect(schema).toEqual({\n        '@context': 'https://schema.org',\n        '@type': 'FAQPage',\n        'mainEntity': [\n          {\n            '@type': 'Question',\n            'name': 'What is Tucsenberg?',\n            'acceptedAnswer': {\n              '@type': 'Answer',\n              'text': 'A modern enterprise platform',\n            },\n          },\n          {\n            '@type': 'Question',\n            'name': 'How does it work?',\n            'acceptedAnswer': {\n              '@type': 'Answer',\n              'text': 'Through advanced technology',\n            },\n          },\n        ],\n      });\n    });\n  });\n\n  describe('generateLocalBusinessSchema', () => {\n    it('should generate valid local business schema', async () => {\n      const businessData = {\n        name: 'Tucsenberg Office',\n        address: '123 Business St, City, Country',\n        phone: '+1-234-567-8900',\n        email: 'contact@tucsenberg.com',\n        openingHours: ['Mo-Fr 09:00-17:00'],\n        priceRange: '$$$',\n      };\n\n      const schema = await generateLocalBusinessSchema(businessData, 'en');\n\n      expect(schema).toEqual({\n        '@context': 'https://schema.org',\n        '@type': 'LocalBusiness',\n        'name': 'Tucsenberg Office',\n        'address': {\n          '@type': 'PostalAddress',\n          'streetAddress': '123 Business St, City, Country',\n        },\n        'telephone': '+1-234-567-8900',\n        'email': 'contact@tucsenberg.com',\n        'openingHours': ['Mo-Fr 09:00-17:00'],\n        'priceRange': '$$$',\n        'url': 'https://tucsenberg.com',\n      });\n    });\n  });\n\n  describe('generateStructuredData', () => {\n    it('should generate structured data for home page', async () => {\n      const data = await generateStructuredData('home', 'en');\n\n      expect(data).toHaveLength(TEST_COUNTS.HOME_STRUCTURED_DATA); // Organization + Website\n      expect(data[0]['@type']).toBe('Organization');\n      expect(data[1]['@type']).toBe('WebSite');\n    });\n\n    it('should generate structured data for blog page', async () => {\n      const articleData = {\n        title: 'Blog Post',\n        description: 'Blog Description',\n      };\n\n      const data = await generateStructuredData('blog', 'en', {\n        article: articleData,\n      });\n\n      expect(data).toHaveLength(TEST_COUNTS.BLOG_STRUCTURED_DATA); // Organization + Website + Article\n      expect(data[2]['@type']).toBe('Article');\n    });\n\n    it('should generate structured data for products page', async () => {\n      const productData = {\n        name: 'Product',\n        description: 'Product Description',\n        price: '100.00',\n        currency: 'USD',\n        availability: 'InStock' as const,\n      };\n\n      const data = await generateStructuredData('products', 'en', {\n        product: productData,\n      });\n\n      expect(data).toHaveLength(TEST_COUNTS.PRODUCTS_STRUCTURED_DATA); // Organization + Website + Product\n      expect(data[2]['@type']).toBe('Product');\n    });\n\n    it('should handle unknown page types', async () => {\n      const data = await generateStructuredData('home', 'en');\n\n      expect(data).toHaveLength(TEST_COUNTS.FALLBACK_STRUCTURED_DATA); // Organization + Website (fallback)\n    });\n  });\n\n  describe('错误处理和边缘情况', () => {\n    it('should handle translation errors gracefully', async () => {\n      // Mock getTranslations to throw an error\n      mockGetTranslations.mockRejectedValueOnce(new Error('Translation error'));\n\n      const data = await generateLocalizedStructuredData(\n        'en',\n        'Organization',\n        {},\n      );\n\n      // Should return basic structure even when translation fails\n      expect(data).toHaveProperty('@context', 'https://schema.org');\n      expect(data).toHaveProperty('@type', 'Organization');\n    });\n\n    it('should handle invalid structured data types', async () => {\n      const data = await generateLocalizedStructuredData(\n        'en',\n        'InvalidType' as unknown,\n        {},\n      );\n\n      // Should return basic structure for unknown types\n      expect(data).toHaveProperty('@context', 'https://schema.org');\n      expect(data).toHaveProperty('@type', 'InvalidType');\n    });\n\n    it('should handle null and undefined data inputs', async () => {\n      const testCases = [\n        { type: 'Organization', data: null },\n        { type: 'WebSite', data: undefined },\n        { type: 'Article', data: {} },\n      ] as const;\n\n      for (const testCase of testCases) {\n        const data = await generateLocalizedStructuredData(\n          'en',\n          testCase.type,\n          testCase.data as unknown,\n        );\n\n        expect(data).toHaveProperty('@context', 'https://schema.org');\n        expect(data).toHaveProperty('@type', testCase.type);\n      }\n    });\n\n    it('should handle malformed article data', async () => {\n      const malformedData = {\n        title: 'Test Article',\n        description: 'Test Description',\n        publishedTime: '2023-01-01T00:00:00Z',\n        url: 'https://example.com/test',\n        invalidProperty: 'should be ignored',\n      };\n\n      const data = await generateLocalizedStructuredData(\n        'en',\n        'Article',\n        malformedData,\n      );\n\n      expect(data).toHaveProperty('@context', 'https://schema.org');\n      expect(data).toHaveProperty('@type', 'Article');\n    });\n\n    it('should handle malformed product data', async () => {\n      const malformedData = {\n        name: '',\n        price: 'invalid-price',\n        currency: null,\n        availability: 'InvalidStatus',\n      };\n\n      const data = await generateLocalizedStructuredData(\n        'en',\n        'Product',\n        malformedData,\n      );\n\n      expect(data).toHaveProperty('@context', 'https://schema.org');\n      expect(data).toHaveProperty('@type', 'Product');\n    });\n  });\n\n  describe('JSON-LD 生成测试', () => {\n    it('should generate valid JSON-LD string', () => {\n      const testData = {\n        '@context': 'https://schema.org',\n        '@type': 'Organization',\n        'name': 'Test Organization',\n      };\n\n      const jsonLD = generateJSONLD(testData);\n\n      // Should be valid JSON\n      expect(() => JSON.parse(jsonLD)).not.toThrow();\n\n      // Should be properly formatted\n      expect(jsonLD).toContain('\"@context\"');\n      expect(jsonLD).toContain('\"@type\"');\n      expect(jsonLD).toContain('Test Organization');\n    });\n\n    it('should handle complex nested objects in JSON-LD', () => {\n      const complexData = {\n        '@context': 'https://schema.org',\n        '@type': 'Organization',\n        'address': {\n          '@type': 'PostalAddress',\n          'streetAddress': '123 Main St',\n          'addressLocality': 'City',\n        },\n        'contactPoint': [\n          {\n            '@type': 'ContactPoint',\n            'telephone': '+1-555-123-4567',\n            'contactType': 'customer service',\n          },\n        ],\n      };\n\n      const jsonLD = generateJSONLD(complexData);\n\n      expect(() => JSON.parse(jsonLD)).not.toThrow();\n\n      const parsed = JSON.parse(jsonLD);\n      expect(parsed.address).toHaveProperty('@type', 'PostalAddress');\n      expect(parsed.contactPoint).toHaveLength(1);\n    });\n\n    it('should handle null and undefined values in JSON-LD', () => {\n      const dataWithNulls = {\n        '@context': 'https://schema.org',\n        '@type': 'Organization',\n        'name': 'Test',\n        'description': null,\n        'url': undefined,\n      };\n\n      const jsonLD = generateJSONLD(dataWithNulls);\n\n      expect(() => JSON.parse(jsonLD)).not.toThrow();\n\n      const parsed = JSON.parse(jsonLD);\n      expect(parsed.description).toBeNull();\n      expect(parsed).not.toHaveProperty('url'); // undefined should be omitted\n    });\n  });\n\n  describe('性能和内存测试', () => {\n    it('should handle repeated generation efficiently', async () => {\n      const startTime = performance.now();\n\n      // Generate structured data multiple times\n      for (let i = 0; i < 100; i++) {\n        await generateStructuredData('home', 'en');\n        await generateLocalizedStructuredData('en', 'Organization', {});\n      }\n\n      const endTime = performance.now();\n      const duration = endTime - startTime;\n\n      // Should complete within reasonable time (less than 1000ms)\n      expect(duration).toBeLessThan(1000);\n    });\n\n    it('should not create memory leaks with repeated calls', async () => {\n      const initialMemory = (performance as unknown).memory?.usedJSHeapSize || 0;\n\n      // Perform many operations\n      for (let i = 0; i < 1000; i++) {\n        await generateLocalizedStructuredData('en', 'Organization', {});\n        generateJSONLD({ test: 'data' });\n      }\n\n      // Force garbage collection if available\n      if (global.gc) {\n        global.gc();\n      }\n\n      const finalMemory = (performance as unknown).memory?.usedJSHeapSize || 0;\n      const memoryIncrease = finalMemory - initialMemory;\n\n      // Memory increase should be minimal (less than 5MB)\n      expect(memoryIncrease).toBeLessThan(5 * 1024 * 1024);\n    });\n  });\n\n  describe('generateJSONLD', () => {\n    it('should generate valid JSON-LD string', () => {\n      const testData = {\n        '@context': 'https://schema.org',\n        '@type': 'Organization',\n        'name': 'Test Organization',\n      };\n\n      const result = generateJSONLD(testData);\n\n      expect(result).toBe(JSON.stringify(testData, null, 2));\n      expect(() => JSON.parse(result)).not.toThrow();\n    });\n\n    it('should handle complex nested objects', () => {\n      const complexData = {\n        '@context': 'https://schema.org',\n        '@type': 'Article',\n        'author': {\n          '@type': 'Person',\n          'name': 'John Doe',\n        },\n        'publisher': {\n          '@type': 'Organization',\n          'name': 'Test Publisher',\n          'logo': {\n            '@type': 'ImageObject',\n            'url': 'https://example.com/logo.png',\n          },\n        },\n      };\n\n      const result = generateJSONLD(complexData);\n\n      expect(result).toContain('\"@context\": \"https://schema.org\"');\n      expect(result).toContain('\"@type\": \"Article\"');\n      expect(result).toContain('\"name\": \"John Doe\"');\n      expect(() => JSON.parse(result)).not.toThrow();\n    });\n\n    it('should handle null and undefined values', () => {\n      const dataWithNulls = {\n        '@context': 'https://schema.org',\n        '@type': 'Organization',\n        'name': 'Test',\n        'description': null,\n        'url': undefined,\n      };\n\n      const result = generateJSONLD(dataWithNulls);\n\n      expect(() => JSON.parse(result)).not.toThrow();\n      const parsed = JSON.parse(result);\n      expect(parsed.description).toBeNull();\n      expect(parsed).not.toHaveProperty('url');\n    });\n\n    it('should handle empty objects and arrays', () => {\n      const emptyData = {};\n      const result = generateJSONLD(emptyData);\n\n      expect(result).toBe('{}');\n      expect(() => JSON.parse(result)).not.toThrow();\n    });\n  });\n\n  describe('generateLocalizedStructuredData - Error Handling', () => {\n    beforeEach(() => {\n      // Reset mocks\n      vi.clearAllMocks();\n    });\n\n    it('should handle translation errors gracefully', async () => {\n      // Mock getTranslations to throw an error\n      const mockGetTranslationsError = vi.mocked(\n        await import('next-intl/server'),\n      ).getTranslations;\n      mockGetTranslationsError.mockRejectedValueOnce(\n        new Error('Translation failed'),\n      );\n\n      const result = await generateLocalizedStructuredData(\n        'en',\n        'Organization',\n        {},\n      );\n\n      expect(result).toEqual({\n        '@context': 'https://schema.org',\n        '@type': 'Organization',\n      });\n    });\n\n    it('should handle unknown structured data types', async () => {\n      const result = await generateLocalizedStructuredData(\n        'en',\n        'UnknownType' as unknown,\n        {},\n      );\n\n      expect(result).toEqual({\n        '@context': 'https://schema.org',\n        '@type': 'UnknownType',\n      });\n    });\n\n    it('should handle non-Error exceptions', async () => {\n      // Mock getTranslations to throw a non-Error object\n      const mockGetTranslationsString = vi.mocked(\n        await import('next-intl/server'),\n      ).getTranslations;\n      mockGetTranslationsString.mockRejectedValueOnce('String error');\n\n      const result = await generateLocalizedStructuredData(\n        'en',\n        'Organization',\n        {},\n      );\n\n      expect(result).toEqual({\n        '@context': 'https://schema.org',\n        '@type': 'Organization',\n      });\n    });\n\n    it('should record errors in I18nPerformanceMonitor', async () => {\n      // Mock getTranslations to throw an Error\n      mockGetTranslations.mockRejectedValueOnce(\n        new Error('Translation failed'),\n      );\n\n      await generateLocalizedStructuredData('en', 'Organization', {});\n\n      expect(mockRecordError).toHaveBeenCalled();\n    });\n  });\n\n  describe('BreadcrumbList Generation', () => {\n    it('should generate breadcrumb structured data', async () => {\n      const breadcrumbData = {\n        items: [\n          { name: 'Home', url: '/', position: 1 },\n          { name: 'Products', url: '/products', position: 2 },\n          { name: 'Category', url: '/products/category', position: 3 },\n        ],\n      };\n\n      const result = await generateLocalizedStructuredData(\n        'en',\n        'BreadcrumbList',\n        breadcrumbData,\n      );\n\n      expect(result['@type']).toBe('BreadcrumbList');\n      expect(result['@context']).toBe('https://schema.org');\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/tech-stack-data.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/theme-analytics.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/theme-analytics/setup.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/translation-benchmarks.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/translation-manager-core.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/translation-manager.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/translation-validators.test.ts","messages":[{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\_.","line":29,"column":15,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":29,"endColumn":16,"suggestions":[{"messageId":"removeEscape","fix":{"range":[1089,1090],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[1089,1089],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { describe, expect, it } from 'vitest';\nimport { Locale } from '@/types/i18n';\nimport { VALIDATION_THRESHOLDS } from '@/constants/i18n-constants';\nimport { TranslationValidators } from '../translation-validators';\n\ndescribe('TranslationValidators', () => {\n  describe('performBasicValidation', () => {\n    it('should detect empty translation', () => {\n      const result = TranslationValidators.performBasicValidation(\n        'Hello world',\n        '',\n      );\n\n      expect(result.issues.length).toBeGreaterThan(0);\n      const missingIssue = result.issues.find(\n        (issue) => issue.type === 'missing',\n      );\n      expect(missingIssue).toBeDefined();\n      expect(missingIssue?.severity).toBe('high');\n      expect(missingIssue?.message).toBe('Translation is empty');\n      expect(result.penalty).toBeGreaterThanOrEqual(\n        VALIDATION_THRESHOLDS.EMPTY_TRANSLATION_PENALTY,\n      );\n    });\n\n    it('should detect empty translation with whitespace only', () => {\n      const result = TranslationValidators.performBasicValidation(\n        'Hello world',\n        '   \\n\\_t  ',\n      );\n\n      expect(result.issues).toHaveLength(1);\n      expect(result.issues[0]?.type).toBe('missing');\n      expect(result.penalty).toBe(\n        VALIDATION_THRESHOLDS.EMPTY_TRANSLATION_PENALTY,\n      );\n    });\n\n    it('should detect placeholder count mismatch', () => {\n      const result = TranslationValidators.performBasicValidation(\n        'Hello {name}, you have {count} messages',\n        'Hello {name}, you have messages',\n      );\n\n      expect(result.issues.length).toBeGreaterThan(0);\n      const placeholderIssue = result.issues.find(\n        (issue) => issue.type === 'placeholder',\n      );\n      expect(placeholderIssue).toBeDefined();\n      expect(placeholderIssue?.severity).toBe('high');\n      expect(placeholderIssue?.message).toBe('Placeholder count mismatch');\n      expect(result.penalty).toBeGreaterThanOrEqual(\n        VALIDATION_THRESHOLDS.PLACEHOLDER_MISMATCH_PENALTY,\n      );\n    });\n\n    it('should detect missing specific placeholders', () => {\n      const result = TranslationValidators.performBasicValidation(\n        'Welcome {username} to {platform}',\n        'Welcome {username} to our site',\n      );\n\n      expect(result.issues).toHaveLength(2); // Both placeholder mismatch and missing placeholder\n      const missingPlaceholderIssue = result.issues.find((issue) =>\n        issue.message.includes('Missing placeholders'),\n      );\n      expect(missingPlaceholderIssue).toBeDefined();\n      expect(missingPlaceholderIssue?.message).toContain('platform');\n    });\n\n    it('should detect significant length differences', () => {\n      const shortTranslation = TranslationValidators.performBasicValidation(\n        'This is a very long original text that should be translated properly',\n        'Short',\n      );\n\n      expect(shortTranslation.issues).toHaveLength(1);\n      expect(shortTranslation.issues[0]?.type).toBe('length');\n      expect(shortTranslation.issues[0]?.severity).toBe('medium');\n\n      const longTranslation = TranslationValidators.performBasicValidation(\n        'Short',\n        'This is an extremely long translation that goes way beyond what would be reasonable for such a short original text',\n      );\n\n      expect(longTranslation.issues).toHaveLength(1);\n      expect(longTranslation.issues[0]?.type).toBe('length');\n    });\n\n    it('should pass validation for good translation', () => {\n      const result = TranslationValidators.performBasicValidation(\n        'Hello {name}, welcome to our platform!',\n        'Hola {name}, ¡bienvenido a nuestra plataforma!',\n      );\n\n      expect(result.issues).toHaveLength(0);\n      expect(result.penalty).toBe(0);\n    });\n\n    it('should handle text without placeholders', () => {\n      const result = TranslationValidators.performBasicValidation(\n        'Simple text without placeholders',\n        'Texto simple sin marcadores de posición',\n      );\n\n      expect(result.issues).toHaveLength(0);\n      expect(result.penalty).toBe(0);\n    });\n  });\n\n  describe('performLanguageSpecificValidation', () => {\n    it('should detect traditional Chinese in simplified Chinese locale', () => {\n      const result = TranslationValidators.performLanguageSpecificValidation(\n        '繁體字檢測',\n        'zh' as Locale,\n      );\n\n      expect(result.issues).toHaveLength(1);\n      expect(result.issues[0]?.type).toBe('language');\n      expect(result.issues[0]?.severity).toBe('medium');\n      expect(result.issues[0]?.message).toBe(\n        'Contains traditional Chinese characters',\n      );\n      expect(result.penalty).toBe(5);\n    });\n\n    it('should pass simplified Chinese validation', () => {\n      const result = TranslationValidators.performLanguageSpecificValidation(\n        '这是简体中文文本',\n        'zh' as Locale,\n      );\n\n      expect(result.issues).toHaveLength(0);\n      expect(result.penalty).toBe(0);\n    });\n\n    it('should detect grammar issues in English', () => {\n      const result = TranslationValidators.performLanguageSpecificValidation(\n        'This is a a duplicate word and and another one',\n        'en' as Locale,\n      );\n\n      expect(result.issues).toHaveLength(1);\n      expect(result.issues[0]?.type).toBe('grammar');\n      expect(result.issues[0]?.severity).toBe('medium');\n      expect(result.issues[0]?.message).toBe(\n        'Potential grammar issues detected',\n      );\n      expect(result.penalty).toBe(8);\n    });\n\n    it('should pass good English validation', () => {\n      const result = TranslationValidators.performLanguageSpecificValidation(\n        'This is a well-written English sentence.',\n        'en' as Locale,\n      );\n\n      expect(result.issues).toHaveLength(0);\n      expect(result.penalty).toBe(0);\n    });\n\n    it('should handle unsupported locales gracefully', () => {\n      const result = TranslationValidators.performLanguageSpecificValidation(\n        'Some text in unsupported locale',\n        'fr' as Locale,\n      );\n\n      expect(result.issues).toHaveLength(0);\n      expect(result.penalty).toBe(0);\n    });\n  });\n\n  describe('compareWithHumanTranslation', () => {\n    it('should detect low similarity with human translation', () => {\n      const result = TranslationValidators.compareWithHumanTranslation(\n        'Completely different AI translation',\n        'Totally unrelated human reference text',\n      );\n\n      expect(result.issues.length).toBeGreaterThan(0);\n      const accuracyIssue = result.issues.find(\n        (issue) => issue.type === 'accuracy',\n      );\n      expect(accuracyIssue).toBeDefined();\n      expect(accuracyIssue?.severity).toBe('high');\n      expect(accuracyIssue?.message).toBe(\n        'AI translation significantly differs from human reference',\n      );\n      expect(result.penalty).toBeGreaterThanOrEqual(25);\n    });\n\n    it('should detect moderate similarity differences', () => {\n      const result = TranslationValidators.compareWithHumanTranslation(\n        'Hello world this is a test',\n        'Hello world this is different content',\n      );\n\n      expect(result.issues.length).toBeGreaterThan(0);\n      const accuracyIssue = result.issues.find(\n        (issue) => issue.type === 'accuracy',\n      );\n      expect(accuracyIssue).toBeDefined();\n      expect(accuracyIssue?.severity).toBe('medium');\n      expect(result.penalty).toBeGreaterThanOrEqual(15);\n    });\n\n    it('should detect missing key terms', () => {\n      const result = TranslationValidators.compareWithHumanTranslation(\n        'Simple translation without important terms',\n        'Professional translation with technical terminology and specialized vocabulary',\n      );\n\n      const terminologyIssue = result.issues.find(\n        (issue) => issue.type === 'terminology',\n      );\n      expect(terminologyIssue).toBeDefined();\n      expect(terminologyIssue?.message).toContain('Missing key terms');\n      expect(\n        (terminologyIssue as { penalty?: number })?.penalty || (result as { penalty?: number }).penalty,\n      ).toBeGreaterThan(0);\n    });\n\n    it('should pass for similar translations', () => {\n      const result = TranslationValidators.compareWithHumanTranslation(\n        'Hello world welcome to our platform',\n        'Hello world welcome to our amazing platform',\n      );\n\n      // Should have no accuracy issues (similarity > 0.6)\n      const accuracyIssues = result.issues.filter(\n        (issue) => issue.type === 'accuracy',\n      );\n      expect(accuracyIssues).toHaveLength(0);\n    });\n  });\n\n  describe('checkContextRelevance', () => {\n    it('should detect missing error terms in error context', () => {\n      const issues = TranslationValidators.checkContextRelevance(\n        'user.error.validation',\n        'Please check your input',\n      );\n\n      expect(issues).toHaveLength(1);\n      expect(issues[0]?.type).toBe('context');\n      expect(issues[0]?.severity).toBe('medium');\n      expect(issues[0]?.message).toBe(\n        'Error context not reflected in translation',\n      );\n    });\n\n    it('should pass when error terms are present', () => {\n      const issues = TranslationValidators.checkContextRelevance(\n        'user.error.validation',\n        'Error: Invalid input provided',\n      );\n\n      expect(issues).toHaveLength(0);\n    });\n\n    it('should pass when error terms are present in Chinese', () => {\n      const issues = TranslationValidators.checkContextRelevance(\n        'user.error.validation',\n        '错误：输入无效',\n      );\n\n      expect(issues).toHaveLength(0);\n    });\n\n    it('should handle non-error contexts gracefully', () => {\n      const issues = TranslationValidators.checkContextRelevance(\n        'user.welcome.message',\n        'Welcome to our platform',\n      );\n\n      expect(issues).toHaveLength(0);\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/utils.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/validations.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/web-vitals-collector.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/__tests__/web-vitals-monitor.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/accessibility-hooks.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/accessibility-manager.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/accessibility-tester.ts","messages":[{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 50.","line":69,"column":58,"nodeType":"Literal","messageId":"noMagic","endLine":69,"endColumn":60},{"ruleId":"max-statements","severity":2,"message":"Async method 'testKeyActivation' has too many statements (24). Maximum allowed is 20.","line":98,"column":26,"nodeType":"FunctionExpression","messageId":"exceed","endLine":155,"endColumn":4},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 3.","line":125,"column":53,"nodeType":"Literal","messageId":"noMagic","endLine":125,"endColumn":54},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0.8.","line":138,"column":32,"nodeType":"Literal","messageId":"noMagic","endLine":138,"endColumn":35},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0.8.","line":140,"column":27,"nodeType":"Literal","messageId":"noMagic","endLine":140,"endColumn":30},{"ruleId":"max-statements","severity":2,"message":"Async method 'testEscapeKeyClose' has too many statements (21). Maximum allowed is 20.","line":160,"column":27,"nodeType":"FunctionExpression","messageId":"exceed","endLine":221,"endColumn":4},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (4). Maximum allowed is 3.","line":196,"column":11,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":196,"endColumn":42},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0.8.","line":204,"column":32,"nodeType":"Literal","messageId":"noMagic","endLine":204,"endColumn":35},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0.8.","line":206,"column":27,"nodeType":"Literal","messageId":"noMagic","endLine":206,"endColumn":30},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0.8.","line":344,"column":58,"nodeType":"Literal","messageId":"noMagic","endLine":344,"endColumn":61}],"suppressedMessages":[],"errorCount":10,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 无障碍性测试工具\n * 用于测试导航组件的键盘导航和无障碍性功能\n */\n\nexport interface AccessibilityTestResult {\n  testName: string;\n  passed: boolean;\n  details: string;\n  suggestions?: string[];\n}\n\nexport interface KeyboardNavigationTest {\n  element: HTMLElement;\n  expectedBehavior: string;\n  testFunction: () => Promise<boolean>;\n}\n\n/**\n * 无障碍性测试器类\n */\nexport class AccessibilityTester {\n  private results: AccessibilityTestResult[] = [];\n\n  /**\n   * 测试Tab键循环导航\n   */\n  async testTabNavigation(): Promise<AccessibilityTestResult> {\n    const testName = 'Tab键循环导航测试';\n\n    try {\n      // 获取所有可聚焦元素\n      const focusableElements = this.getFocusableElements();\n\n      if (focusableElements.length === 0) {\n        return {\n          testName,\n          passed: false,\n          details: '未找到可聚焦的导航元素',\n          suggestions: ['确保导航元素具有正确的tabindex属性', '检查元素是否被正确渲染']\n        };\n      }\n\n      // 测试Tab键导航顺序\n      const tabOrder: HTMLElement[] = [];\n      const currentElement = focusableElements[0];\n\n      if (!currentElement) {\n        return {\n          testName,\n          passed: false,\n          details: '未找到可聚焦的导航元素'\n        };\n      }\n\n      for (let i = 0; i < focusableElements.length; i++) {\n        currentElement.focus();\n        tabOrder.push(document.activeElement as HTMLElement);\n\n        // 模拟Tab键\n        const tabEvent = new KeyboardEvent('keydown', {\n          key: 'Tab',\n          bubbles: true,\n          cancelable: true\n        });\n        document.dispatchEvent(tabEvent);\n\n        // 等待焦点变化\n        await new Promise(resolve => setTimeout(resolve, 50));\n      }\n\n      const isValidTabOrder = this.validateTabOrder(tabOrder, focusableElements);\n\n      return {\n        testName,\n        passed: isValidTabOrder,\n        details: `测试了${focusableElements.length}个可聚焦元素，Tab键导航${isValidTabOrder ? '正常' : '异常'}`,\n        ...(isValidTabOrder ? {} : { suggestions: [\n          '检查tabindex属性设置',\n          '确保元素按逻辑顺序排列',\n          '验证隐藏元素不在Tab序列中'\n        ] })\n      };\n    } catch (_error) {\n    // 忽略错误变量\n      return {\n        testName,\n        passed: false,\n        details: `测试过程中发生错误: ${_error}`,\n        suggestions: ['检查DOM结构', '确保测试环境正确']\n      };\n    }\n  }\n\n  /**\n   * 测试Enter/Space键激活功能\n   */\n  async testKeyActivation(): Promise<AccessibilityTestResult> {\n    const testName = 'Enter/Space键激活测试';\n\n    try {\n      const triggers = document.querySelectorAll('[data-slot=\"navigation-menu-trigger\"]');\n      const links = document.querySelectorAll('a[href]');\n\n      let activationTests = 0;\n      let passedTests = 0;\n\n      // 测试下拉菜单触发器\n      for (const trigger of triggers) {\n        const element = trigger as HTMLElement;\n        element.focus();\n\n        // 测试Enter键\n        const enterResult = await this.testElementKeyActivation(element, 'Enter');\n        activationTests += 1;\n        if (enterResult) passedTests += 1;\n\n        // 测试Space键\n        const spaceResult = await this.testElementKeyActivation(element, ' ');\n        activationTests += 1;\n        if (spaceResult) passedTests += 1;\n      }\n\n      // 测试导航链接\n      for (const link of Array.from(links).slice(0, 3)) { // 限制测试数量\n        const element = link as HTMLElement;\n        element.focus();\n\n        const enterResult = await this.testElementKeyActivation(element, 'Enter');\n        activationTests += 1;\n        if (enterResult) passedTests += 1;\n      }\n\n      const successRate = activationTests > 0 ? passedTests / activationTests : 0;\n\n      return {\n        testName,\n        passed: successRate >= 0.8, // 80%通过率\n        details: `测试了${activationTests}个激活操作，成功率: ${(successRate * 100).toFixed(1)}%`,\n        ...(successRate < 0.8 ? { suggestions: [\n          '确保所有交互元素支持Enter键激活',\n          '验证Space键在按钮元素上的激活功能',\n          '检查键盘事件处理器的实现'\n        ] } : {})\n      };\n    } catch (_error) {\n    // 忽略错误变量\n      return {\n        testName,\n        passed: false,\n        details: `测试过程中发生错误: ${_error}`,\n        suggestions: ['检查事件处理器', '验证元素可访问性']\n      };\n    }\n  }\n\n  /**\n   * 测试Escape键关闭功能\n   */\n  async testEscapeKeyClose(): Promise<AccessibilityTestResult> {\n    const testName = 'Escape键关闭测试';\n\n    try {\n      const triggers = document.querySelectorAll('[data-slot=\"navigation-menu-trigger\"]');\n      let escapeTests = 0;\n      let passedTests = 0;\n\n      for (const trigger of triggers) {\n        const element = trigger as HTMLElement;\n\n        // 先打开菜单\n        element.focus();\n        element.click();\n        await new Promise(resolve => setTimeout(resolve, 100));\n\n        // 检查菜单是否打开\n        const isOpen = element.getAttribute('data-state') === 'open' ||\n                      element.getAttribute('aria-expanded') === 'true';\n\n        if (isOpen) {\n          // 测试Escape键关闭\n          const escapeEvent = new KeyboardEvent('keydown', {\n            key: 'Escape',\n            bubbles: true,\n            cancelable: true\n          });\n          element.dispatchEvent(escapeEvent);\n\n          await new Promise(resolve => setTimeout(resolve, 100));\n\n          // 检查菜单是否关闭\n          const isClosed = element.getAttribute('data-state') !== 'open' &&\n                          element.getAttribute('aria-expanded') !== 'true';\n\n          escapeTests += 1;\n          if (isClosed) passedTests += 1;\n        }\n      }\n\n      const successRate = escapeTests > 0 ? passedTests / escapeTests : 0;\n\n      return {\n        testName,\n        passed: successRate >= 0.8,\n        details: `测试了${escapeTests}个Escape关闭操作，成功率: ${(successRate * 100).toFixed(1)}%`,\n        ...(successRate < 0.8 ? { suggestions: [\n          '确保Escape键事件处理器正确实现',\n          '验证菜单状态管理',\n          '检查事件冒泡和传播'\n        ] } : {})\n      };\n    } catch (_error) {\n    // 忽略错误变量\n      return {\n        testName,\n        passed: false,\n        details: `测试过程中发生错误: ${_error}`,\n        suggestions: ['检查菜单状态管理', '验证键盘事件处理']\n      };\n    }\n  }\n\n  /**\n   * 测试ARIA标签和属性\n   */\n  testAriaAttributes(): AccessibilityTestResult {\n    const testName = 'ARIA标签和属性测试';\n\n    try {\n      const issues: string[] = [];\n      const suggestions: string[] = [];\n\n      // 检查导航容器\n      const navElements = document.querySelectorAll('nav');\n      navElements.forEach((nav, index) => {\n        if (!nav.getAttribute('aria-label') && !nav.getAttribute('aria-labelledby')) {\n          issues.push(`导航容器${index + 1}缺少aria-label或aria-labelledby`);\n          suggestions.push('为导航容器添加描述性的aria-label');\n        }\n      });\n\n      // 检查下拉菜单触发器\n      const triggers = document.querySelectorAll('[data-slot=\"navigation-menu-trigger\"]');\n      triggers.forEach((trigger, index) => {\n        if (!trigger.getAttribute('aria-expanded')) {\n          issues.push(`下拉菜单触发器${index + 1}缺少aria-expanded属性`);\n          suggestions.push('为下拉菜单触发器添加aria-expanded属性');\n        }\n\n        if (!trigger.getAttribute('aria-haspopup')) {\n          issues.push(`下拉菜单触发器${index + 1}缺少aria-haspopup属性`);\n          suggestions.push('为下拉菜单触发器添加aria-haspopup属性');\n        }\n      });\n\n      // 检查当前页面标识\n      const currentPageLinks = document.querySelectorAll('[aria-current=\"page\"]');\n      const allLinks = document.querySelectorAll('a[href]');\n\n      if (currentPageLinks.length === 0 && allLinks.length > 0) {\n        issues.push('未找到当前页面的aria-current=\"page\"标识');\n        suggestions.push('为当前页面链接添加aria-current=\"page\"属性');\n      }\n\n      return {\n        testName,\n        passed: issues.length === 0,\n        details: issues.length === 0 ?\n          '所有ARIA属性配置正确' :\n          `发现${issues.length}个ARIA属性问题: ${issues.join('; ')}`,\n        ...(suggestions.length > 0 ? { suggestions } : {})\n      };\n    } catch (_error) {\n    // 忽略错误变量\n      return {\n        testName,\n        passed: false,\n        details: `测试过程中发生错误: ${_error}`,\n        suggestions: ['检查DOM结构', '验证ARIA属性配置']\n      };\n    }\n  }\n\n  /**\n   * 运行所有无障碍性测试\n   */\n  async runAllTests(): Promise<AccessibilityTestResult[]> {\n    this.results = [];\n\n    // 运行各项测试\n    this.results.push(await this.testTabNavigation());\n    this.results.push(await this.testKeyActivation());\n    this.results.push(await this.testEscapeKeyClose());\n    this.results.push(this.testAriaAttributes());\n\n    return this.results;\n  }\n\n  /**\n   * 获取测试报告\n   */\n  getTestReport(): string {\n    const totalTests = this.results.length;\n    const passedTests = this.results.filter(r => r.passed).length;\n    const failedTests = totalTests - passedTests;\n\n    let report = `\\n=== 无障碍性测试报告 ===\\n`;\n    report += `总测试数: ${totalTests}\\n`;\n    report += `通过: ${passedTests}\\n`;\n    report += `失败: ${failedTests}\\n`;\n    report += `通过率: ${((passedTests / totalTests) * 100).toFixed(1)}%\\n\\n`;\n\n    this.results.forEach((result, index) => {\n      report += `${index + 1}. ${result.testName}\\n`;\n      report += `   状态: ${result.passed ? '✅ 通过' : '❌ 失败'}\\n`;\n      report += `   详情: ${result.details}\\n`;\n      if (result.suggestions) {\n        report += `   建议: ${result.suggestions.join('; ')}\\n`;\n      }\n      report += '\\n';\n    });\n\n    return report;\n  }\n\n  // 私有辅助方法\n  private getFocusableElements(): HTMLElement[] {\n    const selector = [\n      'a[href]',\n      'button:not([disabled])',\n      'input:not([disabled])',\n      'select:not([disabled])',\n      'textarea:not([disabled])',\n      '[tabindex]:not([tabindex=\"-1\"])',\n      '[data-slot=\"navigation-menu-trigger\"]',\n      '[data-slot=\"navigation-menu-link\"]'\n    ].join(', ');\n\n    return Array.from(document.querySelectorAll(selector)) as HTMLElement[];\n  }\n\n  private validateTabOrder(tabOrder: HTMLElement[], focusableElements: HTMLElement[]): boolean {\n    // 简单验证：检查是否能遍历所有可聚焦元素\n    return tabOrder.length >= focusableElements.length * 0.8; // 允许80%的覆盖率\n  }\n\n  private async testElementKeyActivation(element: HTMLElement, key: string): Promise<boolean> {\n    try {\n      const initialState = element.getAttribute('data-state');\n      const initialExpanded = element.getAttribute('aria-expanded');\n\n      const keyEvent = new KeyboardEvent('keydown', {\n        key,\n        bubbles: true,\n        cancelable: true\n      });\n\n      element.dispatchEvent(keyEvent);\n      await new Promise(resolve => setTimeout(resolve, 100));\n\n      const newState = element.getAttribute('data-state');\n      const newExpanded = element.getAttribute('aria-expanded');\n\n      // 检查状态是否发生变化（表示激活成功）\n      return initialState !== newState || initialExpanded !== newExpanded;\n    } catch {\n      return false;\n    }\n  }\n}\n\n// 导出便捷函数\nexport async function runAccessibilityTests(): Promise<string> {\n  const tester = new AccessibilityTester();\n  await tester.runAllTests();\n  return tester.getTestReport();\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/accessibility-types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/accessibility-utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/accessibility.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/airtable.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/airtable/instance.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/airtable/service.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'AirtableStatistics' is defined but never used. Allowed unused vars must match /^_/u.","line":16,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"AirtableStatistics"},"fix":{"range":[284,306],"text":""},"desc":"Remove unused variable 'AirtableStatistics'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'AirtableStatistics' is defined but never used. Allowed unused vars must match /^_/u.","line":16,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":16,"endColumn":21}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Airtable 核心服务类\n */\n\nimport Airtable from 'airtable';\nimport { env } from '@/../env.mjs';\nimport { logger } from '../logger';\nimport {\n  airtableRecordSchema,\n  validationHelpers,\n} from '../validations';\nimport type {\n  AirtableRecord,\n  ContactFormData,\n  AirtableQueryOptions,\n  AirtableStatistics,\n  ContactStatus,\n} from './types';\n\n/**\n * Airtable配置和初始化\n * Airtable configuration and initialization\n */\nexport class AirtableService {\n  private base: Airtable.Base | null = null;\n  private tableName: string;\n  private isConfigured: boolean = false;\n\n  constructor() {\n    this.tableName = env.AIRTABLE_TABLE_NAME || 'Contacts';\n    this.initializeAirtable();\n  }\n\n  /**\n   * 初始化Airtable连接\n   * Initialize Airtable connection\n   */\n  private initializeAirtable(): void {\n    try {\n      if (!env.AIRTABLE_API_KEY || !env.AIRTABLE_BASE_ID) {\n        logger.warn(\n          'Airtable configuration missing - service will be disabled',\n          {\n            hasApiKey: Boolean(env.AIRTABLE_API_KEY),\n            hasBaseId: Boolean(env.AIRTABLE_BASE_ID),\n          },\n        );\n        return;\n      }\n\n      Airtable.configure({\n        endpointUrl: 'https://api.airtable.com',\n        apiKey: env.AIRTABLE_API_KEY,\n      });\n\n      this.base = Airtable.base(env.AIRTABLE_BASE_ID);\n      this.isConfigured = true;\n\n      logger.info('Airtable service initialized successfully', {\n        tableName: this.tableName,\n      });\n    } catch (error) {\n      logger.error('Failed to initialize Airtable service', {\n        error: error instanceof Error ? error.message : 'Unknown error',\n      });\n    }\n  }\n\n  /**\n   * 检查服务是否已配置\n   * Check if service is configured\n   */\n  public isReady(): boolean {\n    return this.isConfigured && this.base !== null;\n  }\n\n  /**\n   * 清理表单数据\n   * Sanitize form data before saving\n   */\n  private sanitizeFormData(formData: ContactFormData): ContactFormData {\n    return {\n      firstName: validationHelpers.sanitizeInput(formData.firstName),\n      lastName: validationHelpers.sanitizeInput(formData.lastName),\n      email: formData.email.toLowerCase().trim(),\n      company: validationHelpers.sanitizeInput(formData.company),\n      message: validationHelpers.sanitizeInput(formData.message),\n      phone: formData.phone\n        ? validationHelpers.sanitizeInput(formData.phone)\n        : undefined,\n      subject: formData.subject\n        ? validationHelpers.sanitizeInput(formData.subject)\n        : undefined,\n      acceptPrivacy: formData.acceptPrivacy,\n      marketingConsent: formData.marketingConsent,\n      website: formData.website,\n    };\n  }\n\n  /**\n   * 创建联系人记录\n   * Create contact record in Airtable\n   */\n  public async createContact(\n    formData: ContactFormData,\n  ): Promise<AirtableRecord> {\n    if (!this.isReady()) {\n      throw new Error('Airtable service is not configured');\n    }\n\n    try {\n      // 清理和验证数据\n      const sanitizedData = this.sanitizeFormData(formData);\n\n      // 构建Airtable记录\n      const recordData = {\n        'First Name': sanitizedData.firstName,\n        'Last Name': sanitizedData.lastName,\n        'Email': sanitizedData.email,\n        'Company': sanitizedData.company,\n        'Message': sanitizedData.message,\n        'Phone': sanitizedData.phone || '',\n        'Subject': sanitizedData.subject || '',\n        'Submitted At': new Date().toISOString(),\n        'Status': 'New' as const,\n        'Source': 'Website Contact Form',\n        'Marketing Consent': sanitizedData.marketingConsent || false,\n      };\n\n      // 验证记录格式\n      const validatedRecord = airtableRecordSchema.parse({\n        fields: recordData,\n      });\n\n      // 创建记录\n      const records = await this.base!.table(this.tableName).create([\n        {\n          fields: validatedRecord.fields,\n        },\n      ]);\n\n      const [createdRecord] = records;\n\n      if (!createdRecord) {\n        throw new Error('Failed to create record');\n      }\n\n      logger.info('Contact record created successfully', {\n        recordId: createdRecord.id,\n        email: sanitizedData.email,\n        company: sanitizedData.company,\n      });\n\n      return {\n        id: createdRecord.id,\n        fields: createdRecord.fields as AirtableRecord['fields'],\n        createdTime: createdRecord.get('Created Time') as string,\n      };\n    } catch (error) {\n      logger.error('Failed to create contact record', {\n        error: error instanceof Error ? error.message : 'Unknown error',\n        email: formData.email,\n      });\n      throw new Error('Failed to save contact information');\n    }\n  }\n\n  /**\n   * 获取联系人记录\n   * Get contact records from Airtable\n   */\n  public async getContacts(\n    options: AirtableQueryOptions = {},\n  ): Promise<AirtableRecord[]> {\n    if (!this.isReady()) {\n      throw new Error('Airtable service is not configured');\n    }\n\n    try {\n      const { maxRecords = 100, filterByFormula, sort } = options;\n\n      const selectOptions: {\n        maxRecords: number;\n        filterByFormula?: string;\n        sort?: Array<{ field: string; direction: 'asc' | 'desc' }>;\n      } = { maxRecords };\n      if (filterByFormula) {\n        selectOptions.filterByFormula = filterByFormula;\n      }\n      if (sort) {\n        selectOptions.sort = sort;\n      }\n\n      const records = await this.base!.table(this.tableName)\n        .select(selectOptions)\n        .all();\n\n      return records.map((record) => ({\n        id: record.id,\n        fields: record.fields as AirtableRecord['fields'],\n        createdTime: record.get('Created Time') as string,\n      }));\n    } catch (error) {\n      logger.error('Failed to fetch contact records', {\n        error: error instanceof Error ? error.message : 'Unknown error',\n      });\n      throw new Error('Failed to fetch contact records');\n    }\n  }\n\n  /**\n   * 更新联系人记录状态\n   * Update contact record status\n   */\n  public async updateContactStatus(\n    recordId: string,\n    status: ContactStatus,\n  ): Promise<void> {\n    if (!this.isReady()) {\n      throw new Error('Airtable service is not configured');\n    }\n\n    try {\n      await this.base!.table(this.tableName).update([\n        {\n          id: recordId,\n          fields: {\n            'Status': status,\n            'Updated At': new Date().toISOString(),\n          },\n        },\n      ]);\n\n      logger.info('Contact record status updated', {\n        recordId,\n        newStatus: status,\n      });\n    } catch (error) {\n      logger.error('Failed to update contact record status', {\n        error: error instanceof Error ? error.message : 'Unknown error',\n        recordId,\n        status,\n      });\n      throw new Error('Failed to update contact status');\n    }\n  }\n\n  /**\n   * 删除联系人记录\n   * Delete contact record\n   */\n  public async deleteContact(recordId: string): Promise<void> {\n    if (!this.isReady()) {\n      throw new Error('Airtable service is not configured');\n    }\n\n    try {\n      await this.base!.table(this.tableName).destroy([recordId]);\n\n      logger.info('Contact record deleted', {\n        recordId,\n      });\n    } catch (error) {\n      logger.error('Failed to delete contact record', {\n        error: error instanceof Error ? error.message : 'Unknown error',\n        recordId,\n      });\n      throw new Error('Failed to delete contact record');\n    }\n  }\n\n  /**\n   * 检查重复邮箱\n   * Check for duplicate email addresses\n   */\n  public async isDuplicateEmail(email: string): Promise<boolean> {\n    if (!this.isReady()) {\n      return false;\n    }\n\n    try {\n      const records = await this.base!.table(this.tableName)\n        .select({\n          filterByFormula: `{Email} = \"${email.toLowerCase()}\"`,\n          maxRecords: 1,\n        })\n        .all();\n\n      return records.length > 0;\n    } catch (error) {\n      logger.error('Failed to check duplicate email', {\n        error: error instanceof Error ? error.message : 'Unknown error',\n        email,\n      });\n      return false;\n    }\n  }\n\n  /**\n   * 获取统计信息\n   * Get statistics\n   */\n  public async getStatistics(): Promise<{\n    totalContacts: number;\n    newContacts: number;\n    completedContacts: number;\n    recentContacts: number;\n  }> {\n    if (!this.isReady()) {\n      throw new Error('Airtable service is not configured');\n    }\n\n    try {\n      const [total, newContacts, completed, recent] = await Promise.all([\n        this.getContacts({ maxRecords: 1000 }),\n        this.getContacts({\n          filterByFormula: `{Status} = \"New\"`,\n          maxRecords: 1000,\n        }),\n        this.getContacts({\n          filterByFormula: `{Status} = \"Completed\"`,\n          maxRecords: 1000,\n        }),\n        this.getContacts({\n          filterByFormula: `IS_AFTER({Submitted At}, DATEADD(TODAY(), -7, 'days'))`,\n          maxRecords: 1000,\n        }),\n      ]);\n\n      return {\n        totalContacts: total.length,\n        newContacts: newContacts.length,\n        completedContacts: completed.length,\n        recentContacts: recent.length,\n      };\n    } catch (error) {\n      logger.error('Failed to get statistics', {\n        error: error instanceof Error ? error.message : 'Unknown error',\n      });\n      throw new Error('Failed to get statistics');\n    }\n  }\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/airtable/types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/colors.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/colors/color-system.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/colors/dark-theme.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/colors/light-theme.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/colors/types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/colors/utils.ts","messages":[],"suppressedMessages":[{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":63,"column":5,"nodeType":"MemberExpression","endLine":63,"endColumn":22,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/content-parser.ts","messages":[],"suppressedMessages":[{"ruleId":"security/detect-non-literal-fs-filename","severity":2,"message":"Found existsSync from package \"fs\" with non literal argument at index 0","line":34,"column":10,"nodeType":"CallExpression","endLine":34,"endColumn":38,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"security/detect-non-literal-fs-filename","severity":2,"message":"Found readFileSync from package \"fs\" with non literal argument at index 0","line":42,"column":25,"nodeType":"CallExpression","endLine":42,"endColumn":64,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"security/detect-non-literal-fs-filename","severity":2,"message":"Found existsSync from package \"fs\" with non literal argument at index 0","line":92,"column":8,"nodeType":"CallExpression","endLine":92,"endColumn":42,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"security/detect-non-literal-fs-filename","severity":2,"message":"Found readdirSync from package \"fs\" with non literal argument at index 0","line":100,"column":17,"nodeType":"CallExpression","endLine":100,"endColumn":52,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/content-query.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/content-query/filters.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/content-query/queries.ts","messages":[{"ruleId":"no-throw-literal","severity":2,"message":"Expected an error object to be thrown.","line":73,"column":5,"nodeType":"ThrowStatement","messageId":"object","endLine":73,"endColumn":75}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 内容查询函数\n */\n\nimport path from 'path';\nimport type {\n  BlogPost,\n  BlogPostMetadata,\n  ContentMetadata,\n  ContentNotFoundError,\n  ContentQueryOptions,\n  ContentType,\n  Locale,\n  Page,\n  PageMetadata,\n  ParsedContent,\n} from '@/types/content';\nimport { getContentFiles, parseContentFile } from '../content-parser';\nimport { getContentConfig, PAGES_DIR, POSTS_DIR } from '../content-utils';\nimport { filterPosts } from './filters';\nimport { sortPosts, paginatePosts } from './sorting';\n\n/**\n * Get all blog posts\n */\nexport function getAllPosts(\n  locale?: Locale,\n  options: ContentQueryOptions = {},\n): BlogPost[] {\n  const files = getContentFiles(POSTS_DIR, locale);\n  const parsedPosts = files.map((file) =>\n    parseContentFile<BlogPostMetadata>(file, 'posts'),\n  );\n\n  const filteredPosts = filterPosts(parsedPosts, options);\n  const sortedPosts = sortPosts(filteredPosts, options);\n  const paginatedPosts = paginatePosts(sortedPosts, options);\n\n  return paginatedPosts;\n}\n\n/**\n * Get all pages\n */\nexport function getAllPages(locale?: Locale): Page[] {\n  const files = getContentFiles(PAGES_DIR, locale);\n  return files\n    .map((file) => parseContentFile<PageMetadata>(file, 'pages'))\n    .filter((page) => {\n      // Filter drafts in production\n      const config = getContentConfig();\n      return config.enableDrafts || !page.metadata.draft;\n    }) as Page[];\n}\n\n/**\n * Get content by slug\n */\nexport function getContentBySlug<T extends ContentMetadata = ContentMetadata>(\n  slug: string,\n  type: ContentType,\n  locale?: Locale,\n): ParsedContent<T> {\n  const contentDir = type === 'posts' ? POSTS_DIR : PAGES_DIR;\n  const files = getContentFiles(contentDir, locale);\n\n  const matchingFile = files.find((file) => {\n    const fileSlug = path.basename(file, path.extname(file));\n    return fileSlug === slug || fileSlug.startsWith(`${slug}.`);\n  });\n\n  if (!matchingFile) {\n    throw new Error(`Content not found: ${slug}`) as ContentNotFoundError;\n  }\n\n  return parseContentFile<T>(matchingFile, type);\n}\n\n/**\n * Get blog post by slug\n */\nexport function getPostBySlug(slug: string, locale?: Locale): BlogPost {\n  return getContentBySlug<BlogPostMetadata>(slug, 'posts', locale) as BlogPost;\n}\n\n/**\n * Get page by slug\n */\nexport function getPageBySlug(slug: string, locale?: Locale): Page {\n  return getContentBySlug<PageMetadata>(slug, 'pages', locale) as Page;\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/content-query/sorting.ts","messages":[{"ruleId":"no-throw-literal","severity":2,"message":"Expected an error object to be thrown.","line":23,"column":7,"nodeType":"ThrowStatement","messageId":"object","endLine":25,"endColumn":25},{"ruleId":"no-throw-literal","severity":2,"message":"Expected an error object to be thrown.","line":63,"column":5,"nodeType":"ThrowStatement","messageId":"object","endLine":65,"endColumn":23}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 内容排序和分页函数\n */\n\nimport type {\n  BlogPost,\n  ContentError,\n  ContentQueryOptions,\n} from '@/types/content';\n\n/**\n * Get field value from post metadata with type safety\n */\nfunction getFieldValue(post: BlogPost, field: string): string {\n  switch (field) {\n    case 'publishedAt':\n      return post.metadata.publishedAt || '';\n    case 'updatedAt':\n      return post.metadata.updatedAt || '';\n    case 'title':\n      return post.metadata.title || '';\n    default:\n      throw new Error(\n        `Unexpected sort field: ${field}`,\n      ) as ContentError;\n  }\n}\n\n/**\n * Compare two values with specified sort order\n */\nfunction compareValues(\n  aValue: string,\n  bValue: string,\n  sortOrder: 'asc' | 'desc',\n): number {\n  if (sortOrder === 'desc') {\n    return bValue.localeCompare(aValue);\n  }\n  return aValue.localeCompare(bValue);\n}\n\n/**\n * Create a sort comparator function for posts\n */\nfunction createSortComparator(sortBy: string, sortOrder: 'asc' | 'desc') {\n  return (a: BlogPost, b: BlogPost): number => {\n    const aValue = getFieldValue(a, sortBy);\n    const bValue = getFieldValue(b, sortBy);\n    return compareValues(aValue, bValue, sortOrder);\n  };\n}\n\n/**\n * Validate sort field to prevent object injection\n */\nfunction validateSortField(sortBy: string): void {\n  const allowedSortFields = ['publishedAt', 'updatedAt', 'title'] as const;\n\n  if (\n    !allowedSortFields.includes(sortBy as (typeof allowedSortFields)[number])\n  ) {\n    throw new Error(\n      `Invalid sort field: ${sortBy}. Allowed fields: ${allowedSortFields.join(', ')}`,\n    ) as ContentError;\n  }\n}\n\n/**\n * Sort posts with type-safe property access\n */\nexport function sortPosts(\n  posts: BlogPost[],\n  options: ContentQueryOptions,\n): BlogPost[] {\n  const sortBy = options.sortBy || 'publishedAt';\n  const sortOrder = options.sortOrder || 'desc';\n\n  // Validate sort field to prevent object injection\n  validateSortField(sortBy);\n\n  // Create and apply sort comparator\n  const comparator = createSortComparator(sortBy, sortOrder);\n  posts.sort(comparator);\n\n  return posts;\n}\n\n/**\n * Apply pagination to posts\n */\nexport function paginatePosts(\n  posts: BlogPost[],\n  options: ContentQueryOptions,\n): BlogPost[] {\n  if (options.offset || options.limit) {\n    const start = options.offset || 0;\n    const end = options.limit ? start + options.limit : undefined;\n    return posts.slice(start, end);\n  }\n  return posts;\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/content-query/stats.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/content-utils.ts","messages":[],"suppressedMessages":[{"ruleId":"security/detect-non-literal-fs-filename","severity":2,"message":"Found existsSync from package \"fs\" with non literal argument at index 0","line":102,"column":9,"nodeType":"CallExpression","endLine":102,"endColumn":43,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"security/detect-non-literal-fs-filename","severity":2,"message":"Found readFileSync from package \"fs\" with non literal argument at index 0","line":104,"column":29,"nodeType":"CallExpression","endLine":104,"endColumn":74,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/content-validation.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/content.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/dev-tools-positioning.ts","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":1,"message":"Do not use \"@ts-nocheck\" because it alters compilation errors.","line":1,"column":1,"nodeType":"Line","messageId":"tsDirectiveComment","endLine":1,"endColumn":42},{"ruleId":"no-undef","severity":2,"message":"'DEV_TOOLS_CONSTANTS' is not defined.","line":156,"column":28,"nodeType":"Identifier","messageId":"undef","endLine":156,"endColumn":47}],"suppressedMessages":[{"ruleId":"security/detect-object-injection","severity":2,"message":"Variable Assigned to Object Injection Sink","line":134,"column":18,"nodeType":"MemberExpression","endLine":134,"endColumn":42,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// @ts-nocheck - 开发工具豁免：仅开发环境使用，不影响生产代码质量\n/**\n * 开发工具定位管理系统\n *\n * 统一管理所有开发工具的定位，防止重叠和视觉冲突\n * 提供智能布局算法和可配置的定位策略\n */\n\nexport type DevToolPosition =\n  | 'top-left'\n  | 'top-right'\n  | 'bottom-left'\n  | 'bottom-right'\n  | 'top-center'\n  | 'bottom-center'\n  | 'left-center'\n  | 'right-center';\n\nexport type DevToolSize = 'small' | 'medium' | 'large';\n\nexport interface DevToolConfig {\n  id: string;\n  name: string;\n  position: DevToolPosition;\n  size: DevToolSize;\n  priority: number; // 1-10, 10 为最高优先级\n  zIndex: number;\n  collapsible: boolean;\n  defaultCollapsed?: boolean;\n}\n\n/**\n * 开发工具定位配置\n * 按优先级和功能重要性分配位置\n */\nexport const DEV_TOOLS_CONFIG: Record<string, DevToolConfig> = {\n  // React Scan - 最重要的性能工具，右下角主要位置\n  reactScanIndicator: {\n    id: 'react-scan-indicator',\n    name: 'React Scan Indicator',\n    position: 'bottom-left',\n    size: 'small',\n    priority: 9,\n    zIndex: 1000,\n    collapsible: false,\n  },\n\n  reactScanControlPanel: {\n    id: 'react-scan-control-panel',\n    name: 'React Scan Controls',\n    position: 'bottom-right',\n    size: 'medium',\n    priority: 8,\n    zIndex: 1001,\n    collapsible: true,\n    defaultCollapsed: false,\n  },\n\n  // I18n Performance - 重要但不如 React Scan，放在右上角\n  i18nPerformanceDashboard: {\n    id: 'i18n-performance-dashboard',\n    name: 'I18n Performance',\n    position: 'top-right',\n    size: 'medium',\n    priority: 7,\n    zIndex: 999,\n    collapsible: true,\n    defaultCollapsed: false,\n  },\n\n  i18nPerformanceIndicator: {\n    id: 'i18n-performance-indicator',\n    name: 'I18n Indicator',\n    position: 'top-left',\n    size: 'small',\n    priority: 6,\n    zIndex: 998,\n    collapsible: false,\n  },\n\n  // Web Vitals - 性能监控，左下角次要位置\n  webVitalsIndicator: {\n    id: 'web-vitals-indicator',\n    name: 'Web Vitals',\n    position: 'left-center',\n    size: 'medium',\n    priority: 5,\n    zIndex: 997,\n    collapsible: true,\n    defaultCollapsed: true,\n  },\n\n  // 开发性能监控 - 最低优先级，顶部中央\n  developmentPerformanceMonitor: {\n    id: 'development-performance-monitor',\n    name: 'Dev Performance',\n    position: 'top-center',\n    size: 'small',\n    priority: 4,\n    zIndex: 996,\n    collapsible: true,\n    defaultCollapsed: true,\n  },\n};\n\n/**\n * 位置到 CSS 类的映射\n */\nexport const POSITION_CLASSES: Record<DevToolPosition, string> = {\n  'top-left': 'fixed top-4 left-4',\n  'top-right': 'fixed top-4 right-4',\n  'bottom-left': 'fixed bottom-4 left-4',\n  'bottom-right': 'fixed bottom-4 right-4',\n  'top-center': 'fixed top-4 left-1/2 -translate-x-1/2',\n  'bottom-center': 'fixed bottom-4 left-1/2 -translate-x-1/2',\n  'left-center': 'fixed left-4 top-1/2 -translate-y-1/2',\n  'right-center': 'fixed right-4 top-1/2 -translate-y-1/2',\n};\n\n/**\n * 尺寸到 CSS 类的映射\n */\nexport const SIZE_CLASSES: Record<DevToolSize, string> = {\n  small: 'max-w-xs',\n  medium: 'max-w-sm',\n  large: 'max-w-md',\n};\n\n/**\n * 获取开发工具的完整 CSS 类\n */\nexport function getDevToolClasses(toolId: string): string {\n  // eslint-disable-next-line security/detect-object-injection\n  const config = DEV_TOOLS_CONFIG[toolId]; // toolId 来自预定义配置，安全\n  if (!config) {\n    console.warn(`Dev tool config not found for: ${toolId}`);\n    return 'fixed bottom-4 right-4 z-50';\n  }\n\n  const positionClass =\n    POSITION_CLASSES[config.position as keyof typeof POSITION_CLASSES] ||\n    POSITION_CLASSES['bottom-right'];\n  const sizeClass =\n    SIZE_CLASSES[config.size as keyof typeof SIZE_CLASSES] ||\n    SIZE_CLASSES.medium;\n  const zIndexClass = `z-[${config.zIndex}]`;\n\n  return `${positionClass} ${sizeClass} ${zIndexClass}`;\n}\n\n/**\n * 获取开发工具的 z-index 值\n */\nexport function getDevToolZIndex(toolId: string): number {\n  const config = DEV_TOOLS_CONFIG[toolId as keyof typeof DEV_TOOLS_CONFIG];\n  return config?.zIndex || DEV_TOOLS_CONSTANTS.LAYOUT.DEFAULT_OFFSET;\n}\n\n/**\n * 检查开发工具是否应该默认折叠\n */\nexport function shouldDefaultCollapse(toolId: string): boolean {\n  const config = DEV_TOOLS_CONFIG[toolId as keyof typeof DEV_TOOLS_CONFIG];\n  return config?.defaultCollapsed || false;\n}\n\n/**\n * 获取开发工具的优先级\n */\nexport function getDevToolPriority(toolId: string): number {\n  const config = DEV_TOOLS_CONFIG[toolId as keyof typeof DEV_TOOLS_CONFIG];\n  return config?.priority || 1;\n}\n\n/**\n * 开发工具布局管理器\n */\nexport class DevToolsLayoutManager {\n  private static instance: DevToolsLayoutManager;\n  private activeTools: Set<string> = new Set();\n\n  static getInstance(): DevToolsLayoutManager {\n    if (!DevToolsLayoutManager.instance) {\n      DevToolsLayoutManager.instance = new DevToolsLayoutManager();\n    }\n    return DevToolsLayoutManager.instance;\n  }\n\n  /**\n   * 注册开发工具\n   */\n  registerTool(toolId: string): void {\n    this.activeTools.add(toolId);\n    this.optimizeLayout();\n  }\n\n  /**\n   * 注销开发工具\n   */\n  unregisterTool(toolId: string): void {\n    this.activeTools.delete(toolId);\n    this.optimizeLayout();\n  }\n\n  /**\n   * 优化布局，避免重叠\n   */\n  private optimizeLayout(): void {\n    // 按优先级排序活跃工具\n    const sortedTools = Array.from(this.activeTools).sort((a, b) => {\n      const priorityA = getDevToolPriority(a);\n      const priorityB = getDevToolPriority(b);\n      return priorityB - priorityA; // 降序排列\n    });\n\n    // 检测位置冲突并调整\n    const usedPositions = new Set<DevToolPosition>();\n\n    sortedTools.forEach((toolId) => {\n      const config = DEV_TOOLS_CONFIG[toolId as keyof typeof DEV_TOOLS_CONFIG];\n      if (!config) return;\n\n      if (usedPositions.has(config.position)) {\n        // 位置冲突，寻找替代位置\n        const alternativePosition = this.findAlternativePosition(\n          config.position,\n          usedPositions,\n        );\n        if (alternativePosition) {\n          // 临时调整位置（在实际应用中可能需要更复杂的状态管理）\n          console.warn(\n            `Dev tool ${toolId} position conflict, using alternative: ${alternativePosition}`,\n          );\n        }\n      } else {\n        usedPositions.add(config.position);\n      }\n    });\n  }\n\n  /**\n   * 寻找替代位置\n   */\n  private findAlternativePosition(\n    preferredPosition: DevToolPosition,\n    usedPositions: Set<DevToolPosition>,\n  ): DevToolPosition | null {\n    // 位置优先级映射\n    const alternatives: Record<DevToolPosition, DevToolPosition[]> = {\n      'bottom-right': ['right-center', 'bottom-center', 'top-right'],\n      'bottom-left': ['left-center', 'bottom-center', 'top-left'],\n      'top-right': ['right-center', 'top-center', 'bottom-right'],\n      'top-left': ['left-center', 'top-center', 'bottom-left'],\n      'top-center': ['top-right', 'top-left', 'bottom-center'],\n      'bottom-center': ['bottom-right', 'bottom-left', 'top-center'],\n      'left-center': ['bottom-left', 'top-left', 'right-center'],\n      'right-center': ['bottom-right', 'top-right', 'left-center'],\n    };\n\n    const alternativeList =\n      alternatives[preferredPosition as keyof typeof alternatives] || [];\n\n    for (const alternative of alternativeList) {\n      if (!usedPositions.has(alternative)) {\n        return alternative;\n      }\n    }\n\n    return null;\n  }\n\n  /**\n   * 获取所有活跃工具的布局信息\n   */\n  getLayoutInfo(): Array<{ toolId: string; config: DevToolConfig }> {\n    return Array.from(this.activeTools)\n      .map((toolId) => ({\n        toolId,\n        config: DEV_TOOLS_CONFIG[toolId as keyof typeof DEV_TOOLS_CONFIG],\n      }))\n      .filter((item): item is { toolId: string; config: DevToolConfig } =>\n        Boolean(item.config),\n      )\n      .sort((a, b) => b.config.priority - a.config.priority);\n  }\n}\n\n/**\n * React Hook for dev tools positioning\n */\nexport function useDevToolsLayout() {\n  const layoutManager = DevToolsLayoutManager.getInstance();\n\n  return {\n    registerTool: (toolId: string) => layoutManager.registerTool(toolId),\n    unregisterTool: (toolId: string) => layoutManager.unregisterTool(toolId),\n    getClasses: (toolId: string) => getDevToolClasses(toolId),\n    getZIndex: (toolId: string) => getDevToolZIndex(toolId),\n    shouldCollapse: (toolId: string) => shouldDefaultCollapse(toolId),\n    getLayoutInfo: () => layoutManager.getLayoutInfo(),\n  };\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/enhanced-web-vitals.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/footer-config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/i18n-analytics.ts","messages":[{"ruleId":"default-case","severity":2,"message":"Expected a default case.","line":143,"column":7,"nodeType":"SwitchStatement","messageId":"missingDefaultCase","endLine":156,"endColumn":8}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"interface I18nEvent {\n  type: 'locale_change' | 'translation_error' | 'fallback_used' | 'load_time';\n  locale: string;\n  timestamp: number;\n  metadata: Record<string, unknown>;\n  userId?: string;\n  sessionId: string;\n}\n\ninterface I18nMetrics {\n  localeUsage: Record<string, number>;\n  translationErrors: number;\n  fallbackUsage: number;\n  averageLoadTime: number;\n  userSatisfaction: number;\n}\n\nexport class I18nAnalytics {\n  private events: I18nEvent[] = [];\n  private sessionId: string;\n\n  constructor() {\n    this.sessionId = this.generateSessionId();\n    this.initializeTracking();\n  }\n\n  // 记录语言切换事件\n  trackLocaleChange(\n    fromLocale: string,\n    toLocale: string,\n    source: string,\n  ): void {\n    this.trackEvent({\n      type: 'locale_change',\n      locale: toLocale,\n      timestamp: Date.now(),\n      metadata: {\n        fromLocale,\n        source,\n        userAgent:\n          typeof navigator !== 'undefined' ? navigator.userAgent : 'unknown',\n        referrer:\n          typeof document !== 'undefined' ? document.referrer : 'unknown',\n      },\n      sessionId: this.sessionId,\n    });\n\n    // 发送到分析服务\n    this.sendToAnalytics('locale_change', {\n      from_locale: fromLocale,\n      to_locale: toLocale,\n      source,\n      session_id: this.sessionId,\n    });\n  }\n\n  // 记录翻译错误\n  trackTranslationError(key: string, locale: string, error: string): void {\n    this.trackEvent({\n      type: 'translation_error',\n      locale,\n      timestamp: Date.now(),\n      metadata: {\n        translationKey: key,\n        error,\n        url: typeof window !== 'undefined' ? window.location.href : 'unknown',\n      },\n      sessionId: this.sessionId,\n    });\n\n    // 发送错误报告\n    this.sendErrorReport({\n      type: 'translation_error',\n      key,\n      locale,\n      error,\n      url: typeof window !== 'undefined' ? window.location.href : 'unknown',\n      userAgent:\n        typeof navigator !== 'undefined' ? navigator.userAgent : 'unknown',\n      timestamp: new Date().toISOString(),\n    });\n  }\n\n  // 记录回退使用\n  trackFallbackUsage(\n    key: string,\n    locale: string,\n    fallbackLocale: string,\n  ): void {\n    this.trackEvent({\n      type: 'fallback_used',\n      locale,\n      timestamp: Date.now(),\n      metadata: {\n        translationKey: key,\n        fallbackLocale,\n        url: typeof window !== 'undefined' ? window.location.href : 'unknown',\n      },\n      sessionId: this.sessionId,\n    });\n  }\n\n  // 记录加载时间\n  trackLoadTime(locale: string, loadTime: number): void {\n    this.trackEvent({\n      type: 'load_time',\n      locale,\n      timestamp: Date.now(),\n      metadata: {\n        loadTime,\n        url: typeof window !== 'undefined' ? window.location.href : 'unknown',\n      },\n      sessionId: this.sessionId,\n    });\n\n    // 性能监控\n    if (loadTime > 1000) {\n      // 超过1秒\n      this.sendPerformanceAlert({\n        type: 'slow_translation_load',\n        locale,\n        loadTime,\n        url: typeof window !== 'undefined' ? window.location.href : 'unknown',\n        timestamp: new Date().toISOString(),\n      });\n    }\n  }\n\n  // 生成分析报告\n  generateReport(timeRange: { start: Date; end: Date }): I18nMetrics {\n    const filteredEvents = this.events.filter(\n      (event) =>\n        event.timestamp >= timeRange.start.getTime() &&\n        event.timestamp <= timeRange.end.getTime(),\n    );\n\n    const localeUsage: Record<string, number> = {};\n    let translationErrors = 0;\n    let fallbackUsage = 0;\n    const loadTimes: number[] = [];\n\n    for (const event of filteredEvents) {\n      switch (event.type) {\n        case 'locale_change':\n          localeUsage[event.locale] = (localeUsage[event.locale] || 0) + 1;\n          break;\n        case 'translation_error':\n          translationErrors += 1;\n          break;\n        case 'fallback_used':\n          fallbackUsage += 1;\n          break;\n        case 'load_time':\n          loadTimes.push(event.metadata.loadTime);\n          break;\n      }\n    }\n\n    const averageLoadTime =\n      loadTimes.length > 0\n        ? loadTimes.reduce((a, b) => a + b, 0) / loadTimes.length\n        : 0;\n\n    return {\n      localeUsage,\n      translationErrors,\n      fallbackUsage,\n      averageLoadTime,\n      userSatisfaction: this.calculateUserSatisfaction(filteredEvents),\n    };\n  }\n\n  // 实时监控仪表板数据\n  getRealTimeMetrics(): unknown {\n    const last24Hours = this.events.filter(\n      (event) => Date.now() - event.timestamp < 24 * 60 * 60 * 1000,\n    );\n\n    return {\n      activeUsers: new Set(last24Hours.map((e) => e.sessionId)).size,\n      localeDistribution: this.calculateLocaleDistribution(last24Hours),\n      errorRate: this.calculateErrorRate(last24Hours),\n      performanceScore: this.calculatePerformanceScore(last24Hours),\n    };\n  }\n\n  private async sendToAnalytics(eventType: string, data: unknown): Promise<void> {\n    try {\n      // Google Analytics 4\n      if (typeof window !== 'undefined' && 'gtag' in window) {\n        (window as unknown).gtag('event', eventType, data);\n      }\n\n      // 自定义分析服务\n      if (typeof fetch !== 'undefined') {\n        await fetch('/api/analytics/i18n', {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({ eventType, data, timestamp: Date.now() }),\n        });\n      }\n    } catch (error) {\n      console.error('Failed to send analytics:', error);\n    }\n  }\n\n  private async sendErrorReport(error: unknown): Promise<void> {\n    try {\n      if (typeof fetch !== 'undefined') {\n        await fetch('/api/errors/i18n', {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify(error),\n        });\n      }\n    } catch (err) {\n      console.error('Failed to send error report:', err);\n    }\n  }\n\n  private async sendPerformanceAlert(alert: unknown): Promise<void> {\n    try {\n      if (typeof fetch !== 'undefined') {\n        await fetch('/api/alerts/performance', {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify(alert),\n        });\n      }\n    } catch (error) {\n      console.error('Failed to send performance alert:', error);\n    }\n  }\n\n  private generateSessionId(): string {\n    return `session_${Date.now()}_${Math.random().toString(36).substring(2, 8)}`;\n  }\n\n  private initializeTracking(): void {\n    if (typeof window === 'undefined') return;\n\n    // 监听页面可见性变化\n    document.addEventListener('visibilitychange', () => {\n      if (document.hidden) {\n        this.flushEvents();\n      }\n    });\n\n    // 监听页面卸载\n    window.addEventListener('beforeunload', () => {\n      this.flushEvents();\n    });\n\n    // 定期刷新事件\n    setInterval(() => {\n      this.flushEvents();\n    }, 30000); // 30秒\n  }\n\n  private async flushEvents(): Promise<void> {\n    if (this.events.length === 0) return;\n\n    try {\n      if (typeof fetch !== 'undefined') {\n        await fetch('/api/analytics/i18n/batch', {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({ events: this.events }),\n        });\n\n        this.events = [];\n      }\n    } catch (error) {\n      console.error('Failed to flush events:', error);\n    }\n  }\n\n  private trackEvent(event: I18nEvent): void {\n    this.events.push(event);\n\n    // 限制内存中事件数量\n    if (this.events.length > 1000) {\n      this.events = this.events.slice(-500);\n    }\n  }\n\n  private calculateUserSatisfaction(events: I18nEvent[]): number {\n    // 基于错误率、加载时间等计算用户满意度\n    const errorEvents = events.filter(\n      (e) => e.type === 'translation_error',\n    ).length;\n    const totalEvents = events.length;\n    const errorRate = totalEvents > 0 ? errorEvents / totalEvents : 0;\n\n    return Math.max(0, 100 - errorRate * 100);\n  }\n\n  private calculateLocaleDistribution(\n    events: I18nEvent[],\n  ): Record<string, number> {\n    const distribution: Record<string, number> = {};\n\n    for (const event of events) {\n      distribution[event.locale] = (distribution[event.locale] || 0) + 1;\n    }\n\n    return distribution;\n  }\n\n  private calculateErrorRate(events: I18nEvent[]): number {\n    const errorEvents = events.filter(\n      (e) => e.type === 'translation_error',\n    ).length;\n    return events.length > 0 ? (errorEvents / events.length) * 100 : 0;\n  }\n\n  private calculatePerformanceScore(events: I18nEvent[]): number {\n    const loadTimeEvents = events.filter((e) => e.type === 'load_time');\n    if (loadTimeEvents.length === 0) return 100;\n\n    const avgLoadTime =\n      loadTimeEvents.reduce((sum, e) => sum + e.metadata.loadTime, 0) /\n      loadTimeEvents.length;\n\n    // 100ms = 100分，1000ms = 0分\n    return Math.max(0, 100 - avgLoadTime / 10);\n  }\n}\n\n// 全局实例\nexport const i18nAnalytics = new I18nAnalytics();\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/i18n-cache-manager.ts","messages":[{"ruleId":"no-undef","severity":2,"message":"'NodeJS' is not defined.","line":28,"column":33,"nodeType":"Identifier","messageId":"undef","endLine":28,"endColumn":39},{"ruleId":"no-undef","severity":2,"message":"'NodeJS' is not defined.","line":29,"column":29,"nodeType":"Identifier","messageId":"undef","endLine":29,"endColumn":35},{"ruleId":"require-await","severity":2,"message":"Async method 'getMessages' has no 'await' expression.","line":53,"column":3,"nodeType":"FunctionExpression","messageId":"missingAwait","endLine":53,"endColumn":20,"suggestions":[{"messageId":"removeAsync","fix":{"range":[1529,1535],"text":""},"desc":"Remove 'async'."}]},{"ruleId":"require-await","severity":2,"message":"Async method 'performHealthCheck' has no 'await' expression.","line":99,"column":3,"nodeType":"FunctionExpression","messageId":"missingAwait","endLine":99,"endColumn":27,"suggestions":[{"messageId":"removeAsync","fix":{"range":[2451,2457],"text":""},"desc":"Remove 'async'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'event' is defined but never used. Allowed unused args must match /^_/u.","line":238,"column":50,"nodeType":"Identifier","messageId":"unusedVar","endLine":238,"endColumn":80,"suggestions":[{"messageId":"removeVar","data":{"varName":"event"},"fix":{"range":[6008,6038],"text":""},"desc":"Remove unused variable 'event'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'event' is defined but never used. Allowed unused args must match /^_/u.","line":243,"column":53,"nodeType":"Identifier","messageId":"unusedVar","endLine":243,"endColumn":83,"suggestions":[{"messageId":"removeVar","data":{"varName":"event"},"fix":{"range":[6192,6222],"text":""},"desc":"Remove unused variable 'event'."}]}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 国际化缓存管理器\n *\n * 主缓存管理器，整合 LRU 缓存、预加载器和性能指标收集器\n */\n\nimport type { Locale, Messages, I18nMetrics } from '@/types/i18n';\nimport type {\n  CacheConfig,\n  CacheStats,\n  CacheManager,\n  CacheHealthCheck,\n  CacheDebugInfo,\n  PreloadConfig\n} from './i18n-cache-types';\nimport { CACHE_DURATIONS, CACHE_LIMITS } from '@/constants/i18n-constants';\nimport { I18nMetricsCollector } from './i18n-metrics-collector';\nimport { LRUCache } from './i18n-lru-cache';\nimport { TranslationPreloader } from './i18n-preloader';\nimport { logger } from '@/lib/logger';\n\n// 主缓存管理器实现\nexport class I18nCacheManager implements CacheManager {\n  private cache: LRUCache<Messages>;\n  private preloader: TranslationPreloader;\n  private metricsCollector: I18nMetricsCollector;\n  private config: CacheConfig;\n  private healthCheckInterval?: NodeJS.Timeout;\n  private cleanupInterval?: NodeJS.Timeout;\n\n  constructor(config?: Partial<CacheConfig>, preloadConfig?: Partial<PreloadConfig>) {\n    // 默认配置\n    const defaultConfig: CacheConfig = {\n      maxSize: CACHE_LIMITS.MAX_CACHE_ENTRIES,\n      ttl: CACHE_DURATIONS.PERFORMANCE_CACHE,\n      enablePersistence: true,\n      storageKey: 'i18n_cache',\n    };\n\n    this.config = { ...defaultConfig, ...config };\n    this.metricsCollector = new I18nMetricsCollector();\n    this.cache = new LRUCache<Messages>(this.config, this.metricsCollector);\n    this.preloader = new TranslationPreloader(\n      this.cache,\n      this.metricsCollector,\n      preloadConfig\n    );\n\n    this.setupPeriodicTasks();\n  }\n\n  // 获取消息\n  async getMessages(locale: Locale): Promise<Messages> {\n    this.metricsCollector.recordLocaleUsage(locale);\n    return this.preloader.preloadLocale(locale);\n  }\n\n  // 预加载消息\n  preloadMessages(locale: Locale): Promise<Messages> {\n    return this.preloader.preloadLocale(locale);\n  }\n\n  // 预热缓存\n  warmupCache(): void {\n    this.preloader.warmupCache();\n  }\n\n  // 获取性能指标\n  getMetrics(): I18nMetrics {\n    return this.metricsCollector.getMetrics();\n  }\n\n  // 获取缓存统计\n  getCacheStats(): CacheStats {\n    return this.cache.getStats();\n  }\n\n  // 清空缓存\n  clearCache(): void {\n    this.cache.clear();\n  }\n\n  // 重置指标\n  resetMetrics(): void {\n    this.metricsCollector.reset();\n  }\n\n  // 获取详细统计信息\n  getDetailedStats() {\n    return {\n      cache: this.cache.getDetailedStats(),\n      metrics: this.metricsCollector.getDetailedStats(),\n      preloader: this.preloader.getPreloadStats(),\n      config: this.config,\n    };\n  }\n\n  // 健康检查\n  async performHealthCheck(): Promise<CacheHealthCheck> {\n    const metrics = this.getMetrics();\n    const stats = this.getCacheStats();\n    const issues: string[] = [];\n    const recommendations: string[] = [];\n\n    // 检查缓存命中率\n    if (metrics.cacheHitRate < 70) {\n      issues.push('缓存命中率过低');\n      recommendations.push('考虑增加缓存大小或调整 TTL');\n    }\n\n    // 检查错误率\n    if (metrics.errorRate > 5) {\n      issues.push('错误率过高');\n      recommendations.push('检查网络连接和翻译文件完整性');\n    }\n\n    // 检查平均加载时间\n    if (metrics.loadTime > 200) {\n      issues.push('平均加载时间过长');\n      recommendations.push('启用预加载或优化翻译文件大小');\n    }\n\n    // 检查缓存利用率\n    const utilizationRate = (stats.size / this.config.maxSize) * 100;\n    if (utilizationRate > 90) {\n      issues.push('缓存接近满载');\n      recommendations.push('考虑增加缓存大小');\n    }\n\n    return {\n      isHealthy: issues.length === 0,\n      issues,\n      performance: {\n        hitRate: metrics.cacheHitRate,\n        averageLoadTime: metrics.loadTime,\n        errorRate: metrics.errorRate,\n      },\n      recommendations,\n    };\n  }\n\n  // 获取调试信息\n  getDebugInfo(): CacheDebugInfo {\n    return {\n      config: this.config,\n      stats: this.getCacheStats(),\n      metrics: this.getMetrics(),\n      recentEvents: [], // 可以从 metricsCollector 获取\n      memoryUsage: this.estimateMemoryUsage(),\n    };\n  }\n\n  // 优化缓存\n  async optimizeCache(): Promise<void> {\n    // 清理过期项\n    const cleanedCount = this.cache.cleanup();\n    logger.info('Cleaned expired cache entries', { cleanedCount });\n\n    // 基于使用模式调整配置\n    const metrics = this.getMetrics();\n    if (metrics.cacheHitRate < 80) {\n      // 如果命中率低，尝试智能预加载\n      await this.preloader.smartPreload();\n    }\n  }\n\n  // 导出缓存数据\n  exportCache(): string {\n    const data = {\n      version: '1.0',\n      timestamp: Date.now(),\n      config: this.config,\n      entries: Array.from(this.cache.entries()),\n      stats: this.getCacheStats(),\n      metrics: this.getMetrics(),\n    };\n\n    return JSON.stringify(data, null, 2);\n  }\n\n  // 导入缓存数据\n  importCache(data: string): void {\n    try {\n      const parsed = JSON.parse(data);\n\n      if (parsed.entries && Array.isArray(parsed.entries)) {\n        this.cache.clear();\n        parsed.entries.forEach(([key, value]: [string, Messages]) => {\n          this.cache.set(key, value);\n        });\n      }\n    } catch (error) {\n      logger.error('Failed to import cache data', { error: error as Error });\n      throw new Error('Invalid cache data format');\n    }\n  }\n\n  // 批量操作\n  async batchGetMessages(locales: Locale[]): Promise<Map<Locale, Messages>> {\n    const results = new Map<Locale, Messages>();\n\n    // 并行加载\n    const promises = locales.map(async (locale) => {\n      try {\n        const messages = await this.getMessages(locale);\n        results.set(locale, messages);\n      } catch (error) {\n        logger.error('Failed to load messages for locale', { locale, error: error as Error });\n      }\n    });\n\n    await Promise.all(promises);\n    return results;\n  }\n\n  // 预加载多个语言\n  async preloadMultipleLocales(locales: Locale[]): Promise<void> {\n    await this.preloader.preloadMultipleLocales(locales);\n  }\n\n  // 设置缓存配置\n  updateConfig(newConfig: Partial<CacheConfig>): void {\n    this.config = { ...this.config, ...newConfig };\n    // 注意：这里可能需要重新创建缓存实例以应用新配置\n  }\n\n  // 设置预加载配置\n  updatePreloadConfig(newConfig: Partial<PreloadConfig>): void {\n    this.preloader.setConfig(newConfig);\n  }\n\n  // 获取性能报告\n  generatePerformanceReport() {\n    return this.metricsCollector.generatePerformanceReport();\n  }\n\n  // 添加事件监听器\n  addEventListener(eventType: string, listener: (event: Record<string, unknown>) => void): void {\n    this.metricsCollector.addEventListener(eventType, listener);\n  }\n\n  // 移除事件监听器\n  removeEventListener(eventType: string, listener: (event: Record<string, unknown>) => void): void {\n    this.metricsCollector.removeEventListener(eventType, listener);\n  }\n\n  // 估算内存使用量\n  private estimateMemoryUsage() {\n    const cacheStats = this.cache.getDetailedStats();\n    return {\n      used: cacheStats.memoryUsage || 0,\n      total: this.config.maxSize * 1024, // 估算值\n      percentage: cacheStats.utilizationRate || 0,\n    };\n  }\n\n  // 设置定期任务\n  private setupPeriodicTasks(): void {\n    // 定期健康检查\n    this.healthCheckInterval = setInterval(async () => {\n      const health = await this.performHealthCheck();\n      if (!health.isHealthy) {\n        console.warn('Cache health check failed:', health.issues);\n      }\n    }, 5 * 60 * 1000); // 每5分钟检查一次\n\n    // 定期清理过期项\n    this.cleanupInterval = setInterval(() => {\n      this.cache.cleanup();\n    }, 10 * 60 * 1000); // 每10分钟清理一次\n  }\n\n  // 清理资源\n  destroy(): void {\n    if (this.healthCheckInterval) {\n      clearInterval(this.healthCheckInterval);\n    }\n\n    if (this.cleanupInterval) {\n      clearInterval(this.cleanupInterval);\n    }\n\n    this.preloader.cleanup();\n    this.cache.clear();\n  }\n\n  // 获取缓存键\n  getCacheKey(locale: Locale, namespace?: string): string {\n    return namespace ? `${locale}:${namespace}` : locale;\n  }\n\n  // 检查缓存是否存在\n  hasMessages(locale: Locale, namespace?: string): boolean {\n    const key = this.getCacheKey(locale, namespace);\n    return this.cache.has(key);\n  }\n\n  // 删除特定语言的缓存\n  deleteMessages(locale: Locale, namespace?: string): boolean {\n    const key = this.getCacheKey(locale, namespace);\n    return this.cache.delete(key);\n  }\n\n  // 获取所有缓存的语言\n  getCachedLocales(): Locale[] {\n    const keys = Array.from(this.cache.keys());\n    return [...new Set(keys.map(key => key.split(':')[0] as Locale))];\n  }\n\n  // 获取缓存大小（字节）\n  getCacheSize(): number {\n    return this.cache.getDetailedStats().memoryUsage || 0;\n  }\n\n  // 检查是否正在预加载\n  isPreloading(): boolean {\n    return this.preloader.isPreloading();\n  }\n\n  // 获取预加载进度\n  getPreloadProgress(): number {\n    return this.preloader.getPreloadProgress();\n  }\n\n  // 停止预加载\n  stopPreloading(): void {\n    this.preloader.stopPreloading();\n  }\n}\n\n// 全局缓存实例\nexport const i18nCache = new I18nCacheManager();\n\n// 初始化缓存预热\nif (typeof window !== 'undefined') {\n  // 在浏览器环境中预热缓存\n  i18nCache.warmupCache();\n}\n\n// 创建缓存管理器的工厂函数\nexport function createI18nCacheManager(\n  config?: Partial<CacheConfig>,\n  preloadConfig?: Partial<PreloadConfig>\n): I18nCacheManager {\n  return new I18nCacheManager(config, preloadConfig);\n}\n\n// 导出类型别名\nexport type {\n  I18nCacheManager as CacheManager,\n};\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/i18n-cache-types-advanced.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'items' is defined but never used. Allowed unused args must match /^_/u.","line":43,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":43,"endColumn":94,"suggestions":[{"messageId":"removeVar","data":{"varName":"items"},"fix":{"range":[975,1040],"text":""},"desc":"Remove unused variable 'items'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'key' is defined but never used. Allowed unused args must match /^_/u.","line":90,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":90,"endColumn":40,"suggestions":[{"messageId":"removeVar","data":{"varName":"key"},"fix":{"range":[2018,2029],"text":""},"desc":"Remove unused variable 'key'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'context' is defined but never used. Allowed unused args must match /^_/u.","line":104,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":104,"endColumn":49,"suggestions":[{"messageId":"removeVar","data":{"varName":"context"},"fix":{"range":[2286,2318],"text":""},"desc":"Remove unused variable 'context'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'cache' is defined but never used. Allowed unused args must match /^_/u.","line":105,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":105,"endColumn":29,"suggestions":[{"messageId":"removeVar","data":{"varName":"cache"},"fix":{"range":[2346,2360],"text":""},"desc":"Remove unused variable 'cache'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'key' is defined but never used. Allowed unused args must match /^_/u.","line":141,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":141,"endColumn":28,"suggestions":[{"messageId":"removeVar","data":{"varName":"key"},"fix":{"range":[3108,3120],"text":""},"desc":"Remove unused variable 'key'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'value' is defined but never used. Allowed unused args must match /^_/u.","line":141,"column":30,"nodeType":"Identifier","messageId":"unusedVar","endLine":141,"endColumn":44,"suggestions":[{"messageId":"removeVar","data":{"varName":"value"},"fix":{"range":[3119,3135],"text":""},"desc":"Remove unused variable 'value'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'local' is defined but never used. Allowed unused args must match /^_/u.","line":153,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":153,"endColumn":43,"suggestions":[{"messageId":"removeVar","data":{"varName":"local"},"fix":{"range":[3455,3470],"text":""},"desc":"Remove unused variable 'local'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'remote' is defined but never used. Allowed unused args must match /^_/u.","line":153,"column":45,"nodeType":"Identifier","messageId":"unusedVar","endLine":153,"endColumn":60,"suggestions":[{"messageId":"removeVar","data":{"varName":"remote"},"fix":{"range":[3469,3486],"text":""},"desc":"Remove unused variable 'remote'."}]}],"suppressedMessages":[],"errorCount":8,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 国际化缓存高级配置和功能\n * I18n Cache Advanced Configuration and Features\n * \n * 提供缓存系统的高级配置选项、策略和扩展功能\n */\n\nimport type { Locale } from '@/types/i18n';\nimport type {\n  CacheCompressionConfig,\n  CacheEncryptionConfig,\n  CacheMonitoringConfig,\n  CacheBackupConfig,\n  CachePerformanceConfig,\n  CacheSecurityConfig,\n  CachePartitionConfig,\n  CacheSyncOptions,\n} from './i18n-cache-types-interfaces';\n\n/**\n * 高级缓存配置\n * Advanced cache configuration\n */\nexport interface AdvancedCacheConfig {\n  // 基础配置\n  maxSize: number;\n  ttl: number;\n  enablePersistence: boolean;\n  storageKey: string;\n  \n  // 高级功能配置\n  compression: CacheCompressionConfig;\n  encryption: CacheEncryptionConfig;\n  monitoring: CacheMonitoringConfig;\n  backup: CacheBackupConfig;\n  performance: CachePerformanceConfig;\n  security: CacheSecurityConfig;\n  partitioning: CachePartitionConfig;\n  sync: CacheSyncOptions;\n  \n  // 策略配置\n  evictionStrategy: 'lru' | 'lfu' | 'fifo' | 'ttl' | 'custom';\n  customEvictionStrategy?: (items: Array<{ key: string; lastAccessed: number; hits: number }>) => string[];\n  \n  // 预加载配置\n  preload: {\n    enabled: boolean;\n    locales: Locale[];\n    batchSize: number;\n    delayBetweenBatches: number;\n    warmupOnInit: boolean;\n    prefetchThreshold: number;\n  };\n  \n  // 调试和开发配置\n  debug: {\n    enabled: boolean;\n    logLevel: 'error' | 'warn' | 'info' | 'debug';\n    logOperations: boolean;\n    trackMetrics: boolean;\n  };\n}\n\n/**\n * 缓存集群配置\n * Cache cluster configuration\n */\nexport interface CacheClusterConfig {\n  enabled: boolean;\n  nodes: Array<{\n    id: string;\n    host: string;\n    port: number;\n    weight: number;\n  }>;\n  replicationFactor: number;\n  consistencyLevel: 'eventual' | 'strong' | 'weak';\n  failoverStrategy: 'round_robin' | 'weighted' | 'least_connections';\n  healthCheckInterval: number;\n}\n\n/**\n * 缓存分片配置\n * Cache sharding configuration\n */\nexport interface CacheShardingConfig {\n  enabled: boolean;\n  shardCount: number;\n  shardingStrategy: 'hash' | 'range' | 'directory' | 'custom';\n  customShardingFunction?: (key: string) => number;\n  rebalanceThreshold: number;\n  autoRebalance: boolean;\n}\n\n/**\n * 缓存预热配置\n * Cache warming configuration\n */\nexport interface CacheWarmingConfig {\n  enabled: boolean;\n  strategies: Array<{\n    name: string;\n    priority: number;\n    condition: (context: Record<string, unknown>) => boolean;\n    execute: (cache: unknown) => Promise<void>;\n  }>;\n  schedules: Array<{\n    cron: string;\n    strategy: string;\n    enabled: boolean;\n  }>;\n  maxConcurrency: number;\n  timeout: number;\n}\n\n/**\n * 缓存失效配置\n * Cache invalidation configuration\n */\nexport interface CacheInvalidationConfig {\n  enabled: boolean;\n  strategies: {\n    timeBasedInvalidation: {\n      enabled: boolean;\n      checkInterval: number;\n      batchSize: number;\n    };\n    eventBasedInvalidation: {\n      enabled: boolean;\n      events: string[];\n      debounceTime: number;\n    };\n    dependencyBasedInvalidation: {\n      enabled: boolean;\n      dependencyGraph: Record<string, string[]>;\n      cascadeInvalidation: boolean;\n    };\n  };\n  customInvalidationRules: Array<{\n    name: string;\n    condition: (key: string, value: unknown) => boolean;\n    action: 'delete' | 'refresh' | 'mark_stale';\n  }>;\n}\n\n/**\n * 缓存一致性配置\n * Cache consistency configuration\n */\nexport interface CacheConsistencyConfig {\n  level: 'eventual' | 'strong' | 'weak';\n  conflictResolution: 'last_write_wins' | 'first_write_wins' | 'merge' | 'custom';\n  customConflictResolver?: (local: unknown, remote: unknown) => unknown;\n  versioningStrategy: 'timestamp' | 'vector_clock' | 'sequence' | 'custom';\n  maxVersionHistory: number;\n}\n\n/**\n * 缓存限流配置\n * Cache rate limiting configuration\n */\nexport interface CacheRateLimitConfig {\n  enabled: boolean;\n  rules: Array<{\n    name: string;\n    pattern: string; // Key pattern (regex)\n    limit: number; // Requests per window\n    window: number; // Time window in milliseconds\n    action: 'block' | 'delay' | 'degrade';\n    priority: number;\n  }>;\n  globalLimit: {\n    enabled: boolean;\n    maxRequestsPerSecond: number;\n    burstSize: number;\n  };\n  adaptiveThrottling: {\n    enabled: boolean;\n    cpuThreshold: number;\n    memoryThreshold: number;\n    responseTimeThreshold: number;\n  };\n}\n\n/**\n * 缓存质量配置\n * Cache quality configuration\n */\nexport interface CacheQualityConfig {\n  dataValidation: {\n    enabled: boolean;\n    schemas: Record<string, unknown>;\n    strictMode: boolean;\n    sanitization: boolean;\n  };\n  integrityChecks: {\n    enabled: boolean;\n    checksumAlgorithm: 'md5' | 'sha1' | 'sha256';\n    verifyOnRead: boolean;\n    verifyOnWrite: boolean;\n  };\n  qualityMetrics: {\n    enabled: boolean;\n    trackDataFreshness: boolean;\n    trackDataAccuracy: boolean;\n    trackDataCompleteness: boolean;\n  };\n}\n\n/**\n * 缓存扩展配置\n * Cache extension configuration\n */\nexport interface CacheExtensionConfig {\n  plugins: Array<{\n    name: string;\n    version: string;\n    enabled: boolean;\n    config: Record<string, unknown>;\n  }>;\n  middleware: Array<{\n    name: string;\n    order: number;\n    enabled: boolean;\n    config: Record<string, unknown>;\n  }>;\n  hooks: {\n    beforeGet: string[];\n    afterGet: string[];\n    beforeSet: string[];\n    afterSet: string[];\n    beforeDelete: string[];\n    afterDelete: string[];\n  };\n}\n\n/**\n * 缓存环境配置\n * Cache environment configuration\n */\nexport interface CacheEnvironmentConfig {\n  development: Partial<AdvancedCacheConfig>;\n  staging: Partial<AdvancedCacheConfig>;\n  production: Partial<AdvancedCacheConfig>;\n  test: Partial<AdvancedCacheConfig>;\n}\n\n/**\n * 默认高级缓存配置\n * Default advanced cache configuration\n */\nexport const DEFAULT_ADVANCED_CACHE_CONFIG: AdvancedCacheConfig = {\n  // 基础配置\n  maxSize: 1000,\n  ttl: 5 * 60 * 1000,\n  enablePersistence: true,\n  storageKey: 'i18n_cache',\n  \n  // 压缩配置\n  compression: {\n    enableCompression: false,\n    algorithm: 'gzip',\n    threshold: 1024,\n    level: 6,\n  },\n  \n  // 加密配置\n  encryption: {\n    enableEncryption: false,\n    algorithm: 'aes-256-gcm',\n    keyDerivation: 'pbkdf2',\n    saltLength: 16,\n  },\n  \n  // 监控配置\n  monitoring: {\n    enableMonitoring: true,\n    metricsInterval: 60000,\n    alertThresholds: {\n      hitRateBelow: 0.8,\n      errorRateAbove: 0.05,\n      loadTimeAbove: 1000,\n    },\n  },\n  \n  // 备份配置\n  backup: {\n    enableBackup: false,\n    backupInterval: 24 * 60 * 60 * 1000,\n    maxBackups: 7,\n    backupLocation: './cache-backups',\n    compressionEnabled: true,\n  },\n  \n  // 性能配置\n  performance: {\n    enableLazyLoading: true,\n    prefetchThreshold: 0.8,\n    maxConcurrentLoads: 5,\n    loadTimeout: 10000,\n    retryAttempts: 3,\n    retryDelay: 1000,\n  },\n  \n  // 安全配置\n  security: {\n    enableAccessControl: false,\n    allowedOrigins: [],\n    maxKeyLength: 256,\n    maxValueSize: 1024 * 1024,\n    sanitizeKeys: true,\n    validateValues: true,\n  },\n  \n  // 分区配置\n  partitioning: {\n    enablePartitioning: false,\n    partitionKey: (key: string) => key.split(':')[0],\n    maxPartitions: 10,\n    partitionStrategy: 'hash',\n  },\n  \n  // 同步配置\n  sync: {\n    enableSync: false,\n    syncInterval: 30000,\n    conflictResolution: 'local',\n  },\n  \n  // 策略配置\n  evictionStrategy: 'lru',\n  \n  // 预加载配置\n  preload: {\n    enabled: true,\n    locales: ['en', 'zh'],\n    batchSize: 5,\n    delayBetweenBatches: 100,\n    warmupOnInit: false,\n    prefetchThreshold: 0.8,\n  },\n  \n  // 调试配置\n  debug: {\n    enabled: process.env.NODE_ENV === 'development',\n    logLevel: 'warn',\n    logOperations: false,\n    trackMetrics: true,\n  },\n};\n\n/**\n * 缓存配置工厂\n * Cache configuration factory\n */\nexport class CacheConfigFactory {\n  /**\n   * 创建开发环境配置\n   * Create development configuration\n   */\n  static createDevelopmentConfig(): AdvancedCacheConfig {\n    return {\n      ...DEFAULT_ADVANCED_CACHE_CONFIG,\n      debug: {\n        enabled: true,\n        logLevel: 'debug',\n        logOperations: true,\n        trackMetrics: true,\n      },\n      monitoring: {\n        ...DEFAULT_ADVANCED_CACHE_CONFIG.monitoring,\n        metricsInterval: 10000,\n      },\n    };\n  }\n\n  /**\n   * 创建生产环境配置\n   * Create production configuration\n   */\n  static createProductionConfig(): AdvancedCacheConfig {\n    return {\n      ...DEFAULT_ADVANCED_CACHE_CONFIG,\n      compression: {\n        enableCompression: true,\n        algorithm: 'gzip',\n        threshold: 512,\n        level: 6,\n      },\n      encryption: {\n        enableEncryption: true,\n        algorithm: 'aes-256-gcm',\n        keyDerivation: 'pbkdf2',\n        saltLength: 32,\n      },\n      backup: {\n        enableBackup: true,\n        backupInterval: 6 * 60 * 60 * 1000, // 6 hours\n        maxBackups: 14,\n        backupLocation: './cache-backups',\n        compressionEnabled: true,\n      },\n      debug: {\n        enabled: false,\n        logLevel: 'error',\n        logOperations: false,\n        trackMetrics: true,\n      },\n    };\n  }\n\n  /**\n   * 创建测试环境配置\n   * Create test configuration\n   */\n  static createTestConfig(): AdvancedCacheConfig {\n    return {\n      ...DEFAULT_ADVANCED_CACHE_CONFIG,\n      maxSize: 100,\n      ttl: 1000,\n      enablePersistence: false,\n      monitoring: {\n        ...DEFAULT_ADVANCED_CACHE_CONFIG.monitoring,\n        enableMonitoring: false,\n      },\n      debug: {\n        enabled: false,\n        logLevel: 'error',\n        logOperations: false,\n        trackMetrics: false,\n      },\n    };\n  }\n\n  /**\n   * 合并配置\n   * Merge configurations\n   */\n  static mergeConfigs(base: AdvancedCacheConfig, override: Partial<AdvancedCacheConfig>): AdvancedCacheConfig {\n    return {\n      ...base,\n      ...override,\n      compression: { ...base.compression, ...override.compression },\n      encryption: { ...base.encryption, ...override.encryption },\n      monitoring: { ...base.monitoring, ...override.monitoring },\n      backup: { ...base.backup, ...override.backup },\n      performance: { ...base.performance, ...override.performance },\n      security: { ...base.security, ...override.security },\n      partitioning: { ...base.partitioning, ...override.partitioning },\n      sync: { ...base.sync, ...override.sync },\n      preload: { ...base.preload, ...override.preload },\n      debug: { ...base.debug, ...override.debug },\n    };\n  }\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/i18n-cache-types-base.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'Messages' is defined but never used. Allowed unused vars must match /^_/u.","line":8,"column":36,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":44,"suggestions":[{"messageId":"removeVar","data":{"varName":"Messages"},"fix":{"range":[122,132],"text":""},"desc":"Remove unused variable 'Messages'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Messages' is defined but never used. Allowed unused vars must match /^_/u.","line":8,"column":36,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":44},{"ruleId":"no-unused-vars","severity":2,"message":"'event' is defined but never used. Allowed unused args must match /^_/u.","line":96,"column":48,"nodeType":"Identifier","messageId":"unusedVar","endLine":96,"endColumn":68,"suggestions":[{"messageId":"removeVar","data":{"varName":"event"},"fix":{"range":[1475,1495],"text":""},"desc":"Remove unused variable 'event'."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 国际化缓存基础类型定义\n * I18n Cache Base Type Definitions\n * \n * 提供缓存系统所需的基础类型、接口和常量定义\n */\n\nimport type { I18nMetrics, Locale, Messages } from '@/types/i18n';\n\n/**\n * 缓存配置接口\n * Cache configuration interface\n */\nexport interface CacheConfig {\n  maxSize: number;\n  ttl: number; // Time to live in milliseconds\n  enablePersistence: boolean;\n  storageKey: string;\n}\n\n/**\n * 缓存项接口\n * Cache item interface\n */\nexport interface CacheItem<T> {\n  data: T;\n  timestamp: number;\n  ttl: number;\n  hits: number;\n}\n\n/**\n * 缓存统计信息\n * Cache statistics\n */\nexport interface CacheStats {\n  size: number;\n  totalHits: number;\n  averageAge: number;\n}\n\n/**\n * 预加载配置\n * Preload configuration\n */\nexport interface PreloadConfig {\n  enablePreload: boolean;\n  preloadLocales: Locale[];\n  batchSize: number;\n  delayBetweenBatches: number;\n}\n\n/**\n * 缓存操作结果\n * Cache operation result\n */\nexport interface CacheOperationResult<T> {\n  success: boolean;\n  data?: T;\n  error?: string;\n  fromCache: boolean;\n  loadTime?: number;\n}\n\n/**\n * 缓存事件类型\n * Cache event types\n */\nexport type CacheEventType = \n  | 'hit'\n  | 'miss'\n  | 'set'\n  | 'delete'\n  | 'clear'\n  | 'expire'\n  | 'preload_start'\n  | 'preload_complete'\n  | 'preload_error';\n\n/**\n * 缓存事件\n * Cache event\n */\nexport interface CacheEvent<T = unknown> {\n  type: CacheEventType;\n  key?: string;\n  data?: T;\n  timestamp: number;\n  metadata?: Record<string, unknown>;\n}\n\n/**\n * 缓存监听器\n * Cache event listener\n */\nexport type CacheEventListener<T = unknown> = (event: CacheEvent<T>) => void;\n\n/**\n * 缓存策略\n * Cache strategy\n */\nexport type CacheStrategy = 'lru' | 'lfu' | 'fifo' | 'ttl';\n\n/**\n * 缓存配置验证\n * Cache configuration validation\n */\nexport interface CacheConfigValidation {\n  isValid: boolean;\n  errors: string[];\n  warnings: string[];\n}\n\n/**\n * 缓存健康检查\n * Cache health check\n */\nexport interface CacheHealthCheck {\n  isHealthy: boolean;\n  issues: string[];\n  performance: {\n    hitRate: number;\n    averageLoadTime: number;\n    errorRate: number;\n  };\n  recommendations: string[];\n}\n\n/**\n * 缓存调试信息\n * Cache debug information\n */\nexport interface CacheDebugInfo {\n  config: CacheConfig;\n  stats: CacheStats;\n  metrics: I18nMetrics;\n  recentEvents: CacheEvent[];\n  memoryUsage?: {\n    used: number;\n    total: number;\n    percentage: number;\n  };\n}\n\n/**\n * 默认缓存配置\n * Default cache configuration\n */\nexport const DEFAULT_CACHE_CONFIG: CacheConfig = {\n  maxSize: 1000,\n  ttl: 5 * 60 * 1000, // 5 minutes\n  enablePersistence: true,\n  storageKey: 'i18n_cache',\n};\n\n/**\n * 默认预加载配置\n * Default preload configuration\n */\nexport const DEFAULT_PRELOAD_CONFIG: PreloadConfig = {\n  enablePreload: true,\n  preloadLocales: ['en', 'zh'],\n  batchSize: 5,\n  delayBetweenBatches: 100,\n};\n\n/**\n * 缓存常量\n * Cache constants\n */\nexport const CACHE_CONSTANTS = {\n  MIN_TTL: 1000, // 1 second\n  MAX_TTL: 24 * 60 * 60 * 1000, // 24 hours\n  MIN_CACHE_SIZE: 10,\n  MAX_CACHE_SIZE: 10000,\n  DEFAULT_BATCH_SIZE: 5,\n  MAX_CONCURRENT_LOADS: 10,\n  METRICS_RESET_INTERVAL: 60 * 60 * 1000, // 1 hour\n  HEALTH_CHECK_INTERVAL: 5 * 60 * 1000, // 5 minutes\n} as const;\n\n/**\n * 缓存错误类型\n * Cache error types\n */\nexport class CacheError extends Error {\n  public readonly code: string;\n  public readonly details?: Record<string, unknown>;\n\n  constructor(message: string, code: string = 'CACHE_ERROR', details?: Record<string, unknown>) {\n    super(message);\n    this.name = 'CacheError';\n    this.code = code;\n    this.details = details;\n  }\n}\n\n/**\n * 缓存验证错误\n * Cache validation error\n */\nexport class CacheValidationError extends CacheError {\n  constructor(message: string, details?: Record<string, unknown>) {\n    super(message, 'CACHE_VALIDATION_ERROR', details);\n    this.name = 'CacheValidationError';\n  }\n}\n\n/**\n * 缓存存储错误\n * Cache storage error\n */\nexport class CacheStorageError extends CacheError {\n  constructor(message: string, details?: Record<string, unknown>) {\n    super(message, 'CACHE_STORAGE_ERROR', details);\n    this.name = 'CacheStorageError';\n  }\n}\n\n/**\n * 缓存序列化错误\n * Cache serialization error\n */\nexport class CacheSerializationError extends CacheError {\n  constructor(message: string, details?: Record<string, unknown>) {\n    super(message, 'CACHE_SERIALIZATION_ERROR', details);\n    this.name = 'CacheSerializationError';\n  }\n}\n\n/**\n * 类型守卫函数\n * Type guard functions\n */\nexport function isCacheItem<T>(value: unknown): value is CacheItem<T> {\n  return (\n    typeof value === 'object' &&\n    value !== null &&\n    'data' in value &&\n    'timestamp' in value &&\n    'ttl' in value &&\n    'hits' in value\n  );\n}\n\nexport function isCacheConfig(value: unknown): value is CacheConfig {\n  return (\n    typeof value === 'object' &&\n    value !== null &&\n    'maxSize' in value &&\n    'ttl' in value &&\n    'enablePersistence' in value &&\n    'storageKey' in value\n  );\n}\n\nexport function isCacheEvent(value: unknown): value is CacheEvent {\n  return (\n    typeof value === 'object' &&\n    value !== null &&\n    'type' in value &&\n    'timestamp' in value\n  );\n}\n\n/**\n * 基础工具函数\n * Basic utility functions\n */\nexport function createCacheKey(locale: Locale, namespace?: string, key?: string): string {\n  const parts = [locale];\n  if (namespace) parts.push(namespace);\n  if (key) parts.push(key);\n  return parts.join(':');\n}\n\nexport function parseCacheKey(cacheKey: string): { locale: Locale; namespace?: string; key?: string } {\n  const parts = cacheKey.split(':');\n  return {\n    locale: parts[0] as Locale,\n    namespace: parts[1],\n    key: parts[2],\n  };\n}\n\n/**\n * 缓存配置验证函数\n * Cache configuration validation function\n */\nexport function validateCacheConfig(config: Partial<CacheConfig>): CacheConfigValidation {\n  const errors: string[] = [];\n  const warnings: string[] = [];\n\n  if (config.maxSize !== undefined) {\n    if (config.maxSize < CACHE_CONSTANTS.MIN_CACHE_SIZE) {\n      errors.push(`maxSize must be at least ${CACHE_CONSTANTS.MIN_CACHE_SIZE}`);\n    }\n    if (config.maxSize > CACHE_CONSTANTS.MAX_CACHE_SIZE) {\n      errors.push(`maxSize must not exceed ${CACHE_CONSTANTS.MAX_CACHE_SIZE}`);\n    }\n  }\n\n  if (config.ttl !== undefined) {\n    if (config.ttl < CACHE_CONSTANTS.MIN_TTL) {\n      errors.push(`ttl must be at least ${CACHE_CONSTANTS.MIN_TTL}ms`);\n    }\n    if (config.ttl > CACHE_CONSTANTS.MAX_TTL) {\n      warnings.push(`ttl is very high (${config.ttl}ms), consider reducing it`);\n    }\n  }\n\n  if (config.storageKey !== undefined) {\n    if (typeof config.storageKey !== 'string' || config.storageKey.length === 0) {\n      errors.push('storageKey must be a non-empty string');\n    }\n  }\n\n  if (config.enablePersistence !== undefined) {\n    if (typeof config.enablePersistence !== 'boolean') {\n      errors.push('enablePersistence must be a boolean');\n    }\n  }\n\n  return {\n    isValid: errors.length === 0,\n    errors,\n    warnings,\n  };\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/i18n-cache-types-interfaces.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'key' is defined but never used. Allowed unused args must match /^_/u.","line":16,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":18,"suggestions":[{"messageId":"removeVar","data":{"varName":"key"},"fix":{"range":[319,330],"text":""},"desc":"Remove unused variable 'key'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'key' is defined but never used. Allowed unused args must match /^_/u.","line":17,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":18,"suggestions":[{"messageId":"removeVar","data":{"varName":"key"},"fix":{"range":[349,361],"text":""},"desc":"Remove unused variable 'key'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'value' is defined but never used. Allowed unused args must match /^_/u.","line":17,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":28,"suggestions":[{"messageId":"removeVar","data":{"varName":"value"},"fix":{"range":[360,370],"text":""},"desc":"Remove unused variable 'value'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'ttl' is defined but never used. Allowed unused args must match /^_/u.","line":17,"column":30,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":42,"suggestions":[{"messageId":"removeVar","data":{"varName":"ttl"},"fix":{"range":[370,384],"text":""},"desc":"Remove unused variable 'ttl'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'key' is defined but never used. Allowed unused args must match /^_/u.","line":18,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":18,"suggestions":[{"messageId":"removeVar","data":{"varName":"key"},"fix":{"range":[399,410],"text":""},"desc":"Remove unused variable 'key'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'key' is defined but never used. Allowed unused args must match /^_/u.","line":19,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"key"},"fix":{"range":[431,442],"text":""},"desc":"Remove unused variable 'key'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'key' is defined but never used. Allowed unused args must match /^_/u.","line":32,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":32,"endColumn":19,"suggestions":[{"messageId":"removeVar","data":{"varName":"key"},"fix":{"range":[700,711],"text":""},"desc":"Remove unused variable 'key'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'key' is defined but never used. Allowed unused args must match /^_/u.","line":33,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":33,"endColumn":19,"suggestions":[{"messageId":"removeVar","data":{"varName":"key"},"fix":{"range":[749,761],"text":""},"desc":"Remove unused variable 'key'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'data' is defined but never used. Allowed unused args must match /^_/u.","line":33,"column":21,"nodeType":"Identifier","messageId":"unusedVar","endLine":33,"endColumn":34,"suggestions":[{"messageId":"removeVar","data":{"varName":"data"},"fix":{"range":[760,775],"text":""},"desc":"Remove unused variable 'data'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'key' is defined but never used. Allowed unused args must match /^_/u.","line":34,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":34,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"key"},"fix":{"range":[809,820],"text":""},"desc":"Remove unused variable 'key'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'time' is defined but never used. Allowed unused args must match /^_/u.","line":43,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":43,"endColumn":30,"suggestions":[{"messageId":"removeVar","data":{"varName":"time"},"fix":{"range":[984,996],"text":""},"desc":"Remove unused variable 'time'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'locale' is defined but never used. Allowed unused args must match /^_/u.","line":47,"column":21,"nodeType":"Identifier","messageId":"unusedVar","endLine":47,"endColumn":35,"suggestions":[{"messageId":"removeVar","data":{"varName":"locale"},"fix":{"range":[1101,1115],"text":""},"desc":"Remove unused variable 'locale'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'locale' is defined but never used. Allowed unused args must match /^_/u.","line":57,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":57,"endColumn":31,"suggestions":[{"messageId":"removeVar","data":{"varName":"locale"},"fix":{"range":[1259,1273],"text":""},"desc":"Remove unused variable 'locale'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'locale' is defined but never used. Allowed unused args must match /^_/u.","line":68,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":68,"endColumn":29,"suggestions":[{"messageId":"removeVar","data":{"varName":"locale"},"fix":{"range":[1472,1486],"text":""},"desc":"Remove unused variable 'locale'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'locale' is defined but never used. Allowed unused args must match /^_/u.","line":69,"column":19,"nodeType":"Identifier","messageId":"unusedVar","endLine":69,"endColumn":33,"suggestions":[{"messageId":"removeVar","data":{"varName":"locale"},"fix":{"range":[1526,1540],"text":""},"desc":"Remove unused variable 'locale'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'key' is defined but never used. Allowed unused args must match /^_/u.","line":125,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":125,"endColumn":29,"suggestions":[{"messageId":"removeVar","data":{"varName":"key"},"fix":{"range":[2575,2586],"text":""},"desc":"Remove unused variable 'key'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'progress' is defined but never used. Allowed unused args must match /^_/u.","line":187,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":187,"endColumn":33,"suggestions":[{"messageId":"removeVar","data":{"varName":"progress"},"fix":{"range":[3906,3922],"text":""},"desc":"Remove unused variable 'progress'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'key' is defined but never used. Allowed unused args must match /^_/u.","line":221,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":221,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"key"},"fix":{"range":[4538,4550],"text":""},"desc":"Remove unused variable 'key'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'data' is defined but never used. Allowed unused args must match /^_/u.","line":221,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":221,"endColumn":40,"suggestions":[{"messageId":"removeVar","data":{"varName":"data"},"fix":{"range":[4549,4564],"text":""},"desc":"Remove unused variable 'data'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'key' is defined but never used. Allowed unused args must match /^_/u.","line":222,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":222,"endColumn":26,"suggestions":[{"messageId":"removeVar","data":{"varName":"key"},"fix":{"range":[4587,4598],"text":""},"desc":"Remove unused variable 'key'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'key' is defined but never used. Allowed unused args must match /^_/u.","line":223,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":223,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"key"},"fix":{"range":[4620,4632],"text":""},"desc":"Remove unused variable 'key'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'data' is defined but never used. Allowed unused args must match /^_/u.","line":223,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":223,"endColumn":40,"suggestions":[{"messageId":"removeVar","data":{"varName":"data"},"fix":{"range":[4631,4646],"text":""},"desc":"Remove unused variable 'data'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'key' is defined but never used. Allowed unused args must match /^_/u.","line":224,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":224,"endColumn":28,"suggestions":[{"messageId":"removeVar","data":{"varName":"key"},"fix":{"range":[4671,4682],"text":""},"desc":"Remove unused variable 'key'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used. Allowed unused args must match /^_/u.","line":226,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":226,"endColumn":28,"suggestions":[{"messageId":"removeVar","data":{"varName":"error"},"fix":{"range":[4730,4743],"text":""},"desc":"Remove unused variable 'error'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'operation' is defined but never used. Allowed unused args must match /^_/u.","line":226,"column":30,"nodeType":"Identifier","messageId":"unusedVar","endLine":226,"endColumn":47,"suggestions":[{"messageId":"removeVar","data":{"varName":"operation"},"fix":{"range":[4742,4761],"text":""},"desc":"Remove unused variable 'operation'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'key' is defined but never used. Allowed unused args must match /^_/u.","line":234,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":234,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"key"},"fix":{"range":[4870,4881],"text":""},"desc":"Remove unused variable 'key'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'key' is defined but never used. Allowed unused args must match /^_/u.","line":235,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":235,"endColumn":24,"suggestions":[{"messageId":"removeVar","data":{"varName":"key"},"fix":{"range":[4922,4934],"text":""},"desc":"Remove unused variable 'key'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'value' is defined but never used. Allowed unused args must match /^_/u.","line":235,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":235,"endColumn":40,"suggestions":[{"messageId":"removeVar","data":{"varName":"value"},"fix":{"range":[4933,4949],"text":""},"desc":"Remove unused variable 'value'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'key' is defined but never used. Allowed unused args must match /^_/u.","line":236,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":236,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"key"},"fix":{"range":[4993,5005],"text":""},"desc":"Remove unused variable 'key'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'value' is defined but never used. Allowed unused args must match /^_/u.","line":236,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":236,"endColumn":41,"suggestions":[{"messageId":"removeVar","data":{"varName":"value"},"fix":{"range":[5004,5020],"text":""},"desc":"Remove unused variable 'value'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'key' is defined but never used. Allowed unused args must match /^_/u.","line":237,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":237,"endColumn":24,"suggestions":[{"messageId":"removeVar","data":{"varName":"key"},"fix":{"range":[5111,5123],"text":""},"desc":"Remove unused variable 'key'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'value' is defined but never used. Allowed unused args must match /^_/u.","line":237,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":237,"endColumn":40,"suggestions":[{"messageId":"removeVar","data":{"varName":"value"},"fix":{"range":[5122,5138],"text":""},"desc":"Remove unused variable 'value'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'key' is defined but never used. Allowed unused args must match /^_/u.","line":238,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":238,"endColumn":28,"suggestions":[{"messageId":"removeVar","data":{"varName":"key"},"fix":{"range":[5179,5190],"text":""},"desc":"Remove unused variable 'key'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'key' is defined but never used. Allowed unused args must match /^_/u.","line":239,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":239,"endColumn":27,"suggestions":[{"messageId":"removeVar","data":{"varName":"key"},"fix":{"range":[5234,5245],"text":""},"desc":"Remove unused variable 'key'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'items' is defined but never used. Allowed unused args must match /^_/u.","line":247,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":247,"endColumn":80,"suggestions":[{"messageId":"removeVar","data":{"varName":"items"},"fix":{"range":[5375,5440],"text":""},"desc":"Remove unused variable 'items'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'key' is defined but never used. Allowed unused args must match /^_/u.","line":248,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":248,"endColumn":23,"suggestions":[{"messageId":"removeVar","data":{"varName":"key"},"fix":{"range":[5464,5475],"text":""},"desc":"Remove unused variable 'key'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'key' is defined but never used. Allowed unused args must match /^_/u.","line":249,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":249,"endColumn":20,"suggestions":[{"messageId":"removeVar","data":{"varName":"key"},"fix":{"range":[5492,5503],"text":""},"desc":"Remove unused variable 'key'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'key' is defined but never used. Allowed unused args must match /^_/u.","line":250,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":250,"endColumn":23,"suggestions":[{"messageId":"removeVar","data":{"varName":"key"},"fix":{"range":[5523,5534],"text":""},"desc":"Remove unused variable 'key'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'key' is defined but never used. Allowed unused args must match /^_/u.","line":261,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":261,"endColumn":18,"suggestions":[{"messageId":"removeVar","data":{"varName":"key"},"fix":{"range":[5702,5713],"text":""},"desc":"Remove unused variable 'key'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'key' is defined but never used. Allowed unused args must match /^_/u.","line":262,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":262,"endColumn":18,"suggestions":[{"messageId":"removeVar","data":{"varName":"key"},"fix":{"range":[5752,5764],"text":""},"desc":"Remove unused variable 'key'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'value' is defined but never used. Allowed unused args must match /^_/u.","line":262,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":262,"endColumn":28,"suggestions":[{"messageId":"removeVar","data":{"varName":"value"},"fix":{"range":[5763,5773],"text":""},"desc":"Remove unused variable 'value'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'ttl' is defined but never used. Allowed unused args must match /^_/u.","line":262,"column":30,"nodeType":"Identifier","messageId":"unusedVar","endLine":262,"endColumn":42,"suggestions":[{"messageId":"removeVar","data":{"varName":"ttl"},"fix":{"range":[5773,5787],"text":""},"desc":"Remove unused variable 'ttl'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'key' is defined but never used. Allowed unused args must match /^_/u.","line":263,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":263,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"key"},"fix":{"range":[5821,5832],"text":""},"desc":"Remove unused variable 'key'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'name' is defined but never used. Allowed unused args must match /^_/u.","line":274,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":274,"endColumn":30,"suggestions":[{"messageId":"removeVar","data":{"varName":"name"},"fix":{"range":[6069,6082],"text":""},"desc":"Remove unused variable 'name'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'config' is defined but never used. Allowed unused args must match /^_/u.","line":274,"column":32,"nodeType":"Identifier","messageId":"unusedVar","endLine":274,"endColumn":73,"suggestions":[{"messageId":"removeVar","data":{"varName":"config"},"fix":{"range":[6081,6124],"text":""},"desc":"Remove unused variable 'config'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'name' is defined but never used. Allowed unused args must match /^_/u.","line":275,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":275,"endColumn":39,"suggestions":[{"messageId":"removeVar","data":{"varName":"name"},"fix":{"range":[6170,6183],"text":""},"desc":"Remove unused variable 'name'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'config' is defined but never used. Allowed unused args must match /^_/u.","line":275,"column":41,"nodeType":"Identifier","messageId":"unusedVar","endLine":275,"endColumn":82,"suggestions":[{"messageId":"removeVar","data":{"varName":"config"},"fix":{"range":[6182,6225],"text":""},"desc":"Remove unused variable 'config'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'name' is defined but never used. Allowed unused args must match /^_/u.","line":276,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":276,"endColumn":38,"suggestions":[{"messageId":"removeVar","data":{"varName":"name"},"fix":{"range":[6272,6285],"text":""},"desc":"Remove unused variable 'name'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'config' is defined but never used. Allowed unused args must match /^_/u.","line":276,"column":40,"nodeType":"Identifier","messageId":"unusedVar","endLine":276,"endColumn":81,"suggestions":[{"messageId":"removeVar","data":{"varName":"config"},"fix":{"range":[6284,6327],"text":""},"desc":"Remove unused variable 'config'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'name' is defined but never used. Allowed unused args must match /^_/u.","line":277,"column":19,"nodeType":"Identifier","messageId":"unusedVar","endLine":277,"endColumn":31,"suggestions":[{"messageId":"removeVar","data":{"varName":"name"},"fix":{"range":[6366,6379],"text":""},"desc":"Remove unused variable 'name'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'config' is defined but never used. Allowed unused args must match /^_/u.","line":277,"column":33,"nodeType":"Identifier","messageId":"unusedVar","endLine":277,"endColumn":74,"suggestions":[{"messageId":"removeVar","data":{"varName":"config"},"fix":{"range":[6378,6421],"text":""},"desc":"Remove unused variable 'config'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'event' is defined but never used. Allowed unused args must match /^_/u.","line":285,"column":19,"nodeType":"Identifier","messageId":"unusedVar","endLine":285,"endColumn":32,"suggestions":[{"messageId":"removeVar","data":{"varName":"event"},"fix":{"range":[6547,6561],"text":""},"desc":"Remove unused variable 'event'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'listener' is defined but never used. Allowed unused args must match /^_/u.","line":285,"column":34,"nodeType":"Identifier","messageId":"unusedVar","endLine":285,"endColumn":73,"suggestions":[{"messageId":"removeVar","data":{"varName":"listener"},"fix":{"range":[6560,6601],"text":""},"desc":"Remove unused variable 'listener'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'data' is defined but never used. Allowed unused args must match /^_/u.","line":285,"column":45,"nodeType":"Identifier","messageId":"unusedVar","endLine":285,"endColumn":64,"suggestions":[{"messageId":"removeVar","data":{"varName":"data"},"fix":{"range":[6573,6592],"text":""},"desc":"Remove unused variable 'data'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'event' is defined but never used. Allowed unused args must match /^_/u.","line":286,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":286,"endColumn":33,"suggestions":[{"messageId":"removeVar","data":{"varName":"event"},"fix":{"range":[6629,6643],"text":""},"desc":"Remove unused variable 'event'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'listener' is defined but never used. Allowed unused args must match /^_/u.","line":286,"column":35,"nodeType":"Identifier","messageId":"unusedVar","endLine":286,"endColumn":74,"suggestions":[{"messageId":"removeVar","data":{"varName":"listener"},"fix":{"range":[6642,6683],"text":""},"desc":"Remove unused variable 'listener'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'data' is defined but never used. Allowed unused args must match /^_/u.","line":286,"column":46,"nodeType":"Identifier","messageId":"unusedVar","endLine":286,"endColumn":65,"suggestions":[{"messageId":"removeVar","data":{"varName":"data"},"fix":{"range":[6655,6674],"text":""},"desc":"Remove unused variable 'data'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'event' is defined but never used. Allowed unused args must match /^_/u.","line":287,"column":21,"nodeType":"Identifier","messageId":"unusedVar","endLine":287,"endColumn":34,"suggestions":[{"messageId":"removeVar","data":{"varName":"event"},"fix":{"range":[6712,6726],"text":""},"desc":"Remove unused variable 'event'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'data' is defined but never used. Allowed unused args must match /^_/u.","line":287,"column":36,"nodeType":"Identifier","messageId":"unusedVar","endLine":287,"endColumn":55,"suggestions":[{"messageId":"removeVar","data":{"varName":"data"},"fix":{"range":[6725,6746],"text":""},"desc":"Remove unused variable 'data'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'event' is defined but never used. Allowed unused args must match /^_/u.","line":288,"column":21,"nodeType":"Identifier","messageId":"unusedVar","endLine":288,"endColumn":34,"suggestions":[{"messageId":"removeVar","data":{"varName":"event"},"fix":{"range":[6775,6789],"text":""},"desc":"Remove unused variable 'event'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'listener' is defined but never used. Allowed unused args must match /^_/u.","line":288,"column":36,"nodeType":"Identifier","messageId":"unusedVar","endLine":288,"endColumn":75,"suggestions":[{"messageId":"removeVar","data":{"varName":"listener"},"fix":{"range":[6788,6829],"text":""},"desc":"Remove unused variable 'listener'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'data' is defined but never used. Allowed unused args must match /^_/u.","line":288,"column":47,"nodeType":"Identifier","messageId":"unusedVar","endLine":288,"endColumn":66,"suggestions":[{"messageId":"removeVar","data":{"varName":"data"},"fix":{"range":[6801,6820],"text":""},"desc":"Remove unused variable 'data'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'event' is defined but never used. Allowed unused args must match /^_/u.","line":289,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":289,"endColumn":36,"suggestions":[{"messageId":"removeVar","data":{"varName":"event"},"fix":{"range":[6859,6873],"text":""},"desc":"Remove unused variable 'event'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'cache' is defined but never used. Allowed unused args must match /^_/u.","line":299,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":299,"endColumn":30,"suggestions":[{"messageId":"removeVar","data":{"varName":"cache"},"fix":{"range":[7005,7024],"text":""},"desc":"Remove unused variable 'cache'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'cache' is defined but never used. Allowed unused args must match /^_/u.","line":300,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":300,"endColumn":32,"suggestions":[{"messageId":"removeVar","data":{"varName":"cache"},"fix":{"range":[7045,7064],"text":""},"desc":"Remove unused variable 'cache'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'newConfig' is defined but never used. Allowed unused args must match /^_/u.","line":311,"column":19,"nodeType":"Identifier","messageId":"unusedVar","endLine":311,"endColumn":53,"suggestions":[{"messageId":"removeVar","data":{"varName":"newConfig"},"fix":{"range":[7277,7311],"text":""},"desc":"Remove unused variable 'newConfig'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'operation' is defined but never used. Allowed unused args must match /^_/u.","line":321,"column":19,"nodeType":"Identifier","messageId":"unusedVar","endLine":321,"endColumn":36,"suggestions":[{"messageId":"removeVar","data":{"varName":"operation"},"fix":{"range":[7538,7556],"text":""},"desc":"Remove unused variable 'operation'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'duration' is defined but never used. Allowed unused args must match /^_/u.","line":321,"column":38,"nodeType":"Identifier","messageId":"unusedVar","endLine":321,"endColumn":54,"suggestions":[{"messageId":"removeVar","data":{"varName":"duration"},"fix":{"range":[7555,7573],"text":""},"desc":"Remove unused variable 'duration'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'size' is defined but never used. Allowed unused args must match /^_/u.","line":322,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":322,"endColumn":26,"suggestions":[{"messageId":"removeVar","data":{"varName":"size"},"fix":{"range":[7595,7607],"text":""},"desc":"Remove unused variable 'size'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'rate' is defined but never used. Allowed unused args must match /^_/u.","line":323,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":323,"endColumn":29,"suggestions":[{"messageId":"removeVar","data":{"varName":"rate"},"fix":{"range":[7632,7644],"text":""},"desc":"Remove unused variable 'rate'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'usage' is defined but never used. Allowed unused args must match /^_/u.","line":324,"column":21,"nodeType":"Identifier","messageId":"unusedVar","endLine":324,"endColumn":34,"suggestions":[{"messageId":"removeVar","data":{"varName":"usage"},"fix":{"range":[7673,7686],"text":""},"desc":"Remove unused variable 'usage'."}]}],"suppressedMessages":[],"errorCount":71,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 国际化缓存接口定义\n * I18n Cache Interface Definitions\n * \n * 提供缓存系统所需的接口定义，包括存储、管理器、预加载器等\n */\n\nimport type { I18nMetrics, Locale, Messages } from '@/types/i18n';\nimport type { CacheStats, CacheEvent } from './i18n-cache-types-base';\n\n/**\n * 缓存存储接口\n * Cache storage interface\n */\nexport interface CacheStorage<T> {\n  get(key: string): T | null;\n  set(key: string, value: T, ttl?: number): void;\n  has(key: string): boolean;\n  delete(key: string): boolean;\n  clear(): void;\n  size(): number;\n  keys(): IterableIterator<string>;\n  values(): IterableIterator<T>;\n  entries(): IterableIterator<[string, T]>;\n}\n\n/**\n * 持久化存储接口\n * Persistent storage interface\n */\nexport interface PersistentStorage {\n  load(key: string): Promise<unknown> | unknown;\n  save(key: string, data: unknown): Promise<void> | void;\n  remove(key: string): Promise<void> | void;\n  clear(): Promise<void> | void;\n}\n\n/**\n * 指标收集器接口\n * Metrics collector interface\n */\nexport interface MetricsCollector {\n  recordLoadTime(time: number): void;\n  recordCacheHit(): void;\n  recordCacheMiss(): void;\n  recordError(): void;\n  recordLocaleUsage(locale: Locale): void;\n  getMetrics(): I18nMetrics;\n  reset(): void;\n}\n\n/**\n * 预加载器接口\n * Preloader interface\n */\nexport interface Preloader {\n  preloadLocale(locale: Locale): Promise<Messages>;\n  warmupCache(): void;\n  isPreloading(): boolean;\n  getPreloadProgress(): number;\n}\n\n/**\n * 缓存管理器接口\n * Cache manager interface\n */\nexport interface CacheManager {\n  getMessages(locale: Locale): Promise<Messages>;\n  preloadMessages(locale: Locale): Promise<Messages>;\n  warmupCache(): void;\n  getMetrics(): I18nMetrics;\n  getCacheStats(): CacheStats;\n  clearCache(): void;\n  resetMetrics(): void;\n}\n\n/**\n * 缓存序列化选项\n * Cache serialization options\n */\nexport interface SerializationOptions {\n  compress: boolean;\n  encryption: boolean;\n  format: 'json' | 'binary' | 'msgpack';\n}\n\n/**\n * 缓存导入/导出\n * Cache import/export\n */\nexport interface CacheExportData {\n  version: string;\n  timestamp: number;\n  config: Record<string, unknown>;\n  entries: Array<{\n    key: string;\n    data: unknown;\n    timestamp: number;\n    ttl: number;\n    hits: number;\n  }>;\n  metadata: {\n    totalSize: number;\n    checksum?: string;\n  };\n}\n\n/**\n * 缓存同步选项\n * Cache synchronization options\n */\nexport interface CacheSyncOptions {\n  enableSync: boolean;\n  syncInterval: number;\n  conflictResolution: 'local' | 'remote' | 'merge' | 'manual';\n  syncEndpoint?: string;\n}\n\n/**\n * 缓存分区配置\n * Cache partition configuration\n */\nexport interface CachePartitionConfig {\n  enablePartitioning: boolean;\n  partitionKey: (key: string) => string;\n  maxPartitions: number;\n  partitionStrategy: 'hash' | 'prefix' | 'custom';\n}\n\n/**\n * 缓存压缩配置\n * Cache compression configuration\n */\nexport interface CacheCompressionConfig {\n  enableCompression: boolean;\n  algorithm: 'gzip' | 'deflate' | 'brotli';\n  threshold: number; // Minimum size to compress\n  level: number; // Compression level (1-9)\n}\n\n/**\n * 缓存加密配置\n * Cache encryption configuration\n */\nexport interface CacheEncryptionConfig {\n  enableEncryption: boolean;\n  algorithm: 'aes-256-gcm' | 'aes-192-gcm' | 'aes-128-gcm';\n  keyDerivation: 'pbkdf2' | 'scrypt' | 'argon2';\n  saltLength: number;\n}\n\n/**\n * 缓存监控配置\n * Cache monitoring configuration\n */\nexport interface CacheMonitoringConfig {\n  enableMonitoring: boolean;\n  metricsInterval: number;\n  alertThresholds: {\n    hitRateBelow: number;\n    errorRateAbove: number;\n    loadTimeAbove: number;\n  };\n  webhookUrl?: string;\n}\n\n/**\n * 缓存备份配置\n * Cache backup configuration\n */\nexport interface CacheBackupConfig {\n  enableBackup: boolean;\n  backupInterval: number;\n  maxBackups: number;\n  backupLocation: string;\n  compressionEnabled: boolean;\n}\n\n/**\n * 缓存恢复选项\n * Cache recovery options\n */\nexport interface CacheRecoveryOptions {\n  backupFile: string;\n  validateChecksum: boolean;\n  mergeStrategy: 'replace' | 'merge' | 'skip_existing';\n  onProgress?: (progress: number) => void;\n}\n\n/**\n * 缓存性能配置\n * Cache performance configuration\n */\nexport interface CachePerformanceConfig {\n  enableLazyLoading: boolean;\n  prefetchThreshold: number;\n  maxConcurrentLoads: number;\n  loadTimeout: number;\n  retryAttempts: number;\n  retryDelay: number;\n}\n\n/**\n * 缓存安全配置\n * Cache security configuration\n */\nexport interface CacheSecurityConfig {\n  enableAccessControl: boolean;\n  allowedOrigins: string[];\n  maxKeyLength: number;\n  maxValueSize: number;\n  sanitizeKeys: boolean;\n  validateValues: boolean;\n}\n\n/**\n * 缓存观察者接口\n * Cache observer interface\n */\nexport interface CacheObserver {\n  onCacheHit(key: string, data: unknown): void;\n  onCacheMiss(key: string): void;\n  onCacheSet(key: string, data: unknown): void;\n  onCacheDelete(key: string): void;\n  onCacheClear(): void;\n  onCacheError(error: Error, operation: string): void;\n}\n\n/**\n * 缓存中间件接口\n * Cache middleware interface\n */\nexport interface CacheMiddleware {\n  beforeGet?(key: string): string | Promise<string>;\n  afterGet?(key: string, value: unknown): unknown | Promise<unknown>;\n  beforeSet?(key: string, value: unknown): { key: string; value: unknown } | Promise<{ key: string; value: unknown }>;\n  afterSet?(key: string, value: unknown): void | Promise<void>;\n  beforeDelete?(key: string): string | Promise<string>;\n  afterDelete?(key: string): void | Promise<void>;\n}\n\n/**\n * 缓存策略接口\n * Cache strategy interface\n */\nexport interface CacheStrategyInterface {\n  shouldEvict(items: Array<{ key: string; lastAccessed: number; hits: number }>): string[];\n  onAccess(key: string): void;\n  onSet(key: string): void;\n  onDelete(key: string): void;\n  reset(): void;\n}\n\n/**\n * 缓存适配器接口\n * Cache adapter interface\n */\nexport interface CacheAdapter<T = unknown> {\n  name: string;\n  isAvailable(): boolean;\n  get(key: string): Promise<T | null> | T | null;\n  set(key: string, value: T, ttl?: number): Promise<void> | void;\n  delete(key: string): Promise<boolean> | boolean;\n  clear(): Promise<void> | void;\n  size(): Promise<number> | number;\n  keys(): Promise<string[]> | string[];\n}\n\n/**\n * 缓存工厂接口\n * Cache factory interface\n */\nexport interface CacheFactory {\n  createCache<T>(name: string, config?: Partial<Record<string, unknown>>): CacheStorage<T>;\n  createPersistentStorage(name: string, config?: Partial<Record<string, unknown>>): PersistentStorage;\n  createMetricsCollector(name: string, config?: Partial<Record<string, unknown>>): MetricsCollector;\n  createPreloader(name: string, config?: Partial<Record<string, unknown>>): Preloader;\n}\n\n/**\n * 缓存事件发射器接口\n * Cache event emitter interface\n */\nexport interface CacheEventEmitter {\n  on<T = unknown>(event: string, listener: (data: CacheEvent<T>) => void): void;\n  off<T = unknown>(event: string, listener: (data: CacheEvent<T>) => void): void;\n  emit<T = unknown>(event: string, data: CacheEvent<T>): void;\n  once<T = unknown>(event: string, listener: (data: CacheEvent<T>) => void): void;\n  removeAllListeners(event?: string): void;\n}\n\n/**\n * 缓存插件接口\n * Cache plugin interface\n */\nexport interface CachePlugin {\n  name: string;\n  version: string;\n  install(cache: CacheManager): void;\n  uninstall(cache: CacheManager): void;\n  isInstalled(): boolean;\n}\n\n/**\n * 缓存生命周期钩子\n * Cache lifecycle hooks\n */\nexport interface CacheLifecycleHooks {\n  onInit?(): void | Promise<void>;\n  onDestroy?(): void | Promise<void>;\n  onConfigChange?(newConfig: Record<string, unknown>): void | Promise<void>;\n  onCacheFull?(): void | Promise<void>;\n  onCacheEmpty?(): void | Promise<void>;\n}\n\n/**\n * 缓存统计收集器接口\n * Cache statistics collector interface\n */\nexport interface CacheStatsCollector {\n  recordOperation(operation: string, duration: number): void;\n  recordSize(size: number): void;\n  recordHitRate(rate: number): void;\n  recordMemoryUsage(usage: number): void;\n  getStats(): Record<string, unknown>;\n  reset(): void;\n  export(): string;\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/i18n-cache-types-utils.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'CACHE_CONSTANTS' is defined but never used. Allowed unused vars must match /^_/u.","line":15,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":18,"suggestions":[{"messageId":"removeVar","data":{"varName":"CACHE_CONSTANTS"},"fix":{"range":[221,240],"text":""},"desc":"Remove unused variable 'CACHE_CONSTANTS'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CACHE_CONSTANTS' is defined but never used. Allowed unused vars must match /^_/u.","line":15,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":15,"endColumn":18},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":134,"column":34,"nodeType":"MemberExpression","endLine":134,"endColumn":45},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":169,"column":34,"nodeType":"MemberExpression","endLine":169,"endColumn":50},{"ruleId":"security/detect-unsafe-regex","severity":2,"message":"Unsafe Regular Expression","line":185,"column":33,"nodeType":"Literal","endLine":185,"endColumn":71},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":418,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":418,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9778,9781],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9778,9781],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 国际化缓存工具函数\n * I18n Cache Utility Functions\n * \n * 提供缓存系统所需的工具函数、验证器和辅助方法\n */\n\nimport type { Locale } from '@/types/i18n';\nimport type {\n  CacheConfig,\n  CacheItem,\n  CacheEvent,\n  CacheStats,\n  CacheConfigValidation,\n  CACHE_CONSTANTS,\n} from './i18n-cache-types-base';\nimport type { AdvancedCacheConfig } from './i18n-cache-types-advanced';\n\n/**\n * 缓存键工具函数\n * Cache key utility functions\n */\nexport const CacheKeyUtils = {\n  /**\n   * 创建缓存键\n   * Create cache key\n   */\n  create(locale: Locale, namespace?: string, key?: string): string {\n    const parts = [locale];\n    if (namespace) parts.push(namespace);\n    if (key) parts.push(key);\n    return parts.join(':');\n  },\n\n  /**\n   * 解析缓存键\n   * Parse cache key\n   */\n  parse(cacheKey: string): { locale: Locale; namespace?: string; key?: string } {\n    const parts = cacheKey.split(':');\n    return {\n      locale: parts[0] as Locale,\n      namespace: parts[1],\n      key: parts[2],\n    };\n  },\n\n  /**\n   * 验证缓存键格式\n   * Validate cache key format\n   */\n  validate(key: string): boolean {\n    return typeof key === 'string' && key.length > 0 && key.length <= 256;\n  },\n\n  /**\n   * 标准化缓存键\n   * Normalize cache key\n   */\n  normalize(key: string): string {\n    return key.toLowerCase().trim().replace(/[^a-z0-9:_-]/g, '_');\n  },\n\n  /**\n   * 生成通配符模式\n   * Generate wildcard pattern\n   */\n  createPattern(locale?: Locale, namespace?: string): string {\n    const parts: string[] = [];\n    if (locale) parts.push(locale);\n    else parts.push('*');\n    if (namespace) parts.push(namespace);\n    else parts.push('*');\n    parts.push('*');\n    return parts.join(':');\n  },\n} as const;\n\n/**\n * 缓存时间工具函数\n * Cache time utility functions\n */\nexport const CacheTimeUtils = {\n  /**\n   * 检查是否过期\n   * Check if expired\n   */\n  isExpired(timestamp: number, ttl: number): boolean {\n    return Date.now() - timestamp > ttl;\n  },\n\n  /**\n   * 计算剩余时间\n   * Calculate remaining time\n   */\n  getRemainingTime(timestamp: number, ttl: number): number {\n    const elapsed = Date.now() - timestamp;\n    return Math.max(0, ttl - elapsed);\n  },\n\n  /**\n   * 格式化时间\n   * Format time\n   */\n  formatDuration(milliseconds: number): string {\n    const seconds = Math.floor(milliseconds / 1000);\n    const minutes = Math.floor(seconds / 60);\n    const hours = Math.floor(minutes / 60);\n    const days = Math.floor(hours / 24);\n\n    if (days > 0) return `${days}d ${hours % 24}h`;\n    if (hours > 0) return `${hours}h ${minutes % 60}m`;\n    if (minutes > 0) return `${minutes}m ${seconds % 60}s`;\n    return `${seconds}s`;\n  },\n\n  /**\n   * 解析时间字符串\n   * Parse time string\n   */\n  parseTimeString(timeStr: string): number {\n    const units: Record<string, number> = {\n      ms: 1,\n      s: 1000,\n      m: 60 * 1000,\n      h: 60 * 60 * 1000,\n      d: 24 * 60 * 60 * 1000,\n    };\n\n    const match = timeStr.match(/^(\\d+)(ms|s|m|h|d)$/);\n    if (!match) throw new Error(`Invalid time format: ${timeStr}`);\n\n    const [, value, unit] = match;\n    return parseInt(value, 10) * units[unit];\n  },\n} as const;\n\n/**\n * 缓存大小工具函数\n * Cache size utility functions\n */\nexport const CacheSizeUtils = {\n  /**\n   * 估算对象大小\n   * Estimate object size\n   */\n  estimateSize(obj: unknown): number {\n    try {\n      return new Blob([JSON.stringify(obj)]).size;\n    } catch {\n      return 0;\n    }\n  },\n\n  /**\n   * 格式化字节大小\n   * Format byte size\n   */\n  formatBytes(bytes: number): string {\n    const units = ['B', 'KB', 'MB', 'GB', 'TB'];\n    let size = bytes;\n    let unitIndex = 0;\n\n    while (size >= 1024 && unitIndex < units.length - 1) {\n      size /= 1024;\n      unitIndex += 1;\n    }\n\n    return `${size.toFixed(2)} ${units[unitIndex]}`;\n  },\n\n  /**\n   * 解析大小字符串\n   * Parse size string\n   */\n  parseSize(sizeStr: string): number {\n    const units: Record<string, number> = {\n      B: 1,\n      KB: 1024,\n      MB: 1024 * 1024,\n      GB: 1024 * 1024 * 1024,\n      TB: 1024 * 1024 * 1024 * 1024,\n    };\n\n    const match = sizeStr.match(/^(\\d+(?:\\.\\d+)?)\\s*(B|KB|MB|GB|TB)$/i);\n    if (!match) throw new Error(`Invalid size format: ${sizeStr}`);\n\n    const [, value, unit] = match;\n    return parseFloat(value) * units[unit.toUpperCase()];\n  },\n} as const;\n\n/**\n * 缓存统计工具函数\n * Cache statistics utility functions\n */\nexport const CacheStatsUtils = {\n  /**\n   * 计算命中率\n   * Calculate hit rate\n   */\n  calculateHitRate(hits: number, misses: number): number {\n    const total = hits + misses;\n    return total > 0 ? hits / total : 0;\n  },\n\n  /**\n   * 计算平均年龄\n   * Calculate average age\n   */\n  calculateAverageAge(items: Array<{ timestamp: number }>): number {\n    if (items.length === 0) return 0;\n    const now = Date.now();\n    const totalAge = items.reduce((sum, item) => sum + (now - item.timestamp), 0);\n    return totalAge / items.length;\n  },\n\n  /**\n   * 生成统计报告\n   * Generate statistics report\n   */\n  generateReport(stats: CacheStats): string {\n    return `Cache Statistics:\n- Size: ${stats.size} items\n- Total Hits: ${stats.totalHits}\n- Average Age: ${CacheTimeUtils.formatDuration(stats.averageAge)}`;\n  },\n\n  /**\n   * 比较统计数据\n   * Compare statistics\n   */\n  compareStats(before: CacheStats, after: CacheStats): {\n    sizeDiff: number;\n    hitsDiff: number;\n    ageDiff: number;\n  } {\n    return {\n      sizeDiff: after.size - before.size,\n      hitsDiff: after.totalHits - before.totalHits,\n      ageDiff: after.averageAge - before.averageAge,\n    };\n  },\n} as const;\n\n/**\n * 缓存验证工具函数\n * Cache validation utility functions\n */\nexport const CacheValidationUtils = {\n  /**\n   * 验证缓存项\n   * Validate cache item\n   */\n  validateItem<T>(item: unknown): item is CacheItem<T> {\n    return (\n      typeof item === 'object' &&\n      item !== null &&\n      'data' in item &&\n      'timestamp' in item &&\n      'ttl' in item &&\n      'hits' in item &&\n      typeof (item as CacheItem<T>).timestamp === 'number' &&\n      typeof (item as CacheItem<T>).ttl === 'number' &&\n      typeof (item as CacheItem<T>).hits === 'number'\n    );\n  },\n\n  /**\n   * 验证缓存配置\n   * Validate cache configuration\n   */\n  validateConfig(config: Partial<CacheConfig>): CacheConfigValidation {\n    const errors: string[] = [];\n    const warnings: string[] = [];\n\n    if (config.maxSize !== undefined) {\n      if (typeof config.maxSize !== 'number' || config.maxSize < 1) {\n        errors.push('maxSize must be a positive number');\n      } else if (config.maxSize > 100000) {\n        warnings.push('maxSize is very large, consider reducing it');\n      }\n    }\n\n    if (config.ttl !== undefined) {\n      if (typeof config.ttl !== 'number' || config.ttl < 0) {\n        errors.push('ttl must be a non-negative number');\n      } else if (config.ttl > 24 * 60 * 60 * 1000) {\n        warnings.push('ttl is very long (>24h), consider reducing it');\n      }\n    }\n\n    if (config.storageKey !== undefined) {\n      if (typeof config.storageKey !== 'string' || config.storageKey.length === 0) {\n        errors.push('storageKey must be a non-empty string');\n      }\n    }\n\n    if (config.enablePersistence !== undefined) {\n      if (typeof config.enablePersistence !== 'boolean') {\n        errors.push('enablePersistence must be a boolean');\n      }\n    }\n\n    return {\n      isValid: errors.length === 0,\n      errors,\n      warnings,\n    };\n  },\n\n  /**\n   * 验证高级配置\n   * Validate advanced configuration\n   */\n  validateAdvancedConfig(config: Partial<AdvancedCacheConfig>): CacheConfigValidation {\n    const errors: string[] = [];\n    const warnings: string[] = [];\n\n    // 验证基础配置\n    const baseValidation = this.validateConfig(config);\n    errors.push(...baseValidation.errors);\n    warnings.push(...baseValidation.warnings);\n\n    // 验证压缩配置\n    if (config.compression) {\n      if (config.compression.enableCompression && config.compression.threshold < 0) {\n        errors.push('compression threshold must be non-negative');\n      }\n      if (config.compression.level !== undefined && (config.compression.level < 1 || config.compression.level > 9)) {\n        errors.push('compression level must be between 1 and 9');\n      }\n    }\n\n    // 验证性能配置\n    if (config.performance) {\n      if (config.performance.maxConcurrentLoads !== undefined && config.performance.maxConcurrentLoads < 1) {\n        errors.push('maxConcurrentLoads must be at least 1');\n      }\n      if (config.performance.loadTimeout !== undefined && config.performance.loadTimeout < 1000) {\n        warnings.push('loadTimeout is very short (<1s), consider increasing it');\n      }\n    }\n\n    return {\n      isValid: errors.length === 0,\n      errors,\n      warnings,\n    };\n  },\n} as const;\n\n/**\n * 缓存序列化工具函数\n * Cache serialization utility functions\n */\nexport const CacheSerializationUtils = {\n  /**\n   * 序列化数据\n   * Serialize data\n   */\n  serialize(data: unknown): string {\n    try {\n      return JSON.stringify(data);\n    } catch (error) {\n      throw new Error(`Serialization failed: ${error instanceof Error ? error.message : 'Unknown error'}`);\n    }\n  },\n\n  /**\n   * 反序列化数据\n   * Deserialize data\n   */\n  deserialize<T>(data: string): T {\n    try {\n      return JSON.parse(data) as T;\n    } catch (error) {\n      throw new Error(`Deserialization failed: ${error instanceof Error ? error.message : 'Unknown error'}`);\n    }\n  },\n\n  /**\n   * 安全序列化\n   * Safe serialize\n   */\n  safeSerialize(data: unknown, fallback = '{}'): string {\n    try {\n      return JSON.stringify(data);\n    } catch {\n      return fallback;\n    }\n  },\n\n  /**\n   * 安全反序列化\n   * Safe deserialize\n   */\n  safeDeserialize<T>(data: string, fallback: T): T {\n    try {\n      return JSON.parse(data) as T;\n    } catch {\n      return fallback;\n    }\n  },\n} as const;\n\n/**\n * 缓存事件工具函数\n * Cache event utility functions\n */\nexport const CacheEventUtils = {\n  /**\n   * 创建缓存事件\n   * Create cache event\n   */\n  createEvent<T>(type: string, data?: T, key?: string): CacheEvent<T> {\n    return {\n      type: type as any,\n      key,\n      data,\n      timestamp: Date.now(),\n    };\n  },\n\n  /**\n   * 过滤事件\n   * Filter events\n   */\n  filterEvents<T>(events: CacheEvent<T>[], type?: string, timeRange?: { start: number; end: number }): CacheEvent<T>[] {\n    return events.filter(event => {\n      if (type && event.type !== type) return false;\n      if (timeRange && (event.timestamp < timeRange.start || event.timestamp > timeRange.end)) return false;\n      return true;\n    });\n  },\n\n  /**\n   * 聚合事件统计\n   * Aggregate event statistics\n   */\n  aggregateEvents<T>(events: CacheEvent<T>[]): Record<string, number> {\n    const stats: Record<string, number> = {};\n    events.forEach(event => {\n      stats[event.type] = (stats[event.type] || 0) + 1;\n    });\n    return stats;\n  },\n} as const;\n\n/**\n * 缓存调试工具函数\n * Cache debug utility functions\n */\nexport const CacheDebugUtils = {\n  /**\n   * 生成调试信息\n   * Generate debug information\n   */\n  generateDebugInfo(cache: unknown): Record<string, unknown> {\n    return {\n      timestamp: Date.now(),\n      environment: process.env.NODE_ENV,\n      memoryUsage: process.memoryUsage?.(),\n      cacheInfo: cache,\n    };\n  },\n\n  /**\n   * 格式化调试输出\n   * Format debug output\n   */\n  formatDebugOutput(info: Record<string, unknown>): string {\n    return JSON.stringify(info, null, 2);\n  },\n\n  /**\n   * 创建性能标记\n   * Create performance mark\n   */\n  mark(name: string): void {\n    if (typeof performance !== 'undefined' && performance.mark) {\n      performance.mark(name);\n    }\n  },\n\n  /**\n   * 测量性能\n   * Measure performance\n   */\n  measure(name: string, startMark: string, endMark?: string): number {\n    if (typeof performance !== 'undefined' && performance.measure) {\n      performance.measure(name, startMark, endMark);\n      const entries = performance.getEntriesByName(name);\n      return entries.length > 0 ? entries[entries.length - 1].duration : 0;\n    }\n    return 0;\n  },\n} as const;\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/i18n-cache-types.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'I18nMetrics' is defined but never used. Allowed unused vars must match /^_/u.","line":15,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":26,"suggestions":[{"messageId":"removeVar","data":{"varName":"I18nMetrics"},"fix":{"range":[333,345],"text":""},"desc":"Remove unused variable 'I18nMetrics'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'I18nMetrics' is defined but never used. Allowed unused vars must match /^_/u.","line":15,"column":15,"nodeType":null,"messageId":"unusedVar","endLine":15,"endColumn":26},{"ruleId":"no-unused-vars","severity":2,"message":"'Locale' is defined but never used. Allowed unused vars must match /^_/u.","line":15,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":34,"suggestions":[{"messageId":"removeVar","data":{"varName":"Locale"},"fix":{"range":[344,352],"text":""},"desc":"Remove unused variable 'Locale'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Locale' is defined but never used. Allowed unused vars must match /^_/u.","line":15,"column":28,"nodeType":null,"messageId":"unusedVar","endLine":15,"endColumn":34},{"ruleId":"no-unused-vars","severity":2,"message":"'Messages' is defined but never used. Allowed unused vars must match /^_/u.","line":15,"column":36,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":44,"suggestions":[{"messageId":"removeVar","data":{"varName":"Messages"},"fix":{"range":[352,362],"text":""},"desc":"Remove unused variable 'Messages'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Messages' is defined but never used. Allowed unused vars must match /^_/u.","line":15,"column":36,"nodeType":null,"messageId":"unusedVar","endLine":15,"endColumn":44},{"ruleId":"no-unused-vars","severity":2,"message":"'PreloadConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":21,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"PreloadConfig"},"fix":{"range":[441,458],"text":""},"desc":"Remove unused variable 'PreloadConfig'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'PreloadConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":21,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":21,"endColumn":16},{"ruleId":"no-unused-vars","severity":2,"message":"'CacheOperationResult' is defined but never used. Allowed unused vars must match /^_/u.","line":22,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":23,"suggestions":[{"messageId":"removeVar","data":{"varName":"CacheOperationResult"},"fix":{"range":[458,482],"text":""},"desc":"Remove unused variable 'CacheOperationResult'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CacheOperationResult' is defined but never used. Allowed unused vars must match /^_/u.","line":22,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":22,"endColumn":23},{"ruleId":"no-unused-vars","severity":2,"message":"'CacheConfigValidation' is defined but never used. Allowed unused vars must match /^_/u.","line":27,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":27,"endColumn":24,"suggestions":[{"messageId":"removeVar","data":{"varName":"CacheConfigValidation"},"fix":{"range":[553,578],"text":""},"desc":"Remove unused variable 'CacheConfigValidation'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CacheConfigValidation' is defined but never used. Allowed unused vars must match /^_/u.","line":27,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":27,"endColumn":24},{"ruleId":"no-unused-vars","severity":2,"message":"'CacheHealthCheck' is defined but never used. Allowed unused vars must match /^_/u.","line":28,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":28,"endColumn":19,"suggestions":[{"messageId":"removeVar","data":{"varName":"CacheHealthCheck"},"fix":{"range":[578,598],"text":""},"desc":"Remove unused variable 'CacheHealthCheck'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CacheHealthCheck' is defined but never used. Allowed unused vars must match /^_/u.","line":28,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":28,"endColumn":19},{"ruleId":"no-unused-vars","severity":2,"message":"'CacheDebugInfo' is defined but never used. Allowed unused vars must match /^_/u.","line":29,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":29,"endColumn":17,"suggestions":[{"messageId":"removeVar","data":{"varName":"CacheDebugInfo"},"fix":{"range":[598,616],"text":""},"desc":"Remove unused variable 'CacheDebugInfo'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CacheDebugInfo' is defined but never used. Allowed unused vars must match /^_/u.","line":29,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":29,"endColumn":17},{"ruleId":"no-unused-vars","severity":2,"message":"'DEFAULT_CACHE_CONFIG' is defined but never used. Allowed unused vars must match /^_/u.","line":30,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":30,"endColumn":23,"suggestions":[{"messageId":"removeVar","data":{"varName":"DEFAULT_CACHE_CONFIG"},"fix":{"range":[616,640],"text":""},"desc":"Remove unused variable 'DEFAULT_CACHE_CONFIG'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'DEFAULT_CACHE_CONFIG' is defined but never used. Allowed unused vars must match /^_/u.","line":30,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":30,"endColumn":23},{"ruleId":"no-unused-vars","severity":2,"message":"'DEFAULT_PRELOAD_CONFIG' is defined but never used. Allowed unused vars must match /^_/u.","line":31,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":31,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"DEFAULT_PRELOAD_CONFIG"},"fix":{"range":[640,666],"text":""},"desc":"Remove unused variable 'DEFAULT_PRELOAD_CONFIG'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'DEFAULT_PRELOAD_CONFIG' is defined but never used. Allowed unused vars must match /^_/u.","line":31,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":31,"endColumn":25},{"ruleId":"no-unused-vars","severity":2,"message":"'CACHE_CONSTANTS' is defined but never used. Allowed unused vars must match /^_/u.","line":32,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":32,"endColumn":18,"suggestions":[{"messageId":"removeVar","data":{"varName":"CACHE_CONSTANTS"},"fix":{"range":[666,685],"text":""},"desc":"Remove unused variable 'CACHE_CONSTANTS'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CACHE_CONSTANTS' is defined but never used. Allowed unused vars must match /^_/u.","line":32,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":32,"endColumn":18},{"ruleId":"no-unused-vars","severity":2,"message":"'CacheError' is defined but never used. Allowed unused vars must match /^_/u.","line":33,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":33,"endColumn":13,"suggestions":[{"messageId":"removeVar","data":{"varName":"CacheError"},"fix":{"range":[685,699],"text":""},"desc":"Remove unused variable 'CacheError'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CacheError' is defined but never used. Allowed unused vars must match /^_/u.","line":33,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":33,"endColumn":13},{"ruleId":"no-unused-vars","severity":2,"message":"'CacheValidationError' is defined but never used. Allowed unused vars must match /^_/u.","line":34,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":34,"endColumn":23,"suggestions":[{"messageId":"removeVar","data":{"varName":"CacheValidationError"},"fix":{"range":[699,723],"text":""},"desc":"Remove unused variable 'CacheValidationError'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CacheValidationError' is defined but never used. Allowed unused vars must match /^_/u.","line":34,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":34,"endColumn":23},{"ruleId":"no-unused-vars","severity":2,"message":"'CacheStorageError' is defined but never used. Allowed unused vars must match /^_/u.","line":35,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":35,"endColumn":20,"suggestions":[{"messageId":"removeVar","data":{"varName":"CacheStorageError"},"fix":{"range":[723,744],"text":""},"desc":"Remove unused variable 'CacheStorageError'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CacheStorageError' is defined but never used. Allowed unused vars must match /^_/u.","line":35,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":35,"endColumn":20},{"ruleId":"no-unused-vars","severity":2,"message":"'CacheSerializationError' is defined but never used. Allowed unused vars must match /^_/u.","line":36,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":36,"endColumn":26,"suggestions":[{"messageId":"removeVar","data":{"varName":"CacheSerializationError"},"fix":{"range":[744,771],"text":""},"desc":"Remove unused variable 'CacheSerializationError'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CacheSerializationError' is defined but never used. Allowed unused vars must match /^_/u.","line":36,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":36,"endColumn":26},{"ruleId":"no-unused-vars","severity":2,"message":"'SerializationOptions' is defined but never used. Allowed unused vars must match /^_/u.","line":45,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":45,"endColumn":23,"suggestions":[{"messageId":"removeVar","data":{"varName":"SerializationOptions"},"fix":{"range":[906,930],"text":""},"desc":"Remove unused variable 'SerializationOptions'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'SerializationOptions' is defined but never used. Allowed unused vars must match /^_/u.","line":45,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":45,"endColumn":23},{"ruleId":"no-unused-vars","severity":2,"message":"'CacheExportData' is defined but never used. Allowed unused vars must match /^_/u.","line":46,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":46,"endColumn":18,"suggestions":[{"messageId":"removeVar","data":{"varName":"CacheExportData"},"fix":{"range":[930,949],"text":""},"desc":"Remove unused variable 'CacheExportData'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CacheExportData' is defined but never used. Allowed unused vars must match /^_/u.","line":46,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":46,"endColumn":18},{"ruleId":"no-unused-vars","severity":2,"message":"'CacheSyncOptions' is defined but never used. Allowed unused vars must match /^_/u.","line":47,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":47,"endColumn":19,"suggestions":[{"messageId":"removeVar","data":{"varName":"CacheSyncOptions"},"fix":{"range":[949,969],"text":""},"desc":"Remove unused variable 'CacheSyncOptions'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CacheSyncOptions' is defined but never used. Allowed unused vars must match /^_/u.","line":47,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":47,"endColumn":19},{"ruleId":"no-unused-vars","severity":2,"message":"'CachePartitionConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":48,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":48,"endColumn":23,"suggestions":[{"messageId":"removeVar","data":{"varName":"CachePartitionConfig"},"fix":{"range":[969,993],"text":""},"desc":"Remove unused variable 'CachePartitionConfig'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CachePartitionConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":48,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":48,"endColumn":23},{"ruleId":"no-unused-vars","severity":2,"message":"'CacheCompressionConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":49,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":49,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"CacheCompressionConfig"},"fix":{"range":[993,1019],"text":""},"desc":"Remove unused variable 'CacheCompressionConfig'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CacheCompressionConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":49,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":49,"endColumn":25},{"ruleId":"no-unused-vars","severity":2,"message":"'CacheEncryptionConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":50,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":50,"endColumn":24,"suggestions":[{"messageId":"removeVar","data":{"varName":"CacheEncryptionConfig"},"fix":{"range":[1019,1044],"text":""},"desc":"Remove unused variable 'CacheEncryptionConfig'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CacheEncryptionConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":50,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":50,"endColumn":24},{"ruleId":"no-unused-vars","severity":2,"message":"'CacheMonitoringConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":51,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":51,"endColumn":24,"suggestions":[{"messageId":"removeVar","data":{"varName":"CacheMonitoringConfig"},"fix":{"range":[1044,1069],"text":""},"desc":"Remove unused variable 'CacheMonitoringConfig'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CacheMonitoringConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":51,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":51,"endColumn":24},{"ruleId":"no-unused-vars","severity":2,"message":"'CacheBackupConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":52,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":52,"endColumn":20,"suggestions":[{"messageId":"removeVar","data":{"varName":"CacheBackupConfig"},"fix":{"range":[1069,1090],"text":""},"desc":"Remove unused variable 'CacheBackupConfig'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CacheBackupConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":52,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":52,"endColumn":20},{"ruleId":"no-unused-vars","severity":2,"message":"'CacheRecoveryOptions' is defined but never used. Allowed unused vars must match /^_/u.","line":53,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":53,"endColumn":23,"suggestions":[{"messageId":"removeVar","data":{"varName":"CacheRecoveryOptions"},"fix":{"range":[1090,1114],"text":""},"desc":"Remove unused variable 'CacheRecoveryOptions'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CacheRecoveryOptions' is defined but never used. Allowed unused vars must match /^_/u.","line":53,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":53,"endColumn":23},{"ruleId":"no-unused-vars","severity":2,"message":"'CachePerformanceConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":54,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":54,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"CachePerformanceConfig"},"fix":{"range":[1114,1140],"text":""},"desc":"Remove unused variable 'CachePerformanceConfig'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CachePerformanceConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":54,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":54,"endColumn":25},{"ruleId":"no-unused-vars","severity":2,"message":"'CacheSecurityConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":55,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":55,"endColumn":22,"suggestions":[{"messageId":"removeVar","data":{"varName":"CacheSecurityConfig"},"fix":{"range":[1140,1163],"text":""},"desc":"Remove unused variable 'CacheSecurityConfig'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CacheSecurityConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":55,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":55,"endColumn":22},{"ruleId":"no-unused-vars","severity":2,"message":"'CacheObserver' is defined but never used. Allowed unused vars must match /^_/u.","line":56,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":56,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"CacheObserver"},"fix":{"range":[1163,1180],"text":""},"desc":"Remove unused variable 'CacheObserver'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CacheObserver' is defined but never used. Allowed unused vars must match /^_/u.","line":56,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":56,"endColumn":16},{"ruleId":"no-unused-vars","severity":2,"message":"'CacheMiddleware' is defined but never used. Allowed unused vars must match /^_/u.","line":57,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":57,"endColumn":18,"suggestions":[{"messageId":"removeVar","data":{"varName":"CacheMiddleware"},"fix":{"range":[1180,1199],"text":""},"desc":"Remove unused variable 'CacheMiddleware'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CacheMiddleware' is defined but never used. Allowed unused vars must match /^_/u.","line":57,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":57,"endColumn":18},{"ruleId":"no-unused-vars","severity":2,"message":"'CacheStrategyInterface' is defined but never used. Allowed unused vars must match /^_/u.","line":58,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":58,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"CacheStrategyInterface"},"fix":{"range":[1199,1225],"text":""},"desc":"Remove unused variable 'CacheStrategyInterface'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CacheStrategyInterface' is defined but never used. Allowed unused vars must match /^_/u.","line":58,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":58,"endColumn":25},{"ruleId":"no-unused-vars","severity":2,"message":"'CacheAdapter' is defined but never used. Allowed unused vars must match /^_/u.","line":59,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":59,"endColumn":15,"suggestions":[{"messageId":"removeVar","data":{"varName":"CacheAdapter"},"fix":{"range":[1225,1241],"text":""},"desc":"Remove unused variable 'CacheAdapter'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CacheAdapter' is defined but never used. Allowed unused vars must match /^_/u.","line":59,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":59,"endColumn":15},{"ruleId":"no-unused-vars","severity":2,"message":"'CacheFactory' is defined but never used. Allowed unused vars must match /^_/u.","line":60,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":60,"endColumn":15,"suggestions":[{"messageId":"removeVar","data":{"varName":"CacheFactory"},"fix":{"range":[1241,1257],"text":""},"desc":"Remove unused variable 'CacheFactory'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CacheFactory' is defined but never used. Allowed unused vars must match /^_/u.","line":60,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":60,"endColumn":15},{"ruleId":"no-unused-vars","severity":2,"message":"'CacheEventEmitter' is defined but never used. Allowed unused vars must match /^_/u.","line":61,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":61,"endColumn":20,"suggestions":[{"messageId":"removeVar","data":{"varName":"CacheEventEmitter"},"fix":{"range":[1257,1278],"text":""},"desc":"Remove unused variable 'CacheEventEmitter'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CacheEventEmitter' is defined but never used. Allowed unused vars must match /^_/u.","line":61,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":61,"endColumn":20},{"ruleId":"no-unused-vars","severity":2,"message":"'CachePlugin' is defined but never used. Allowed unused vars must match /^_/u.","line":62,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":62,"endColumn":14,"suggestions":[{"messageId":"removeVar","data":{"varName":"CachePlugin"},"fix":{"range":[1278,1293],"text":""},"desc":"Remove unused variable 'CachePlugin'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CachePlugin' is defined but never used. Allowed unused vars must match /^_/u.","line":62,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":62,"endColumn":14},{"ruleId":"no-unused-vars","severity":2,"message":"'CacheLifecycleHooks' is defined but never used. Allowed unused vars must match /^_/u.","line":63,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":63,"endColumn":22,"suggestions":[{"messageId":"removeVar","data":{"varName":"CacheLifecycleHooks"},"fix":{"range":[1293,1316],"text":""},"desc":"Remove unused variable 'CacheLifecycleHooks'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CacheLifecycleHooks' is defined but never used. Allowed unused vars must match /^_/u.","line":63,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":63,"endColumn":22},{"ruleId":"no-unused-vars","severity":2,"message":"'CacheStatsCollector' is defined but never used. Allowed unused vars must match /^_/u.","line":64,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":64,"endColumn":22,"suggestions":[{"messageId":"removeVar","data":{"varName":"CacheStatsCollector"},"fix":{"range":[1316,1339],"text":""},"desc":"Remove unused variable 'CacheStatsCollector'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CacheStatsCollector' is defined but never used. Allowed unused vars must match /^_/u.","line":64,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":64,"endColumn":22},{"ruleId":"no-unused-vars","severity":2,"message":"'CacheWarmingConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":71,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":71,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"CacheWarmingConfig"},"fix":{"range":[1462,1484],"text":""},"desc":"Remove unused variable 'CacheWarmingConfig'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CacheWarmingConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":71,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":71,"endColumn":21},{"ruleId":"no-unused-vars","severity":2,"message":"'CacheInvalidationConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":72,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":72,"endColumn":26,"suggestions":[{"messageId":"removeVar","data":{"varName":"CacheInvalidationConfig"},"fix":{"range":[1484,1511],"text":""},"desc":"Remove unused variable 'CacheInvalidationConfig'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CacheInvalidationConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":72,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":72,"endColumn":26},{"ruleId":"no-unused-vars","severity":2,"message":"'CacheConsistencyConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":73,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":73,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"CacheConsistencyConfig"},"fix":{"range":[1511,1537],"text":""},"desc":"Remove unused variable 'CacheConsistencyConfig'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CacheConsistencyConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":73,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":73,"endColumn":25},{"ruleId":"no-unused-vars","severity":2,"message":"'CacheRateLimitConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":74,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":74,"endColumn":23,"suggestions":[{"messageId":"removeVar","data":{"varName":"CacheRateLimitConfig"},"fix":{"range":[1537,1561],"text":""},"desc":"Remove unused variable 'CacheRateLimitConfig'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CacheRateLimitConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":74,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":74,"endColumn":23},{"ruleId":"no-unused-vars","severity":2,"message":"'CacheQualityConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":75,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":75,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"CacheQualityConfig"},"fix":{"range":[1561,1583],"text":""},"desc":"Remove unused variable 'CacheQualityConfig'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CacheQualityConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":75,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":75,"endColumn":21},{"ruleId":"no-unused-vars","severity":2,"message":"'CacheExtensionConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":76,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":76,"endColumn":23,"suggestions":[{"messageId":"removeVar","data":{"varName":"CacheExtensionConfig"},"fix":{"range":[1583,1607],"text":""},"desc":"Remove unused variable 'CacheExtensionConfig'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CacheExtensionConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":76,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":76,"endColumn":23},{"ruleId":"no-unused-vars","severity":2,"message":"'CacheEnvironmentConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":77,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":77,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"CacheEnvironmentConfig"},"fix":{"range":[1607,1633],"text":""},"desc":"Remove unused variable 'CacheEnvironmentConfig'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CacheEnvironmentConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":77,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":77,"endColumn":25},{"ruleId":"no-unused-vars","severity":2,"message":"'DEFAULT_ADVANCED_CACHE_CONFIG' is defined but never used. Allowed unused vars must match /^_/u.","line":78,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":78,"endColumn":32,"suggestions":[{"messageId":"removeVar","data":{"varName":"DEFAULT_ADVANCED_CACHE_CONFIG"},"fix":{"range":[1633,1666],"text":""},"desc":"Remove unused variable 'DEFAULT_ADVANCED_CACHE_CONFIG'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'DEFAULT_ADVANCED_CACHE_CONFIG' is defined but never used. Allowed unused vars must match /^_/u.","line":78,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":78,"endColumn":32},{"ruleId":"no-duplicate-imports","severity":2,"message":"'./i18n-cache-types-advanced' import is duplicated.","line":81,"column":1,"nodeType":"ImportDeclaration","messageId":"import","endLine":83,"endColumn":38},{"ruleId":"no-unused-vars","severity":2,"message":"'CacheConfigFactory' is defined but never used. Allowed unused vars must match /^_/u.","line":82,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":82,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"CacheConfigFactory"},"fix":{"range":[1707,1775],"text":""},"desc":"Remove unused variable 'CacheConfigFactory'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CacheConfigFactory' is defined but never used. Allowed unused vars must match /^_/u.","line":82,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":82,"endColumn":21},{"ruleId":"no-unused-vars","severity":2,"message":"'CacheKeyUtils' is defined but never used. Allowed unused vars must match /^_/u.","line":86,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":86,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"CacheKeyUtils"},"fix":{"range":[1788,1802],"text":""},"desc":"Remove unused variable 'CacheKeyUtils'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CacheKeyUtils' is defined but never used. Allowed unused vars must match /^_/u.","line":86,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":86,"endColumn":16},{"ruleId":"no-unused-vars","severity":2,"message":"'CacheTimeUtils' is defined but never used. Allowed unused vars must match /^_/u.","line":87,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":87,"endColumn":17,"suggestions":[{"messageId":"removeVar","data":{"varName":"CacheTimeUtils"},"fix":{"range":[1801,1819],"text":""},"desc":"Remove unused variable 'CacheTimeUtils'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CacheTimeUtils' is defined but never used. Allowed unused vars must match /^_/u.","line":87,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":87,"endColumn":17},{"ruleId":"no-unused-vars","severity":2,"message":"'CacheSizeUtils' is defined but never used. Allowed unused vars must match /^_/u.","line":88,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":88,"endColumn":17,"suggestions":[{"messageId":"removeVar","data":{"varName":"CacheSizeUtils"},"fix":{"range":[1819,1837],"text":""},"desc":"Remove unused variable 'CacheSizeUtils'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CacheSizeUtils' is defined but never used. Allowed unused vars must match /^_/u.","line":88,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":88,"endColumn":17},{"ruleId":"no-unused-vars","severity":2,"message":"'CacheStatsUtils' is defined but never used. Allowed unused vars must match /^_/u.","line":89,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":89,"endColumn":18,"suggestions":[{"messageId":"removeVar","data":{"varName":"CacheStatsUtils"},"fix":{"range":[1837,1856],"text":""},"desc":"Remove unused variable 'CacheStatsUtils'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CacheStatsUtils' is defined but never used. Allowed unused vars must match /^_/u.","line":89,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":89,"endColumn":18},{"ruleId":"no-unused-vars","severity":2,"message":"'CacheValidationUtils' is defined but never used. Allowed unused vars must match /^_/u.","line":90,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":90,"endColumn":23,"suggestions":[{"messageId":"removeVar","data":{"varName":"CacheValidationUtils"},"fix":{"range":[1856,1880],"text":""},"desc":"Remove unused variable 'CacheValidationUtils'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CacheValidationUtils' is defined but never used. Allowed unused vars must match /^_/u.","line":90,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":90,"endColumn":23},{"ruleId":"no-unused-vars","severity":2,"message":"'CacheSerializationUtils' is defined but never used. Allowed unused vars must match /^_/u.","line":91,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":91,"endColumn":26,"suggestions":[{"messageId":"removeVar","data":{"varName":"CacheSerializationUtils"},"fix":{"range":[1880,1907],"text":""},"desc":"Remove unused variable 'CacheSerializationUtils'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CacheSerializationUtils' is defined but never used. Allowed unused vars must match /^_/u.","line":91,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":91,"endColumn":26},{"ruleId":"no-unused-vars","severity":2,"message":"'CacheEventUtils' is defined but never used. Allowed unused vars must match /^_/u.","line":92,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":92,"endColumn":18,"suggestions":[{"messageId":"removeVar","data":{"varName":"CacheEventUtils"},"fix":{"range":[1907,1926],"text":""},"desc":"Remove unused variable 'CacheEventUtils'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CacheEventUtils' is defined but never used. Allowed unused vars must match /^_/u.","line":92,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":92,"endColumn":18},{"ruleId":"no-unused-vars","severity":2,"message":"'CacheDebugUtils' is defined but never used. Allowed unused vars must match /^_/u.","line":93,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":93,"endColumn":18,"suggestions":[{"messageId":"removeVar","data":{"varName":"CacheDebugUtils"},"fix":{"range":[1926,1945],"text":""},"desc":"Remove unused variable 'CacheDebugUtils'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CacheDebugUtils' is defined but never used. Allowed unused vars must match /^_/u.","line":93,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":93,"endColumn":18}],"suppressedMessages":[],"errorCount":105,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 国际化缓存基础类型定义 - 主入口\n * I18n Cache Base Type Definitions - Main Entry Point\n *\n * 统一的国际化缓存类型入口，整合所有类型定义模块\n */\n\n// 重新导出所有模块的功能\nexport * from './i18n-cache-types-base';\nexport * from './i18n-cache-types-interfaces';\nexport * from './i18n-cache-types-advanced';\nexport * from './i18n-cache-types-utils';\n\n// 向后兼容的重新导出\nimport type { I18nMetrics, Locale, Messages } from '@/types/i18n';\n\nimport type {\n  CacheConfig,\n  CacheItem,\n  CacheStats,\n  PreloadConfig,\n  CacheOperationResult,\n  CacheEventType,\n  CacheEvent,\n  CacheEventListener,\n  CacheStrategy,\n  CacheConfigValidation,\n  CacheHealthCheck,\n  CacheDebugInfo,\n  DEFAULT_CACHE_CONFIG,\n  DEFAULT_PRELOAD_CONFIG,\n  CACHE_CONSTANTS,\n  CacheError,\n  CacheValidationError,\n  CacheStorageError,\n  CacheSerializationError,\n} from './i18n-cache-types-base';\n\nimport type {\n  CacheStorage,\n  PersistentStorage,\n  MetricsCollector,\n  Preloader,\n  CacheManager,\n  SerializationOptions,\n  CacheExportData,\n  CacheSyncOptions,\n  CachePartitionConfig,\n  CacheCompressionConfig,\n  CacheEncryptionConfig,\n  CacheMonitoringConfig,\n  CacheBackupConfig,\n  CacheRecoveryOptions,\n  CachePerformanceConfig,\n  CacheSecurityConfig,\n  CacheObserver,\n  CacheMiddleware,\n  CacheStrategyInterface,\n  CacheAdapter,\n  CacheFactory,\n  CacheEventEmitter,\n  CachePlugin,\n  CacheLifecycleHooks,\n  CacheStatsCollector,\n} from './i18n-cache-types-interfaces';\n\nimport type {\n  AdvancedCacheConfig,\n  CacheClusterConfig,\n  CacheShardingConfig,\n  CacheWarmingConfig,\n  CacheInvalidationConfig,\n  CacheConsistencyConfig,\n  CacheRateLimitConfig,\n  CacheQualityConfig,\n  CacheExtensionConfig,\n  CacheEnvironmentConfig,\n  DEFAULT_ADVANCED_CACHE_CONFIG,\n} from './i18n-cache-types-advanced';\n\nimport {\n  CacheConfigFactory,\n} from './i18n-cache-types-advanced';\n\nimport {\n  CacheKeyUtils,\n  CacheTimeUtils,\n  CacheSizeUtils,\n  CacheStatsUtils,\n  CacheValidationUtils,\n  CacheSerializationUtils,\n  CacheEventUtils,\n  CacheDebugUtils,\n} from './i18n-cache-types-utils';\n\n// ==================== 向后兼容的类型别名 ====================\n\n/**\n * 向后兼容的类型别名\n * Backward compatible type aliases\n */\nexport type {\n  // 基础类型\n  CacheConfig as Config,\n  CacheItem as Item,\n  CacheStats as Stats,\n  CacheEvent as Event,\n  CacheManager as Manager,\n\n  // 高级配置\n  AdvancedCacheConfig as AdvancedConfig,\n  CacheClusterConfig as ClusterConfig,\n  CacheShardingConfig as ShardingConfig,\n\n  // 接口\n  CacheStorage as Storage,\n  PersistentStorage as PersistentStore,\n  MetricsCollector as Metrics,\n  Preloader as PreloadManager,\n\n  // 工具类型\n  CacheEventType as EventType,\n  CacheStrategy as Strategy,\n  CacheEventListener as EventListener,\n};\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/i18n-cache.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/i18n-event-collector.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/i18n-lru-cache.ts","messages":[{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":342,"column":28,"nodeType":"MemberExpression","endLine":342,"endColumn":39},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":343,"column":9,"nodeType":"MemberExpression","endLine":343,"endColumn":20},{"ruleId":"no-unused-vars","severity":2,"message":"'event' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":348,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":348,"endColumn":31,"suggestions":[{"messageId":"removeVar","data":{"varName":"event"},"fix":{"range":[8581,8796],"text":""},"desc":"Remove unused variable 'event'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'event' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":348,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":348,"endColumn":16},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":349,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":349,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8632,8635],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8632,8635],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * LRU (Least Recently Used) 缓存实现\n * \n * 提供高性能的 LRU 缓存，支持 TTL、持久化存储和性能监控\n */\n\nimport type { \n  CacheConfig, \n  CacheItem, \n  CacheStats, \n  CacheStorage,\n  CacheEvent,\n  MetricsCollector \n} from './i18n-cache-types';\n\n// LRU 缓存实现\nexport class LRUCache<T> implements CacheStorage<T> {\n  private cache = new Map<string, CacheItem<T>>();\n  private config: CacheConfig;\n  private metricsCollector: MetricsCollector;\n\n  constructor(config: CacheConfig, metricsCollector: MetricsCollector) {\n    this.config = config;\n    this.metricsCollector = metricsCollector;\n\n    if (config.enablePersistence && typeof window !== 'undefined') {\n      this.loadFromStorage();\n    }\n  }\n\n  // 获取缓存项\n  get(key: string): T | null {\n    const item = this.cache.get(key);\n\n    if (!item) {\n      this.metricsCollector.recordCacheMiss();\n      this.emitEvent('miss', key);\n      return null;\n    }\n\n    // 检查是否过期\n    if (Date.now() - item.timestamp > item.ttl) {\n      this.cache.delete(key);\n      this.metricsCollector.recordCacheMiss();\n      this.emitEvent('expire', key, item.data);\n      return null;\n    }\n\n    // 更新访问顺序 (LRU)\n    this.cache.delete(key);\n    item.hits += 1;\n    this.cache.set(key, item);\n\n    this.metricsCollector.recordCacheHit();\n    this.emitEvent('hit', key, item.data);\n    return item.data;\n  }\n\n  // 设置缓存项\n  set(key: string, value: T, customTtl?: number): void {\n    const ttl = customTtl || this.config.ttl;\n\n    // 如果缓存已满，删除最旧的项\n    if (this.cache.size >= this.config.maxSize) {\n      const firstKey = this.cache.keys().next().value;\n      if (firstKey !== undefined) {\n        const removedItem = this.cache.get(firstKey);\n        this.cache.delete(firstKey);\n        this.emitEvent('delete', firstKey, removedItem?.data);\n      }\n    }\n\n    const item: CacheItem<T> = {\n      data: value,\n      timestamp: Date.now(),\n      ttl,\n      hits: 0,\n    };\n\n    this.cache.set(key, item);\n    this.emitEvent('set', key, value);\n\n    if (this.config.enablePersistence) {\n      this.saveToStorage();\n    }\n  }\n\n  // 检查是否存在\n  has(key: string): boolean {\n    return this.get(key) !== null;\n  }\n\n  // 删除缓存项\n  delete(key: string): boolean {\n    const item = this.cache.get(key);\n    const deleted = this.cache.delete(key);\n    \n    if (deleted) {\n      this.emitEvent('delete', key, item?.data);\n      if (this.config.enablePersistence) {\n        this.saveToStorage();\n      }\n    }\n    \n    return deleted;\n  }\n\n  // 清空缓存\n  clear(): void {\n    this.cache.clear();\n    this.emitEvent('clear');\n    \n    if (this.config.enablePersistence && typeof window !== 'undefined') {\n      localStorage.removeItem(this.config.storageKey);\n    }\n  }\n\n  // 获取缓存大小\n  size(): number {\n    return this.cache.size;\n  }\n\n  // 获取所有键\n  keys(): IterableIterator<string> {\n    return this.cache.keys();\n  }\n\n  // 获取所有值\n  values(): IterableIterator<T> {\n    return Array.from(this.cache.values()).map(item => item.data)[Symbol.iterator]();\n  }\n\n  // 获取所有条目\n  entries(): IterableIterator<[string, T]> {\n    const entries = Array.from(this.cache.entries()).map(([key, item]) => [key, item.data] as [string, T]);\n    return entries[Symbol.iterator]();\n  }\n\n  // 获取缓存统计信息\n  getStats(): CacheStats {\n    const items = Array.from(this.cache.values());\n    return {\n      size: this.cache.size,\n      totalHits: items.reduce((sum, item) => sum + item.hits, 0),\n      averageAge:\n        items.length > 0\n          ? items.reduce(\n              (sum, item) => sum + (Date.now() - item.timestamp),\n              0,\n            ) / items.length\n          : 0,\n    };\n  }\n\n  // 获取详细统计信息\n  getDetailedStats() {\n    const items = Array.from(this.cache.values());\n    const now = Date.now();\n    \n    const ages = items.map(item => now - item.timestamp);\n    const hits = items.map(item => item.hits);\n    const ttls = items.map(item => item.ttl);\n    \n    return {\n      ...this.getStats(),\n      memoryUsage: this.estimateMemoryUsage(),\n      ageDistribution: {\n        min: Math.min(...ages),\n        max: Math.max(...ages),\n        median: this.calculateMedian(ages),\n        average: ages.length > 0 ? ages.reduce((a, b) => a + b, 0) / ages.length : 0,\n      },\n      hitDistribution: {\n        min: Math.min(...hits),\n        max: Math.max(...hits),\n        median: this.calculateMedian(hits),\n        average: hits.length > 0 ? hits.reduce((a, b) => a + b, 0) / hits.length : 0,\n      },\n      ttlDistribution: {\n        min: Math.min(...ttls),\n        max: Math.max(...ttls),\n        median: this.calculateMedian(ttls),\n        average: ttls.length > 0 ? ttls.reduce((a, b) => a + b, 0) / ttls.length : 0,\n      },\n      expiredItems: items.filter(item => now - item.timestamp > item.ttl).length,\n      utilizationRate: (this.cache.size / this.config.maxSize) * 100,\n    };\n  }\n\n  // 清理过期项\n  cleanup(): number {\n    const now = Date.now();\n    let cleanedCount = 0;\n    \n    for (const [key, item] of this.cache.entries()) {\n      if (now - item.timestamp > item.ttl) {\n        this.cache.delete(key);\n        this.emitEvent('expire', key, item.data);\n        cleanedCount += 1;\n      }\n    }\n    \n    if (cleanedCount > 0 && this.config.enablePersistence) {\n      this.saveToStorage();\n    }\n    \n    return cleanedCount;\n  }\n\n  // 预热缓存\n  warmup(entries: Array<{ key: string; value: T; ttl?: number }>): void {\n    entries.forEach(({ key, value, ttl }) => {\n      this.set(key, value, ttl);\n    });\n  }\n\n  // 批量获取\n  getMultiple(keys: string[]): Map<string, T | null> {\n    const result = new Map<string, T | null>();\n    keys.forEach(key => {\n      result.set(key, this.get(key));\n    });\n    return result;\n  }\n\n  // 批量设置\n  setMultiple(entries: Array<{ key: string; value: T; ttl?: number }>): void {\n    entries.forEach(({ key, value, ttl }) => {\n      this.set(key, value, ttl);\n    });\n  }\n\n  // 批量删除\n  deleteMultiple(keys: string[]): number {\n    let deletedCount = 0;\n    keys.forEach(key => {\n      if (this.delete(key)) {\n        deletedCount += 1;\n      }\n    });\n    return deletedCount;\n  }\n\n  // 从存储加载\n  private loadFromStorage(): void {\n    try {\n      const stored = localStorage.getItem(this.config.storageKey);\n      if (stored) {\n        const data = JSON.parse(stored);\n        if (data && typeof data === 'object') {\n          Object.entries(data).forEach(([key, item]) => {\n            if (this.isValidCacheItem(item)) {\n              this.cache.set(key, item as CacheItem<T>);\n            }\n          });\n        }\n      }\n    } catch (error) {\n      console.warn('Failed to load cache from storage:', error);\n    }\n  }\n\n  // 保存到存储\n  private saveToStorage(): void {\n    if (typeof window === 'undefined') return;\n    \n    try {\n      const data = Object.fromEntries(this.cache.entries());\n      localStorage.setItem(this.config.storageKey, JSON.stringify(data));\n    } catch (error) {\n      console.warn('Failed to save cache to storage:', error);\n    }\n  }\n\n  // 验证缓存项\n  private isValidCacheItem(item: unknown): boolean {\n    return (\n      typeof item === 'object' &&\n      item !== null &&\n      'data' in item &&\n      'timestamp' in item &&\n      'ttl' in item &&\n      'hits' in item\n    );\n  }\n\n  // 估算内存使用量\n  private estimateMemoryUsage(): number {\n    let totalSize = 0;\n    \n    for (const [key, item] of this.cache.entries()) {\n      // 估算键的大小\n      totalSize += key.length * 2; // UTF-16 字符\n      \n      // 估算值的大小\n      totalSize += this.estimateObjectSize(item.data);\n      \n      // 估算缓存项元数据的大小\n      totalSize += 32; // timestamp, ttl, hits 等\n    }\n    \n    return totalSize;\n  }\n\n  // 估算对象大小\n  private estimateObjectSize(obj: unknown): number {\n    if (obj === null || obj === undefined) return 0;\n    \n    if (typeof obj === 'string') {\n      return obj.length * 2; // UTF-16\n    }\n    \n    if (typeof obj === 'number') {\n      return 8; // 64-bit number\n    }\n    \n    if (typeof obj === 'boolean') {\n      return 4;\n    }\n    \n    if (Array.isArray(obj)) {\n      return obj.reduce((sum, item) => sum + this.estimateObjectSize(item), 0);\n    }\n    \n    if (typeof obj === 'object') {\n      return Object.entries(obj).reduce((sum, [key, value]) => {\n        return sum + key.length * 2 + this.estimateObjectSize(value);\n      }, 0);\n    }\n    \n    return 0;\n  }\n\n  // 计算中位数\n  private calculateMedian(numbers: number[]): number {\n    if (numbers.length === 0) return 0;\n    \n    const sorted = [...numbers].sort((a, b) => a - b);\n    const mid = Math.floor(sorted.length / 2);\n    \n    return sorted.length % 2 === 0\n      ? (sorted[mid - 1] + sorted[mid]) / 2\n      : sorted[mid];\n  }\n\n  // 发出事件\n  private emitEvent(type: string, key?: string, data?: T): void {\n    const event: CacheEvent<T> = {\n      type: type as any,\n      key,\n      data,\n      timestamp: Date.now(),\n      metadata: {\n        cacheSize: this.cache.size,\n        maxSize: this.config.maxSize,\n      },\n    };\n    \n    // 这里可以添加事件发射逻辑\n    // 由于 MetricsCollector 已经处理了基本事件，这里主要用于扩展\n  }\n}\n\n// 创建 LRU 缓存实例的工厂函数\nexport function createLRUCache<T>(\n  config: CacheConfig,\n  metricsCollector: MetricsCollector\n): LRUCache<T> {\n  return new LRUCache<T>(config, metricsCollector);\n}\n\n// 导出类型别名\nexport type {\n  LRUCache as Cache,\n};\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/i18n-metrics-collector.ts","messages":[{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":96,"column":5,"nodeType":"MemberExpression","endLine":96,"endColumn":34},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":96,"column":38,"nodeType":"MemberExpression","endLine":96,"endColumn":67},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":104,"column":21,"nodeType":"MemberExpression","endLine":104,"endColumn":50},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":223,"column":36,"nodeType":"MemberExpression","endLine":223,"endColumn":65},{"ruleId":"prefer-destructuring","severity":2,"message":"Use object destructuring.","line":266,"column":11,"nodeType":"VariableDeclarator","messageId":"preferDestructuring","endLine":266,"endColumn":45,"fix":{"range":[6580,6614],"text":"{errorRate} = this.metrics"}}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"/**\n * 国际化性能指标收集器\n *\n * 负责收集和管理 i18n 系统的性能指标，包括缓存命中率、加载时间、错误率等\n */\n\nimport type { I18nMetrics, Locale } from '@/types/i18n';\nimport type { MetricsCollector, CacheEvent, CacheEventListener } from './i18n-cache-types';\n\n// 性能指标收集器实现\nexport class I18nMetricsCollector implements MetricsCollector {\n  private metrics: I18nMetrics = {\n    loadTime: 0,\n    cacheHitRate: 0,\n    errorRate: 0,\n    translationCoverage: 0,\n    localeUsage: { en: 0, zh: 0 },\n  };\n\n  private totalRequests = 0;\n  private cacheHits = 0;\n  private errors = 0;\n  private loadTimes: number[] = [];\n  private localeUsageCount: Record<string, number> = {};\n  private eventListeners: Map<string, CacheEventListener[]> = new Map();\n  private startTime = Date.now();\n\n  // 记录加载时间\n  recordLoadTime(time: number): void {\n    this.loadTimes.push(time);\n\n    // 保持最近 100 次记录以计算平均值\n    if (this.loadTimes.length > 100) {\n      this.loadTimes = this.loadTimes.slice(-100);\n    }\n\n    this.metrics.loadTime =\n      this.loadTimes.reduce((a, b) => a + b, 0) / this.loadTimes.length;\n\n    this.emitEvent({\n      type: 'hit',\n      timestamp: Date.now(),\n      metadata: { loadTime: time }\n    });\n  }\n\n  // 记录缓存命中\n  recordCacheHit(): void {\n    this.cacheHits += 1;\n    this.totalRequests += 1;\n    this.updateCacheHitRate();\n\n    this.emitEvent({\n      type: 'hit',\n      timestamp: Date.now(),\n      metadata: {\n        totalHits: this.cacheHits,\n        totalRequests: this.totalRequests,\n        hitRate: this.metrics.cacheHitRate\n      }\n    });\n  }\n\n  // 记录缓存未命中\n  recordCacheMiss(): void {\n    this.totalRequests += 1;\n    this.updateCacheHitRate();\n\n    this.emitEvent({\n      type: 'miss',\n      timestamp: Date.now(),\n      metadata: {\n        totalRequests: this.totalRequests,\n        hitRate: this.metrics.cacheHitRate\n      }\n    });\n  }\n\n  // 记录错误\n  recordError(): void {\n    this.errors += 1;\n    this.updateErrorRate();\n\n    this.emitEvent({\n      type: 'preload_error',\n      timestamp: Date.now(),\n      metadata: {\n        totalErrors: this.errors,\n        errorRate: this.metrics.errorRate\n      }\n    });\n  }\n\n  // 记录语言使用情况\n  recordLocaleUsage(locale: Locale): void {\n    this.localeUsageCount[locale] = (this.localeUsageCount[locale] || 0) + 1;\n    this.updateLocaleUsage();\n\n    this.emitEvent({\n      type: 'hit',\n      timestamp: Date.now(),\n      metadata: {\n        locale,\n        usageCount: this.localeUsageCount[locale],\n        totalUsage: this.getTotalLocaleUsage()\n      }\n    });\n  }\n\n  // 获取当前指标\n  getMetrics(): I18nMetrics {\n    return { ...this.metrics };\n  }\n\n  // 重置指标\n  reset(): void {\n    this.metrics = {\n      loadTime: 0,\n      cacheHitRate: 0,\n      errorRate: 0,\n      translationCoverage: 0,\n      localeUsage: { en: 0, zh: 0 },\n    };\n\n    this.totalRequests = 0;\n    this.cacheHits = 0;\n    this.errors = 0;\n    this.loadTimes = [];\n    this.localeUsageCount = {};\n    this.startTime = Date.now();\n\n    this.emitEvent({\n      type: 'clear',\n      timestamp: Date.now(),\n      metadata: { reason: 'metrics_reset' }\n    });\n  }\n\n  // 获取详细统计信息\n  getDetailedStats() {\n    const uptime = Date.now() - this.startTime;\n    const requestsPerMinute = this.totalRequests > 0 ? (this.totalRequests / (uptime / 60000)) : 0;\n\n    return {\n      uptime,\n      totalRequests: this.totalRequests,\n      cacheHits: this.cacheHits,\n      cacheMisses: this.totalRequests - this.cacheHits,\n      errors: this.errors,\n      requestsPerMinute,\n      averageLoadTime: this.metrics.loadTime,\n      loadTimePercentiles: this.calculateLoadTimePercentiles(),\n      localeDistribution: this.getLocaleDistribution(),\n      performanceGrade: this.calculatePerformanceGrade(),\n    };\n  }\n\n  // 添加事件监听器\n  addEventListener(eventType: string, listener: CacheEventListener): void {\n    if (!this.eventListeners.has(eventType)) {\n      this.eventListeners.set(eventType, []);\n    }\n    this.eventListeners.get(eventType)!.push(listener);\n  }\n\n  // 移除事件监听器\n  removeEventListener(eventType: string, listener: CacheEventListener): void {\n    const listeners = this.eventListeners.get(eventType);\n    if (listeners) {\n      const index = listeners.indexOf(listener);\n      if (index > -1) {\n        listeners.splice(index, 1);\n      }\n    }\n  }\n\n  // 发出事件\n  private emitEvent(event: CacheEvent): void {\n    const listeners = this.eventListeners.get(event.type);\n    if (listeners) {\n      listeners.forEach(listener => {\n        try {\n          listener(event);\n        } catch (error) {\n          console.error('Error in cache event listener:', error);\n        }\n      });\n    }\n\n    // 也发送给通用监听器\n    const allListeners = this.eventListeners.get('*');\n    if (allListeners) {\n      allListeners.forEach(listener => {\n        try {\n          listener(event);\n        } catch (error) {\n          console.error('Error in cache event listener:', error);\n        }\n      });\n    }\n  }\n\n  // 更新缓存命中率\n  private updateCacheHitRate(): void {\n    this.metrics.cacheHitRate = this.totalRequests > 0\n      ? (this.cacheHits / this.totalRequests) * 100\n      : 0;\n  }\n\n  // 更新错误率\n  private updateErrorRate(): void {\n    this.metrics.errorRate = this.totalRequests > 0\n      ? (this.errors / this.totalRequests) * 100\n      : 0;\n  }\n\n  // 更新语言使用情况\n  private updateLocaleUsage(): void {\n    const total = this.getTotalLocaleUsage();\n    if (total > 0) {\n      this.metrics.localeUsage = Object.keys(this.localeUsageCount).reduce(\n        (acc, locale) => {\n          acc[locale as Locale] = (this.localeUsageCount[locale] / total) * 100;\n          return acc;\n        },\n        {} as Record<Locale, number>\n      );\n    }\n  }\n\n  // 获取总语言使用次数\n  private getTotalLocaleUsage(): number {\n    return Object.values(this.localeUsageCount).reduce((sum, count) => sum + count, 0);\n  }\n\n  // 计算加载时间百分位数\n  private calculateLoadTimePercentiles() {\n    if (this.loadTimes.length === 0) {\n      return { p50: 0, p90: 0, p95: 0, p99: 0 };\n    }\n\n    const sorted = [...this.loadTimes].sort((a, b) => a - b);\n    const len = sorted.length;\n\n    return {\n      p50: sorted[Math.floor(len * 0.5)],\n      p90: sorted[Math.floor(len * 0.9)],\n      p95: sorted[Math.floor(len * 0.95)],\n      p99: sorted[Math.floor(len * 0.99)],\n    };\n  }\n\n  // 获取语言分布\n  private getLocaleDistribution() {\n    const total = this.getTotalLocaleUsage();\n    return Object.entries(this.localeUsageCount).map(([locale, count]) => ({\n      locale,\n      count,\n      percentage: total > 0 ? (count / total) * 100 : 0,\n    }));\n  }\n\n  // 计算性能等级\n  private calculatePerformanceGrade(): 'A' | 'B' | 'C' | 'D' | 'F' {\n    const hitRate = this.metrics.cacheHitRate;\n    const errorRate = this.metrics.errorRate;\n    const avgLoadTime = this.metrics.loadTime;\n\n    // 基于多个指标计算综合评分\n    let score = 0;\n\n    // 缓存命中率评分 (40%)\n    if (hitRate >= 95) score += 40;\n    else if (hitRate >= 90) score += 35;\n    else if (hitRate >= 80) score += 30;\n    else if (hitRate >= 70) score += 20;\n    else score += 10;\n\n    // 错误率评分 (30%)\n    if (errorRate <= 0.1) score += 30;\n    else if (errorRate <= 0.5) score += 25;\n    else if (errorRate <= 1) score += 20;\n    else if (errorRate <= 2) score += 10;\n    else score += 0;\n\n    // 平均加载时间评分 (30%)\n    if (avgLoadTime <= 10) score += 30;\n    else if (avgLoadTime <= 50) score += 25;\n    else if (avgLoadTime <= 100) score += 20;\n    else if (avgLoadTime <= 200) score += 10;\n    else score += 0;\n\n    // 根据总分确定等级\n    if (score >= 90) return 'A';\n    if (score >= 80) return 'B';\n    if (score >= 70) return 'C';\n    if (score >= 60) return 'D';\n    return 'F';\n  }\n\n  // 生成性能报告\n  generatePerformanceReport() {\n    const stats = this.getDetailedStats();\n    const percentiles = this.calculateLoadTimePercentiles();\n    const grade = this.calculatePerformanceGrade();\n\n    return {\n      summary: {\n        grade,\n        uptime: stats.uptime,\n        totalRequests: stats.totalRequests,\n        averageLoadTime: stats.averageLoadTime,\n        cacheHitRate: this.metrics.cacheHitRate,\n        errorRate: this.metrics.errorRate,\n      },\n      performance: {\n        requestsPerMinute: stats.requestsPerMinute,\n        loadTimePercentiles: percentiles,\n        cacheEfficiency: {\n          hits: stats.cacheHits,\n          misses: stats.cacheMisses,\n          hitRate: this.metrics.cacheHitRate,\n        },\n      },\n      usage: {\n        localeDistribution: stats.localeDistribution,\n        totalErrors: stats.errors,\n      },\n      recommendations: this.generateRecommendations(stats, grade),\n    };\n  }\n\n  // 生成性能建议\n  private generateRecommendations(stats: Record<string, unknown>, grade: string): string[] {\n    const recommendations: string[] = [];\n\n    if (this.metrics.cacheHitRate < 80) {\n      recommendations.push('考虑增加缓存大小或调整 TTL 以提高缓存命中率');\n    }\n\n    if (this.metrics.errorRate > 1) {\n      recommendations.push('错误率较高，建议检查网络连接和翻译文件完整性');\n    }\n\n    if (this.metrics.loadTime > 100) {\n      recommendations.push('平均加载时间较长，考虑启用预加载或优化翻译文件大小');\n    }\n\n    if (stats.requestsPerMinute > 100) {\n      recommendations.push('请求频率较高，建议增加缓存容量');\n    }\n\n    if (grade === 'D' || grade === 'F') {\n      recommendations.push('整体性能需要改进，建议全面优化缓存策略');\n    }\n\n    return recommendations;\n  }\n}\n\n// 创建默认指标收集器实例\nexport const defaultMetricsCollector = new I18nMetricsCollector();\n\n// 导出工具函数\nexport function createMetricsCollector(): I18nMetricsCollector {\n  return new I18nMetricsCollector();\n}\n\nexport function formatMetrics(metrics: I18nMetrics): string {\n  return `\n缓存命中率: ${metrics.cacheHitRate.toFixed(2)}%\n平均加载时间: ${metrics.loadTime.toFixed(2)}ms\n错误率: ${metrics.errorRate.toFixed(2)}%\n翻译覆盖率: ${metrics.translationCoverage.toFixed(2)}%\n语言使用分布: ${Object.entries(metrics.localeUsage)\n    .map(([locale, usage]) => `${locale}: ${usage.toFixed(1)}%`)\n    .join(', ')}\n  `.trim();\n}\n\n// 导出类型别名\nexport type {\n  I18nMetricsCollector as MetricsCollector,\n};\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/i18n-monitor-core.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/i18n-monitoring-types.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'INFO' is defined but never used. Allowed unused vars must match /^_/u.","line":10,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":7,"suggestions":[{"messageId":"removeVar","data":{"varName":"INFO"},"fix":{"range":[143,147],"text":""},"desc":"Remove unused variable 'INFO'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'WARNING' is defined but never used. Allowed unused vars must match /^_/u.","line":11,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":10,"suggestions":[{"messageId":"removeVar","data":{"varName":"WARNING"},"fix":{"range":[156,167],"text":""},"desc":"Remove unused variable 'WARNING'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'ERROR' is defined but never used. Allowed unused vars must match /^_/u.","line":12,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":8,"suggestions":[{"messageId":"removeVar","data":{"varName":"ERROR"},"fix":{"range":[179,188],"text":""},"desc":"Remove unused variable 'ERROR'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'CRITICAL' is defined but never used. Allowed unused vars must match /^_/u.","line":13,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":11,"suggestions":[{"messageId":"removeVar","data":{"varName":"CRITICAL"},"fix":{"range":[198,210],"text":""},"desc":"Remove unused variable 'CRITICAL'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'TRANSLATION_MISSING' is defined but never used. Allowed unused vars must match /^_/u.","line":18,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":22,"suggestions":[{"messageId":"removeVar","data":{"varName":"TRANSLATION_MISSING"},"fix":{"range":[274,293],"text":""},"desc":"Remove unused variable 'TRANSLATION_MISSING'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'TRANSLATION_ERROR' is defined but never used. Allowed unused vars must match /^_/u.","line":19,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":20,"suggestions":[{"messageId":"removeVar","data":{"varName":"TRANSLATION_ERROR"},"fix":{"range":[317,338],"text":""},"desc":"Remove unused variable 'TRANSLATION_ERROR'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'LOCALE_SWITCH' is defined but never used. Allowed unused vars must match /^_/u.","line":20,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"LOCALE_SWITCH"},"fix":{"range":[360,377],"text":""},"desc":"Remove unused variable 'LOCALE_SWITCH'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'CACHE_MISS' is defined but never used. Allowed unused vars must match /^_/u.","line":21,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":13,"suggestions":[{"messageId":"removeVar","data":{"varName":"CACHE_MISS"},"fix":{"range":[395,409],"text":""},"desc":"Remove unused variable 'CACHE_MISS'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'PERFORMANCE_ISSUE' is defined but never used. Allowed unused vars must match /^_/u.","line":22,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":20,"suggestions":[{"messageId":"removeVar","data":{"varName":"PERFORMANCE_ISSUE"},"fix":{"range":[424,445],"text":""},"desc":"Remove unused variable 'PERFORMANCE_ISSUE'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'QUALITY_ISSUE' is defined but never used. Allowed unused vars must match /^_/u.","line":23,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":23,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"QUALITY_ISSUE"},"fix":{"range":[467,484],"text":""},"desc":"Remove unused variable 'QUALITY_ISSUE'."}]}],"suppressedMessages":[],"errorCount":10,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 企业级国际化监控和错误追踪 - 类型定义\n * 提供翻译错误监控、性能追踪、质量保证等功能的类型定义\n */\n\nimport type { Locale } from '@/types/i18n';\n\n// 错误级别\nexport enum ErrorLevel {\n  INFO = 'info',\n  WARNING = 'warning',\n  ERROR = 'error',\n  CRITICAL = 'critical',\n}\n\n// 监控事件类型\nexport enum MonitoringEventType {\n  TRANSLATION_MISSING = 'translation_missing',\n  TRANSLATION_ERROR = 'translation_error',\n  LOCALE_SWITCH = 'locale_switch',\n  CACHE_MISS = 'cache_miss',\n  PERFORMANCE_ISSUE = 'performance_issue',\n  QUALITY_ISSUE = 'quality_issue',\n}\n\n// 监控事件\nexport interface MonitoringEvent {\n  id: string;\n  type: MonitoringEventType;\n  level: ErrorLevel;\n  timestamp: number;\n  locale: Locale;\n  message: string;\n  metadata?: Record<string, string | number | boolean | Record<string, unknown> | unknown[]>;\n  stackTrace?: string;\n  userAgent?: string;\n  url?: string;\n}\n\n// 性能阈值配置\nexport interface PerformanceThresholds {\n  translationLoadTime: number; // ms\n  cacheHitRate: number; // percentage\n  errorRate: number; // percentage\n  memoryUsage: number; // MB\n}\n\n// 质量阈值配置\nexport interface QualityThresholds {\n  completeness: number; // percentage\n  consistency: number; // percentage\n  accuracy: number; // percentage\n  freshness: number; // days\n}\n\n// 监控配置\nexport interface MonitoringConfig {\n  enabled: boolean;\n  enableConsoleLogging: boolean;\n  enableRemoteLogging: boolean;\n  enablePerformanceTracking: boolean;\n  enableQualityTracking: boolean;\n  performanceThresholds: PerformanceThresholds;\n  qualityThresholds: QualityThresholds;\n  maxEvents: number;\n  flushInterval: number; // ms\n  remoteEndpoint?: string;\n}\n\n// 性能数据结构\nexport interface PerformanceData {\n  loadTimes: number[];\n  cacheHits: number;\n  cacheMisses: number;\n  errors: number;\n  totalRequests: number;\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/i18n-monitoring.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/i18n-performance-monitor.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/i18n-performance.ts","messages":[{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":105,"column":14,"nodeType":"MemberExpression","endLine":105,"endColumn":33}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { cache } from 'react';\nimport {\n  CACHE_DURATIONS,\n  CACHE_LIMITS,\n  PERFORMANCE_THRESHOLDS,\n} from '@/constants/i18n-constants';\n\n// 翻译缓存管理器\nexport class TranslationCache {\n  private static instance: TranslationCache;\n  private cache = new Map<string, unknown>();\n  private readonly maxSize = CACHE_LIMITS.MAX_PERFORMANCE_DATA_POINTS;\n  private readonly ttl = CACHE_DURATIONS.TRANSLATION_CACHE;\n\n  static getInstance(): TranslationCache {\n    if (!TranslationCache.instance) {\n      TranslationCache.instance = new TranslationCache();\n    }\n    return TranslationCache.instance;\n  }\n\n  // 缓存翻译消息\n  set(key: string, value: unknown): void {\n    if (this.cache.size >= this.maxSize) {\n      // LRU清理\n      const firstKey = this.cache.keys().next().value;\n      if (firstKey) {\n        this.cache.delete(firstKey);\n      }\n    }\n\n    this.cache.set(key, {\n      value,\n      timestamp: Date.now(),\n    });\n  }\n\n  // 获取缓存的翻译消息\n  get(key: string): unknown | null {\n    const cached = this.cache.get(key);\n    if (!cached) return null;\n\n    // 检查是否过期\n    if (Date.now() - cached.timestamp > this.ttl) {\n      this.cache.delete(key);\n      return null;\n    }\n\n    return cached.value;\n  }\n\n  // 清理过期缓存\n  cleanup(): void {\n    const now = Date.now();\n    for (const [key, cached] of this.cache.entries()) {\n      if (now - cached.timestamp > this.ttl) {\n        this.cache.delete(key);\n      }\n    }\n  }\n\n  // 获取缓存统计\n  getStats() {\n    return {\n      size: this.cache.size,\n      maxSize: this.maxSize,\n      hitRate: this.calculateHitRate(),\n    };\n  }\n\n  private calculateHitRate(): number {\n    // 简化的命中率计算\n    return this.cache.size > 0 ? PERFORMANCE_THRESHOLDS.EXCELLENT : 0;\n  }\n}\n\n// 缓存的消息加载器\nexport const getCachedMessages = cache(async (locale: string) => {\n  const cacheInstance = TranslationCache.getInstance();\n  const cacheKey = `messages-${locale}`;\n\n  // 检查缓存\n  const cached = cacheInstance.get(cacheKey);\n  if (cached) {\n    return cached;\n  }\n\n  // 加载消息\n  try {\n    const messages = (await import(`../../messages/${locale}.json`)).default;\n    cacheInstance.set(cacheKey, messages);\n    return messages;\n  } catch (error) {\n    console.error(`Failed to load messages for locale ${locale}:`, error);\n    return {};\n  }\n});\n\n// React缓存的翻译函数\nexport const getCachedTranslations = cache(\n  async (locale: string, namespace?: string) => {\n    const messages = await getCachedMessages(locale);\n\n    if (namespace) {\n      return messages[namespace] || {};\n    }\n\n    return messages;\n  },\n);\n\n// 预加载翻译消息\nexport async function preloadTranslations(locales: string[]): Promise<void> {\n  const promises = locales.map((locale) => getCachedMessages(locale));\n  await Promise.all(promises);\n}\n\n// 性能监控\nexport class I18nPerformanceMonitor {\n  private static metrics = {\n    loadTime: [] as number[],\n    cacheHits: 0,\n    cacheMisses: 0,\n    errors: 0,\n  };\n\n  static recordLoadTime(time: number): void {\n    this.metrics.loadTime.push(time);\n    // 保持最近记录数量限制\n    if (this.metrics.loadTime.length > CACHE_LIMITS.MAX_CACHE_ENTRIES) {\n      this.metrics.loadTime.shift();\n    }\n  }\n\n  static recordCacheHit(): void {\n    this.metrics.cacheHits += 1;\n  }\n\n  static recordCacheMiss(): void {\n    this.metrics.cacheMisses += 1;\n  }\n\n  static recordError(): void {\n    this.metrics.errors += 1;\n  }\n\n  static getMetrics() {\n    const loadTimes = this.metrics.loadTime;\n    const avgLoadTime =\n      loadTimes.length > 0\n        ? loadTimes.reduce((a, b) => a + b, 0) / loadTimes.length\n        : 0;\n\n    const totalRequests = this.metrics.cacheHits + this.metrics.cacheMisses;\n    const cacheHitRate =\n      totalRequests > 0\n        ? ((this.metrics.cacheHits / totalRequests) *\n            PERFORMANCE_THRESHOLDS.MAX_RESPONSE_TIME) /\n          10\n        : 0;\n\n    return {\n      averageLoadTime: avgLoadTime,\n      cacheHitRate,\n      totalErrors: this.metrics.errors,\n      totalRequests,\n    };\n  }\n\n  static reset(): void {\n    this.metrics = {\n      loadTime: [],\n      cacheHits: 0,\n      cacheMisses: 0,\n      errors: 0,\n    };\n  }\n}\n\n// 性能基准目标\nexport const PERFORMANCE_TARGETS = {\n  TRANSLATION_LOAD_TIME: {\n    excellent: 50, // < 50ms\n    good: 100, // < 100ms\n    acceptable: 200, // < 200ms\n    poor: 500, // > 500ms\n  },\n\n  CACHE_HIT_RATE: {\n    excellent: PERFORMANCE_THRESHOLDS.EXCELLENT + 3, // > 98%\n    good: PERFORMANCE_THRESHOLDS.EXCELLENT, // > 95%\n    acceptable: PERFORMANCE_THRESHOLDS.GOOD + 10, // > 90%\n    poor: PERFORMANCE_THRESHOLDS.GOOD, // < 80%\n  },\n};\n\n// 性能评估函数\nexport function evaluatePerformance(\n  metrics: ReturnType<typeof I18nPerformanceMonitor.getMetrics>,\n) {\n  const loadTimeScore = getPerformanceScore(\n    metrics.averageLoadTime,\n    PERFORMANCE_TARGETS.TRANSLATION_LOAD_TIME,\n  );\n\n  const cacheScore = getPerformanceScore(\n    metrics.cacheHitRate,\n    PERFORMANCE_TARGETS.CACHE_HIT_RATE,\n    true,\n  );\n\n  const overallScore = (loadTimeScore + cacheScore) / 2;\n\n  return {\n    loadTimeScore,\n    cacheScore,\n    overallScore,\n    grade: getGrade(overallScore),\n  };\n}\n\nfunction getPerformanceScore(\n  value: number,\n  targets: unknown,\n  higherIsBetter = false,\n): number {\n  if (higherIsBetter) {\n    if (value >= targets.excellent) return CACHE_LIMITS.MAX_CACHE_ENTRIES;\n    if (value >= targets.good) return PERFORMANCE_THRESHOLDS.GOOD;\n    if (value >= targets.acceptable) return PERFORMANCE_THRESHOLDS.FAIR;\n    return PERFORMANCE_THRESHOLDS.POOR;\n  }\n\n  if (value <= targets.excellent) return CACHE_LIMITS.MAX_CACHE_ENTRIES;\n  if (value <= targets.good) return PERFORMANCE_THRESHOLDS.GOOD;\n  if (value <= targets.acceptable) return PERFORMANCE_THRESHOLDS.FAIR;\n  return PERFORMANCE_THRESHOLDS.POOR;\n}\n\nfunction getGrade(score: number): string {\n  if (score >= PERFORMANCE_THRESHOLDS.EXCELLENT - 5) return 'A';\n  if (score >= PERFORMANCE_THRESHOLDS.GOOD) return 'B';\n  if (score >= PERFORMANCE_THRESHOLDS.GOOD - 10) return 'C';\n  if (score >= PERFORMANCE_THRESHOLDS.FAIR) return 'D';\n  return 'F';\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/i18n-preloader-core.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'PreloadResult' is defined but never used. Allowed unused vars must match /^_/u.","line":19,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"PreloadResult"},"fix":{"range":[323,340],"text":""},"desc":"Remove unused variable 'PreloadResult'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'PreloadResult' is defined but never used. Allowed unused vars must match /^_/u.","line":19,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":19,"endColumn":16},{"ruleId":"no-unused-vars","severity":2,"message":"'PreloaderConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":22,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":18,"suggestions":[{"messageId":"removeVar","data":{"varName":"PreloaderConfig"},"fix":{"range":[372,391],"text":""},"desc":"Remove unused variable 'PreloaderConfig'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'PreloaderConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":22,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":22,"endColumn":18},{"ruleId":"no-unused-vars","severity":2,"message":"'CACHE_LIMITS' is defined but never used. Allowed unused vars must match /^_/u.","line":27,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":27,"endColumn":22,"suggestions":[{"messageId":"removeVar","data":{"varName":"CACHE_LIMITS"},"fix":{"range":[493,551],"text":""},"desc":"Remove unused variable 'CACHE_LIMITS'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CACHE_LIMITS' is defined but never used. Allowed unused vars must match /^_/u.","line":27,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":27,"endColumn":22},{"ruleId":"max-statements","severity":2,"message":"Async method 'preloadMultipleLocales' has too many statements (21). Maximum allowed is 20.","line":141,"column":31,"nodeType":"FunctionExpression","messageId":"exceed","endLine":192,"endColumn":4},{"ruleId":"security/detect-object-injection","severity":2,"message":"Variable Assigned to Object Injection Sink","line":170,"column":23,"nodeType":"MemberExpression","endLine":170,"endColumn":33},{"ruleId":"prefer-destructuring","severity":2,"message":"Use object destructuring.","line":232,"column":11,"nodeType":"VariableDeclarator","messageId":"preferDestructuring","endLine":232,"endColumn":44,"fix":{"range":[5360,5393],"text":"{localeUsage} = metrics"}},{"ruleId":"require-await","severity":2,"message":"Async method 'processBatch' has no 'await' expression.","line":391,"column":3,"nodeType":"FunctionExpression","messageId":"missingAwait","endLine":391,"endColumn":29,"suggestions":[{"messageId":"removeAsync","fix":{"range":[9498,9504],"text":""},"desc":"Remove 'async'."}]},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":432,"column":12,"nodeType":"MemberExpression","endLine":432,"endColumn":30}],"suppressedMessages":[],"errorCount":11,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"/**\n * 翻译预加载器核心实现\n * Translation Preloader Core Implementation\n *\n * 提供翻译预加载的核心功能和主要类实现\n */\n\nimport type { Locale, Messages } from '@/types/i18n';\nimport type {\n  Preloader,\n  MetricsCollector,\n  CacheStorage,\n  PreloadConfig,\n  CacheOperationResult\n} from './i18n-cache-types';\nimport type {\n  PreloadState,\n  PreloadStats,\n  PreloadResult,\n  PreloadOptions,\n  IPreloader,\n  PreloaderConfig,\n  PreloaderError,\n  PreloaderTimeoutError,\n  PreloaderNetworkError\n} from './i18n-preloader-types';\nimport { CACHE_LIMITS } from '@/constants/i18n-constants';\n\n/**\n * 翻译预加载器核心实现\n * Translation preloader core implementation\n */\nexport class TranslationPreloader implements Preloader, IPreloader {\n  private cache: CacheStorage<Messages>;\n  private metricsCollector: MetricsCollector;\n  private preloadState: PreloadState = {\n    isPreloading: false,\n    progress: 0,\n    totalLocales: 0,\n    completedLocales: 0,\n    errors: [],\n  };\n  private preloadConfig: PreloadConfig;\n  private abortController?: AbortController;\n\n  constructor(\n    cache: CacheStorage<Messages>,\n    metricsCollector: MetricsCollector,\n    config?: Partial<PreloadConfig>\n  ) {\n    this.cache = cache;\n    this.metricsCollector = metricsCollector;\n    this.preloadConfig = {\n      enablePreload: true,\n      preloadLocales: ['en', 'zh'],\n      batchSize: 3,\n      delayBetweenBatches: 100,\n      maxConcurrency: 5,\n      timeout: 10000,\n      retryCount: 3,\n      retryDelay: 1000,\n      ...config,\n    };\n  }\n\n  /**\n   * 预加载指定语言\n   * Preload specific locale\n   */\n  async preloadLocale(locale: Locale, options?: PreloadOptions): Promise<Messages> {\n    const startTime = Date.now();\n\n    try {\n      // 首先检查缓存\n      const cached = this.cache.get(locale);\n      if (cached) {\n        this.metricsCollector.recordLoadTime(Date.now() - startTime);\n        options?.onSuccess?.(locale, cached);\n        return cached;\n      }\n\n      // 从服务器加载\n      const messages = await this.loadMessagesFromServer(locale, options);\n\n      // 存储到缓存\n      this.cache.set(locale, messages);\n      this.metricsCollector.recordLoadTime(Date.now() - startTime);\n\n      options?.onSuccess?.(locale, messages);\n      return messages;\n    } catch (error) {\n      const preloaderError = error instanceof Error\n        ? new PreloaderNetworkError(locale, error)\n        : new PreloaderError(`Failed to preload locale ${locale}`, locale);\n\n      options?.onError?.(preloaderError, locale);\n      throw preloaderError;\n    }\n  }\n\n  /**\n   * 预热缓存\n   * Warmup cache\n   */\n  warmupCache(): void {\n    if (!this.preloadConfig.enablePreload || this.preloadState.isPreloading) {\n      return;\n    }\n\n    this.preloadMultipleLocales(this.preloadConfig.preloadLocales);\n  }\n\n  /**\n   * 检查是否正在预加载\n   * Check if preloading\n   */\n  isPreloading(): boolean {\n    return this.preloadState.isPreloading;\n  }\n\n  /**\n   * 获取预加载进度\n   * Get preload progress\n   */\n  getPreloadProgress(): number {\n    return this.preloadState.progress;\n  }\n\n  /**\n   * 获取预加载状态\n   * Get preload state\n   */\n  getPreloadState(): PreloadState {\n    return { ...this.preloadState };\n  }\n\n  /**\n   * 批量预加载多个语言\n   * Preload multiple locales in batches\n   */\n  async preloadMultipleLocales(\n    locales: Locale[],\n    options?: PreloadOptions\n  ): Promise<CacheOperationResult<Messages>[]> {\n    if (this.preloadState.isPreloading) {\n      throw new PreloaderError('Preloading is already in progress');\n    }\n\n    this.preloadState = {\n      isPreloading: true,\n      progress: 0,\n      totalLocales: locales.length,\n      completedLocales: 0,\n      errors: [],\n      startTime: Date.now(),\n    };\n\n    this.abortController = new AbortController();\n    const results: CacheOperationResult<Messages>[] = [];\n\n    try {\n      // 分批处理\n      const batches = this.createBatches(locales, this.preloadConfig.batchSize);\n\n      for (let i = 0; i < batches.length; i++) {\n        if (this.abortController.signal.aborted) {\n          break;\n        }\n\n        const batch = batches[i];\n        const batchResults = await this.processBatch(batch, options);\n        results.push(...batchResults);\n\n        // 更新进度\n        this.preloadState.completedLocales += batch.length;\n        this.preloadState.progress = (this.preloadState.completedLocales / this.preloadState.totalLocales) * 100;\n\n        options?.onProgress?.(this.preloadState.progress);\n\n        // 批次间延迟\n        if (i < batches.length - 1 && this.preloadConfig.delayBetweenBatches > 0) {\n          await this.delay(this.preloadConfig.delayBetweenBatches);\n        }\n      }\n    } catch (error) {\n      console.error('Preloading failed:', error);\n    } finally {\n      this.preloadState.isPreloading = false;\n    }\n\n    return results;\n  }\n\n  /**\n   * 停止预加载\n   * Stop preloading\n   */\n  stopPreloading(): void {\n    if (this.abortController) {\n      this.abortController.abort();\n    }\n    this.preloadState.isPreloading = false;\n  }\n\n  /**\n   * 暂停预加载\n   * Pause preloading\n   */\n  pausePreloading(): void {\n    // 实现暂停逻辑\n    this.stopPreloading();\n  }\n\n  /**\n   * 恢复预加载\n   * Resume preloading\n   */\n  resumePreloading(): void {\n    // 实现恢复逻辑\n    if (!this.preloadState.isPreloading) {\n      this.warmupCache();\n    }\n  }\n\n  /**\n   * 智能预加载（基于使用模式）\n   * Smart preload based on usage patterns\n   */\n  async smartPreload(): Promise<void> {\n    // 获取使用统计\n    const metrics = this.metricsCollector.getMetrics();\n    const localeUsage = metrics.localeUsage;\n\n    // 按使用频率排序\n    const sortedLocales = Object.entries(localeUsage)\n      .sort(([, a], [, b]) => b - a)\n      .map(([locale]) => locale as Locale)\n      .slice(0, 3); // 只预加载前3个最常用的语言\n\n    if (sortedLocales.length > 0) {\n      await this.preloadMultipleLocales(sortedLocales);\n    }\n  }\n\n  /**\n   * 预加载相关语言\n   * Preload related locales\n   */\n  async preloadRelatedLocales(currentLocale: Locale): Promise<void> {\n    const relatedLocales = this.getRelatedLocales(currentLocale);\n    if (relatedLocales.length > 0) {\n      await this.preloadMultipleLocales(relatedLocales);\n    }\n  }\n\n  /**\n   * 预加载缺失的翻译\n   * Preload missing translations\n   */\n  async preloadMissingTranslations(locale: Locale, keys: string[]): Promise<void> {\n    try {\n      const messages = await this.loadSpecificKeys(locale, keys);\n\n      // 合并到现有缓存\n      const existing = this.cache.get(locale) || {};\n      const merged = { ...existing, ...messages };\n      this.cache.set(locale, merged);\n    } catch (error) {\n      console.error(`Failed to preload missing translations for ${locale}:`, error);\n    }\n  }\n\n  /**\n   * 获取预加载统计\n   * Get preload statistics\n   */\n  getPreloadStats(): PreloadStats {\n    const state = this.preloadState;\n    const duration = state.startTime ? Date.now() - state.startTime : 0;\n\n    return {\n      isActive: state.isPreloading,\n      progress: state.progress,\n      totalLocales: state.totalLocales,\n      completedLocales: state.completedLocales,\n      errorCount: state.errors.length,\n      duration,\n      averageLoadTime: duration / Math.max(state.completedLocales, 1),\n      successRate: state.totalLocales > 0\n        ? (state.completedLocales - state.errors.length) / state.totalLocales\n        : 0,\n    };\n  }\n\n  /**\n   * 清除缓存\n   * Clear cache\n   */\n  clearCache(): void {\n    this.cache.clear();\n  }\n\n  /**\n   * 获取缓存统计\n   * Get cache statistics\n   */\n  getCacheStats(): { size: number; keys: string[] } {\n    return {\n      size: this.cache.size(),\n      keys: this.cache.keys(),\n      // 其他缓存统计信息\n    };\n  }\n\n  /**\n   * 从服务器加载消息\n   * Load messages from server\n   */\n  private async loadMessagesFromServer(locale: Locale, options?: PreloadOptions): Promise<Messages> {\n    try {\n      // 这里应该是实际的 API 调用\n      const controller = new AbortController();\n      const timeoutId = setTimeout(() => controller.abort(), options?.timeout || this.preloadConfig.timeout);\n\n      const response = await fetch(`/api/messages/${locale}`, {\n        signal: controller.signal,\n      });\n\n      clearTimeout(timeoutId);\n\n      if (!response.ok) {\n        throw new Error(`Failed to load messages for ${locale}: ${response.statusText}`);\n      }\n\n      return await response.json();\n    } catch (error) {\n      if (error instanceof Error) {\n        if (error.name === 'AbortError') {\n          throw new PreloaderTimeoutError(locale, options?.timeout || this.preloadConfig.timeout);\n        }\n        throw new PreloaderNetworkError(locale, error);\n      }\n      throw error;\n    }\n  }\n\n  /**\n   * 加载特定键的翻译\n   * Load specific translation keys\n   */\n  private async loadSpecificKeys(locale: Locale, keys: string[]): Promise<Partial<Messages>> {\n    try {\n      const response = await fetch(`/api/messages/${locale}/keys`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({ keys }),\n        signal: this.abortController?.signal,\n      });\n\n      if (!response.ok) {\n        throw new Error(`Failed to load specific keys for ${locale}: ${response.statusText}`);\n      }\n\n      return await response.json();\n    } catch (error) {\n      if (error instanceof Error && error.name === 'AbortError') {\n        throw new PreloaderError('Load was cancelled', locale);\n      }\n      throw error;\n    }\n  }\n\n  /**\n   * 创建批次\n   * Create batches\n   */\n  private createBatches<T>(items: T[], batchSize: number): T[][] {\n    const batches: T[][] = [];\n    for (let i = 0; i < items.length; i += batchSize) {\n      batches.push(items.slice(i, i + batchSize));\n    }\n    return batches;\n  }\n\n  /**\n   * 处理批次\n   * Process batch\n   */\n  private async processBatch(\n    batch: Locale[],\n    options?: PreloadOptions\n  ): Promise<CacheOperationResult<Messages>[]> {\n    const promises = batch.map(async (locale): Promise<CacheOperationResult<Messages>> => {\n      try {\n        const messages = await this.preloadLocale(locale, options);\n        return {\n          success: true,\n          data: messages,\n          key: locale,\n          timestamp: Date.now(),\n        };\n      } catch (error) {\n        this.preloadState.errors.push({\n          locale,\n          error: error instanceof Error ? error.message : 'Unknown error',\n        });\n\n        return {\n          success: false,\n          error: error instanceof Error ? error.message : 'Unknown error',\n          key: locale,\n          timestamp: Date.now(),\n        };\n      }\n    });\n\n    return Promise.all(promises);\n  }\n\n  /**\n   * 获取相关语言\n   * Get related locales\n   */\n  private getRelatedLocales(locale: Locale): Locale[] {\n    const relatedMap: Record<Locale, Locale[]> = {\n      'en': ['zh'],\n      'zh': ['en'],\n    };\n\n    return relatedMap[locale] || [];\n  }\n\n  /**\n   * 延迟函数\n   * Delay function\n   */\n  private delay(ms: number): Promise<void> {\n    return new Promise(resolve => setTimeout(resolve, ms));\n  }\n\n  /**\n   * 清理资源\n   * Cleanup resources\n   */\n  cleanup(): void {\n    this.stopPreloading();\n    this.preloadState = {\n      isPreloading: false,\n      progress: 0,\n      totalLocales: 0,\n      completedLocales: 0,\n      errors: [],\n    };\n  }\n\n  /**\n   * 设置预加载配置\n   * Set preload configuration\n   */\n  setConfig(config: Partial<PreloadConfig>): void {\n    this.preloadConfig = { ...this.preloadConfig, ...config };\n  }\n\n  /**\n   * 获取预加载配置\n   * Get preload configuration\n   */\n  getConfig(): PreloadConfig {\n    return { ...this.preloadConfig };\n  }\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/i18n-preloader-strategies.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/i18n-preloader-strategies/advanced-strategies.ts","messages":[{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0.9.","line":55,"column":27,"nodeType":"Literal","messageId":"noMagic","endLine":55,"endColumn":30},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0.7.","line":58,"column":34,"nodeType":"Literal","messageId":"noMagic","endLine":58,"endColumn":37},{"ruleId":"prefer-destructuring","severity":2,"message":"Use object destructuring.","line":78,"column":9,"nodeType":"VariableDeclarator","messageId":"preferDestructuring","endLine":78,"endColumn":110,"fix":{"range":[1718,1819],"text":"{connection} = (navigator as { connection?: { effectiveType?: string; downlink?: number } })"}},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2.","line":88,"column":46,"nodeType":"Literal","messageId":"noMagic","endLine":88,"endColumn":47},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0.5.","line":91,"column":53,"nodeType":"Literal","messageId":"noMagic","endLine":91,"endColumn":56},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 9.","line":117,"column":15,"nodeType":"Literal","messageId":"noMagic","endLine":117,"endColumn":16},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 17.","line":117,"column":28,"nodeType":"Literal","messageId":"noMagic","endLine":117,"endColumn":30},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 18.","line":120,"column":22,"nodeType":"Literal","messageId":"noMagic","endLine":120,"endColumn":24},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 22.","line":120,"column":36,"nodeType":"Literal","messageId":"noMagic","endLine":120,"endColumn":38},{"ruleId":"prefer-destructuring","severity":2,"message":"Use object destructuring.","line":139,"column":9,"nodeType":"VariableDeclarator","messageId":"preferDestructuring","endLine":139,"endColumn":106,"fix":{"range":[3218,3315],"text":"{memory} = (performance as { memory?: { usedJSHeapSize: number; totalJSHeapSize: number } })"}},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0.5.","line":145,"column":23,"nodeType":"Literal","messageId":"noMagic","endLine":145,"endColumn":26},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0.8.","line":148,"column":30,"nodeType":"Literal","messageId":"noMagic","endLine":148,"endColumn":33}],"suppressedMessages":[],"errorCount":12,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":2,"fixableWarningCount":0,"source":"/**\n * 高级翻译预加载策略实现\n * Advanced Translation Preloader Strategy Implementations\n */\n\nimport type { Locale } from '@/types/i18n';\nimport type {\n  IPreloader,\n  PreloadStrategy,\n  PreloadOptions,\n} from '../i18n-preloader-types';\n\n// 导入基础策略以便复用\nimport {\n  immediateStrategy,\n  progressiveStrategy,\n  lazyStrategy\n} from './basic-strategies';\n\n/**\n * 批量预加载策略\n * Batch preload strategy\n */\nexport const batchStrategy: PreloadStrategy = async (\n  preloader: IPreloader,\n  locales: Locale[],\n  options?: PreloadOptions\n) => {\n  const batchSize = 2;\n  const batches: Locale[][] = [];\n\n  for (let i = 0; i < locales.length; i += batchSize) {\n    batches.push(locales.slice(i, i + batchSize));\n  }\n\n  for (const batch of batches) {\n    await preloader.preloadMultipleLocales(batch, options);\n    // 批次间延迟\n    await new Promise(resolve => setTimeout(resolve, 1000));\n  }\n};\n\n/**\n * 自适应预加载策略\n * Adaptive preload strategy\n */\nexport const adaptiveStrategy: PreloadStrategy = async (\n  preloader: IPreloader,\n  locales: Locale[],\n  options?: PreloadOptions\n) => {\n  const stats = preloader.getPreloadStats();\n\n  // 根据当前性能选择策略\n  if (stats.successRate > 0.9 && stats.averageLoadTime < 1000) {\n    // 性能良好，使用立即策略\n    await immediateStrategy(preloader, locales, options);\n  } else if (stats.successRate > 0.7) {\n    // 性能一般，使用渐进式策略\n    await progressiveStrategy(preloader, locales, options);\n  } else {\n    // 性能较差，使用懒加载策略\n    await lazyStrategy(preloader, locales, options);\n  }\n};\n\n/**\n * 网络感知预加载策略\n * Network-aware preload strategy\n */\nexport const networkAwareStrategy: PreloadStrategy = async (\n  preloader: IPreloader,\n  locales: Locale[],\n  options?: PreloadOptions\n) => {\n  // 检测网络状况\n  const isOnline = navigator.onLine;\n  const connection = (navigator as { connection?: { effectiveType?: string; downlink?: number } }).connection;\n\n  if (!isOnline) {\n    // 离线状态，不进行预加载\n    return;\n  }\n\n  if (connection) {\n    const { effectiveType, downlink } = connection;\n\n    if (effectiveType === '4g' && downlink > 2) {\n      // 快速网络，使用立即策略\n      await immediateStrategy(preloader, locales, options);\n    } else if (effectiveType === '3g' || downlink > 0.5) {\n      // 中等网络，使用渐进式策略\n      await progressiveStrategy(preloader, locales, options);\n    } else {\n      // 慢速网络，使用懒加载策略\n      await lazyStrategy(preloader, locales, options);\n    }\n  } else {\n    // 无法检测网络，使用默认策略\n    await progressiveStrategy(preloader, locales, options);\n  }\n};\n\n/**\n * 时间感知预加载策略\n * Time-aware preload strategy\n */\nexport const timeAwareStrategy: PreloadStrategy = async (\n  preloader: IPreloader,\n  locales: Locale[],\n  options?: PreloadOptions\n) => {\n  const now = new Date();\n  const hour = now.getHours();\n\n  // 根据时间选择策略\n  if (hour >= 9 && hour <= 17) {\n    // 工作时间，使用快速策略\n    await immediateStrategy(preloader, locales, options);\n  } else if (hour >= 18 && hour <= 22) {\n    // 晚上，使用渐进式策略\n    await progressiveStrategy(preloader, locales, options);\n  } else {\n    // 深夜或早晨，使用懒加载策略\n    await lazyStrategy(preloader, locales, options);\n  }\n};\n\n/**\n * 内存感知预加载策略\n * Memory-aware preload strategy\n */\nexport const memoryAwareStrategy: PreloadStrategy = async (\n  preloader: IPreloader,\n  locales: Locale[],\n  options?: PreloadOptions\n) => {\n  // 检查可用内存\n  const memory = (performance as { memory?: { usedJSHeapSize: number; totalJSHeapSize: number } }).memory;\n\n  if (memory) {\n    const { usedJSHeapSize, totalJSHeapSize } = memory;\n    const memoryUsage = usedJSHeapSize / totalJSHeapSize;\n\n    if (memoryUsage < 0.5) {\n      // 内存充足，使用立即策略\n      await immediateStrategy(preloader, locales, options);\n    } else if (memoryUsage < 0.8) {\n      // 内存一般，使用渐进式策略\n      await progressiveStrategy(preloader, locales, options);\n    } else {\n      // 内存不足，使用懒加载策略\n      await lazyStrategy(preloader, locales, options);\n    }\n  } else {\n    // 无法检测内存，使用默认策略\n    await progressiveStrategy(preloader, locales, options);\n  }\n};\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/i18n-preloader-strategies/basic-strategies.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'locales' is defined but never used. Allowed unused args must match /^_/u.","line":31,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":31,"endColumn":20,"suggestions":[{"messageId":"removeVar","data":{"varName":"locales"},"fix":{"range":[598,619],"text":""},"desc":"Remove unused variable 'locales'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'locales' is defined but never used. Allowed unused args must match /^_/u.","line":31,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":31,"endColumn":10},{"ruleId":"no-unused-vars","severity":2,"message":"'options' is defined but never used. Allowed unused args must match /^_/u.","line":32,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":32,"endColumn":27,"suggestions":[{"messageId":"removeVar","data":{"varName":"options"},"fix":{"range":[619,647],"text":""},"desc":"Remove unused variable 'options'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'options' is defined but never used. Allowed unused args must match /^_/u.","line":32,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":32,"endColumn":10},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":72,"column":23,"nodeType":"MemberExpression","endLine":72,"endColumn":37},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 999.","line":72,"column":41,"nodeType":"Literal","messageId":"noMagic","endLine":72,"endColumn":44},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":73,"column":23,"nodeType":"MemberExpression","endLine":73,"endColumn":37},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 999.","line":73,"column":41,"nodeType":"Literal","messageId":"noMagic","endLine":73,"endColumn":44},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":81,"column":17,"nodeType":"MemberExpression","endLine":81,"endColumn":36},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2.","line":81,"column":40,"nodeType":"Literal","messageId":"noMagic","endLine":81,"endColumn":41}],"suppressedMessages":[],"errorCount":10,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 基础翻译预加载策略实现\n * Basic Translation Preloader Strategy Implementations\n */\n\nimport type { Locale } from '@/types/i18n';\nimport type { \n  IPreloader,\n  PreloadStrategy,\n  PreloadOptions,\n} from '../i18n-preloader-types';\n\n/**\n * 立即预加载策略\n * Immediate preload strategy\n */\nexport const immediateStrategy: PreloadStrategy = async (\n  preloader: IPreloader,\n  locales: Locale[],\n  options?: PreloadOptions\n) => {\n  await preloader.preloadMultipleLocales(locales, options);\n};\n\n/**\n * 智能预加载策略\n * Smart preload strategy\n */\nexport const smartStrategy: PreloadStrategy = async (\n  preloader: IPreloader,\n  locales: Locale[],\n  options?: PreloadOptions\n) => {\n  await preloader.smartPreload();\n};\n\n/**\n * 渐进式预加载策略\n * Progressive preload strategy\n */\nexport const progressiveStrategy: PreloadStrategy = async (\n  preloader: IPreloader,\n  locales: Locale[],\n  options?: PreloadOptions\n) => {\n  for (const locale of locales) {\n    if (preloader.isPreloading()) {\n      await preloader.preloadLocale(locale, options);\n      // 添加延迟以避免阻塞主线程\n      await new Promise(resolve => setTimeout(resolve, 500));\n    }\n  }\n};\n\n/**\n * 优先级预加载策略\n * Priority preload strategy\n */\nexport const priorityStrategy: PreloadStrategy = async (\n  preloader: IPreloader,\n  locales: Locale[],\n  options?: PreloadOptions\n) => {\n  // 定义语言优先级\n  const priorityMap: Record<Locale, number> = {\n    'en': 1,\n    'zh': 2,\n  };\n\n  // 按优先级排序\n  const sortedLocales = locales.sort((a, b) => {\n    const priorityA = priorityMap[a] || 999;\n    const priorityB = priorityMap[b] || 999;\n    return priorityA - priorityB;\n  });\n\n  // 高优先级的语言先预加载\n  for (const locale of sortedLocales) {\n    await preloader.preloadLocale(locale, {\n      ...options,\n      priority: priorityMap[locale] <= 2 ? 'high' : 'normal',\n    });\n  }\n};\n\n/**\n * 懒加载策略\n * Lazy preload strategy\n */\nexport const lazyStrategy: PreloadStrategy = async (\n  preloader: IPreloader,\n  locales: Locale[],\n  options?: PreloadOptions\n) => {\n  // 只预加载当前最需要的语言\n  if (locales.length > 0) {\n    await preloader.preloadLocale(locales[0], options);\n  }\n};\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/i18n-preloader-strategies/configs.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/i18n-preloader-strategies/factory.ts","messages":[{"ruleId":"security/detect-object-injection","severity":2,"message":"Variable Assigned to Object Injection Sink","line":53,"column":20,"nodeType":"MemberExpression","endLine":53,"endColumn":41}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 翻译预加载策略工厂和集合\n * Translation Preloader Strategy Factory and Collections\n */\n\nimport type { PreloaderMetrics } from '../i18n-preloader-types';\nimport { PreloadStrategyManager } from './manager';\nimport { strategyConfigs } from './configs';\n\n// 导入所有策略\nimport {\n  immediateStrategy,\n  smartStrategy,\n  progressiveStrategy,\n  priorityStrategy,\n  lazyStrategy,\n} from './basic-strategies';\n\nimport {\n  batchStrategy,\n  adaptiveStrategy,\n  networkAwareStrategy,\n  timeAwareStrategy,\n  memoryAwareStrategy,\n} from './advanced-strategies';\n\n/**\n * 预加载策略集合\n * Preload strategies collection\n */\nexport const PreloadStrategies = {\n  immediate: immediateStrategy,\n  smart: smartStrategy,\n  progressive: progressiveStrategy,\n  priority: priorityStrategy,\n  lazy: lazyStrategy,\n  batch: batchStrategy,\n  adaptive: adaptiveStrategy,\n  networkAware: networkAwareStrategy,\n  timeAware: timeAwareStrategy,\n  memoryAware: memoryAwareStrategy,\n};\n\n/**\n * 创建策略管理器\n * Create strategy manager\n */\nexport function createStrategyManager(): PreloadStrategyManager {\n  const manager = new PreloadStrategyManager();\n  \n  // 注册所有策略\n  Object.entries(PreloadStrategies).forEach(([name, strategy]) => {\n    const config = strategyConfigs[name];\n    manager.registerStrategy(name, strategy, config);\n  });\n  \n  return manager;\n}\n\n/**\n * 获取推荐策略\n * Get recommended strategy\n */\nexport function getRecommendedStrategy(\n  metrics: PreloaderMetrics,\n  networkCondition: 'fast' | 'slow' | 'offline' = 'fast'\n): string {\n  const manager = createStrategyManager();\n  return manager.selectBestStrategy(metrics, networkCondition);\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/i18n-preloader-strategies/manager.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/i18n-preloader-strategies/utils.ts","messages":[{"ruleId":"prefer-destructuring","severity":2,"message":"Use object destructuring.","line":23,"column":11,"nodeType":"VariableDeclarator","messageId":"preferDestructuring","endLine":23,"endColumn":112,"fix":{"range":[444,545],"text":"{connection} = (navigator as { connection?: { effectiveType?: string; downlink?: number } })"}},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2.","line":26,"column":48,"nodeType":"Literal","messageId":"noMagic","endLine":26,"endColumn":49},{"ruleId":"prefer-destructuring","severity":2,"message":"Use object destructuring.","line":39,"column":11,"nodeType":"VariableDeclarator","messageId":"preferDestructuring","endLine":39,"endColumn":108,"fix":{"range":[827,924],"text":"{memory} = (performance as { memory?: { usedJSHeapSize: number; totalJSHeapSize: number } })"}},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0.5.","line":44,"column":12,"nodeType":"Literal","messageId":"noMagic","endLine":44,"endColumn":15},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 9.","line":53,"column":17,"nodeType":"Literal","messageId":"noMagic","endLine":53,"endColumn":18},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 17.","line":53,"column":30,"nodeType":"Literal","messageId":"noMagic","endLine":53,"endColumn":32},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 18.","line":56,"column":17,"nodeType":"Literal","messageId":"noMagic","endLine":56,"endColumn":19},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 22.","line":56,"column":31,"nodeType":"Literal","messageId":"noMagic","endLine":56,"endColumn":33},{"ruleId":"security/detect-object-injection","severity":2,"message":"Variable Assigned to Object Injection Sink","line":71,"column":20,"nodeType":"MemberExpression","endLine":71,"endColumn":45},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2.","line":78,"column":16,"nodeType":"Literal","messageId":"noMagic","endLine":78,"endColumn":17},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0.5.","line":80,"column":29,"nodeType":"Literal","messageId":"noMagic","endLine":80,"endColumn":32},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0.9.","line":83,"column":31,"nodeType":"Literal","messageId":"noMagic","endLine":83,"endColumn":34}],"suppressedMessages":[],"errorCount":12,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":2,"fixableWarningCount":0,"source":"/**\n * 翻译预加载策略工具函数\n * Translation Preloader Strategy Utility Functions\n */\n\nimport type { PreloaderMetrics } from '../i18n-preloader-types';\nimport { strategyConfigs } from './configs';\n\n/**\n * 策略工具函数\n * Strategy utility functions\n */\nexport const StrategyUtils = {\n  /**\n   * 检查网络状况\n   * Check network condition\n   */\n  getNetworkCondition(): 'fast' | 'slow' | 'offline' {\n    if (!navigator.onLine) {\n      return 'offline';\n    }\n\n    const connection = (navigator as { connection?: { effectiveType?: string; downlink?: number } }).connection;\n    if (connection) {\n      const { effectiveType, downlink } = connection;\n      if (effectiveType === '4g' && downlink > 2) {\n        return 'fast';\n      }\n    }\n\n    return 'slow';\n  },\n\n  /**\n   * 检查内存使用情况\n   * Check memory usage\n   */\n  getMemoryUsage(): number {\n    const memory = (performance as { memory?: { usedJSHeapSize: number; totalJSHeapSize: number } }).memory;\n    if (memory) {\n      const { usedJSHeapSize, totalJSHeapSize } = memory;\n      return usedJSHeapSize / totalJSHeapSize;\n    }\n    return 0.5; // 默认值\n  },\n\n  /**\n   * 获取当前时间段\n   * Get current time period\n   */\n  getTimePeriod(): 'work' | 'evening' | 'night' {\n    const hour = new Date().getHours();\n    if (hour >= 9 && hour <= 17) {\n      return 'work';\n    }\n    if (hour >= 18 && hour <= 22) {\n      return 'evening';\n    }\n    return 'night';\n  },\n\n  /**\n   * 计算策略优先级\n   * Calculate strategy priority\n   */\n  calculateStrategyPriority(\n    strategy: string,\n    metrics: PreloaderMetrics,\n    conditions: { network: string; memory: number; time: string }\n  ): number {\n    const config = strategyConfigs[strategy];\n    if (!config) return 0;\n\n    let score = config.priority;\n\n    // 根据条件调整分数\n    if (conditions.network === 'fast' && strategy === 'immediate') {\n      score += 2;\n    }\n    if (conditions.memory < 0.5 && strategy === 'lazy') {\n      score += 1;\n    }\n    if (metrics.successRate > 0.9 && strategy === 'smart') {\n      score += 1;\n    }\n\n    return score;\n  },\n};\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/i18n-preloader-types.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'progress' is defined but never used. Allowed unused args must match /^_/u.","line":75,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":75,"endColumn":33,"suggestions":[{"messageId":"removeVar","data":{"varName":"progress"},"fix":{"range":[1337,1353],"text":""},"desc":"Remove unused variable 'progress'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used. Allowed unused args must match /^_/u.","line":76,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":76,"endColumn":26,"suggestions":[{"messageId":"removeVar","data":{"varName":"error"},"fix":{"range":[1377,1390],"text":""},"desc":"Remove unused variable 'error'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'locale' is defined but never used. Allowed unused args must match /^_/u.","line":76,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":76,"endColumn":42,"suggestions":[{"messageId":"removeVar","data":{"varName":"locale"},"fix":{"range":[1389,1405],"text":""},"desc":"Remove unused variable 'locale'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'locale' is defined but never used. Allowed unused args must match /^_/u.","line":77,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":77,"endColumn":30,"suggestions":[{"messageId":"removeVar","data":{"varName":"locale"},"fix":{"range":[1431,1446],"text":""},"desc":"Remove unused variable 'locale'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'messages' is defined but never used. Allowed unused args must match /^_/u.","line":77,"column":32,"nodeType":"Identifier","messageId":"unusedVar","endLine":77,"endColumn":50,"suggestions":[{"messageId":"removeVar","data":{"varName":"messages"},"fix":{"range":[1445,1465],"text":""},"desc":"Remove unused variable 'messages'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'locales' is defined but never used. Allowed unused args must match /^_/u.","line":136,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":136,"endColumn":37,"suggestions":[{"messageId":"removeVar","data":{"varName":"locales"},"fix":{"range":[2645,2662],"text":""},"desc":"Remove unused variable 'locales'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'progress' is defined but never used. Allowed unused args must match /^_/u.","line":137,"column":23,"nodeType":"Identifier","messageId":"unusedVar","endLine":137,"endColumn":39,"suggestions":[{"messageId":"removeVar","data":{"varName":"progress"},"fix":{"range":[2695,2712],"text":""},"desc":"Remove unused variable 'progress'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'currentLocale' is defined but never used. Allowed unused args must match /^_/u.","line":137,"column":41,"nodeType":"Identifier","messageId":"unusedVar","endLine":137,"endColumn":63,"suggestions":[{"messageId":"removeVar","data":{"varName":"currentLocale"},"fix":{"range":[2711,2735],"text":""},"desc":"Remove unused variable 'currentLocale'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'results' is defined but never used. Allowed unused args must match /^_/u.","line":138,"column":23,"nodeType":"Identifier","messageId":"unusedVar","endLine":138,"endColumn":47,"suggestions":[{"messageId":"removeVar","data":{"varName":"results"},"fix":{"range":[2768,2792],"text":""},"desc":"Remove unused variable 'results'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used. Allowed unused args must match /^_/u.","line":139,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":139,"endColumn":32,"suggestions":[{"messageId":"removeVar","data":{"varName":"error"},"fix":{"range":[2822,2835],"text":""},"desc":"Remove unused variable 'error'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'locale' is defined but never used. Allowed unused args must match /^_/u.","line":139,"column":34,"nodeType":"Identifier","messageId":"unusedVar","endLine":139,"endColumn":49,"suggestions":[{"messageId":"removeVar","data":{"varName":"locale"},"fix":{"range":[2834,2851],"text":""},"desc":"Remove unused variable 'locale'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'locale' is defined but never used. Allowed unused args must match /^_/u.","line":141,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":141,"endColumn":30,"suggestions":[{"messageId":"removeVar","data":{"varName":"locale"},"fix":{"range":[2908,2923],"text":""},"desc":"Remove unused variable 'locale'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'messages' is defined but never used. Allowed unused args must match /^_/u.","line":141,"column":32,"nodeType":"Identifier","messageId":"unusedVar","endLine":141,"endColumn":50,"suggestions":[{"messageId":"removeVar","data":{"varName":"messages"},"fix":{"range":[2922,2942],"text":""},"desc":"Remove unused variable 'messages'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'locale' is defined but never used. Allowed unused args must match /^_/u.","line":142,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":142,"endColumn":31,"suggestions":[{"messageId":"removeVar","data":{"varName":"locale"},"fix":{"range":[2969,2983],"text":""},"desc":"Remove unused variable 'locale'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'batchResult' is defined but never used. Allowed unused args must match /^_/u.","line":143,"column":21,"nodeType":"Identifier","messageId":"unusedVar","endLine":143,"endColumn":45,"suggestions":[{"messageId":"removeVar","data":{"varName":"batchResult"},"fix":{"range":[3014,3038],"text":""},"desc":"Remove unused variable 'batchResult'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'state' is defined but never used. Allowed unused args must match /^_/u.","line":190,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":190,"endColumn":40,"suggestions":[{"messageId":"removeVar","data":{"varName":"state"},"fix":{"range":[3911,3939],"text":""},"desc":"Remove unused variable 'state'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'locale' is defined but never used. Allowed unused args must match /^_/u.","line":195,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":195,"endColumn":26,"suggestions":[{"messageId":"removeVar","data":{"varName":"locale"},"fix":{"range":[4090,4105],"text":""},"desc":"Remove unused variable 'locale'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used. Allowed unused args must match /^_/u.","line":195,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":195,"endColumn":41,"suggestions":[{"messageId":"removeVar","data":{"varName":"error"},"fix":{"range":[4104,4119],"text":""},"desc":"Remove unused variable 'error'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'locale' is defined but never used. Allowed unused args must match /^_/u.","line":204,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":204,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"locale"},"fix":{"range":[4243,4257],"text":""},"desc":"Remove unused variable 'locale'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'locale' is defined but never used. Allowed unused args must match /^_/u.","line":205,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":205,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"locale"},"fix":{"range":[4288,4303],"text":""},"desc":"Remove unused variable 'locale'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'messages' is defined but never used. Allowed unused args must match /^_/u.","line":205,"column":23,"nodeType":"Identifier","messageId":"unusedVar","endLine":205,"endColumn":41,"suggestions":[{"messageId":"removeVar","data":{"varName":"messages"},"fix":{"range":[4302,4322],"text":""},"desc":"Remove unused variable 'messages'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'locale' is defined but never used. Allowed unused args must match /^_/u.","line":206,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":206,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"locale"},"fix":{"range":[4337,4351],"text":""},"desc":"Remove unused variable 'locale'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'locale' is defined but never used. Allowed unused args must match /^_/u.","line":207,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":207,"endColumn":24,"suggestions":[{"messageId":"removeVar","data":{"varName":"locale"},"fix":{"range":[4372,4386],"text":""},"desc":"Remove unused variable 'locale'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'locale' is defined but never used. Allowed unused args must match /^_/u.","line":225,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":225,"endColumn":30,"suggestions":[{"messageId":"removeVar","data":{"varName":"locale"},"fix":{"range":[4688,4703],"text":""},"desc":"Remove unused variable 'locale'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'options' is defined but never used. Allowed unused args must match /^_/u.","line":225,"column":32,"nodeType":"Identifier","messageId":"unusedVar","endLine":225,"endColumn":56,"suggestions":[{"messageId":"removeVar","data":{"varName":"options"},"fix":{"range":[4702,4728],"text":""},"desc":"Remove unused variable 'options'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'locale' is defined but never used. Allowed unused args must match /^_/u.","line":226,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":226,"endColumn":34,"suggestions":[{"messageId":"removeVar","data":{"varName":"locale"},"fix":{"range":[4769,4784],"text":""},"desc":"Remove unused variable 'locale'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'keys' is defined but never used. Allowed unused args must match /^_/u.","line":226,"column":36,"nodeType":"Identifier","messageId":"unusedVar","endLine":226,"endColumn":50,"suggestions":[{"messageId":"removeVar","data":{"varName":"keys"},"fix":{"range":[4783,4799],"text":""},"desc":"Remove unused variable 'keys'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'options' is defined but never used. Allowed unused args must match /^_/u.","line":226,"column":52,"nodeType":"Identifier","messageId":"unusedVar","endLine":226,"endColumn":76,"suggestions":[{"messageId":"removeVar","data":{"varName":"options"},"fix":{"range":[4799,4825],"text":""},"desc":"Remove unused variable 'options'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'locale' is defined but never used. Allowed unused args must match /^_/u.","line":232,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":232,"endColumn":34,"suggestions":[{"messageId":"removeVar","data":{"varName":"locale"},"fix":{"range":[4985,4999],"text":""},"desc":"Remove unused variable 'locale'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'task' is defined but never used. Allowed unused args must match /^_/u.","line":240,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":240,"endColumn":37,"suggestions":[{"messageId":"removeVar","data":{"varName":"task"},"fix":{"range":[5113,5139],"text":""},"desc":"Remove unused variable 'task'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'priority' is defined but never used. Allowed unused args must match /^_/u.","line":240,"column":39,"nodeType":"Identifier","messageId":"unusedVar","endLine":240,"endColumn":56,"suggestions":[{"messageId":"removeVar","data":{"varName":"priority"},"fix":{"range":[5138,5157],"text":""},"desc":"Remove unused variable 'priority'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'taskId' is defined but never used. Allowed unused args must match /^_/u.","line":241,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":241,"endColumn":24,"suggestions":[{"messageId":"removeVar","data":{"varName":"taskId"},"fix":{"range":[5175,5189],"text":""},"desc":"Remove unused variable 'taskId'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'result' is defined but never used. Allowed unused args must match /^_/u.","line":258,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":258,"endColumn":38,"suggestions":[{"messageId":"removeVar","data":{"varName":"result"},"fix":{"range":[5509,5530],"text":""},"desc":"Remove unused variable 'result'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'locale' is defined but never used. Allowed unused args must match /^_/u.","line":259,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":259,"endColumn":32,"suggestions":[{"messageId":"removeVar","data":{"varName":"locale"},"fix":{"range":[5556,5570],"text":""},"desc":"Remove unused variable 'locale'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'locale' is defined but never used. Allowed unused args must match /^_/u.","line":260,"column":19,"nodeType":"Identifier","messageId":"unusedVar","endLine":260,"endColumn":33,"suggestions":[{"messageId":"removeVar","data":{"varName":"locale"},"fix":{"range":[5597,5611],"text":""},"desc":"Remove unused variable 'locale'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used. Allowed unused args must match /^_/u.","line":261,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":261,"endColumn":27,"suggestions":[{"messageId":"removeVar","data":{"varName":"error"},"fix":{"range":[5634,5647],"text":""},"desc":"Remove unused variable 'error'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'locale' is defined but never used. Allowed unused args must match /^_/u.","line":261,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":261,"endColumn":44,"suggestions":[{"messageId":"removeVar","data":{"varName":"locale"},"fix":{"range":[5646,5663],"text":""},"desc":"Remove unused variable 'locale'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'locale' is defined but never used. Allowed unused args must match /^_/u.","line":283,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":283,"endColumn":31,"suggestions":[{"messageId":"removeVar","data":{"varName":"locale"},"fix":{"range":[6122,6137],"text":""},"desc":"Remove unused variable 'locale'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'options' is defined but never used. Allowed unused args must match /^_/u.","line":283,"column":33,"nodeType":"Identifier","messageId":"unusedVar","endLine":283,"endColumn":57,"suggestions":[{"messageId":"removeVar","data":{"varName":"options"},"fix":{"range":[6136,6162],"text":""},"desc":"Remove unused variable 'options'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'locales' is defined but never used. Allowed unused args must match /^_/u.","line":284,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":284,"endColumn":43,"suggestions":[{"messageId":"removeVar","data":{"varName":"locales"},"fix":{"range":[6209,6227],"text":""},"desc":"Remove unused variable 'locales'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'options' is defined but never used. Allowed unused args must match /^_/u.","line":284,"column":45,"nodeType":"Identifier","messageId":"unusedVar","endLine":284,"endColumn":69,"suggestions":[{"messageId":"removeVar","data":{"varName":"options"},"fix":{"range":[6226,6252],"text":""},"desc":"Remove unused variable 'options'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'locale' is defined but never used. Allowed unused args must match /^_/u.","line":285,"column":30,"nodeType":"Identifier","messageId":"unusedVar","endLine":285,"endColumn":44,"suggestions":[{"messageId":"removeVar","data":{"varName":"locale"},"fix":{"range":[6327,6342],"text":""},"desc":"Remove unused variable 'locale'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'keys' is defined but never used. Allowed unused args must match /^_/u.","line":285,"column":46,"nodeType":"Identifier","messageId":"unusedVar","endLine":285,"endColumn":60,"suggestions":[{"messageId":"removeVar","data":{"varName":"keys"},"fix":{"range":[6341,6357],"text":""},"desc":"Remove unused variable 'keys'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'currentLocale' is defined but never used. Allowed unused args must match /^_/u.","line":289,"column":25,"nodeType":"Identifier","messageId":"unusedVar","endLine":289,"endColumn":46,"suggestions":[{"messageId":"removeVar","data":{"varName":"currentLocale"},"fix":{"range":[6444,6465],"text":""},"desc":"Remove unused variable 'currentLocale'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'config' is defined but never used. Allowed unused args must match /^_/u.","line":308,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":308,"endColumn":45,"suggestions":[{"messageId":"removeVar","data":{"varName":"config"},"fix":{"range":[6847,6879],"text":""},"desc":"Remove unused variable 'config'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'preloader' is defined but never used. Allowed unused args must match /^_/u.","line":320,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":320,"endColumn":24,"suggestions":[{"messageId":"removeVar","data":{"varName":"preloader"},"fix":{"range":[7042,7064],"text":""},"desc":"Remove unused variable 'preloader'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'locales' is defined but never used. Allowed unused args must match /^_/u.","line":321,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":321,"endColumn":20,"suggestions":[{"messageId":"removeVar","data":{"varName":"locales"},"fix":{"range":[7063,7084],"text":""},"desc":"Remove unused variable 'locales'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'options' is defined but never used. Allowed unused args must match /^_/u.","line":322,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":322,"endColumn":27,"suggestions":[{"messageId":"removeVar","data":{"varName":"options"},"fix":{"range":[7084,7112],"text":""},"desc":"Remove unused variable 'options'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'config' is defined but never used. Allowed unused args must match /^_/u.","line":330,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":330,"endColumn":33,"suggestions":[{"messageId":"removeVar","data":{"varName":"config"},"fix":{"range":[7226,7256],"text":""},"desc":"Remove unused variable 'config'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'locale' is defined but never used. Allowed unused args must match /^_/u.","line":338,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":338,"endColumn":17,"suggestions":[{"messageId":"removeVar","data":{"varName":"locale"},"fix":{"range":[7363,7378],"text":""},"desc":"Remove unused variable 'locale'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'next' is defined but never used. Allowed unused args must match /^_/u.","line":339,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":339,"endColumn":32,"suggestions":[{"messageId":"removeVar","data":{"varName":"next"},"fix":{"range":[7377,7410],"text":""},"desc":"Remove unused variable 'next'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'preloader' is defined but never used. Allowed unused args must match /^_/u.","line":349,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":349,"endColumn":32,"suggestions":[{"messageId":"removeVar","data":{"varName":"preloader"},"fix":{"range":[7566,7587],"text":""},"desc":"Remove unused variable 'preloader'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'preloader' is defined but never used. Allowed unused args must match /^_/u.","line":350,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":350,"endColumn":34,"suggestions":[{"messageId":"removeVar","data":{"varName":"preloader"},"fix":{"range":[7608,7629],"text":""},"desc":"Remove unused variable 'preloader'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'locales' is defined but never used. Allowed unused args must match /^_/u.","line":351,"column":19,"nodeType":"Identifier","messageId":"unusedVar","endLine":351,"endColumn":36,"suggestions":[{"messageId":"removeVar","data":{"varName":"locales"},"fix":{"range":[7656,7673],"text":""},"desc":"Remove unused variable 'locales'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'results' is defined but never used. Allowed unused args must match /^_/u.","line":352,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":352,"endColumn":46,"suggestions":[{"messageId":"removeVar","data":{"varName":"results"},"fix":{"range":[7703,7727],"text":""},"desc":"Remove unused variable 'results'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used. Allowed unused args must match /^_/u.","line":353,"column":19,"nodeType":"Identifier","messageId":"unusedVar","endLine":353,"endColumn":31,"suggestions":[{"messageId":"removeVar","data":{"varName":"error"},"fix":{"range":[7754,7767],"text":""},"desc":"Remove unused variable 'error'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'locale' is defined but never used. Allowed unused args must match /^_/u.","line":353,"column":33,"nodeType":"Identifier","messageId":"unusedVar","endLine":353,"endColumn":48,"suggestions":[{"messageId":"removeVar","data":{"varName":"locale"},"fix":{"range":[7766,7783],"text":""},"desc":"Remove unused variable 'locale'."}]},{"ruleId":"max-params","severity":2,"message":"Constructor has too many parameters (4). Maximum allowed is 3.","line":361,"column":3,"nodeType":"FunctionExpression","messageId":"exceed","endLine":361,"endColumn":14},{"ruleId":"no-unused-vars","severity":2,"message":"'locale' is defined but never used. Allowed unused args must match /^_/u.","line":363,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":363,"endColumn":27,"suggestions":[{"messageId":"removeVar","data":{"varName":"locale"},"fix":{"range":[7931,7946],"text":""},"desc":"Remove unused variable 'locale'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'code' is defined but never used. Allowed unused args must match /^_/u.","line":364,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":364,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"code"},"fix":{"range":[7959,7972],"text":""},"desc":"Remove unused variable 'code'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'retryable' is assigned a value but never used. Allowed unused args must match /^_/u.","line":365,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":365,"endColumn":30,"suggestions":[{"messageId":"removeVar","data":{"varName":"retryable"},"fix":{"range":[7985,8003],"text":""},"desc":"Remove unused variable 'retryable'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'IDLE' is defined but never used. Allowed unused vars must match /^_/u.","line":433,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":433,"endColumn":7,"suggestions":[{"messageId":"removeVar","data":{"varName":"IDLE"},"fix":{"range":[9813,9817],"text":""},"desc":"Remove unused variable 'IDLE'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'PRELOADING' is defined but never used. Allowed unused vars must match /^_/u.","line":434,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":434,"endColumn":13,"suggestions":[{"messageId":"removeVar","data":{"varName":"PRELOADING"},"fix":{"range":[9826,9840],"text":""},"desc":"Remove unused variable 'PRELOADING'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'PAUSED' is defined but never used. Allowed unused vars must match /^_/u.","line":435,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":435,"endColumn":9,"suggestions":[{"messageId":"removeVar","data":{"varName":"PAUSED"},"fix":{"range":[9855,9865],"text":""},"desc":"Remove unused variable 'PAUSED'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'COMPLETED' is defined but never used. Allowed unused vars must match /^_/u.","line":436,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":436,"endColumn":12,"suggestions":[{"messageId":"removeVar","data":{"varName":"COMPLETED"},"fix":{"range":[9876,9889],"text":""},"desc":"Remove unused variable 'COMPLETED'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'ERROR' is defined but never used. Allowed unused vars must match /^_/u.","line":437,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":437,"endColumn":8,"suggestions":[{"messageId":"removeVar","data":{"varName":"ERROR"},"fix":{"range":[9903,9912],"text":""},"desc":"Remove unused variable 'ERROR'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'CANCELLED' is defined but never used. Allowed unused vars must match /^_/u.","line":438,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":438,"endColumn":12,"suggestions":[{"messageId":"removeVar","data":{"varName":"CANCELLED"},"fix":{"range":[9922,9935],"text":""},"desc":"Remove unused variable 'CANCELLED'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'LOW' is defined but never used. Allowed unused vars must match /^_/u.","line":446,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":446,"endColumn":6,"suggestions":[{"messageId":"removeVar","data":{"varName":"LOW"},"fix":{"range":[10031,10034],"text":""},"desc":"Remove unused variable 'LOW'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'NORMAL' is defined but never used. Allowed unused vars must match /^_/u.","line":447,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":447,"endColumn":9,"suggestions":[{"messageId":"removeVar","data":{"varName":"NORMAL"},"fix":{"range":[10038,10048],"text":""},"desc":"Remove unused variable 'NORMAL'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'HIGH' is defined but never used. Allowed unused vars must match /^_/u.","line":448,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":448,"endColumn":7,"suggestions":[{"messageId":"removeVar","data":{"varName":"HIGH"},"fix":{"range":[10052,10060],"text":""},"desc":"Remove unused variable 'HIGH'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'CRITICAL' is defined but never used. Allowed unused vars must match /^_/u.","line":449,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":449,"endColumn":11,"suggestions":[{"messageId":"removeVar","data":{"varName":"CRITICAL"},"fix":{"range":[10064,10076],"text":""},"desc":"Remove unused variable 'CRITICAL'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'data' is defined but never used. Allowed unused args must match /^_/u.","line":487,"column":65,"nodeType":"Identifier","messageId":"unusedVar","endLine":487,"endColumn":72,"suggestions":[{"messageId":"removeVar","data":{"varName":"data"},"fix":{"range":[11085,11092],"text":""},"desc":"Remove unused variable 'data'."}]}],"suppressedMessages":[],"errorCount":72,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 翻译预加载器类型定义\n * Translation Preloader Type Definitions\n *\n * 提供预加载器相关的类型定义和接口\n */\n\nimport type { Locale, Messages } from '@/types/i18n';\nimport type { CacheOperationResult } from './i18n-cache-types';\n\n/**\n * 预加载状态\n * Preload state\n */\nexport interface PreloadState {\n  isPreloading: boolean;\n  currentLocale?: Locale;\n  progress: number;\n  totalLocales: number;\n  completedLocales: number;\n  errors: Array<{ locale: Locale; error: string }>;\n  startTime?: number;\n}\n\n/**\n * 预加载统计信息\n * Preload statistics\n */\nexport interface PreloadStats {\n  isActive: boolean;\n  progress: number;\n  totalLocales: number;\n  completedLocales: number;\n  errorCount: number;\n  duration: number;\n  averageLoadTime: number;\n  successRate: number;\n}\n\n/**\n * 预加载结果\n * Preload result\n */\nexport interface PreloadResult {\n  success: boolean;\n  locale: Locale;\n  messages?: Messages;\n  error?: string;\n  loadTime: number;\n  fromCache: boolean;\n}\n\n/**\n * 批处理结果\n * Batch processing result\n */\nexport interface BatchResult {\n  batchIndex: number;\n  results: PreloadResult[];\n  totalTime: number;\n  successCount: number;\n  errorCount: number;\n}\n\n/**\n * 预加载选项\n * Preload options\n */\nexport interface PreloadOptions {\n  priority?: 'high' | 'normal' | 'low';\n  timeout?: number;\n  retryCount?: number;\n  retryDelay?: number;\n  signal?: AbortSignal;\n  onProgress?: (progress: number) => void;\n  onError?: (error: Error, locale: Locale) => void;\n  onSuccess?: (locale: Locale, messages: Messages) => void;\n}\n\n/**\n * 智能预加载配置\n * Smart preload configuration\n */\nexport interface SmartPreloadConfig {\n  enabled: boolean;\n  maxLocales: number;\n  minUsageThreshold: number;\n  usageWindow: number; // 统计窗口（小时）\n  preloadTrigger: 'immediate' | 'idle' | 'scheduled';\n  scheduleInterval?: number; // 定时预加载间隔（分钟）\n}\n\n/**\n * 预加载策略配置\n * Preload strategy configuration\n */\nexport interface PreloadStrategyConfig {\n  name: string;\n  description: string;\n  priority: number;\n  conditions: {\n    minCacheHitRate?: number;\n    maxErrorRate?: number;\n    minAvailableMemory?: number;\n    networkCondition?: 'fast' | 'slow' | 'offline';\n  };\n  parameters: {\n    batchSize?: number;\n    delayBetweenBatches?: number;\n    maxConcurrency?: number;\n    timeout?: number;\n  };\n}\n\n/**\n * 预加载器性能指标\n * Preloader performance metrics\n */\nexport interface PreloaderMetrics {\n  totalPreloads: number;\n  successfulPreloads: number;\n  failedPreloads: number;\n  averageLoadTime: number;\n  cacheHitRate: number;\n  memoryUsage: number;\n  networkRequests: number;\n  lastPreloadTime?: number;\n  performanceScore: number;\n}\n\n/**\n * 预加载器事件\n * Preloader events\n */\nexport interface PreloaderEvents {\n  onPreloadStart: (locales: Locale[]) => void;\n  onPreloadProgress: (progress: number, currentLocale?: Locale) => void;\n  onPreloadComplete: (results: PreloadResult[]) => void;\n  onPreloadError: (error: Error, locale?: Locale) => void;\n  onPreloadCancel: () => void;\n  onCacheHit: (locale: Locale, messages: Messages) => void;\n  onCacheMiss: (locale: Locale) => void;\n  onBatchComplete: (batchResult: BatchResult) => void;\n}\n\n/**\n * 预加载器配置\n * Preloader configuration\n */\nexport interface PreloaderConfig {\n  // 基础配置\n  enablePreload: boolean;\n  preloadLocales: Locale[];\n  batchSize: number;\n  delayBetweenBatches: number;\n  maxConcurrency: number;\n  timeout: number;\n  retryCount: number;\n  retryDelay: number;\n\n  // 智能预加载\n  smartPreload: SmartPreloadConfig;\n\n  // 性能配置\n  memoryLimit: number;\n  networkThrottling: boolean;\n  priorityQueue: boolean;\n\n  // 缓存配置\n  cacheStrategy: 'aggressive' | 'conservative' | 'adaptive';\n  cacheTTL: number;\n  maxCacheSize: number;\n\n  // 监控配置\n  enableMetrics: boolean;\n  metricsInterval: number;\n  enableLogging: boolean;\n  logLevel: 'debug' | 'info' | 'warn' | 'error';\n\n  // 事件处理\n  events?: Partial<PreloaderEvents>;\n}\n\n/**\n * 预加载器状态管理\n * Preloader state management\n */\nexport interface PreloaderStateManager {\n  getState(): PreloadState;\n  setState(state: Partial<PreloadState>): void;\n  resetState(): void;\n  isPreloading(): boolean;\n  getProgress(): number;\n  getErrors(): Array<{ locale: Locale; error: string }>;\n  addError(locale: Locale, error: string): void;\n  clearErrors(): void;\n}\n\n/**\n * 预加载器缓存接口\n * Preloader cache interface\n */\nexport interface PreloaderCache {\n  get(locale: Locale): Messages | undefined;\n  set(locale: Locale, messages: Messages): void;\n  has(locale: Locale): boolean;\n  delete(locale: Locale): boolean;\n  clear(): void;\n  size(): number;\n  keys(): Locale[];\n  getStats(): {\n    hitCount: number;\n    missCount: number;\n    hitRate: number;\n    size: number;\n    memoryUsage: number;\n  };\n}\n\n/**\n * 预加载器网络接口\n * Preloader network interface\n */\nexport interface PreloaderNetwork {\n  loadMessages(locale: Locale, options?: PreloadOptions): Promise<Messages>;\n  loadSpecificKeys(locale: Locale, keys: string[], options?: PreloadOptions): Promise<Partial<Messages>>;\n  checkNetworkStatus(): Promise<{\n    online: boolean;\n    speed: 'fast' | 'slow';\n    latency: number;\n  }>;\n  estimateLoadTime(locale: Locale): Promise<number>;\n}\n\n/**\n * 预加载器调度器\n * Preloader scheduler\n */\nexport interface PreloaderScheduler {\n  schedule(task: () => Promise<void>, priority?: number): void;\n  cancel(taskId: string): boolean;\n  pause(): void;\n  resume(): void;\n  clear(): void;\n  getQueueSize(): number;\n  isRunning(): boolean;\n}\n\n/**\n * 预加载器监控器\n * Preloader monitor\n */\nexport interface PreloaderMonitor {\n  startMonitoring(): void;\n  stopMonitoring(): void;\n  getMetrics(): PreloaderMetrics;\n  resetMetrics(): void;\n  recordPreload(result: PreloadResult): void;\n  recordCacheHit(locale: Locale): void;\n  recordCacheMiss(locale: Locale): void;\n  recordError(error: Error, locale?: Locale): void;\n  getPerformanceScore(): number;\n}\n\n/**\n * 预加载器工厂配置\n * Preloader factory configuration\n */\nexport interface PreloaderFactoryConfig {\n  cacheType: 'memory' | 'indexeddb' | 'localstorage';\n  networkAdapter: 'fetch' | 'xhr' | 'custom';\n  schedulerType: 'fifo' | 'priority' | 'adaptive';\n  monitoringEnabled: boolean;\n  debugMode: boolean;\n}\n\n/**\n * 预加载器实例接口\n * Preloader instance interface\n */\nexport interface IPreloader {\n  // 基础预加载方法\n  preloadLocale(locale: Locale, options?: PreloadOptions): Promise<Messages>;\n  preloadMultipleLocales(locales: Locale[], options?: PreloadOptions): Promise<CacheOperationResult<Messages>[]>;\n  preloadMissingTranslations(locale: Locale, keys: string[]): Promise<void>;\n\n  // 智能预加载\n  smartPreload(): Promise<void>;\n  preloadRelatedLocales(currentLocale: Locale): Promise<void>;\n\n  // 缓存管理\n  warmupCache(): void;\n  clearCache(): void;\n  getCacheStats(): { size: number; keys: string[] };\n\n  // 状态管理\n  isPreloading(): boolean;\n  getPreloadProgress(): number;\n  getPreloadState(): PreloadState;\n  getPreloadStats(): PreloadStats;\n\n  // 控制方法\n  stopPreloading(): void;\n  pausePreloading(): void;\n  resumePreloading(): void;\n\n  // 配置管理\n  setConfig(config: Partial<PreloaderConfig>): void;\n  getConfig(): PreloaderConfig;\n\n  // 清理资源\n  cleanup(): void;\n}\n\n/**\n * 预加载策略函数类型\n * Preload strategy function type\n */\nexport type PreloadStrategy = (\n  preloader: IPreloader,\n  locales: Locale[],\n  options?: PreloadOptions\n) => Promise<void>;\n\n/**\n * 预加载器工厂函数类型\n * Preloader factory function type\n */\nexport type PreloaderFactory = (\n  config: PreloaderFactoryConfig\n) => IPreloader;\n\n/**\n * 预加载器中间件类型\n * Preloader middleware type\n */\nexport type PreloaderMiddleware = (\n  locale: Locale,\n  next: () => Promise<Messages>\n) => Promise<Messages>;\n\n/**\n * 预加载器插件接口\n * Preloader plugin interface\n */\nexport interface PreloaderPlugin {\n  name: string;\n  version: string;\n  install(preloader: IPreloader): void;\n  uninstall(preloader: IPreloader): void;\n  onPreloadStart?(locales: Locale[]): void;\n  onPreloadComplete?(results: PreloadResult[]): void;\n  onPreloadError?(error: Error, locale?: Locale): void;\n}\n\n/**\n * 预加载器错误类型\n * Preloader error types\n */\nexport class PreloaderError extends Error {\n  constructor(\n    message: string,\n    public locale?: Locale,\n    public code?: string,\n    public retryable: boolean = true\n  ) {\n    super(message);\n    this.name = 'PreloaderError';\n  }\n}\n\nexport class PreloaderTimeoutError extends PreloaderError {\n  constructor(locale: Locale, timeout: number) {\n    super(`Preload timeout for locale ${locale} after ${timeout}ms`, locale, 'TIMEOUT', true);\n    this.name = 'PreloaderTimeoutError';\n  }\n}\n\nexport class PreloaderNetworkError extends PreloaderError {\n  constructor(locale: Locale, originalError: Error) {\n    super(`Network error while preloading ${locale}: ${originalError.message}`, locale, 'NETWORK', true);\n    this.name = 'PreloaderNetworkError';\n  }\n}\n\nexport class PreloaderCacheError extends PreloaderError {\n  constructor(locale: Locale, operation: string) {\n    super(`Cache error during ${operation} for locale ${locale}`, locale, 'CACHE', false);\n    this.name = 'PreloaderCacheError';\n  }\n}\n\n/**\n * 预加载器常量\n * Preloader constants\n */\nexport const PRELOADER_CONSTANTS = {\n  DEFAULT_BATCH_SIZE: 3,\n  DEFAULT_DELAY_BETWEEN_BATCHES: 100,\n  DEFAULT_MAX_CONCURRENCY: 5,\n  DEFAULT_TIMEOUT: 10000,\n  DEFAULT_RETRY_COUNT: 3,\n  DEFAULT_RETRY_DELAY: 1000,\n  DEFAULT_CACHE_TTL: 24 * 60 * 60 * 1000, // 24 hours\n  DEFAULT_MEMORY_LIMIT: 50 * 1024 * 1024, // 50MB\n  MIN_USAGE_THRESHOLD: 0.1,\n  MAX_PRELOAD_LOCALES: 10,\n  PERFORMANCE_SCORE_THRESHOLD: 0.8,\n} as const;\n\n/**\n * 预加载器事件名称\n * Preloader event names\n */\nexport const PRELOADER_EVENTS = {\n  PRELOAD_START: 'preload:start',\n  PRELOAD_PROGRESS: 'preload:progress',\n  PRELOAD_COMPLETE: 'preload:complete',\n  PRELOAD_ERROR: 'preload:error',\n  PRELOAD_CANCEL: 'preload:cancel',\n  CACHE_HIT: 'cache:hit',\n  CACHE_MISS: 'cache:miss',\n  BATCH_COMPLETE: 'batch:complete',\n  NETWORK_SLOW: 'network:slow',\n  MEMORY_WARNING: 'memory:warning',\n} as const;\n\n/**\n * 预加载器状态枚举\n * Preloader state enum\n */\nexport enum PreloaderState {\n  IDLE = 'idle',\n  PRELOADING = 'preloading',\n  PAUSED = 'paused',\n  COMPLETED = 'completed',\n  ERROR = 'error',\n  CANCELLED = 'cancelled',\n}\n\n/**\n * 预加载优先级枚举\n * Preload priority enum\n */\nexport enum PreloadPriority {\n  LOW = 1,\n  NORMAL = 2,\n  HIGH = 3,\n  CRITICAL = 4,\n}\n\n/**\n * 类型守卫函数\n * Type guard functions\n */\nexport function isPreloadResult(obj: unknown): obj is PreloadResult {\n  return (\n    obj &&\n    typeof obj === 'object' &&\n    typeof (obj as Record<string, unknown>).success === 'boolean' &&\n    typeof (obj as Record<string, unknown>).locale === 'string' &&\n    typeof (obj as Record<string, unknown>).loadTime === 'number' &&\n    typeof (obj as Record<string, unknown>).fromCache === 'boolean'\n  );\n}\n\nexport function isPreloadState(obj: unknown): obj is PreloadState {\n  return (\n    obj &&\n    typeof obj === 'object' &&\n    typeof obj.isPreloading === 'boolean' &&\n    typeof obj.progress === 'number' &&\n    typeof obj.totalLocales === 'number' &&\n    typeof obj.completedLocales === 'number' &&\n    Array.isArray(obj.errors)\n  );\n}\n\nexport function isPreloaderError(error: unknown): error is PreloaderError {\n  return error instanceof PreloaderError;\n}\n\n/**\n * 工具类型\n * Utility types\n */\nexport type PreloadEventHandler<T = Record<string, unknown>> = (data: T) => void;\nexport type PreloadEventMap = {\n  [K in keyof PreloaderEvents]: PreloaderEvents[K];\n};\n\nexport type PreloadConfigKey = keyof PreloaderConfig;\nexport type PreloadStateKey = keyof PreloadState;\nexport type PreloadStatsKey = keyof PreloadStats;\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/i18n-preloader-utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/i18n-preloader-utils/factory-functions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/i18n-preloader-utils/global-instances.ts","messages":[{"ruleId":"max-params","severity":2,"message":"Function 'setupPreloader' has too many parameters (4). Maximum allowed is 3.","line":34,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":34,"endColumn":31},{"ruleId":"no-return-await","severity":2,"message":"Redundant use of `await` on a return value.","line":60,"column":12,"nodeType":"Identifier","messageId":"redundantUseOfAwait","endLine":60,"endColumn":49,"suggestions":[{"messageId":"removeAwait","fix":{"range":[1481,1487],"text":""},"desc":"Remove redundant `await`."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 全局预加载器实例和便捷函数\n * Global Preloader Instances and Convenience Functions\n */\n\nimport type { Locale, Messages } from '@/types/i18n';\nimport type { \n  MetricsCollector, \n  CacheStorage\n} from '../i18n-cache-types';\nimport type {\n  IPreloader,\n  PreloaderConfig\n} from '../i18n-preloader-types';\nimport { PreloaderManager } from './preloader-manager';\nimport { PreloaderFactory } from './preloader-factory';\n\n/**\n * 全局预加载器管理器实例\n * Global preloader manager instance\n */\nexport const globalPreloaderManager = new PreloaderManager();\n\n/**\n * 全局预加载器工厂实例\n * Global preloader factory instance\n */\nexport const globalPreloaderFactory = PreloaderFactory.getInstance();\n\n/**\n * 便捷函数：创建并注册预加载器\n * Convenience function: create and register preloader\n */\nexport function setupPreloader(\n  name: string,\n  cache: CacheStorage<Messages>,\n  metricsCollector: MetricsCollector,\n  config?: Partial<PreloaderConfig>\n): IPreloader {\n  const preloader = globalPreloaderFactory.createPreloader(cache, metricsCollector, config);\n  globalPreloaderManager.register(name, preloader);\n  return preloader;\n}\n\n/**\n * 便捷函数：获取默认预加载器\n * Convenience function: get default preloader\n */\nexport function getDefaultPreloader(): IPreloader | undefined {\n  return globalPreloaderManager.get();\n}\n\n/**\n * 便捷函数：预加载语言\n * Convenience function: preload locale\n */\nexport async function preloadLocale(locale: Locale): Promise<Messages | undefined> {\n  const preloader = getDefaultPreloader();\n  if (preloader) {\n    return await preloader.preloadLocale(locale);\n  }\n  return undefined;\n}\n\n/**\n * 便捷函数：智能预加载\n * Convenience function: smart preload\n */\nexport async function smartPreload(): Promise<void> {\n  const preloader = getDefaultPreloader();\n  if (preloader) {\n    await preloader.smartPreload();\n  }\n}\n\n/**\n * 便捷函数：清理所有预加载器\n * Convenience function: cleanup all preloaders\n */\nexport function cleanupPreloaders(): void {\n  globalPreloaderManager.cleanup();\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/i18n-preloader-utils/preloader-factory.ts","messages":[{"ruleId":"no-empty-function","severity":2,"message":"Unexpected empty constructor.","line":28,"column":25,"nodeType":"FunctionExpression","messageId":"unexpected","endLine":28,"endColumn":27},{"ruleId":"no-unused-vars","severity":2,"message":"'preloader' is defined but never used. Allowed unused args must match /^_/u.","line":116,"column":30,"nodeType":"Identifier","messageId":"unusedVar","endLine":116,"endColumn":51,"suggestions":[{"messageId":"removeVar","data":{"varName":"preloader"},"fix":{"range":[2380,2401],"text":""},"desc":"Remove unused variable 'preloader'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'preloader' is defined but never used. Allowed unused args must match /^_/u.","line":116,"column":30,"nodeType":null,"messageId":"unusedVar","endLine":116,"endColumn":39}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 预加载器工厂类\n * Preloader Factory Class\n */\n\nimport type { Messages } from '@/types/i18n';\nimport type { \n  MetricsCollector, \n  CacheStorage\n} from '../i18n-cache-types';\nimport type {\n  IPreloader,\n  PreloaderConfig,\n  PreloaderPlugin,\n  PreloadEventHandler\n} from '../i18n-preloader-types';\nimport { TranslationPreloader } from '../i18n-preloader-core';\n\n/**\n * 预加载器工厂类\n * Preloader factory class\n */\nexport class PreloaderFactory {\n  private static instance: PreloaderFactory;\n  private plugins = new Map<string, PreloaderPlugin>();\n  private eventHandlers = new Map<string, PreloadEventHandler[]>();\n\n  private constructor() {}\n\n  /**\n   * 获取工厂实例\n   * Get factory instance\n   */\n  static getInstance(): PreloaderFactory {\n    if (!PreloaderFactory.instance) {\n      PreloaderFactory.instance = new PreloaderFactory();\n    }\n    return PreloaderFactory.instance;\n  }\n\n  /**\n   * 创建预加载器\n   * Create preloader\n   */\n  createPreloader(\n    cache: CacheStorage<Messages>,\n    metricsCollector: MetricsCollector,\n    config?: Partial<PreloaderConfig>\n  ): IPreloader {\n    const preloader = new TranslationPreloader(cache, metricsCollector, config);\n    \n    // 安装插件\n    this.plugins.forEach(plugin => {\n      plugin.install(preloader);\n    });\n\n    // 设置事件处理器\n    this.setupEventHandlers(preloader);\n\n    return preloader;\n  }\n\n  /**\n   * 注册插件\n   * Register plugin\n   */\n  registerPlugin(plugin: PreloaderPlugin): void {\n    this.plugins.set(plugin.name, plugin);\n  }\n\n  /**\n   * 卸载插件\n   * Unregister plugin\n   */\n  unregisterPlugin(name: string): boolean {\n    return this.plugins.delete(name);\n  }\n\n  /**\n   * 获取插件\n   * Get plugin\n   */\n  getPlugin(name: string): PreloaderPlugin | undefined {\n    return this.plugins.get(name);\n  }\n\n  /**\n   * 注册事件处理器\n   * Register event handler\n   */\n  on(event: string, handler: PreloadEventHandler): void {\n    if (!this.eventHandlers.has(event)) {\n      this.eventHandlers.set(event, []);\n    }\n    this.eventHandlers.get(event)!.push(handler);\n  }\n\n  /**\n   * 移除事件处理器\n   * Remove event handler\n   */\n  off(event: string, handler: PreloadEventHandler): void {\n    const handlers = this.eventHandlers.get(event);\n    if (handlers) {\n      const index = handlers.indexOf(handler);\n      if (index > -1) {\n        handlers.splice(index, 1);\n      }\n    }\n  }\n\n  /**\n   * 设置事件处理器\n   * Setup event handlers\n   */\n  private setupEventHandlers(preloader: IPreloader): void {\n    // 这里可以设置默认的事件处理逻辑\n    // 实际实现需要根据具体的事件系统来完成\n  }\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/i18n-preloader-utils/preloader-manager.ts","messages":[{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":90,"column":7,"nodeType":"MemberExpression","endLine":90,"endColumn":19}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 预加载器管理器\n * Preloader Manager\n */\n\nimport type {\n  IPreloader,\n  PreloadState\n} from '../i18n-preloader-types';\n\n/**\n * 预加载器管理器\n * Preloader manager\n */\nexport class PreloaderManager {\n  private preloaders = new Map<string, IPreloader>();\n  private defaultPreloader?: IPreloader;\n\n  /**\n   * 注册预加载器\n   * Register preloader\n   */\n  register(name: string, preloader: IPreloader): void {\n    this.preloaders.set(name, preloader);\n    if (!this.defaultPreloader) {\n      this.defaultPreloader = preloader;\n    }\n  }\n\n  /**\n   * 获取预加载器\n   * Get preloader\n   */\n  get(name?: string): IPreloader | undefined {\n    if (name) {\n      return this.preloaders.get(name);\n    }\n    return this.defaultPreloader;\n  }\n\n  /**\n   * 设置默认预加载器\n   * Set default preloader\n   */\n  setDefault(name: string): boolean {\n    const preloader = this.preloaders.get(name);\n    if (preloader) {\n      this.defaultPreloader = preloader;\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * 移除预加载器\n   * Remove preloader\n   */\n  remove(name: string): boolean {\n    const preloader = this.preloaders.get(name);\n    if (preloader) {\n      preloader.cleanup();\n      this.preloaders.delete(name);\n      if (this.defaultPreloader === preloader) {\n        this.defaultPreloader = this.preloaders.values().next().value;\n      }\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * 清理所有预加载器\n   * Cleanup all preloaders\n   */\n  cleanup(): void {\n    this.preloaders.forEach(preloader => {\n      preloader.cleanup();\n    });\n    this.preloaders.clear();\n    this.defaultPreloader = undefined;\n  }\n\n  /**\n   * 获取所有预加载器状态\n   * Get all preloader states\n   */\n  getAllStates(): Record<string, PreloadState> {\n    const states: Record<string, PreloadState> = {};\n    this.preloaders.forEach((preloader, name) => {\n      states[name] = preloader.getPreloadState();\n    });\n    return states;\n  }\n\n  /**\n   * 停止所有预加载\n   * Stop all preloading\n   */\n  stopAll(): void {\n    this.preloaders.forEach(preloader => {\n      preloader.stopPreloading();\n    });\n  }\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/i18n-preloader-utils/preloader-utils.ts","messages":[{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 10.","line":64,"column":44,"nodeType":"Literal","messageId":"noMagic","endLine":64,"endColumn":46},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 5.","line":64,"column":49,"nodeType":"Literal","messageId":"noMagic","endLine":64,"endColumn":50},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0.1.","line":67,"column":62,"nodeType":"Literal","messageId":"noMagic","endLine":67,"endColumn":65},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 5.","line":67,"column":67,"nodeType":"Literal","messageId":"noMagic","endLine":67,"endColumn":68},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0.2.","line":70,"column":51,"nodeType":"Literal","messageId":"noMagic","endLine":70,"endColumn":54},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0.8.","line":134,"column":29,"nodeType":"Literal","messageId":"noMagic","endLine":134,"endColumn":32},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 5.","line":146,"column":28,"nodeType":"Literal","messageId":"noMagic","endLine":146,"endColumn":29},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2.","line":152,"column":36,"nodeType":"Literal","messageId":"noMagic","endLine":152,"endColumn":37},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 50.","line":179,"column":20,"nodeType":"Literal","messageId":"noMagic","endLine":179,"endColumn":22},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 1024.","line":179,"column":25,"nodeType":"Literal","messageId":"noMagic","endLine":179,"endColumn":29},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 1024.","line":179,"column":32,"nodeType":"Literal","messageId":"noMagic","endLine":179,"endColumn":36},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 24.","line":183,"column":17,"nodeType":"Literal","messageId":"noMagic","endLine":183,"endColumn":19},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 60.","line":183,"column":22,"nodeType":"Literal","messageId":"noMagic","endLine":183,"endColumn":24},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 60.","line":183,"column":27,"nodeType":"Literal","messageId":"noMagic","endLine":183,"endColumn":29}],"suppressedMessages":[],"errorCount":14,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 预加载器工具函数\n * Preloader Utility Functions\n */\n\nimport type { Locale, Messages } from '@/types/i18n';\nimport type {\n  IPreloader,\n  PreloaderConfig,\n  PreloadResult,\n  PreloaderMetrics\n} from '../i18n-preloader-types';\n\n/**\n * 预加载器工具函数\n * Preloader utility functions\n */\nexport const PreloaderUtils = {\n  /**\n   * 验证预加载配置\n   * Validate preload configuration\n   */\n  validateConfig(config: Partial<PreloaderConfig>): boolean {\n    if (config.batchSize && config.batchSize <= 0) {\n      return false;\n    }\n    if (config.timeout && config.timeout <= 0) {\n      return false;\n    }\n    if (config.retryCount && config.retryCount < 0) {\n      return false;\n    }\n    return true;\n  },\n\n  /**\n   * 合并配置\n   * Merge configurations\n   */\n  mergeConfigs(\n    base: PreloaderConfig,\n    override: Partial<PreloaderConfig>\n  ): PreloaderConfig {\n    return {\n      ...base,\n      ...override,\n      smartPreload: {\n        ...base.smartPreload,\n        ...override.smartPreload,\n      },\n      events: {\n        ...base.events,\n        ...override.events,\n      },\n    };\n  },\n\n  /**\n   * 计算预加载优先级\n   * Calculate preload priority\n   */\n  calculatePriority(locale: Locale, metrics: PreloaderMetrics): number {\n    // 基础优先级\n    const basePriority = locale === 'en' ? 10 : 5;\n    \n    // 根据使用频率调整\n    const usageBonus = Math.min(metrics.successfulPreloads * 0.1, 5);\n    \n    // 根据错误率调整\n    const errorPenalty = metrics.failedPreloads * 0.2;\n    \n    return Math.max(basePriority + usageBonus - errorPenalty, 1);\n  },\n\n  /**\n   * 格式化预加载结果\n   * Format preload result\n   */\n  formatResult(result: PreloadResult): string {\n    const status = result.success ? '✅' : '❌';\n    const time = `${result.loadTime}ms`;\n    const source = result.fromCache ? '(cached)' : '(network)';\n    \n    return `${status} ${result.locale} ${time} ${source}`;\n  },\n\n  /**\n   * 生成预加载报告\n   * Generate preload report\n   */\n  generateReport(results: PreloadResult[]): {\n    total: number;\n    successful: number;\n    failed: number;\n    averageTime: number;\n    cacheHitRate: number;\n    details: string[];\n  } {\n    const total = results.length;\n    const successful = results.filter(r => r.success).length;\n    const failed = total - successful;\n    const cacheHits = results.filter(r => r.fromCache).length;\n    \n    const totalTime = results.reduce((sum, r) => sum + r.loadTime, 0);\n    const averageTime = total > 0 ? totalTime / total : 0;\n    const cacheHitRate = total > 0 ? cacheHits / total : 0;\n    \n    const details = results.map(result => PreloaderUtils.formatResult(result));\n    \n    return {\n      total,\n      successful,\n      failed,\n      averageTime,\n      cacheHitRate,\n      details,\n    };\n  },\n\n  /**\n   * 检查预加载器健康状态\n   * Check preloader health\n   */\n  checkHealth(preloader: IPreloader): {\n    status: 'healthy' | 'warning' | 'error';\n    issues: string[];\n    recommendations: string[];\n  } {\n    const stats = preloader.getPreloadStats();\n    const issues: string[] = [];\n    const recommendations: string[] = [];\n    \n    // 检查成功率\n    if (stats.successRate < 0.8) {\n      issues.push(`Low success rate: ${(stats.successRate * 100).toFixed(1)}%`);\n      recommendations.push('Check network connectivity and API endpoints');\n    }\n    \n    // 检查平均加载时间\n    if (stats.averageLoadTime > 5000) {\n      issues.push(`High average load time: ${stats.averageLoadTime}ms`);\n      recommendations.push('Consider optimizing network requests or reducing payload size');\n    }\n    \n    // 检查错误数量\n    if (stats.errorCount > 5) {\n      issues.push(`High error count: ${stats.errorCount}`);\n      recommendations.push('Review error logs and implement better error handling');\n    }\n    \n    const status = issues.length === 0 ? 'healthy' : \n                  issues.length <= 2 ? 'warning' : 'error';\n    \n    return { status, issues, recommendations };\n  },\n\n  /**\n   * 创建默认配置\n   * Create default configuration\n   */\n  createDefaultConfig(): PreloaderConfig {\n    return {\n      enablePreload: true,\n      preloadLocales: ['en', 'zh'],\n      batchSize: 3,\n      delayBetweenBatches: 100,\n      maxConcurrency: 5,\n      timeout: 10000,\n      retryCount: 3,\n      retryDelay: 1000,\n      smartPreload: {\n        enabled: true,\n        maxLocales: 5,\n        minUsageThreshold: 0.1,\n        usageWindow: 24,\n        preloadTrigger: 'idle',\n        scheduleInterval: 60,\n      },\n      memoryLimit: 50 * 1024 * 1024, // 50MB\n      networkThrottling: false,\n      priorityQueue: true,\n      cacheStrategy: 'adaptive',\n      cacheTTL: 24 * 60 * 60 * 1000, // 24 hours\n      maxCacheSize: 100,\n      enableMetrics: true,\n      metricsInterval: 60000, // 1 minute\n      enableLogging: true,\n      logLevel: 'info',\n    };\n  },\n\n  /**\n   * 估算内存使用量\n   * Estimate memory usage\n   */\n  estimateMemoryUsage(messages: Messages): number {\n    const jsonString = JSON.stringify(messages);\n    return new Blob([jsonString]).size;\n  },\n\n  /**\n   * 检查浏览器支持\n   * Check browser support\n   */\n  checkBrowserSupport(): {\n    fetch: boolean;\n    abortController: boolean;\n    intersectionObserver: boolean;\n    serviceWorker: boolean;\n  } {\n    return {\n      fetch: typeof fetch !== 'undefined',\n      abortController: typeof AbortController !== 'undefined',\n      intersectionObserver: typeof IntersectionObserver !== 'undefined',\n      serviceWorker: 'serviceWorker' in navigator,\n    };\n  },\n};\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/i18n-preloader.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'Locale' is defined but never used. Allowed unused vars must match /^_/u.","line":15,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"Locale"},"fix":{"range":[306,313],"text":""},"desc":"Remove unused variable 'Locale'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Locale' is defined but never used. Allowed unused vars must match /^_/u.","line":15,"column":15,"nodeType":null,"messageId":"unusedVar","endLine":15,"endColumn":21},{"ruleId":"no-unused-vars","severity":2,"message":"'Messages' is defined but never used. Allowed unused vars must match /^_/u.","line":15,"column":23,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":31,"suggestions":[{"messageId":"removeVar","data":{"varName":"Messages"},"fix":{"range":[312,322],"text":""},"desc":"Remove unused variable 'Messages'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Messages' is defined but never used. Allowed unused vars must match /^_/u.","line":15,"column":23,"nodeType":null,"messageId":"unusedVar","endLine":15,"endColumn":31},{"ruleId":"no-unused-vars","severity":2,"message":"'Preloader' is defined but never used. Allowed unused vars must match /^_/u.","line":17,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":12,"suggestions":[{"messageId":"removeVar","data":{"varName":"Preloader"},"fix":{"range":[362,372],"text":""},"desc":"Remove unused variable 'Preloader'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Preloader' is defined but never used. Allowed unused vars must match /^_/u.","line":17,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":17,"endColumn":12},{"ruleId":"no-unused-vars","severity":2,"message":"'MetricsCollector' is defined but never used. Allowed unused vars must match /^_/u.","line":18,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":19,"suggestions":[{"messageId":"removeVar","data":{"varName":"MetricsCollector"},"fix":{"range":[371,391],"text":""},"desc":"Remove unused variable 'MetricsCollector'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'MetricsCollector' is defined but never used. Allowed unused vars must match /^_/u.","line":18,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":18,"endColumn":19},{"ruleId":"no-unused-vars","severity":2,"message":"'CacheStorage' is defined but never used. Allowed unused vars must match /^_/u.","line":19,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":15,"suggestions":[{"messageId":"removeVar","data":{"varName":"CacheStorage"},"fix":{"range":[391,407],"text":""},"desc":"Remove unused variable 'CacheStorage'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CacheStorage' is defined but never used. Allowed unused vars must match /^_/u.","line":19,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":19,"endColumn":15},{"ruleId":"no-unused-vars","severity":2,"message":"'CacheOperationResult' is defined but never used. Allowed unused vars must match /^_/u.","line":21,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":23,"suggestions":[{"messageId":"removeVar","data":{"varName":"CacheOperationResult"},"fix":{"range":[424,448],"text":""},"desc":"Remove unused variable 'CacheOperationResult'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CacheOperationResult' is defined but never used. Allowed unused vars must match /^_/u.","line":21,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":21,"endColumn":23},{"ruleId":"no-undef","severity":2,"message":"'PreloaderFactoryConfig' is not defined.","line":78,"column":3,"nodeType":"Identifier","messageId":"undef","endLine":78,"endColumn":25}],"suppressedMessages":[],"errorCount":13,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 翻译预加载器 - 主入口\n * Translation Preloader - Main Entry Point\n *\n * 统一的翻译预加载器入口，整合所有预加载相关功能\n */\n\n// 重新导出所有模块的功能\nexport * from './i18n-preloader-types';\nexport * from './i18n-preloader-core';\nexport * from './i18n-preloader-strategies';\nexport * from './i18n-preloader-utils';\n\n// 向后兼容的重新导出\nimport type { Locale, Messages } from '@/types/i18n';\nimport type {\n  Preloader,\n  MetricsCollector,\n  CacheStorage,\n  PreloadConfig,\n  CacheOperationResult\n} from './i18n-cache-types';\n\nimport type {\n  PreloadState,\n  PreloadStats,\n  PreloadResult,\n  PreloadOptions,\n  IPreloader,\n  PreloaderConfig,\n  PreloaderFactory,\n  PreloaderPlugin,\n  PreloadStrategy,\n  PreloaderMetrics,\n  PreloaderEvents,\n} from './i18n-preloader-types';\n\nimport { TranslationPreloader } from './i18n-preloader-core';\nimport {\n  PreloadStrategies,\n  PreloadStrategyManager,\n  createStrategyManager,\n  getRecommendedStrategy,\n  StrategyUtils\n} from './i18n-preloader-strategies';\nimport {\n  createTranslationPreloader,\n  PreloaderFactory as PreloaderFactoryClass,\n  PreloaderManager,\n  PreloaderUtils,\n  globalPreloaderManager,\n  globalPreloaderFactory,\n  setupPreloader,\n  getDefaultPreloader,\n  preloadLocale,\n  smartPreload,\n  cleanupPreloaders\n} from './i18n-preloader-utils';\n\n// ==================== 向后兼容的类型别名 ====================\n\n/**\n * 向后兼容的类型别名\n * Backward compatible type aliases\n */\nexport type {\n  // 核心类型\n  TranslationPreloader as Preloader,\n  IPreloader as PreloaderInterface,\n  PreloadState as State,\n  PreloadStats as Stats,\n  PreloadResult as Result,\n  PreloadOptions as Options,\n\n  // 配置类型\n  PreloaderConfig as Config,\n  PreloadConfig as LegacyConfig,\n  PreloaderFactoryConfig as FactoryConfig,\n\n  // 策略类型\n  PreloadStrategy as Strategy,\n  PreloadStrategyManager as StrategyManager,\n\n  // 工厂类型\n  PreloaderFactory as Factory,\n  PreloaderManager as Manager,\n  PreloaderPlugin as Plugin,\n\n  // 事件类型\n  PreloaderEvents as Events,\n  PreloaderMetrics as Metrics,\n};\n\n/**\n * 向后兼容的导出别名\n * Backward compatible export aliases\n */\nexport {\n  // 核心类\n  TranslationPreloader,\n\n  // 策略\n  PreloadStrategies,\n  PreloadStrategyManager,\n  createStrategyManager,\n  getRecommendedStrategy,\n  StrategyUtils,\n\n  // 工厂和管理器\n  PreloaderFactoryClass as PreloaderFactory,\n  PreloaderManager,\n  PreloaderUtils,\n\n  // 全局实例\n  globalPreloaderManager,\n  globalPreloaderFactory,\n\n  // 便捷函数\n  createTranslationPreloader,\n  setupPreloader,\n  getDefaultPreloader,\n  preloadLocale,\n  smartPreload,\n  cleanupPreloaders,\n};\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/i18n-validation.ts","messages":[{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":47,"column":7,"nodeType":"MemberExpression","endLine":47,"endColumn":27},{"ruleId":"no-unused-vars","severity":2,"message":"'_error' is defined but never used.","line":48,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":48,"endColumn":20},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_error' is defined but never used.","line":48,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":48,"endColumn":20},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":150,"column":9,"nodeType":"MemberExpression","endLine":150,"endColumn":50},{"ruleId":"max-params","severity":2,"message":"Function 'validateTranslationCompleteness' has too many parameters (5). Maximum allowed is 3.","line":199,"column":1,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":199,"endColumn":41},{"ruleId":"security/detect-object-injection","severity":2,"message":"Variable Assigned to Object Injection Sink","line":207,"column":25,"nodeType":"MemberExpression","endLine":207,"endColumn":45},{"ruleId":"max-params","severity":2,"message":"Function 'validateTranslationQuality' has too many parameters (6). Maximum allowed is 3.","line":241,"column":1,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":241,"endColumn":36},{"ruleId":"max-params","severity":2,"message":"Function 'checkUntranslatedContent' has too many parameters (5). Maximum allowed is 3.","line":274,"column":1,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":274,"endColumn":34},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":283,"column":39,"nodeType":"MemberExpression","endLine":283,"endColumn":64},{"ruleId":"max-params","severity":2,"message":"Function 'checkPlaceholderConsistency' has too many parameters (5). Maximum allowed is 3.","line":299,"column":1,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":299,"endColumn":37}],"suppressedMessages":[],"errorCount":10,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 企业级国际化验证工具\n * 提供翻译完整性检查、质量验证和同步机制\n */\nimport { routing } from '@/i18n/routing';\n\nexport interface TranslationValidationResult {\n  isValid: boolean;\n  errors: TranslationError[];\n  warnings: TranslationWarning[];\n  coverage: number;\n  missingKeys: string[];\n  inconsistentKeys: string[];\n}\n\nexport interface TranslationError {\n  type: 'missing_key' | 'type_mismatch' | 'invalid_format' | 'empty_value';\n  key: string;\n  locale: string;\n  message: string;\n  severity: 'critical' | 'high' | 'medium' | 'low';\n}\n\nexport interface TranslationWarning {\n  type:\n    | 'untranslated'\n    | 'length_mismatch'\n    | 'format_inconsistency'\n    | 'placeholder_mismatch';\n  key: string;\n  locale: string;\n  message: string;\n  suggestion?: string;\n}\n\n/**\n * 加载所有语言的翻译文件\n */\nasync function loadTranslations(\n  errors: TranslationError[],\n): Promise<Record<string, Record<string, unknown>>> {\n  const translations: Record<string, Record<string, unknown>> = {};\n\n  for (const locale of routing.locales) {\n    try {\n      const messages = await import(`../../messages/${locale}.json`);\n      translations[locale] = messages.default;\n    } catch (_error) {\n      errors.push({\n        type: 'missing_key',\n        key: 'translation_file',\n        locale,\n        message: `Translation file for locale ${locale} not found`,\n        severity: 'critical',\n      });\n    }\n  }\n\n  return translations;\n}\n\n/**\n * 验证翻译文件的完整性和质量\n */\nexport async function validateTranslations(): Promise<TranslationValidationResult> {\n  const errors: TranslationError[] = [];\n  const warnings: TranslationWarning[] = [];\n  const missingKeys: string[] = [];\n  const inconsistentKeys: string[] = [];\n\n  try {\n    const translations = await loadTranslations(errors);\n\n    // 获取所有翻译键\n    const allKeys = new Set<string>();\n    Object.values(translations).forEach((translation) => {\n      extractKeys(translation).forEach((key) => allKeys.add(key));\n    });\n\n    // 验证每个语言的翻译完整性\n    validateTranslationCompleteness(\n      translations,\n      allKeys,\n      errors,\n      warnings,\n      missingKeys,\n    );\n\n    // 计算覆盖率\n    const totalKeys = allKeys.size * routing.locales.length;\n    const missingCount = missingKeys.length;\n    const coverage =\n      totalKeys > 0 ? ((totalKeys - missingCount) / totalKeys) * 100 : 100;\n\n    return {\n      isValid:\n        errors.filter((e) => e.severity === 'critical' || e.severity === 'high')\n          .length === 0,\n      errors,\n      warnings,\n      coverage,\n      missingKeys,\n      inconsistentKeys,\n    };\n  } catch (error) {\n    return {\n      isValid: false,\n      errors: [\n        {\n          type: 'invalid_format',\n          key: 'validation',\n          locale: 'all',\n          message: `Validation failed: ${error instanceof Error ? error.message : 'Unknown error'}`,\n          severity: 'critical',\n        },\n      ],\n      warnings: [],\n      coverage: 0,\n      missingKeys: [],\n      inconsistentKeys: [],\n    };\n  }\n}\n\n/**\n * 提取对象中的所有键路径\n */\nfunction extractKeys(obj: Record<string, unknown>, prefix = ''): string[] {\n  const keys: string[] = [];\n\n  for (const [key, value] of Object.entries(obj)) {\n    const fullKey = prefix ? `${prefix}.${key}` : key;\n\n    if (value && typeof value === 'object' && !Array.isArray(value)) {\n      keys.push(...extractKeys(value as Record<string, unknown>, fullKey));\n    } else {\n      keys.push(fullKey);\n    }\n  }\n\n  return keys;\n}\n\n/**\n * 获取嵌套对象的值\n */\nfunction getNestedValue(obj: Record<string, unknown>, path: string): unknown {\n  return path.split('.').reduce((current: Record<string, unknown> | unknown, key) =>\n    (current && typeof current === 'object' && current !== null && !Array.isArray(current))\n      ? (current as Record<string, unknown>)[key]\n      : undefined, obj);\n}\n\n/**\n * 生成翻译质量报告\n */\nexport function generateTranslationReport(\n  result: TranslationValidationResult,\n): string {\n  const { isValid, errors, warnings, coverage, missingKeys } = result;\n\n  let report = '# 翻译质量报告\\n\\n';\n\n  report += `## 总体状态: ${isValid ? '✅ 通过' : '❌ 失败'}\\n`;\n  report += `## 覆盖率: ${coverage.toFixed(1)}%\\n\\n`;\n\n  if (errors.length > 0) {\n    report += '## 错误\\n\\n';\n    errors.forEach((error) => {\n      report += `- **${error.severity.toUpperCase()}**: ${error.message} (${error.locale}.${error.key})\\n`;\n    });\n    report += '\\n';\n  }\n\n  if (warnings.length > 0) {\n    report += '## 警告\\n\\n';\n    warnings.forEach((warning) => {\n      report += `- **${warning.type}**: ${warning.message} (${warning.locale}.${warning.key})\\n`;\n      if (warning.suggestion) {\n        report += `  建议: ${warning.suggestion}\\n`;\n      }\n    });\n    report += '\\n';\n  }\n\n  if (missingKeys.length > 0) {\n    report += '## 缺失的翻译键\\n\\n';\n    missingKeys.forEach((key) => {\n      report += `- ${key}\\n`;\n    });\n  }\n\n  return report;\n}\n\n/**\n * 验证翻译完整性\n */\nfunction validateTranslationCompleteness(\n  translations: Record<string, Record<string, unknown>>,\n  allKeys: Set<string>,\n  errors: TranslationError[],\n  warnings: TranslationWarning[],\n  missingKeys: string[],\n): void {\n  for (const locale of routing.locales) {\n    const translation = translations[locale];\n    if (!translation) continue;\n\n    const localeKeys = new Set(extractKeys(translation));\n\n    // 检查缺失的键\n    for (const key of allKeys) {\n      if (!localeKeys.has(key)) {\n        missingKeys.push(`${locale}.${key}`);\n        errors.push({\n          type: 'missing_key',\n          key,\n          locale,\n          message: `Missing translation for key: ${key}`,\n          severity: 'high',\n        });\n      }\n    }\n\n    // 检查翻译质量\n    validateTranslationQuality(\n      translation,\n      locale,\n      localeKeys,\n      translations,\n      errors,\n      warnings,\n    );\n  }\n}\n\n/**\n * 验证翻译质量\n */\nfunction validateTranslationQuality(\n  translation: Record<string, unknown>,\n  locale: string,\n  localeKeys: Set<string>,\n  translations: Record<string, Record<string, unknown>>,\n  errors: TranslationError[],\n  warnings: TranslationWarning[],\n): void {\n  for (const key of localeKeys) {\n    const value = getNestedValue(translation, key);\n\n    // 检查空值\n    if (!value || (typeof value === 'string' && value.trim() === '')) {\n      errors.push({\n        type: 'empty_value',\n        key,\n        locale,\n        message: `Empty translation value for key: ${key}`,\n        severity: 'medium',\n      });\n    }\n\n    // 检查是否未翻译（与其他语言相同）\n    if (typeof value === 'string') {\n      checkUntranslatedContent(value, key, locale, translations, warnings);\n      checkPlaceholderConsistency(value, key, locale, translations, warnings);\n    }\n  }\n}\n\n/**\n * 检查未翻译内容\n */\nfunction checkUntranslatedContent(\n  value: string,\n  key: string,\n  locale: string,\n  translations: Record<string, Record<string, unknown>>,\n  warnings: TranslationWarning[],\n): void {\n  const otherLocales = routing.locales.filter((l) => l !== locale);\n  for (const otherLocale of otherLocales) {\n    const otherValue = getNestedValue(translations[otherLocale] || {}, key);\n    if (value === otherValue && key !== 'home.title') {\n      warnings.push({\n        type: 'untranslated',\n        key,\n        locale,\n        message: `Possibly untranslated: same value as ${otherLocale}`,\n        suggestion: `Consider translating \"${value}\" to ${locale}`,\n      });\n    }\n  }\n}\n\n/**\n * 检查占位符一致性\n */\nfunction checkPlaceholderConsistency(\n  value: string,\n  key: string,\n  locale: string,\n  translations: Record<string, Record<string, unknown>>,\n  warnings: TranslationWarning[],\n): void {\n  const placeholders = value.match(/\\{[^}]+\\}/g) || [];\n  const referencePlaceholders = getNestedValue(\n    translations[routing.locales[0]] || {},\n    key,\n  );\n  if (typeof referencePlaceholders === 'string') {\n    const refPlaceholders = referencePlaceholders.match(/\\{[^}]+\\}/g) || [];\n    if (placeholders.length !== refPlaceholders.length) {\n      warnings.push({\n        type: 'placeholder_mismatch',\n        key,\n        locale,\n        message: `Placeholder count mismatch: expected ${refPlaceholders.length}, got ${placeholders.length}`,\n        suggestion: `Ensure all placeholders are present: ${refPlaceholders.join(', ')}`,\n      });\n    }\n  }\n}\n\n/**\n * 实时翻译同步检查\n */\nexport function createTranslationSyncChecker() {\n  let lastValidation: TranslationValidationResult | null = null;\n\n  return {\n    async check(): Promise<TranslationValidationResult> {\n      const result = await validateTranslations();\n      lastValidation = result;\n      return result;\n    },\n\n    getLastResult(): TranslationValidationResult | null {\n      return lastValidation;\n    },\n\n    isHealthy(): boolean {\n      return lastValidation?.isValid ?? false;\n    },\n\n    getCoverage(): number {\n      return lastValidation?.coverage ?? 0;\n    },\n  };\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-constants.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-detection-hooks.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-detection-types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-detection.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-detector-base.ts","messages":[{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (4). Maximum allowed is 3.","line":252,"column":11,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":254,"endColumn":12},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (4). Maximum allowed is 3.","line":259,"column":11,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":261,"endColumn":12},{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":262,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":262,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":262,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":262,"endColumn":23}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 语言检测器基础方法\n * \n * 提供浏览器检测、地理位置检测、时区检测等基础检测方法\n */\n\nimport { Locale } from '@/types/i18n';\nimport { DEFAULT_LOCALE, SUPPORTED_LOCALES } from './locale-constants';\nimport {\n  LANGUAGE_CODE_TO_LOCALE_MAP,\n  COUNTRY_CODE_TO_LOCALE_MAP,\n  TIMEZONE_TO_LOCALE_MAP,\n  DETECTION_TIMEOUTS,\n  GEO_API_CONFIG,\n} from './locale-detector-constants';\n\n/**\n * 基础语言检测器\n * Base locale detector with fundamental detection methods\n */\nexport class BaseLocaleDetector {\n  /**\n   * 安全地从语言映射中获取语言\n   * Safely get locale from language mapping\n   * 使用白名单验证，避免 Object Injection Sink\n   */\n  protected getLocaleFromLanguageCode(normalizedLang: string): Locale | undefined {\n    if (!normalizedLang || typeof normalizedLang !== 'string') {\n      return undefined;\n    }\n\n    const locale = LANGUAGE_CODE_TO_LOCALE_MAP.get(normalizedLang.toLowerCase());\n    return locale && SUPPORTED_LOCALES.includes(locale) ? locale : undefined;\n  }\n\n  /**\n   * 安全地从地理位置映射中获取语言\n   * Safely get locale from geo mapping\n   * 使用白名单验证，避免 Object Injection Sink\n   */\n  protected getLocaleFromCountryCode(countryCode: string | undefined): Locale | undefined {\n    if (!countryCode || typeof countryCode !== 'string') {\n      return undefined;\n    }\n\n    const locale = COUNTRY_CODE_TO_LOCALE_MAP.get(countryCode.toUpperCase());\n    return locale && SUPPORTED_LOCALES.includes(locale) ? locale : undefined;\n  }\n\n  /**\n   * 安全地从时区映射中获取语言\n   * Safely get locale from timezone mapping\n   */\n  protected getLocaleFromTimeZone(timeZone: string | undefined): Locale | undefined {\n    if (!timeZone || typeof timeZone !== 'string') {\n      return undefined;\n    }\n\n    const locale = TIMEZONE_TO_LOCALE_MAP.get(timeZone);\n    return locale && SUPPORTED_LOCALES.includes(locale) ? locale : undefined;\n  }\n\n  /**\n   * 从浏览器检测语言\n   * Detect locale from browser\n   */\n  detectFromBrowser(): Locale {\n    try {\n      if (typeof navigator === 'undefined') {\n        return DEFAULT_LOCALE;\n      }\n\n      const languages = navigator.languages || [navigator.language];\n\n      for (const lang of languages) {\n        const normalizedLang = lang.toLowerCase();\n        const detectedLocale = this.getLocaleFromLanguageCode(normalizedLang);\n\n        if (detectedLocale) {\n          return detectedLocale;\n        }\n\n        // 尝试提取主要语言代码 (例如: 'zh-CN' -> 'zh')\n        const primaryLang = normalizedLang.split('-')[0];\n        const primaryLocale = this.getLocaleFromLanguageCode(primaryLang);\n        \n        if (primaryLocale) {\n          return primaryLocale;\n        }\n      }\n\n      return DEFAULT_LOCALE;\n    } catch (error) {\n      if (process.env.NODE_ENV === 'development') {\n        console.warn('Browser locale detection failed:', error);\n      }\n      return DEFAULT_LOCALE;\n    }\n  }\n\n  /**\n   * 从地理位置检测语言\n   * Detect locale from geolocation\n   */\n  async detectFromGeolocation(): Promise<Locale> {\n    try {\n      if (typeof navigator === 'undefined' || !navigator.geolocation) {\n        return DEFAULT_LOCALE;\n      }\n\n      return await new Promise<Locale>((resolve) => {\n        const timeoutId = setTimeout(() => {\n          resolve(DEFAULT_LOCALE);\n        }, DETECTION_TIMEOUTS.GEOLOCATION);\n\n        navigator.geolocation.getCurrentPosition(\n          async (position) => {\n            clearTimeout(timeoutId);\n            try {\n              const countryCode = await this.getCountryFromCoordinates(\n                position.coords.latitude,\n                position.coords.longitude\n              );\n              \n              const detectedLocale = this.getLocaleFromCountryCode(countryCode);\n              resolve(detectedLocale || DEFAULT_LOCALE);\n            } catch (error) {\n              if (process.env.NODE_ENV === 'development') {\n                console.warn('Geolocation API failed:', error);\n              }\n              resolve(DEFAULT_LOCALE);\n            }\n          },\n          (error) => {\n            clearTimeout(timeoutId);\n            if (process.env.NODE_ENV === 'development') {\n              console.warn('Geolocation permission denied or failed:', error);\n            }\n            resolve(DEFAULT_LOCALE);\n          },\n          { \n            timeout: DETECTION_TIMEOUTS.GEOLOCATION,\n            enableHighAccuracy: false,\n            maximumAge: 10 * 60 * 1000, // 10分钟缓存\n          }\n        );\n      });\n    } catch (error) {\n      if (process.env.NODE_ENV === 'development') {\n        console.warn('Geolocation detection failed:', error);\n      }\n      return DEFAULT_LOCALE;\n    }\n  }\n\n  /**\n   * 从时区检测语言\n   * Detect locale from timezone\n   */\n  detectFromTimeZone(): Locale {\n    try {\n      if (typeof Intl === 'undefined' || !Intl.DateTimeFormat) {\n        return DEFAULT_LOCALE;\n      }\n\n      const { timeZone } = Intl.DateTimeFormat().resolvedOptions();\n      const detectedLocale = this.getLocaleFromTimeZone(timeZone);\n\n      return detectedLocale || DEFAULT_LOCALE;\n    } catch (error) {\n      if (process.env.NODE_ENV === 'development') {\n        console.warn('Timezone detection failed:', error);\n      }\n      return DEFAULT_LOCALE;\n    }\n  }\n\n  /**\n   * 从IP地址检测语言\n   * Detect locale from IP address\n   */\n  async detectFromIP(): Promise<Locale> {\n    try {\n      const countryCode = await this.getCountryFromIP();\n      const detectedLocale = this.getLocaleFromCountryCode(countryCode);\n      \n      return detectedLocale || DEFAULT_LOCALE;\n    } catch (error) {\n      if (process.env.NODE_ENV === 'development') {\n        console.warn('IP-based detection failed:', error);\n      }\n      return DEFAULT_LOCALE;\n    }\n  }\n\n  /**\n   * 根据坐标获取国家代码\n   * Get country code from coordinates\n   */\n  private async getCountryFromCoordinates(lat: number, lng: number): Promise<string | undefined> {\n    const controller = new AbortController();\n    const timeoutId = setTimeout(() => controller.abort(), DETECTION_TIMEOUTS.NETWORK_REQUEST);\n\n    try {\n      // 在实际应用中，这里应该调用真实的地理位置API\n      // 例如: Google Geocoding API, OpenStreetMap Nominatim, 等\n      const response = await fetch(\n        `https://api.example.com/geo?lat=${lat}&lng=${lng}`,\n        { \n          signal: controller.signal,\n          headers: {\n            'Accept': 'application/json',\n          },\n        }\n      );\n\n      if (!response.ok) {\n        throw new Error(`HTTP ${response.status}`);\n      }\n\n      const data = await response.json();\n      return data.country || data.country_code || data.countryCode;\n    } catch (error) {\n      if (error instanceof Error && error.name === 'AbortError') {\n        throw new Error('Geolocation API request timeout');\n      }\n      throw error;\n    } finally {\n      clearTimeout(timeoutId);\n    }\n  }\n\n  /**\n   * 根据IP地址获取国家代码\n   * Get country code from IP address\n   */\n  private async getCountryFromIP(): Promise<string | undefined> {\n    const controller = new AbortController();\n    const timeoutId = setTimeout(() => controller.abort(), DETECTION_TIMEOUTS.NETWORK_REQUEST);\n\n    try {\n      // 尝试多个IP地理位置API\n      for (const endpoint of GEO_API_CONFIG.ENDPOINTS) {\n        try {\n          const response = await fetch(endpoint, {\n            signal: controller.signal,\n            headers: {\n              'Accept': 'application/json',\n            },\n          });\n\n          if (!response.ok) {\n            continue; // 尝试下一个端点\n          }\n\n          const data = await response.json();\n          const countryCode = data.country || data.country_code || data.countryCode;\n          \n          if (countryCode) {\n            return countryCode;\n          }\n        } catch (error) {\n          // 继续尝试下一个端点\n          continue;\n        }\n      }\n\n      throw new Error('All IP geolocation endpoints failed');\n    } catch (error) {\n      if (error instanceof Error && error.name === 'AbortError') {\n        throw new Error('IP geolocation request timeout');\n      }\n      throw error;\n    } finally {\n      clearTimeout(timeoutId);\n    }\n  }\n\n  /**\n   * 验证检测到的语言是否受支持\n   * Validate if detected locale is supported\n   */\n  protected validateLocale(locale: Locale | undefined): Locale {\n    return locale && SUPPORTED_LOCALES.includes(locale) ? locale : DEFAULT_LOCALE;\n  }\n\n  /**\n   * 获取浏览器支持的语言列表\n   * Get browser supported languages\n   */\n  getBrowserLanguages(): string[] {\n    try {\n      if (typeof navigator === 'undefined') {\n        return [];\n      }\n\n      return navigator.languages ? Array.from(navigator.languages) : [navigator.language];\n    } catch (error) {\n      if (process.env.NODE_ENV === 'development') {\n        console.warn('Failed to get browser languages:', error);\n      }\n      return [];\n    }\n  }\n\n  /**\n   * 获取当前时区信息\n   * Get current timezone info\n   */\n  getTimeZoneInfo(): { timeZone: string; offset: number } | null {\n    try {\n      if (typeof Intl === 'undefined' || !Intl.DateTimeFormat) {\n        return null;\n      }\n\n      const { timeZone } = Intl.DateTimeFormat().resolvedOptions();\n      const offset = new Date().getTimezoneOffset();\n\n      return { timeZone, offset };\n    } catch (error) {\n      if (process.env.NODE_ENV === 'development') {\n        console.warn('Failed to get timezone info:', error);\n      }\n      return null;\n    }\n  }\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-detector-constants.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-detector-smart.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'TEST_APP_CONSTANTS' is defined but never used. Allowed unused vars must match /^_/u.","line":8,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":28,"suggestions":[{"messageId":"removeVar","data":{"varName":"TEST_APP_CONSTANTS"},"fix":{"range":[93,157],"text":""},"desc":"Remove unused variable 'TEST_APP_CONSTANTS'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'TEST_APP_CONSTANTS' is defined but never used. Allowed unused vars must match /^_/u.","line":8,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":28},{"ruleId":"max-statements","severity":2,"message":"Method 'analyzeBestLocale' has too many statements (29). Maximum allowed is 20.","line":207,"column":28,"nodeType":"FunctionExpression","messageId":"exceed","endLine":282,"endColumn":4},{"ruleId":"max-statements","severity":2,"message":"Method 'getDetectionQuality' has too many statements (22). Maximum allowed is 20.","line":335,"column":22,"nodeType":"FunctionExpression","messageId":"exceed","endLine":377,"endColumn":4}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 智能语言检测算法\n *\n * 提供综合检测逻辑、置信度计算、结果分析等智能检测功能\n */\n\nimport { Locale } from '@/types/i18n';\nimport { TEST_APP_CONSTANTS } from '@/constants/test-constants';\nimport { DEFAULT_LOCALE, SUPPORTED_LOCALES } from './locale-constants';\nimport { LocaleDetectionResult } from './locale-detection-types';\nimport { LocaleStorageManager } from './locale-storage';\nimport { BaseLocaleDetector } from './locale-detector-base';\nimport {\n  CONFIDENCE_WEIGHTS,\n  DETECTION_SOURCES,\n  QUALITY_THRESHOLDS,\n  DetectionSource,\n} from './locale-detector-constants';\n\n/**\n * 检测结果接口\n * Detection result interface\n */\ninterface DetectionResult {\n  locale: Locale;\n  source: DetectionSource;\n  weight: number;\n  confidence: number;\n}\n\n/**\n * 智能语言检测器\n * Smart locale detector with advanced algorithms\n */\nexport class SmartLocaleDetector extends BaseLocaleDetector {\n  /**\n   * 智能检测用户语言偏好\n   * Smart detection of user locale preference\n   */\n  async detectSmartLocale(): Promise<LocaleDetectionResult> {\n    // 1. 检查用户手动设置 (最高优先级)\n    const userOverride = LocaleStorageManager.getUserOverride();\n    if (userOverride && SUPPORTED_LOCALES.includes(userOverride)) {\n      return {\n        locale: userOverride,\n        source: DETECTION_SOURCES.USER,\n        confidence: CONFIDENCE_WEIGHTS.USER_OVERRIDE,\n        details: { userOverride },\n      };\n    }\n\n    // 2. 检查存储的用户偏好\n    const userPreference = LocaleStorageManager.getUserPreference();\n    if (userPreference && SUPPORTED_LOCALES.includes(userPreference.locale)) {\n      return {\n        locale: userPreference.locale,\n        source: DETECTION_SOURCES.STORED,\n        confidence: userPreference.confidence || CONFIDENCE_WEIGHTS.STORED_PREFERENCE,\n        details: { storedPreference: userPreference },\n      };\n    }\n\n    // 3. 收集所有检测结果\n    const detectionResults = await this.collectAllDetectionResults();\n\n    // 4. 如果没有任何检测结果，返回默认语言\n    if (detectionResults.length === 0) {\n      return {\n        locale: DEFAULT_LOCALE,\n        source: DETECTION_SOURCES.DEFAULT,\n        confidence: CONFIDENCE_WEIGHTS.DEFAULT_FALLBACK,\n        details: { fallbackUsed: true },\n      };\n    }\n\n    // 5. 分析检测结果并选择最佳语言\n    const bestResult = this.analyzeBestLocale(detectionResults);\n\n    return bestResult;\n  }\n\n  /**\n   * 检测最佳语言偏好 (兼容方法名)\n   * Detect best locale preference (compatibility method)\n   */\n  async detectBestLocale(): Promise<LocaleDetectionResult> {\n    // 1. 检查存储的用户偏好\n    const userPreference = LocaleStorageManager.getUserPreference();\n    if (userPreference && SUPPORTED_LOCALES.includes(userPreference.locale)) {\n      return {\n        locale: userPreference.locale,\n        source: DETECTION_SOURCES.STORED,\n        confidence: userPreference.confidence || CONFIDENCE_WEIGHTS.STORED_PREFERENCE,\n        details: { userOverride: userPreference.locale },\n      };\n    }\n\n    // 2. 检查用户手动设置\n    const userOverride = LocaleStorageManager.getUserOverride();\n    if (userOverride && SUPPORTED_LOCALES.includes(userOverride)) {\n      return {\n        locale: userOverride,\n        source: DETECTION_SOURCES.USER,\n        confidence: CONFIDENCE_WEIGHTS.USER_OVERRIDE,\n        details: { userOverride },\n      };\n    }\n\n    // 3. 按优先级逐个检测\n    const geoLocale = await this.detectFromGeolocation();\n    if (geoLocale !== DEFAULT_LOCALE) {\n      return {\n        locale: geoLocale,\n        source: DETECTION_SOURCES.GEO,\n        confidence: CONFIDENCE_WEIGHTS.GEOLOCATION,\n        details: { geoLocale },\n      };\n    }\n\n    const browserLocale = this.detectFromBrowser();\n    if (browserLocale !== DEFAULT_LOCALE) {\n      return {\n        locale: browserLocale,\n        source: DETECTION_SOURCES.BROWSER,\n        confidence: CONFIDENCE_WEIGHTS.BROWSER_LANGUAGE,\n        details: { browserLocale },\n      };\n    }\n\n    // 4. 使用默认语言\n    return {\n      locale: DEFAULT_LOCALE,\n      source: DETECTION_SOURCES.DEFAULT,\n      confidence: CONFIDENCE_WEIGHTS.DEFAULT_FALLBACK,\n      details: { fallbackUsed: true },\n    };\n  }\n\n  /**\n   * 收集所有检测结果\n   * Collect all detection results\n   */\n  private async collectAllDetectionResults(): Promise<DetectionResult[]> {\n    const results: DetectionResult[] = [];\n\n    try {\n      // 并行执行所有检测方法\n      const [geoLocale, browserLocale, timeZoneLocale, ipLocale] = await Promise.allSettled([\n        this.detectFromGeolocation(),\n        Promise.resolve(this.detectFromBrowser()),\n        Promise.resolve(this.detectFromTimeZone()),\n        this.detectFromIP(),\n      ]);\n\n      // 处理地理位置检测结果\n      if (geoLocale.status === 'fulfilled' && geoLocale.value !== DEFAULT_LOCALE) {\n        results.push({\n          locale: geoLocale.value,\n          source: DETECTION_SOURCES.GEO,\n          weight: CONFIDENCE_WEIGHTS.GEOLOCATION,\n          confidence: CONFIDENCE_WEIGHTS.GEOLOCATION,\n        });\n      }\n\n      // 处理浏览器语言检测结果\n      if (browserLocale.status === 'fulfilled' && browserLocale.value !== DEFAULT_LOCALE) {\n        results.push({\n          locale: browserLocale.value,\n          source: DETECTION_SOURCES.BROWSER,\n          weight: CONFIDENCE_WEIGHTS.BROWSER_LANGUAGE,\n          confidence: CONFIDENCE_WEIGHTS.BROWSER_LANGUAGE,\n        });\n      }\n\n      // 处理时区检测结果\n      if (timeZoneLocale.status === 'fulfilled' && timeZoneLocale.value !== DEFAULT_LOCALE) {\n        results.push({\n          locale: timeZoneLocale.value,\n          source: DETECTION_SOURCES.TIMEZONE,\n          weight: CONFIDENCE_WEIGHTS.TIMEZONE,\n          confidence: CONFIDENCE_WEIGHTS.TIMEZONE,\n        });\n      }\n\n      // 处理IP检测结果\n      if (ipLocale.status === 'fulfilled' && ipLocale.value !== DEFAULT_LOCALE) {\n        results.push({\n          locale: ipLocale.value,\n          source: DETECTION_SOURCES.GEO, // IP检测归类为地理位置检测\n          weight: CONFIDENCE_WEIGHTS.GEOLOCATION * 0.8, // IP检测权重略低于GPS\n          confidence: CONFIDENCE_WEIGHTS.GEOLOCATION * 0.8,\n        });\n      }\n    } catch (error) {\n      if (process.env.NODE_ENV === 'development') {\n        console.warn('Error collecting detection results:', error);\n      }\n    }\n\n    return results;\n  }\n\n  /**\n   * 分析最佳语言选择\n   * Analyze best locale choice\n   */\n  private analyzeBestLocale(detectionResults: DetectionResult[]): LocaleDetectionResult {\n    // 统计每种语言的出现次数和权重\n    const localeStats = new Map<\n      Locale,\n      { count: number; totalWeight: number; sources: DetectionSource[]; maxConfidence: number }\n    >();\n\n    for (const result of detectionResults) {\n      const current = localeStats.get(result.locale) || {\n        count: 0,\n        totalWeight: 0,\n        sources: [],\n        maxConfidence: 0,\n      };\n\n      current.count += 1;\n      current.totalWeight += result.weight;\n      current.sources.push(result.source);\n      current.maxConfidence = Math.max(current.maxConfidence, result.confidence);\n\n      localeStats.set(result.locale, current);\n    }\n\n    // 计算每种语言的综合得分\n    let bestLocale = DEFAULT_LOCALE;\n    let bestScore = 0;\n    let bestSources: DetectionSource[] = [];\n    let bestConfidence = CONFIDENCE_WEIGHTS.DEFAULT_FALLBACK;\n\n    for (const [locale, stats] of localeStats.entries()) {\n      // 综合得分 = 权重总和 + 一致性奖励\n      const consistencyBonus = stats.count > 1 ? QUALITY_THRESHOLDS.CONSISTENCY_BONUS : 0;\n      const score = stats.totalWeight + consistencyBonus;\n\n      if (score > bestScore) {\n        bestScore = score;\n        bestLocale = locale;\n        bestSources = stats.sources;\n\n        // 计算最终置信度\n        const baseConfidence = Math.min(\n          stats.totalWeight / detectionResults.length,\n          QUALITY_THRESHOLDS.HIGH_CONFIDENCE\n        );\n        bestConfidence = Math.min(baseConfidence + consistencyBonus, 1.0);\n      }\n    }\n\n    // 构建详细信息\n    const details: Record<string, string | number | boolean> = {};\n    for (const result of detectionResults) {\n      if (result.source === DETECTION_SOURCES.GEO) {\n        details.geoLocale = result.locale;\n      } else if (result.source === DETECTION_SOURCES.BROWSER) {\n        details.browserLocale = result.locale;\n      } else if (result.source === DETECTION_SOURCES.TIMEZONE) {\n        details.timeZoneLocale = result.locale;\n      }\n    }\n\n    // 添加统计信息\n    details.detectionStats = {\n      totalSources: detectionResults.length,\n      consistentSources: localeStats.get(bestLocale)?.count || 0,\n      score: bestScore,\n    };\n\n    return {\n      locale: bestLocale,\n      source: bestSources.length > QUALITY_THRESHOLDS.MIN_SOURCES_FOR_COMBINED\n        ? DETECTION_SOURCES.COMBINED\n        : bestSources[0] || DETECTION_SOURCES.DEFAULT,\n      confidence: bestConfidence,\n      details,\n    };\n  }\n\n  /**\n   * 快速检测语言 (仅使用本地方法)\n   * Quick locale detection (local methods only)\n   */\n  detectQuickLocale(): LocaleDetectionResult {\n    // 1. 检查用户设置\n    const userOverride = LocaleStorageManager.getUserOverride();\n    if (userOverride && SUPPORTED_LOCALES.includes(userOverride)) {\n      return {\n        locale: userOverride,\n        source: DETECTION_SOURCES.USER,\n        confidence: CONFIDENCE_WEIGHTS.USER_OVERRIDE,\n        details: { userOverride },\n      };\n    }\n\n    // 2. 检查浏览器语言\n    const browserLocale = this.detectFromBrowser();\n    if (browserLocale !== DEFAULT_LOCALE) {\n      return {\n        locale: browserLocale,\n        source: DETECTION_SOURCES.BROWSER,\n        confidence: CONFIDENCE_WEIGHTS.BROWSER_LANGUAGE,\n        details: { browserLocale },\n      };\n    }\n\n    // 3. 检查时区\n    const timeZoneLocale = this.detectFromTimeZone();\n    if (timeZoneLocale !== DEFAULT_LOCALE) {\n      return {\n        locale: timeZoneLocale,\n        source: DETECTION_SOURCES.TIMEZONE,\n        confidence: CONFIDENCE_WEIGHTS.TIMEZONE,\n        details: { timeZoneLocale },\n      };\n    }\n\n    // 4. 返回默认语言\n    return {\n      locale: DEFAULT_LOCALE,\n      source: DETECTION_SOURCES.DEFAULT,\n      confidence: CONFIDENCE_WEIGHTS.DEFAULT_FALLBACK,\n      details: { fallbackUsed: true },\n    };\n  }\n\n  /**\n   * 获取检测质量评估\n   * Get detection quality assessment\n   */\n  getDetectionQuality(result: LocaleDetectionResult): {\n    quality: 'high' | 'medium' | 'low';\n    reliability: number;\n    recommendations: string[];\n  } {\n    const { confidence, source, details } = result;\n    const recommendations: string[] = [];\n\n    // 评估质量等级\n    let quality: 'high' | 'medium' | 'low';\n    if (confidence >= QUALITY_THRESHOLDS.HIGH_CONFIDENCE) {\n      quality = 'high';\n    } else if (confidence >= QUALITY_THRESHOLDS.MEDIUM_CONFIDENCE) {\n      quality = 'medium';\n    } else {\n      quality = 'low';\n    }\n\n    // 计算可靠性\n    let reliability = confidence;\n    if (source === DETECTION_SOURCES.COMBINED) {\n      reliability += 0.1; // 组合检测更可靠\n    }\n    if (details?.detectionStats?.consistentSources > 1) {\n      reliability += 0.05; // 一致性检测更可靠\n    }\n    reliability = Math.min(reliability, 1.0);\n\n    // 生成建议\n    if (quality === 'low') {\n      recommendations.push('建议用户手动选择语言');\n      recommendations.push('可以尝试启用地理位置权限以提高检测准确性');\n    }\n    if (source === DETECTION_SOURCES.DEFAULT) {\n      recommendations.push('检测失败，使用了默认语言');\n      recommendations.push('建议检查浏览器语言设置');\n    }\n    if (!details?.geoLocale && quality !== 'high') {\n      recommendations.push('地理位置检测未成功，可能影响准确性');\n    }\n\n    return { quality, reliability, recommendations };\n  }\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-detector.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'Locale' is defined but never used. Allowed unused vars must match /^_/u.","line":17,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"Locale"},"fix":{"range":[460,503],"text":""},"desc":"Remove unused variable 'Locale'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Locale' is defined but never used. Allowed unused vars must match /^_/u.","line":17,"column":15,"nodeType":null,"messageId":"unusedVar","endLine":17,"endColumn":21},{"ruleId":"no-return-await","severity":2,"message":"Redundant use of `await` on a return value.","line":50,"column":10,"nodeType":"Identifier","messageId":"redundantUseOfAwait","endLine":50,"endColumn":44,"suggestions":[{"messageId":"removeAwait","fix":{"range":[1279,1285],"text":""},"desc":"Remove redundant `await`."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 语言检测器 - 主入口文件\n * Locale Detector - Main Entry Point\n *\n * 统一的语言检测管理接口，整合所有子模块功能\n */\n\n// 重新导出所有模块的类型和功能\nexport * from './locale-detector-constants';\nexport * from './locale-detector-base';\nexport * from './locale-detector-smart';\n\n// 导入主要功能类\nimport { SmartLocaleDetector as SmartDetector } from './locale-detector-smart';\nimport { BaseLocaleDetector } from './locale-detector-base';\nimport type { LocaleDetectionResult } from './locale-detection-types';\nimport type { Locale } from '@/types/i18n';\n\n/**\n * 智能语言检测器 - 向后兼容的主类\n * Smart Locale Detector - Backward compatible main class\n */\nexport class SmartLocaleDetector extends SmartDetector {\n  // 向后兼容的方法 - 继承自SmartDetector，无需重新实现\n}\n// ==================== 便捷导出和工厂函数 ====================\n\n/**\n * 创建智能语言检测器实例\n * Create smart locale detector instance\n */\nexport function createSmartLocaleDetector(): SmartLocaleDetector {\n  return new SmartLocaleDetector();\n}\n\n/**\n * 创建基础语言检测器实例\n * Create base locale detector instance\n */\nexport function createBaseLocaleDetector(): BaseLocaleDetector {\n  return new BaseLocaleDetector();\n}\n\n/**\n * 快速检测当前用户语言\n * Quick detection of current user locale\n */\nexport async function detectCurrentLocale(): Promise<LocaleDetectionResult> {\n  const detector = new SmartLocaleDetector();\n  return await detector.detectSmartLocale();\n}\n\n/**\n * 快速检测当前用户语言 (仅本地方法)\n * Quick detection of current user locale (local methods only)\n */\nexport function detectCurrentLocaleSync(): LocaleDetectionResult {\n  const detector = new SmartLocaleDetector();\n  return detector.detectQuickLocale();\n}\n\n// ==================== 默认导出 ====================\n\n/**\n * 默认导出智能语言检测器\n * Default export smart locale detector\n */\nexport default SmartLocaleDetector;\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-storage-analytics-core.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'Locale' is defined but never used. Allowed unused vars must match /^_/u.","line":10,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"Locale"},"fix":{"range":[106,144],"text":""},"desc":"Remove unused variable 'Locale'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Locale' is defined but never used. Allowed unused vars must match /^_/u.","line":10,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":10,"endColumn":16},{"ruleId":"no-unused-vars","severity":2,"message":"'UserLocalePreference' is defined but never used. Allowed unused vars must match /^_/u.","line":16,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":23,"suggestions":[{"messageId":"removeVar","data":{"varName":"UserLocalePreference"},"fix":{"range":[283,307],"text":""},"desc":"Remove unused variable 'UserLocalePreference'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'UserLocalePreference' is defined but never used. Allowed unused vars must match /^_/u.","line":16,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":16,"endColumn":23},{"ruleId":"no-duplicate-imports","severity":2,"message":"'./locale-storage-types' import is duplicated.","line":19,"column":1,"nodeType":"ImportDeclaration","messageId":"import","endLine":19,"endColumn":62},{"ruleId":"complexity","severity":1,"message":"Function 'calculateStorageStats' has a complexity of 24. Maximum allowed is 20.","line":27,"column":8,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":77,"endColumn":2},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":92,"column":5,"nodeType":"MemberExpression","endLine":92,"endColumn":25},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":92,"column":29,"nodeType":"MemberExpression","endLine":92,"endColumn":49},{"ruleId":"max-statements","severity":2,"message":"Function 'calculateHealthCheck' has too many statements (26). Maximum allowed is 20.","line":132,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":194,"endColumn":2}],"suppressedMessages":[],"errorCount":8,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 语言存储分析核心功能\n * Locale Storage Analytics Core Functions\n * \n * 负责核心统计信息收集和健康检查功能\n */\n\n'use client';\n\nimport { Locale } from '@/types/i18n';\nimport { LocalStorageManager } from './locale-storage-local';\nimport type {\n  StorageStats,\n  StorageHealthCheck,\n  StorageOperationResult,\n  UserLocalePreference,\n  LocaleDetectionHistory,\n} from './locale-storage-types';\nimport { estimateStorageSize } from './locale-storage-types';\n\n// ==================== 核心统计功能 ====================\n\n/**\n * 计算存储统计信息\n * Calculate storage statistics\n */\nexport function calculateStorageStats(): StorageStats {\n  const now = Date.now();\n  \n  // 获取所有存储的数据\n  const userPreference = LocalStorageManager.getUserPreference();\n  const detectionHistory = LocalStorageManager.getDetectionHistory();\n  const fallbackLocale = LocalStorageManager.getFallbackLocale();\n  \n  // 计算存储大小\n  const userPreferenceSize = estimateStorageSize(userPreference);\n  const historySize = estimateStorageSize(detectionHistory);\n  const fallbackSize = estimateStorageSize(fallbackLocale);\n  const totalSize = userPreferenceSize + historySize + fallbackSize;\n  \n  // 计算历史记录统计\n  const historyCount = detectionHistory?.history?.length || 0;\n  const uniqueLocales = new Set(\n    detectionHistory?.history?.map(h => h.detectedLocale) || []\n  ).size;\n  \n  // 计算最近活动\n  const lastActivity = Math.max(\n    userPreference?.lastUpdated || 0,\n    detectionHistory?.lastUpdated || 0,\n    fallbackLocale?.lastUpdated || 0\n  );\n  \n  // 计算数据新鲜度 (0-1, 1表示最新)\n  const maxAge = 7 * 24 * 60 * 60 * 1000; // 7天\n  const dataAge = now - lastActivity;\n  const freshness = Math.max(0, 1 - (dataAge / maxAge));\n  \n  return {\n    totalSize,\n    itemCount: (userPreference ? 1 : 0) + (detectionHistory ? 1 : 0) + (fallbackLocale ? 1 : 0),\n    lastActivity,\n    freshness,\n    breakdown: {\n      userPreference: userPreferenceSize,\n      detectionHistory: historySize,\n      fallbackLocale: fallbackSize,\n    },\n    historyStats: {\n      totalEntries: historyCount,\n      uniqueLocales,\n      oldestEntry: detectionHistory?.history?.[historyCount - 1]?.timestamp || 0,\n      newestEntry: detectionHistory?.history?.[0]?.timestamp || 0,\n    },\n    localeDistribution: calculateLocaleDistribution(detectionHistory),\n  };\n}\n\n/**\n * 计算语言分布\n * Calculate locale distribution\n */\nfunction calculateLocaleDistribution(detectionHistory: LocaleDetectionHistory | null): Record<string, number> {\n  if (!detectionHistory?.history) {\n    return {};\n  }\n  \n  const distribution: Record<string, number> = {};\n  \n  for (const entry of detectionHistory.history) {\n    const locale = entry.detectedLocale;\n    distribution[locale] = (distribution[locale] || 0) + 1;\n  }\n  \n  return distribution;\n}\n\n/**\n * 获取存储统计信息\n * Get storage statistics\n */\nexport function getStorageStats(): StorageOperationResult<StorageStats> {\n  const startTime = Date.now();\n  \n  try {\n    const stats = calculateStorageStats();\n    \n    return {\n      success: true,\n      data: stats,\n      source: 'localStorage',\n      timestamp: Date.now(),\n      responseTime: Date.now() - startTime,\n    };\n  } catch (error) {\n    return {\n      success: false,\n      error: error instanceof Error ? error.message : 'Unknown error',\n      source: 'localStorage',\n      timestamp: Date.now(),\n      responseTime: Date.now() - startTime,\n    };\n  }\n}\n\n// ==================== 健康检查功能 ====================\n\n/**\n * 计算健康检查结果\n * Calculate health check results\n */\nexport function calculateHealthCheck(): StorageHealthCheck {\n  const stats = calculateStorageStats();\n  const availability = checkStorageAvailability();\n  \n  // 计算健康分数 (0-1)\n  let healthScore = 1.0;\n  const issues: string[] = [];\n  \n  // 检查存储可用性\n  if (!availability.localStorageAvailable) {\n    healthScore -= 0.4;\n    issues.push('localStorage不可用');\n  }\n  \n  if (!availability.cookiesAvailable) {\n    healthScore -= 0.2;\n    issues.push('Cookies不可用');\n  }\n  \n  // 检查数据新鲜度\n  if (stats.freshness < 0.5) {\n    healthScore -= 0.2;\n    issues.push('数据过期');\n  }\n  \n  // 检查存储大小\n  const maxSize = 5 * 1024 * 1024; // 5MB\n  if (stats.totalSize > maxSize * 0.8) {\n    healthScore -= 0.1;\n    issues.push('存储空间使用过多');\n  }\n  \n  // 检查历史记录数量\n  if (stats.historyStats.totalEntries > 1000) {\n    healthScore -= 0.1;\n    issues.push('历史记录过多');\n  }\n  \n  // 确定健康状态\n  let status: 'healthy' | 'warning' | 'error';\n  if (healthScore >= 0.8) {\n    status = 'healthy';\n  } else if (healthScore >= 0.5) {\n    status = 'warning';\n  } else {\n    status = 'error';\n  }\n  \n  return {\n    status,\n    score: Math.max(0, healthScore),\n    issues,\n    lastCheck: Date.now(),\n    availability,\n    recommendations: generateHealthRecommendations(healthScore, issues),\n    storageQuota: {\n      used: stats.totalSize,\n      available: maxSize - stats.totalSize,\n      total: maxSize,\n      usagePercentage: (stats.totalSize / maxSize) * 100,\n    },\n  };\n}\n\n/**\n * 检查存储可用性\n * Check storage availability\n */\nfunction checkStorageAvailability(): {\n  localStorageAvailable: boolean;\n  sessionStorageAvailable: boolean;\n  cookiesAvailable: boolean;\n  indexedDBAvailable: boolean;\n} {\n  const result = {\n    localStorageAvailable: false,\n    sessionStorageAvailable: false,\n    cookiesAvailable: false,\n    indexedDBAvailable: false,\n  };\n  \n  // 检查 localStorage\n  try {\n    const testKey = '__test_localStorage__';\n    localStorage.setItem(testKey, 'test');\n    localStorage.removeItem(testKey);\n    result.localStorageAvailable = true;\n  } catch {\n    // localStorage 不可用\n  }\n  \n  // 检查 sessionStorage\n  try {\n    const testKey = '__test_sessionStorage__';\n    sessionStorage.setItem(testKey, 'test');\n    sessionStorage.removeItem(testKey);\n    result.sessionStorageAvailable = true;\n  } catch {\n    // sessionStorage 不可用\n  }\n  \n  // 检查 Cookies\n  try {\n    document.cookie = '__test_cookie__=test; path=/';\n    result.cookiesAvailable = document.cookie.includes('__test_cookie__');\n    // 清理测试 cookie\n    document.cookie = '__test_cookie__=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/';\n  } catch {\n    // Cookies 不可用\n  }\n  \n  // 检查 IndexedDB\n  try {\n    result.indexedDBAvailable = 'indexedDB' in window && indexedDB !== null;\n  } catch {\n    // IndexedDB 不可用\n  }\n  \n  return result;\n}\n\n/**\n * 生成健康建议\n * Generate health recommendations\n */\nfunction generateHealthRecommendations(healthScore: number, issues: string[]): string[] {\n  const recommendations: string[] = [];\n  \n  if (healthScore < 0.5) {\n    recommendations.push('建议立即检查存储系统配置');\n  }\n  \n  if (issues.includes('localStorage不可用')) {\n    recommendations.push('检查浏览器设置，确保localStorage已启用');\n  }\n  \n  if (issues.includes('Cookies不可用')) {\n    recommendations.push('检查浏览器Cookie设置');\n  }\n  \n  if (issues.includes('数据过期')) {\n    recommendations.push('考虑清理过期数据或更新数据');\n  }\n  \n  if (issues.includes('存储空间使用过多')) {\n    recommendations.push('清理不必要的历史记录');\n  }\n  \n  if (issues.includes('历史记录过多')) {\n    recommendations.push('定期清理旧的检测历史记录');\n  }\n  \n  if (recommendations.length === 0) {\n    recommendations.push('系统运行正常，建议定期监控');\n  }\n  \n  return recommendations;\n}\n\n/**\n * 执行健康检查\n * Perform health check\n */\nexport function performHealthCheck(): StorageOperationResult<StorageHealthCheck> {\n  const startTime = Date.now();\n  \n  try {\n    const healthCheck = calculateHealthCheck();\n    \n    return {\n      success: true,\n      data: healthCheck,\n      source: 'localStorage',\n      timestamp: Date.now(),\n      responseTime: Date.now() - startTime,\n    };\n  } catch (error) {\n    return {\n      success: false,\n      error: error instanceof Error ? error.message : 'Unknown error',\n      source: 'localStorage',\n      timestamp: Date.now(),\n      responseTime: Date.now() - startTime,\n    };\n  }\n}\n\n// ==================== 存储效率计算 ====================\n\n/**\n * 计算存储效率\n * Calculate storage efficiency\n */\nexport function calculateStorageEfficiency(stats: StorageStats): number {\n  // 基于多个因素计算效率分数 (0-1)\n  let efficiency = 1.0;\n  \n  // 数据新鲜度权重 40%\n  efficiency *= (0.6 + 0.4 * stats.freshness);\n  \n  // 存储利用率权重 30%\n  const maxReasonableSize = 1024 * 1024; // 1MB\n  const sizeEfficiency = Math.min(1, maxReasonableSize / Math.max(stats.totalSize, 1));\n  efficiency *= (0.7 + 0.3 * sizeEfficiency);\n  \n  // 历史记录质量权重 30%\n  const maxReasonableEntries = 100;\n  const historyEfficiency = Math.min(1, maxReasonableEntries / Math.max(stats.historyStats.totalEntries, 1));\n  efficiency *= (0.7 + 0.3 * historyEfficiency);\n  \n  return Math.max(0, Math.min(1, efficiency));\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-storage-analytics-events.ts","messages":[{"ruleId":"max-params","severity":2,"message":"Static method 'logAccess' has too many parameters (5). Maximum allowed is 3.","line":130,"column":3,"nodeType":"FunctionExpression","messageId":"exceed","endLine":130,"endColumn":19},{"ruleId":"max-params","severity":2,"message":"Static method 'logError' has too many parameters (4). Maximum allowed is 3.","line":252,"column":3,"nodeType":"FunctionExpression","messageId":"exceed","endLine":252,"endColumn":18},{"ruleId":"prefer-destructuring","severity":2,"message":"Use object destructuring.","line":314,"column":11,"nodeType":"VariableDeclarator","messageId":"preferDestructuring","endLine":314,"endColumn":74,"fix":{"range":[6695,6758],"text":"{totalOperations} = AccessLogger.getAccessStats()"}},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":357,"column":7,"nodeType":"MemberExpression","endLine":357,"endColumn":22},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":365,"column":9,"nodeType":"MemberExpression","endLine":365,"endColumn":24}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"/**\n * 语言存储分析事件和日志管理\n * Locale Storage Analytics Events and Logging\n * \n * 负责事件监听、访问日志和错误日志管理\n */\n\n'use client';\n\nimport type {\n  StorageEvent,\n  StorageEventListener,\n} from './locale-storage-types';\n\n// ==================== 事件管理 ====================\n\n/**\n * 事件监听器管理\n * Event listener management\n */\nexport class EventManager {\n  private static eventListeners: Map<string, StorageEventListener[]> = new Map();\n\n  /**\n   * 添加事件监听器\n   * Add event listener\n   */\n  static addEventListener(eventType: string, listener: StorageEventListener): void {\n    if (!this.eventListeners.has(eventType)) {\n      this.eventListeners.set(eventType, []);\n    }\n    this.eventListeners.get(eventType)!.push(listener);\n  }\n\n  /**\n   * 移除事件监听器\n   * Remove event listener\n   */\n  static removeEventListener(eventType: string, listener: StorageEventListener): void {\n    const listeners = this.eventListeners.get(eventType);\n    if (listeners) {\n      const index = listeners.indexOf(listener);\n      if (index > -1) {\n        listeners.splice(index, 1);\n      }\n    }\n  }\n\n  /**\n   * 移除所有事件监听器\n   * Remove all event listeners\n   */\n  static removeAllListeners(eventType?: string): void {\n    if (eventType) {\n      this.eventListeners.delete(eventType);\n    } else {\n      this.eventListeners.clear();\n    }\n  }\n\n  /**\n   * 触发事件\n   * Emit event\n   */\n  static emitEvent(event: StorageEvent): void {\n    const listeners = this.eventListeners.get(event.type);\n    if (listeners) {\n      listeners.forEach(listener => {\n        try {\n          listener(event);\n        } catch (error) {\n          console.error('Error in storage event listener:', error);\n        }\n      });\n    }\n  }\n\n  /**\n   * 获取事件监听器数量\n   * Get event listener count\n   */\n  static getListenerCount(eventType?: string): number {\n    if (eventType) {\n      return this.eventListeners.get(eventType)?.length || 0;\n    }\n    \n    let total = 0;\n    for (const listeners of this.eventListeners.values()) {\n      total += listeners.length;\n    }\n    return total;\n  }\n\n  /**\n   * 获取所有事件类型\n   * Get all event types\n   */\n  static getEventTypes(): string[] {\n    return Array.from(this.eventListeners.keys());\n  }\n}\n\n// ==================== 访问日志管理 ====================\n\n/**\n * 访问日志条目\n * Access log entry\n */\nexport interface AccessLogEntry {\n  key: string;\n  operation: string;\n  timestamp: number;\n  success: boolean;\n  responseTime?: number;\n  error?: string;\n}\n\n/**\n * 访问日志管理器\n * Access log manager\n */\nexport class AccessLogger {\n  private static accessLog: AccessLogEntry[] = [];\n  private static readonly MAX_LOG_ENTRIES = 1000;\n\n  /**\n   * 记录访问日志\n   * Log access\n   */\n  static logAccess(\n    key: string, \n    operation: string, \n    success: boolean, \n    responseTime?: number,\n    error?: string\n  ): void {\n    const logEntry: AccessLogEntry = {\n      key,\n      operation,\n      timestamp: Date.now(),\n      success,\n      responseTime,\n      error,\n    };\n\n    this.accessLog.unshift(logEntry);\n\n    // 限制日志条目数量\n    if (this.accessLog.length > this.MAX_LOG_ENTRIES) {\n      this.accessLog = this.accessLog.slice(0, this.MAX_LOG_ENTRIES);\n    }\n\n    // 触发访问事件\n    EventManager.emitEvent({\n      type: 'access',\n      timestamp: Date.now(),\n      data: logEntry,\n    });\n  }\n\n  /**\n   * 获取访问日志\n   * Get access log\n   */\n  static getAccessLog(limit?: number): AccessLogEntry[] {\n    return limit ? this.accessLog.slice(0, limit) : [...this.accessLog];\n  }\n\n  /**\n   * 清理访问日志\n   * Clear access log\n   */\n  static clearAccessLog(): void {\n    this.accessLog = [];\n  }\n\n  /**\n   * 获取访问统计\n   * Get access statistics\n   */\n  static getAccessStats(): {\n    totalOperations: number;\n    successRate: number;\n    averageResponseTime: number;\n    operationCounts: Record<string, number>;\n    keyCounts: Record<string, number>;\n    recentErrors: AccessLogEntry[];\n  } {\n    const total = this.accessLog.length;\n    const successful = this.accessLog.filter(entry => entry.success).length;\n    const successRate = total > 0 ? (successful / total) * 100 : 100;\n\n    // 计算平均响应时间\n    const responseTimes = this.accessLog\n      .filter(entry => entry.responseTime !== undefined)\n      .map(entry => entry.responseTime!);\n    const averageResponseTime = responseTimes.length > 0\n      ? responseTimes.reduce((sum, time) => sum + time, 0) / responseTimes.length\n      : 0;\n\n    // 统计操作类型\n    const operationCounts: Record<string, number> = {};\n    const keyCounts: Record<string, number> = {};\n\n    for (const entry of this.accessLog) {\n      operationCounts[entry.operation] = (operationCounts[entry.operation] || 0) + 1;\n      keyCounts[entry.key] = (keyCounts[entry.key] || 0) + 1;\n    }\n\n    // 获取最近的错误\n    const recentErrors = this.accessLog\n      .filter(entry => !entry.success)\n      .slice(0, 10);\n\n    return {\n      totalOperations: total,\n      successRate,\n      averageResponseTime,\n      operationCounts,\n      keyCounts,\n      recentErrors,\n    };\n  }\n}\n\n// ==================== 错误日志管理 ====================\n\n/**\n * 错误日志条目\n * Error log entry\n */\nexport interface ErrorLogEntry {\n  error: string;\n  timestamp: number;\n  context?: string;\n  stack?: string;\n  severity: 'low' | 'medium' | 'high' | 'critical';\n}\n\n/**\n * 错误日志管理器\n * Error log manager\n */\nexport class ErrorLogger {\n  private static errorLog: ErrorLogEntry[] = [];\n  private static readonly MAX_ERROR_ENTRIES = 500;\n\n  /**\n   * 记录错误\n   * Log error\n   */\n  static logError(\n    error: string, \n    context?: string, \n    severity: ErrorLogEntry['severity'] = 'medium',\n    stack?: string\n  ): void {\n    const errorEntry: ErrorLogEntry = {\n      error,\n      timestamp: Date.now(),\n      context,\n      severity,\n      stack,\n    };\n\n    this.errorLog.unshift(errorEntry);\n\n    // 限制错误日志条目数量\n    if (this.errorLog.length > this.MAX_ERROR_ENTRIES) {\n      this.errorLog = this.errorLog.slice(0, this.MAX_ERROR_ENTRIES);\n    }\n\n    // 触发错误事件\n    EventManager.emitEvent({\n      type: 'error',\n      timestamp: Date.now(),\n      data: errorEntry,\n    });\n\n    // 对于严重错误，额外处理\n    if (severity === 'critical') {\n      console.error('Critical storage error:', error, context);\n    }\n  }\n\n  /**\n   * 获取错误日志\n   * Get error log\n   */\n  static getErrorLog(limit?: number): ErrorLogEntry[] {\n    return limit ? this.errorLog.slice(0, limit) : [...this.errorLog];\n  }\n\n  /**\n   * 清理错误日志\n   * Clear error log\n   */\n  static clearErrorLog(): void {\n    this.errorLog = [];\n  }\n\n  /**\n   * 获取错误统计\n   * Get error statistics\n   */\n  static getErrorStats(): {\n    totalErrors: number;\n    errorRate: number;\n    severityDistribution: Record<string, number>;\n    recentErrors: ErrorLogEntry[];\n    errorTrends: Array<{ date: string; count: number }>;\n  } {\n    const total = this.errorLog.length;\n    const totalOperations = AccessLogger.getAccessStats().totalOperations;\n    const errorRate = totalOperations > 0 ? (total / totalOperations) * 100 : 0;\n\n    // 统计严重程度分布\n    const severityDistribution: Record<string, number> = {\n      low: 0,\n      medium: 0,\n      high: 0,\n      critical: 0,\n    };\n\n    for (const entry of this.errorLog) {\n      severityDistribution[entry.severity] += 1;\n    }\n\n    // 获取最近错误\n    const recentErrors = this.errorLog.slice(0, 10);\n\n    // 计算错误趋势（按天）\n    const errorTrends = this.calculateErrorTrends();\n\n    return {\n      totalErrors: total,\n      errorRate,\n      severityDistribution,\n      recentErrors,\n      errorTrends,\n    };\n  }\n\n  /**\n   * 计算错误趋势\n   * Calculate error trends\n   */\n  private static calculateErrorTrends(): Array<{ date: string; count: number }> {\n    const trends: Record<string, number> = {};\n    const now = new Date();\n\n    // 初始化最近7天的数据\n    for (let i = 6; i >= 0; i--) {\n      const date = new Date(now);\n      date.setDate(date.getDate() - i);\n      const dateStr = date.toISOString().split('T')[0];\n      trends[dateStr] = 0;\n    }\n\n    // 统计错误数量\n    for (const entry of this.errorLog) {\n      const date = new Date(entry.timestamp);\n      const dateStr = date.toISOString().split('T')[0];\n      if (Object.prototype.hasOwnProperty.call(trends, dateStr)) {\n        trends[dateStr] += 1;\n      }\n    }\n\n    return Object.entries(trends).map(([date, count]) => ({ date, count }));\n  }\n}\n\n// ==================== 数据清理 ====================\n\n/**\n * 清理分析数据\n * Cleanup analytics data\n */\nexport function cleanupAnalyticsData(maxAge: number = 7 * 24 * 60 * 60 * 1000): void {\n  const cutoffTime = Date.now() - maxAge;\n\n  // 清理访问日志\n  const accessLog = AccessLogger.getAccessLog();\n  const filteredAccessLog = accessLog.filter(entry => entry.timestamp > cutoffTime);\n  AccessLogger.clearAccessLog();\n  filteredAccessLog.forEach(entry => {\n    AccessLogger.logAccess(\n      entry.key,\n      entry.operation,\n      entry.success,\n      entry.responseTime,\n      entry.error\n    );\n  });\n\n  // 清理错误日志\n  const errorLog = ErrorLogger.getErrorLog();\n  const filteredErrorLog = errorLog.filter(entry => entry.timestamp > cutoffTime);\n  ErrorLogger.clearErrorLog();\n  filteredErrorLog.forEach(entry => {\n    ErrorLogger.logError(entry.error, entry.context, entry.severity, entry.stack);\n  });\n\n  // 触发清理事件\n  EventManager.emitEvent({\n    type: 'cleanup',\n    timestamp: Date.now(),\n    data: {\n      maxAge,\n      cutoffTime,\n      accessLogCleaned: accessLog.length - filteredAccessLog.length,\n      errorLogCleaned: errorLog.length - filteredErrorLog.length,\n    },\n  });\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-storage-analytics-performance.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'LocaleDetectionHistory' is defined but never used. Allowed unused vars must match /^_/u.","line":12,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"LocaleDetectionHistory"},"fix":{"range":[148,174],"text":""},"desc":"Remove unused variable 'LocaleDetectionHistory'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'LocaleDetectionHistory' is defined but never used. Allowed unused vars must match /^_/u.","line":12,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":12,"endColumn":25},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":52,"column":5,"nodeType":"MemberExpression","endLine":52,"endColumn":22},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":52,"column":26,"nodeType":"MemberExpression","endLine":52,"endColumn":43},{"ruleId":"radix","severity":2,"message":"Missing radix parameter.","line":56,"column":38,"nodeType":"CallExpression","messageId":"missingRadix","endLine":56,"endColumn":52,"suggestions":[{"messageId":"addRadixParameter10","fix":{"range":[1609,1609],"text":", 10"},"desc":"Add radix parameter `10` for parsing decimal numbers."}]},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":91,"column":25,"nodeType":"MemberExpression","endLine":91,"endColumn":37},{"ruleId":"max-statements","severity":2,"message":"Function 'generateBehaviorInsights' has too many statements (23). Maximum allowed is 20.","line":114,"column":1,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":165,"endColumn":2},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":337,"column":5,"nodeType":"MemberExpression","endLine":337,"endColumn":22},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":345,"column":7,"nodeType":"MemberExpression","endLine":345,"endColumn":24}],"suppressedMessages":[],"errorCount":9,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 语言存储分析性能和趋势分析\n * Locale Storage Analytics Performance and Trends\n * \n * 负责性能指标分析、使用模式识别和趋势分析\n */\n\n'use client';\n\nimport type {\n  StorageStats,\n  LocaleDetectionHistory,\n} from './locale-storage-types';\nimport { AccessLogger, ErrorLogger, type AccessLogEntry } from './locale-storage-analytics-events';\nimport { calculateStorageStats } from './locale-storage-analytics-core';\n\n// ==================== 使用模式分析 ====================\n\n/**\n * 使用模式分析结果\n * Usage pattern analysis result\n */\nexport interface UsagePatterns {\n  mostAccessedKeys: Array<{ key: string; count: number }>;\n  leastAccessedKeys: Array<{ key: string; count: number }>;\n  peakUsageHours: Array<{ hour: number; count: number }>;\n  operationDistribution: Record<string, number>;\n  averageSessionDuration: number;\n  userBehaviorInsights: string[];\n}\n\n/**\n * 获取使用模式\n * Get usage patterns\n */\nexport function getUsagePatterns(): UsagePatterns {\n  const accessLog = AccessLogger.getAccessLog();\n  const accessStats = AccessLogger.getAccessStats();\n  \n  // 分析最常访问的键\n  const keyEntries = Object.entries(accessStats.keyCounts)\n    .map(([key, count]) => ({ key, count }))\n    .sort((a, b) => b.count - a.count);\n  \n  const mostAccessedKeys = keyEntries.slice(0, 5);\n  const leastAccessedKeys = keyEntries.slice(-5).reverse();\n  \n  // 分析峰值使用时间\n  const hourlyUsage: Record<number, number> = {};\n  for (const entry of accessLog) {\n    const hour = new Date(entry.timestamp).getHours();\n    hourlyUsage[hour] = (hourlyUsage[hour] || 0) + 1;\n  }\n  \n  const peakUsageHours = Object.entries(hourlyUsage)\n    .map(([hour, count]) => ({ hour: parseInt(hour), count }))\n    .sort((a, b) => b.count - a.count)\n    .slice(0, 5);\n  \n  // 计算平均会话持续时间\n  const averageSessionDuration = calculateAverageSessionDuration(accessLog);\n  \n  // 生成用户行为洞察\n  const userBehaviorInsights = generateBehaviorInsights(accessStats, peakUsageHours, averageSessionDuration);\n  \n  return {\n    mostAccessedKeys,\n    leastAccessedKeys,\n    peakUsageHours,\n    operationDistribution: accessStats.operationCounts,\n    averageSessionDuration,\n    userBehaviorInsights,\n  };\n}\n\n/**\n * 计算平均会话持续时间\n * Calculate average session duration\n */\nfunction calculateAverageSessionDuration(accessLog: AccessLogEntry[]): number {\n  if (accessLog.length < 2) return 0;\n  \n  const sessions: number[] = [];\n  let sessionStart = accessLog[accessLog.length - 1].timestamp;\n  let lastActivity = sessionStart;\n  \n  // 会话间隔阈值：30分钟\n  const sessionGap = 30 * 60 * 1000;\n  \n  for (let i = accessLog.length - 2; i >= 0; i--) {\n    const currentTime = accessLog[i].timestamp;\n    \n    if (currentTime - lastActivity > sessionGap) {\n      // 新会话开始\n      sessions.push(lastActivity - sessionStart);\n      sessionStart = currentTime;\n    }\n    \n    lastActivity = currentTime;\n  }\n  \n  // 添加最后一个会话\n  sessions.push(lastActivity - sessionStart);\n  \n  return sessions.length > 0 \n    ? sessions.reduce((sum, duration) => sum + duration, 0) / sessions.length\n    : 0;\n}\n\n/**\n * 生成行为洞察\n * Generate behavior insights\n */\nfunction generateBehaviorInsights(\n  accessStats: ReturnType<typeof AccessLogger.getAccessStats>,\n  peakUsageHours: Array<{ hour: number; count: number }>,\n  averageSessionDuration: number\n): string[] {\n  const insights: string[] = [];\n  \n  // 成功率分析\n  if (accessStats.successRate < 95) {\n    insights.push(`存储操作成功率较低 (${accessStats.successRate.toFixed(1)}%)，建议检查存储配置`);\n  } else if (accessStats.successRate > 99) {\n    insights.push('存储操作成功率优秀，系统运行稳定');\n  }\n  \n  // 响应时间分析\n  if (accessStats.averageResponseTime > 100) {\n    insights.push(`平均响应时间较慢 (${accessStats.averageResponseTime.toFixed(1)}ms)，可能需要优化`);\n  } else if (accessStats.averageResponseTime < 10) {\n    insights.push('响应时间优秀，存储性能良好');\n  }\n  \n  // 使用时间模式分析\n  if (peakUsageHours.length > 0) {\n    const peakHour = peakUsageHours[0].hour;\n    if (peakHour >= 9 && peakHour <= 17) {\n      insights.push('主要在工作时间使用，符合办公场景');\n    } else if (peakHour >= 18 && peakHour <= 23) {\n      insights.push('主要在晚间使用，可能为个人用户');\n    }\n  }\n  \n  // 会话持续时间分析\n  const sessionMinutes = averageSessionDuration / (60 * 1000);\n  if (sessionMinutes > 60) {\n    insights.push('用户会话时间较长，表明深度使用');\n  } else if (sessionMinutes < 5) {\n    insights.push('用户会话时间较短，可能为快速访问');\n  }\n  \n  // 操作类型分析\n  const operations = Object.entries(accessStats.operationCounts);\n  const totalOps = operations.reduce((sum, [, count]) => sum + count, 0);\n  \n  for (const [operation, count] of operations) {\n    const percentage = (count / totalOps) * 100;\n    if (percentage > 50) {\n      insights.push(`${operation}操作占主导地位 (${percentage.toFixed(1)}%)`);\n    }\n  }\n  \n  return insights;\n}\n\n// ==================== 性能指标分析 ====================\n\n/**\n * 性能指标\n * Performance metrics\n */\nexport interface PerformanceMetrics {\n  averageResponseTime: number;\n  successRate: number;\n  errorRate: number;\n  throughput: number;\n  efficiency: number;\n  recommendations: string[];\n}\n\n/**\n * 获取性能指标\n * Get performance metrics\n */\nexport function getPerformanceMetrics(): PerformanceMetrics {\n  const accessStats = AccessLogger.getAccessStats();\n  const errorStats = ErrorLogger.getErrorStats();\n  const stats = calculateStorageStats();\n  \n  // 计算吞吐量 (操作数/小时)\n  const oneHourAgo = Date.now() - 60 * 60 * 1000;\n  const recentOperations = AccessLogger.getAccessLog()\n    .filter(entry => entry.timestamp > oneHourAgo).length;\n  const throughput = recentOperations; // 每小时操作数\n  \n  // 计算效率分数\n  const efficiency = calculateEfficiencyScore(accessStats, errorStats, stats);\n  \n  // 生成性能建议\n  const recommendations = generatePerformanceRecommendations({\n    errorRate: errorStats.errorRate,\n    responseTime: accessStats.averageResponseTime,\n    successRate: accessStats.successRate,\n    efficiency,\n  });\n  \n  return {\n    averageResponseTime: accessStats.averageResponseTime,\n    successRate: accessStats.successRate,\n    errorRate: errorStats.errorRate,\n    throughput,\n    efficiency,\n    recommendations,\n  };\n}\n\n/**\n * 计算效率分数\n * Calculate efficiency score\n */\nfunction calculateEfficiencyScore(\n  accessStats: ReturnType<typeof AccessLogger.getAccessStats>,\n  errorStats: ReturnType<typeof ErrorLogger.getErrorStats>,\n  storageStats: StorageStats\n): number {\n  let score = 1.0;\n  \n  // 成功率权重 30%\n  score *= 0.7 + 0.3 * (accessStats.successRate / 100);\n  \n  // 响应时间权重 25%\n  const responseTimeScore = Math.max(0, 1 - (accessStats.averageResponseTime / 1000));\n  score *= 0.75 + 0.25 * responseTimeScore;\n  \n  // 错误率权重 25%\n  const errorRateScore = Math.max(0, 1 - (errorStats.errorRate / 100));\n  score *= 0.75 + 0.25 * errorRateScore;\n  \n  // 数据新鲜度权重 20%\n  score *= 0.8 + 0.2 * storageStats.freshness;\n  \n  return Math.max(0, Math.min(1, score));\n}\n\n/**\n * 生成性能建议\n * Generate performance recommendations\n */\nfunction generatePerformanceRecommendations(metrics: {\n  errorRate: number;\n  responseTime: number;\n  successRate: number;\n  efficiency: number;\n}): string[] {\n  const recommendations: string[] = [];\n  \n  if (metrics.errorRate > 5) {\n    recommendations.push('错误率过高，建议检查存储操作逻辑');\n  }\n  \n  if (metrics.responseTime > 100) {\n    recommendations.push('响应时间较慢，考虑优化存储访问方式');\n  }\n  \n  if (metrics.successRate < 95) {\n    recommendations.push('成功率偏低，建议增加错误处理和重试机制');\n  }\n  \n  if (metrics.efficiency < 0.7) {\n    recommendations.push('整体效率偏低，建议全面优化存储策略');\n  }\n  \n  if (recommendations.length === 0) {\n    recommendations.push('性能表现良好，建议继续监控');\n  }\n  \n  return recommendations;\n}\n\n// ==================== 趋势分析 ====================\n\n/**\n * 使用趋势\n * Usage trends\n */\nexport interface UsageTrends {\n  dailyOperations: Array<{ date: string; operations: number }>;\n  weeklyGrowth: number;\n  monthlyGrowth: number;\n  seasonalPatterns: Array<{ period: string; avgOperations: number }>;\n  predictions: Array<{ date: string; predictedOperations: number }>;\n}\n\n/**\n * 获取使用趋势\n * Get usage trends\n */\nexport function getUsageTrends(days: number = 7): UsageTrends {\n  const accessLog = AccessLogger.getAccessLog();\n  \n  // 计算每日操作数\n  const dailyOperations = calculateDailyOperations(accessLog, days);\n  \n  // 计算增长率\n  const weeklyGrowth = calculateGrowthRate(dailyOperations, 7);\n  const monthlyGrowth = calculateGrowthRate(dailyOperations, 30);\n  \n  // 分析季节性模式\n  const seasonalPatterns = analyzeSeasonalPatterns(accessLog);\n  \n  // 生成预测\n  const predictions = generatePredictions(dailyOperations, 3);\n  \n  return {\n    dailyOperations,\n    weeklyGrowth,\n    monthlyGrowth,\n    seasonalPatterns,\n    predictions,\n  };\n}\n\n/**\n * 计算每日操作数\n * Calculate daily operations\n */\nfunction calculateDailyOperations(accessLog: AccessLogEntry[], days: number): Array<{ date: string; operations: number }> {\n  const dailyOps: Record<string, number> = {};\n  const now = new Date();\n  \n  // 初始化日期\n  for (let i = days - 1; i >= 0; i--) {\n    const date = new Date(now);\n    date.setDate(date.getDate() - i);\n    const dateStr = date.toISOString().split('T')[0];\n    dailyOps[dateStr] = 0;\n  }\n  \n  // 统计操作数\n  for (const entry of accessLog) {\n    const date = new Date(entry.timestamp);\n    const dateStr = date.toISOString().split('T')[0];\n    if (Object.prototype.hasOwnProperty.call(dailyOps, dateStr)) {\n      dailyOps[dateStr] += 1;\n    }\n  }\n  \n  return Object.entries(dailyOps).map(([date, operations]) => ({ date, operations }));\n}\n\n/**\n * 计算增长率\n * Calculate growth rate\n */\nfunction calculateGrowthRate(dailyOperations: Array<{ date: string; operations: number }>, period: number): number {\n  if (dailyOperations.length < period) return 0;\n  \n  const recent = dailyOperations.slice(-period);\n  const previous = dailyOperations.slice(-period * 2, -period);\n  \n  if (previous.length === 0) return 0;\n  \n  const recentAvg = recent.reduce((sum, day) => sum + day.operations, 0) / recent.length;\n  const previousAvg = previous.reduce((sum, day) => sum + day.operations, 0) / previous.length;\n  \n  return previousAvg > 0 ? ((recentAvg - previousAvg) / previousAvg) * 100 : 0;\n}\n\n/**\n * 分析季节性模式\n * Analyze seasonal patterns\n */\nfunction analyzeSeasonalPatterns(accessLog: AccessLogEntry[]): Array<{ period: string; avgOperations: number }> {\n  const patterns: Record<string, number[]> = {\n    '工作日': [],\n    '周末': [],\n    '上午': [],\n    '下午': [],\n    '晚上': [],\n  };\n  \n  for (const entry of accessLog) {\n    const date = new Date(entry.timestamp);\n    const dayOfWeek = date.getDay();\n    const hour = date.getHours();\n    \n    // 工作日 vs 周末\n    if (dayOfWeek >= 1 && dayOfWeek <= 5) {\n      patterns['工作日'].push(1);\n    } else {\n      patterns['周末'].push(1);\n    }\n    \n    // 时间段\n    if (hour >= 6 && hour < 12) {\n      patterns['上午'].push(1);\n    } else if (hour >= 12 && hour < 18) {\n      patterns['下午'].push(1);\n    } else {\n      patterns['晚上'].push(1);\n    }\n  }\n  \n  return Object.entries(patterns).map(([period, operations]) => ({\n    period,\n    avgOperations: operations.length,\n  }));\n}\n\n/**\n * 生成预测\n * Generate predictions\n */\nfunction generatePredictions(\n  dailyOperations: Array<{ date: string; operations: number }>,\n  futureDays: number\n): Array<{ date: string; predictedOperations: number }> {\n  if (dailyOperations.length < 3) {\n    return [];\n  }\n  \n  // 简单线性趋势预测\n  const recent = dailyOperations.slice(-7); // 使用最近7天数据\n  const avgOperations = recent.reduce((sum, day) => sum + day.operations, 0) / recent.length;\n  \n  // 计算趋势斜率\n  const trend = recent.length > 1 \n    ? (recent[recent.length - 1].operations - recent[0].operations) / (recent.length - 1)\n    : 0;\n  \n  const predictions: Array<{ date: string; predictedOperations: number }> = [];\n  \n  for (let i = 1; i <= futureDays; i++) {\n    const futureDate = new Date();\n    futureDate.setDate(futureDate.getDate() + i);\n    const dateStr = futureDate.toISOString().split('T')[0];\n    \n    const predictedOperations = Math.max(0, Math.round(avgOperations + trend * i));\n    \n    predictions.push({\n      date: dateStr,\n      predictedOperations,\n    });\n  }\n  \n  return predictions;\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-storage-analytics-utils.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'key' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":101,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":101,"endColumn":20,"suggestions":[{"messageId":"removeVar","data":{"varName":"key"},"fix":{"range":[2132,2135],"text":""},"desc":"Remove unused variable 'key'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'key' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":101,"column":17,"nodeType":null,"messageId":"unusedVar","endLine":101,"endColumn":20},{"ruleId":"max-statements","severity":2,"message":"Function 'validateAnalyticsData' has too many statements (28). Maximum allowed is 20.","line":224,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":283,"endColumn":2},{"ruleId":"max-statements","severity":2,"message":"Function 'optimizeAnalyticsStorage' has too many statements (24). Maximum allowed is 20.","line":318,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":396,"endColumn":2},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":414,"column":32,"nodeType":"MemberExpression","endLine":414,"endColumn":48}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 语言存储分析工具函数和缓存管理\n * Locale Storage Analytics Utilities and Cache Management\n * \n * 负责缓存管理、数据导出和通用工具函数\n */\n\n'use client';\n\nimport type {\n  StorageStats,\n  StorageHealthCheck,\n} from './locale-storage-types';\nimport { AccessLogger, ErrorLogger } from './locale-storage-analytics-events';\nimport { getStorageStats, performHealthCheck } from './locale-storage-analytics-core';\nimport { getUsagePatterns, getPerformanceMetrics, getUsageTrends } from './locale-storage-analytics-performance';\n\n// ==================== 缓存管理 ====================\n\n/**\n * 缓存条目\n * Cache entry\n */\ninterface CacheEntry {\n  data: unknown;\n  timestamp: number;\n}\n\n/**\n * 缓存管理器\n * Cache manager\n */\nexport class CacheManager {\n  private static metricsCache: Map<string, CacheEntry> = new Map();\n  private static readonly CACHE_TTL = 5 * 60 * 1000; // 5 minutes\n\n  /**\n   * 获取缓存的指标\n   * Get cached metrics\n   */\n  static getCachedMetrics(key: string): unknown | null {\n    const cached = this.metricsCache.get(key);\n    if (cached && Date.now() - cached.timestamp < this.CACHE_TTL) {\n      return cached.data;\n    }\n    return null;\n  }\n\n  /**\n   * 设置缓存的指标\n   * Set cached metrics\n   */\n  static setCachedMetrics(key: string, data: unknown): void {\n    this.metricsCache.set(key, {\n      data,\n      timestamp: Date.now(),\n    });\n  }\n\n  /**\n   * 使缓存失效\n   * Invalidate cache\n   */\n  static invalidateCache(key?: string): void {\n    if (key) {\n      this.metricsCache.delete(key);\n    } else {\n      this.metricsCache.clear();\n    }\n  }\n\n  /**\n   * 清理过期缓存\n   * Clean expired cache\n   */\n  static cleanExpiredCache(): void {\n    const now = Date.now();\n    for (const [key, entry] of this.metricsCache.entries()) {\n      if (now - entry.timestamp >= this.CACHE_TTL) {\n        this.metricsCache.delete(key);\n      }\n    }\n  }\n\n  /**\n   * 获取缓存统计\n   * Get cache statistics\n   */\n  static getCacheStats(): {\n    totalEntries: number;\n    validEntries: number;\n    expiredEntries: number;\n    hitRate: number;\n    memoryUsage: number;\n  } {\n    const now = Date.now();\n    let validEntries = 0;\n    let expiredEntries = 0;\n    let memoryUsage = 0;\n\n    for (const [key, entry] of this.metricsCache.entries()) {\n      if (now - entry.timestamp < this.CACHE_TTL) {\n        validEntries += 1;\n      } else {\n        expiredEntries += 1;\n      }\n      \n      // 估算内存使用量\n      memoryUsage += JSON.stringify(entry).length * 2; // 粗略估算\n    }\n\n    // 简单的命中率计算（基于有效条目比例）\n    const totalEntries = validEntries + expiredEntries;\n    const hitRate = totalEntries > 0 ? (validEntries / totalEntries) * 100 : 0;\n\n    return {\n      totalEntries,\n      validEntries,\n      expiredEntries,\n      hitRate,\n      memoryUsage,\n    };\n  }\n}\n\n// ==================== 数据导出 ====================\n\n/**\n * 导出数据格式\n * Export data format\n */\nexport interface ExportData {\n  stats: StorageStats;\n  healthCheck: StorageHealthCheck;\n  usagePatterns: ReturnType<typeof getUsagePatterns>;\n  performanceMetrics: ReturnType<typeof getPerformanceMetrics>;\n  usageTrends: ReturnType<typeof getUsageTrends>;\n  accessLog: ReturnType<typeof AccessLogger.getAccessLog>;\n  errorLog: ReturnType<typeof ErrorLogger.getErrorLog>;\n  exportTimestamp: number;\n  exportVersion: string;\n}\n\n/**\n * 导出分析数据\n * Export analytics data\n */\nexport function exportAnalyticsData(): ExportData {\n  return {\n    stats: getStorageStats().data!,\n    healthCheck: performHealthCheck().data!,\n    usagePatterns: getUsagePatterns(),\n    performanceMetrics: getPerformanceMetrics(),\n    usageTrends: getUsageTrends(),\n    accessLog: AccessLogger.getAccessLog(100), // 限制为最近100条\n    errorLog: ErrorLogger.getErrorLog(50), // 限制为最近50条\n    exportTimestamp: Date.now(),\n    exportVersion: '1.0.0',\n  };\n}\n\n/**\n * 导出为JSON字符串\n * Export as JSON string\n */\nexport function exportAnalyticsDataAsJson(): string {\n  const data = exportAnalyticsData();\n  return JSON.stringify(data, null, 2);\n}\n\n/**\n * 导出为CSV格式\n * Export as CSV format\n */\nexport function exportAnalyticsDataAsCsv(): string {\n  const data = exportAnalyticsData();\n  const lines: string[] = [];\n\n  // 访问日志CSV\n  lines.push('=== Access Log ===');\n  lines.push('Timestamp,Key,Operation,Success,Response Time,Error');\n  \n  for (const entry of data.accessLog) {\n    lines.push([\n      new Date(entry.timestamp).toISOString(),\n      entry.key,\n      entry.operation,\n      entry.success.toString(),\n      entry.responseTime?.toString() || '',\n      entry.error || '',\n    ].join(','));\n  }\n\n  lines.push('');\n  lines.push('=== Error Log ===');\n  lines.push('Timestamp,Error,Context,Severity');\n  \n  for (const entry of data.errorLog) {\n    lines.push([\n      new Date(entry.timestamp).toISOString(),\n      entry.error,\n      entry.context || '',\n      entry.severity,\n    ].join(','));\n  }\n\n  lines.push('');\n  lines.push('=== Usage Trends ===');\n  lines.push('Date,Operations');\n  \n  for (const entry of data.usageTrends.dailyOperations) {\n    lines.push([entry.date, entry.operations.toString()].join(','));\n  }\n\n  return lines.join('\\n');\n}\n\n// ==================== 数据验证 ====================\n\n/**\n * 验证分析数据完整性\n * Validate analytics data integrity\n */\nexport function validateAnalyticsData(): {\n  isValid: boolean;\n  issues: string[];\n  recommendations: string[];\n} {\n  const issues: string[] = [];\n  const recommendations: string[] = [];\n\n  try {\n    // 检查基础数据\n    const stats = getStorageStats();\n    if (!stats.success) {\n      issues.push('无法获取存储统计信息');\n    }\n\n    const healthCheck = performHealthCheck();\n    if (!healthCheck.success) {\n      issues.push('无法执行健康检查');\n    }\n\n    // 检查日志数据\n    const accessLog = AccessLogger.getAccessLog();\n    const errorLog = ErrorLogger.getErrorLog();\n\n    if (accessLog.length === 0) {\n      issues.push('访问日志为空');\n      recommendations.push('开始记录存储操作以收集分析数据');\n    }\n\n    if (errorLog.length > accessLog.length * 0.1) {\n      issues.push('错误率过高');\n      recommendations.push('检查存储操作逻辑，减少错误发生');\n    }\n\n    // 检查数据时效性\n    const now = Date.now();\n    const oneHourAgo = now - 60 * 60 * 1000;\n    const recentAccess = accessLog.filter(entry => entry.timestamp > oneHourAgo);\n\n    if (recentAccess.length === 0 && accessLog.length > 0) {\n      issues.push('最近一小时无活动记录');\n      recommendations.push('检查应用是否正常运行');\n    }\n\n    // 检查缓存状态\n    const cacheStats = CacheManager.getCacheStats();\n    if (cacheStats.expiredEntries > cacheStats.validEntries) {\n      recommendations.push('清理过期缓存以提高性能');\n    }\n\n  } catch (error) {\n    issues.push(`数据验证过程中发生错误: ${error instanceof Error ? error.message : '未知错误'}`);\n  }\n\n  return {\n    isValid: issues.length === 0,\n    issues,\n    recommendations,\n  };\n}\n\n// ==================== 数据压缩和优化 ====================\n\n/**\n * 压缩分析数据\n * Compress analytics data\n */\nexport function compressAnalyticsData(): {\n  originalSize: number;\n  compressedSize: number;\n  compressionRatio: number;\n  compressedData: string;\n} {\n  const originalData = exportAnalyticsDataAsJson();\n  const originalSize = originalData.length;\n\n  // 简单的数据压缩：移除不必要的空白和重复信息\n  const compressedData = JSON.stringify(exportAnalyticsData());\n  const compressedSize = compressedData.length;\n\n  const compressionRatio = originalSize > 0 ? (1 - compressedSize / originalSize) * 100 : 0;\n\n  return {\n    originalSize,\n    compressedSize,\n    compressionRatio,\n    compressedData,\n  };\n}\n\n/**\n * 优化分析数据存储\n * Optimize analytics data storage\n */\nexport function optimizeAnalyticsStorage(): {\n  beforeOptimization: {\n    accessLogSize: number;\n    errorLogSize: number;\n    cacheSize: number;\n  };\n  afterOptimization: {\n    accessLogSize: number;\n    errorLogSize: number;\n    cacheSize: number;\n  };\n  optimizationResults: string[];\n} {\n  const results: string[] = [];\n\n  // 记录优化前的状态\n  const beforeAccessLog = AccessLogger.getAccessLog();\n  const beforeErrorLog = ErrorLogger.getErrorLog();\n  const beforeCacheStats = CacheManager.getCacheStats();\n\n  const before = {\n    accessLogSize: beforeAccessLog.length,\n    errorLogSize: beforeErrorLog.length,\n    cacheSize: beforeCacheStats.totalEntries,\n  };\n\n  // 执行优化\n  \n  // 1. 清理过期缓存\n  CacheManager.cleanExpiredCache();\n  results.push('清理了过期缓存');\n\n  // 2. 压缩访问日志（保留最近1000条）\n  if (beforeAccessLog.length > 1000) {\n    const recentAccessLog = beforeAccessLog.slice(0, 1000);\n    AccessLogger.clearAccessLog();\n    recentAccessLog.forEach(entry => {\n      AccessLogger.logAccess(\n        entry.key,\n        entry.operation,\n        entry.success,\n        entry.responseTime,\n        entry.error\n      );\n    });\n    results.push(`压缩访问日志：${beforeAccessLog.length} -> 1000 条`);\n  }\n\n  // 3. 压缩错误日志（保留最近500条）\n  if (beforeErrorLog.length > 500) {\n    const recentErrorLog = beforeErrorLog.slice(0, 500);\n    ErrorLogger.clearErrorLog();\n    recentErrorLog.forEach(entry => {\n      ErrorLogger.logError(entry.error, entry.context, entry.severity, entry.stack);\n    });\n    results.push(`压缩错误日志：${beforeErrorLog.length} -> 500 条`);\n  }\n\n  // 记录优化后的状态\n  const afterAccessLog = AccessLogger.getAccessLog();\n  const afterErrorLog = ErrorLogger.getErrorLog();\n  const afterCacheStats = CacheManager.getCacheStats();\n\n  const after = {\n    accessLogSize: afterAccessLog.length,\n    errorLogSize: afterErrorLog.length,\n    cacheSize: afterCacheStats.totalEntries,\n  };\n\n  if (results.length === 0) {\n    results.push('无需优化，数据已处于最佳状态');\n  }\n\n  return {\n    beforeOptimization: before,\n    afterOptimization: after,\n    optimizationResults: results,\n  };\n}\n\n// ==================== 工具函数 ====================\n\n/**\n * 格式化字节大小\n * Format byte size\n */\nexport function formatByteSize(bytes: number): string {\n  const units = ['B', 'KB', 'MB', 'GB'];\n  let size = bytes;\n  let unitIndex = 0;\n\n  while (size >= 1024 && unitIndex < units.length - 1) {\n    size /= 1024;\n    unitIndex += 1;\n  }\n\n  return `${size.toFixed(2)} ${units[unitIndex]}`;\n}\n\n/**\n * 格式化持续时间\n * Format duration\n */\nexport function formatDuration(milliseconds: number): string {\n  const seconds = Math.floor(milliseconds / 1000);\n  const minutes = Math.floor(seconds / 60);\n  const hours = Math.floor(minutes / 60);\n  const days = Math.floor(hours / 24);\n\n  if (days > 0) {\n    return `${days}天 ${hours % 24}小时`;\n  }\n  if (hours > 0) {\n    return `${hours}小时 ${minutes % 60}分钟`;\n  }\n  if (minutes > 0) {\n    return `${minutes}分钟 ${seconds % 60}秒`;\n  }\n  return `${seconds}秒`;\n}\n\n/**\n * 格式化百分比\n * Format percentage\n */\nexport function formatPercentage(value: number, decimals: number = 1): string {\n  return `${value.toFixed(decimals)}%`;\n}\n\n/**\n * 生成唯一ID\n * Generate unique ID\n */\nexport function generateUniqueId(): string {\n  return `analytics_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-storage-analytics.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'getStorageStats' is defined but never used. Allowed unused vars must match /^_/u.","line":18,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":18,"suggestions":[{"messageId":"removeVar","data":{"varName":"getStorageStats"},"fix":{"range":[368,384],"text":""},"desc":"Remove unused variable 'getStorageStats'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'getStorageStats' is defined but never used. Allowed unused vars must match /^_/u.","line":18,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":18,"endColumn":18},{"ruleId":"no-unused-vars","severity":2,"message":"'calculateHealthCheck' is defined but never used. Allowed unused vars must match /^_/u.","line":21,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":23,"suggestions":[{"messageId":"removeVar","data":{"varName":"calculateHealthCheck"},"fix":{"range":[430,454],"text":""},"desc":"Remove unused variable 'calculateHealthCheck'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'calculateHealthCheck' is defined but never used. Allowed unused vars must match /^_/u.","line":21,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":21,"endColumn":23},{"ruleId":"no-unused-vars","severity":2,"message":"'calculateStorageEfficiency' is defined but never used. Allowed unused vars must match /^_/u.","line":22,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":29,"suggestions":[{"messageId":"removeVar","data":{"varName":"calculateStorageEfficiency"},"fix":{"range":[454,484],"text":""},"desc":"Remove unused variable 'calculateStorageEfficiency'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'calculateStorageEfficiency' is defined but never used. Allowed unused vars must match /^_/u.","line":22,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":22,"endColumn":29},{"ruleId":"no-unused-vars","severity":2,"message":"'exportAnalyticsDataAsJson' is defined but never used. Allowed unused vars must match /^_/u.","line":44,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":44,"endColumn":28,"suggestions":[{"messageId":"removeVar","data":{"varName":"exportAnalyticsDataAsJson"},"fix":{"range":[891,920],"text":""},"desc":"Remove unused variable 'exportAnalyticsDataAsJson'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'exportAnalyticsDataAsJson' is defined but never used. Allowed unused vars must match /^_/u.","line":44,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":44,"endColumn":28},{"ruleId":"no-unused-vars","severity":2,"message":"'exportAnalyticsDataAsCsv' is defined but never used. Allowed unused vars must match /^_/u.","line":45,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":45,"endColumn":27,"suggestions":[{"messageId":"removeVar","data":{"varName":"exportAnalyticsDataAsCsv"},"fix":{"range":[920,948],"text":""},"desc":"Remove unused variable 'exportAnalyticsDataAsCsv'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'exportAnalyticsDataAsCsv' is defined but never used. Allowed unused vars must match /^_/u.","line":45,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":45,"endColumn":27},{"ruleId":"no-unused-vars","severity":2,"message":"'validateAnalyticsData' is defined but never used. Allowed unused vars must match /^_/u.","line":46,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":46,"endColumn":24,"suggestions":[{"messageId":"removeVar","data":{"varName":"validateAnalyticsData"},"fix":{"range":[948,973],"text":""},"desc":"Remove unused variable 'validateAnalyticsData'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'validateAnalyticsData' is defined but never used. Allowed unused vars must match /^_/u.","line":46,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":46,"endColumn":24},{"ruleId":"no-unused-vars","severity":2,"message":"'compressAnalyticsData' is defined but never used. Allowed unused vars must match /^_/u.","line":47,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":47,"endColumn":24,"suggestions":[{"messageId":"removeVar","data":{"varName":"compressAnalyticsData"},"fix":{"range":[973,998],"text":""},"desc":"Remove unused variable 'compressAnalyticsData'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'compressAnalyticsData' is defined but never used. Allowed unused vars must match /^_/u.","line":47,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":47,"endColumn":24},{"ruleId":"no-unused-vars","severity":2,"message":"'optimizeAnalyticsStorage' is defined but never used. Allowed unused vars must match /^_/u.","line":48,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":48,"endColumn":27,"suggestions":[{"messageId":"removeVar","data":{"varName":"optimizeAnalyticsStorage"},"fix":{"range":[998,1026],"text":""},"desc":"Remove unused variable 'optimizeAnalyticsStorage'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'optimizeAnalyticsStorage' is defined but never used. Allowed unused vars must match /^_/u.","line":48,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":48,"endColumn":27},{"ruleId":"no-unused-vars","severity":2,"message":"'formatByteSize' is defined but never used. Allowed unused vars must match /^_/u.","line":49,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":49,"endColumn":17,"suggestions":[{"messageId":"removeVar","data":{"varName":"formatByteSize"},"fix":{"range":[1026,1044],"text":""},"desc":"Remove unused variable 'formatByteSize'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'formatByteSize' is defined but never used. Allowed unused vars must match /^_/u.","line":49,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":49,"endColumn":17},{"ruleId":"no-unused-vars","severity":2,"message":"'formatDuration' is defined but never used. Allowed unused vars must match /^_/u.","line":50,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":50,"endColumn":17,"suggestions":[{"messageId":"removeVar","data":{"varName":"formatDuration"},"fix":{"range":[1044,1062],"text":""},"desc":"Remove unused variable 'formatDuration'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'formatDuration' is defined but never used. Allowed unused vars must match /^_/u.","line":50,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":50,"endColumn":17},{"ruleId":"no-unused-vars","severity":2,"message":"'formatPercentage' is defined but never used. Allowed unused vars must match /^_/u.","line":51,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":51,"endColumn":19,"suggestions":[{"messageId":"removeVar","data":{"varName":"formatPercentage"},"fix":{"range":[1062,1082],"text":""},"desc":"Remove unused variable 'formatPercentage'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'formatPercentage' is defined but never used. Allowed unused vars must match /^_/u.","line":51,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":51,"endColumn":19},{"ruleId":"no-unused-vars","severity":2,"message":"'generateUniqueId' is defined but never used. Allowed unused vars must match /^_/u.","line":52,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":52,"endColumn":19,"suggestions":[{"messageId":"removeVar","data":{"varName":"generateUniqueId"},"fix":{"range":[1082,1102],"text":""},"desc":"Remove unused variable 'generateUniqueId'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'generateUniqueId' is defined but never used. Allowed unused vars must match /^_/u.","line":52,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":52,"endColumn":19},{"ruleId":"no-unused-vars","severity":2,"message":"'StorageEvent' is defined but never used. Allowed unused vars must match /^_/u.","line":60,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":60,"endColumn":15,"suggestions":[{"messageId":"removeVar","data":{"varName":"StorageEvent"},"fix":{"range":[1243,1259],"text":""},"desc":"Remove unused variable 'StorageEvent'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'StorageEvent' is defined but never used. Allowed unused vars must match /^_/u.","line":60,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":60,"endColumn":15}],"suppressedMessages":[],"errorCount":26,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 语言存储分析和统计 - 主入口\n * Locale Storage Analytics - Main Entry Point\n *\n * 统一的语言存储分析入口，整合所有分析功能模块\n */\n\n'use client';\n\n// 重新导出所有模块的功能\nexport * from './locale-storage-analytics-core';\nexport * from './locale-storage-analytics-events';\nexport * from './locale-storage-analytics-performance';\nexport * from './locale-storage-analytics-utils';\n\n// 导入主要功能用于向后兼容\nimport {\n  getStorageStats,\n  performHealthCheck,\n  calculateStorageStats,\n  calculateHealthCheck,\n  calculateStorageEfficiency,\n} from './locale-storage-analytics-core';\n\nimport {\n  EventManager,\n  AccessLogger,\n  ErrorLogger,\n  cleanupAnalyticsData,\n} from './locale-storage-analytics-events';\n\nimport {\n  getUsagePatterns,\n  getPerformanceMetrics,\n  getUsageTrends,\n  type UsagePatterns,\n  type PerformanceMetrics,\n  type UsageTrends,\n} from './locale-storage-analytics-performance';\n\nimport {\n  CacheManager,\n  exportAnalyticsData,\n  exportAnalyticsDataAsJson,\n  exportAnalyticsDataAsCsv,\n  validateAnalyticsData,\n  compressAnalyticsData,\n  optimizeAnalyticsStorage,\n  formatByteSize,\n  formatDuration,\n  formatPercentage,\n  generateUniqueId,\n  type ExportData,\n} from './locale-storage-analytics-utils';\n\nimport type {\n  StorageStats,\n  StorageHealthCheck,\n  StorageOperationResult,\n  StorageEvent,\n  StorageEventListener,\n} from './locale-storage-types';\n\n/**\n * 存储分析管理器 - 向后兼容类\n * Storage analytics manager - Backward compatible class\n */\nexport class LocaleStorageAnalytics {\n  /**\n   * 获取存储统计信息\n   * Get storage statistics\n   */\n  static getStorageStats(): StorageOperationResult<StorageStats> {\n    const startTime = Date.now();\n\n    try {\n      // 检查缓存\n      const cached = CacheManager.getCachedMetrics('storage_stats');\n      if (cached) {\n        return {\n          success: true,\n          data: cached as StorageStats,\n          source: 'memory',\n          timestamp: Date.now(),\n          responseTime: Date.now() - startTime,\n        };\n      }\n\n      const stats = calculateStorageStats();\n\n      // 缓存结果\n      CacheManager.setCachedMetrics('storage_stats', stats);\n\n      // 记录访问\n      AccessLogger.logAccess('storage_stats', 'read', true, Date.now() - startTime);\n\n      return {\n        success: true,\n        data: stats,\n        source: 'localStorage',\n        timestamp: Date.now(),\n        responseTime: Date.now() - startTime,\n      };\n    } catch (error) {\n      const errorMessage = error instanceof Error ? error.message : 'Unknown error';\n      ErrorLogger.logError(errorMessage, 'getStorageStats');\n      AccessLogger.logAccess('storage_stats', 'read', false, Date.now() - startTime, errorMessage);\n\n      return {\n        success: false,\n        error: errorMessage,\n        source: 'localStorage',\n        timestamp: Date.now(),\n        responseTime: Date.now() - startTime,\n      };\n    }\n  }\n\n  /**\n   * 执行存储健康检查\n   * Perform storage health check\n   */\n  static performHealthCheck(): StorageOperationResult<StorageHealthCheck> {\n    return performHealthCheck();\n  }\n\n  /**\n   * 记录访问日志\n   * Log access\n   */\n  static logAccess(key: string, operation: string, success: boolean): void {\n    AccessLogger.logAccess(key, operation, success);\n  }\n\n  /**\n   * 记录错误日志\n   * Log error\n   */\n  static logError(error: string, context?: string): void {\n    ErrorLogger.logError(error, context);\n  }\n\n  /**\n   * 获取使用模式\n   * Get usage patterns\n   */\n  static getUsagePatterns(): UsagePatterns {\n    return getUsagePatterns();\n  }\n\n  /**\n   * 获取性能指标\n   * Get performance metrics\n   */\n  static getPerformanceMetrics(): PerformanceMetrics {\n    return getPerformanceMetrics();\n  }\n\n  /**\n   * 获取使用趋势\n   * Get usage trends\n   */\n  static getUsageTrends(days: number = 7): UsageTrends {\n    return getUsageTrends(days);\n  }\n\n  /**\n   * 清理分析数据\n   * Cleanup analytics data\n   */\n  static cleanupAnalyticsData(maxAge: number = 7 * 24 * 60 * 60 * 1000): void {\n    cleanupAnalyticsData(maxAge);\n  }\n\n  /**\n   * 导出分析数据\n   * Export analytics data\n   */\n  static exportAnalyticsData(): ExportData {\n    return exportAnalyticsData();\n  }\n\n  /**\n   * 添加事件监听器\n   * Add event listener\n   */\n  static addEventListener(eventType: string, listener: StorageEventListener): void {\n    EventManager.addEventListener(eventType, listener);\n  }\n\n  /**\n   * 移除事件监听器\n   * Remove event listener\n   */\n  static removeEventListener(eventType: string, listener: StorageEventListener): void {\n    EventManager.removeEventListener(eventType, listener);\n  }\n\n  /**\n   * 移除所有事件监听器\n   * Remove all event listeners\n   */\n  static removeAllListeners(): void {\n    EventManager.removeAllListeners();\n  }\n}\n\n// ==================== 向后兼容的类型别名 ====================\n\n/**\n * 向后兼容的类型别名\n * Backward compatible type aliases\n */\nexport type {\n  LocaleStorageAnalytics as Analytics,\n  UsagePatterns,\n  PerformanceMetrics,\n  UsageTrends,\n  ExportData,\n};\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-storage-cookie.ts","messages":[{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":107,"column":9,"nodeType":"MemberExpression","endLine":107,"endColumn":22},{"ruleId":"max-params","severity":2,"message":"Static method 'setWithExpiry' has too many parameters (4). Maximum allowed is 3.","line":136,"column":3,"nodeType":"FunctionExpression","messageId":"exceed","endLine":136,"endColumn":23},{"ruleId":"no-unused-vars","severity":2,"message":"'name' is defined but never used. Allowed unused args must match /^_/u.","line":170,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":170,"endColumn":32,"suggestions":[{"messageId":"removeVar","data":{"varName":"name"},"fix":{"range":[4263,4275],"text":""},"desc":"Remove unused variable 'name'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'name' is defined but never used. Allowed unused args must match /^_/u.","line":170,"column":20,"nodeType":null,"messageId":"unusedVar","endLine":170,"endColumn":24}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { CACHE_DURATIONS } from '@/constants/i18n-constants';\n\n/**\n * Cookie 配置常量\n * Cookie configuration constants\n */\nexport const COOKIE_CONFIG = {\n  maxAge: CACHE_DURATIONS.COOKIE_MAX_AGE / 1000, // 转换为秒\n  sameSite: 'lax' as const,\n  secure:\n    typeof window !== 'undefined' && window.location.protocol === 'https:',\n  path: '/',\n} as const;\n\n/**\n * Cookie 操作工具类\n * Cookie management utility class\n */\nexport class CookieManager {\n  /**\n   * 设置 Cookie\n   * Set cookie with options\n   */\n  static set(name: string, value: string, options = COOKIE_CONFIG): void {\n    if (typeof document === 'undefined') return;\n\n    const optionsStr = Object.entries(options)\n      .map(([key, val]) => {\n        if (key === 'maxAge') return `max-age=${val}`;\n        if (key === 'sameSite') return `SameSite=${val}`;\n        if (key === 'secure' && val) return 'Secure';\n        if (key === 'path') return `Path=${val}`;\n        return '';\n      })\n      .filter(Boolean)\n      .join('; ');\n\n    document.cookie = `${name}=${encodeURIComponent(value)}; ${optionsStr}`;\n  }\n\n  /**\n   * 获取 Cookie 值\n   * Get cookie value by name\n   */\n  static get(name: string): string | null {\n    if (typeof document === 'undefined') return null;\n\n    // 使用更安全的cookie解析方法\n    const cookies = document.cookie.split(';');\n    for (const cookie of cookies) {\n      const [cookieName, ...cookieValueParts] = cookie.trim().split('=');\n      if (cookieName !== name) continue;\n\n      const cookieValue = cookieValueParts.join('=');\n      if (!cookieValue) return null;\n\n      try {\n        return decodeURIComponent(cookieValue);\n      } catch {\n        // 静默处理URI解码错误\n        if (process.env.NODE_ENV === 'development') {\n          // console.warn('Failed to decode cookie value:', error);\n        }\n        return null;\n      }\n    }\n    return null;\n  }\n\n  /**\n   * 删除 Cookie\n   * Remove cookie by name\n   */\n  static remove(name: string): void {\n    if (typeof document === 'undefined') return;\n    document.cookie = `${name}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;`;\n  }\n\n  /**\n   * 检查 Cookie 是否存在\n   * Check if cookie exists\n   */\n  static exists(name: string): boolean {\n    return this.get(name) !== null;\n  }\n\n  /**\n   * 获取所有 Cookie\n   * Get all cookies as key-value pairs\n   */\n  static getAll(): Record<string, string> {\n    if (typeof document === 'undefined') return {};\n\n    const cookies: Record<string, string> = {};\n    const cookieStrings = document.cookie.split(';');\n\n    for (const cookie of cookieStrings) {\n      const [name, ...valueParts] = cookie.trim().split('=');\n      if (!name) continue;\n\n      const value = valueParts.join('=');\n      if (!value) continue;\n\n      try {\n        cookies[name] = decodeURIComponent(value);\n      } catch {\n        // 静默处理解码错误\n        if (process.env.NODE_ENV === 'development') {\n          // console.warn(`Failed to decode cookie ${name}:`, error);\n        }\n      }\n    }\n\n    return cookies;\n  }\n\n  /**\n   * 清除所有 Cookie\n   * Clear all cookies\n   */\n  static clearAll(): void {\n    if (typeof document === 'undefined') return;\n\n    const cookies = this.getAll();\n    Object.keys(cookies).forEach((name) => {\n      this.remove(name);\n    });\n  }\n\n  /**\n   * 设置带有过期时间的 Cookie\n   * Set cookie with expiration date\n   */\n  static setWithExpiry(\n    name: string,\n    value: string,\n    expiryDays: number,\n    options: Partial<typeof COOKIE_CONFIG> = {},\n  ): void {\n    const expiryDate = new Date();\n    expiryDate.setTime(expiryDate.getTime() + expiryDays * 24 * 60 * 60 * 1000);\n\n    const cookieOptions = {\n      ...COOKIE_CONFIG,\n      ...options,\n      expires: expiryDate.toUTCString(),\n    };\n\n    const optionsStr = Object.entries(cookieOptions)\n      .map(([key, val]) => {\n        if (key === 'maxAge') return `max-age=${val}`;\n        if (key === 'sameSite') return `SameSite=${val}`;\n        if (key === 'secure' && val) return 'Secure';\n        if (key === 'path') return `Path=${val}`;\n        if (key === 'expires') return `expires=${val}`;\n        return '';\n      })\n      .filter(Boolean)\n      .join('; ');\n\n    document.cookie = `${name}=${encodeURIComponent(value)}; ${optionsStr}`;\n  }\n\n  /**\n   * 获取 Cookie 的过期时间\n   * Get cookie expiration time (if available)\n   */\n  static getExpiry(name: string): Date | null {\n    // Note: JavaScript无法直接获取Cookie的过期时间\n    // 这个方法主要用于文档完整性，实际使用中需要在设置时记录\n    if (process.env.NODE_ENV === 'development') {\n      console.warn(\n        'Cookie expiry cannot be retrieved directly from JavaScript. ' +\n        'Consider storing expiry information separately if needed.',\n      );\n    }\n    return null;\n  }\n\n  /**\n   * 检查 Cookie 是否支持\n   * Check if cookies are supported\n   */\n  static isSupported(): boolean {\n    if (typeof document === 'undefined') return false;\n\n    try {\n      const testKey = '__cookie_test__';\n      const testValue = 'test';\n      \n      this.set(testKey, testValue);\n      const retrieved = this.get(testKey);\n      this.remove(testKey);\n      \n      return retrieved === testValue;\n    } catch {\n      return false;\n    }\n  }\n\n  /**\n   * 获取 Cookie 大小（字节）\n   * Get cookie size in bytes\n   */\n  static getSize(name: string): number {\n    const value = this.get(name);\n    if (!value) return 0;\n    \n    // 计算 Cookie 的总大小（名称 + 值 + 分隔符）\n    return new Blob([`${name}=${value}`]).size;\n  }\n\n  /**\n   * 获取所有 Cookie 的总大小\n   * Get total size of all cookies\n   */\n  static getTotalSize(): number {\n    if (typeof document === 'undefined') return 0;\n    \n    return new Blob([document.cookie]).size;\n  }\n\n  /**\n   * 检查是否接近 Cookie 大小限制\n   * Check if approaching cookie size limit\n   */\n  static isNearLimit(threshold: number = 0.8): boolean {\n    const maxSize = 4096; // 标准 Cookie 大小限制\n    const currentSize = this.getTotalSize();\n    \n    return currentSize / maxSize > threshold;\n  }\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-storage-history-core.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'LocaleSource' is defined but never used. Allowed unused vars must match /^_/u.","line":16,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":15,"suggestions":[{"messageId":"removeVar","data":{"varName":"LocaleSource"},"fix":{"range":[338,354],"text":""},"desc":"Remove unused variable 'LocaleSource'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'LocaleSource' is defined but never used. Allowed unused vars must match /^_/u.","line":16,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":16,"endColumn":15},{"ruleId":"no-unused-vars","severity":2,"message":"'StorageEvent' is defined but never used. Allowed unused vars must match /^_/u.","line":18,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":15,"suggestions":[{"messageId":"removeVar","data":{"varName":"StorageEvent"},"fix":{"range":[380,396],"text":""},"desc":"Remove unused variable 'StorageEvent'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'StorageEvent' is defined but never used. Allowed unused vars must match /^_/u.","line":18,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":18,"endColumn":15},{"ruleId":"no-unused-vars","severity":2,"message":"'STORAGE_KEYS' is defined but never used. Allowed unused vars must match /^_/u.","line":19,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":15,"suggestions":[{"messageId":"removeVar","data":{"varName":"STORAGE_KEYS"},"fix":{"range":[396,412],"text":""},"desc":"Remove unused variable 'STORAGE_KEYS'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'STORAGE_KEYS' is defined but never used. Allowed unused vars must match /^_/u.","line":19,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":19,"endColumn":15},{"ruleId":"no-duplicate-imports","severity":2,"message":"'./locale-storage-types' import is duplicated.","line":21,"column":1,"nodeType":"ImportDeclaration","messageId":"import","endLine":21,"endColumn":67},{"ruleId":"max-params","severity":2,"message":"Function 'addDetectionRecord' has too many parameters (4). Maximum allowed is 3.","line":91,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":91,"endColumn":35}],"suppressedMessages":[],"errorCount":8,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 语言检测历史核心管理\n * Locale Detection History Core Management\n * \n * 负责历史记录的基础操作：添加、获取、更新和缓存管理\n */\n\n'use client';\n\nimport { Locale } from '@/types/i18n';\nimport { CACHE_LIMITS } from '@/constants/i18n-constants';\nimport { LocalStorageManager } from './locale-storage-local';\nimport type {\n  LocaleDetectionHistory,\n  LocaleDetectionRecord,\n  LocaleSource,\n  StorageOperationResult,\n  StorageEvent,\n  STORAGE_KEYS,\n} from './locale-storage-types';\nimport { isLocaleDetectionHistory } from './locale-storage-types';\n\n// ==================== 缓存管理 ====================\n\n/**\n * 历史记录缓存管理器\n * History cache manager\n */\nexport class HistoryCacheManager {\n  private static cache: LocaleDetectionHistory | null = null;\n  private static cacheTimestamp = 0;\n  private static readonly CACHE_TTL = 10 * 60 * 1000; // 10 minutes\n\n  /**\n   * 获取缓存的历史记录\n   * Get cached history\n   */\n  static getCachedHistory(): LocaleDetectionHistory | null {\n    if (Date.now() - this.cacheTimestamp > this.CACHE_TTL) {\n      this.cache = null;\n      return null;\n    }\n    return this.cache;\n  }\n\n  /**\n   * 更新缓存\n   * Update cache\n   */\n  static updateCache(history: LocaleDetectionHistory): void {\n    this.cache = history;\n    this.cacheTimestamp = Date.now();\n  }\n\n  /**\n   * 清除缓存\n   * Clear cache\n   */\n  static clearCache(): void {\n    this.cache = null;\n    this.cacheTimestamp = 0;\n  }\n\n  /**\n   * 获取缓存状态\n   * Get cache status\n   */\n  static getCacheStatus(): {\n    isCached: boolean;\n    cacheAge: number;\n    cacheSize: number;\n  } {\n    const isCached = this.cache !== null && Date.now() - this.cacheTimestamp <= this.CACHE_TTL;\n    const cacheAge = Date.now() - this.cacheTimestamp;\n    const cacheSize = this.cache ? JSON.stringify(this.cache).length : 0;\n\n    return {\n      isCached,\n      cacheAge,\n      cacheSize,\n    };\n  }\n}\n\n// ==================== 核心历史管理 ====================\n\n/**\n * 添加检测记录\n * Add detection record\n */\nexport function addDetectionRecord(\n  locale: Locale,\n  source: string,\n  confidence: number,\n  metadata?: Record<string, unknown>\n): StorageOperationResult<LocaleDetectionHistory> {\n  const startTime = Date.now();\n  \n  try {\n    const detection: LocaleDetectionRecord = {\n      locale,\n      source,\n      timestamp: Date.now(),\n      confidence: Math.max(0, Math.min(1, confidence)),\n      metadata: metadata || {},\n    };\n\n    const result = updateDetectionHistory(detection);\n    \n    if (result.success) {\n      // 清除缓存以确保下次获取最新数据\n      HistoryCacheManager.clearCache();\n    }\n\n    return {\n      ...result,\n      responseTime: Date.now() - startTime,\n    };\n  } catch (error) {\n    return {\n      success: false,\n      error: error instanceof Error ? error.message : 'Unknown error',\n      source: 'localStorage',\n      timestamp: Date.now(),\n      responseTime: Date.now() - startTime,\n    };\n  }\n}\n\n/**\n * 获取检测历史\n * Get detection history\n */\nexport function getDetectionHistory(): StorageOperationResult<LocaleDetectionHistory> {\n  const startTime = Date.now();\n  \n  try {\n    // 首先检查缓存\n    const cached = HistoryCacheManager.getCachedHistory();\n    if (cached) {\n      return {\n        success: true,\n        data: cached,\n        source: 'memory',\n        timestamp: Date.now(),\n        responseTime: Date.now() - startTime,\n      };\n    }\n\n    // 从存储中获取\n    const stored = LocalStorageManager.get<LocaleDetectionHistory>('locale_detection_history');\n    \n    if (!stored) {\n      // 创建默认历史记录\n      const defaultHistory: LocaleDetectionHistory = {\n        history: [],\n        lastUpdated: Date.now(),\n        version: '1.0.0',\n      };\n      \n      const saveResult = LocalStorageManager.set('locale_detection_history', defaultHistory);\n      \n      if (saveResult.success) {\n        HistoryCacheManager.updateCache(defaultHistory);\n        return {\n          success: true,\n          data: defaultHistory,\n          source: 'localStorage',\n          timestamp: Date.now(),\n          responseTime: Date.now() - startTime,\n        };\n      }\n      return {\n        success: false,\n        error: saveResult.error || 'Failed to create default history',\n        source: 'localStorage',\n        timestamp: Date.now(),\n        responseTime: Date.now() - startTime,\n      };\n    }\n\n    // 验证数据格式\n    if (!validateHistoryData(stored)) {\n      return {\n        success: false,\n        error: 'Invalid history data format',\n        source: 'localStorage',\n        timestamp: Date.now(),\n        responseTime: Date.now() - startTime,\n      };\n    }\n\n    // 更新缓存\n    HistoryCacheManager.updateCache(stored);\n\n    return {\n      success: true,\n      data: stored,\n      source: 'localStorage',\n      timestamp: Date.now(),\n      responseTime: Date.now() - startTime,\n    };\n  } catch (error) {\n    return {\n      success: false,\n      error: error instanceof Error ? error.message : 'Unknown error',\n      source: 'localStorage',\n      timestamp: Date.now(),\n      responseTime: Date.now() - startTime,\n    };\n  }\n}\n\n/**\n * 更新检测历史\n * Update detection history\n */\nexport function updateDetectionHistory(detection: LocaleDetectionRecord): StorageOperationResult<LocaleDetectionHistory> {\n  const existingResult = getDetectionHistory();\n  \n  if (!existingResult.success) {\n    return existingResult;\n  }\n\n  const history = existingResult.data!;\n  \n  // 添加新记录到历史开头\n  history.history.unshift(detection);\n  \n  // 限制历史记录数量\n  const maxRecords = CACHE_LIMITS.MAX_HISTORY_ENTRIES || 100;\n  if (history.history.length > maxRecords) {\n    history.history = history.history.slice(0, maxRecords);\n  }\n  \n  // 更新时间戳\n  history.lastUpdated = Date.now();\n  \n  // 保存到存储\n  const saveResult = LocalStorageManager.set('locale_detection_history', history);\n  \n  if (saveResult.success) {\n    // 更新缓存\n    HistoryCacheManager.updateCache(history);\n    return {\n      success: true,\n      data: history,\n      source: 'localStorage',\n      timestamp: Date.now(),\n    };\n  }\n  return {\n    success: false,\n    error: saveResult.error || 'Failed to save history',\n    source: 'localStorage',\n    timestamp: Date.now(),\n  };\n}\n\n/**\n * 验证历史数据格式\n * Validate history data format\n */\nexport function validateHistoryData(history: unknown): history is LocaleDetectionHistory {\n  return isLocaleDetectionHistory(history);\n}\n\n/**\n * 创建默认历史记录\n * Create default history\n */\nexport function createDefaultHistory(): LocaleDetectionHistory {\n  return {\n    history: [],\n    lastUpdated: Date.now(),\n    version: '1.0.0',\n  };\n}\n\n/**\n * 获取历史记录摘要\n * Get history summary\n */\nexport function getHistorySummary(): {\n  totalRecords: number;\n  lastUpdated: number;\n  oldestRecord: number;\n  newestRecord: number;\n  cacheStatus: ReturnType<typeof HistoryCacheManager.getCacheStatus>;\n} {\n  const historyResult = getDetectionHistory();\n  \n  if (!historyResult.success || !historyResult.data) {\n    return {\n      totalRecords: 0,\n      lastUpdated: 0,\n      oldestRecord: 0,\n      newestRecord: 0,\n      cacheStatus: HistoryCacheManager.getCacheStatus(),\n    };\n  }\n\n  const history = historyResult.data;\n  const records = history.history;\n\n  return {\n    totalRecords: records.length,\n    lastUpdated: history.lastUpdated,\n    oldestRecord: records.length > 0 ? records[records.length - 1].timestamp : 0,\n    newestRecord: records.length > 0 ? records[0].timestamp : 0,\n    cacheStatus: HistoryCacheManager.getCacheStatus(),\n  };\n}\n\n/**\n * 检查历史记录是否需要清理\n * Check if history needs cleanup\n */\nexport function needsCleanup(maxAge: number = 30 * 24 * 60 * 60 * 1000): {\n  needsCleanup: boolean;\n  expiredCount: number;\n  totalCount: number;\n  recommendations: string[];\n} {\n  const historyResult = getDetectionHistory();\n  \n  if (!historyResult.success || !historyResult.data) {\n    return {\n      needsCleanup: false,\n      expiredCount: 0,\n      totalCount: 0,\n      recommendations: ['无法获取历史记录'],\n    };\n  }\n\n  const history = historyResult.data;\n  const cutoffTime = Date.now() - maxAge;\n  const expiredRecords = history.history.filter(record => record.timestamp < cutoffTime);\n  const totalCount = history.history.length;\n  const expiredCount = expiredRecords.length;\n\n  const recommendations: string[] = [];\n  \n  if (expiredCount > 0) {\n    recommendations.push(`发现 ${expiredCount} 条过期记录，建议清理`);\n  }\n  \n  if (totalCount > 100) {\n    recommendations.push(`历史记录过多 (${totalCount} 条)，建议清理旧记录`);\n  }\n  \n  const maxRecords = CACHE_LIMITS.MAX_HISTORY_ENTRIES || 100;\n  if (totalCount > maxRecords) {\n    recommendations.push(`超出最大记录限制 (${maxRecords})，将自动截断`);\n  }\n\n  if (recommendations.length === 0) {\n    recommendations.push('历史记录状态良好，无需清理');\n  }\n\n  return {\n    needsCleanup: expiredCount > 0 || totalCount > maxRecords,\n    expiredCount,\n    totalCount,\n    recommendations,\n  };\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-storage-history-events.ts","messages":[{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":141,"column":7,"nodeType":"MemberExpression","endLine":141,"endColumn":33},{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used. Allowed unused args must match /^_/u.","line":314,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":314,"endColumn":26,"suggestions":[{"messageId":"removeVar","data":{"varName":"error"},"fix":{"range":[6633,6647],"text":""},"desc":"Remove unused variable 'error'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'operation' is defined but never used. Allowed unused args must match /^_/u.","line":314,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":314,"endColumn":45,"suggestions":[{"messageId":"removeVar","data":{"varName":"operation"},"fix":{"range":[6646,6665],"text":""},"desc":"Remove unused variable 'operation'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'event' is defined but never used. Allowed unused args must match /^_/u.","line":314,"column":47,"nodeType":"Identifier","messageId":"unusedVar","endLine":314,"endColumn":66,"suggestions":[{"messageId":"removeVar","data":{"varName":"event"},"fix":{"range":[6665,6686],"text":""},"desc":"Remove unused variable 'event'."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 语言检测历史事件管理\n * Locale Detection History Event Management\n * \n * 负责历史记录相关的事件监听、发布和管理功能\n */\n\n'use client';\n\nimport type {\n  StorageEvent,\n  StorageEventListener,\n} from './locale-storage-types';\nimport { logger } from '@/lib/logger';\n\n// ==================== 事件管理器 ====================\n\n/**\n * 历史事件管理器\n * History event manager\n */\nexport class HistoryEventManager {\n  private static eventListeners: Map<string, StorageEventListener[]> = new Map();\n  private static eventHistory: StorageEvent[] = [];\n  private static readonly MAX_EVENT_HISTORY = 100;\n\n  /**\n   * 添加事件监听器\n   * Add event listener\n   */\n  static addEventListener(eventType: string, listener: StorageEventListener): void {\n    if (!this.eventListeners.has(eventType)) {\n      this.eventListeners.set(eventType, []);\n    }\n    this.eventListeners.get(eventType)!.push(listener);\n  }\n\n  /**\n   * 移除事件监听器\n   * Remove event listener\n   */\n  static removeEventListener(eventType: string, listener: StorageEventListener): void {\n    const listeners = this.eventListeners.get(eventType);\n    if (listeners) {\n      const index = listeners.indexOf(listener);\n      if (index > -1) {\n        listeners.splice(index, 1);\n      }\n    }\n  }\n\n  /**\n   * 移除所有事件监听器\n   * Remove all event listeners\n   */\n  static removeAllListeners(eventType?: string): void {\n    if (eventType) {\n      this.eventListeners.delete(eventType);\n    } else {\n      this.eventListeners.clear();\n    }\n  }\n\n  /**\n   * 发出事件\n   * Emit event\n   */\n  static emitEvent(event: StorageEvent): void {\n    // 记录事件历史\n    this.recordEvent(event);\n\n    // 发送给特定类型的监听器\n    const listeners = this.eventListeners.get(event.type);\n    if (listeners) {\n      listeners.forEach(listener => {\n        try {\n          listener(event);\n        } catch (error) {\n          logger.error(`Error in history event listener for ${event.type}`, { error: error as Error });\n        }\n      });\n    }\n\n    // 发送给通用监听器\n    const allListeners = this.eventListeners.get('*');\n    if (allListeners) {\n      allListeners.forEach(listener => {\n        try {\n          listener(event);\n        } catch (error) {\n          logger.error('Error in universal history event listener', { error: error as Error });\n        }\n      });\n    }\n  }\n\n  /**\n   * 记录事件历史\n   * Record event history\n   */\n  private static recordEvent(event: StorageEvent): void {\n    this.eventHistory.unshift(event);\n    \n    // 限制事件历史长度\n    if (this.eventHistory.length > this.MAX_EVENT_HISTORY) {\n      this.eventHistory = this.eventHistory.slice(0, this.MAX_EVENT_HISTORY);\n    }\n  }\n\n  /**\n   * 获取事件历史\n   * Get event history\n   */\n  static getEventHistory(limit?: number): StorageEvent[] {\n    return limit ? this.eventHistory.slice(0, limit) : [...this.eventHistory];\n  }\n\n  /**\n   * 清除事件历史\n   * Clear event history\n   */\n  static clearEventHistory(): void {\n    this.eventHistory = [];\n  }\n\n  /**\n   * 获取监听器统计\n   * Get listener statistics\n   */\n  static getListenerStats(): {\n    totalListeners: number;\n    eventTypes: string[];\n    listenersByType: Record<string, number>;\n  } {\n    let totalListeners = 0;\n    const listenersByType: Record<string, number> = {};\n\n    for (const [eventType, listeners] of this.eventListeners.entries()) {\n      const count = listeners.length;\n      totalListeners += count;\n      listenersByType[eventType] = count;\n    }\n\n    return {\n      totalListeners,\n      eventTypes: Array.from(this.eventListeners.keys()),\n      listenersByType,\n    };\n  }\n}\n\n// ==================== 事件创建工具 ====================\n\n/**\n * 创建历史记录添加事件\n * Create history record added event\n */\nexport function createRecordAddedEvent(\n  locale: string,\n  source: string,\n  confidence: number\n): StorageEvent {\n  return {\n    type: 'history_record_added',\n    data: {\n      locale,\n      source,\n      confidence,\n      action: 'add_record',\n    },\n    timestamp: Date.now(),\n    source: 'history_manager',\n  };\n}\n\n/**\n * 创建历史记录清理事件\n * Create history cleanup event\n */\nexport function createCleanupEvent(\n  cleanupType: 'expired' | 'duplicates' | 'size_limit' | 'all',\n  removedCount: number\n): StorageEvent {\n  return {\n    type: 'history_cleanup',\n    data: {\n      cleanupType,\n      removedCount,\n      action: 'cleanup',\n    },\n    timestamp: Date.now(),\n    source: 'history_manager',\n  };\n}\n\n/**\n * 创建历史记录导出事件\n * Create history export event\n */\nexport function createExportEvent(\n  format: 'json' | 'backup',\n  recordCount: number\n): StorageEvent {\n  return {\n    type: 'history_export',\n    data: {\n      format,\n      recordCount,\n      action: 'export',\n    },\n    timestamp: Date.now(),\n    source: 'history_manager',\n  };\n}\n\n/**\n * 创建历史记录导入事件\n * Create history import event\n */\nexport function createImportEvent(\n  format: 'json' | 'backup',\n  recordCount: number,\n  success: boolean\n): StorageEvent {\n  return {\n    type: 'history_import',\n    data: {\n      format,\n      recordCount,\n      success,\n      action: 'import',\n    },\n    timestamp: Date.now(),\n    source: 'history_manager',\n  };\n}\n\n/**\n * 创建历史记录错误事件\n * Create history error event\n */\nexport function createErrorEvent(\n  operation: string,\n  error: string\n): StorageEvent {\n  return {\n    type: 'history_error',\n    data: {\n      operation,\n      error,\n      action: 'error',\n    },\n    timestamp: Date.now(),\n    source: 'history_manager',\n  };\n}\n\n// ==================== 事件监听器工具 ====================\n\n/**\n * 创建调试事件监听器\n * Create debug event listener\n */\nexport function createDebugListener(prefix: string = '[History]'): StorageEventListener {\n  return (event: StorageEvent) => {\n    logger.info(`${prefix} Event`, {\n      type: event.type,\n      data: event.data,\n      timestamp: new Date(event.timestamp).toISOString(),\n      source: event.source,\n    });\n  };\n}\n\n/**\n * 创建统计事件监听器\n * Create statistics event listener\n */\nexport function createStatsListener(): {\n  listener: StorageEventListener;\n  getStats: () => {\n    totalEvents: number;\n    eventsByType: Record<string, number>;\n    recentEvents: StorageEvent[];\n  };\n} {\n  const stats = {\n    totalEvents: 0,\n    eventsByType: {} as Record<string, number>,\n    recentEvents: [] as StorageEvent[],\n  };\n\n  const listener: StorageEventListener = (event: StorageEvent) => {\n    stats.totalEvents += 1;\n    stats.eventsByType[event.type] = (stats.eventsByType[event.type] || 0) + 1;\n    \n    // 保留最近10个事件\n    stats.recentEvents.unshift(event);\n    if (stats.recentEvents.length > 10) {\n      stats.recentEvents = stats.recentEvents.slice(0, 10);\n    }\n  };\n\n  const getStats = () => ({ ...stats });\n\n  return { listener, getStats };\n}\n\n/**\n * 创建错误监听器\n * Create error listener\n */\nexport function createErrorListener(\n  onError: (error: string, operation: string, event: StorageEvent) => void\n): StorageEventListener {\n  return (event: StorageEvent) => {\n    if (event.type === 'history_error' && event.data) {\n      const { operation, error } = event.data as { operation: string; error: string };\n      onError(error, operation, event);\n    }\n  };\n}\n\n// ==================== 预定义事件监听器 ====================\n\n/**\n * 控制台日志监听器\n * Console log listener\n */\nexport const consoleLogListener: StorageEventListener = (event: StorageEvent) => {\n  const timestamp = new Date(event.timestamp).toLocaleTimeString();\n  \n  switch (event.type) {\n    case 'history_record_added':\n      logger.info('历史记录已添加', { timestamp, data: event.data });\n      break;\n    case 'history_cleanup':\n      logger.info('历史记录已清理', { timestamp, data: event.data });\n      break;\n    case 'history_export':\n      logger.info('历史记录已导出', { timestamp, data: event.data });\n      break;\n    case 'history_import':\n      logger.info('历史记录已导入', { timestamp, data: event.data });\n      break;\n    case 'history_error':\n      logger.error('历史记录错误', { timestamp, data: event.data as unknown });\n      break;\n    default:\n      logger.info(`历史记录事件 (${event.type})`, { timestamp, data: event.data });\n  }\n};\n\n/**\n * 性能监控监听器\n * Performance monitoring listener\n */\nexport const performanceListener: StorageEventListener = (event: StorageEvent) => {\n  // 记录性能相关的事件\n  if (event.type === 'history_cleanup' && event.data) {\n    const { cleanupType, removedCount } = event.data as { cleanupType: string; removedCount: number };\n    \n    if (removedCount > 100) {\n      logger.warn('大量历史记录清理', { cleanupType, removedCount });\n    }\n  }\n  \n  if (event.type === 'history_error') {\n    logger.error('历史记录操作失败', { data: event.data as unknown });\n  }\n};\n\n// ==================== 事件管理工具函数 ====================\n\n/**\n * 批量添加事件监听器\n * Batch add event listeners\n */\nexport function addMultipleListeners(listeners: Array<{\n  eventType: string;\n  listener: StorageEventListener;\n}>): void {\n  listeners.forEach(({ eventType, listener }) => {\n    HistoryEventManager.addEventListener(eventType, listener);\n  });\n}\n\n/**\n * 设置默认事件监听器\n * Setup default event listeners\n */\nexport function setupDefaultListeners(options: {\n  enableConsoleLog?: boolean;\n  enablePerformanceMonitoring?: boolean;\n  enableDebug?: boolean;\n} = {}): void {\n  const {\n    enableConsoleLog = true,\n    enablePerformanceMonitoring = true,\n    enableDebug = false,\n  } = options;\n\n  if (enableConsoleLog) {\n    HistoryEventManager.addEventListener('*', consoleLogListener);\n  }\n\n  if (enablePerformanceMonitoring) {\n    HistoryEventManager.addEventListener('*', performanceListener);\n  }\n\n  if (enableDebug) {\n    HistoryEventManager.addEventListener('*', createDebugListener('[HistoryDebug]'));\n  }\n}\n\n/**\n * 清理所有事件监听器和历史\n * Cleanup all event listeners and history\n */\nexport function cleanupEventSystem(): void {\n  HistoryEventManager.removeAllListeners();\n  HistoryEventManager.clearEventHistory();\n}\n\n/**\n * 获取事件系统状态\n * Get event system status\n */\nexport function getEventSystemStatus(): {\n  isActive: boolean;\n  listenerStats: ReturnType<typeof HistoryEventManager.getListenerStats>;\n  eventHistoryCount: number;\n  lastEventTime: number | null;\n} {\n  const listenerStats = HistoryEventManager.getListenerStats();\n  const eventHistory = HistoryEventManager.getEventHistory(1);\n  \n  return {\n    isActive: listenerStats.totalListeners > 0,\n    listenerStats,\n    eventHistoryCount: HistoryEventManager.getEventHistory().length,\n    lastEventTime: eventHistory.length > 0 ? eventHistory[0].timestamp : null,\n  };\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-storage-history-maintenance.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-storage-history-maintenance/backup.ts","messages":[{"ruleId":"no-duplicate-imports","severity":2,"message":"'./import-export' import is duplicated.","line":13,"column":1,"nodeType":"ImportDeclaration","messageId":"import","endLine":13,"endColumn":49}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 语言检测历史备份和恢复功能\n * Locale Detection History Backup and Restore Functions\n */\n\n'use client';\n\nimport type {\n  LocaleDetectionHistory,\n  StorageOperationResult,\n} from '../locale-storage-types';\nimport { exportHistory } from './import-export';\nimport { importHistory } from './import-export';\n\n/**\n * 创建历史记录备份\n * Create history backup\n */\nexport function createBackup(): StorageOperationResult<{\n  backup: LocaleDetectionHistory;\n  timestamp: number;\n  size: number;\n}> {\n  const historyResult = exportHistory();\n  \n  if (!historyResult.success) {\n    return {\n      ...historyResult,\n      data: undefined,\n    } as StorageOperationResult<{\n      backup: LocaleDetectionHistory;\n      timestamp: number;\n      size: number;\n    }>;\n  }\n\n  const backup = historyResult.data!;\n  const timestamp = Date.now();\n  const size = JSON.stringify(backup).length;\n\n  return {\n    success: true,\n    data: {\n      backup,\n      timestamp,\n      size,\n    },\n    source: 'localStorage',\n    timestamp,\n  };\n}\n\n/**\n * 从备份恢复历史记录\n * Restore history from backup\n */\nexport function restoreFromBackup(backup: LocaleDetectionHistory): StorageOperationResult<LocaleDetectionHistory> {\n  return importHistory(backup);\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-storage-history-maintenance/cleanup.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'LocaleDetectionHistory' is defined but never used. Allowed unused vars must match /^_/u.","line":11,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"LocaleDetectionHistory"},"fix":{"range":[222,245],"text":""},"desc":"Remove unused variable 'LocaleDetectionHistory'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'LocaleDetectionHistory' is defined but never used. Allowed unused vars must match /^_/u.","line":11,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":11,"endColumn":25},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 30.","line":25,"column":61,"nodeType":"Literal","messageId":"noMagic","endLine":25,"endColumn":63},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 24.","line":25,"column":66,"nodeType":"Literal","messageId":"noMagic","endLine":25,"endColumn":68},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 60.","line":25,"column":71,"nodeType":"Literal","messageId":"noMagic","endLine":25,"endColumn":73},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 60.","line":25,"column":76,"nodeType":"Literal","messageId":"noMagic","endLine":25,"endColumn":78},{"ruleId":"max-statements","severity":2,"message":"Function 'cleanupDuplicateDetections' has too many statements (21). Maximum allowed is 20.","line":99,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":175,"endColumn":2}],"suppressedMessages":[],"errorCount":7,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 语言检测历史清理功能\n * Locale Detection History Cleanup Functions\n */\n\n'use client';\n\nimport { CACHE_LIMITS } from '@/constants/i18n-constants';\nimport { LocalStorageManager } from '../locale-storage-local';\nimport type {\n  LocaleDetectionHistory,\n  LocaleDetectionRecord,\n  StorageOperationResult,\n} from '../locale-storage-types';\nimport { \n  getDetectionHistory, \n  createDefaultHistory,\n  HistoryCacheManager \n} from '../locale-storage-history-core';\n\n/**\n * 清理过期的检测记录\n * Cleanup expired detection records\n */\nexport function cleanupExpiredDetections(maxAgeMs: number = 30 * 24 * 60 * 60 * 1000): StorageOperationResult<number> {\n  const startTime = Date.now();\n  \n  try {\n    const historyResult = getDetectionHistory();\n    \n    if (!historyResult.success || !historyResult.data) {\n      return {\n        success: false,\n        error: 'Failed to get detection history',\n        source: 'localStorage',\n        timestamp: Date.now(),\n        responseTime: Date.now() - startTime,\n      };\n    }\n\n    const history = historyResult.data;\n    const cutoffTime = Date.now() - maxAgeMs;\n    const originalCount = history.history.length;\n    \n    // 过滤掉过期的记录\n    history.history = history.history.filter(record => record.timestamp > cutoffTime);\n    \n    const removedCount = originalCount - history.history.length;\n    \n    if (removedCount > 0) {\n      // 更新时间戳\n      history.lastUpdated = Date.now();\n      \n      // 保存更新后的历史\n      const saveResult = LocalStorageManager.set('locale_detection_history', history);\n      \n      if (saveResult.success) {\n        // 清除缓存\n        HistoryCacheManager.clearCache();\n        \n        return {\n          success: true,\n          data: removedCount,\n          source: 'localStorage',\n          timestamp: Date.now(),\n          responseTime: Date.now() - startTime,\n        };\n      }\n      return {\n        success: false,\n        error: saveResult.error || 'Failed to save cleaned history',\n        source: 'localStorage',\n        timestamp: Date.now(),\n        responseTime: Date.now() - startTime,\n      };\n    }\n    return {\n      success: true,\n      data: 0,\n      source: 'localStorage',\n      timestamp: Date.now(),\n      responseTime: Date.now() - startTime,\n    };\n  } catch (error) {\n    return {\n      success: false,\n      error: error instanceof Error ? error.message : 'Unknown error',\n      source: 'localStorage',\n      timestamp: Date.now(),\n      responseTime: Date.now() - startTime,\n    };\n  }\n}\n\n/**\n * 清理重复的检测记录\n * Cleanup duplicate detection records\n */\nexport function cleanupDuplicateDetections(): StorageOperationResult<number> {\n  const startTime = Date.now();\n  \n  try {\n    const historyResult = getDetectionHistory();\n    \n    if (!historyResult.success || !historyResult.data) {\n      return {\n        success: false,\n        error: 'Failed to get detection history',\n        source: 'localStorage',\n        timestamp: Date.now(),\n        responseTime: Date.now() - startTime,\n      };\n    }\n\n    const history = historyResult.data;\n    const originalCount = history.history.length;\n    \n    // 使用 Set 来跟踪已见过的记录\n    const seen = new Set<string>();\n    const uniqueRecords: LocaleDetectionRecord[] = [];\n    \n    history.history.forEach(record => {\n      // 创建记录的唯一标识符\n      const key = `${record.locale}-${record.source}-${record.timestamp}-${record.confidence}`;\n      \n      if (!seen.has(key)) {\n        seen.add(key);\n        uniqueRecords.push(record);\n      }\n    });\n    \n    const removedCount = originalCount - uniqueRecords.length;\n    \n    if (removedCount > 0) {\n      history.history = uniqueRecords;\n      history.lastUpdated = Date.now();\n      \n      const saveResult = LocalStorageManager.set('locale_detection_history', history);\n      \n      if (saveResult.success) {\n        HistoryCacheManager.clearCache();\n        \n        return {\n          success: true,\n          data: removedCount,\n          source: 'localStorage',\n          timestamp: Date.now(),\n          responseTime: Date.now() - startTime,\n        };\n      }\n      return {\n        success: false,\n        error: saveResult.error || 'Failed to save deduplicated history',\n        source: 'localStorage',\n        timestamp: Date.now(),\n        responseTime: Date.now() - startTime,\n      };\n    }\n    return {\n      success: true,\n      data: 0,\n      source: 'localStorage',\n      timestamp: Date.now(),\n      responseTime: Date.now() - startTime,\n    };\n  } catch (error) {\n    return {\n      success: false,\n      error: error instanceof Error ? error.message : 'Unknown error',\n      source: 'localStorage',\n      timestamp: Date.now(),\n      responseTime: Date.now() - startTime,\n    };\n  }\n}\n\n/**\n * 限制历史记录数量\n * Limit history record count\n */\nexport function limitHistorySize(maxRecords: number = CACHE_LIMITS.MAX_HISTORY_ENTRIES || 100): StorageOperationResult<number> {\n  const startTime = Date.now();\n  \n  try {\n    const historyResult = getDetectionHistory();\n    \n    if (!historyResult.success || !historyResult.data) {\n      return {\n        success: false,\n        error: 'Failed to get detection history',\n        source: 'localStorage',\n        timestamp: Date.now(),\n        responseTime: Date.now() - startTime,\n      };\n    }\n\n    const history = historyResult.data;\n    const originalCount = history.history.length;\n    \n    if (originalCount > maxRecords) {\n      // 保留最新的记录\n      history.history = history.history.slice(0, maxRecords);\n      history.lastUpdated = Date.now();\n      \n      const saveResult = LocalStorageManager.set('locale_detection_history', history);\n      \n      if (saveResult.success) {\n        HistoryCacheManager.clearCache();\n        \n        const removedCount = originalCount - maxRecords;\n        return {\n          success: true,\n          data: removedCount,\n          source: 'localStorage',\n          timestamp: Date.now(),\n          responseTime: Date.now() - startTime,\n        };\n      }\n      return {\n        success: false,\n        error: saveResult.error || 'Failed to save limited history',\n        source: 'localStorage',\n        timestamp: Date.now(),\n        responseTime: Date.now() - startTime,\n      };\n    }\n    return {\n      success: true,\n      data: 0,\n      source: 'localStorage',\n      timestamp: Date.now(),\n      responseTime: Date.now() - startTime,\n    };\n  } catch (error) {\n    return {\n      success: false,\n      error: error instanceof Error ? error.message : 'Unknown error',\n      source: 'localStorage',\n      timestamp: Date.now(),\n      responseTime: Date.now() - startTime,\n    };\n  }\n}\n\n/**\n * 清除所有历史记录\n * Clear all history\n */\nexport function clearAllHistory(): StorageOperationResult<void> {\n  const startTime = Date.now();\n  \n  try {\n    const defaultHistory = createDefaultHistory();\n    const saveResult = LocalStorageManager.set('locale_detection_history', defaultHistory);\n    \n    if (saveResult.success) {\n      HistoryCacheManager.clearCache();\n      \n      return {\n        success: true,\n        data: undefined,\n        source: 'localStorage',\n        timestamp: Date.now(),\n        responseTime: Date.now() - startTime,\n      };\n    }\n    return {\n      success: false,\n      error: saveResult.error || 'Failed to clear history',\n      source: 'localStorage',\n      timestamp: Date.now(),\n      responseTime: Date.now() - startTime,\n    };\n  } catch (error) {\n    return {\n      success: false,\n      error: error instanceof Error ? error.message : 'Unknown error',\n      source: 'localStorage',\n      timestamp: Date.now(),\n      responseTime: Date.now() - startTime,\n    };\n  }\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-storage-history-maintenance/import-export.ts","messages":[{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2.","line":42,"column":65,"nodeType":"Literal","messageId":"noMagic","endLine":42,"endColumn":66}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 语言检测历史导入导出功能\n * Locale Detection History Import/Export Functions\n */\n\n'use client';\n\nimport { LocalStorageManager } from '../locale-storage-local';\nimport type {\n  LocaleDetectionHistory,\n  StorageOperationResult,\n} from '../locale-storage-types';\nimport { \n  getDetectionHistory, \n  validateHistoryData,\n  HistoryCacheManager \n} from '../locale-storage-history-core';\n\n/**\n * 导出历史记录\n * Export history\n */\nexport function exportHistory(): StorageOperationResult<LocaleDetectionHistory> {\n  return getDetectionHistory();\n}\n\n/**\n * 导出历史记录为JSON字符串\n * Export history as JSON string\n */\nexport function exportHistoryAsJson(): StorageOperationResult<string> {\n  const historyResult = exportHistory();\n  \n  if (!historyResult.success) {\n    return {\n      ...historyResult,\n      data: undefined,\n    } as StorageOperationResult<string>;\n  }\n\n  try {\n    const jsonString = JSON.stringify(historyResult.data, null, 2);\n    return {\n      ...historyResult,\n      data: jsonString,\n    };\n  } catch (error) {\n    return {\n      success: false,\n      error: error instanceof Error ? error.message : 'Failed to serialize history',\n      source: 'localStorage',\n      timestamp: Date.now(),\n    };\n  }\n}\n\n/**\n * 导入历史记录\n * Import history\n */\nexport function importHistory(history: LocaleDetectionHistory): StorageOperationResult<LocaleDetectionHistory> {\n  const startTime = Date.now();\n  \n  try {\n    // 验证导入的数据\n    if (!validateHistoryData(history)) {\n      return {\n        success: false,\n        error: 'Invalid history data format',\n        source: 'localStorage',\n        timestamp: Date.now(),\n        responseTime: Date.now() - startTime,\n      };\n    }\n\n    // 更新时间戳\n    const updatedHistory: LocaleDetectionHistory = {\n      ...history,\n      lastUpdated: Date.now(),\n    };\n\n    // 保存到存储\n    const saveResult = LocalStorageManager.set('locale_detection_history', updatedHistory);\n    \n    if (saveResult.success) {\n      HistoryCacheManager.clearCache();\n      return {\n        success: true,\n        data: updatedHistory,\n        source: 'localStorage',\n        timestamp: Date.now(),\n        responseTime: Date.now() - startTime,\n      };\n    }\n    return {\n      success: false,\n      error: saveResult.error || 'Failed to save imported history',\n      source: 'localStorage',\n      timestamp: Date.now(),\n      responseTime: Date.now() - startTime,\n    };\n  } catch (error) {\n    return {\n      success: false,\n      error: error instanceof Error ? error.message : 'Unknown error',\n      source: 'localStorage',\n      timestamp: Date.now(),\n      responseTime: Date.now() - startTime,\n    };\n  }\n}\n\n/**\n * 从JSON字符串导入历史记录\n * Import history from JSON string\n */\nexport function importHistoryFromJson(jsonString: string): StorageOperationResult<LocaleDetectionHistory> {\n  try {\n    const history = JSON.parse(jsonString) as LocaleDetectionHistory;\n    return importHistory(history);\n  } catch (error) {\n    return {\n      success: false,\n      error: error instanceof Error ? error.message : 'Failed to parse JSON',\n      source: 'localStorage',\n      timestamp: Date.now(),\n    };\n  }\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-storage-history-maintenance/maintenance.ts","messages":[{"ruleId":"max-statements","severity":2,"message":"Function 'performMaintenance' has too many statements (21). Maximum allowed is 20.","line":23,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":91,"endColumn":2},{"ruleId":"max-statements","severity":2,"message":"Function 'getMaintenanceRecommendations' has too many statements (31). Maximum allowed is 20.","line":97,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":178,"endColumn":2},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 1.5.","line":119,"column":37,"nodeType":"Literal","messageId":"noMagic","endLine":119,"endColumn":40},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 30.","line":128,"column":38,"nodeType":"Literal","messageId":"noMagic","endLine":128,"endColumn":40},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 24.","line":128,"column":43,"nodeType":"Literal","messageId":"noMagic","endLine":128,"endColumn":45},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 60.","line":128,"column":48,"nodeType":"Literal","messageId":"noMagic","endLine":128,"endColumn":50},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 60.","line":128,"column":53,"nodeType":"Literal","messageId":"noMagic","endLine":128,"endColumn":55}],"suppressedMessages":[],"errorCount":7,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 语言检测历史维护工具功能\n * Locale Detection History Maintenance Tools\n */\n\n'use client';\n\nimport { CACHE_LIMITS } from '@/constants/i18n-constants';\nimport type {\n  StorageOperationResult,\n} from '../locale-storage-types';\nimport { getDetectionHistory } from '../locale-storage-history-core';\nimport { \n  cleanupExpiredDetections, \n  cleanupDuplicateDetections, \n  limitHistorySize \n} from './cleanup';\n\n/**\n * 执行完整的历史维护\n * Perform complete history maintenance\n */\nexport function performMaintenance(options: {\n  cleanupExpired?: boolean;\n  maxAge?: number;\n  removeDuplicates?: boolean;\n  limitSize?: boolean;\n  maxRecords?: number;\n}): StorageOperationResult<{\n  expiredRemoved: number;\n  duplicatesRemoved: number;\n  sizeReduced: number;\n  finalCount: number;\n}> {\n  const startTime = Date.now();\n  \n  try {\n    let expiredRemoved = 0;\n    let duplicatesRemoved = 0;\n    let sizeReduced = 0;\n\n    // 清理过期记录\n    if (options.cleanupExpired !== false) {\n      const expiredResult = cleanupExpiredDetections(options.maxAge);\n      if (expiredResult.success) {\n        expiredRemoved = expiredResult.data || 0;\n      }\n    }\n\n    // 移除重复记录\n    if (options.removeDuplicates !== false) {\n      const duplicateResult = cleanupDuplicateDetections();\n      if (duplicateResult.success) {\n        duplicatesRemoved = duplicateResult.data || 0;\n      }\n    }\n\n    // 限制大小\n    if (options.limitSize !== false) {\n      const limitResult = limitHistorySize(options.maxRecords);\n      if (limitResult.success) {\n        sizeReduced = limitResult.data || 0;\n      }\n    }\n\n    // 获取最终计数\n    const historyResult = getDetectionHistory();\n    const finalCount = historyResult.success ? historyResult.data!.history.length : 0;\n\n    return {\n      success: true,\n      data: {\n        expiredRemoved,\n        duplicatesRemoved,\n        sizeReduced,\n        finalCount,\n      },\n      source: 'localStorage',\n      timestamp: Date.now(),\n      responseTime: Date.now() - startTime,\n    };\n  } catch (error) {\n    return {\n      success: false,\n      error: error instanceof Error ? error.message : 'Unknown error',\n      source: 'localStorage',\n      timestamp: Date.now(),\n      responseTime: Date.now() - startTime,\n    };\n  }\n}\n\n/**\n * 获取维护建议\n * Get maintenance recommendations\n */\nexport function getMaintenanceRecommendations(): {\n  recommendations: string[];\n  urgency: 'low' | 'medium' | 'high';\n  estimatedBenefit: string;\n} {\n  const historyResult = getDetectionHistory();\n  \n  if (!historyResult.success || !historyResult.data) {\n    return {\n      recommendations: ['无法获取历史记录，建议检查存储状态'],\n      urgency: 'high',\n      estimatedBenefit: '恢复正常功能',\n    };\n  }\n\n  const history = historyResult.data;\n  const records = history.history;\n  const recommendations: string[] = [];\n  let urgency: 'low' | 'medium' | 'high' = 'low';\n\n  // 检查记录数量\n  const maxRecords = CACHE_LIMITS.MAX_HISTORY_ENTRIES || 100;\n  if (records.length > maxRecords * 1.5) {\n    recommendations.push(`历史记录过多 (${records.length})，建议清理`);\n    urgency = 'high';\n  } else if (records.length > maxRecords) {\n    recommendations.push(`历史记录较多 (${records.length})，考虑清理`);\n    urgency = Math.max(urgency === 'low' ? 'medium' : urgency, 'medium') as 'medium' | 'high';\n  }\n\n  // 检查过期记录\n  const thirtyDaysAgo = Date.now() - 30 * 24 * 60 * 60 * 1000;\n  const expiredCount = records.filter(r => r.timestamp < thirtyDaysAgo).length;\n  \n  if (expiredCount > 0) {\n    recommendations.push(`发现 ${expiredCount} 条过期记录，建议清理`);\n    urgency = Math.max(urgency === 'low' ? 'medium' : urgency, 'medium') as 'medium' | 'high';\n  }\n\n  // 检查重复记录\n  const uniqueKeys = new Set();\n  let duplicateCount = 0;\n  \n  records.forEach(record => {\n    const key = `${record.locale}-${record.source}-${record.timestamp}`;\n    if (uniqueKeys.has(key)) {\n      duplicateCount += 1;\n    } else {\n      uniqueKeys.add(key);\n    }\n  });\n\n  if (duplicateCount > 0) {\n    recommendations.push(`发现 ${duplicateCount} 条重复记录，建议清理`);\n  }\n\n  // 检查数据完整性\n  const invalidRecords = records.filter(record => \n    !record.locale || !record.source || !record.timestamp || record.confidence < 0 || record.confidence > 1\n  );\n\n  if (invalidRecords.length > 0) {\n    recommendations.push(`发现 ${invalidRecords.length} 条无效记录，建议清理`);\n    urgency = 'high';\n  }\n\n  if (recommendations.length === 0) {\n    recommendations.push('历史记录状态良好，无需维护');\n  }\n\n  const estimatedBenefit = urgency === 'high' \n    ? '显著提升性能和稳定性'\n    : urgency === 'medium'\n    ? '改善存储效率'\n    : '保持系统整洁';\n\n  return {\n    recommendations,\n    urgency,\n    estimatedBenefit,\n  };\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-storage-history-query.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'LocaleSource' is defined but never used. Allowed unused vars must match /^_/u.","line":13,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":15,"suggestions":[{"messageId":"removeVar","data":{"varName":"LocaleSource"},"fix":{"range":[187,203],"text":""},"desc":"Remove unused variable 'LocaleSource'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'LocaleSource' is defined but never used. Allowed unused vars must match /^_/u.","line":13,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":13,"endColumn":15},{"ruleId":"max-statements","severity":2,"message":"Function 'queryDetections' has too many statements (24). Maximum allowed is 20.","line":122,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":214,"endColumn":2},{"ruleId":"no-unused-vars","severity":2,"message":"'maxTime' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":427,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":427,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"maxTime"},"fix":{"range":[9679,9719],"text":""},"desc":"Remove unused variable 'maxTime'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'maxTime' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":427,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":427,"endColumn":16}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 语言检测历史查询和过滤\n * Locale Detection History Query and Filtering\n *\n * 负责历史记录的查询、过滤和搜索功能\n */\n\n'use client';\n\nimport { Locale } from '@/types/i18n';\nimport type {\n  LocaleDetectionRecord,\n  LocaleSource,\n} from './locale-storage-types';\nimport { getDetectionHistory } from './locale-storage-history-core';\n\n// ==================== 基础查询功能 ====================\n\n/**\n * 获取最近的检测记录\n * Get recent detections\n */\nexport function getRecentDetections(limit: number = 10): LocaleDetectionRecord[] {\n  const historyResult = getDetectionHistory();\n\n  if (!historyResult.success || !historyResult.data) {\n    return [];\n  }\n\n  return historyResult.data.history.slice(0, limit);\n}\n\n/**\n * 按来源获取检测记录\n * Get detections by source\n */\nexport function getDetectionsBySource(source: string): LocaleDetectionRecord[] {\n  const historyResult = getDetectionHistory();\n\n  if (!historyResult.success || !historyResult.data) {\n    return [];\n  }\n\n  return historyResult.data.history.filter(record => record.source === source);\n}\n\n/**\n * 按语言获取检测记录\n * Get detections by locale\n */\nexport function getDetectionsByLocale(locale: Locale): LocaleDetectionRecord[] {\n  const historyResult = getDetectionHistory();\n\n  if (!historyResult.success || !historyResult.data) {\n    return [];\n  }\n\n  return historyResult.data.history.filter(record => record.locale === locale);\n}\n\n/**\n * 按时间范围获取检测记录\n * Get detections by time range\n */\nexport function getDetectionsByTimeRange(\n  startTime: number,\n  endTime: number\n): LocaleDetectionRecord[] {\n  const historyResult = getDetectionHistory();\n\n  if (!historyResult.success || !historyResult.data) {\n    return [];\n  }\n\n  return historyResult.data.history.filter(\n    record => record.timestamp >= startTime && record.timestamp <= endTime\n  );\n}\n\n/**\n * 按置信度范围获取检测记录\n * Get detections by confidence range\n */\nexport function getDetectionsByConfidence(\n  minConfidence: number,\n  maxConfidence: number = 1.0\n): LocaleDetectionRecord[] {\n  const historyResult = getDetectionHistory();\n\n  if (!historyResult.success || !historyResult.data) {\n    return [];\n  }\n\n  return historyResult.data.history.filter(\n    record => record.confidence >= minConfidence && record.confidence <= maxConfidence\n  );\n}\n\n// ==================== 高级查询功能 ====================\n\n/**\n * 查询条件接口\n * Query conditions interface\n */\nexport interface QueryConditions {\n  locale?: Locale;\n  source?: string;\n  startTime?: number;\n  endTime?: number;\n  minConfidence?: number;\n  maxConfidence?: number;\n  limit?: number;\n  offset?: number;\n  sortBy?: 'timestamp' | 'confidence' | 'locale' | 'source';\n  sortOrder?: 'asc' | 'desc';\n}\n\n/**\n * 复合查询检测记录\n * Complex query for detection records\n */\nexport function queryDetections(conditions: QueryConditions): {\n  records: LocaleDetectionRecord[];\n  totalCount: number;\n  hasMore: boolean;\n} {\n  const historyResult = getDetectionHistory();\n\n  if (!historyResult.success || !historyResult.data) {\n    return {\n      records: [],\n      totalCount: 0,\n      hasMore: false,\n    };\n  }\n\n  let records = historyResult.data.history;\n\n  // 应用过滤条件\n  if (conditions.locale) {\n    records = records.filter(record => record.locale === conditions.locale);\n  }\n\n  if (conditions.source) {\n    records = records.filter(record => record.source === conditions.source);\n  }\n\n  if (conditions.startTime !== undefined) {\n    records = records.filter(record => record.timestamp >= conditions.startTime!);\n  }\n\n  if (conditions.endTime !== undefined) {\n    records = records.filter(record => record.timestamp <= conditions.endTime!);\n  }\n\n  if (conditions.minConfidence !== undefined) {\n    records = records.filter(record => record.confidence >= conditions.minConfidence!);\n  }\n\n  if (conditions.maxConfidence !== undefined) {\n    records = records.filter(record => record.confidence <= conditions.maxConfidence!);\n  }\n\n  // 排序\n  if (conditions.sortBy) {\n    records.sort((a, b) => {\n      let aValue: string | number;\n      let bValue: string | number;\n\n      switch (conditions.sortBy) {\n        case 'timestamp':\n          aValue = a.timestamp;\n          bValue = b.timestamp;\n          break;\n        case 'confidence':\n          aValue = a.confidence;\n          bValue = b.confidence;\n          break;\n        case 'locale':\n          aValue = a.locale;\n          bValue = b.locale;\n          break;\n        case 'source':\n          aValue = a.source;\n          bValue = b.source;\n          break;\n        default:\n          return 0;\n      }\n\n      if (aValue < bValue) {\n        return conditions.sortOrder === 'desc' ? 1 : -1;\n      }\n      if (aValue > bValue) {\n        return conditions.sortOrder === 'desc' ? -1 : 1;\n      }\n      return 0;\n    });\n  }\n\n  const totalCount = records.length;\n\n  // 应用分页\n  const offset = conditions.offset || 0;\n  const limit = conditions.limit || totalCount;\n  const paginatedRecords = records.slice(offset, offset + limit);\n  const hasMore = offset + limit < totalCount;\n\n  return {\n    records: paginatedRecords,\n    totalCount,\n    hasMore,\n  };\n}\n\n/**\n * 搜索检测记录\n * Search detection records\n */\nexport function searchDetections(searchTerm: string): LocaleDetectionRecord[] {\n  const historyResult = getDetectionHistory();\n\n  if (!historyResult.success || !historyResult.data) {\n    return [];\n  }\n\n  const term = searchTerm.toLowerCase();\n\n  return historyResult.data.history.filter(record => {\n    // 搜索语言代码\n    if (record.locale.toLowerCase().includes(term)) {\n      return true;\n    }\n\n    // 搜索来源\n    if (record.source.toLowerCase().includes(term)) {\n      return true;\n    }\n\n    // 搜索元数据\n    if (record.metadata) {\n      const metadataStr = JSON.stringify(record.metadata).toLowerCase();\n      if (metadataStr.includes(term)) {\n        return true;\n      }\n    }\n\n    return false;\n  });\n}\n\n// ==================== 聚合查询功能 ====================\n\n/**\n * 获取唯一的语言列表\n * Get unique locales\n */\nexport function getUniqueLocales(): Locale[] {\n  const historyResult = getDetectionHistory();\n\n  if (!historyResult.success || !historyResult.data) {\n    return [];\n  }\n\n  const locales = new Set<Locale>();\n  historyResult.data.history.forEach(record => {\n    locales.add(record.locale);\n  });\n\n  return Array.from(locales).sort();\n}\n\n/**\n * 获取唯一的来源列表\n * Get unique sources\n */\nexport function getUniqueSources(): string[] {\n  const historyResult = getDetectionHistory();\n\n  if (!historyResult.success || !historyResult.data) {\n    return [];\n  }\n\n  const sources = new Set<string>();\n  historyResult.data.history.forEach(record => {\n    sources.add(record.source);\n  });\n\n  return Array.from(sources).sort();\n}\n\n/**\n * 按语言分组统计\n * Group by locale statistics\n */\nexport function getLocaleGroupStats(): Array<{\n  locale: Locale;\n  count: number;\n  percentage: number;\n  avgConfidence: number;\n  lastDetection: number;\n}> {\n  const historyResult = getDetectionHistory();\n\n  if (!historyResult.success || !historyResult.data) {\n    return [];\n  }\n\n  const records = historyResult.data.history;\n  const totalRecords = records.length;\n\n  if (totalRecords === 0) {\n    return [];\n  }\n\n  const localeStats = new Map<Locale, {\n    count: number;\n    totalConfidence: number;\n    lastDetection: number;\n  }>();\n\n  records.forEach(record => {\n    const existing = localeStats.get(record.locale) || {\n      count: 0,\n      totalConfidence: 0,\n      lastDetection: 0,\n    };\n\n    existing.count += 1;\n    existing.totalConfidence += record.confidence;\n    existing.lastDetection = Math.max(existing.lastDetection, record.timestamp);\n\n    localeStats.set(record.locale, existing);\n  });\n\n  return Array.from(localeStats.entries())\n    .map(([locale, stats]) => ({\n      locale,\n      count: stats.count,\n      percentage: (stats.count / totalRecords) * 100,\n      avgConfidence: stats.totalConfidence / stats.count,\n      lastDetection: stats.lastDetection,\n    }))\n    .sort((a, b) => b.count - a.count);\n}\n\n/**\n * 按来源分组统计\n * Group by source statistics\n */\nexport function getSourceGroupStats(): Array<{\n  source: string;\n  count: number;\n  percentage: number;\n  avgConfidence: number;\n  lastDetection: number;\n}> {\n  const historyResult = getDetectionHistory();\n\n  if (!historyResult.success || !historyResult.data) {\n    return [];\n  }\n\n  const records = historyResult.data.history;\n  const totalRecords = records.length;\n\n  if (totalRecords === 0) {\n    return [];\n  }\n\n  const sourceStats = new Map<string, {\n    count: number;\n    totalConfidence: number;\n    lastDetection: number;\n  }>();\n\n  records.forEach(record => {\n    const existing = sourceStats.get(record.source) || {\n      count: 0,\n      totalConfidence: 0,\n      lastDetection: 0,\n    };\n\n    existing.count += 1;\n    existing.totalConfidence += record.confidence;\n    existing.lastDetection = Math.max(existing.lastDetection, record.timestamp);\n\n    sourceStats.set(record.source, existing);\n  });\n\n  return Array.from(sourceStats.entries())\n    .map(([source, stats]) => ({\n      source,\n      count: stats.count,\n      percentage: (stats.count / totalRecords) * 100,\n      avgConfidence: stats.totalConfidence / stats.count,\n      lastDetection: stats.lastDetection,\n    }))\n    .sort((a, b) => b.count - a.count);\n}\n\n/**\n * 获取时间分布统计\n * Get time distribution statistics\n */\nexport function getTimeDistributionStats(bucketSize: number = 24 * 60 * 60 * 1000): Array<{\n  startTime: number;\n  endTime: number;\n  count: number;\n  avgConfidence: number;\n}> {\n  const historyResult = getDetectionHistory();\n\n  if (!historyResult.success || !historyResult.data) {\n    return [];\n  }\n\n  const records = historyResult.data.history;\n\n  if (records.length === 0) {\n    return [];\n  }\n\n  // 找到时间范围\n  const timestamps = records.map(r => r.timestamp);\n  const minTime = Math.min(...timestamps);\n  const maxTime = Math.max(...timestamps);\n\n  // 创建时间桶\n  const buckets = new Map<number, {\n    count: number;\n    totalConfidence: number;\n  }>();\n\n  records.forEach(record => {\n    const bucketStart = Math.floor((record.timestamp - minTime) / bucketSize) * bucketSize + minTime;\n    const existing = buckets.get(bucketStart) || {\n      count: 0,\n      totalConfidence: 0,\n    };\n\n    existing.count += 1;\n    existing.totalConfidence += record.confidence;\n\n    buckets.set(bucketStart, existing);\n  });\n\n  return Array.from(buckets.entries())\n    .map(([startTime, stats]) => ({\n      startTime,\n      endTime: startTime + bucketSize,\n      count: stats.count,\n      avgConfidence: stats.totalConfidence / stats.count,\n    }))\n    .sort((a, b) => a.startTime - b.startTime);\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-storage-history-stats.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'LocaleDetectionRecord' is defined but never used. Allowed unused vars must match /^_/u.","line":12,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":24,"suggestions":[{"messageId":"removeVar","data":{"varName":"LocaleDetectionRecord"},"fix":{"range":[159,230],"text":""},"desc":"Remove unused variable 'LocaleDetectionRecord'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'LocaleDetectionRecord' is defined but never used. Allowed unused vars must match /^_/u.","line":12,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":12,"endColumn":24},{"ruleId":"no-unused-vars","severity":2,"message":"'getTimeDistributionStats' is defined but never used. Allowed unused vars must match /^_/u.","line":15,"column":52,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":76,"suggestions":[{"messageId":"removeVar","data":{"varName":"getTimeDistributionStats"},"fix":{"range":[349,375],"text":""},"desc":"Remove unused variable 'getTimeDistributionStats'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'getTimeDistributionStats' is defined but never used. Allowed unused vars must match /^_/u.","line":15,"column":52,"nodeType":null,"messageId":"unusedVar","endLine":15,"endColumn":76},{"ruleId":"max-statements","severity":2,"message":"Function 'getDetectionStats' has too many statements (31). Maximum allowed is 20.","line":23,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":150,"endColumn":2},{"ruleId":"max-statements","severity":2,"message":"Function 'generateHistoryInsights' has too many statements (39). Maximum allowed is 20.","line":324,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":404,"endColumn":2},{"ruleId":"no-unused-vars","severity":2,"message":"'localeStats' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":331,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":331,"endColumn":20,"suggestions":[{"messageId":"removeVar","data":{"varName":"localeStats"},"fix":{"range":[8918,8960],"text":""},"desc":"Remove unused variable 'localeStats'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'localeStats' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":331,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":331,"endColumn":20},{"ruleId":"no-unused-vars","severity":2,"message":"'sourceStats' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":332,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":332,"endColumn":20,"suggestions":[{"messageId":"removeVar","data":{"varName":"sourceStats"},"fix":{"range":[8963,9005],"text":""},"desc":"Remove unused variable 'sourceStats'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'sourceStats' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":332,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":332,"endColumn":20},{"ruleId":"max-statements","severity":2,"message":"Function 'getPerformanceMetrics' has too many statements (27). Maximum allowed is 20.","line":410,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":493,"endColumn":2},{"ruleId":"no-unused-vars","severity":2,"message":"'locale' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":474,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":474,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"locale"},"fix":{"range":[12932,12938],"text":""},"desc":"Remove unused variable 'locale'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'locale' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":474,"column":15,"nodeType":null,"messageId":"unusedVar","endLine":474,"endColumn":21}],"suppressedMessages":[],"errorCount":13,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 语言检测历史统计和分析\n * Locale Detection History Statistics and Analysis\n * \n * 负责历史记录的统计分析、趋势分析和洞察生成\n */\n\n'use client';\n\nimport { Locale } from '@/types/i18n';\nimport type {\n  LocaleDetectionRecord,\n} from './locale-storage-types';\nimport { getDetectionHistory } from './locale-storage-history-core';\nimport { getLocaleGroupStats, getSourceGroupStats, getTimeDistributionStats } from './locale-storage-history-query';\n\n// ==================== 基础统计功能 ====================\n\n/**\n * 获取检测统计信息\n * Get detection statistics\n */\nexport function getDetectionStats(): {\n  totalDetections: number;\n  uniqueLocales: number;\n  uniqueSources: number;\n  averageConfidence: number;\n  mostDetectedLocale: { locale: Locale; count: number } | null;\n  mostUsedSource: { source: string; count: number } | null;\n  detectionFrequency: number; // detections per day\n  confidenceDistribution: {\n    high: number; // > 0.8\n    medium: number; // 0.5 - 0.8\n    low: number; // < 0.5\n  };\n  timeSpan: {\n    oldest: number;\n    newest: number;\n    spanDays: number;\n  };\n} {\n  const historyResult = getDetectionHistory();\n  \n  if (!historyResult.success || !historyResult.data) {\n    return {\n      totalDetections: 0,\n      uniqueLocales: 0,\n      uniqueSources: 0,\n      averageConfidence: 0,\n      mostDetectedLocale: null,\n      mostUsedSource: null,\n      detectionFrequency: 0,\n      confidenceDistribution: { high: 0, medium: 0, low: 0 },\n      timeSpan: { oldest: 0, newest: 0, spanDays: 0 },\n    };\n  }\n\n  const records = historyResult.data.history;\n  const totalDetections = records.length;\n\n  if (totalDetections === 0) {\n    return {\n      totalDetections: 0,\n      uniqueLocales: 0,\n      uniqueSources: 0,\n      averageConfidence: 0,\n      mostDetectedLocale: null,\n      mostUsedSource: null,\n      detectionFrequency: 0,\n      confidenceDistribution: { high: 0, medium: 0, low: 0 },\n      timeSpan: { oldest: 0, newest: 0, spanDays: 0 },\n    };\n  }\n\n  // 基础统计\n  const locales = new Set<Locale>();\n  const sources = new Set<string>();\n  let totalConfidence = 0;\n  let highConfidence = 0;\n  let mediumConfidence = 0;\n  let lowConfidence = 0;\n\n  const localeCounts = new Map<Locale, number>();\n  const sourceCounts = new Map<string, number>();\n\n  records.forEach(record => {\n    locales.add(record.locale);\n    sources.add(record.source);\n    totalConfidence += record.confidence;\n\n    // 置信度分布\n    if (record.confidence > 0.8) {\n      highConfidence += 1;\n    } else if (record.confidence >= 0.5) {\n      mediumConfidence += 1;\n    } else {\n      lowConfidence += 1;\n    }\n\n    // 计数统计\n    localeCounts.set(record.locale, (localeCounts.get(record.locale) || 0) + 1);\n    sourceCounts.set(record.source, (sourceCounts.get(record.source) || 0) + 1);\n  });\n\n  // 最常检测的语言\n  let mostDetectedLocale: { locale: Locale; count: number } | null = null;\n  for (const [locale, count] of localeCounts.entries()) {\n    if (!mostDetectedLocale || count > mostDetectedLocale.count) {\n      mostDetectedLocale = { locale, count };\n    }\n  }\n\n  // 最常用的来源\n  let mostUsedSource: { source: string; count: number } | null = null;\n  for (const [source, count] of sourceCounts.entries()) {\n    if (!mostUsedSource || count > mostUsedSource.count) {\n      mostUsedSource = { source, count };\n    }\n  }\n\n  // 时间跨度\n  const timestamps = records.map(r => r.timestamp);\n  const oldest = Math.min(...timestamps);\n  const newest = Math.max(...timestamps);\n  const spanMs = newest - oldest;\n  const spanDays = spanMs / (24 * 60 * 60 * 1000);\n\n  // 检测频率（每天）\n  const detectionFrequency = spanDays > 0 ? totalDetections / spanDays : 0;\n\n  return {\n    totalDetections,\n    uniqueLocales: locales.size,\n    uniqueSources: sources.size,\n    averageConfidence: totalConfidence / totalDetections,\n    mostDetectedLocale,\n    mostUsedSource,\n    detectionFrequency,\n    confidenceDistribution: {\n      high: highConfidence,\n      medium: mediumConfidence,\n      low: lowConfidence,\n    },\n    timeSpan: {\n      oldest,\n      newest,\n      spanDays,\n    },\n  };\n}\n\n// ==================== 趋势分析功能 ====================\n\n/**\n * 获取检测趋势\n * Get detection trends\n */\nexport function getDetectionTrends(days: number = 7): {\n  dailyDetections: Array<{ date: string; count: number; avgConfidence: number }>;\n  weeklyGrowth: number;\n  monthlyGrowth: number;\n  trendDirection: 'increasing' | 'decreasing' | 'stable';\n  predictions: Array<{ date: string; predictedCount: number }>;\n} {\n  const historyResult = getDetectionHistory();\n  \n  if (!historyResult.success || !historyResult.data) {\n    return {\n      dailyDetections: [],\n      weeklyGrowth: 0,\n      monthlyGrowth: 0,\n      trendDirection: 'stable',\n      predictions: [],\n    };\n  }\n\n  const records = historyResult.data.history;\n  const now = Date.now();\n  const startTime = now - days * 24 * 60 * 60 * 1000;\n\n  // 过滤指定时间范围内的记录\n  const recentRecords = records.filter(record => record.timestamp >= startTime);\n\n  // 按天分组\n  const dailyData = new Map<string, { count: number; totalConfidence: number }>();\n\n  // 初始化所有日期\n  for (let i = 0; i < days; i++) {\n    const date = new Date(now - i * 24 * 60 * 60 * 1000);\n    const dateStr = date.toISOString().split('T')[0];\n    dailyData.set(dateStr, { count: 0, totalConfidence: 0 });\n  }\n\n  // 填充实际数据\n  recentRecords.forEach(record => {\n    const date = new Date(record.timestamp);\n    const dateStr = date.toISOString().split('T')[0];\n    const existing = dailyData.get(dateStr);\n    \n    if (existing) {\n      existing.count += 1;\n      existing.totalConfidence += record.confidence;\n    }\n  });\n\n  // 转换为数组并排序\n  const dailyDetections = Array.from(dailyData.entries())\n    .map(([date, data]) => ({\n      date,\n      count: data.count,\n      avgConfidence: data.count > 0 ? data.totalConfidence / data.count : 0,\n    }))\n    .sort((a, b) => a.date.localeCompare(b.date));\n\n  // 计算增长率\n  const weeklyGrowth = calculateGrowthRate(dailyDetections, 7);\n  const monthlyGrowth = calculateGrowthRate(dailyDetections, 30);\n\n  // 确定趋势方向\n  const trendDirection = determineTrendDirection(dailyDetections);\n\n  // 生成预测\n  const predictions = generatePredictions(dailyDetections, 3);\n\n  return {\n    dailyDetections,\n    weeklyGrowth,\n    monthlyGrowth,\n    trendDirection,\n    predictions,\n  };\n}\n\n/**\n * 计算增长率\n * Calculate growth rate\n */\nfunction calculateGrowthRate(\n  dailyData: Array<{ date: string; count: number; avgConfidence: number }>,\n  period: number\n): number {\n  if (dailyData.length < period) return 0;\n\n  const recent = dailyData.slice(-period);\n  const previous = dailyData.slice(-period * 2, -period);\n\n  if (previous.length === 0) return 0;\n\n  const recentAvg = recent.reduce((sum, day) => sum + day.count, 0) / recent.length;\n  const previousAvg = previous.reduce((sum, day) => sum + day.count, 0) / previous.length;\n\n  return previousAvg > 0 ? ((recentAvg - previousAvg) / previousAvg) * 100 : 0;\n}\n\n/**\n * 确定趋势方向\n * Determine trend direction\n */\nfunction determineTrendDirection(\n  dailyData: Array<{ date: string; count: number; avgConfidence: number }>\n): 'increasing' | 'decreasing' | 'stable' {\n  if (dailyData.length < 3) return 'stable';\n\n  const recent = dailyData.slice(-3);\n  const counts = recent.map(d => d.count);\n\n  // 简单的线性回归斜率\n  const n = counts.length;\n  const sumX = (n * (n - 1)) / 2;\n  const sumY = counts.reduce((sum, count) => sum + count, 0);\n  const sumXY = counts.reduce((sum, count, index) => sum + index * count, 0);\n  const sumX2 = (n * (n - 1) * (2 * n - 1)) / 6;\n\n  const slope = (n * sumXY - sumX * sumY) / (n * sumX2 - sumX * sumX);\n\n  if (slope > 0.1) return 'increasing';\n  if (slope < -0.1) return 'decreasing';\n  return 'stable';\n}\n\n/**\n * 生成预测\n * Generate predictions\n */\nfunction generatePredictions(\n  dailyData: Array<{ date: string; count: number; avgConfidence: number }>,\n  futureDays: number\n): Array<{ date: string; predictedCount: number }> {\n  if (dailyData.length < 3) return [];\n\n  // 使用最近7天的数据进行预测\n  const recent = dailyData.slice(-Math.min(7, dailyData.length));\n  const avgCount = recent.reduce((sum, day) => sum + day.count, 0) / recent.length;\n\n  // 简单的趋势预测\n  const trend = recent.length > 1 \n    ? (recent[recent.length - 1].count - recent[0].count) / (recent.length - 1)\n    : 0;\n\n  const predictions: Array<{ date: string; predictedCount: number }> = [];\n\n  for (let i = 1; i <= futureDays; i++) {\n    const futureDate = new Date();\n    futureDate.setDate(futureDate.getDate() + i);\n    const dateStr = futureDate.toISOString().split('T')[0];\n\n    const predictedCount = Math.max(0, Math.round(avgCount + trend * i));\n\n    predictions.push({\n      date: dateStr,\n      predictedCount,\n    });\n  }\n\n  return predictions;\n}\n\n// ==================== 洞察生成功能 ====================\n\n/**\n * 生成历史洞察\n * Generate history insights\n */\nexport function generateHistoryInsights(): {\n  insights: string[];\n  recommendations: string[];\n  alerts: string[];\n} {\n  const stats = getDetectionStats();\n  const trends = getDetectionTrends();\n  const localeStats = getLocaleGroupStats();\n  const sourceStats = getSourceGroupStats();\n\n  const insights: string[] = [];\n  const recommendations: string[] = [];\n  const alerts: string[] = [];\n\n  // 基础洞察\n  if (stats.totalDetections > 0) {\n    insights.push(`总共记录了 ${stats.totalDetections} 次语言检测`);\n    insights.push(`检测到 ${stats.uniqueLocales} 种不同的语言`);\n    insights.push(`平均置信度为 ${(stats.averageConfidence * 100).toFixed(1)}%`);\n  }\n\n  // 语言偏好洞察\n  if (stats.mostDetectedLocale) {\n    const percentage = (stats.mostDetectedLocale.count / stats.totalDetections * 100).toFixed(1);\n    insights.push(`最常检测的语言是 ${stats.mostDetectedLocale.locale} (${percentage}%)`);\n  }\n\n  // 来源分析洞察\n  if (stats.mostUsedSource) {\n    const percentage = (stats.mostUsedSource.count / stats.totalDetections * 100).toFixed(1);\n    insights.push(`最常用的检测来源是 ${stats.mostUsedSource.source} (${percentage}%)`);\n  }\n\n  // 置信度分析\n  const { high, medium, low } = stats.confidenceDistribution;\n  const highPercentage = (high / stats.totalDetections * 100).toFixed(1);\n  const lowPercentage = (low / stats.totalDetections * 100).toFixed(1);\n\n  if (high > medium + low) {\n    insights.push(`检测质量优秀，${highPercentage}% 的检测具有高置信度`);\n  } else if (low > high) {\n    alerts.push(`检测质量需要改善，${lowPercentage}% 的检测置信度较低`);\n    recommendations.push('考虑优化语言检测算法或数据源');\n  }\n\n  // 趋势分析\n  if (trends.trendDirection === 'increasing') {\n    insights.push('语言检测活动呈上升趋势');\n  } else if (trends.trendDirection === 'decreasing') {\n    insights.push('语言检测活动呈下降趋势');\n    recommendations.push('分析用户行为变化，考虑改进用户体验');\n  }\n\n  // 频率分析\n  if (stats.detectionFrequency > 10) {\n    insights.push('用户语言检测活动频繁，表明多语言需求较高');\n  } else if (stats.detectionFrequency < 1) {\n    recommendations.push('考虑增加语言检测的触发场景');\n  }\n\n  // 多样性分析\n  if (stats.uniqueLocales > 5) {\n    insights.push('用户群体语言多样性较高');\n    recommendations.push('确保所有检测到的语言都有良好的本地化支持');\n  }\n\n  // 数据质量检查\n  if (stats.totalDetections > 1000) {\n    recommendations.push('历史记录较多，建议定期清理过期数据');\n  }\n\n  if (stats.timeSpan.spanDays > 90) {\n    recommendations.push('数据跨度较长，可以进行长期趋势分析');\n  }\n\n  return {\n    insights,\n    recommendations,\n    alerts,\n  };\n}\n\n/**\n * 获取性能指标\n * Get performance metrics\n */\nexport function getPerformanceMetrics(): {\n  averageConfidence: number;\n  confidenceStability: number;\n  sourceReliability: Record<string, number>;\n  detectionAccuracy: number;\n  responseConsistency: number;\n} {\n  const historyResult = getDetectionHistory();\n  \n  if (!historyResult.success || !historyResult.data) {\n    return {\n      averageConfidence: 0,\n      confidenceStability: 0,\n      sourceReliability: {},\n      detectionAccuracy: 0,\n      responseConsistency: 0,\n    };\n  }\n\n  const records = historyResult.data.history;\n  \n  if (records.length === 0) {\n    return {\n      averageConfidence: 0,\n      confidenceStability: 0,\n      sourceReliability: {},\n      detectionAccuracy: 0,\n      responseConsistency: 0,\n    };\n  }\n\n  // 平均置信度\n  const averageConfidence = records.reduce((sum, r) => sum + r.confidence, 0) / records.length;\n\n  // 置信度稳定性（标准差的倒数）\n  const confidenceVariance = records.reduce((sum, r) => {\n    const diff = r.confidence - averageConfidence;\n    return sum + diff * diff;\n  }, 0) / records.length;\n  const confidenceStability = 1 / (1 + Math.sqrt(confidenceVariance));\n\n  // 来源可靠性\n  const sourceStats = getSourceGroupStats();\n  const sourceReliability: Record<string, number> = {};\n  sourceStats.forEach(stat => {\n    sourceReliability[stat.source] = stat.avgConfidence;\n  });\n\n  // 检测准确性（高置信度检测的比例）\n  const highConfidenceCount = records.filter(r => r.confidence > 0.8).length;\n  const detectionAccuracy = highConfidenceCount / records.length;\n\n  // 响应一致性（相同语言检测结果的一致性）\n  const localeConsistency = new Map<Locale, number[]>();\n  records.forEach(record => {\n    if (!localeConsistency.has(record.locale)) {\n      localeConsistency.set(record.locale, []);\n    }\n    localeConsistency.get(record.locale)!.push(record.confidence);\n  });\n\n  let totalConsistency = 0;\n  let localeCount = 0;\n  \n  for (const [locale, confidences] of localeConsistency.entries()) {\n    if (confidences.length > 1) {\n      const avg = confidences.reduce((sum, c) => sum + c, 0) / confidences.length;\n      const variance = confidences.reduce((sum, c) => sum + (c - avg) ** 2, 0) / confidences.length;\n      const consistency = 1 / (1 + Math.sqrt(variance));\n      totalConsistency += consistency;\n      localeCount += 1;\n    }\n  }\n\n  const responseConsistency = localeCount > 0 ? totalConsistency / localeCount : 1;\n\n  return {\n    averageConfidence,\n    confidenceStability,\n    sourceReliability,\n    detectionAccuracy,\n    responseConsistency,\n  };\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-storage-history.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'HistoryCacheManager' is defined but never used. Allowed unused vars must match /^_/u.","line":29,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":29,"endColumn":22,"suggestions":[{"messageId":"removeVar","data":{"varName":"HistoryCacheManager"},"fix":{"range":[651,674],"text":""},"desc":"Remove unused variable 'HistoryCacheManager'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'HistoryCacheManager' is defined but never used. Allowed unused vars must match /^_/u.","line":29,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":29,"endColumn":22},{"ruleId":"no-unused-vars","severity":2,"message":"'getDetectionsByTimeRange' is defined but never used. Allowed unused vars must match /^_/u.","line":37,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":37,"endColumn":27,"suggestions":[{"messageId":"removeVar","data":{"varName":"getDetectionsByTimeRange"},"fix":{"range":[818,846],"text":""},"desc":"Remove unused variable 'getDetectionsByTimeRange'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'getDetectionsByTimeRange' is defined but never used. Allowed unused vars must match /^_/u.","line":37,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":37,"endColumn":27},{"ruleId":"no-unused-vars","severity":2,"message":"'getDetectionsByConfidence' is defined but never used. Allowed unused vars must match /^_/u.","line":38,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":38,"endColumn":28,"suggestions":[{"messageId":"removeVar","data":{"varName":"getDetectionsByConfidence"},"fix":{"range":[846,875],"text":""},"desc":"Remove unused variable 'getDetectionsByConfidence'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'getDetectionsByConfidence' is defined but never used. Allowed unused vars must match /^_/u.","line":38,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":38,"endColumn":28},{"ruleId":"no-unused-vars","severity":2,"message":"'getUniqueLocales' is defined but never used. Allowed unused vars must match /^_/u.","line":41,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":41,"endColumn":19,"suggestions":[{"messageId":"removeVar","data":{"varName":"getUniqueLocales"},"fix":{"range":[914,934],"text":""},"desc":"Remove unused variable 'getUniqueLocales'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'getUniqueLocales' is defined but never used. Allowed unused vars must match /^_/u.","line":41,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":41,"endColumn":19},{"ruleId":"no-unused-vars","severity":2,"message":"'getUniqueSources' is defined but never used. Allowed unused vars must match /^_/u.","line":42,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":42,"endColumn":19,"suggestions":[{"messageId":"removeVar","data":{"varName":"getUniqueSources"},"fix":{"range":[934,954],"text":""},"desc":"Remove unused variable 'getUniqueSources'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'getUniqueSources' is defined but never used. Allowed unused vars must match /^_/u.","line":42,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":42,"endColumn":19},{"ruleId":"no-unused-vars","severity":2,"message":"'getLocaleGroupStats' is defined but never used. Allowed unused vars must match /^_/u.","line":43,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":43,"endColumn":22,"suggestions":[{"messageId":"removeVar","data":{"varName":"getLocaleGroupStats"},"fix":{"range":[954,977],"text":""},"desc":"Remove unused variable 'getLocaleGroupStats'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'getLocaleGroupStats' is defined but never used. Allowed unused vars must match /^_/u.","line":43,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":43,"endColumn":22},{"ruleId":"no-unused-vars","severity":2,"message":"'getSourceGroupStats' is defined but never used. Allowed unused vars must match /^_/u.","line":44,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":44,"endColumn":22,"suggestions":[{"messageId":"removeVar","data":{"varName":"getSourceGroupStats"},"fix":{"range":[977,1000],"text":""},"desc":"Remove unused variable 'getSourceGroupStats'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'getSourceGroupStats' is defined but never used. Allowed unused vars must match /^_/u.","line":44,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":44,"endColumn":22},{"ruleId":"no-unused-vars","severity":2,"message":"'cleanupDuplicateDetections' is defined but never used. Allowed unused vars must match /^_/u.","line":57,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":57,"endColumn":29,"suggestions":[{"messageId":"removeVar","data":{"varName":"cleanupDuplicateDetections"},"fix":{"range":[1249,1279],"text":""},"desc":"Remove unused variable 'cleanupDuplicateDetections'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'cleanupDuplicateDetections' is defined but never used. Allowed unused vars must match /^_/u.","line":57,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":57,"endColumn":29},{"ruleId":"no-unused-vars","severity":2,"message":"'limitHistorySize' is defined but never used. Allowed unused vars must match /^_/u.","line":58,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":58,"endColumn":19,"suggestions":[{"messageId":"removeVar","data":{"varName":"limitHistorySize"},"fix":{"range":[1279,1299],"text":""},"desc":"Remove unused variable 'limitHistorySize'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'limitHistorySize' is defined but never used. Allowed unused vars must match /^_/u.","line":58,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":58,"endColumn":19},{"ruleId":"no-unused-vars","severity":2,"message":"'exportHistoryAsJson' is defined but never used. Allowed unused vars must match /^_/u.","line":61,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":61,"endColumn":22,"suggestions":[{"messageId":"removeVar","data":{"varName":"exportHistoryAsJson"},"fix":{"range":[1335,1358],"text":""},"desc":"Remove unused variable 'exportHistoryAsJson'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'exportHistoryAsJson' is defined but never used. Allowed unused vars must match /^_/u.","line":61,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":61,"endColumn":22},{"ruleId":"no-unused-vars","severity":2,"message":"'importHistoryFromJson' is defined but never used. Allowed unused vars must match /^_/u.","line":63,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":63,"endColumn":24,"suggestions":[{"messageId":"removeVar","data":{"varName":"importHistoryFromJson"},"fix":{"range":[1375,1400],"text":""},"desc":"Remove unused variable 'importHistoryFromJson'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'importHistoryFromJson' is defined but never used. Allowed unused vars must match /^_/u.","line":63,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":63,"endColumn":24},{"ruleId":"no-unused-vars","severity":2,"message":"'createBackup' is defined but never used. Allowed unused vars must match /^_/u.","line":64,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":64,"endColumn":15,"suggestions":[{"messageId":"removeVar","data":{"varName":"createBackup"},"fix":{"range":[1400,1416],"text":""},"desc":"Remove unused variable 'createBackup'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'createBackup' is defined but never used. Allowed unused vars must match /^_/u.","line":64,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":64,"endColumn":15},{"ruleId":"no-unused-vars","severity":2,"message":"'restoreFromBackup' is defined but never used. Allowed unused vars must match /^_/u.","line":65,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":65,"endColumn":20,"suggestions":[{"messageId":"removeVar","data":{"varName":"restoreFromBackup"},"fix":{"range":[1416,1437],"text":""},"desc":"Remove unused variable 'restoreFromBackup'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'restoreFromBackup' is defined but never used. Allowed unused vars must match /^_/u.","line":65,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":65,"endColumn":20},{"ruleId":"no-unused-vars","severity":2,"message":"'setupDefaultListeners' is defined but never used. Allowed unused vars must match /^_/u.","line":77,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":77,"endColumn":24,"suggestions":[{"messageId":"removeVar","data":{"varName":"setupDefaultListeners"},"fix":{"range":[1682,1707],"text":""},"desc":"Remove unused variable 'setupDefaultListeners'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'setupDefaultListeners' is defined but never used. Allowed unused vars must match /^_/u.","line":77,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":77,"endColumn":24},{"ruleId":"no-unused-vars","severity":2,"message":"'cleanupEventSystem' is defined but never used. Allowed unused vars must match /^_/u.","line":78,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":78,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"cleanupEventSystem"},"fix":{"range":[1707,1729],"text":""},"desc":"Remove unused variable 'cleanupEventSystem'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'cleanupEventSystem' is defined but never used. Allowed unused vars must match /^_/u.","line":78,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":78,"endColumn":21},{"ruleId":"no-unused-vars","severity":2,"message":"'getEventSystemStatus' is defined but never used. Allowed unused vars must match /^_/u.","line":79,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":79,"endColumn":23,"suggestions":[{"messageId":"removeVar","data":{"varName":"getEventSystemStatus"},"fix":{"range":[1729,1753],"text":""},"desc":"Remove unused variable 'getEventSystemStatus'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'getEventSystemStatus' is defined but never used. Allowed unused vars must match /^_/u.","line":79,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":79,"endColumn":23},{"ruleId":"max-params","severity":2,"message":"Static method 'addDetectionRecord' has too many parameters (4). Maximum allowed is 3.","line":91,"column":3,"nodeType":"FunctionExpression","messageId":"exceed","endLine":91,"endColumn":28}],"suppressedMessages":[],"errorCount":33,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 语言检测历史管理 - 主入口\n * Locale Detection History Management - Main Entry Point\n *\n * 统一的语言检测历史管理入口，整合所有历史管理功能模块\n */\n\n'use client';\n\n// 重新导出所有模块的功能\nexport * from './locale-storage-history-core';\nexport * from './locale-storage-history-query';\nexport * from './locale-storage-history-stats';\nexport * from './locale-storage-history-maintenance';\nexport * from './locale-storage-history-events';\n\n// 导入主要功能用于向后兼容\nimport { Locale } from '@/types/i18n';\nimport type {\n  LocaleDetectionHistory,\n  LocaleDetectionRecord,\n  StorageOperationResult,\n  StorageEventListener,\n} from './locale-storage-types';\n\nimport {\n  addDetectionRecord,\n  getDetectionHistory,\n  HistoryCacheManager,\n  getHistorySummary,\n} from './locale-storage-history-core';\n\nimport {\n  getRecentDetections,\n  getDetectionsBySource,\n  getDetectionsByLocale,\n  getDetectionsByTimeRange,\n  getDetectionsByConfidence,\n  queryDetections,\n  searchDetections,\n  getUniqueLocales,\n  getUniqueSources,\n  getLocaleGroupStats,\n  getSourceGroupStats,\n  type QueryConditions,\n} from './locale-storage-history-query';\n\nimport {\n  getDetectionStats,\n  getDetectionTrends,\n  generateHistoryInsights,\n  getPerformanceMetrics,\n} from './locale-storage-history-stats';\n\nimport {\n  cleanupExpiredDetections,\n  cleanupDuplicateDetections,\n  limitHistorySize,\n  clearAllHistory,\n  exportHistory,\n  exportHistoryAsJson,\n  importHistory,\n  importHistoryFromJson,\n  createBackup,\n  restoreFromBackup,\n  performMaintenance,\n  getMaintenanceRecommendations,\n} from './locale-storage-history-maintenance';\n\nimport {\n  HistoryEventManager,\n  createRecordAddedEvent,\n  createCleanupEvent,\n  createExportEvent,\n  createImportEvent,\n  createErrorEvent,\n  setupDefaultListeners,\n  cleanupEventSystem,\n  getEventSystemStatus,\n} from './locale-storage-history-events';\n\n/**\n * 检测历史管理器 - 向后兼容类\n * Detection history manager - Backward compatible class\n */\nexport class LocaleHistoryManager {\n  /**\n   * 添加检测记录\n   * Add detection record\n   */\n  static addDetectionRecord(\n    locale: Locale,\n    source: string,\n    confidence: number,\n    metadata?: Record<string, unknown>\n  ): StorageOperationResult<LocaleDetectionHistory> {\n    const result = addDetectionRecord(locale, source, confidence, metadata);\n\n    if (result.success) {\n      HistoryEventManager.emitEvent(createRecordAddedEvent(locale, source, confidence));\n    } else {\n      HistoryEventManager.emitEvent(createErrorEvent('addDetectionRecord', result.error || 'Unknown error'));\n    }\n\n    return result;\n  }\n\n  /**\n   * 获取检测历史\n   * Get detection history\n   */\n  static getDetectionHistory(): StorageOperationResult<LocaleDetectionHistory> {\n    return getDetectionHistory();\n  }\n\n  /**\n   * 获取最近的检测记录\n   * Get recent detections\n   */\n  static getRecentDetections(limit: number = 10): LocaleDetectionRecord[] {\n    return getRecentDetections(limit);\n  }\n\n  /**\n   * 按来源获取检测记录\n   * Get detections by source\n   */\n  static getDetectionsBySource(source: string): LocaleDetectionRecord[] {\n    return getDetectionsBySource(source);\n  }\n\n  /**\n   * 按语言获取检测记录\n   * Get detections by locale\n   */\n  static getDetectionsByLocale(locale: Locale): LocaleDetectionRecord[] {\n    return getDetectionsByLocale(locale);\n  }\n\n  /**\n   * 获取检测统计信息\n   * Get detection statistics\n   */\n  static getDetectionStats(): ReturnType<typeof getDetectionStats> {\n    return getDetectionStats();\n  }\n\n  /**\n   * 清理过期的检测记录\n   * Cleanup expired detection records\n   */\n  static cleanupExpiredDetections(maxAgeMs: number = 30 * 24 * 60 * 60 * 1000): StorageOperationResult<number> {\n    const result = cleanupExpiredDetections(maxAgeMs);\n\n    if (result.success) {\n      HistoryEventManager.emitEvent(createCleanupEvent('expired', result.data || 0));\n    }\n\n    return result;\n  }\n\n  /**\n   * 清除所有历史记录\n   * Clear all history\n   */\n  static clearAllHistory(): StorageOperationResult<void> {\n    const result = clearAllHistory();\n\n    if (result.success) {\n      HistoryEventManager.emitEvent(createCleanupEvent('all', 0));\n    }\n\n    return result;\n  }\n\n  /**\n   * 导出历史记录\n   * Export history\n   */\n  static exportHistory(): StorageOperationResult<LocaleDetectionHistory> {\n    const result = exportHistory();\n\n    if (result.success && result.data) {\n      HistoryEventManager.emitEvent(createExportEvent('backup', result.data.history?.length || 0));\n    }\n\n    return result;\n  }\n\n  /**\n   * 导入历史记录\n   * Import history\n   */\n  static importHistory(history: LocaleDetectionHistory): StorageOperationResult<LocaleDetectionHistory> {\n    const result = importHistory(history);\n\n    if (result.success && result.data) {\n      HistoryEventManager.emitEvent(createImportEvent('backup', result.data.history?.length || 0, true));\n    } else {\n      HistoryEventManager.emitEvent(createImportEvent('backup', 0, false));\n    }\n\n    return result;\n  }\n\n  /**\n   * 添加事件监听器\n   * Add event listener\n   */\n  static addEventListener(eventType: string, listener: StorageEventListener): void {\n    HistoryEventManager.addEventListener(eventType, listener);\n  }\n\n  /**\n   * 移除事件监听器\n   * Remove event listener\n   */\n  static removeEventListener(eventType: string, listener: StorageEventListener): void {\n    HistoryEventManager.removeEventListener(eventType, listener);\n  }\n\n  /**\n   * 移除所有事件监听器\n   * Remove all event listeners\n   */\n  static removeAllListeners(): void {\n    HistoryEventManager.removeAllListeners();\n  }\n\n  /**\n   * 获取历史记录摘要\n   * Get history summary\n   */\n  static getHistorySummary(): ReturnType<typeof getHistorySummary> {\n    return getHistorySummary();\n  }\n\n  /**\n   * 获取维护建议\n   * Get maintenance recommendations\n   */\n  static getMaintenanceRecommendations(): ReturnType<typeof getMaintenanceRecommendations> {\n    return getMaintenanceRecommendations();\n  }\n\n  /**\n   * 执行完整的历史维护\n   * Perform complete history maintenance\n   */\n  static performMaintenance(options?: Parameters<typeof performMaintenance>[0]): ReturnType<typeof performMaintenance> {\n    return performMaintenance(options || {});\n  }\n\n  /**\n   * 查询检测记录\n   * Query detection records\n   */\n  static queryDetections(conditions: QueryConditions): ReturnType<typeof queryDetections> {\n    return queryDetections(conditions);\n  }\n\n  /**\n   * 搜索检测记录\n   * Search detection records\n   */\n  static searchDetections(searchTerm: string): LocaleDetectionRecord[] {\n    return searchDetections(searchTerm);\n  }\n\n  /**\n   * 获取检测趋势\n   * Get detection trends\n   */\n  static getDetectionTrends(days: number = 7): ReturnType<typeof getDetectionTrends> {\n    return getDetectionTrends(days);\n  }\n\n  /**\n   * 生成历史洞察\n   * Generate history insights\n   */\n  static generateHistoryInsights(): ReturnType<typeof generateHistoryInsights> {\n    return generateHistoryInsights();\n  }\n\n  /**\n   * 获取性能指标\n   * Get performance metrics\n   */\n  static getPerformanceMetrics(): ReturnType<typeof getPerformanceMetrics> {\n    return getPerformanceMetrics();\n  }\n}\n\n// ==================== 向后兼容的类型别名 ====================\n\n/**\n * 向后兼容的类型别名\n * Backward compatible type aliases\n */\nexport type {\n  LocaleHistoryManager as HistoryManager,\n  QueryConditions,\n};\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-storage-hooks.ts","messages":[{"ruleId":"consistent-return","severity":2,"message":"Arrow function expected no return value.","line":298,"column":5,"nodeType":"ReturnStatement","messageId":"unexpectedReturnValue","endLine":300,"endColumn":7},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":318,"column":82,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":318,"endColumn":85,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8006,8009],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8006,8009],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState, useEffect, useCallback } from 'react';\nimport { Locale } from '@/types/i18n';\nimport { \n  LocaleStorageManager, \n  UserLocalePreference, \n  LocaleDetectionHistory \n} from './locale-storage-manager';\n\n/**\n * React Hook: 使用语言偏好存储\n * React Hook: Use locale preference storage\n */\nexport function useLocaleStorage() {\n  const savePreference = useCallback((preference: UserLocalePreference) => {\n    LocaleStorageManager.saveUserPreference(preference);\n  }, []);\n\n  const getUserPreference = useCallback(() => {\n    return LocaleStorageManager.getUserPreference();\n  }, []);\n\n  const setUserOverride = useCallback((locale: Locale) => {\n    LocaleStorageManager.setUserOverride(locale);\n  }, []);\n\n  const getUserOverride = useCallback(() => {\n    return LocaleStorageManager.getUserOverride();\n  }, []);\n\n  const clearUserOverride = useCallback(() => {\n    LocaleStorageManager.clearUserOverride();\n  }, []);\n\n  const getStats = useCallback(() => {\n    return LocaleStorageManager.getStorageStats();\n  }, []);\n\n  return {\n    savePreference,\n    getUserPreference,\n    setUserOverride,\n    getUserOverride,\n    clearUserOverride,\n    getStats,\n  };\n}\n\n/**\n * React Hook: 响应式语言偏好状态\n * React Hook: Reactive locale preference state\n */\nexport function useLocalePreference() {\n  const [preference, setPreference] = useState<UserLocalePreference | null>(null);\n  const [override, setOverride] = useState<Locale | null>(null);\n  const [isLoading, setIsLoading] = useState(true);\n\n  // 初始化加载\n  useEffect(() => {\n    const loadPreferences = () => {\n      try {\n        const userPreference = LocaleStorageManager.getUserPreference();\n        const userOverride = LocaleStorageManager.getUserOverride();\n        \n        setPreference(userPreference);\n        setOverride(userOverride);\n      } catch (error) {\n        if (process.env.NODE_ENV === 'development') {\n          console.warn('Failed to load locale preferences:', error);\n        }\n      } finally {\n        setIsLoading(false);\n      }\n    };\n\n    loadPreferences();\n  }, []);\n\n  const updatePreference = useCallback((newPreference: UserLocalePreference) => {\n    LocaleStorageManager.saveUserPreference(newPreference);\n    setPreference(newPreference);\n  }, []);\n\n  const updateOverride = useCallback((locale: Locale) => {\n    LocaleStorageManager.setUserOverride(locale);\n    setOverride(locale);\n  }, []);\n\n  const clearOverride = useCallback(() => {\n    LocaleStorageManager.clearUserOverride();\n    setOverride(null);\n  }, []);\n\n  const currentLocale = override || preference?.locale || null;\n\n  return {\n    preference,\n    override,\n    currentLocale,\n    isLoading,\n    updatePreference,\n    updateOverride,\n    clearOverride,\n  };\n}\n\n/**\n * React Hook: 检测历史状态\n * React Hook: Detection history state\n */\nexport function useDetectionHistory() {\n  const [history, setHistory] = useState<LocaleDetectionHistory | null>(null);\n  const [isLoading, setIsLoading] = useState(true);\n\n  // 初始化加载\n  useEffect(() => {\n    const loadHistory = () => {\n      try {\n        const detectionHistory = LocaleStorageManager.getDetectionHistory();\n        setHistory(detectionHistory);\n      } catch (error) {\n        if (process.env.NODE_ENV === 'development') {\n          console.warn('Failed to load detection history:', error);\n        }\n      } finally {\n        setIsLoading(false);\n      }\n    };\n\n    loadHistory();\n  }, []);\n\n  const addDetection = useCallback((detection: {\n    locale: Locale;\n    source: string;\n    timestamp: number;\n    confidence: number;\n  }) => {\n    LocaleStorageManager.addDetectionRecord(detection);\n    \n    // 重新加载历史记录\n    const updatedHistory = LocaleStorageManager.getDetectionHistory();\n    setHistory(updatedHistory);\n  }, []);\n\n  const getRecentDetections = useCallback((limit: number = 5) => {\n    return LocaleStorageManager.getRecentDetections(limit);\n  }, []);\n\n  const cleanupExpired = useCallback((maxAgeMs?: number) => {\n    LocaleStorageManager.cleanupExpiredDetections(maxAgeMs);\n    \n    // 重新加载历史记录\n    const updatedHistory = LocaleStorageManager.getDetectionHistory();\n    setHistory(updatedHistory);\n  }, []);\n\n  return {\n    history,\n    isLoading,\n    addDetection,\n    getRecentDetections,\n    cleanupExpired,\n  };\n}\n\n/**\n * React Hook: 存储统计信息\n * React Hook: Storage statistics\n */\nexport function useStorageStats() {\n  const [stats, setStats] = useState<ReturnType<typeof LocaleStorageManager.getStorageStats> | null>(null);\n  const [isLoading, setIsLoading] = useState(true);\n\n  const refreshStats = useCallback(() => {\n    try {\n      const currentStats = LocaleStorageManager.getStorageStats();\n      setStats(currentStats);\n    } catch (error) {\n      if (process.env.NODE_ENV === 'development') {\n        console.warn('Failed to get storage stats:', error);\n      }\n    }\n  }, []);\n\n  // 初始化加载\n  useEffect(() => {\n    refreshStats();\n    setIsLoading(false);\n  }, [refreshStats]);\n\n  return {\n    stats,\n    isLoading,\n    refreshStats,\n  };\n}\n\n/**\n * React Hook: 存储数据导入导出\n * React Hook: Storage data import/export\n */\nexport function useStorageDataManager() {\n  const exportData = useCallback(() => {\n    return LocaleStorageManager.exportData();\n  }, []);\n\n  const importData = useCallback((data: Parameters<typeof LocaleStorageManager.importData>[0]) => {\n    LocaleStorageManager.importData(data);\n  }, []);\n\n  const clearAllData = useCallback(() => {\n    LocaleStorageManager.clearAll();\n  }, []);\n\n  return {\n    exportData,\n    importData,\n    clearAllData,\n  };\n}\n\n/**\n * React Hook: 存储可用性检查\n * React Hook: Storage availability check\n */\nexport function useStorageAvailability() {\n  const [isLocalStorageAvailable, setIsLocalStorageAvailable] = useState(false);\n  const [isCookieAvailable, setIsCookieAvailable] = useState(false);\n  const [isLoading, setIsLoading] = useState(true);\n\n  useEffect(() => {\n    const checkAvailability = async () => {\n      try {\n        // 动态导入以避免 SSR 问题\n        const { LocalStorageManager } = await import('./locale-storage-local');\n        const { CookieManager } = await import('./locale-storage-cookie');\n\n        setIsLocalStorageAvailable(LocalStorageManager.isAvailable());\n        setIsCookieAvailable(CookieManager.isSupported());\n      } catch (error) {\n        if (process.env.NODE_ENV === 'development') {\n          console.warn('Failed to check storage availability:', error);\n        }\n        setIsLocalStorageAvailable(false);\n        setIsCookieAvailable(false);\n      } finally {\n        setIsLoading(false);\n      }\n    };\n\n    checkAvailability();\n  }, []);\n\n  return {\n    isLocalStorageAvailable,\n    isCookieAvailable,\n    isAnyStorageAvailable: isLocalStorageAvailable || isCookieAvailable,\n    isLoading,\n  };\n}\n\n/**\n * React Hook: 自动清理过期数据\n * React Hook: Auto cleanup expired data\n */\nexport function useAutoCleanup(options: {\n  enabled?: boolean;\n  intervalMs?: number;\n  maxAgeMs?: number;\n} = {}) {\n  const {\n    enabled = true,\n    intervalMs = 60 * 60 * 1000, // 1 hour\n    maxAgeMs = 30 * 24 * 60 * 60 * 1000, // 30 days\n  } = options;\n\n  useEffect(() => {\n    if (!enabled) return;\n\n    const cleanup = () => {\n      try {\n        LocaleStorageManager.cleanupExpiredDetections(maxAgeMs);\n      } catch (error) {\n        if (process.env.NODE_ENV === 'development') {\n          console.warn('Auto cleanup failed:', error);\n        }\n      }\n    };\n\n    // 立即执行一次清理\n    cleanup();\n\n    // 设置定期清理\n    const intervalId = setInterval(cleanup, intervalMs);\n\n    return () => {\n      clearInterval(intervalId);\n    };\n  }, [enabled, intervalMs, maxAgeMs]);\n}\n\n/**\n * React Hook: 存储事件监听\n * React Hook: Storage event listener\n */\nexport function useStorageEvents() {\n  const [lastStorageEvent, setLastStorageEvent] = useState<{\n    key: string;\n    newValue: string | null;\n    oldValue: string | null;\n    timestamp: number;\n  } | null>(null);\n\n  useEffect(() => {\n    const handleStorageChange = (event: StorageEvent) => {\n      if (event.key && Object.values(LocaleStorageManager).includes(event.key as any)) {\n        setLastStorageEvent({\n          key: event.key,\n          newValue: event.newValue,\n          oldValue: event.oldValue,\n          timestamp: Date.now(),\n        });\n      }\n    };\n\n    window.addEventListener('storage', handleStorageChange);\n\n    return () => {\n      window.removeEventListener('storage', handleStorageChange);\n    };\n  }, []);\n\n  return {\n    lastStorageEvent,\n  };\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-storage-local.ts","messages":[{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (4). Maximum allowed is 3.","line":88,"column":11,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":90,"endColumn":12},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":89,"column":13,"nodeType":"MemberExpression","endLine":89,"endColumn":23},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (4). Maximum allowed is 3.","line":131,"column":11,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":133,"endColumn":12},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":258,"column":7,"nodeType":"MemberExpression","endLine":258,"endColumn":18},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (4). Maximum allowed is 3.","line":288,"column":11,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":290,"endColumn":12},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":289,"column":13,"nodeType":"MemberExpression","endLine":289,"endColumn":23}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\n/**\n * LocalStorage 操作工具类\n * LocalStorage management utility class\n */\nexport class LocalStorageManager {\n  /**\n   * 设置 LocalStorage 项\n   * Set item in localStorage\n   */\n  static set(key: string, value: unknown): void {\n    if (typeof window === 'undefined') return;\n    try {\n      localStorage.setItem(key, JSON.stringify(value));\n    } catch {\n      // 静默处理localStorage错误，避免在生产环境中输出日志\n      if (process.env.NODE_ENV === 'development') {\n        // 在开发环境中可以使用调试器或其他日志方案\n        // console.warn('Failed to save to localStorage:', error);\n      }\n    }\n  }\n\n  /**\n   * 获取 LocalStorage 项\n   * Get item from localStorage\n   */\n  static get<T>(key: string): T | null {\n    if (typeof window === 'undefined') return null;\n    try {\n      const item = localStorage.getItem(key);\n      return item ? JSON.parse(item) : null;\n    } catch {\n      // 静默处理localStorage错误，避免在生产环境中输出日志\n      if (process.env.NODE_ENV === 'development') {\n        // 在开发环境中可以使用调试器或其他日志方案\n        // console.warn('Failed to read from localStorage:', error);\n      }\n      return null;\n    }\n  }\n\n  /**\n   * 删除 LocalStorage 项\n   * Remove item from localStorage\n   */\n  static remove(key: string): void {\n    if (typeof window === 'undefined') return;\n    try {\n      localStorage.removeItem(key);\n    } catch {\n      // 静默处理localStorage错误，避免在生产环境中输出日志\n      if (process.env.NODE_ENV === 'development') {\n        // 在开发环境中可以使用调试器或其他日志方案\n        // console.warn('Failed to remove from localStorage:', error);\n      }\n    }\n  }\n\n  /**\n   * 检查 LocalStorage 项是否存在\n   * Check if item exists in localStorage\n   */\n  static exists(key: string): boolean {\n    if (typeof window === 'undefined') return false;\n    try {\n      return localStorage.getItem(key) !== null;\n    } catch {\n      return false;\n    }\n  }\n\n  /**\n   * 获取所有 LocalStorage 项\n   * Get all localStorage items\n   */\n  static getAll(): Record<string, unknown> {\n    if (typeof window === 'undefined') return {};\n    \n    const items: Record<string, unknown> = {};\n    \n    try {\n      for (let i = 0; i < localStorage.length; i++) {\n        const key = localStorage.key(i);\n        if (key) {\n          const value = this.get(key);\n          if (value !== null) {\n            items[key] = value;\n          }\n        }\n      }\n    } catch {\n      if (process.env.NODE_ENV === 'development') {\n        // console.warn('Failed to get all localStorage items:', error);\n      }\n    }\n    \n    return items;\n  }\n\n  /**\n   * 清除所有 LocalStorage 项\n   * Clear all localStorage items\n   */\n  static clear(): void {\n    if (typeof window === 'undefined') return;\n    try {\n      localStorage.clear();\n    } catch {\n      if (process.env.NODE_ENV === 'development') {\n        // console.warn('Failed to clear localStorage:', error);\n      }\n    }\n  }\n\n  /**\n   * 获取 LocalStorage 使用的存储空间大小\n   * Get localStorage usage size in bytes\n   */\n  static getUsageSize(): number {\n    if (typeof window === 'undefined') return 0;\n    \n    let totalSize = 0;\n    \n    try {\n      for (let i = 0; i < localStorage.length; i++) {\n        const key = localStorage.key(i);\n        if (key) {\n          const value = localStorage.getItem(key);\n          if (value) {\n            totalSize += new Blob([key + value]).size;\n          }\n        }\n      }\n    } catch {\n      if (process.env.NODE_ENV === 'development') {\n        // console.warn('Failed to calculate localStorage usage:', error);\n      }\n    }\n    \n    return totalSize;\n  }\n\n  /**\n   * 获取特定项的大小\n   * Get size of specific item in bytes\n   */\n  static getItemSize(key: string): number {\n    if (typeof window === 'undefined') return 0;\n    \n    try {\n      const value = localStorage.getItem(key);\n      if (!value) return 0;\n      \n      return new Blob([key + value]).size;\n    } catch {\n      return 0;\n    }\n  }\n\n  /**\n   * 检查 LocalStorage 是否可用\n   * Check if localStorage is available\n   */\n  static isAvailable(): boolean {\n    if (typeof window === 'undefined') return false;\n    \n    try {\n      const testKey = '__localStorage_test__';\n      const testValue = 'test';\n      \n      localStorage.setItem(testKey, testValue);\n      const retrieved = localStorage.getItem(testKey);\n      localStorage.removeItem(testKey);\n      \n      return retrieved === testValue;\n    } catch {\n      return false;\n    }\n  }\n\n  /**\n   * 获取 LocalStorage 剩余空间（估算）\n   * Get estimated remaining localStorage space\n   */\n  static getRemainingSpace(): number {\n    if (!this.isAvailable()) return 0;\n    \n    const maxSize = 5 * 1024 * 1024; // 5MB 估算限制\n    const usedSize = this.getUsageSize();\n    \n    return Math.max(0, maxSize - usedSize);\n  }\n\n  /**\n   * 检查是否接近存储限制\n   * Check if approaching storage limit\n   */\n  static isNearLimit(threshold: number = 0.8): boolean {\n    if (!this.isAvailable()) return true;\n    \n    const maxSize = 5 * 1024 * 1024; // 5MB 估算限制\n    const usedSize = this.getUsageSize();\n    \n    return usedSize / maxSize > threshold;\n  }\n\n  /**\n   * 设置带有过期时间的项\n   * Set item with expiration time\n   */\n  static setWithExpiry(key: string, value: unknown, expiryMs: number): void {\n    const item = {\n      value,\n      expiry: Date.now() + expiryMs,\n    };\n    \n    this.set(key, item);\n  }\n\n  /**\n   * 获取带有过期时间检查的项\n   * Get item with expiry check\n   */\n  static getWithExpiry<T>(key: string): T | null {\n    const item = this.get<{ value: T; expiry: number }>(key);\n    \n    if (!item) return null;\n    \n    // 检查是否过期\n    if (Date.now() > item.expiry) {\n      this.remove(key);\n      return null;\n    }\n    \n    return item.value;\n  }\n\n  /**\n   * 批量设置多个项\n   * Set multiple items in batch\n   */\n  static setMultiple(items: Record<string, unknown>): void {\n    Object.entries(items).forEach(([key, value]) => {\n      this.set(key, value);\n    });\n  }\n\n  /**\n   * 批量获取多个项\n   * Get multiple items in batch\n   */\n  static getMultiple<T>(keys: string[]): Record<string, T | null> {\n    const result: Record<string, T | null> = {};\n    \n    keys.forEach((key) => {\n      result[key] = this.get<T>(key);\n    });\n    \n    return result;\n  }\n\n  /**\n   * 批量删除多个项\n   * Remove multiple items in batch\n   */\n  static removeMultiple(keys: string[]): void {\n    keys.forEach((key) => {\n      this.remove(key);\n    });\n  }\n\n  /**\n   * 按前缀获取项\n   * Get items by key prefix\n   */\n  static getByPrefix<T>(prefix: string): Record<string, T> {\n    const items: Record<string, T> = {};\n    \n    if (typeof window === 'undefined') return items;\n    \n    try {\n      for (let i = 0; i < localStorage.length; i++) {\n        const key = localStorage.key(i);\n        if (key && key.startsWith(prefix)) {\n          const value = this.get<T>(key);\n          if (value !== null) {\n            items[key] = value;\n          }\n        }\n      }\n    } catch {\n      if (process.env.NODE_ENV === 'development') {\n        // console.warn('Failed to get items by prefix:', error);\n      }\n    }\n    \n    return items;\n  }\n\n  /**\n   * 按前缀删除项\n   * Remove items by key prefix\n   */\n  static removeByPrefix(prefix: string): void {\n    if (typeof window === 'undefined') return;\n    \n    const keysToRemove: string[] = [];\n    \n    try {\n      for (let i = 0; i < localStorage.length; i++) {\n        const key = localStorage.key(i);\n        if (key && key.startsWith(prefix)) {\n          keysToRemove.push(key);\n        }\n      }\n      \n      keysToRemove.forEach((key) => {\n        this.remove(key);\n      });\n    } catch {\n      if (process.env.NODE_ENV === 'development') {\n        // console.warn('Failed to remove items by prefix:', error);\n      }\n    }\n  }\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-storage-maintenance-cleanup.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'Locale' is defined but never used. Allowed unused vars must match /^_/u.","line":12,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"Locale"},"fix":{"range":[137,175],"text":""},"desc":"Remove unused variable 'Locale'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Locale' is defined but never used. Allowed unused vars must match /^_/u.","line":12,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":12,"endColumn":16},{"ruleId":"security/detect-object-injection","severity":2,"message":"Variable Assigned to Object Injection Sink","line":126,"column":19,"nodeType":"MemberExpression","endLine":126,"endColumn":41},{"ruleId":"max-statements","severity":2,"message":"Static method 'cleanupInvalidPreferences' has too many statements (21). Maximum allowed is 20.","line":152,"column":35,"nodeType":"FunctionExpression","messageId":"exceed","endLine":199,"endColumn":4},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (4). Maximum allowed is 3.","line":173,"column":11,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":177,"endColumn":12},{"ruleId":"max-statements","severity":2,"message":"Static method 'getCleanupStats' has too many statements (25). Maximum allowed is 20.","line":293,"column":25,"nodeType":"FunctionExpression","messageId":"exceed","endLine":363,"endColumn":4},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (4). Maximum allowed is 3.","line":346,"column":11,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":348,"endColumn":12}],"suppressedMessages":[],"errorCount":7,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 语言存储清理操作\n * Locale Storage Cleanup Operations\n * \n * 负责存储数据的清理和过期数据处理\n */\n\n'use client';\n\nimport { logger } from '@/lib/logger';\n\nimport { Locale } from '@/types/i18n';\nimport { CookieManager } from './locale-storage-cookie';\nimport { LocalStorageManager } from './locale-storage-local';\nimport type {\n  UserLocalePreference,\n  LocaleDetectionHistory,\n  STORAGE_KEYS,\n  StorageOperationResult,\n} from './locale-storage-types';\n\n/**\n * 语言存储清理管理器\n * Locale storage cleanup manager\n */\nexport class LocaleCleanupManager {\n  /**\n   * 清除所有存储数据\n   * Clear all storage data\n   */\n  static clearAll(): StorageOperationResult {\n    try {\n      // 清除 Cookies\n      Object.values(STORAGE_KEYS).forEach((key) => {\n        CookieManager.remove(key);\n      });\n\n      // 清除 localStorage\n      Object.values(STORAGE_KEYS).forEach((key) => {\n        LocalStorageManager.remove(key);\n      });\n\n      return {\n        success: true,\n        message: '所有存储数据已清除',\n        timestamp: Date.now(),\n      };\n    } catch (error) {\n      return {\n        success: false,\n        message: `清除存储数据失败: ${error instanceof Error ? error.message : '未知错误'}`,\n        timestamp: Date.now(),\n        error: error instanceof Error ? error : new Error('Unknown error'),\n      };\n    }\n  }\n\n  /**\n   * 清理过期的检测记录\n   * Clean up expired detection records\n   */\n  static cleanupExpiredDetections(\n    maxAgeMs: number = 30 * 24 * 60 * 60 * 1000\n  ): StorageOperationResult {\n    try {\n      const historyData = LocalStorageManager.get<LocaleDetectionHistory>(\n        STORAGE_KEYS.LOCALE_DETECTION_HISTORY\n      );\n\n      if (!historyData || !Array.isArray(historyData.detections)) {\n        return {\n          success: true,\n          message: '没有检测历史数据需要清理',\n          timestamp: Date.now(),\n        };\n      }\n\n      const now = Date.now();\n      const originalCount = historyData.detections.length;\n      \n      // 过滤掉过期的检测记录\n      const validDetections = historyData.detections.filter(\n        (detection) => now - detection.timestamp <= maxAgeMs\n      );\n\n      const cleanedCount = originalCount - validDetections.length;\n\n      if (cleanedCount > 0) {\n        const updatedHistory: LocaleDetectionHistory = {\n          detections: validDetections,\n          lastUpdated: now,\n        };\n\n        LocalStorageManager.set(STORAGE_KEYS.LOCALE_DETECTION_HISTORY, updatedHistory);\n\n        return {\n          success: true,\n          message: `已清理 ${cleanedCount} 条过期检测记录`,\n          timestamp: Date.now(),\n          data: { cleanedCount, remainingCount: validDetections.length },\n        };\n      }\n\n      return {\n        success: true,\n        message: '没有过期的检测记录需要清理',\n        timestamp: Date.now(),\n        data: { cleanedCount: 0, remainingCount: originalCount },\n      };\n    } catch (error) {\n      return {\n        success: false,\n        message: `清理过期检测记录失败: ${error instanceof Error ? error.message : '未知错误'}`,\n        timestamp: Date.now(),\n        error: error instanceof Error ? error : new Error('Unknown error'),\n      };\n    }\n  }\n\n  /**\n   * 清理特定类型的存储数据\n   * Clean up specific type of storage data\n   */\n  static clearSpecificData(dataType: keyof typeof STORAGE_KEYS): StorageOperationResult {\n    try {\n      const key = STORAGE_KEYS[dataType];\n      \n      // 从两个存储中移除\n      CookieManager.remove(key);\n      LocalStorageManager.remove(key);\n\n      return {\n        success: true,\n        message: `已清除 ${dataType} 数据`,\n        timestamp: Date.now(),\n        data: { dataType, key },\n      };\n    } catch (error) {\n      return {\n        success: false,\n        message: `清除 ${dataType} 数据失败: ${error instanceof Error ? error.message : '未知错误'}`,\n        timestamp: Date.now(),\n        error: error instanceof Error ? error : new Error('Unknown error'),\n      };\n    }\n  }\n\n  /**\n   * 清理无效的用户偏好数据\n   * Clean up invalid user preference data\n   */\n  static cleanupInvalidPreferences(): StorageOperationResult {\n    try {\n      let cleanedItems = 0;\n      const issues: string[] = [];\n\n      // 检查并清理localStorage中的偏好数据\n      const localPreference = LocalStorageManager.get<UserLocalePreference>(\n        STORAGE_KEYS.LOCALE_PREFERENCE\n      );\n\n      if (localPreference && !this.isValidPreferenceData(localPreference)) {\n        LocalStorageManager.remove(STORAGE_KEYS.LOCALE_PREFERENCE);\n        cleanedItems += 1;\n        issues.push('已清理localStorage中的无效偏好数据');\n      }\n\n      // 检查并清理Cookie中的偏好数据\n      const cookiePreference = CookieManager.get(STORAGE_KEYS.LOCALE_PREFERENCE);\n      if (cookiePreference) {\n        try {\n          const parsed = JSON.parse(cookiePreference) as UserLocalePreference;\n          if (!this.isValidPreferenceData(parsed)) {\n            CookieManager.remove(STORAGE_KEYS.LOCALE_PREFERENCE);\n            cleanedItems += 1;\n            issues.push('已清理Cookie中的无效偏好数据');\n          }\n        } catch {\n          CookieManager.remove(STORAGE_KEYS.LOCALE_PREFERENCE);\n          cleanedItems += 1;\n          issues.push('已清理Cookie中的格式错误偏好数据');\n        }\n      }\n\n      return {\n        success: true,\n        message: cleanedItems > 0 ? `已清理 ${cleanedItems} 项无效偏好数据` : '没有无效偏好数据需要清理',\n        timestamp: Date.now(),\n        data: { cleanedItems, issues },\n      };\n    } catch (error) {\n      return {\n        success: false,\n        message: `清理无效偏好数据失败: ${error instanceof Error ? error.message : '未知错误'}`,\n        timestamp: Date.now(),\n        error: error instanceof Error ? error : new Error('Unknown error'),\n      };\n    }\n  }\n\n  /**\n   * 清理重复的检测记录\n   * Clean up duplicate detection records\n   */\n  static cleanupDuplicateDetections(): StorageOperationResult {\n    try {\n      const historyData = LocalStorageManager.get<LocaleDetectionHistory>(\n        STORAGE_KEYS.LOCALE_DETECTION_HISTORY\n      );\n\n      if (!historyData || !Array.isArray(historyData.detections)) {\n        return {\n          success: true,\n          message: '没有检测历史数据需要去重',\n          timestamp: Date.now(),\n        };\n      }\n\n      const originalCount = historyData.detections.length;\n      const seen = new Set<string>();\n      const uniqueDetections = historyData.detections.filter((detection) => {\n        const key = `${detection.locale}-${detection.source}-${Math.floor(detection.timestamp / 60000)}`; // 按分钟分组\n        if (seen.has(key)) {\n          return false;\n        }\n        seen.add(key);\n        return true;\n      });\n\n      const duplicateCount = originalCount - uniqueDetections.length;\n\n      if (duplicateCount > 0) {\n        const updatedHistory: LocaleDetectionHistory = {\n          detections: uniqueDetections,\n          lastUpdated: Date.now(),\n        };\n\n        LocalStorageManager.set(STORAGE_KEYS.LOCALE_DETECTION_HISTORY, updatedHistory);\n\n        return {\n          success: true,\n          message: `已清理 ${duplicateCount} 条重复检测记录`,\n          timestamp: Date.now(),\n          data: { duplicateCount, remainingCount: uniqueDetections.length },\n        };\n      }\n\n      return {\n        success: true,\n        message: '没有重复的检测记录需要清理',\n        timestamp: Date.now(),\n        data: { duplicateCount: 0, remainingCount: originalCount },\n      };\n    } catch (error) {\n      return {\n        success: false,\n        message: `清理重复检测记录失败: ${error instanceof Error ? error.message : '未知错误'}`,\n        timestamp: Date.now(),\n        error: error instanceof Error ? error : new Error('Unknown error'),\n      };\n    }\n  }\n\n  /**\n   * 验证偏好数据是否有效\n   * Validate if preference data is valid\n   */\n  private static isValidPreferenceData(preference: UserLocalePreference): boolean {\n    if (!preference || typeof preference !== 'object') return false;\n    \n    const requiredFields = ['locale', 'source', 'timestamp', 'confidence'];\n    const hasAllFields = requiredFields.every(field => field in preference);\n    \n    if (!hasAllFields) return false;\n    \n    // 验证字段类型\n    if (typeof preference.locale !== 'string') return false;\n    if (typeof preference.source !== 'string') return false;\n    if (typeof preference.timestamp !== 'number') return false;\n    if (typeof preference.confidence !== 'number') return false;\n    \n    // 验证值的合理性\n    if (preference.confidence < 0 || preference.confidence > 1) return false;\n    if (preference.timestamp > Date.now() || preference.timestamp < 0) return false;\n    \n    return true;\n  }\n\n  /**\n   * 获取清理统计信息\n   * Get cleanup statistics\n   */\n  static getCleanupStats(): {\n    totalItems: number;\n    expiredDetections: number;\n    invalidPreferences: number;\n    duplicateDetections: number;\n  } {\n    let totalItems = 0;\n    let expiredDetections = 0;\n    let invalidPreferences = 0;\n    let duplicateDetections = 0;\n\n    try {\n      // 统计总项目数\n      Object.values(STORAGE_KEYS).forEach((key) => {\n        if (LocalStorageManager.get(key) !== null) totalItems += 1;\n        if (CookieManager.get(key) !== null) totalItems += 1;\n      });\n\n      // 统计过期检测记录\n      const historyData = LocalStorageManager.get<LocaleDetectionHistory>(\n        STORAGE_KEYS.LOCALE_DETECTION_HISTORY\n      );\n      if (historyData?.detections) {\n        const now = Date.now();\n        const maxAge = 30 * 24 * 60 * 60 * 1000; // 30天\n        expiredDetections = historyData.detections.filter(\n          (detection) => now - detection.timestamp > maxAge\n        ).length;\n\n        // 统计重复检测记录\n        const seen = new Set<string>();\n        historyData.detections.forEach((detection) => {\n          const key = `${detection.locale}-${detection.source}-${Math.floor(detection.timestamp / 60000)}`;\n          if (seen.has(key)) {\n            duplicateDetections += 1;\n          } else {\n            seen.add(key);\n          }\n        });\n      }\n\n      // 统计无效偏好数据\n      const localPreference = LocalStorageManager.get<UserLocalePreference>(\n        STORAGE_KEYS.LOCALE_PREFERENCE\n      );\n      if (localPreference && !this.isValidPreferenceData(localPreference)) {\n        invalidPreferences += 1;\n      }\n\n      const cookiePreference = CookieManager.get(STORAGE_KEYS.LOCALE_PREFERENCE);\n      if (cookiePreference) {\n        try {\n          const parsed = JSON.parse(cookiePreference) as UserLocalePreference;\n          if (!this.isValidPreferenceData(parsed)) {\n            invalidPreferences += 1;\n          }\n        } catch {\n          invalidPreferences += 1;\n        }\n      }\n    } catch (error) {\n      logger.warn('获取清理统计信息时出错', { error: error as Error });\n    }\n\n    return {\n      totalItems,\n      expiredDetections,\n      invalidPreferences,\n      duplicateDetections,\n    };\n  }\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-storage-maintenance-import-export.ts","messages":[{"ruleId":"max-statements","severity":2,"message":"Static method 'importData' has too many statements (24). Maximum allowed is 20.","line":57,"column":20,"nodeType":"FunctionExpression","messageId":"exceed","endLine":119,"endColumn":4},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (4). Maximum allowed is 3.","line":234,"column":11,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":255,"endColumn":12},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (5). Maximum allowed is 3.","line":235,"column":13,"nodeType":"TryStatement","messageId":"tooDeeply","endLine":254,"endColumn":14},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (6). Maximum allowed is 3.","line":237,"column":15,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":245,"endColumn":16},{"ruleId":"no-undef","severity":2,"message":"'logger' is not defined.","line":259,"column":7,"nodeType":"Identifier","messageId":"undef","endLine":259,"endColumn":13},{"ruleId":"no-implicit-coercion","severity":2,"message":"Unexpected implicit coercion encountered. Use `Boolean(preference)` instead.","line":432,"column":22,"nodeType":"UnaryExpression","messageId":"implicitCoercion","endLine":432,"endColumn":34,"fix":{"range":[11463,11475],"text":"Boolean(preference)"}},{"ruleId":"no-implicit-coercion","severity":2,"message":"Unexpected implicit coercion encountered. Use `Boolean(override)` instead.","line":433,"column":20,"nodeType":"UnaryExpression","messageId":"implicitCoercion","endLine":433,"endColumn":30,"fix":{"range":[11496,11506],"text":"Boolean(override)"}},{"ruleId":"no-implicit-coercion","severity":2,"message":"Unexpected implicit coercion encountered. Use `Boolean(history)` instead.","line":434,"column":19,"nodeType":"UnaryExpression","messageId":"implicitCoercion","endLine":434,"endColumn":28,"fix":{"range":[11526,11535],"text":"Boolean(history)"}}],"suppressedMessages":[],"errorCount":8,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":3,"fixableWarningCount":0,"source":"/**\n * 语言存储导入导出操作\n * Locale Storage Import/Export Operations\n * \n * 负责存储数据的导入、导出和备份恢复\n */\n\n'use client';\n\nimport { Locale } from '@/types/i18n';\nimport { CookieManager } from './locale-storage-cookie';\nimport { LocalStorageManager } from './locale-storage-local';\nimport { LocaleValidationManager } from './locale-storage-maintenance-validation';\nimport type {\n  UserLocalePreference,\n  LocaleDetectionHistory,\n  STORAGE_KEYS,\n  StorageOperationResult,\n  ExportData,\n  ImportData,\n} from './locale-storage-types';\n\n/**\n * 语言存储导入导出管理器\n * Locale storage import/export manager\n */\nexport class LocaleImportExportManager {\n  /**\n   * 导出所有存储数据\n   * Export all storage data\n   */\n  static exportData(): ExportData {\n    return {\n      preference: LocalStorageManager.get<UserLocalePreference>(\n        STORAGE_KEYS.LOCALE_PREFERENCE\n      ),\n      override: LocalStorageManager.get<Locale>(\n        STORAGE_KEYS.USER_LOCALE_OVERRIDE\n      ),\n      history: LocalStorageManager.get<LocaleDetectionHistory>(\n        STORAGE_KEYS.LOCALE_DETECTION_HISTORY\n      ),\n      version: '1.0.0',\n      timestamp: Date.now(),\n      metadata: {\n        userAgent: typeof navigator !== 'undefined' ? navigator.userAgent : 'Unknown',\n        exportedBy: 'LocaleMaintenanceManager',\n        dataIntegrity: this.calculateDataChecksum(),\n      },\n    };\n  }\n\n  /**\n   * 导入存储数据\n   * Import storage data\n   */\n  static importData(data: ImportData): StorageOperationResult {\n    try {\n      let importedItems = 0;\n      const errors: string[] = [];\n\n      // 验证导入数据版本\n      if (data.version && data.version !== '1.0.0') {\n        return {\n          success: false,\n          message: `不支持的数据版本: ${data.version}`,\n          timestamp: Date.now(),\n        };\n      }\n\n      // 导入用户偏好数据\n      if (data.preference) {\n        if (LocaleValidationManager.validatePreferenceData(data.preference)) {\n          LocalStorageManager.set(STORAGE_KEYS.LOCALE_PREFERENCE, data.preference);\n          CookieManager.set(STORAGE_KEYS.LOCALE_PREFERENCE, JSON.stringify(data.preference));\n          importedItems += 1;\n        } else {\n          errors.push('用户偏好数据格式无效');\n        }\n      }\n\n      // 导入用户覆盖设置\n      if (data.override) {\n        if (typeof data.override === 'string') {\n          LocalStorageManager.set(STORAGE_KEYS.USER_LOCALE_OVERRIDE, data.override);\n          CookieManager.set(STORAGE_KEYS.USER_LOCALE_OVERRIDE, data.override);\n          importedItems += 1;\n        } else {\n          errors.push('用户覆盖设置格式无效');\n        }\n      }\n\n      // 导入检测历史数据\n      if (data.history) {\n        if (LocaleValidationManager.validateHistoryData(data.history)) {\n          LocalStorageManager.set(STORAGE_KEYS.LOCALE_DETECTION_HISTORY, data.history);\n          importedItems += 1;\n        } else {\n          errors.push('检测历史数据格式无效');\n        }\n      }\n\n      return {\n        success: errors.length === 0,\n        message: errors.length === 0 \n          ? `成功导入 ${importedItems} 项数据` \n          : `导入完成，但有 ${errors.length} 个错误`,\n        timestamp: Date.now(),\n        data: { importedItems, errors },\n      };\n    } catch (error) {\n      return {\n        success: false,\n        message: `导入数据失败: ${error instanceof Error ? error.message : '未知错误'}`,\n        timestamp: Date.now(),\n        error: error instanceof Error ? error : new Error('Unknown error'),\n      };\n    }\n  }\n\n  /**\n   * 导出为JSON字符串\n   * Export as JSON string\n   */\n  static exportAsJson(): string {\n    const data = this.exportData();\n    return JSON.stringify(data, null, 2);\n  }\n\n  /**\n   * 从JSON字符串导入\n   * Import from JSON string\n   */\n  static importFromJson(jsonString: string): StorageOperationResult {\n    try {\n      const data = JSON.parse(jsonString) as ImportData;\n      return this.importData(data);\n    } catch (error) {\n      return {\n        success: false,\n        message: `JSON解析失败: ${error instanceof Error ? error.message : '未知错误'}`,\n        timestamp: Date.now(),\n        error: error instanceof Error ? error : new Error('JSON parse error'),\n      };\n    }\n  }\n\n  /**\n   * 创建备份\n   * Create backup\n   */\n  static createBackup(): StorageOperationResult {\n    try {\n      const exportData = this.exportData();\n      const backupKey = `locale_backup_${Date.now()}`;\n      \n      // 将备份存储到localStorage（使用特殊前缀）\n      LocalStorageManager.set(backupKey, exportData);\n\n      return {\n        success: true,\n        message: '备份创建成功',\n        timestamp: Date.now(),\n        data: { backupKey, backupData: exportData },\n      };\n    } catch (error) {\n      return {\n        success: false,\n        message: `创建备份失败: ${error instanceof Error ? error.message : '未知错误'}`,\n        timestamp: Date.now(),\n        error: error instanceof Error ? error : new Error('Unknown error'),\n      };\n    }\n  }\n\n  /**\n   * 恢复备份\n   * Restore backup\n   */\n  static restoreBackup(backupKey: string): StorageOperationResult {\n    try {\n      const backupData = LocalStorageManager.get<ExportData>(backupKey);\n      \n      if (!backupData) {\n        return {\n          success: false,\n          message: '备份数据不存在',\n          timestamp: Date.now(),\n        };\n      }\n\n      const importResult = this.importData(backupData);\n      if (importResult.success) {\n        return {\n          success: true,\n          message: '备份恢复成功',\n          timestamp: Date.now(),\n          data: importResult.data,\n        };\n      }\n      return importResult;\n    } catch (error) {\n      return {\n        success: false,\n        message: `恢复备份失败: ${error instanceof Error ? error.message : '未知错误'}`,\n        timestamp: Date.now(),\n        error: error instanceof Error ? error : new Error('Unknown error'),\n      };\n    }\n  }\n\n  /**\n   * 列出所有备份\n   * List all backups\n   */\n  static listBackups(): Array<{\n    key: string;\n    timestamp: number;\n    size: number;\n    isValid: boolean;\n  }> {\n    const backups: Array<{\n      key: string;\n      timestamp: number;\n      size: number;\n      isValid: boolean;\n    }> = [];\n\n    try {\n      // 遍历localStorage查找备份\n      if (typeof localStorage !== 'undefined') {\n        for (let i = 0; i < localStorage.length; i++) {\n          const key = localStorage.key(i);\n          if (key && key.startsWith('locale_backup_')) {\n            try {\n              const data = localStorage.getItem(key);\n              if (data) {\n                const parsed = JSON.parse(data) as ExportData;\n                backups.push({\n                  key,\n                  timestamp: parsed.timestamp || 0,\n                  size: data.length,\n                  isValid: this.validateExportData(parsed),\n                });\n              }\n            } catch {\n              // 忽略无效的备份数据\n              backups.push({\n                key,\n                timestamp: 0,\n                size: 0,\n                isValid: false,\n              });\n            }\n          }\n        }\n      }\n    } catch (error) {\n      logger.warn('列出备份时出错', { error: error as Error });\n    }\n\n    // 按时间戳排序（最新的在前）\n    return backups.sort((a, b) => b.timestamp - a.timestamp);\n  }\n\n  /**\n   * 删除备份\n   * Delete backup\n   */\n  static deleteBackup(backupKey: string): StorageOperationResult {\n    try {\n      if (!backupKey.startsWith('locale_backup_')) {\n        return {\n          success: false,\n          message: '无效的备份键名',\n          timestamp: Date.now(),\n        };\n      }\n\n      LocalStorageManager.remove(backupKey);\n\n      return {\n        success: true,\n        message: '备份删除成功',\n        timestamp: Date.now(),\n        data: { deletedKey: backupKey },\n      };\n    } catch (error) {\n      return {\n        success: false,\n        message: `删除备份失败: ${error instanceof Error ? error.message : '未知错误'}`,\n        timestamp: Date.now(),\n        error: error instanceof Error ? error : new Error('Unknown error'),\n      };\n    }\n  }\n\n  /**\n   * 清理旧备份\n   * Clean up old backups\n   */\n  static cleanupOldBackups(maxBackups: number = 5): StorageOperationResult {\n    try {\n      const backups = this.listBackups();\n      \n      if (backups.length <= maxBackups) {\n        return {\n          success: true,\n          message: '没有需要清理的旧备份',\n          timestamp: Date.now(),\n          data: { totalBackups: backups.length, maxBackups },\n        };\n      }\n\n      const backupsToDelete = backups.slice(maxBackups);\n      let deletedCount = 0;\n\n      backupsToDelete.forEach((backup) => {\n        try {\n          LocalStorageManager.remove(backup.key);\n          deletedCount += 1;\n        } catch {\n          // 忽略删除失败的备份\n        }\n      });\n\n      return {\n        success: true,\n        message: `已清理 ${deletedCount} 个旧备份`,\n        timestamp: Date.now(),\n        data: { deletedCount, remainingBackups: backups.length - deletedCount },\n      };\n    } catch (error) {\n      return {\n        success: false,\n        message: `清理旧备份失败: ${error instanceof Error ? error.message : '未知错误'}`,\n        timestamp: Date.now(),\n        error: error instanceof Error ? error : new Error('Unknown error'),\n      };\n    }\n  }\n\n  /**\n   * 验证导出数据\n   * Validate export data\n   */\n  private static validateExportData(data: ExportData): boolean {\n    try {\n      // 检查基本结构\n      if (!data || typeof data !== 'object') return false;\n      if (typeof data.timestamp !== 'number') return false;\n\n      // 验证偏好数据（如果存在）\n      if (data.preference && !LocaleValidationManager.validatePreferenceData(data.preference)) {\n        return false;\n      }\n\n      // 验证历史数据（如果存在）\n      if (data.history && !LocaleValidationManager.validateHistoryData(data.history)) {\n        return false;\n      }\n\n      // 验证覆盖设置（如果存在）\n      if (data.override && typeof data.override !== 'string') {\n        return false;\n      }\n\n      return true;\n    } catch {\n      return false;\n    }\n  }\n\n  /**\n   * 计算数据校验和\n   * Calculate data checksum\n   */\n  private static calculateDataChecksum(): string {\n    try {\n      const preference = LocalStorageManager.get(STORAGE_KEYS.LOCALE_PREFERENCE);\n      const override = LocalStorageManager.get(STORAGE_KEYS.USER_LOCALE_OVERRIDE);\n      const history = LocalStorageManager.get(STORAGE_KEYS.LOCALE_DETECTION_HISTORY);\n\n      const dataString = JSON.stringify({ preference, override, history });\n      \n      // 简单的校验和计算（实际应用中可能需要更强的算法）\n      let hash = 0;\n      for (let i = 0; i < dataString.length; i++) {\n        const char = dataString.charCodeAt(i);\n        hash = ((hash << 5) - hash) + char;\n        hash = hash & hash; // 转换为32位整数\n      }\n      \n      return Math.abs(hash).toString(16);\n    } catch {\n      return 'unknown';\n    }\n  }\n\n  /**\n   * 获取导出统计信息\n   * Get export statistics\n   */\n  static getExportStats(): {\n    totalItems: number;\n    hasPreference: boolean;\n    hasOverride: boolean;\n    hasHistory: boolean;\n    historyRecords: number;\n    dataSize: number;\n    lastModified: number;\n  } {\n    const preference = LocalStorageManager.get<UserLocalePreference>(\n      STORAGE_KEYS.LOCALE_PREFERENCE\n    );\n    const override = LocalStorageManager.get<Locale>(\n      STORAGE_KEYS.USER_LOCALE_OVERRIDE\n    );\n    const history = LocalStorageManager.get<LocaleDetectionHistory>(\n      STORAGE_KEYS.LOCALE_DETECTION_HISTORY\n    );\n\n    const exportData = this.exportData();\n    const dataSize = JSON.stringify(exportData).length;\n\n    let lastModified = 0;\n    if (preference?.timestamp) lastModified = Math.max(lastModified, preference.timestamp);\n    if (history?.lastUpdated) lastModified = Math.max(lastModified, history.lastUpdated);\n\n    return {\n      totalItems: [preference, override, history].filter(Boolean).length,\n      hasPreference: !!preference,\n      hasOverride: !!override,\n      hasHistory: !!history,\n      historyRecords: history?.detections?.length || 0,\n      dataSize,\n      lastModified,\n    };\n  }\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-storage-maintenance-operations.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'Locale' is defined but never used. Allowed unused vars must match /^_/u.","line":10,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"Locale"},"fix":{"range":[102,140],"text":""},"desc":"Remove unused variable 'Locale'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Locale' is defined but never used. Allowed unused vars must match /^_/u.","line":10,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":10,"endColumn":16},{"ruleId":"no-unused-vars","severity":2,"message":"'CookieManager' is defined but never used. Allowed unused vars must match /^_/u.","line":11,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":23,"suggestions":[{"messageId":"removeVar","data":{"varName":"CookieManager"},"fix":{"range":[141,197],"text":""},"desc":"Remove unused variable 'CookieManager'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CookieManager' is defined but never used. Allowed unused vars must match /^_/u.","line":11,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":11,"endColumn":23},{"ruleId":"max-statements","severity":2,"message":"Static method 'performMaintenance' has too many statements (49). Maximum allowed is 20.","line":32,"column":28,"nodeType":"FunctionExpression","messageId":"exceed","endLine":139,"endColumn":4},{"ruleId":"complexity","severity":1,"message":"Static method 'performMaintenance' has a complexity of 24. Maximum allowed is 20.","line":32,"column":28,"nodeType":"FunctionExpression","messageId":"complex","endLine":139,"endColumn":4},{"ruleId":"max-statements","severity":2,"message":"Static method 'performDeepMaintenance' has too many statements (24). Maximum allowed is 20.","line":302,"column":32,"nodeType":"FunctionExpression","messageId":"exceed","endLine":363,"endColumn":4},{"ruleId":"max-statements","severity":2,"message":"Static method 'getMaintenanceRecommendations' has too many statements (33). Maximum allowed is 20.","line":369,"column":39,"nodeType":"FunctionExpression","messageId":"exceed","endLine":443,"endColumn":4},{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":436,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":436,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":436,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":436,"endColumn":19}],"suppressedMessages":[],"errorCount":9,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 语言存储维护操作\n * Locale Storage Maintenance Operations\n * \n * 负责存储数据的维护、压缩和优化操作\n */\n\n'use client';\n\nimport { Locale } from '@/types/i18n';\nimport { CookieManager } from './locale-storage-cookie';\nimport { LocalStorageManager } from './locale-storage-local';\nimport { LocaleCleanupManager } from './locale-storage-maintenance-cleanup';\nimport { LocaleValidationManager } from './locale-storage-maintenance-validation';\nimport type {\n  UserLocalePreference,\n  LocaleDetectionHistory,\n  STORAGE_KEYS,\n  StorageOperationResult,\n  MaintenanceOptions,\n} from './locale-storage-types';\n\n/**\n * 语言存储维护操作管理器\n * Locale storage maintenance operations manager\n */\nexport class LocaleMaintenanceOperationsManager {\n  /**\n   * 执行存储维护\n   * Perform storage maintenance\n   */\n  static performMaintenance(options: MaintenanceOptions = {}): StorageOperationResult {\n    const {\n      cleanupExpired = true,\n      maxDetectionAge = 30 * 24 * 60 * 60 * 1000, // 30天\n      validateData = true,\n      compactStorage = true,\n      fixSyncIssues = true,\n      cleanupDuplicates = true,\n      cleanupInvalid = true,\n    } = options;\n\n    try {\n      const results: string[] = [];\n      let totalOperations = 0;\n      let successfulOperations = 0;\n\n      // 清理过期检测记录\n      if (cleanupExpired) {\n        totalOperations += 1;\n        const cleanupResult = LocaleCleanupManager.cleanupExpiredDetections(maxDetectionAge);\n        if (cleanupResult.success) {\n          successfulOperations += 1;\n          results.push(cleanupResult.message);\n        } else {\n          results.push(`清理过期记录失败: ${cleanupResult.message}`);\n        }\n      }\n\n      // 清理重复记录\n      if (cleanupDuplicates) {\n        totalOperations += 1;\n        const duplicateResult = LocaleCleanupManager.cleanupDuplicateDetections();\n        if (duplicateResult.success) {\n          successfulOperations += 1;\n          results.push(duplicateResult.message);\n        } else {\n          results.push(`清理重复记录失败: ${duplicateResult.message}`);\n        }\n      }\n\n      // 清理无效数据\n      if (cleanupInvalid) {\n        totalOperations += 1;\n        const invalidResult = LocaleCleanupManager.cleanupInvalidPreferences();\n        if (invalidResult.success) {\n          successfulOperations += 1;\n          results.push(invalidResult.message);\n        } else {\n          results.push(`清理无效数据失败: ${invalidResult.message}`);\n        }\n      }\n\n      // 验证数据完整性\n      if (validateData) {\n        totalOperations += 1;\n        const validationResult = LocaleValidationManager.validateStorageIntegrity();\n        if (validationResult.success) {\n          successfulOperations += 1;\n          results.push(validationResult.message);\n        } else {\n          results.push(`数据验证失败: ${validationResult.message}`);\n        }\n      }\n\n      // 修复同步问题\n      if (fixSyncIssues) {\n        totalOperations += 1;\n        const syncResult = LocaleValidationManager.fixSyncIssues();\n        if (syncResult.success) {\n          successfulOperations += 1;\n          results.push(syncResult.message);\n        } else {\n          results.push(`修复同步问题失败: ${syncResult.message}`);\n        }\n      }\n\n      // 压缩存储空间\n      if (compactStorage) {\n        totalOperations += 1;\n        const compactResult = this.compactStorage();\n        if (compactResult.success) {\n          successfulOperations += 1;\n          results.push(compactResult.message);\n        } else {\n          results.push(`压缩存储失败: ${compactResult.message}`);\n        }\n      }\n\n      return {\n        success: successfulOperations === totalOperations,\n        message: `维护完成: ${successfulOperations}/${totalOperations} 操作成功`,\n        timestamp: Date.now(),\n        data: {\n          totalOperations,\n          successfulOperations,\n          results,\n          options,\n        },\n      };\n    } catch (error) {\n      return {\n        success: false,\n        message: `执行维护失败: ${error instanceof Error ? error.message : '未知错误'}`,\n        timestamp: Date.now(),\n        error: error instanceof Error ? error : new Error('Unknown error'),\n      };\n    }\n  }\n\n  /**\n   * 压缩存储空间\n   * Compact storage space\n   */\n  static compactStorage(): StorageOperationResult {\n    try {\n      let compactedItems = 0;\n\n      // 重新序列化所有数据以移除多余空格\n      Object.values(STORAGE_KEYS).forEach((key) => {\n        const data = LocalStorageManager.get(key);\n        if (data !== null) {\n          // 重新设置数据，这会触发重新序列化\n          LocalStorageManager.set(key, data);\n          compactedItems += 1;\n        }\n      });\n\n      return {\n        success: true,\n        message: `已压缩 ${compactedItems} 项存储数据`,\n        timestamp: Date.now(),\n        data: { compactedItems },\n      };\n    } catch (error) {\n      return {\n        success: false,\n        message: `压缩存储失败: ${error instanceof Error ? error.message : '未知错误'}`,\n        timestamp: Date.now(),\n        error: error instanceof Error ? error : new Error('Unknown error'),\n      };\n    }\n  }\n\n  /**\n   * 优化检测历史数据\n   * Optimize detection history data\n   */\n  static optimizeDetectionHistory(): StorageOperationResult {\n    try {\n      const historyData = LocalStorageManager.get<LocaleDetectionHistory>(\n        STORAGE_KEYS.LOCALE_DETECTION_HISTORY\n      );\n\n      if (!historyData || !Array.isArray(historyData.detections)) {\n        return {\n          success: true,\n          message: '没有检测历史数据需要优化',\n          timestamp: Date.now(),\n        };\n      }\n\n      const originalCount = historyData.detections.length;\n      \n      // 按时间排序（最新的在前）\n      const sortedDetections = historyData.detections.sort((a, b) => b.timestamp - a.timestamp);\n      \n      // 保留最近的100条记录\n      const maxRecords = 100;\n      const optimizedDetections = sortedDetections.slice(0, maxRecords);\n      \n      const removedCount = originalCount - optimizedDetections.length;\n\n      if (removedCount > 0) {\n        const updatedHistory: LocaleDetectionHistory = {\n          detections: optimizedDetections,\n          lastUpdated: Date.now(),\n        };\n\n        LocalStorageManager.set(STORAGE_KEYS.LOCALE_DETECTION_HISTORY, updatedHistory);\n\n        return {\n          success: true,\n          message: `已优化检测历史，移除 ${removedCount} 条旧记录`,\n          timestamp: Date.now(),\n          data: { removedCount, remainingCount: optimizedDetections.length },\n        };\n      }\n\n      return {\n        success: true,\n        message: '检测历史数据已是最优状态',\n        timestamp: Date.now(),\n        data: { removedCount: 0, remainingCount: originalCount },\n      };\n    } catch (error) {\n      return {\n        success: false,\n        message: `优化检测历史失败: ${error instanceof Error ? error.message : '未知错误'}`,\n        timestamp: Date.now(),\n        error: error instanceof Error ? error : new Error('Unknown error'),\n      };\n    }\n  }\n\n  /**\n   * 重建存储索引\n   * Rebuild storage index\n   */\n  static rebuildStorageIndex(): StorageOperationResult {\n    try {\n      let rebuiltItems = 0;\n      const actions: string[] = [];\n\n      // 重建偏好数据索引\n      const preference = LocalStorageManager.get<UserLocalePreference>(\n        STORAGE_KEYS.LOCALE_PREFERENCE\n      );\n      if (preference) {\n        // 确保数据结构完整\n        const rebuiltPreference: UserLocalePreference = {\n          locale: preference.locale,\n          source: preference.source,\n          timestamp: preference.timestamp,\n          confidence: preference.confidence,\n          ...(preference.metadata && { metadata: preference.metadata }),\n        };\n        \n        LocalStorageManager.set(STORAGE_KEYS.LOCALE_PREFERENCE, rebuiltPreference);\n        rebuiltItems += 1;\n        actions.push('重建偏好数据索引');\n      }\n\n      // 重建历史数据索引\n      const history = LocalStorageManager.get<LocaleDetectionHistory>(\n        STORAGE_KEYS.LOCALE_DETECTION_HISTORY\n      );\n      if (history) {\n        // 确保数据结构完整并按时间排序\n        const rebuiltHistory: LocaleDetectionHistory = {\n          detections: history.detections\n            .filter(detection => detection && detection.locale && detection.source)\n            .sort((a, b) => b.timestamp - a.timestamp),\n          lastUpdated: Date.now(),\n        };\n        \n        LocalStorageManager.set(STORAGE_KEYS.LOCALE_DETECTION_HISTORY, rebuiltHistory);\n        rebuiltItems += 1;\n        actions.push('重建历史数据索引');\n      }\n\n      return {\n        success: true,\n        message: `已重建 ${rebuiltItems} 项存储索引`,\n        timestamp: Date.now(),\n        data: { rebuiltItems, actions },\n      };\n    } catch (error) {\n      return {\n        success: false,\n        message: `重建存储索引失败: ${error instanceof Error ? error.message : '未知错误'}`,\n        timestamp: Date.now(),\n        error: error instanceof Error ? error : new Error('Unknown error'),\n      };\n    }\n  }\n\n  /**\n   * 执行深度维护\n   * Perform deep maintenance\n   */\n  static performDeepMaintenance(): StorageOperationResult {\n    try {\n      const results: string[] = [];\n      let totalOperations = 0;\n      let successfulOperations = 0;\n\n      // 执行标准维护\n      totalOperations += 1;\n      const standardResult = this.performMaintenance({\n        cleanupExpired: true,\n        validateData: true,\n        compactStorage: true,\n        fixSyncIssues: true,\n        cleanupDuplicates: true,\n        cleanupInvalid: true,\n      });\n      if (standardResult.success) {\n        successfulOperations += 1;\n        results.push('标准维护完成');\n      } else {\n        results.push(`标准维护失败: ${standardResult.message}`);\n      }\n\n      // 优化检测历史\n      totalOperations += 1;\n      const optimizeResult = this.optimizeDetectionHistory();\n      if (optimizeResult.success) {\n        successfulOperations += 1;\n        results.push(optimizeResult.message);\n      } else {\n        results.push(`优化历史失败: ${optimizeResult.message}`);\n      }\n\n      // 重建存储索引\n      totalOperations += 1;\n      const rebuildResult = this.rebuildStorageIndex();\n      if (rebuildResult.success) {\n        successfulOperations += 1;\n        results.push(rebuildResult.message);\n      } else {\n        results.push(`重建索引失败: ${rebuildResult.message}`);\n      }\n\n      return {\n        success: successfulOperations === totalOperations,\n        message: `深度维护完成: ${successfulOperations}/${totalOperations} 操作成功`,\n        timestamp: Date.now(),\n        data: {\n          totalOperations,\n          successfulOperations,\n          results,\n        },\n      };\n    } catch (error) {\n      return {\n        success: false,\n        message: `执行深度维护失败: ${error instanceof Error ? error.message : '未知错误'}`,\n        timestamp: Date.now(),\n        error: error instanceof Error ? error : new Error('Unknown error'),\n      };\n    }\n  }\n\n  /**\n   * 获取维护建议\n   * Get maintenance recommendations\n   */\n  static getMaintenanceRecommendations(): {\n    recommendations: string[];\n    priority: 'low' | 'medium' | 'high';\n    estimatedTime: string;\n  } {\n    const recommendations: string[] = [];\n    let priority: 'low' | 'medium' | 'high' = 'low';\n\n    try {\n      // 检查清理统计\n      const cleanupStats = LocaleCleanupManager.getCleanupStats();\n      \n      if (cleanupStats.expiredDetections > 50) {\n        recommendations.push(`清理 ${cleanupStats.expiredDetections} 条过期检测记录`);\n        priority = 'medium';\n      }\n\n      if (cleanupStats.duplicateDetections > 10) {\n        recommendations.push(`清理 ${cleanupStats.duplicateDetections} 条重复检测记录`);\n        priority = 'medium';\n      }\n\n      if (cleanupStats.invalidPreferences > 0) {\n        recommendations.push(`修复 ${cleanupStats.invalidPreferences} 项无效偏好数据`);\n        priority = 'high';\n      }\n\n      // 检查验证统计\n      const validationSummary = LocaleValidationManager.getValidationSummary();\n      \n      if (validationSummary.invalidKeys > 0) {\n        recommendations.push(`修复 ${validationSummary.invalidKeys} 项无效数据`);\n        priority = 'high';\n      }\n\n      if (validationSummary.syncIssues > 0) {\n        recommendations.push(`修复 ${validationSummary.syncIssues} 个同步问题`);\n        priority = 'medium';\n      }\n\n      // 检查历史数据大小\n      const historyData = LocalStorageManager.get<LocaleDetectionHistory>(\n        STORAGE_KEYS.LOCALE_DETECTION_HISTORY\n      );\n      if (historyData?.detections && historyData.detections.length > 200) {\n        recommendations.push('优化检测历史数据（记录过多）');\n        if (priority === 'low') priority = 'medium';\n      }\n\n      if (recommendations.length === 0) {\n        recommendations.push('存储状态良好，无需特殊维护');\n      }\n\n      // 估算维护时间\n      let estimatedTime = '< 1分钟';\n      if (recommendations.length > 3) {\n        estimatedTime = '1-2分钟';\n      }\n      if (priority === 'high') {\n        estimatedTime = '2-5分钟';\n      }\n\n      return {\n        recommendations,\n        priority,\n        estimatedTime,\n      };\n    } catch (error) {\n      return {\n        recommendations: ['获取维护建议时出错，建议执行基础维护'],\n        priority: 'medium',\n        estimatedTime: '1-2分钟',\n      };\n    }\n  }\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-storage-maintenance-validation.ts","messages":[{"ruleId":"max-statements","severity":2,"message":"Static method 'validateSpecificData' has too many statements (34). Maximum allowed is 20.","line":146,"column":30,"nodeType":"FunctionExpression","messageId":"exceed","endLine":223,"endColumn":4},{"ruleId":"security/detect-object-injection","severity":2,"message":"Variable Assigned to Object Injection Sink","line":148,"column":26,"nodeType":"MemberExpression","endLine":148,"endColumn":43},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (4). Maximum allowed is 3.","line":169,"column":11,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":172,"endColumn":12},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (4). Maximum allowed is 3.","line":176,"column":11,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":179,"endColumn":12},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (4). Maximum allowed is 3.","line":190,"column":13,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":193,"endColumn":14},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":233,"column":7,"nodeType":"MemberExpression","endLine":233,"endColumn":19},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (4). Maximum allowed is 3.","line":258,"column":11,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":260,"endColumn":12},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (4). Maximum allowed is 3.","line":262,"column":11,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":264,"endColumn":12}],"suppressedMessages":[],"errorCount":8,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 语言存储验证操作\n * Locale Storage Validation Operations\n * \n * 负责存储数据的完整性验证和同步状态检查\n */\n\n'use client';\n\nimport { Locale } from '@/types/i18n';\nimport { CookieManager } from './locale-storage-cookie';\nimport { LocalStorageManager } from './locale-storage-local';\nimport type {\n  UserLocalePreference,\n  LocaleDetectionHistory,\n  STORAGE_KEYS,\n  StorageOperationResult,\n  ValidationResult,\n} from './locale-storage-types';\n\n/**\n * 语言存储验证管理器\n * Locale storage validation manager\n */\nexport class LocaleValidationManager {\n  /**\n   * 验证存储数据完整性\n   * Validate storage data integrity\n   */\n  static validateStorageIntegrity(): StorageOperationResult {\n    const issues: string[] = [];\n\n    try {\n      // 验证用户偏好数据\n      const preference = LocalStorageManager.get<UserLocalePreference>(\n        STORAGE_KEYS.LOCALE_PREFERENCE\n      );\n      if (preference && !this.validatePreferenceData(preference)) {\n        issues.push('用户偏好数据格式无效');\n      }\n\n      // 验证检测历史数据\n      const history = LocalStorageManager.get<LocaleDetectionHistory>(\n        STORAGE_KEYS.LOCALE_DETECTION_HISTORY\n      );\n      if (history && !this.validateHistoryData(history)) {\n        issues.push('检测历史数据格式无效');\n      }\n\n      // 验证存储同步状态\n      const syncIssues = this.validateStorageSync();\n      issues.push(...syncIssues);\n\n      return {\n        success: issues.length === 0,\n        message: issues.length === 0 ? '存储数据完整性验证通过' : `发现 ${issues.length} 个问题`,\n        timestamp: Date.now(),\n        data: { issues },\n      };\n    } catch (error) {\n      return {\n        success: false,\n        message: `验证存储完整性失败: ${error instanceof Error ? error.message : '未知错误'}`,\n        timestamp: Date.now(),\n        error: error instanceof Error ? error : new Error('Unknown error'),\n      };\n    }\n  }\n\n  /**\n   * 验证用户偏好数据\n   * Validate user preference data\n   */\n  static validatePreferenceData(preference: UserLocalePreference): boolean {\n    if (!preference || typeof preference !== 'object') return false;\n    \n    const requiredFields = ['locale', 'source', 'timestamp', 'confidence'];\n    const hasAllFields = requiredFields.every(field => field in preference);\n    \n    if (!hasAllFields) return false;\n    \n    // 验证字段类型\n    if (typeof preference.locale !== 'string') return false;\n    if (typeof preference.source !== 'string') return false;\n    if (typeof preference.timestamp !== 'number') return false;\n    if (typeof preference.confidence !== 'number') return false;\n    \n    // 验证值的合理性\n    if (preference.confidence < 0 || preference.confidence > 1) return false;\n    if (preference.timestamp > Date.now() || preference.timestamp < 0) return false;\n    \n    return true;\n  }\n\n  /**\n   * 验证检测历史数据\n   * Validate detection history data\n   */\n  static validateHistoryData(history: LocaleDetectionHistory): boolean {\n    if (!history || typeof history !== 'object') return false;\n    if (!Array.isArray(history.detections)) return false;\n    if (typeof history.lastUpdated !== 'number') return false;\n\n    return history.detections.every(detection => \n      typeof detection.locale === 'string' &&\n      typeof detection.source === 'string' &&\n      typeof detection.timestamp === 'number' &&\n      typeof detection.confidence === 'number' &&\n      detection.confidence >= 0 && detection.confidence <= 1\n    );\n  }\n\n  /**\n   * 验证存储同步状态\n   * Validate storage synchronization\n   */\n  static validateStorageSync(): string[] {\n    const issues: string[] = [];\n\n    // 检查关键数据的同步状态\n    const localPreference = LocalStorageManager.get<UserLocalePreference>(\n      STORAGE_KEYS.LOCALE_PREFERENCE\n    );\n    const cookiePreference = CookieManager.get(STORAGE_KEYS.LOCALE_PREFERENCE);\n\n    if (localPreference && !cookiePreference) {\n      issues.push('用户偏好在localStorage中存在但Cookie中缺失');\n    }\n\n    const localOverride = LocalStorageManager.get<Locale>(\n      STORAGE_KEYS.USER_LOCALE_OVERRIDE\n    );\n    const cookieOverride = CookieManager.get(STORAGE_KEYS.USER_LOCALE_OVERRIDE);\n\n    if (localOverride && !cookieOverride) {\n      issues.push('用户覆盖设置在localStorage中存在但Cookie中缺失');\n    }\n\n    return issues;\n  }\n\n  /**\n   * 验证特定存储键的数据\n   * Validate data for specific storage key\n   */\n  static validateSpecificData(key: keyof typeof STORAGE_KEYS): ValidationResult {\n    try {\n      const storageKey = STORAGE_KEYS[key];\n      const localData = LocalStorageManager.get(storageKey);\n      const cookieData = CookieManager.get(storageKey);\n\n      const result: ValidationResult = {\n        isValid: true,\n        errors: [],\n        warnings: [],\n        data: {\n          hasLocalData: localData !== null,\n          hasCookieData: cookieData !== null,\n          localDataValid: true,\n          cookieDataValid: true,\n        },\n      };\n\n      // 验证localStorage数据\n      if (localData !== null) {\n        if (key === 'LOCALE_PREFERENCE') {\n          const isValid = this.validatePreferenceData(localData as UserLocalePreference);\n          result.data.localDataValid = isValid;\n          if (!isValid) {\n            result.isValid = false;\n            result.errors.push('localStorage中的偏好数据格式无效');\n          }\n        } else if (key === 'LOCALE_DETECTION_HISTORY') {\n          const isValid = this.validateHistoryData(localData as LocaleDetectionHistory);\n          result.data.localDataValid = isValid;\n          if (!isValid) {\n            result.isValid = false;\n            result.errors.push('localStorage中的历史数据格式无效');\n          }\n        }\n      }\n\n      // 验证Cookie数据\n      if (cookieData !== null) {\n        try {\n          if (key === 'LOCALE_PREFERENCE') {\n            const parsed = JSON.parse(cookieData) as UserLocalePreference;\n            const isValid = this.validatePreferenceData(parsed);\n            result.data.cookieDataValid = isValid;\n            if (!isValid) {\n              result.isValid = false;\n              result.errors.push('Cookie中的偏好数据格式无效');\n            }\n          }\n        } catch {\n          result.isValid = false;\n          result.data.cookieDataValid = false;\n          result.errors.push('Cookie数据JSON格式错误');\n        }\n      }\n\n      // 检查同步状态\n      if (localData !== null && cookieData === null) {\n        result.warnings.push('数据仅存在于localStorage中，Cookie中缺失');\n      } else if (localData === null && cookieData !== null) {\n        result.warnings.push('数据仅存在于Cookie中，localStorage中缺失');\n      }\n\n      return result;\n    } catch (error) {\n      return {\n        isValid: false,\n        errors: [`验证失败: ${error instanceof Error ? error.message : '未知错误'}`],\n        warnings: [],\n        data: {\n          hasLocalData: false,\n          hasCookieData: false,\n          localDataValid: false,\n          cookieDataValid: false,\n        },\n      };\n    }\n  }\n\n  /**\n   * 验证所有存储数据\n   * Validate all storage data\n   */\n  static validateAllData(): Record<string, ValidationResult> {\n    const results: Record<string, ValidationResult> = {};\n\n    Object.keys(STORAGE_KEYS).forEach((key) => {\n      results[key] = this.validateSpecificData(key as keyof typeof STORAGE_KEYS);\n    });\n\n    return results;\n  }\n\n  /**\n   * 检查数据一致性\n   * Check data consistency\n   */\n  static checkDataConsistency(): StorageOperationResult {\n    try {\n      const issues: string[] = [];\n      const warnings: string[] = [];\n\n      // 检查偏好数据一致性\n      const localPreference = LocalStorageManager.get<UserLocalePreference>(\n        STORAGE_KEYS.LOCALE_PREFERENCE\n      );\n      const cookiePreferenceStr = CookieManager.get(STORAGE_KEYS.LOCALE_PREFERENCE);\n\n      if (localPreference && cookiePreferenceStr) {\n        try {\n          const cookiePreference = JSON.parse(cookiePreferenceStr) as UserLocalePreference;\n          \n          if (localPreference.locale !== cookiePreference.locale) {\n            issues.push('localStorage和Cookie中的语言偏好不一致');\n          }\n          \n          if (Math.abs(localPreference.timestamp - cookiePreference.timestamp) > 60000) { // 1分钟差异\n            warnings.push('localStorage和Cookie中的偏好时间戳差异较大');\n          }\n        } catch {\n          issues.push('Cookie中的偏好数据格式错误');\n        }\n      }\n\n      // 检查覆盖设置一致性\n      const localOverride = LocalStorageManager.get<Locale>(\n        STORAGE_KEYS.USER_LOCALE_OVERRIDE\n      );\n      const cookieOverride = CookieManager.get(STORAGE_KEYS.USER_LOCALE_OVERRIDE);\n\n      if (localOverride && cookieOverride && localOverride !== cookieOverride) {\n        issues.push('localStorage和Cookie中的语言覆盖设置不一致');\n      }\n\n      return {\n        success: issues.length === 0,\n        message: issues.length === 0 ? '数据一致性检查通过' : `发现 ${issues.length} 个一致性问题`,\n        timestamp: Date.now(),\n        data: { issues, warnings },\n      };\n    } catch (error) {\n      return {\n        success: false,\n        message: `数据一致性检查失败: ${error instanceof Error ? error.message : '未知错误'}`,\n        timestamp: Date.now(),\n        error: error instanceof Error ? error : new Error('Unknown error'),\n      };\n    }\n  }\n\n  /**\n   * 获取验证摘要\n   * Get validation summary\n   */\n  static getValidationSummary(): {\n    totalKeys: number;\n    validKeys: number;\n    invalidKeys: number;\n    warningKeys: number;\n    syncIssues: number;\n  } {\n    const allResults = this.validateAllData();\n    const syncIssues = this.validateStorageSync();\n\n    let validKeys = 0;\n    let invalidKeys = 0;\n    let warningKeys = 0;\n\n    Object.values(allResults).forEach((result) => {\n      if (result.isValid) {\n        validKeys += 1;\n      } else {\n        invalidKeys += 1;\n      }\n      if (result.warnings.length > 0) {\n        warningKeys += 1;\n      }\n    });\n\n    return {\n      totalKeys: Object.keys(STORAGE_KEYS).length,\n      validKeys,\n      invalidKeys,\n      warningKeys,\n      syncIssues: syncIssues.length,\n    };\n  }\n\n  /**\n   * 修复同步问题\n   * Fix synchronization issues\n   */\n  static fixSyncIssues(): StorageOperationResult {\n    try {\n      let fixedIssues = 0;\n      const actions: string[] = [];\n\n      // 修复偏好数据同步\n      const localPreference = LocalStorageManager.get<UserLocalePreference>(\n        STORAGE_KEYS.LOCALE_PREFERENCE\n      );\n      const cookiePreference = CookieManager.get(STORAGE_KEYS.LOCALE_PREFERENCE);\n\n      if (localPreference && !cookiePreference) {\n        CookieManager.set(STORAGE_KEYS.LOCALE_PREFERENCE, JSON.stringify(localPreference));\n        fixedIssues += 1;\n        actions.push('已同步偏好数据到Cookie');\n      }\n\n      // 修复覆盖设置同步\n      const localOverride = LocalStorageManager.get<Locale>(\n        STORAGE_KEYS.USER_LOCALE_OVERRIDE\n      );\n      const cookieOverride = CookieManager.get(STORAGE_KEYS.USER_LOCALE_OVERRIDE);\n\n      if (localOverride && !cookieOverride) {\n        CookieManager.set(STORAGE_KEYS.USER_LOCALE_OVERRIDE, localOverride);\n        fixedIssues += 1;\n        actions.push('已同步覆盖设置到Cookie');\n      }\n\n      return {\n        success: true,\n        message: fixedIssues > 0 ? `已修复 ${fixedIssues} 个同步问题` : '没有同步问题需要修复',\n        timestamp: Date.now(),\n        data: { fixedIssues, actions },\n      };\n    } catch (error) {\n      return {\n        success: false,\n        message: `修复同步问题失败: ${error instanceof Error ? error.message : '未知错误'}`,\n        timestamp: Date.now(),\n        error: error instanceof Error ? error : new Error('Unknown error'),\n      };\n    }\n  }\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-storage-maintenance.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-storage-manager.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-storage-preference-cache.ts","messages":[{"ruleId":"max-statements","severity":2,"message":"Function 'checkDataConsistency' has too many statements (23). Maximum allowed is 20.","line":176,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":230,"endColumn":2},{"ruleId":"max-statements","severity":2,"message":"Function 'fixDataInconsistency' has too many statements (24). Maximum allowed is 20.","line":236,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":318,"endColumn":2},{"ruleId":"no-restricted-syntax","severity":2,"message":"Using 'ForInStatement' is not allowed.","line":366,"column":7,"nodeType":"ForInStatement","messageId":"restrictedSyntax","endLine":370,"endColumn":8},{"ruleId":"prefer-const","severity":2,"message":"'key' is never reassigned. Use 'const' instead.","line":366,"column":16,"nodeType":"Identifier","messageId":"useConst","endLine":366,"endColumn":19,"fix":{"range":[8994,9001],"text":"const key"}},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (4). Maximum allowed is 3.","line":367,"column":9,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":369,"endColumn":10},{"ruleId":"no-prototype-builtins","severity":2,"message":"Do not access Object.prototype method 'hasOwnProperty' from target object.","line":367,"column":26,"nodeType":"CallExpression","messageId":"prototypeBuildIn","endLine":367,"endColumn":40,"suggestions":[{"messageId":"callObjectPrototype","data":{"prop":"hasOwnProperty"},"fix":{"range":[9033,9061],"text":"Object.prototype.hasOwnProperty.call(localStorage, "},"desc":"Call Object.prototype.hasOwnProperty explicitly."}]},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":368,"column":24,"nodeType":"MemberExpression","endLine":368,"endColumn":41}],"suppressedMessages":[],"errorCount":7,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"/**\n * 用户语言偏好缓存和同步\n * User Locale Preference Cache and Sync\n * \n * 负责偏好数据的缓存管理、数据同步和性能优化\n */\n\n'use client';\n\nimport { Locale } from '@/types/i18n';\nimport { CookieManager } from './locale-storage-cookie';\nimport { LocalStorageManager } from './locale-storage-local';\nimport type {\n  UserLocalePreference,\n  StorageOperationResult,\n} from './locale-storage-types';\nimport { \n  getUserPreference, \n  saveUserPreference, \n  validatePreferenceData \n} from './locale-storage-preference-core';\n\n// ==================== 缓存管理器 ====================\n\n/**\n * 偏好缓存管理器\n * Preference cache manager\n */\nexport class PreferenceCacheManager {\n  private static cache: Map<string, UserLocalePreference> = new Map();\n  private static cacheTimestamp = 0;\n  private static readonly CACHE_TTL = 5 * 60 * 1000; // 5 minutes\n\n  /**\n   * 获取缓存的偏好\n   * Get cached preference\n   */\n  static getCachedPreference(key: string): UserLocalePreference | null {\n    if (Date.now() - this.cacheTimestamp > this.CACHE_TTL) {\n      this.cache.clear();\n      return null;\n    }\n    \n    return this.cache.get(key) || null;\n  }\n\n  /**\n   * 更新缓存\n   * Update cache\n   */\n  static updateCache(key: string, preference: UserLocalePreference): void {\n    this.cache.set(key, preference);\n    this.cacheTimestamp = Date.now();\n  }\n\n  /**\n   * 清除缓存\n   * Clear cache\n   */\n  static clearCache(key?: string): void {\n    if (key) {\n      this.cache.delete(key);\n    } else {\n      this.cache.clear();\n      this.cacheTimestamp = 0;\n    }\n  }\n\n  /**\n   * 获取缓存状态\n   * Get cache status\n   */\n  static getCacheStatus(): {\n    size: number;\n    age: number;\n    isExpired: boolean;\n    keys: string[];\n  } {\n    const age = Date.now() - this.cacheTimestamp;\n    const isExpired = age > this.CACHE_TTL;\n\n    return {\n      size: this.cache.size,\n      age,\n      isExpired,\n      keys: Array.from(this.cache.keys()),\n    };\n  }\n\n  /**\n   * 预热缓存\n   * Warm up cache\n   */\n  static warmUpCache(): void {\n    const preference = getUserPreference();\n    if (preference.success && preference.data) {\n      this.updateCache('locale_preference', preference.data);\n    }\n  }\n}\n\n// ==================== 数据同步功能 ====================\n\n/**\n * 同步偏好数据\n * Sync preference data\n */\nexport function syncPreferenceData(): StorageOperationResult<{\n  localStorage: UserLocalePreference | null;\n  cookies: Locale | null;\n  synced: boolean;\n}> {\n  const startTime = Date.now();\n  \n  try {\n    // 获取各存储源的数据\n    const localPreference = LocalStorageManager.get<UserLocalePreference>('locale_preference');\n    const cookieLocale = CookieManager.get('locale_preference');\n\n    let synced = false;\n    let primaryPreference: UserLocalePreference | null = null;\n\n    // 确定主要数据源\n    if (localPreference && validatePreferenceData(localPreference).isValid) {\n      primaryPreference = localPreference;\n      \n      // 同步到 cookies\n      if (cookieLocale !== localPreference.locale) {\n        CookieManager.set('locale_preference', localPreference.locale);\n        synced = true;\n      }\n    } else if (cookieLocale) {\n      // 从 cookies 创建偏好并同步到 localStorage\n      primaryPreference = {\n        locale: cookieLocale as Locale,\n        source: 'cookie_sync',\n        confidence: 0.7,\n        timestamp: Date.now(),\n        metadata: { syncedFrom: 'cookies' },\n      };\n      \n      const saveResult = saveUserPreference(primaryPreference);\n      synced = saveResult.success;\n    }\n\n    // 更新缓存\n    if (primaryPreference) {\n      PreferenceCacheManager.updateCache('locale_preference', primaryPreference);\n    }\n\n    return {\n      success: true,\n      data: {\n        localStorage: localPreference,\n        cookies: cookieLocale as Locale | null,\n        synced,\n      },\n      source: 'sync',\n      timestamp: Date.now(),\n      responseTime: Date.now() - startTime,\n    };\n  } catch (error) {\n    return {\n      success: false,\n      error: error instanceof Error ? error.message : 'Unknown error',\n      timestamp: Date.now(),\n      responseTime: Date.now() - startTime,\n    };\n  }\n}\n\n/**\n * 检查数据一致性\n * Check data consistency\n */\nexport function checkDataConsistency(): {\n  isConsistent: boolean;\n  issues: string[];\n  recommendations: string[];\n} {\n  const issues: string[] = [];\n  const recommendations: string[] = [];\n\n  try {\n    const localPreference = LocalStorageManager.get<UserLocalePreference>('locale_preference');\n    const cookieLocale = CookieManager.get('locale_preference');\n\n    // 检查 localStorage 数据有效性\n    if (localPreference) {\n      const validation = validatePreferenceData(localPreference);\n      if (!validation.isValid) {\n        issues.push(`Invalid localStorage data: ${validation.errors.join(', ')}`);\n        recommendations.push('Clear and recreate localStorage preference data');\n      }\n    }\n\n    // 检查数据一致性\n    if (localPreference && cookieLocale) {\n      if (localPreference.locale !== cookieLocale) {\n        issues.push(`Locale mismatch: localStorage(${localPreference.locale}) vs cookies(${cookieLocale})`);\n        recommendations.push('Sync data between localStorage and cookies');\n      }\n    } else if (!localPreference && !cookieLocale) {\n      issues.push('No preference data found in any storage');\n      recommendations.push('Initialize default preference data');\n    }\n\n    // 检查缓存一致性\n    const cachedPreference = PreferenceCacheManager.getCachedPreference('locale_preference');\n    if (cachedPreference && localPreference) {\n      if (cachedPreference.locale !== localPreference.locale ||\n          Math.abs(cachedPreference.timestamp - localPreference.timestamp) > 1000) {\n        issues.push('Cache data is inconsistent with localStorage');\n        recommendations.push('Clear and refresh cache');\n      }\n    }\n\n    return {\n      isConsistent: issues.length === 0,\n      issues,\n      recommendations,\n    };\n  } catch (error) {\n    return {\n      isConsistent: false,\n      issues: [`Error checking consistency: ${error instanceof Error ? error.message : 'Unknown error'}`],\n      recommendations: ['Investigate storage access issues'],\n    };\n  }\n}\n\n/**\n * 修复数据不一致\n * Fix data inconsistency\n */\nexport function fixDataInconsistency(): StorageOperationResult<{\n  fixed: boolean;\n  actions: string[];\n}> {\n  const startTime = Date.now();\n  const actions: string[] = [];\n  \n  try {\n    const consistency = checkDataConsistency();\n    \n    if (consistency.isConsistent) {\n      return {\n        success: true,\n        data: {\n          fixed: false,\n          actions: ['No issues found'],\n        },\n        timestamp: Date.now(),\n        responseTime: Date.now() - startTime,\n      };\n    }\n\n    // 清除无效的缓存\n    PreferenceCacheManager.clearCache();\n    actions.push('Cleared cache');\n\n    // 获取最可靠的数据源\n    const localPreference = LocalStorageManager.get<UserLocalePreference>('locale_preference');\n    const cookieLocale = CookieManager.get('locale_preference');\n\n    let authoritative: UserLocalePreference | null = null;\n\n    // 确定权威数据源\n    if (localPreference && validatePreferenceData(localPreference).isValid) {\n      authoritative = localPreference;\n      actions.push('Using localStorage as authoritative source');\n    } else if (cookieLocale) {\n      authoritative = {\n        locale: cookieLocale as Locale,\n        source: 'cookie_recovery',\n        confidence: 0.6,\n        timestamp: Date.now(),\n        metadata: { recoveredFrom: 'cookies' },\n      };\n      actions.push('Recovered from cookies');\n    } else {\n      // 创建默认偏好\n      authoritative = {\n        locale: 'en',\n        source: 'default_recovery',\n        confidence: 0.5,\n        timestamp: Date.now(),\n        metadata: { createdBy: 'recovery' },\n      };\n      actions.push('Created default preference');\n    }\n\n    // 同步到所有存储\n    if (authoritative) {\n      const saveResult = saveUserPreference(authoritative);\n      if (saveResult.success) {\n        actions.push('Synced to all storage locations');\n      }\n    }\n\n    return {\n      success: true,\n      data: {\n        fixed: true,\n        actions,\n      },\n      timestamp: Date.now(),\n      responseTime: Date.now() - startTime,\n    };\n  } catch (error) {\n    return {\n      success: false,\n      error: error instanceof Error ? error.message : 'Unknown error',\n      timestamp: Date.now(),\n      responseTime: Date.now() - startTime,\n    };\n  }\n}\n\n/**\n * 获取存储使用情况\n * Get storage usage\n */\nexport function getStorageUsage(): {\n  localStorage: {\n    available: boolean;\n    size: number;\n    quota: number;\n  };\n  cookies: {\n    available: boolean;\n    size: number;\n    count: number;\n  };\n  cache: {\n    size: number;\n    age: number;\n    isExpired: boolean;\n  };\n} {\n  const usage = {\n    localStorage: {\n      available: false,\n      size: 0,\n      quota: 0,\n    },\n    cookies: {\n      available: false,\n      size: 0,\n      count: 0,\n    },\n    cache: {\n      size: 0,\n      age: 0,\n      isExpired: false,\n    },\n  };\n\n  // 检查 localStorage\n  try {\n    if (typeof localStorage !== 'undefined') {\n      usage.localStorage.available = true;\n      \n      // 估算使用大小\n      let totalSize = 0;\n      for (let key in localStorage) {\n        if (localStorage.hasOwnProperty(key)) {\n          totalSize += localStorage[key].length + key.length;\n        }\n      }\n      usage.localStorage.size = totalSize;\n\n      // 尝试获取配额信息\n      if ('storage' in navigator && 'estimate' in navigator.storage) {\n        navigator.storage.estimate().then(estimate => {\n          usage.localStorage.quota = estimate.quota || 0;\n        }).catch(() => {\n          // 忽略错误\n        });\n      }\n    }\n  } catch {\n    // localStorage 不可用\n  }\n\n  // 检查 cookies\n  try {\n    if (typeof document !== 'undefined') {\n      usage.cookies.available = true;\n      usage.cookies.size = document.cookie.length;\n      usage.cookies.count = document.cookie.split(';').length;\n    }\n  } catch {\n    // cookies 不可用\n  }\n\n  // 检查缓存\n  const cacheStatus = PreferenceCacheManager.getCacheStatus();\n  usage.cache = {\n    size: cacheStatus.size,\n    age: cacheStatus.age,\n    isExpired: cacheStatus.isExpired,\n  };\n\n  return usage;\n}\n\n/**\n * 优化存储性能\n * Optimize storage performance\n */\nexport function optimizeStoragePerformance(): StorageOperationResult<{\n  optimized: boolean;\n  actions: string[];\n  performance: {\n    before: number;\n    after: number;\n    improvement: number;\n  };\n}> {\n  const startTime = Date.now();\n  const actions: string[] = [];\n  \n  try {\n    const beforeTime = Date.now();\n\n    // 清理过期缓存\n    const cacheStatus = PreferenceCacheManager.getCacheStatus();\n    if (cacheStatus.isExpired) {\n      PreferenceCacheManager.clearCache();\n      actions.push('Cleared expired cache');\n    }\n\n    // 预热缓存\n    PreferenceCacheManager.warmUpCache();\n    actions.push('Warmed up cache');\n\n    // 同步数据\n    const syncResult = syncPreferenceData();\n    if (syncResult.success && syncResult.data?.synced) {\n      actions.push('Synced storage data');\n    }\n\n    const afterTime = Date.now();\n    const improvement = beforeTime - afterTime;\n\n    return {\n      success: true,\n      data: {\n        optimized: actions.length > 0,\n        actions,\n        performance: {\n          before: beforeTime,\n          after: afterTime,\n          improvement,\n        },\n      },\n      timestamp: Date.now(),\n      responseTime: Date.now() - startTime,\n    };\n  } catch (error) {\n    return {\n      success: false,\n      error: error instanceof Error ? error.message : 'Unknown error',\n      timestamp: Date.now(),\n      responseTime: Date.now() - startTime,\n    };\n  }\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-storage-preference-core.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'LocaleSource' is defined but never used. Allowed unused vars must match /^_/u.","line":15,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":15,"suggestions":[{"messageId":"removeVar","data":{"varName":"LocaleSource"},"fix":{"range":[309,325],"text":""},"desc":"Remove unused variable 'LocaleSource'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'LocaleSource' is defined but never used. Allowed unused vars must match /^_/u.","line":15,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":15,"endColumn":15},{"ruleId":"no-duplicate-imports","severity":2,"message":"'./locale-storage-types' import is duplicated.","line":19,"column":1,"nodeType":"ImportDeclaration","messageId":"import","endLine":19,"endColumn":85},{"ruleId":"no-unused-vars","severity":2,"message":"'validatePreference' is defined but never used. Allowed unused vars must match /^_/u.","line":19,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":28,"suggestions":[{"messageId":"removeVar","data":{"varName":"validatePreference"},"fix":{"range":[415,434],"text":""},"desc":"Remove unused variable 'validatePreference'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'validatePreference' is defined but never used. Allowed unused vars must match /^_/u.","line":19,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":19,"endColumn":28},{"ruleId":"no-unused-vars","severity":2,"message":"'syncResult' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":189,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":189,"endColumn":23,"suggestions":[{"messageId":"removeVar","data":{"varName":"syncResult"},"fix":{"range":[4846,4902],"text":""},"desc":"Remove unused variable 'syncResult'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'syncResult' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":189,"column":13,"nodeType":null,"messageId":"unusedVar","endLine":189,"endColumn":23},{"ruleId":"no-implicit-coercion","severity":2,"message":"Unexpected implicit coercion encountered. Use `Boolean(cookieLocale)` instead.","line":252,"column":82,"nodeType":"UnaryExpression","messageId":"implicitCoercion","endLine":252,"endColumn":96,"fix":{"range":[6510,6524],"text":"Boolean(cookieLocale)"}},{"ruleId":"no-implicit-coercion","severity":2,"message":"Unexpected implicit coercion encountered. Use `Boolean(cookieLocale)` instead.","line":275,"column":18,"nodeType":"UnaryExpression","messageId":"implicitCoercion","endLine":275,"endColumn":32,"fix":{"range":[7068,7082],"text":"Boolean(cookieLocale)"}},{"ruleId":"no-unused-vars","severity":2,"message":"'localResult' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":368,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":368,"endColumn":22,"suggestions":[{"messageId":"removeVar","data":{"varName":"localResult"},"fix":{"range":[8972,9040],"text":""},"desc":"Remove unused variable 'localResult'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'localResult' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":368,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":368,"endColumn":22},{"ruleId":"no-unused-vars","severity":2,"message":"'cookieResult' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":371,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":371,"endColumn":23,"suggestions":[{"messageId":"removeVar","data":{"varName":"cookieResult"},"fix":{"range":[9068,9131],"text":""},"desc":"Remove unused variable 'cookieResult'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'cookieResult' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":371,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":371,"endColumn":23}],"suppressedMessages":[],"errorCount":13,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":2,"fixableWarningCount":0,"source":"/**\n * 用户语言偏好核心管理\n * User Locale Preference Core Management\n * \n * 负责用户偏好的基础操作：保存、获取、验证和核心数据管理\n */\n\n'use client';\n\nimport { Locale } from '@/types/i18n';\nimport { CookieManager } from './locale-storage-cookie';\nimport { LocalStorageManager } from './locale-storage-local';\nimport type {\n  UserLocalePreference,\n  LocaleSource,\n  StorageOperationResult,\n  ValidationResult,\n} from './locale-storage-types';\nimport { validatePreference, isUserLocalePreference } from './locale-storage-types';\n\n// ==================== 数据验证功能 ====================\n\n/**\n * 验证偏好数据\n * Validate preference data\n */\nexport function validatePreferenceData(preference: unknown): ValidationResult {\n  if (!isUserLocalePreference(preference)) {\n    return {\n      isValid: false,\n      errors: ['Invalid preference data structure'],\n    };\n  }\n\n  const errors: string[] = [];\n\n  // 验证语言代码\n  if (!preference.locale || typeof preference.locale !== 'string') {\n    errors.push('Invalid locale');\n  }\n\n  // 验证来源\n  if (!preference.source || typeof preference.source !== 'string') {\n    errors.push('Invalid source');\n  }\n\n  // 验证置信度\n  if (typeof preference.confidence !== 'number' || \n      preference.confidence < 0 || \n      preference.confidence > 1) {\n    errors.push('Invalid confidence value (must be between 0 and 1)');\n  }\n\n  // 验证时间戳\n  if (typeof preference.timestamp !== 'number' || preference.timestamp <= 0) {\n    errors.push('Invalid timestamp');\n  }\n\n  // 验证元数据（如果存在）\n  if (preference.metadata && typeof preference.metadata !== 'object') {\n    errors.push('Invalid metadata');\n  }\n\n  return {\n    isValid: errors.length === 0,\n    errors,\n  };\n}\n\n/**\n * 创建默认偏好\n * Create default preference\n */\nexport function createDefaultPreference(locale: Locale = 'en'): UserLocalePreference {\n  return {\n    locale,\n    source: 'default',\n    confidence: 0.5,\n    timestamp: Date.now(),\n    metadata: {},\n  };\n}\n\n/**\n * 规范化偏好数据\n * Normalize preference data\n */\nexport function normalizePreference(preference: UserLocalePreference): UserLocalePreference {\n  return {\n    locale: preference.locale,\n    source: preference.source,\n    confidence: Math.max(0, Math.min(1, preference.confidence)),\n    timestamp: preference.timestamp || Date.now(),\n    metadata: preference.metadata || {},\n  };\n}\n\n// ==================== 核心偏好管理 ====================\n\n/**\n * 保存用户语言偏好\n * Save user locale preference\n */\nexport function saveUserPreference(preference: UserLocalePreference): StorageOperationResult<UserLocalePreference> {\n  const startTime = Date.now();\n  \n  try {\n    // 验证偏好数据\n    const validation = validatePreferenceData(preference);\n    if (!validation.isValid) {\n      return {\n        success: false,\n        error: `Invalid preference data: ${validation.errors.join(', ')}`,\n        timestamp: Date.now(),\n        responseTime: Date.now() - startTime,\n      };\n    }\n\n    // 规范化数据\n    const normalizedPreference = normalizePreference(preference);\n\n    // 保存到 localStorage\n    const localResult = LocalStorageManager.set('locale_preference', normalizedPreference);\n    \n    // 保存到 cookies（用于 SSR）\n    const cookieResult = CookieManager.set('locale_preference', normalizedPreference.locale);\n\n    // 检查保存结果\n    if (!localResult.success && !cookieResult.success) {\n      return {\n        success: false,\n        error: 'Failed to save preference to both localStorage and cookies',\n        timestamp: Date.now(),\n        responseTime: Date.now() - startTime,\n      };\n    }\n\n    return {\n      success: true,\n      data: normalizedPreference,\n      source: localResult.success ? 'localStorage' : 'cookies',\n      timestamp: Date.now(),\n      responseTime: Date.now() - startTime,\n    };\n  } catch (error) {\n    return {\n      success: false,\n      error: error instanceof Error ? error.message : 'Unknown error',\n      timestamp: Date.now(),\n      responseTime: Date.now() - startTime,\n    };\n  }\n}\n\n/**\n * 获取用户语言偏好\n * Get user locale preference\n */\nexport function getUserPreference(): StorageOperationResult<UserLocalePreference> {\n  const startTime = Date.now();\n  \n  try {\n    // 首先尝试从 localStorage 获取\n    const localPreference = LocalStorageManager.get<UserLocalePreference>('locale_preference');\n    \n    if (localPreference && validatePreferenceData(localPreference).isValid) {\n      return {\n        success: true,\n        data: localPreference,\n        source: 'localStorage',\n        timestamp: Date.now(),\n        responseTime: Date.now() - startTime,\n      };\n    }\n\n    // 如果 localStorage 没有，尝试从 cookies 获取\n    const cookieLocale = CookieManager.get('locale_preference');\n    \n    if (cookieLocale) {\n      const cookiePreference: UserLocalePreference = {\n        locale: cookieLocale as Locale,\n        source: 'cookie',\n        confidence: 0.7,\n        timestamp: Date.now(),\n        metadata: { source: 'cookie_fallback' },\n      };\n\n      // 同步到 localStorage\n      const syncResult = saveUserPreference(cookiePreference);\n      \n      return {\n        success: true,\n        data: cookiePreference,\n        source: 'cookies',\n        timestamp: Date.now(),\n        responseTime: Date.now() - startTime,\n      };\n    }\n\n    // 如果都没有，返回默认偏好\n    const defaultPreference = createDefaultPreference();\n    \n    return {\n      success: true,\n      data: defaultPreference,\n      source: 'default',\n      timestamp: Date.now(),\n      responseTime: Date.now() - startTime,\n    };\n  } catch (error) {\n    return {\n      success: false,\n      error: error instanceof Error ? error.message : 'Unknown error',\n      timestamp: Date.now(),\n      responseTime: Date.now() - startTime,\n    };\n  }\n}\n\n/**\n * 更新偏好置信度\n * Update preference confidence\n */\nexport function updatePreferenceConfidence(confidence: number): StorageOperationResult<UserLocalePreference> {\n  const currentResult = getUserPreference();\n  \n  if (!currentResult.success || !currentResult.data) {\n    return {\n      success: false,\n      error: 'Failed to get current preference',\n      timestamp: Date.now(),\n    };\n  }\n\n  const updatedPreference: UserLocalePreference = {\n    ...currentResult.data,\n    confidence: Math.max(0, Math.min(1, confidence)),\n    timestamp: Date.now(),\n  };\n\n  return saveUserPreference(updatedPreference);\n}\n\n/**\n * 检查偏好是否存在\n * Check if preference exists\n */\nexport function hasUserPreference(): boolean {\n  const localPreference = LocalStorageManager.get<UserLocalePreference>('locale_preference');\n  const cookieLocale = CookieManager.get('locale_preference');\n  \n  return (localPreference && validatePreferenceData(localPreference).isValid) || !!cookieLocale;\n}\n\n/**\n * 获取偏好来源优先级\n * Get preference source priority\n */\nexport function getPreferenceSourcePriority(): Array<{\n  source: string;\n  available: boolean;\n  priority: number;\n}> {\n  const localPreference = LocalStorageManager.get<UserLocalePreference>('locale_preference');\n  const cookieLocale = CookieManager.get('locale_preference');\n\n  return [\n    {\n      source: 'localStorage',\n      available: localPreference && validatePreferenceData(localPreference).isValid,\n      priority: 1,\n    },\n    {\n      source: 'cookies',\n      available: !!cookieLocale,\n      priority: 2,\n    },\n    {\n      source: 'default',\n      available: true,\n      priority: 3,\n    },\n  ];\n}\n\n/**\n * 比较两个偏好\n * Compare two preferences\n */\nexport function comparePreferences(\n  pref1: UserLocalePreference,\n  pref2: UserLocalePreference\n): {\n  isEqual: boolean;\n  differences: string[];\n} {\n  const differences: string[] = [];\n\n  if (pref1.locale !== pref2.locale) {\n    differences.push(`locale: ${pref1.locale} vs ${pref2.locale}`);\n  }\n\n  if (pref1.source !== pref2.source) {\n    differences.push(`source: ${pref1.source} vs ${pref2.source}`);\n  }\n\n  if (Math.abs(pref1.confidence - pref2.confidence) > 0.01) {\n    differences.push(`confidence: ${pref1.confidence} vs ${pref2.confidence}`);\n  }\n\n  if (Math.abs(pref1.timestamp - pref2.timestamp) > 1000) {\n    differences.push(`timestamp: ${pref1.timestamp} vs ${pref2.timestamp}`);\n  }\n\n  return {\n    isEqual: differences.length === 0,\n    differences,\n  };\n}\n\n/**\n * 获取偏好摘要\n * Get preference summary\n */\nexport function getPreferenceSummary(): {\n  hasPreference: boolean;\n  locale: Locale | null;\n  source: string | null;\n  confidence: number | null;\n  age: number | null;\n  isValid: boolean;\n} {\n  const result = getUserPreference();\n  \n  if (!result.success || !result.data) {\n    return {\n      hasPreference: false,\n      locale: null,\n      source: null,\n      confidence: null,\n      age: null,\n      isValid: false,\n    };\n  }\n\n  const preference = result.data;\n  const age = Date.now() - preference.timestamp;\n\n  return {\n    hasPreference: true,\n    locale: preference.locale,\n    source: preference.source,\n    confidence: preference.confidence,\n    age,\n    isValid: validatePreferenceData(preference).isValid,\n  };\n}\n\n/**\n * 清除用户偏好\n * Clear user preference\n */\nexport function clearUserPreference(): StorageOperationResult<void> {\n  const startTime = Date.now();\n  \n  try {\n    // 清除 localStorage\n    const localResult = LocalStorageManager.remove('locale_preference');\n    \n    // 清除 cookies\n    const cookieResult = CookieManager.remove('locale_preference');\n\n    return {\n      success: true,\n      data: undefined,\n      source: 'both',\n      timestamp: Date.now(),\n      responseTime: Date.now() - startTime,\n    };\n  } catch (error) {\n    return {\n      success: false,\n      error: error instanceof Error ? error.message : 'Unknown error',\n      timestamp: Date.now(),\n      responseTime: Date.now() - startTime,\n    };\n  }\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-storage-preference-events.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-storage-preference-events/event-creators.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-storage-preference-events/event-listeners.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-storage-preference-events/event-manager.ts","messages":[{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":137,"column":7,"nodeType":"MemberExpression","endLine":137,"endColumn":33}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 偏好事件管理器\n * Preference Event Manager\n */\n\n'use client';\n\nimport type {\n  StorageEvent,\n  StorageEventListener,\n} from '../locale-storage-types';\nimport { logger } from '@/lib/logger';\n\n/**\n * 偏好事件管理器\n * Preference event manager\n */\nexport class PreferenceEventManager {\n  private static eventListeners: Map<string, StorageEventListener[]> = new Map();\n  private static eventHistory: StorageEvent[] = [];\n  private static readonly MAX_EVENT_HISTORY = 100;\n\n  /**\n   * 添加事件监听器\n   * Add event listener\n   */\n  static addEventListener(eventType: string, listener: StorageEventListener): void {\n    if (!this.eventListeners.has(eventType)) {\n      this.eventListeners.set(eventType, []);\n    }\n    this.eventListeners.get(eventType)!.push(listener);\n  }\n\n  /**\n   * 移除事件监听器\n   * Remove event listener\n   */\n  static removeEventListener(eventType: string, listener: StorageEventListener): void {\n    const listeners = this.eventListeners.get(eventType);\n    if (listeners) {\n      const index = listeners.indexOf(listener);\n      if (index > -1) {\n        listeners.splice(index, 1);\n      }\n    }\n  }\n\n  /**\n   * 移除所有事件监听器\n   * Remove all event listeners\n   */\n  static removeAllListeners(eventType?: string): void {\n    if (eventType) {\n      this.eventListeners.delete(eventType);\n    } else {\n      this.eventListeners.clear();\n    }\n  }\n\n  /**\n   * 发出事件\n   * Emit event\n   */\n  static emitEvent(event: StorageEvent): void {\n    // 记录事件历史\n    this.recordEvent(event);\n\n    // 发送给特定类型的监听器\n    const listeners = this.eventListeners.get(event.type);\n    if (listeners) {\n      listeners.forEach(listener => {\n        try {\n          listener(event);\n        } catch (error) {\n          logger.error(`Error in preference event listener for ${event.type}`, { error: error as Error });\n        }\n      });\n    }\n\n    // 发送给通用监听器\n    const allListeners = this.eventListeners.get('*');\n    if (allListeners) {\n      allListeners.forEach(listener => {\n        try {\n          listener(event);\n        } catch (error) {\n          logger.error('Error in universal preference event listener', { error: error as Error });\n        }\n      });\n    }\n  }\n\n  /**\n   * 记录事件历史\n   * Record event history\n   */\n  private static recordEvent(event: StorageEvent): void {\n    this.eventHistory.unshift(event);\n    \n    // 限制事件历史长度\n    if (this.eventHistory.length > this.MAX_EVENT_HISTORY) {\n      this.eventHistory = this.eventHistory.slice(0, this.MAX_EVENT_HISTORY);\n    }\n  }\n\n  /**\n   * 获取事件历史\n   * Get event history\n   */\n  static getEventHistory(limit?: number): StorageEvent[] {\n    return limit ? this.eventHistory.slice(0, limit) : [...this.eventHistory];\n  }\n\n  /**\n   * 清除事件历史\n   * Clear event history\n   */\n  static clearEventHistory(): void {\n    this.eventHistory = [];\n  }\n\n  /**\n   * 获取监听器统计\n   * Get listener statistics\n   */\n  static getListenerStats(): {\n    totalListeners: number;\n    eventTypes: string[];\n    listenersByType: Record<string, number>;\n  } {\n    let totalListeners = 0;\n    const listenersByType: Record<string, number> = {};\n\n    for (const [eventType, listeners] of this.eventListeners.entries()) {\n      const count = listeners.length;\n      totalListeners += count;\n      listenersByType[eventType] = count;\n    }\n\n    return {\n      totalListeners,\n      eventTypes: Array.from(this.eventListeners.keys()),\n      listenersByType,\n    };\n  }\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-storage-preference-events/history-manager.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-storage-preference-events/stats-analyzer.ts","messages":[{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 24.","line":57,"column":30,"nodeType":"Literal","messageId":"noMagic","endLine":57,"endColumn":32},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 60.","line":57,"column":35,"nodeType":"Literal","messageId":"noMagic","endLine":57,"endColumn":37},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 60.","line":57,"column":40,"nodeType":"Literal","messageId":"noMagic","endLine":57,"endColumn":42}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 偏好统计分析\n * Preference Statistics Analyzer\n */\n\n'use client';\n\nimport { Locale } from '@/types/i18n';\nimport { getPreferenceHistory } from './history-manager';\n\n/**\n * 获取偏好变化统计\n * Get preference change statistics\n */\nexport function getPreferenceChangeStats(): {\n  totalChanges: number;\n  localeChanges: Record<Locale, number>;\n  sourceChanges: Record<string, number>;\n  averageConfidence: number;\n  lastChange: number | null;\n  changeFrequency: number; // changes per day\n} {\n  const history = getPreferenceHistory();\n  \n  const stats = {\n    totalChanges: history.length,\n    localeChanges: {} as Record<Locale, number>,\n    sourceChanges: {} as Record<string, number>,\n    averageConfidence: 0,\n    lastChange: null as number | null,\n    changeFrequency: 0,\n  };\n\n  if (history.length === 0) {\n    return stats;\n  }\n\n  let totalConfidence = 0;\n\n  history.forEach(pref => {\n    // 统计语言变化\n    stats.localeChanges[pref.locale] = (stats.localeChanges[pref.locale] || 0) + 1;\n    \n    // 统计来源变化\n    stats.sourceChanges[pref.source] = (stats.sourceChanges[pref.source] || 0) + 1;\n    \n    // 累计置信度\n    totalConfidence += pref.confidence;\n  });\n\n  stats.averageConfidence = totalConfidence / history.length;\n  stats.lastChange = history[0].timestamp;\n\n  // 计算变化频率\n  if (history.length > 1) {\n    const timeSpan = history[0].timestamp - history[history.length - 1].timestamp;\n    const days = timeSpan / (24 * 60 * 60 * 1000);\n    stats.changeFrequency = days > 0 ? history.length / days : 0;\n  }\n\n  return stats;\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-storage-preference-events/system-manager.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-storage-preference-override.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-storage-preference.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'clearUserPreference' is defined but never used. Allowed unused vars must match /^_/u.","line":30,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":30,"endColumn":22,"suggestions":[{"messageId":"removeVar","data":{"varName":"clearUserPreference"},"fix":{"range":[656,679],"text":""},"desc":"Remove unused variable 'clearUserPreference'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'clearUserPreference' is defined but never used. Allowed unused vars must match /^_/u.","line":30,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":30,"endColumn":22},{"ruleId":"no-unused-vars","severity":2,"message":"'validatePreferenceData' is defined but never used. Allowed unused vars must match /^_/u.","line":31,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":31,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"validatePreferenceData"},"fix":{"range":[679,705],"text":""},"desc":"Remove unused variable 'validatePreferenceData'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'validatePreferenceData' is defined but never used. Allowed unused vars must match /^_/u.","line":31,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":31,"endColumn":25},{"ruleId":"no-unused-vars","severity":2,"message":"'createDefaultPreference' is defined but never used. Allowed unused vars must match /^_/u.","line":32,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":32,"endColumn":26,"suggestions":[{"messageId":"removeVar","data":{"varName":"createDefaultPreference"},"fix":{"range":[705,732],"text":""},"desc":"Remove unused variable 'createDefaultPreference'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'createDefaultPreference' is defined but never used. Allowed unused vars must match /^_/u.","line":32,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":32,"endColumn":26},{"ruleId":"no-unused-vars","severity":2,"message":"'normalizePreference' is defined but never used. Allowed unused vars must match /^_/u.","line":33,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":33,"endColumn":22,"suggestions":[{"messageId":"removeVar","data":{"varName":"normalizePreference"},"fix":{"range":[732,755],"text":""},"desc":"Remove unused variable 'normalizePreference'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'normalizePreference' is defined but never used. Allowed unused vars must match /^_/u.","line":33,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":33,"endColumn":22},{"ruleId":"no-unused-vars","severity":2,"message":"'comparePreferences' is defined but never used. Allowed unused vars must match /^_/u.","line":34,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":34,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"comparePreferences"},"fix":{"range":[755,777],"text":""},"desc":"Remove unused variable 'comparePreferences'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'comparePreferences' is defined but never used. Allowed unused vars must match /^_/u.","line":34,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":34,"endColumn":21},{"ruleId":"no-unused-vars","severity":2,"message":"'getOverrideHistory' is defined but never used. Allowed unused vars must match /^_/u.","line":42,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":42,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"getOverrideHistory"},"fix":{"range":[908,930],"text":""},"desc":"Remove unused variable 'getOverrideHistory'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'getOverrideHistory' is defined but never used. Allowed unused vars must match /^_/u.","line":42,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":42,"endColumn":21},{"ruleId":"no-unused-vars","severity":2,"message":"'exportOverrideData' is defined but never used. Allowed unused vars must match /^_/u.","line":44,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":44,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"exportOverrideData"},"fix":{"range":[950,972],"text":""},"desc":"Remove unused variable 'exportOverrideData'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'exportOverrideData' is defined but never used. Allowed unused vars must match /^_/u.","line":44,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":44,"endColumn":21},{"ruleId":"no-unused-vars","severity":2,"message":"'importOverrideData' is defined but never used. Allowed unused vars must match /^_/u.","line":45,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":45,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"importOverrideData"},"fix":{"range":[972,994],"text":""},"desc":"Remove unused variable 'importOverrideData'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'importOverrideData' is defined but never used. Allowed unused vars must match /^_/u.","line":45,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":45,"endColumn":21},{"ruleId":"no-unused-vars","severity":2,"message":"'PreferenceCacheManager' is defined but never used. Allowed unused vars must match /^_/u.","line":49,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":49,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"PreferenceCacheManager"},"fix":{"range":[1055,1078],"text":""},"desc":"Remove unused variable 'PreferenceCacheManager'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'PreferenceCacheManager' is defined but never used. Allowed unused vars must match /^_/u.","line":49,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":49,"endColumn":25},{"ruleId":"no-unused-vars","severity":2,"message":"'clearPreferenceHistory' is defined but never used. Allowed unused vars must match /^_/u.","line":67,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":67,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"clearPreferenceHistory"},"fix":{"range":[1493,1519],"text":""},"desc":"Remove unused variable 'clearPreferenceHistory'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'clearPreferenceHistory' is defined but never used. Allowed unused vars must match /^_/u.","line":67,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":67,"endColumn":25},{"ruleId":"no-unused-vars","severity":2,"message":"'setupDefaultListeners' is defined but never used. Allowed unused vars must match /^_/u.","line":69,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":69,"endColumn":24,"suggestions":[{"messageId":"removeVar","data":{"varName":"setupDefaultListeners"},"fix":{"range":[1547,1572],"text":""},"desc":"Remove unused variable 'setupDefaultListeners'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'setupDefaultListeners' is defined but never used. Allowed unused vars must match /^_/u.","line":69,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":69,"endColumn":24},{"ruleId":"no-unused-vars","severity":2,"message":"'cleanupEventSystem' is defined but never used. Allowed unused vars must match /^_/u.","line":70,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":70,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"cleanupEventSystem"},"fix":{"range":[1572,1594],"text":""},"desc":"Remove unused variable 'cleanupEventSystem'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'cleanupEventSystem' is defined but never used. Allowed unused vars must match /^_/u.","line":70,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":70,"endColumn":21},{"ruleId":"no-unused-vars","severity":2,"message":"'getEventSystemStatus' is defined but never used. Allowed unused vars must match /^_/u.","line":71,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":71,"endColumn":23,"suggestions":[{"messageId":"removeVar","data":{"varName":"getEventSystemStatus"},"fix":{"range":[1594,1618],"text":""},"desc":"Remove unused variable 'getEventSystemStatus'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'getEventSystemStatus' is defined but never used. Allowed unused vars must match /^_/u.","line":71,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":71,"endColumn":23}],"suppressedMessages":[],"errorCount":26,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 用户语言偏好管理 - 主入口\n * User Locale Preference Management - Main Entry Point\n *\n * 统一的用户语言偏好管理入口，整合所有偏好管理功能模块\n */\n\n'use client';\n\n// 重新导出所有模块的功能\nexport * from './locale-storage-preference-core';\nexport * from './locale-storage-preference-override';\nexport * from './locale-storage-preference-cache';\nexport * from './locale-storage-preference-events';\n\n// 导入主要功能用于向后兼容\nimport { Locale } from '@/types/i18n';\nimport type {\n  UserLocalePreference,\n  StorageOperationResult,\n  StorageEventListener,\n} from './locale-storage-types';\n\nimport {\n  saveUserPreference,\n  getUserPreference,\n  updatePreferenceConfidence,\n  hasUserPreference,\n  getPreferenceSummary,\n  clearUserPreference,\n  validatePreferenceData,\n  createDefaultPreference,\n  normalizePreference,\n  comparePreferences,\n} from './locale-storage-preference-core';\n\nimport {\n  setUserOverride,\n  getUserOverride,\n  clearUserOverride,\n  hasUserOverride,\n  getOverrideHistory,\n  getOverrideStats,\n  exportOverrideData,\n  importOverrideData,\n} from './locale-storage-preference-override';\n\nimport {\n  PreferenceCacheManager,\n  syncPreferenceData,\n  checkDataConsistency,\n  fixDataInconsistency,\n  getStorageUsage,\n  optimizeStoragePerformance,\n} from './locale-storage-preference-cache';\n\nimport {\n  PreferenceEventManager,\n  createPreferenceSavedEvent,\n  createPreferenceLoadedEvent,\n  createOverrideSetEvent,\n  createOverrideClearedEvent,\n  createSyncEvent,\n  createPreferenceErrorEvent,\n  getPreferenceHistory,\n  recordPreferenceHistory,\n  clearPreferenceHistory,\n  getPreferenceChangeStats,\n  setupDefaultListeners,\n  cleanupEventSystem,\n  getEventSystemStatus,\n} from './locale-storage-preference-events';\n\n/**\n * 用户偏好管理器 - 向后兼容类\n * User preference manager - Backward compatible class\n */\nexport class LocalePreferenceManager {\n  /**\n   * 保存用户语言偏好\n   * Save user locale preference\n   */\n  static saveUserPreference(preference: UserLocalePreference): StorageOperationResult<UserLocalePreference> {\n    const result = saveUserPreference(preference);\n\n    if (result.success && result.data) {\n      PreferenceEventManager.emitEvent(createPreferenceSavedEvent(result.data, result.source || 'unknown'));\n      recordPreferenceHistory(result.data);\n    } else {\n      PreferenceEventManager.emitEvent(createPreferenceErrorEvent('saveUserPreference', result.error || 'Unknown error'));\n    }\n\n    return result;\n  }\n\n  /**\n   * 获取用户语言偏好\n   * Get user locale preference\n   */\n  static getUserPreference(): StorageOperationResult<UserLocalePreference> {\n    const result = getUserPreference();\n\n    if (result.success && result.data) {\n      PreferenceEventManager.emitEvent(createPreferenceLoadedEvent(result.data, result.source || 'unknown'));\n    } else {\n      PreferenceEventManager.emitEvent(createPreferenceErrorEvent('getUserPreference', result.error || 'Unknown error'));\n    }\n\n    return result;\n  }\n\n  /**\n   * 设置用户手动选择的语言\n   * Set user manually selected locale\n   */\n  static setUserOverride(locale: Locale, metadata?: Record<string, unknown>): StorageOperationResult<UserLocalePreference> {\n    const result = setUserOverride(locale, metadata);\n\n    if (result.success) {\n      PreferenceEventManager.emitEvent(createOverrideSetEvent(locale, metadata));\n    } else {\n      PreferenceEventManager.emitEvent(createPreferenceErrorEvent('setUserOverride', result.error || 'Unknown error'));\n    }\n\n    return result;\n  }\n\n  /**\n   * 获取用户手动选择的语言\n   * Get user manually selected locale\n   */\n  static getUserOverride(): StorageOperationResult<Locale> {\n    return getUserOverride();\n  }\n\n  /**\n   * 清除用户手动选择\n   * Clear user manual selection\n   */\n  static clearUserOverride(): StorageOperationResult<void> {\n    const result = clearUserOverride();\n\n    if (result.success) {\n      PreferenceEventManager.emitEvent(createOverrideClearedEvent());\n    } else {\n      PreferenceEventManager.emitEvent(createPreferenceErrorEvent('clearUserOverride', result.error || 'Unknown error'));\n    }\n\n    return result;\n  }\n\n  /**\n   * 更新偏好的置信度\n   * Update preference confidence\n   */\n  static updatePreferenceConfidence(confidence: number): StorageOperationResult<UserLocalePreference> {\n    return updatePreferenceConfidence(confidence);\n  }\n\n  /**\n   * 获取偏好历史\n   * Get preference history\n   */\n  static getPreferenceHistory(): UserLocalePreference[] {\n    return getPreferenceHistory();\n  }\n\n  /**\n   * 添加事件监听器\n   * Add event listener\n   */\n  static addEventListener(eventType: string, listener: StorageEventListener): void {\n    PreferenceEventManager.addEventListener(eventType, listener);\n  }\n\n  /**\n   * 移除事件监听器\n   * Remove event listener\n   */\n  static removeEventListener(eventType: string, listener: StorageEventListener): void {\n    PreferenceEventManager.removeEventListener(eventType, listener);\n  }\n\n  /**\n   * 移除所有事件监听器\n   * Remove all event listeners\n   */\n  static removeAllListeners(): void {\n    PreferenceEventManager.removeAllListeners();\n  }\n\n  /**\n   * 检查是否有用户偏好\n   * Check if user preference exists\n   */\n  static hasUserPreference(): boolean {\n    return hasUserPreference();\n  }\n\n  /**\n   * 检查是否有用户覆盖\n   * Check if user override exists\n   */\n  static hasUserOverride(): boolean {\n    return hasUserOverride();\n  }\n\n  /**\n   * 获取偏好摘要\n   * Get preference summary\n   */\n  static getPreferenceSummary(): ReturnType<typeof getPreferenceSummary> {\n    return getPreferenceSummary();\n  }\n\n  /**\n   * 同步偏好数据\n   * Sync preference data\n   */\n  static syncPreferenceData(): ReturnType<typeof syncPreferenceData> {\n    const result = syncPreferenceData();\n\n    if (result.success && result.data) {\n      PreferenceEventManager.emitEvent(createSyncEvent(result.data.synced, result.data));\n    }\n\n    return result;\n  }\n\n  /**\n   * 检查数据一致性\n   * Check data consistency\n   */\n  static checkDataConsistency(): ReturnType<typeof checkDataConsistency> {\n    return checkDataConsistency();\n  }\n\n  /**\n   * 修复数据不一致\n   * Fix data inconsistency\n   */\n  static fixDataInconsistency(): ReturnType<typeof fixDataInconsistency> {\n    return fixDataInconsistency();\n  }\n\n  /**\n   * 获取存储使用情况\n   * Get storage usage\n   */\n  static getStorageUsage(): ReturnType<typeof getStorageUsage> {\n    return getStorageUsage();\n  }\n\n  /**\n   * 优化存储性能\n   * Optimize storage performance\n   */\n  static optimizeStoragePerformance(): ReturnType<typeof optimizeStoragePerformance> {\n    return optimizeStoragePerformance();\n  }\n\n  /**\n   * 获取覆盖统计\n   * Get override statistics\n   */\n  static getOverrideStats(): ReturnType<typeof getOverrideStats> {\n    return getOverrideStats();\n  }\n\n  /**\n   * 获取偏好变化统计\n   * Get preference change statistics\n   */\n  static getPreferenceChangeStats(): ReturnType<typeof getPreferenceChangeStats> {\n    return getPreferenceChangeStats();\n  }\n}\n\n// ==================== 向后兼容的类型别名 ====================\n\n/**\n * 向后兼容的类型别名\n * Backward compatible type aliases\n */\nexport type {\n  LocalePreferenceManager as PreferenceManager,\n};\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-storage-types-base.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-storage-types-config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-storage-types-config/defaults.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-storage-types-config/factory.ts","messages":[{"ruleId":"security/detect-object-injection","severity":2,"message":"Variable Assigned to Object Injection Sink","line":32,"column":20,"nodeType":"MemberExpression","endLine":32,"endColumn":47},{"ruleId":"max-statements","severity":2,"message":"Method 'validate' has too many statements (29). Maximum allowed is 20.","line":64,"column":11,"nodeType":"FunctionExpression","messageId":"exceed","endLine":124,"endColumn":4},{"ruleId":"complexity","severity":2,"message":"Method 'validate' has a complexity of 20. Maximum allowed is 15.","line":64,"column":11,"nodeType":"FunctionExpression","messageId":"complex","endLine":124,"endColumn":4},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":132,"column":55,"nodeType":"MemberExpression","endLine":132,"endColumn":96}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 语言存储系统配置工厂\n * Locale Storage System Configuration Factory\n */\n\nimport type { EnvironmentType } from '../locale-storage-types-base';\nimport type { ValidationResult } from '../locale-storage-types-data';\nimport type { StorageConfig } from './interfaces';\nimport { DEFAULT_STORAGE_CONFIG } from './defaults';\nimport { CONFIG_PRESETS } from './presets';\nimport { CONFIG_VALIDATION_RULES } from './validation';\n\n/**\n * 配置工厂函数\n * Configuration factory functions\n */\nexport const ConfigFactory = {\n  /**\n   * 创建默认配置\n   * Create default configuration\n   */\n  createDefault(): StorageConfig {\n    return { ...DEFAULT_STORAGE_CONFIG };\n  },\n\n  /**\n   * 创建环境配置\n   * Create environment configuration\n   */\n  createForEnvironment(environment: EnvironmentType): StorageConfig {\n    const baseConfig = this.createDefault();\n    const preset = CONFIG_PRESETS[environment];\n    \n    if (preset) {\n      return this.merge(baseConfig, preset);\n    }\n    \n    return baseConfig;\n  },\n\n  /**\n   * 合并配置\n   * Merge configurations\n   */\n  merge(base: StorageConfig, override: Partial<StorageConfig>): StorageConfig {\n    return {\n      ...base,\n      ...override,\n      retention: { ...base.retention, ...override.retention },\n      performance: { ...base.performance, ...override.performance },\n      compression: { ...base.compression, ...override.compression },\n      encryption: { ...base.encryption, ...override.encryption },\n      sync: { ...base.sync, ...override.sync },\n      healthCheck: { ...base.healthCheck, ...override.healthCheck },\n      errorHandling: { ...base.errorHandling, ...override.errorHandling },\n      debug: { ...base.debug, ...override.debug },\n    };\n  },\n\n  /**\n   * 验证配置\n   * Validate configuration\n   */\n  validate(config: unknown): ValidationResult {\n    const errors: string[] = [];\n    const warnings: string[] = [];\n\n    if (!config || typeof config !== 'object') {\n      errors.push('Configuration must be an object');\n      return { isValid: false, errors, warnings };\n    }\n\n    const cfg = config as Record<string, unknown>;\n\n    // 验证必需字段\n    for (const field of CONFIG_VALIDATION_RULES.required) {\n      if (this.getNestedValue(cfg, field) === undefined) {\n        errors.push(`Required field '${field}' is missing`);\n      }\n    }\n\n    // 验证类型\n    for (const [field, expectedType] of Object.entries(CONFIG_VALIDATION_RULES.types)) {\n      const value = this.getNestedValue(cfg, field);\n      if (value !== undefined && typeof value !== expectedType) {\n        errors.push(`Field '${field}' must be of type ${expectedType}`);\n      }\n    }\n\n    // 验证范围\n    for (const [field, range] of Object.entries(CONFIG_VALIDATION_RULES.ranges)) {\n      const value = this.getNestedValue(cfg, field) as number;\n      if (typeof value === 'number') {\n        if (range.min !== undefined && value < range.min) {\n          errors.push(`Field '${field}' must be >= ${range.min}`);\n        }\n        if (range.max !== undefined && value > range.max) {\n          errors.push(`Field '${field}' must be <= ${range.max}`);\n        }\n      }\n    }\n\n    // 验证枚举\n    for (const [field, allowedValues] of Object.entries(CONFIG_VALIDATION_RULES.enums)) {\n      const value = this.getNestedValue(cfg, field) as string;\n      if (typeof value === 'string' && !allowedValues.includes(value)) {\n        errors.push(`Field '${field}' must be one of: ${allowedValues.join(', ')}`);\n      }\n    }\n\n    // 自定义验证\n    for (const [field, validator] of Object.entries(CONFIG_VALIDATION_RULES.custom)) {\n      const value = this.getNestedValue(cfg, field);\n      if (value !== undefined && !validator(value)) {\n        errors.push(`Field '${field}' failed custom validation`);\n      }\n    }\n\n    return {\n      isValid: errors.length === 0,\n      errors,\n      warnings,\n    };\n  },\n\n  /**\n   * 获取嵌套值\n   * Get nested value\n   */\n  getNestedValue(obj: Record<string, unknown>, path: string): unknown {\n    return path.split('.').reduce((current, key) => {\n      return current && typeof current === 'object' ? (current as Record<string, unknown>)[key] : undefined;\n    }, obj);\n  },\n} as const;\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-storage-types-config/interfaces.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-storage-types-config/migrations.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'value' is defined but never used. Allowed unused args must match /^_/u.","line":18,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":32,"suggestions":[{"messageId":"removeVar","data":{"varName":"value"},"fix":{"range":[362,376],"text":""},"desc":"Remove unused variable 'value'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 语言存储系统配置迁移\n * Locale Storage System Configuration Migrations\n */\n\n/**\n * 配置迁移映射\n * Configuration migration mapping\n */\nexport interface ConfigMigration {\n  fromVersion: string;\n  toVersion: string;\n  migrations: Array<{\n    path: string;\n    action: 'rename' | 'move' | 'transform' | 'delete' | 'add';\n    from?: string;\n    to?: string;\n    transform?: (value: unknown) => unknown;\n    defaultValue?: unknown;\n  }>;\n}\n\n/**\n * 配置迁移历史\n * Configuration migration history\n */\nexport const CONFIG_MIGRATIONS: ConfigMigration[] = [\n  {\n    fromVersion: '1.0.0',\n    toVersion: '1.1.0',\n    migrations: [\n      {\n        path: 'enableMemoryCache',\n        action: 'add',\n        defaultValue: true,\n      },\n      {\n        path: 'performance.throttleDelay',\n        action: 'add',\n        defaultValue: 100,\n      },\n    ],\n  },\n  {\n    fromVersion: '1.1.0',\n    toVersion: '2.0.0',\n    migrations: [\n      {\n        path: 'maxEntries',\n        action: 'move',\n        to: 'performance.maxEntries',\n      },\n      {\n        path: 'maxSize',\n        action: 'move',\n        to: 'performance.maxSize',\n      },\n      {\n        path: 'compressionEnabled',\n        action: 'transform',\n        to: 'compression.enabled',\n        transform: (value: unknown) => Boolean(value),\n      },\n    ],\n  },\n];\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-storage-types-config/presets.ts","messages":[{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 30.","line":23,"column":17,"nodeType":"Literal","messageId":"noMagic","endLine":23,"endColumn":19},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 5.","line":24,"column":16,"nodeType":"Literal","messageId":"noMagic","endLine":24,"endColumn":17},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 5.","line":58,"column":17,"nodeType":"Literal","messageId":"noMagic","endLine":58,"endColumn":18},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 60.","line":58,"column":21,"nodeType":"Literal","messageId":"noMagic","endLine":58,"endColumn":23},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 10.","line":59,"column":16,"nodeType":"Literal","messageId":"noMagic","endLine":59,"endColumn":18},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 1024.","line":89,"column":16,"nodeType":"Literal","messageId":"noMagic","endLine":89,"endColumn":20},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 1024.","line":89,"column":23,"nodeType":"Literal","messageId":"noMagic","endLine":89,"endColumn":27},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 7.","line":99,"column":20,"nodeType":"Literal","messageId":"noMagic","endLine":99,"endColumn":21},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 24.","line":99,"column":24,"nodeType":"Literal","messageId":"noMagic","endLine":99,"endColumn":26},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 60.","line":99,"column":29,"nodeType":"Literal","messageId":"noMagic","endLine":99,"endColumn":31},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 60.","line":99,"column":34,"nodeType":"Literal","messageId":"noMagic","endLine":99,"endColumn":36},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 3.","line":100,"column":16,"nodeType":"Literal","messageId":"noMagic","endLine":100,"endColumn":17},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 24.","line":100,"column":20,"nodeType":"Literal","messageId":"noMagic","endLine":100,"endColumn":22},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 60.","line":100,"column":25,"nodeType":"Literal","messageId":"noMagic","endLine":100,"endColumn":27},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 60.","line":100,"column":30,"nodeType":"Literal","messageId":"noMagic","endLine":100,"endColumn":32},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 30.","line":101,"column":18,"nodeType":"Literal","messageId":"noMagic","endLine":101,"endColumn":20},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 24.","line":101,"column":23,"nodeType":"Literal","messageId":"noMagic","endLine":101,"endColumn":25},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 60.","line":101,"column":28,"nodeType":"Literal","messageId":"noMagic","endLine":101,"endColumn":30},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 60.","line":101,"column":33,"nodeType":"Literal","messageId":"noMagic","endLine":101,"endColumn":35},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 6.","line":102,"column":14,"nodeType":"Literal","messageId":"noMagic","endLine":102,"endColumn":15},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 60.","line":102,"column":18,"nodeType":"Literal","messageId":"noMagic","endLine":102,"endColumn":20},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 60.","line":102,"column":23,"nodeType":"Literal","messageId":"noMagic","endLine":102,"endColumn":25}],"suppressedMessages":[],"errorCount":22,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 语言存储系统环境配置预设\n * Locale Storage System Environment Configuration Presets\n */\n\nimport type { StorageConfig } from './interfaces';\n\n/**\n * 配置预设\n * Configuration presets\n */\nexport const CONFIG_PRESETS: Record<string, Partial<StorageConfig>> = {\n  // 开发环境预设\n  development: {\n    debug: {\n      enabled: true,\n      logLevel: 'debug',\n      logToConsole: true,\n      logToStorage: true,\n    },\n    healthCheck: {\n      enabled: true,\n      interval: 30 * 1000, // 30秒\n      timeout: 5 * 1000,\n      retryAttempts: 1,\n    },\n    errorHandling: {\n      retryAttempts: 1,\n      retryDelay: 500,\n      fallbackStorage: ['localStorage', 'memory'],\n      logErrors: true,\n    },\n  },\n  \n  // 生产环境预设\n  production: {\n    debug: {\n      enabled: false,\n      logLevel: 'error',\n      logToConsole: false,\n      logToStorage: true,\n    },\n    compression: {\n      enabled: true,\n      algorithm: 'gzip',\n      threshold: 512,\n    },\n    encryption: {\n      enabled: true,\n      algorithm: 'aes-256-gcm',\n      keyDerivation: 'pbkdf2',\n      keyLength: 32,\n      saltLength: 16,\n      iterations: 100000,\n    },\n    healthCheck: {\n      enabled: true,\n      interval: 5 * 60 * 1000, // 5分钟\n      timeout: 10 * 1000,\n      retryAttempts: 3,\n    },\n  },\n  \n  // 测试环境预设\n  test: {\n    enableCookies: false,\n    enableLocalStorage: false,\n    enableSessionStorage: false,\n    enableIndexedDB: false,\n    enableMemoryCache: true,\n    debug: {\n      enabled: false,\n      logLevel: 'error',\n      logToConsole: false,\n      logToStorage: false,\n    },\n    healthCheck: {\n      enabled: false,\n      interval: 0,\n      timeout: 0,\n      retryAttempts: 0,\n    },\n  },\n  \n  // 高性能预设\n  performance: {\n    performance: {\n      maxEntries: 50,\n      maxSize: 1024 * 1024, // 1MB\n      batchSize: 20,\n      throttleDelay: 50,\n    },\n    compression: {\n      enabled: true,\n      algorithm: 'lz4',\n      threshold: 256,\n    },\n    retention: {\n      preferences: 7 * 24 * 60 * 60 * 1000, // 7天\n      history: 3 * 24 * 60 * 60 * 1000, // 3天\n      analytics: 30 * 24 * 60 * 60 * 1000, // 30天\n      cache: 6 * 60 * 60 * 1000, // 6小时\n    },\n  },\n  \n  // 安全预设\n  security: {\n    encryption: {\n      enabled: true,\n      algorithm: 'chacha20-poly1305',\n      keyDerivation: 'argon2',\n      keyLength: 32,\n      saltLength: 32,\n      iterations: 200000,\n    },\n    sync: {\n      enabled: true,\n      conflictResolution: 'server',\n      authentication: {\n        type: 'oauth',\n        credentials: {},\n      },\n    },\n    debug: {\n      enabled: false,\n      logLevel: 'error',\n      logToConsole: false,\n      logToStorage: false,\n    },\n  },\n};\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-storage-types-config/validation.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'value' is defined but never used. Allowed unused args must match /^_/u.","line":16,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":41,"suggestions":[{"messageId":"removeVar","data":{"varName":"value"},"fix":{"range":[370,384],"text":""},"desc":"Remove unused variable 'value'."}]},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 365.","line":48,"column":45,"nodeType":"Literal","messageId":"noMagic","endLine":48,"endColumn":48},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 24.","line":48,"column":51,"nodeType":"Literal","messageId":"noMagic","endLine":48,"endColumn":53},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 60.","line":48,"column":56,"nodeType":"Literal","messageId":"noMagic","endLine":48,"endColumn":58},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 60.","line":48,"column":61,"nodeType":"Literal","messageId":"noMagic","endLine":48,"endColumn":63},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 1024.","line":50,"column":52,"nodeType":"Literal","messageId":"noMagic","endLine":50,"endColumn":56},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 1024.","line":50,"column":59,"nodeType":"Literal","messageId":"noMagic","endLine":50,"endColumn":63},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 10.","line":52,"column":45,"nodeType":"Literal","messageId":"noMagic","endLine":52,"endColumn":47},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 1024.","line":52,"column":50,"nodeType":"Literal","messageId":"noMagic","endLine":52,"endColumn":54},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 1024.","line":52,"column":57,"nodeType":"Literal","messageId":"noMagic","endLine":52,"endColumn":61}],"suppressedMessages":[],"errorCount":10,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 语言存储系统配置验证规则\n * Locale Storage System Configuration Validation Rules\n */\n\n/**\n * 配置验证规则\n * Configuration validation rules\n */\nexport interface ConfigValidationRules {\n  required: string[];\n  optional: string[];\n  types: Record<string, string>;\n  ranges: Record<string, { min?: number; max?: number }>;\n  enums: Record<string, string[]>;\n  custom: Record<string, (value: unknown) => boolean>;\n}\n\n/**\n * 配置验证器\n * Configuration validator\n */\nexport const CONFIG_VALIDATION_RULES: ConfigValidationRules = {\n  required: [\n    'enableCookies',\n    'enableLocalStorage',\n    'retention.preferences',\n    'performance.maxEntries',\n  ],\n  \n  optional: [\n    'compression.enabled',\n    'encryption.enabled',\n    'sync.enabled',\n    'debug.enabled',\n  ],\n  \n  types: {\n    'enableCookies': 'boolean',\n    'enableLocalStorage': 'boolean',\n    'retention.preferences': 'number',\n    'performance.maxEntries': 'number',\n    'compression.algorithm': 'string',\n    'encryption.algorithm': 'string',\n  },\n  \n  ranges: {\n    'retention.preferences': { min: 0, max: 365 * 24 * 60 * 60 * 1000 },\n    'performance.maxEntries': { min: 1, max: 10000 },\n    'performance.maxSize': { min: 1024, max: 100 * 1024 * 1024 },\n    'encryption.keyLength': { min: 16, max: 64 },\n    'compression.threshold': { min: 0, max: 10 * 1024 * 1024 },\n  },\n  \n  enums: {\n    'compression.algorithm': ['none', 'gzip', 'lz4', 'brotli'],\n    'encryption.algorithm': ['none', 'aes-256-gcm', 'chacha20-poly1305'],\n    'sync.conflictResolution': ['client', 'server', 'merge', 'manual'],\n    'debug.logLevel': ['error', 'warn', 'info', 'debug'],\n  },\n  \n  custom: {\n    'retention.preferences': (value: unknown) => {\n      return typeof value === 'number' && value >= 0;\n    },\n    'performance.maxEntries': (value: unknown) => {\n      return typeof value === 'number' && value > 0 && Number.isInteger(value);\n    },\n  },\n};\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-storage-types-data.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'StorageType' is defined but never used. Allowed unused vars must match /^_/u.","line":12,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":14,"suggestions":[{"messageId":"removeVar","data":{"varName":"StorageType"},"fix":{"range":[194,210],"text":""},"desc":"Remove unused variable 'StorageType'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'StorageType' is defined but never used. Allowed unused vars must match /^_/u.","line":12,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":12,"endColumn":14},{"ruleId":"no-unused-vars","severity":2,"message":"'MigrationStatus' is defined but never used. Allowed unused vars must match /^_/u.","line":16,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":18,"suggestions":[{"messageId":"removeVar","data":{"varName":"MigrationStatus"},"fix":{"range":[271,290],"text":""},"desc":"Remove unused variable 'MigrationStatus'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'MigrationStatus' is defined but never used. Allowed unused vars must match /^_/u.","line":16,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":16,"endColumn":18},{"ruleId":"no-unused-vars","severity":2,"message":"'event' is defined but never used. Allowed unused args must match /^_/u.","line":115,"column":50,"nodeType":"Identifier","messageId":"unusedVar","endLine":115,"endColumn":72,"suggestions":[{"messageId":"removeVar","data":{"varName":"event"},"fix":{"range":[2113,2135],"text":""},"desc":"Remove unused variable 'event'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'data' is defined but never used. Allowed unused args must match /^_/u.","line":193,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":193,"endColumn":28,"suggestions":[{"messageId":"removeVar","data":{"varName":"data"},"fix":{"range":[3656,3669],"text":""},"desc":"Remove unused variable 'data'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'data' is defined but never used. Allowed unused args must match /^_/u.","line":194,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":194,"endColumn":30,"suggestions":[{"messageId":"removeVar","data":{"varName":"data"},"fix":{"range":[3708,3721],"text":""},"desc":"Remove unused variable 'data'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'data' is defined but never used. Allowed unused args must match /^_/u.","line":197,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":197,"endColumn":35,"suggestions":[{"messageId":"removeVar","data":{"varName":"data"},"fix":{"range":[3788,3801],"text":""},"desc":"Remove unused variable 'data'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'data' is defined but never used. Allowed unused args must match /^_/u.","line":198,"column":23,"nodeType":"Identifier","messageId":"unusedVar","endLine":198,"endColumn":36,"suggestions":[{"messageId":"removeVar","data":{"varName":"data"},"fix":{"range":[3846,3859],"text":""},"desc":"Remove unused variable 'data'."}]}],"suppressedMessages":[],"errorCount":9,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 语言存储系统数据结构接口\n * Locale Storage System Data Structure Interfaces\n * \n * 提供语言偏好存储系统所需的数据结构接口定义\n */\n\nimport { Locale } from '@/types/i18n';\nimport type { \n  LocaleSource, \n  StorageEventType, \n  StorageType,\n  CompressionAlgorithm,\n  EncryptionAlgorithm,\n  SyncStatus,\n  MigrationStatus,\n  HealthStatus,\n  ErrorType,\n  PriorityLevel,\n  BrowserType,\n  DeviceType,\n  OSType,\n  VersionInfo,\n} from './locale-storage-types-base';\n\n/**\n * 用户偏好数据结构\n * User locale preference data structure\n */\nexport interface UserLocalePreference {\n  locale: Locale;\n  source: LocaleSource;\n  timestamp: number;\n  confidence: number; // 0-1, 检测置信度\n  metadata?: {\n    userAgent?: string;\n    ipCountry?: string;\n    browserLanguages?: string[];\n    timezone?: string;\n    [key: string]: unknown;\n  };\n}\n\n/**\n * 语言检测记录\n * Locale detection record\n */\nexport interface LocaleDetectionRecord {\n  locale: Locale;\n  source: LocaleSource;\n  confidence: number;\n  timestamp: number;\n  metadata?: Record<string, unknown>;\n}\n\n/**\n * 语言检测历史\n * Locale detection history\n */\nexport interface LocaleDetectionHistory {\n  detections: LocaleDetectionRecord[];\n  lastUpdated: number;\n  totalDetections: number;\n  metadata?: Record<string, unknown>;\n}\n\n/**\n * 存储统计信息\n * Storage statistics\n */\nexport interface StorageStats {\n  totalEntries: number;\n  totalSize: number;\n  lastAccessed: number;\n  lastModified: number;\n  accessCount: number;\n  errorCount: number;\n  compressionRatio?: number;\n  encryptionEnabled?: boolean;\n  syncStatus?: SyncStatus;\n  healthStatus?: HealthStatus;\n}\n\n/**\n * 存储操作结果\n * Storage operation result\n */\nexport interface StorageOperationResult<T = unknown> {\n  success: boolean;\n  data?: T;\n  error?: string;\n  timestamp: number;\n  responseTime?: number;\n  source?: string;\n  metadata?: Record<string, unknown>;\n}\n\n/**\n * 存储事件\n * Storage event\n */\nexport interface StorageEvent<T = unknown> {\n  type: StorageEventType;\n  data?: T;\n  timestamp: number;\n  source: string;\n  target?: string;\n  metadata?: Record<string, unknown>;\n}\n\n/**\n * 存储事件监听器\n * Storage event listener\n */\nexport type StorageEventListener<T = unknown> = (event: StorageEvent<T>) => void;\n\n/**\n * 存储健康检查\n * Storage health check\n */\nexport interface StorageHealthCheck {\n  isHealthy: boolean;\n  status: HealthStatus;\n  issues: Array<{\n    type: ErrorType;\n    severity: PriorityLevel;\n    message: string;\n    timestamp: number;\n  }>;\n  performance: {\n    readLatency: number;\n    writeLatency: number;\n    errorRate: number;\n    availability: number;\n  };\n  storage: {\n    used: number;\n    available: number;\n    quota: number;\n    utilization: number;\n  };\n  lastCheck: number;\n}\n\n/**\n * 验证结果\n * Validation result\n */\nexport interface ValidationResult {\n  isValid: boolean;\n  errors: string[];\n  warnings: string[];\n  metadata?: Record<string, unknown>;\n}\n\n/**\n * 存储备份数据\n * Storage backup data\n */\nexport interface StorageBackupData {\n  version: string;\n  timestamp: number;\n  checksum: string;\n  data: {\n    preferences: UserLocalePreference[];\n    history: LocaleDetectionHistory[];\n    analytics: Record<string, unknown>[];\n    settings: Record<string, unknown>;\n  };\n  metadata: {\n    environment: string;\n    userAgent: string;\n    compression?: CompressionAlgorithm;\n    encryption?: EncryptionAlgorithm;\n    size: number;\n    entryCount: number;\n  };\n}\n\n/**\n * 存储迁移配置\n * Storage migration configuration\n */\nexport interface StorageMigrationConfig {\n  fromVersion: string;\n  toVersion: string;\n  strategy: 'incremental' | 'full' | 'selective';\n  backupBeforeMigration: boolean;\n  rollbackOnFailure: boolean;\n  migrationSteps: Array<{\n    name: string;\n    description: string;\n    execute: (data: unknown) => Promise<unknown>;\n    rollback?: (data: unknown) => Promise<unknown>;\n  }>;\n  validation?: {\n    preValidation?: (data: unknown) => ValidationResult;\n    postValidation?: (data: unknown) => ValidationResult;\n  };\n}\n\n/**\n * 存储压缩配置\n * Storage compression configuration\n */\nexport interface StorageCompressionConfig {\n  enabled: boolean;\n  algorithm: CompressionAlgorithm;\n  threshold: number; // 压缩阈值（字节）\n  level?: number; // 压缩级别\n  options?: Record<string, unknown>;\n}\n\n/**\n * 存储加密配置\n * Storage encryption configuration\n */\nexport interface StorageEncryptionConfig {\n  enabled: boolean;\n  algorithm: EncryptionAlgorithm;\n  keyDerivation: 'pbkdf2' | 'scrypt' | 'argon2';\n  keyLength: number;\n  saltLength: number;\n  iterations?: number;\n  options?: Record<string, unknown>;\n}\n\n/**\n * 存储同步配置\n * Storage synchronization configuration\n */\nexport interface StorageSyncConfig {\n  enabled: boolean;\n  endpoint?: string;\n  interval: number;\n  retryAttempts: number;\n  timeout: number;\n  conflictResolution: 'client' | 'server' | 'merge' | 'manual';\n  authentication?: {\n    type: 'bearer' | 'basic' | 'oauth';\n    credentials: Record<string, string>;\n  };\n}\n\n/**\n * 设备信息\n * Device information\n */\nexport interface DeviceInfo {\n  browser: {\n    type: BrowserType;\n    version: string;\n    userAgent: string;\n  };\n  device: {\n    type: DeviceType;\n    model?: string;\n    vendor?: string;\n  };\n  os: {\n    type: OSType;\n    version: string;\n    architecture?: string;\n  };\n  screen: {\n    width: number;\n    height: number;\n    pixelRatio: number;\n    colorDepth: number;\n  };\n  capabilities: {\n    localStorage: boolean;\n    sessionStorage: boolean;\n    indexedDB: boolean;\n    cookies: boolean;\n    webWorkers: boolean;\n    serviceWorkers: boolean;\n  };\n}\n\n/**\n * 网络信息\n * Network information\n */\nexport interface NetworkInfo {\n  type: 'wifi' | 'cellular' | 'ethernet' | 'unknown';\n  effectiveType: 'slow-2g' | '2g' | '3g' | '4g' | 'unknown';\n  downlink: number;\n  rtt: number;\n  saveData: boolean;\n  online: boolean;\n}\n\n/**\n * 地理位置信息\n * Geolocation information\n */\nexport interface GeolocationInfo {\n  country: string;\n  region?: string;\n  city?: string;\n  timezone: string;\n  coordinates?: {\n    latitude: number;\n    longitude: number;\n    accuracy: number;\n  };\n  ipAddress?: string;\n  isp?: string;\n}\n\n/**\n * 用户会话信息\n * User session information\n */\nexport interface SessionInfo {\n  sessionId: string;\n  startTime: number;\n  lastActivity: number;\n  pageViews: number;\n  interactions: number;\n  referrer?: string;\n  landingPage: string;\n  currentPage: string;\n  duration: number;\n  isActive: boolean;\n}\n\n/**\n * 性能指标\n * Performance metrics\n */\nexport interface PerformanceMetrics {\n  storage: {\n    readTime: number;\n    writeTime: number;\n    deleteTime: number;\n    size: number;\n  };\n  network: {\n    latency: number;\n    bandwidth: number;\n    errorRate: number;\n  };\n  memory: {\n    used: number;\n    available: number;\n    peak: number;\n  };\n  cpu: {\n    usage: number;\n    loadAverage: number[];\n  };\n}\n\n/**\n * 错误信息\n * Error information\n */\nexport interface ErrorInfo {\n  type: ErrorType;\n  message: string;\n  stack?: string;\n  timestamp: number;\n  context?: {\n    operation: string;\n    data?: unknown;\n    environment: string;\n    userAgent: string;\n  };\n  severity: PriorityLevel;\n  resolved: boolean;\n  resolution?: {\n    action: string;\n    timestamp: number;\n    notes?: string;\n  };\n}\n\n/**\n * 审计日志条目\n * Audit log entry\n */\nexport interface AuditLogEntry {\n  id: string;\n  timestamp: number;\n  operation: string;\n  resource: string;\n  actor: {\n    type: 'user' | 'system' | 'api';\n    id?: string;\n    ip?: string;\n    userAgent?: string;\n  };\n  changes?: {\n    before?: unknown;\n    after?: unknown;\n    fields: string[];\n  };\n  result: 'success' | 'failure' | 'partial';\n  metadata?: Record<string, unknown>;\n}\n\n/**\n * 配置快照\n * Configuration snapshot\n */\nexport interface ConfigSnapshot {\n  id: string;\n  timestamp: number;\n  version: VersionInfo;\n  config: Record<string, unknown>;\n  checksum: string;\n  description?: string;\n  tags?: string[];\n  metadata?: Record<string, unknown>;\n}\n\n/**\n * 数据导出格式\n * Data export format\n */\nexport interface DataExport {\n  format: 'json' | 'csv' | 'xml' | 'binary';\n  version: string;\n  timestamp: number;\n  checksum: string;\n  data: unknown;\n  metadata: {\n    source: string;\n    compression?: CompressionAlgorithm;\n    encryption?: EncryptionAlgorithm;\n    size: number;\n    entryCount: number;\n  };\n}\n\n/**\n * 数据导入结果\n * Data import result\n */\nexport interface DataImportResult {\n  success: boolean;\n  imported: number;\n  skipped: number;\n  errors: Array<{\n    index: number;\n    error: string;\n    data?: unknown;\n  }>;\n  warnings: string[];\n  duration: number;\n  metadata?: Record<string, unknown>;\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-storage-types-utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-storage-types-utils/async-utils.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'args' is defined but never used. Allowed unused args must match /^_/u.","line":14,"column":40,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":44,"suggestions":[{"messageId":"removeVar","data":{"varName":"args"},"fix":{"range":[225,229],"text":""},"desc":"Remove unused variable 'args'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'args' is defined but never used. Allowed unused args must match /^_/u.","line":17,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":12,"suggestions":[{"messageId":"removeVar","data":{"varName":"args"},"fix":{"range":[289,293],"text":""},"desc":"Remove unused variable 'args'."}]},{"ruleId":"no-undef","severity":2,"message":"'NodeJS' is not defined.","line":18,"column":18,"nodeType":"Identifier","messageId":"undef","endLine":18,"endColumn":24},{"ruleId":"no-unused-vars","severity":2,"message":"'args' is defined but never used. Allowed unused args must match /^_/u.","line":43,"column":40,"nodeType":"Identifier","messageId":"unusedVar","endLine":43,"endColumn":44,"suggestions":[{"messageId":"removeVar","data":{"varName":"args"},"fix":{"range":[879,883],"text":""},"desc":"Remove unused variable 'args'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'args' is defined but never used. Allowed unused args must match /^_/u.","line":46,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":46,"endColumn":12,"suggestions":[{"messageId":"removeVar","data":{"varName":"args"},"fix":{"range":[943,947],"text":""},"desc":"Remove unused variable 'args'."}]},{"ruleId":"no-undef","severity":2,"message":"'NodeJS' is not defined.","line":47,"column":18,"nodeType":"Identifier","messageId":"undef","endLine":47,"endColumn":24},{"ruleId":"no-throw-literal","severity":2,"message":"Expected an error object to be thrown.","line":82,"column":3,"nodeType":"ThrowStatement","messageId":"object","endLine":82,"endColumn":20}],"suppressedMessages":[],"errorCount":7,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 语言存储系统异步工具函数\n * Locale Storage System Async Utility Functions\n */\n\nimport type {\n  STORAGE_CONSTANTS,\n} from '../locale-storage-types-base';\n\n/**\n * 节流函数\n * Throttle function\n */\nexport function throttle<T extends (...args: unknown[]) => unknown>(\n  func: T,\n  delay: number\n): (...args: Parameters<T>) => void {\n  let timeoutId: NodeJS.Timeout | null = null;\n  let lastExecTime = 0;\n\n  return (...args: Parameters<T>) => {\n    const currentTime = Date.now();\n\n    if (currentTime - lastExecTime > delay) {\n      func(...args);\n      lastExecTime = currentTime;\n    } else {\n      if (timeoutId) {\n        clearTimeout(timeoutId);\n      }\n      timeoutId = setTimeout(() => {\n        func(...args);\n        lastExecTime = Date.now();\n      }, delay - (currentTime - lastExecTime));\n    }\n  };\n}\n\n/**\n * 防抖函数\n * Debounce function\n */\nexport function debounce<T extends (...args: unknown[]) => unknown>(\n  func: T,\n  delay: number\n): (...args: Parameters<T>) => void {\n  let timeoutId: NodeJS.Timeout | null = null;\n\n  return (...args: Parameters<T>) => {\n    if (timeoutId) {\n      clearTimeout(timeoutId);\n    }\n    timeoutId = setTimeout(() => func(...args), delay);\n  };\n}\n\n/**\n * 重试函数\n * Retry function\n */\nexport async function retry<T>(\n  func: () => Promise<T>,\n  maxAttempts: number = STORAGE_CONSTANTS.MAX_RETRY_ATTEMPTS,\n  delay: number = STORAGE_CONSTANTS.RETRY_DELAY\n): Promise<T> {\n  let lastError: Error;\n\n  for (let attempt = 1; attempt <= maxAttempts; attempt++) {\n    try {\n      return await func();\n    } catch (error) {\n      lastError = error instanceof Error ? error : new Error(String(error));\n      \n      if (attempt === maxAttempts) {\n        throw lastError;\n      }\n\n      await new Promise(resolve => setTimeout(resolve, delay * attempt));\n    }\n  }\n\n  throw lastError!;\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-storage-types-utils/format-utils.ts","messages":[{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 1024.","line":15,"column":18,"nodeType":"Literal","messageId":"noMagic","endLine":15,"endColumn":22},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 1024.","line":16,"column":13,"nodeType":"Literal","messageId":"noMagic","endLine":16,"endColumn":17},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2.","line":20,"column":26,"nodeType":"Literal","messageId":"noMagic","endLine":20,"endColumn":27},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":20,"column":32,"nodeType":"MemberExpression","endLine":20,"endColumn":48},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 60.","line":29,"column":40,"nodeType":"Literal","messageId":"noMagic","endLine":29,"endColumn":42},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 60.","line":30,"column":38,"nodeType":"Literal","messageId":"noMagic","endLine":30,"endColumn":40},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 24.","line":31,"column":35,"nodeType":"Literal","messageId":"noMagic","endLine":31,"endColumn":37},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 24.","line":34,"column":32,"nodeType":"Literal","messageId":"noMagic","endLine":34,"endColumn":34},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 60.","line":37,"column":35,"nodeType":"Literal","messageId":"noMagic","endLine":37,"endColumn":37},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 60.","line":40,"column":37,"nodeType":"Literal","messageId":"noMagic","endLine":40,"endColumn":39},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 36.","line":50,"column":50,"nodeType":"Literal","messageId":"noMagic","endLine":50,"endColumn":52},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2.","line":50,"column":61,"nodeType":"Literal","messageId":"noMagic","endLine":50,"endColumn":62},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 9.","line":50,"column":64,"nodeType":"Literal","messageId":"noMagic","endLine":50,"endColumn":65}],"suppressedMessages":[],"errorCount":13,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 语言存储系统格式化工具函数\n * Locale Storage System Format Utility Functions\n */\n\n/**\n * 格式化字节大小\n * Format byte size\n */\nexport function formatByteSize(bytes: number): string {\n  const units = ['B', 'KB', 'MB', 'GB', 'TB'];\n  let size = bytes;\n  let unitIndex = 0;\n\n  while (size >= 1024 && unitIndex < units.length - 1) {\n    size /= 1024;\n    unitIndex += 1;\n  }\n\n  return `${size.toFixed(2)} ${units[unitIndex]}`;\n}\n\n/**\n * 格式化时间间隔\n * Format time duration\n */\nexport function formatDuration(milliseconds: number): string {\n  const seconds = Math.floor(milliseconds / 1000);\n  const minutes = Math.floor(seconds / 60);\n  const hours = Math.floor(minutes / 60);\n  const days = Math.floor(hours / 24);\n\n  if (days > 0) {\n    return `${days}d ${hours % 24}h`;\n  }\n  if (hours > 0) {\n    return `${hours}h ${minutes % 60}m`;\n  }\n  if (minutes > 0) {\n    return `${minutes}m ${seconds % 60}s`;\n  }\n  return `${seconds}s`;\n}\n\n/**\n * 生成唯一ID\n * Generate unique ID\n */\nexport function generateUniqueId(): string {\n  return `${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-storage-types-utils/json-utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-storage-types-utils/object-utils.ts","messages":[{"ruleId":"no-restricted-syntax","severity":2,"message":"Using 'ForInStatement' is not allowed.","line":25,"column":5,"nodeType":"ForInStatement","messageId":"restrictedSyntax","endLine":29,"endColumn":6},{"ruleId":"no-prototype-builtins","severity":2,"message":"Do not access Object.prototype method 'hasOwnProperty' from target object.","line":26,"column":15,"nodeType":"CallExpression","messageId":"prototypeBuildIn","endLine":26,"endColumn":29,"suggestions":[{"messageId":"callObjectPrototype","data":{"prop":"hasOwnProperty"},"fix":{"range":[510,529],"text":"Object.prototype.hasOwnProperty.call(obj, "},"desc":"Call Object.prototype.hasOwnProperty explicitly."}]},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":27,"column":9,"nodeType":"MemberExpression","endLine":27,"endColumn":20},{"ruleId":"security/detect-object-injection","severity":2,"message":"Function Call Object Injection Sink","line":27,"column":33,"nodeType":"MemberExpression","endLine":27,"endColumn":41},{"ruleId":"no-restricted-syntax","severity":2,"message":"Using 'ForInStatement' is not allowed.","line":43,"column":3,"nodeType":"ForInStatement","messageId":"restrictedSyntax","endLine":66,"endColumn":4},{"ruleId":"no-prototype-builtins","severity":2,"message":"Do not access Object.prototype method 'hasOwnProperty' from target object.","line":44,"column":16,"nodeType":"CallExpression","messageId":"prototypeBuildIn","endLine":44,"endColumn":30,"suggestions":[{"messageId":"callObjectPrototype","data":{"prop":"hasOwnProperty"},"fix":{"range":[841,863],"text":"Object.prototype.hasOwnProperty.call(source, "},"desc":"Call Object.prototype.hasOwnProperty explicitly."}]},{"ruleId":"security/detect-object-injection","severity":2,"message":"Variable Assigned to Object Injection Sink","line":45,"column":27,"nodeType":"MemberExpression","endLine":45,"endColumn":38},{"ruleId":"security/detect-object-injection","severity":2,"message":"Variable Assigned to Object Injection Sink","line":46,"column":27,"nodeType":"MemberExpression","endLine":46,"endColumn":38},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (4). Maximum allowed is 3.","line":49,"column":9,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":63,"endColumn":10},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":57,"column":11,"nodeType":"MemberExpression","endLine":57,"endColumn":22},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":62,"column":11,"nodeType":"MemberExpression","endLine":62,"endColumn":22},{"ruleId":"security/detect-object-injection","severity":2,"message":"Function Call Object Injection Sink","line":96,"column":61,"nodeType":"MemberExpression","endLine":96,"endColumn":72},{"ruleId":"security/detect-object-injection","severity":2,"message":"Variable Assigned to Object Injection Sink","line":107,"column":18,"nodeType":"MemberExpression","endLine":107,"endColumn":56},{"ruleId":"security/detect-object-injection","severity":2,"message":"Variable Assigned to Object Injection Sink","line":108,"column":18,"nodeType":"MemberExpression","endLine":108,"endColumn":56}],"suppressedMessages":[],"errorCount":14,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 语言存储系统对象操作工具函数\n * Locale Storage System Object Utility Functions\n */\n\n/**\n * 深度克隆对象\n * Deep clone object\n */\nexport function deepClone<T>(obj: T): T {\n  if (obj === null || typeof obj !== 'object') {\n    return obj;\n  }\n\n  if (obj instanceof Date) {\n    return new Date(obj.getTime()) as unknown as T;\n  }\n\n  if (obj instanceof Array) {\n    return obj.map(item => deepClone(item)) as unknown as T;\n  }\n\n  if (typeof obj === 'object') {\n    const cloned = {} as T;\n    for (const key in obj) {\n      if (obj.hasOwnProperty(key)) {\n        cloned[key] = deepClone(obj[key]);\n      }\n    }\n    return cloned;\n  }\n\n  return obj;\n}\n\n/**\n * 合并对象\n * Merge objects\n */\nexport function mergeObjects<T extends Record<string, unknown>>(target: T, source: Partial<T>): T {\n  const result = { ...target };\n  \n  for (const key in source) {\n    if (source.hasOwnProperty(key)) {\n      const sourceValue = source[key];\n      const targetValue = result[key];\n      \n      if (sourceValue !== undefined) {\n        if (\n          typeof sourceValue === 'object' &&\n          sourceValue !== null &&\n          !Array.isArray(sourceValue) &&\n          typeof targetValue === 'object' &&\n          targetValue !== null &&\n          !Array.isArray(targetValue)\n        ) {\n          result[key] = mergeObjects(\n            targetValue as Record<string, unknown>,\n            sourceValue as Record<string, unknown>\n          ) as T[Extract<keyof T, string>];\n        } else {\n          result[key] = sourceValue as T[Extract<keyof T, string>];\n        }\n      }\n    }\n  }\n  \n  return result;\n}\n\n/**\n * 比较对象\n * Compare objects\n */\nexport function compareObjects(obj1: unknown, obj2: unknown): boolean {\n  if (obj1 === obj2) {\n    return true;\n  }\n\n  if (obj1 === null || obj2 === null || typeof obj1 !== typeof obj2) {\n    return false;\n  }\n\n  if (typeof obj1 !== 'object') {\n    return obj1 === obj2;\n  }\n\n  if (Array.isArray(obj1) !== Array.isArray(obj2)) {\n    return false;\n  }\n\n  if (Array.isArray(obj1) && Array.isArray(obj2)) {\n    if (obj1.length !== obj2.length) {\n      return false;\n    }\n    return obj1.every((item, index) => compareObjects(item, obj2[index]));\n  }\n\n  const keys1 = Object.keys(obj1 as Record<string, unknown>);\n  const keys2 = Object.keys(obj2 as Record<string, unknown>);\n\n  if (keys1.length !== keys2.length) {\n    return false;\n  }\n\n  return keys1.every(key => {\n    const val1 = (obj1 as Record<string, unknown>)[key];\n    const val2 = (obj2 as Record<string, unknown>)[key];\n    return compareObjects(val1, val2);\n  });\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-storage-types-utils/storage-utils.ts","messages":[{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 5.","line":49,"column":22,"nodeType":"Literal","messageId":"noMagic","endLine":49,"endColumn":23},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 16.","line":53,"column":34,"nodeType":"Literal","messageId":"noMagic","endLine":53,"endColumn":36}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 语言存储系统存储工具函数\n * Locale Storage System Storage Utility Functions\n */\n\n/**\n * 工具函数\n * Utility functions\n */\n\n/**\n * 创建存储键\n * Create storage key\n */\nexport function createStorageKey(prefix: string, key: string): string {\n  return `${prefix}${key}`;\n}\n\n/**\n * 解析存储键\n * Parse storage key\n */\nexport function parseStorageKey(fullKey: string, prefix: string): string {\n  return fullKey.startsWith(prefix) ? fullKey.slice(prefix.length) : fullKey;\n}\n\n/**\n * 估算存储大小\n * Estimate storage size\n */\nexport function estimateStorageSize(data: unknown): number {\n  try {\n    return new Blob([JSON.stringify(data)]).size;\n  } catch {\n    return 0;\n  }\n}\n\n/**\n * 生成校验和\n * Generate checksum\n */\nexport function generateChecksum(data: unknown): string {\n  const str = JSON.stringify(data);\n  let hash = 0;\n  \n  for (let i = 0; i < str.length; i++) {\n    const char = str.charCodeAt(i);\n    hash = ((hash << 5) - hash) + char;\n    hash = hash & hash; // 转换为32位整数\n  }\n  \n  return Math.abs(hash).toString(16);\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-storage-types-utils/type-guards.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-storage-types-utils/validators.ts","messages":[{"ruleId":"max-statements","severity":2,"message":"Function 'validatePreference' has too many statements (26). Maximum allowed is 20.","line":25,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":87,"endColumn":2},{"ruleId":"complexity","severity":2,"message":"Function 'validatePreference' has a complexity of 19. Maximum allowed is 15.","line":25,"column":8,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":87,"endColumn":2},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0.9.","line":74,"column":63,"nodeType":"Literal","messageId":"noMagic","endLine":74,"endColumn":66},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0.3.","line":78,"column":67,"nodeType":"Literal","messageId":"noMagic","endLine":78,"endColumn":70},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":127,"column":11,"nodeType":"MemberExpression","endLine":127,"endColumn":32}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 语言存储系统验证函数\n * Locale Storage System Validation Functions\n */\n\nimport type {\n  BaseValidators,\n} from '../locale-storage-types-base';\n\nimport type {\n  UserLocalePreference,\n  LocaleDetectionHistory,\n  ValidationResult,\n} from '../locale-storage-types-data';\n\n/**\n * 验证函数\n * Validation functions\n */\n\n/**\n * 验证用户偏好\n * Validate user preference\n */\nexport function validatePreference(preference: UserLocalePreference): ValidationResult {\n  const errors: string[] = [];\n  const warnings: string[] = [];\n\n  // 验证必需字段\n  if (!BaseValidators.isValidLocale(preference.locale)) {\n    errors.push('Invalid locale');\n  }\n\n  if (!BaseValidators.isValidSource(preference.source)) {\n    errors.push('Invalid source');\n  }\n\n  if (!BaseValidators.isValidTimestamp(preference.timestamp)) {\n    errors.push('Invalid timestamp');\n  }\n\n  if (!BaseValidators.isValidConfidence(preference.confidence)) {\n    errors.push('Invalid confidence value');\n  }\n\n  // 验证元数据\n  if (preference.metadata) {\n    if (typeof preference.metadata !== 'object') {\n      errors.push('Metadata must be an object');\n    } else {\n      // 验证用户代理\n      if (preference.metadata.userAgent && typeof preference.metadata.userAgent !== 'string') {\n        warnings.push('User agent should be a string');\n      }\n\n      // 验证IP国家\n      if (preference.metadata.ipCountry && typeof preference.metadata.ipCountry !== 'string') {\n        warnings.push('IP country should be a string');\n      }\n\n      // 验证浏览器语言\n      if (preference.metadata.browserLanguages && !Array.isArray(preference.metadata.browserLanguages)) {\n        warnings.push('Browser languages should be an array');\n      }\n\n      // 验证时区\n      if (preference.metadata.timezone && typeof preference.metadata.timezone !== 'string') {\n        warnings.push('Timezone should be a string');\n      }\n    }\n  }\n\n  // 验证置信度与来源的一致性\n  if (preference.source === 'user' && preference.confidence < 0.9) {\n    warnings.push('User-selected preferences should have high confidence');\n  }\n\n  if (preference.source === 'fallback' && preference.confidence > 0.3) {\n    warnings.push('Fallback preferences should have low confidence');\n  }\n\n  return {\n    isValid: errors.length === 0,\n    errors,\n    warnings,\n  };\n}\n\n/**\n * 验证检测历史\n * Validate detection history\n */\nexport function validateDetectionHistory(history: LocaleDetectionHistory): ValidationResult {\n  const errors: string[] = [];\n  const warnings: string[] = [];\n\n  // 验证检测记录数组\n  if (!Array.isArray(history.detections)) {\n    errors.push('Detections must be an array');\n  } else {\n    // 验证每个检测记录\n    history.detections.forEach((detection, index) => {\n      if (!BaseValidators.isValidLocale(detection.locale)) {\n        errors.push(`Invalid locale in detection ${index}`);\n      }\n\n      if (!BaseValidators.isValidSource(detection.source)) {\n        errors.push(`Invalid source in detection ${index}`);\n      }\n\n      if (!BaseValidators.isValidTimestamp(detection.timestamp)) {\n        errors.push(`Invalid timestamp in detection ${index}`);\n      }\n\n      if (!BaseValidators.isValidConfidence(detection.confidence)) {\n        errors.push(`Invalid confidence in detection ${index}`);\n      }\n    });\n\n    // 验证数量一致性\n    if (history.detections.length !== history.totalDetections) {\n      warnings.push('Detection count mismatch');\n    }\n\n    // 验证时间顺序\n    for (let i = 1; i < history.detections.length; i++) {\n      if (history.detections[i].timestamp < history.detections[i - 1].timestamp) {\n        warnings.push('Detections are not in chronological order');\n        break;\n      }\n    }\n  }\n\n  // 验证最后更新时间\n  if (!BaseValidators.isValidTimestamp(history.lastUpdated)) {\n    errors.push('Invalid lastUpdated timestamp');\n  }\n\n  // 验证总检测数\n  if (typeof history.totalDetections !== 'number' || history.totalDetections < 0) {\n    errors.push('Invalid totalDetections');\n  }\n\n  return {\n    isValid: errors.length === 0,\n    errors,\n    warnings,\n  };\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-storage-types.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'Locale' is defined but never used. Allowed unused vars must match /^_/u.","line":15,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"Locale"},"fix":{"range":[340,383],"text":""},"desc":"Remove unused variable 'Locale'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Locale' is defined but never used. Allowed unused vars must match /^_/u.","line":15,"column":15,"nodeType":null,"messageId":"unusedVar","endLine":15,"endColumn":21},{"ruleId":"no-unused-vars","severity":2,"message":"'STORAGE_CONSTANTS' is defined but never used. Allowed unused vars must match /^_/u.","line":20,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":20,"suggestions":[{"messageId":"removeVar","data":{"varName":"STORAGE_CONSTANTS"},"fix":{"range":[448,469],"text":""},"desc":"Remove unused variable 'STORAGE_CONSTANTS'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'STORAGE_CONSTANTS' is defined but never used. Allowed unused vars must match /^_/u.","line":20,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":20,"endColumn":20},{"ruleId":"no-unused-vars","severity":2,"message":"'StorageType' is defined but never used. Allowed unused vars must match /^_/u.","line":21,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":14,"suggestions":[{"messageId":"removeVar","data":{"varName":"StorageType"},"fix":{"range":[469,484],"text":""},"desc":"Remove unused variable 'StorageType'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'StorageType' is defined but never used. Allowed unused vars must match /^_/u.","line":21,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":21,"endColumn":14},{"ruleId":"no-unused-vars","severity":2,"message":"'CompressionAlgorithm' is defined but never used. Allowed unused vars must match /^_/u.","line":22,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":23,"suggestions":[{"messageId":"removeVar","data":{"varName":"CompressionAlgorithm"},"fix":{"range":[484,508],"text":""},"desc":"Remove unused variable 'CompressionAlgorithm'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CompressionAlgorithm' is defined but never used. Allowed unused vars must match /^_/u.","line":22,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":22,"endColumn":23},{"ruleId":"no-unused-vars","severity":2,"message":"'EncryptionAlgorithm' is defined but never used. Allowed unused vars must match /^_/u.","line":23,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":23,"endColumn":22,"suggestions":[{"messageId":"removeVar","data":{"varName":"EncryptionAlgorithm"},"fix":{"range":[508,531],"text":""},"desc":"Remove unused variable 'EncryptionAlgorithm'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'EncryptionAlgorithm' is defined but never used. Allowed unused vars must match /^_/u.","line":23,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":23,"endColumn":22},{"ruleId":"no-unused-vars","severity":2,"message":"'SyncStatus' is defined but never used. Allowed unused vars must match /^_/u.","line":24,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":13,"suggestions":[{"messageId":"removeVar","data":{"varName":"SyncStatus"},"fix":{"range":[531,545],"text":""},"desc":"Remove unused variable 'SyncStatus'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'SyncStatus' is defined but never used. Allowed unused vars must match /^_/u.","line":24,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":24,"endColumn":13},{"ruleId":"no-unused-vars","severity":2,"message":"'MigrationStatus' is defined but never used. Allowed unused vars must match /^_/u.","line":25,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":25,"endColumn":18,"suggestions":[{"messageId":"removeVar","data":{"varName":"MigrationStatus"},"fix":{"range":[545,564],"text":""},"desc":"Remove unused variable 'MigrationStatus'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'MigrationStatus' is defined but never used. Allowed unused vars must match /^_/u.","line":25,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":25,"endColumn":18},{"ruleId":"no-unused-vars","severity":2,"message":"'HealthStatus' is defined but never used. Allowed unused vars must match /^_/u.","line":26,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":26,"endColumn":15,"suggestions":[{"messageId":"removeVar","data":{"varName":"HealthStatus"},"fix":{"range":[564,580],"text":""},"desc":"Remove unused variable 'HealthStatus'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'HealthStatus' is defined but never used. Allowed unused vars must match /^_/u.","line":26,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":26,"endColumn":15},{"ruleId":"no-unused-vars","severity":2,"message":"'ErrorType' is defined but never used. Allowed unused vars must match /^_/u.","line":27,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":27,"endColumn":12,"suggestions":[{"messageId":"removeVar","data":{"varName":"ErrorType"},"fix":{"range":[580,593],"text":""},"desc":"Remove unused variable 'ErrorType'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ErrorType' is defined but never used. Allowed unused vars must match /^_/u.","line":27,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":27,"endColumn":12},{"ruleId":"no-unused-vars","severity":2,"message":"'PriorityLevel' is defined but never used. Allowed unused vars must match /^_/u.","line":28,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":28,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"PriorityLevel"},"fix":{"range":[593,610],"text":""},"desc":"Remove unused variable 'PriorityLevel'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'PriorityLevel' is defined but never used. Allowed unused vars must match /^_/u.","line":28,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":28,"endColumn":16},{"ruleId":"no-unused-vars","severity":2,"message":"'EnvironmentType' is defined but never used. Allowed unused vars must match /^_/u.","line":29,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":29,"endColumn":18,"suggestions":[{"messageId":"removeVar","data":{"varName":"EnvironmentType"},"fix":{"range":[610,629],"text":""},"desc":"Remove unused variable 'EnvironmentType'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'EnvironmentType' is defined but never used. Allowed unused vars must match /^_/u.","line":29,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":29,"endColumn":18},{"ruleId":"no-unused-vars","severity":2,"message":"'BrowserType' is defined but never used. Allowed unused vars must match /^_/u.","line":30,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":30,"endColumn":14,"suggestions":[{"messageId":"removeVar","data":{"varName":"BrowserType"},"fix":{"range":[629,644],"text":""},"desc":"Remove unused variable 'BrowserType'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'BrowserType' is defined but never used. Allowed unused vars must match /^_/u.","line":30,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":30,"endColumn":14},{"ruleId":"no-unused-vars","severity":2,"message":"'DeviceType' is defined but never used. Allowed unused vars must match /^_/u.","line":31,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":31,"endColumn":13,"suggestions":[{"messageId":"removeVar","data":{"varName":"DeviceType"},"fix":{"range":[644,658],"text":""},"desc":"Remove unused variable 'DeviceType'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'DeviceType' is defined but never used. Allowed unused vars must match /^_/u.","line":31,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":31,"endColumn":13},{"ruleId":"no-unused-vars","severity":2,"message":"'OSType' is defined but never used. Allowed unused vars must match /^_/u.","line":32,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":32,"endColumn":9,"suggestions":[{"messageId":"removeVar","data":{"varName":"OSType"},"fix":{"range":[658,668],"text":""},"desc":"Remove unused variable 'OSType'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'OSType' is defined but never used. Allowed unused vars must match /^_/u.","line":32,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":32,"endColumn":9},{"ruleId":"no-unused-vars","severity":2,"message":"'VersionInfo' is defined but never used. Allowed unused vars must match /^_/u.","line":33,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":33,"endColumn":14,"suggestions":[{"messageId":"removeVar","data":{"varName":"VersionInfo"},"fix":{"range":[668,683],"text":""},"desc":"Remove unused variable 'VersionInfo'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'VersionInfo' is defined but never used. Allowed unused vars must match /^_/u.","line":33,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":33,"endColumn":14},{"ruleId":"no-unused-vars","severity":2,"message":"'TimestampUtils' is defined but never used. Allowed unused vars must match /^_/u.","line":34,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":34,"endColumn":17,"suggestions":[{"messageId":"removeVar","data":{"varName":"TimestampUtils"},"fix":{"range":[683,701],"text":""},"desc":"Remove unused variable 'TimestampUtils'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'TimestampUtils' is defined but never used. Allowed unused vars must match /^_/u.","line":34,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":34,"endColumn":17},{"ruleId":"no-unused-vars","severity":2,"message":"'BaseValidators' is defined but never used. Allowed unused vars must match /^_/u.","line":35,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":35,"endColumn":17,"suggestions":[{"messageId":"removeVar","data":{"varName":"BaseValidators"},"fix":{"range":[701,719],"text":""},"desc":"Remove unused variable 'BaseValidators'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'BaseValidators' is defined but never used. Allowed unused vars must match /^_/u.","line":35,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":35,"endColumn":17},{"ruleId":"no-unused-vars","severity":2,"message":"'StorageStats' is defined but never used. Allowed unused vars must match /^_/u.","line":42,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":42,"endColumn":15,"suggestions":[{"messageId":"removeVar","data":{"varName":"StorageStats"},"fix":{"range":[847,863],"text":""},"desc":"Remove unused variable 'StorageStats'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'StorageStats' is defined but never used. Allowed unused vars must match /^_/u.","line":42,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":42,"endColumn":15},{"ruleId":"no-unused-vars","severity":2,"message":"'StorageHealthCheck' is defined but never used. Allowed unused vars must match /^_/u.","line":46,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":46,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"StorageHealthCheck"},"fix":{"range":[929,951],"text":""},"desc":"Remove unused variable 'StorageHealthCheck'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'StorageHealthCheck' is defined but never used. Allowed unused vars must match /^_/u.","line":46,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":46,"endColumn":21},{"ruleId":"no-unused-vars","severity":2,"message":"'StorageBackupData' is defined but never used. Allowed unused vars must match /^_/u.","line":48,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":48,"endColumn":20,"suggestions":[{"messageId":"removeVar","data":{"varName":"StorageBackupData"},"fix":{"range":[971,992],"text":""},"desc":"Remove unused variable 'StorageBackupData'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'StorageBackupData' is defined but never used. Allowed unused vars must match /^_/u.","line":48,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":48,"endColumn":20},{"ruleId":"no-unused-vars","severity":2,"message":"'StorageMigrationConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":49,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":49,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"StorageMigrationConfig"},"fix":{"range":[992,1018],"text":""},"desc":"Remove unused variable 'StorageMigrationConfig'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'StorageMigrationConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":49,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":49,"endColumn":25},{"ruleId":"no-unused-vars","severity":2,"message":"'StorageCompressionConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":50,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":50,"endColumn":27,"suggestions":[{"messageId":"removeVar","data":{"varName":"StorageCompressionConfig"},"fix":{"range":[1018,1046],"text":""},"desc":"Remove unused variable 'StorageCompressionConfig'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'StorageCompressionConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":50,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":50,"endColumn":27},{"ruleId":"no-unused-vars","severity":2,"message":"'StorageEncryptionConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":51,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":51,"endColumn":26,"suggestions":[{"messageId":"removeVar","data":{"varName":"StorageEncryptionConfig"},"fix":{"range":[1046,1073],"text":""},"desc":"Remove unused variable 'StorageEncryptionConfig'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'StorageEncryptionConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":51,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":51,"endColumn":26},{"ruleId":"no-unused-vars","severity":2,"message":"'StorageSyncConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":52,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":52,"endColumn":20,"suggestions":[{"messageId":"removeVar","data":{"varName":"StorageSyncConfig"},"fix":{"range":[1073,1094],"text":""},"desc":"Remove unused variable 'StorageSyncConfig'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'StorageSyncConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":52,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":52,"endColumn":20},{"ruleId":"no-unused-vars","severity":2,"message":"'DeviceInfo' is defined but never used. Allowed unused vars must match /^_/u.","line":53,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":53,"endColumn":13,"suggestions":[{"messageId":"removeVar","data":{"varName":"DeviceInfo"},"fix":{"range":[1094,1108],"text":""},"desc":"Remove unused variable 'DeviceInfo'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'DeviceInfo' is defined but never used. Allowed unused vars must match /^_/u.","line":53,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":53,"endColumn":13},{"ruleId":"no-unused-vars","severity":2,"message":"'NetworkInfo' is defined but never used. Allowed unused vars must match /^_/u.","line":54,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":54,"endColumn":14,"suggestions":[{"messageId":"removeVar","data":{"varName":"NetworkInfo"},"fix":{"range":[1108,1123],"text":""},"desc":"Remove unused variable 'NetworkInfo'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'NetworkInfo' is defined but never used. Allowed unused vars must match /^_/u.","line":54,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":54,"endColumn":14},{"ruleId":"no-unused-vars","severity":2,"message":"'GeolocationInfo' is defined but never used. Allowed unused vars must match /^_/u.","line":55,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":55,"endColumn":18,"suggestions":[{"messageId":"removeVar","data":{"varName":"GeolocationInfo"},"fix":{"range":[1123,1142],"text":""},"desc":"Remove unused variable 'GeolocationInfo'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'GeolocationInfo' is defined but never used. Allowed unused vars must match /^_/u.","line":55,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":55,"endColumn":18},{"ruleId":"no-unused-vars","severity":2,"message":"'SessionInfo' is defined but never used. Allowed unused vars must match /^_/u.","line":56,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":56,"endColumn":14,"suggestions":[{"messageId":"removeVar","data":{"varName":"SessionInfo"},"fix":{"range":[1142,1157],"text":""},"desc":"Remove unused variable 'SessionInfo'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'SessionInfo' is defined but never used. Allowed unused vars must match /^_/u.","line":56,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":56,"endColumn":14},{"ruleId":"no-unused-vars","severity":2,"message":"'PerformanceMetrics' is defined but never used. Allowed unused vars must match /^_/u.","line":57,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":57,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"PerformanceMetrics"},"fix":{"range":[1157,1179],"text":""},"desc":"Remove unused variable 'PerformanceMetrics'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'PerformanceMetrics' is defined but never used. Allowed unused vars must match /^_/u.","line":57,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":57,"endColumn":21},{"ruleId":"no-unused-vars","severity":2,"message":"'ErrorInfo' is defined but never used. Allowed unused vars must match /^_/u.","line":58,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":58,"endColumn":12,"suggestions":[{"messageId":"removeVar","data":{"varName":"ErrorInfo"},"fix":{"range":[1179,1192],"text":""},"desc":"Remove unused variable 'ErrorInfo'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ErrorInfo' is defined but never used. Allowed unused vars must match /^_/u.","line":58,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":58,"endColumn":12},{"ruleId":"no-unused-vars","severity":2,"message":"'AuditLogEntry' is defined but never used. Allowed unused vars must match /^_/u.","line":59,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":59,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"AuditLogEntry"},"fix":{"range":[1192,1209],"text":""},"desc":"Remove unused variable 'AuditLogEntry'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'AuditLogEntry' is defined but never used. Allowed unused vars must match /^_/u.","line":59,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":59,"endColumn":16},{"ruleId":"no-unused-vars","severity":2,"message":"'ConfigSnapshot' is defined but never used. Allowed unused vars must match /^_/u.","line":60,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":60,"endColumn":17,"suggestions":[{"messageId":"removeVar","data":{"varName":"ConfigSnapshot"},"fix":{"range":[1209,1227],"text":""},"desc":"Remove unused variable 'ConfigSnapshot'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ConfigSnapshot' is defined but never used. Allowed unused vars must match /^_/u.","line":60,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":60,"endColumn":17},{"ruleId":"no-unused-vars","severity":2,"message":"'DataExport' is defined but never used. Allowed unused vars must match /^_/u.","line":61,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":61,"endColumn":13,"suggestions":[{"messageId":"removeVar","data":{"varName":"DataExport"},"fix":{"range":[1227,1241],"text":""},"desc":"Remove unused variable 'DataExport'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'DataExport' is defined but never used. Allowed unused vars must match /^_/u.","line":61,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":61,"endColumn":13},{"ruleId":"no-unused-vars","severity":2,"message":"'DataImportResult' is defined but never used. Allowed unused vars must match /^_/u.","line":62,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":62,"endColumn":19,"suggestions":[{"messageId":"removeVar","data":{"varName":"DataImportResult"},"fix":{"range":[1241,1261],"text":""},"desc":"Remove unused variable 'DataImportResult'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'DataImportResult' is defined but never used. Allowed unused vars must match /^_/u.","line":62,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":62,"endColumn":19},{"ruleId":"no-unused-vars","severity":2,"message":"'EnvironmentConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":68,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":68,"endColumn":20,"suggestions":[{"messageId":"removeVar","data":{"varName":"EnvironmentConfig"},"fix":{"range":[1357,1378],"text":""},"desc":"Remove unused variable 'EnvironmentConfig'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'EnvironmentConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":68,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":68,"endColumn":20},{"ruleId":"no-unused-vars","severity":2,"message":"'CONFIG_PRESETS' is defined but never used. Allowed unused vars must match /^_/u.","line":69,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":69,"endColumn":17,"suggestions":[{"messageId":"removeVar","data":{"varName":"CONFIG_PRESETS"},"fix":{"range":[1378,1396],"text":""},"desc":"Remove unused variable 'CONFIG_PRESETS'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CONFIG_PRESETS' is defined but never used. Allowed unused vars must match /^_/u.","line":69,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":69,"endColumn":17},{"ruleId":"no-unused-vars","severity":2,"message":"'ConfigValidationRules' is defined but never used. Allowed unused vars must match /^_/u.","line":70,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":70,"endColumn":24,"suggestions":[{"messageId":"removeVar","data":{"varName":"ConfigValidationRules"},"fix":{"range":[1396,1421],"text":""},"desc":"Remove unused variable 'ConfigValidationRules'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ConfigValidationRules' is defined but never used. Allowed unused vars must match /^_/u.","line":70,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":70,"endColumn":24},{"ruleId":"no-unused-vars","severity":2,"message":"'CONFIG_VALIDATION_RULES' is defined but never used. Allowed unused vars must match /^_/u.","line":71,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":71,"endColumn":26,"suggestions":[{"messageId":"removeVar","data":{"varName":"CONFIG_VALIDATION_RULES"},"fix":{"range":[1421,1448],"text":""},"desc":"Remove unused variable 'CONFIG_VALIDATION_RULES'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CONFIG_VALIDATION_RULES' is defined but never used. Allowed unused vars must match /^_/u.","line":71,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":71,"endColumn":26},{"ruleId":"no-unused-vars","severity":2,"message":"'ConfigMigration' is defined but never used. Allowed unused vars must match /^_/u.","line":72,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":72,"endColumn":18,"suggestions":[{"messageId":"removeVar","data":{"varName":"ConfigMigration"},"fix":{"range":[1448,1467],"text":""},"desc":"Remove unused variable 'ConfigMigration'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ConfigMigration' is defined but never used. Allowed unused vars must match /^_/u.","line":72,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":72,"endColumn":18},{"ruleId":"no-unused-vars","severity":2,"message":"'CONFIG_MIGRATIONS' is defined but never used. Allowed unused vars must match /^_/u.","line":73,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":73,"endColumn":20,"suggestions":[{"messageId":"removeVar","data":{"varName":"CONFIG_MIGRATIONS"},"fix":{"range":[1467,1488],"text":""},"desc":"Remove unused variable 'CONFIG_MIGRATIONS'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CONFIG_MIGRATIONS' is defined but never used. Allowed unused vars must match /^_/u.","line":73,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":73,"endColumn":20},{"ruleId":"no-unused-vars","severity":2,"message":"'isUserLocalePreference' is defined but never used. Allowed unused vars must match /^_/u.","line":77,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":77,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"isUserLocalePreference"},"fix":{"range":[1542,1565],"text":""},"desc":"Remove unused variable 'isUserLocalePreference'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'isUserLocalePreference' is defined but never used. Allowed unused vars must match /^_/u.","line":77,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":77,"endColumn":25},{"ruleId":"no-unused-vars","severity":2,"message":"'isLocaleDetectionHistory' is defined but never used. Allowed unused vars must match /^_/u.","line":78,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":78,"endColumn":27,"suggestions":[{"messageId":"removeVar","data":{"varName":"isLocaleDetectionHistory"},"fix":{"range":[1564,1592],"text":""},"desc":"Remove unused variable 'isLocaleDetectionHistory'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'isLocaleDetectionHistory' is defined but never used. Allowed unused vars must match /^_/u.","line":78,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":78,"endColumn":27},{"ruleId":"no-unused-vars","severity":2,"message":"'isStorageConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":79,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":79,"endColumn":18,"suggestions":[{"messageId":"removeVar","data":{"varName":"isStorageConfig"},"fix":{"range":[1592,1611],"text":""},"desc":"Remove unused variable 'isStorageConfig'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'isStorageConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":79,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":79,"endColumn":18},{"ruleId":"no-unused-vars","severity":2,"message":"'validatePreference' is defined but never used. Allowed unused vars must match /^_/u.","line":80,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":80,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"validatePreference"},"fix":{"range":[1611,1633],"text":""},"desc":"Remove unused variable 'validatePreference'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'validatePreference' is defined but never used. Allowed unused vars must match /^_/u.","line":80,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":80,"endColumn":21},{"ruleId":"no-unused-vars","severity":2,"message":"'validateDetectionHistory' is defined but never used. Allowed unused vars must match /^_/u.","line":81,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":81,"endColumn":27,"suggestions":[{"messageId":"removeVar","data":{"varName":"validateDetectionHistory"},"fix":{"range":[1633,1661],"text":""},"desc":"Remove unused variable 'validateDetectionHistory'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'validateDetectionHistory' is defined but never used. Allowed unused vars must match /^_/u.","line":81,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":81,"endColumn":27},{"ruleId":"no-unused-vars","severity":2,"message":"'createStorageKey' is defined but never used. Allowed unused vars must match /^_/u.","line":82,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":82,"endColumn":19,"suggestions":[{"messageId":"removeVar","data":{"varName":"createStorageKey"},"fix":{"range":[1661,1681],"text":""},"desc":"Remove unused variable 'createStorageKey'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'createStorageKey' is defined but never used. Allowed unused vars must match /^_/u.","line":82,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":82,"endColumn":19},{"ruleId":"no-unused-vars","severity":2,"message":"'parseStorageKey' is defined but never used. Allowed unused vars must match /^_/u.","line":83,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":83,"endColumn":18,"suggestions":[{"messageId":"removeVar","data":{"varName":"parseStorageKey"},"fix":{"range":[1681,1700],"text":""},"desc":"Remove unused variable 'parseStorageKey'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'parseStorageKey' is defined but never used. Allowed unused vars must match /^_/u.","line":83,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":83,"endColumn":18},{"ruleId":"no-unused-vars","severity":2,"message":"'estimateStorageSize' is defined but never used. Allowed unused vars must match /^_/u.","line":84,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":84,"endColumn":22,"suggestions":[{"messageId":"removeVar","data":{"varName":"estimateStorageSize"},"fix":{"range":[1700,1723],"text":""},"desc":"Remove unused variable 'estimateStorageSize'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'estimateStorageSize' is defined but never used. Allowed unused vars must match /^_/u.","line":84,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":84,"endColumn":22},{"ruleId":"no-unused-vars","severity":2,"message":"'generateChecksum' is defined but never used. Allowed unused vars must match /^_/u.","line":85,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":85,"endColumn":19,"suggestions":[{"messageId":"removeVar","data":{"varName":"generateChecksum"},"fix":{"range":[1723,1743],"text":""},"desc":"Remove unused variable 'generateChecksum'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'generateChecksum' is defined but never used. Allowed unused vars must match /^_/u.","line":85,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":85,"endColumn":19},{"ruleId":"no-unused-vars","severity":2,"message":"'deepClone' is defined but never used. Allowed unused vars must match /^_/u.","line":86,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":86,"endColumn":12,"suggestions":[{"messageId":"removeVar","data":{"varName":"deepClone"},"fix":{"range":[1743,1756],"text":""},"desc":"Remove unused variable 'deepClone'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'deepClone' is defined but never used. Allowed unused vars must match /^_/u.","line":86,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":86,"endColumn":12},{"ruleId":"no-unused-vars","severity":2,"message":"'mergeObjects' is defined but never used. Allowed unused vars must match /^_/u.","line":87,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":87,"endColumn":15,"suggestions":[{"messageId":"removeVar","data":{"varName":"mergeObjects"},"fix":{"range":[1756,1772],"text":""},"desc":"Remove unused variable 'mergeObjects'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'mergeObjects' is defined but never used. Allowed unused vars must match /^_/u.","line":87,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":87,"endColumn":15},{"ruleId":"no-unused-vars","severity":2,"message":"'compareObjects' is defined but never used. Allowed unused vars must match /^_/u.","line":88,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":88,"endColumn":17,"suggestions":[{"messageId":"removeVar","data":{"varName":"compareObjects"},"fix":{"range":[1772,1790],"text":""},"desc":"Remove unused variable 'compareObjects'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'compareObjects' is defined but never used. Allowed unused vars must match /^_/u.","line":88,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":88,"endColumn":17},{"ruleId":"no-unused-vars","severity":2,"message":"'formatByteSize' is defined but never used. Allowed unused vars must match /^_/u.","line":89,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":89,"endColumn":17,"suggestions":[{"messageId":"removeVar","data":{"varName":"formatByteSize"},"fix":{"range":[1790,1808],"text":""},"desc":"Remove unused variable 'formatByteSize'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'formatByteSize' is defined but never used. Allowed unused vars must match /^_/u.","line":89,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":89,"endColumn":17},{"ruleId":"no-unused-vars","severity":2,"message":"'formatDuration' is defined but never used. Allowed unused vars must match /^_/u.","line":90,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":90,"endColumn":17,"suggestions":[{"messageId":"removeVar","data":{"varName":"formatDuration"},"fix":{"range":[1808,1826],"text":""},"desc":"Remove unused variable 'formatDuration'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'formatDuration' is defined but never used. Allowed unused vars must match /^_/u.","line":90,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":90,"endColumn":17},{"ruleId":"no-unused-vars","severity":2,"message":"'generateUniqueId' is defined but never used. Allowed unused vars must match /^_/u.","line":91,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":91,"endColumn":19,"suggestions":[{"messageId":"removeVar","data":{"varName":"generateUniqueId"},"fix":{"range":[1826,1846],"text":""},"desc":"Remove unused variable 'generateUniqueId'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'generateUniqueId' is defined but never used. Allowed unused vars must match /^_/u.","line":91,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":91,"endColumn":19},{"ruleId":"no-unused-vars","severity":2,"message":"'throttle' is defined but never used. Allowed unused vars must match /^_/u.","line":92,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":92,"endColumn":11,"suggestions":[{"messageId":"removeVar","data":{"varName":"throttle"},"fix":{"range":[1846,1858],"text":""},"desc":"Remove unused variable 'throttle'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'throttle' is defined but never used. Allowed unused vars must match /^_/u.","line":92,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":92,"endColumn":11},{"ruleId":"no-unused-vars","severity":2,"message":"'debounce' is defined but never used. Allowed unused vars must match /^_/u.","line":93,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":93,"endColumn":11,"suggestions":[{"messageId":"removeVar","data":{"varName":"debounce"},"fix":{"range":[1858,1870],"text":""},"desc":"Remove unused variable 'debounce'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'debounce' is defined but never used. Allowed unused vars must match /^_/u.","line":93,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":93,"endColumn":11},{"ruleId":"no-unused-vars","severity":2,"message":"'retry' is defined but never used. Allowed unused vars must match /^_/u.","line":94,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":94,"endColumn":8,"suggestions":[{"messageId":"removeVar","data":{"varName":"retry"},"fix":{"range":[1870,1879],"text":""},"desc":"Remove unused variable 'retry'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'retry' is defined but never used. Allowed unused vars must match /^_/u.","line":94,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":94,"endColumn":8},{"ruleId":"no-unused-vars","severity":2,"message":"'safeJsonParse' is defined but never used. Allowed unused vars must match /^_/u.","line":95,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":95,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"safeJsonParse"},"fix":{"range":[1879,1896],"text":""},"desc":"Remove unused variable 'safeJsonParse'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'safeJsonParse' is defined but never used. Allowed unused vars must match /^_/u.","line":95,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":95,"endColumn":16},{"ruleId":"no-unused-vars","severity":2,"message":"'safeJsonStringify' is defined but never used. Allowed unused vars must match /^_/u.","line":96,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":96,"endColumn":20,"suggestions":[{"messageId":"removeVar","data":{"varName":"safeJsonStringify"},"fix":{"range":[1896,1917],"text":""},"desc":"Remove unused variable 'safeJsonStringify'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'safeJsonStringify' is defined but never used. Allowed unused vars must match /^_/u.","line":96,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":96,"endColumn":20}],"suppressedMessages":[],"errorCount":120,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 语言存储系统基础类型定义 - 主入口\n * Locale Storage System Base Type Definitions - Main Entry Point\n *\n * 统一的语言存储系统类型入口，整合所有类型定义模块\n */\n\n// 重新导出所有模块的功能\nexport * from './locale-storage-types-base';\nexport * from './locale-storage-types-data';\nexport * from './locale-storage-types-config';\nexport * from './locale-storage-types-utils';\n\n// 向后兼容的重新导出\nimport type { Locale } from '@/types/i18n';\nimport type {\n  STORAGE_KEYS,\n  LocaleSource,\n  StorageEventType,\n  STORAGE_CONSTANTS,\n  StorageType,\n  CompressionAlgorithm,\n  EncryptionAlgorithm,\n  SyncStatus,\n  MigrationStatus,\n  HealthStatus,\n  ErrorType,\n  PriorityLevel,\n  EnvironmentType,\n  BrowserType,\n  DeviceType,\n  OSType,\n  VersionInfo,\n  TimestampUtils,\n  BaseValidators,\n} from './locale-storage-types-base';\n\nimport type {\n  UserLocalePreference,\n  LocaleDetectionRecord,\n  LocaleDetectionHistory,\n  StorageStats,\n  StorageOperationResult,\n  StorageEvent,\n  StorageEventListener,\n  StorageHealthCheck,\n  ValidationResult,\n  StorageBackupData,\n  StorageMigrationConfig,\n  StorageCompressionConfig,\n  StorageEncryptionConfig,\n  StorageSyncConfig,\n  DeviceInfo,\n  NetworkInfo,\n  GeolocationInfo,\n  SessionInfo,\n  PerformanceMetrics,\n  ErrorInfo,\n  AuditLogEntry,\n  ConfigSnapshot,\n  DataExport,\n  DataImportResult,\n} from './locale-storage-types-data';\n\nimport type {\n  StorageConfig,\n  DEFAULT_STORAGE_CONFIG,\n  EnvironmentConfig,\n  CONFIG_PRESETS,\n  ConfigValidationRules,\n  CONFIG_VALIDATION_RULES,\n  ConfigMigration,\n  CONFIG_MIGRATIONS,\n} from './locale-storage-types-config';\n\nimport {\n  isUserLocalePreference,\n  isLocaleDetectionHistory,\n  isStorageConfig,\n  validatePreference,\n  validateDetectionHistory,\n  createStorageKey,\n  parseStorageKey,\n  estimateStorageSize,\n  generateChecksum,\n  deepClone,\n  mergeObjects,\n  compareObjects,\n  formatByteSize,\n  formatDuration,\n  generateUniqueId,\n  throttle,\n  debounce,\n  retry,\n  safeJsonParse,\n  safeJsonStringify,\n} from './locale-storage-types-utils';\n\n// ==================== 向后兼容的类型别名 ====================\n\n/**\n * 向后兼容的类型别名\n * Backward compatible type aliases\n */\nexport type {\n  // 基础类型\n  STORAGE_KEYS as StorageKeys,\n  LocaleSource as Source,\n  StorageEventType as EventType,\n\n  // 数据结构\n  UserLocalePreference as Preference,\n  LocaleDetectionRecord as DetectionRecord,\n  LocaleDetectionHistory as DetectionHistory,\n  StorageOperationResult as OperationResult,\n  StorageEvent as Event,\n  StorageEventListener as EventListener,\n\n  // 配置\n  StorageConfig as Config,\n  DEFAULT_STORAGE_CONFIG as DefaultConfig,\n\n  // 工具函数类型\n  ValidationResult as Validation,\n};\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/locale-storage.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/logger.ts","messages":[{"ruleId":"max-params","severity":2,"message":"Method 'createLogEntry' has too many parameters (4). Maximum allowed is 3.","line":89,"column":3,"nodeType":"FunctionExpression","messageId":"exceed","endLine":89,"endColumn":25},{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from 'no-console').","line":116,"column":5,"severity":1,"nodeType":null,"fix":{"range":[2335,2373],"text":" "}},{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from 'no-console').","line":118,"column":5,"severity":1,"nodeType":null,"fix":{"range":[2415,2453],"text":" "}},{"ruleId":"max-params","severity":2,"message":"Method 'log' has too many parameters (4). Maximum allowed is 3.","line":153,"column":3,"nodeType":"FunctionExpression","messageId":"exceed","endLine":153,"endColumn":14}],"suppressedMessages":[{"ruleId":"no-unused-vars","severity":2,"message":"'DEBUG' is defined but never used. Allowed unused vars must match /^_/u.","line":11,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":8,"suggestions":[{"messageId":"removeVar","data":{"varName":"DEBUG"},"fix":{"range":[193,198],"text":""},"desc":"Remove unused variable 'DEBUG'."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-unused-vars","severity":2,"message":"'INFO' is defined but never used. Allowed unused vars must match /^_/u.","line":13,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":7,"suggestions":[{"messageId":"removeVar","data":{"varName":"INFO"},"fix":{"range":[208,261],"text":""},"desc":"Remove unused variable 'INFO'."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-unused-vars","severity":2,"message":"'WARN' is defined but never used. Allowed unused vars must match /^_/u.","line":15,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":7,"suggestions":[{"messageId":"removeVar","data":{"varName":"WARN"},"fix":{"range":[270,323],"text":""},"desc":"Remove unused variable 'WARN'."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-unused-vars","severity":2,"message":"'ERROR' is defined but never used. Allowed unused vars must match /^_/u.","line":17,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":8,"suggestions":[{"messageId":"removeVar","data":{"varName":"ERROR"},"fix":{"range":[332,386],"text":""},"desc":"Remove unused variable 'ERROR'."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-console","severity":2,"message":"Unexpected console statement.","line":117,"column":23,"nodeType":"MemberExpression","messageId":"unexpected","endLine":117,"endColumn":36,"suppressions":[{"kind":"directive","justification":""},{"kind":"directive","justification":""}]},{"ruleId":"no-console","severity":2,"message":"Unexpected console statement.","line":119,"column":22,"nodeType":"MemberExpression","messageId":"unexpected","endLine":119,"endColumn":34,"suppressions":[{"kind":"directive","justification":""},{"kind":"directive","justification":""}]},{"ruleId":"no-console","severity":2,"message":"Unexpected console statement.","line":120,"column":22,"nodeType":"MemberExpression","messageId":"unexpected","endLine":120,"endColumn":34,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-console","severity":2,"message":"Unexpected console statement.","line":121,"column":23,"nodeType":"MemberExpression","messageId":"unexpected","endLine":121,"endColumn":36,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":2,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":2,"source":"/* eslint-disable no-console */\n/**\n * 结构化日志工具\n * 提供类型安全的结构化日志记录，替代console语句\n * 遵循项目编码标准，支持不同日志级别和结构化数据\n */\n\n/** 日志级别枚举 */\nexport enum LogLevel {\n  // eslint-disable-next-line no-unused-vars\n  DEBUG = 'debug',\n  // eslint-disable-next-line no-unused-vars\n  INFO = 'info',\n  // eslint-disable-next-line no-unused-vars\n  WARN = 'warn',\n  // eslint-disable-next-line no-unused-vars\n  ERROR = 'error',\n}\n\n/** 日志条目接口 */\nexport interface LogEntry {\n  level: LogLevel;\n  message: string;\n  timestamp: string;\n  context?: Record<string, unknown>;\n  error?: Error;\n}\n\n/** 日志配置接口 */\nexport interface LoggerConfig {\n  /** 是否启用日志 */\n  enabled: boolean;\n  /** 最小日志级别 */\n  minLevel: LogLevel;\n  /** 是否在开发环境输出到控制台 */\n  enableConsoleInDev: boolean;\n  /** 是否包含时间戳 */\n  includeTimestamp: boolean;\n}\n\n/** 默认日志配置 */\nconst DEFAULT_CONFIG: LoggerConfig = {\n  enabled: true,\n  minLevel: LogLevel.INFO,\n  enableConsoleInDev: process.env.NODE_ENV === 'development',\n  includeTimestamp: true,\n};\n\n/** 日志级别优先级映射 */\nconst LOG_LEVEL_PRIORITY: Record<LogLevel, number> = {\n  [LogLevel.DEBUG]: 0,\n  [LogLevel.INFO]: 1,\n  [LogLevel.WARN]: 2,\n  [LogLevel.ERROR]: 3,\n};\n\n/**\n * 结构化日志记录器类\n */\nclass Logger {\n  private config: LoggerConfig;\n\n  constructor(config: Partial<LoggerConfig> = {}) {\n    this.config = { ...DEFAULT_CONFIG, ...config };\n  }\n\n  /**\n   * 检查日志级别是否应该被记录\n   */\n  private shouldLog(level: LogLevel): boolean {\n    if (!this.config.enabled) {\n      return false;\n    }\n\n    // 安全的属性访问，避免对象注入\n    const levelPriority =\n      LOG_LEVEL_PRIORITY[level as keyof typeof LOG_LEVEL_PRIORITY];\n    const minLevelPriority =\n      LOG_LEVEL_PRIORITY[\n        this.config.minLevel as keyof typeof LOG_LEVEL_PRIORITY\n      ];\n\n    return levelPriority >= minLevelPriority;\n  }\n\n  /**\n   * 创建日志条目\n   */\n  private createLogEntry(\n    level: LogLevel,\n    message: string,\n    context?: Record<string, unknown>,\n    error?: Error,\n  ): LogEntry {\n    const entry: LogEntry = {\n      level,\n      message,\n      timestamp: this.config.includeTimestamp ? new Date().toISOString() : '',\n    };\n\n    if (context && Object.keys(context).length > 0) {\n      entry.context = context;\n    }\n\n    if (error) {\n      entry.error = error;\n    }\n\n    return entry;\n  }\n\n  /**\n   * Console method mapping for different log levels\n   */\n  private readonly consoleMethodMap = {\n    // eslint-disable-next-line no-console\n    [LogLevel.DEBUG]: console.debug,\n    // eslint-disable-next-line no-console\n    [LogLevel.INFO]: console.info,\n    [LogLevel.WARN]: console.warn,\n    [LogLevel.ERROR]: console.error,\n  } as const;\n\n  /**\n   * Format log message with timestamp\n   */\n  private formatLogMessage(message: string, timestamp?: string): string {\n    const timePrefix = timestamp ? `[${timestamp}] ` : '';\n    return `${timePrefix}${message}`;\n  }\n\n  /**\n   * 输出日志到控制台 (仅在开发环境)\n   */\n  private outputToConsole(entry: LogEntry): void {\n    if (!this.config.enableConsoleInDev) {\n      return;\n    }\n\n    const { level, message, timestamp, context, error } = entry;\n    const fullMessage = this.formatLogMessage(message, timestamp);\n    const consoleMethod =\n      this.consoleMethodMap[level as keyof typeof this.consoleMethodMap];\n\n    if (consoleMethod) {\n      consoleMethod(fullMessage, context || '', error || '');\n    }\n  }\n\n  /**\n   * 记录日志的通用方法\n   */\n  private log(\n    level: LogLevel,\n    message: string,\n    context?: Record<string, unknown>,\n    error?: Error,\n  ): void {\n    if (!this.shouldLog(level)) {\n      return;\n    }\n\n    const entry = this.createLogEntry(level, message, context, error);\n\n    // 在开发环境输出到控制台\n    this.outputToConsole(entry);\n\n    // 在生产环境可以扩展为发送到日志服务\n    // 例如：Sentry、CloudWatch、或其他日志聚合服务\n  }\n\n  /**\n   * 记录调试信息\n   */\n  debug(message: string, context?: Record<string, unknown>): void {\n    this.log(LogLevel.DEBUG, message, context);\n  }\n\n  /**\n   * 记录一般信息\n   */\n  info(message: string, context?: Record<string, unknown>): void {\n    this.log(LogLevel.INFO, message, context);\n  }\n\n  /**\n   * 记录警告信息\n   */\n  warn(message: string, context?: Record<string, unknown>): void {\n    this.log(LogLevel.WARN, message, context);\n  }\n\n  /**\n   * 记录错误信息\n   */\n  error(\n    message: string,\n    context?: Record<string, unknown>,\n    error?: Error,\n  ): void {\n    this.log(LogLevel.ERROR, message, context, error);\n  }\n\n  /**\n   * 更新日志配置\n   */\n  updateConfig(newConfig: Partial<LoggerConfig>): void {\n    this.config = { ...this.config, ...newConfig };\n  }\n\n  /**\n   * 获取当前配置\n   */\n  getConfig(): LoggerConfig {\n    return { ...this.config };\n  }\n}\n\n/** 默认日志实例 */\nexport const logger = new Logger();\n\n/** 创建自定义日志实例 */\nexport function createLogger(config: Partial<LoggerConfig> = {}): Logger {\n  return new Logger(config);\n}\n\n/** 日志工具函数 */\nexport const log = {\n  debug: (message: string, context?: Record<string, unknown>) =>\n    logger.debug(message, context),\n  info: (message: string, context?: Record<string, unknown>) =>\n    logger.info(message, context),\n  warn: (message: string, context?: Record<string, unknown>) =>\n    logger.warn(message, context),\n  error: (message: string, context?: Record<string, unknown>, error?: Error) =>\n    logger.error(message, context, error),\n};\n\n/** 导出类型 - 使用命名导出避免冲突 */\nexport type { LoggerConfig as LoggerConfiguration, LogEntry as LoggerEntry };\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/metadata.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/navigation.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/performance-monitoring-coordinator.ts","messages":[{"ruleId":"no-duplicate-imports","severity":2,"message":"'./performance-monitoring-types' import is duplicated.","line":21,"column":1,"nodeType":"ImportDeclaration","messageId":"import","endLine":21,"endColumn":76},{"ruleId":"max-params","severity":2,"message":"Method 'recordNetworkRequest' has too many parameters (4). Maximum allowed is 3.","line":115,"column":5,"nodeType":"ArrowFunctionExpression","messageId":"exceed","endLine":115,"endColumn":27}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 性能监控协调器 - 主入口文件\n * Performance Monitoring Coordinator - Main Entry Point\n *\n * 统一管理多个性能监控工具的协调运作：\n * - React Scan: 实时组件性能监控\n * - Web Eval Agent: 端到端用户体验测试\n * - Bundle Analyzer: 构建产物分析\n * - Size Limit: 包大小监控\n * - Web Vitals: 核心网页指标监控\n */\n\n// 重新导出所有模块的类型和功能\nexport * from './performance-monitoring-types';\nexport * from './performance-monitoring-core';\nexport * from './performance-monitoring-integrations';\n\n// 导入核心功能\nimport { PerformanceMonitoringCore } from './performance-monitoring-core';\nimport type { PerformanceConfig } from './performance-monitoring-types';\nimport { generateEnvironmentConfig } from './performance-monitoring-types';\n\n/**\n * 性能监控协调器 - 向后兼容的主类\n * Performance Monitoring Coordinator - Backward compatible main class\n */\nexport class PerformanceMonitoringCoordinator extends PerformanceMonitoringCore {\n  constructor(customConfig?: Partial<PerformanceConfig>) {\n    super(customConfig);\n  }\n}\n\n// ==================== 全局实例和便捷导出 ====================\n\n/**\n * 全局性能监控协调器实例\n * Global performance monitoring coordinator instance\n */\nexport const performanceCoordinator = new PerformanceMonitoringCoordinator();\n\n// ==================== 便捷工厂函数 ====================\n\n/**\n * 创建性能监控协调器实例\n * Create performance monitoring coordinator instance\n */\nexport function createPerformanceCoordinator(\n  customConfig?: Partial<PerformanceConfig>\n): PerformanceMonitoringCoordinator {\n  return new PerformanceMonitoringCoordinator(customConfig);\n}\n\n/**\n * 获取默认环境配置\n * Get default environment configuration\n */\nexport function getDefaultConfig(): PerformanceConfig {\n  return generateEnvironmentConfig();\n}\n\n// ==================== 便捷集成钩子 ====================\n\n/**\n * React Scan 集成钩子 (向后兼容)\n * React Scan integration hook (backward compatible)\n */\nexport function useReactScanIntegration() {\n  const config = performanceCoordinator.getConfig();\n\n  return {\n    enabled: config.reactScan.enabled,\n    recordRender: (componentName: string, renderCount: number) => {\n      if (config.reactScan.enabled) {\n        performanceCoordinator.recordMetric({\n          source: 'react-scan',\n          type: 'component',\n          data: {\n            componentName,\n            renderCount,\n            timestamp: Date.now(),\n          },\n        });\n      }\n    },\n  };\n}\n\n/**\n * Web Eval Agent 集成钩子 (向后兼容)\n * Web Eval Agent integration hook (backward compatible)\n */\nexport function useWebEvalAgentIntegration() {\n  const config = performanceCoordinator.getConfig();\n\n  return {\n    enabled: config.webEvalAgent.enabled,\n    recordUserInteraction: (\n      action: string,\n      timing: number,\n      success: boolean,\n    ) => {\n      if (config.webEvalAgent.enabled) {\n        performanceCoordinator.recordMetric({\n          source: 'web-eval-agent',\n          type: 'user-interaction',\n          data: {\n            action,\n            timing,\n            success,\n            timestamp: Date.now(),\n          },\n        });\n      }\n    },\n    recordNetworkRequest: (\n      url: string,\n      method: string,\n      status: number,\n      timing: number,\n    ) => {\n      if (config.webEvalAgent.enabled && config.webEvalAgent.captureNetwork) {\n        performanceCoordinator.recordMetric({\n          source: 'web-eval-agent',\n          type: 'network',\n          data: {\n            url,\n            method,\n            status,\n            timing,\n            timestamp: Date.now(),\n          },\n        });\n      }\n    },\n  };\n}\n\n/**\n * 环境检查工具 (向后兼容)\n * Environment check tool (backward compatible)\n */\nexport function checkEnvironmentCompatibility(): {\n  isCompatible: boolean;\n  issues: string[];\n  recommendations: string[];\n} {\n  const issues: string[] = [];\n  const recommendations: string[] = [];\n\n  // 检查测试环境配置\n  if (process.env.PLAYWRIGHT_TEST === 'true') {\n    if (process.env.NEXT_PUBLIC_DISABLE_REACT_SCAN !== 'true') {\n      issues.push('测试环境中 React Scan 未被禁用');\n      recommendations.push('设置 NEXT_PUBLIC_DISABLE_REACT_SCAN=true');\n    }\n  }\n\n  // 检查开发环境配置\n  if (process.env.NODE_ENV === 'development') {\n    if (process.env.NEXT_PUBLIC_DISABLE_REACT_SCAN === 'true') {\n      recommendations.push(\n        '开发环境中 React Scan 被禁用，考虑启用以获得性能监控',\n      );\n    }\n  }\n\n  return {\n    isCompatible: issues.length === 0,\n    issues,\n    recommendations,\n  };\n}\n\n// ==================== 默认导出 ====================\n\n/**\n * 默认导出全局协调器实例\n * Default export global coordinator instance\n */\nexport default performanceCoordinator;\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/performance-monitoring-core-config.ts","messages":[{"ruleId":"no-duplicate-imports","severity":2,"message":"'./performance-monitoring-types' import is duplicated.","line":14,"column":1,"nodeType":"ImportDeclaration","messageId":"import","endLine":14,"endColumn":92},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":143,"column":17,"nodeType":"MemberExpression","endLine":143,"endColumn":36},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":154,"column":5,"nodeType":"MemberExpression","endLine":154,"endColumn":24},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":155,"column":10,"nodeType":"MemberExpression","endLine":155,"endColumn":29},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2.","line":171,"column":46,"nodeType":"Literal","messageId":"noMagic","endLine":171,"endColumn":47},{"ruleId":"complexity","severity":2,"message":"Method 'getConfigSummary' has a complexity of 17. Maximum allowed is 15.","line":201,"column":19,"nodeType":"FunctionExpression","messageId":"complex","endLine":229,"endColumn":4},{"ruleId":"max-statements","severity":2,"message":"Method 'compareConfigs' has too many statements (21). Maximum allowed is 20.","line":235,"column":17,"nodeType":"FunctionExpression","messageId":"exceed","endLine":281,"endColumn":4},{"ruleId":"complexity","severity":2,"message":"Method 'compareConfigs' has a complexity of 34. Maximum allowed is 15.","line":235,"column":17,"nodeType":"FunctionExpression","messageId":"complex","endLine":281,"endColumn":4},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 10.","line":305,"column":37,"nodeType":"Literal","messageId":"noMagic","endLine":305,"endColumn":39},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: -10.","line":306,"column":53,"nodeType":"UnaryExpression","messageId":"noMagic","endLine":306,"endColumn":56}],"suppressedMessages":[],"errorCount":10,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 性能监控核心配置管理\n * Performance Monitoring Core Configuration Management\n * \n * 负责性能监控的配置管理、验证和合并功能\n */\n\nimport { PERFORMANCE_CONSTANTS } from '@/constants/performance';\nimport { MB } from '@/constants/units';\nimport { logger } from '@/lib/logger';\nimport type {\n  PerformanceConfig,\n} from './performance-monitoring-types';\nimport { generateEnvironmentConfig, validateConfig } from './performance-monitoring-types';\n\n/**\n * 配置管理器\n * Configuration manager\n */\nexport class PerformanceConfigManager {\n  private config: PerformanceConfig;\n  private isInitialized = false;\n\n  constructor(customConfig?: Partial<PerformanceConfig>) {\n    this.config = this.initializeConfig(customConfig);\n    this.isInitialized = true;\n  }\n\n  /**\n   * 初始化配置\n   * Initialize configuration\n   */\n  private initializeConfig(customConfig?: Partial<PerformanceConfig>): PerformanceConfig {\n    // 生成默认配置\n    const defaultConfig = generateEnvironmentConfig();\n    \n    // 合并自定义配置\n    const mergedConfig = customConfig \n      ? this.mergeConfig(defaultConfig, customConfig)\n      : defaultConfig;\n\n    // 验证配置\n    const validation = validateConfig(mergedConfig);\n    if (!validation.isValid) {\n      logger.warn('Performance monitoring config validation failed', { errors: validation.errors });\n      // 使用默认配置作为后备\n      return defaultConfig;\n    }\n\n    return mergedConfig;\n  }\n\n  /**\n   * 合并配置\n   * Merge configuration\n   */\n  mergeConfig(\n    defaultConfig: PerformanceConfig,\n    customConfig: Partial<PerformanceConfig>\n  ): PerformanceConfig {\n    const merged: PerformanceConfig = {\n      global: {\n        ...defaultConfig.global,\n        ...customConfig.global,\n      },\n      component: {\n        ...defaultConfig.component,\n        ...customConfig.component,\n      },\n      network: {\n        ...defaultConfig.network,\n        ...customConfig.network,\n      },\n      bundle: {\n        ...defaultConfig.bundle,\n        ...customConfig.bundle,\n      },\n    };\n\n    return merged;\n  }\n\n  /**\n   * 获取配置\n   * Get configuration\n   */\n  getConfig(): PerformanceConfig {\n    return { ...this.config };\n  }\n\n  /**\n   * 更新配置\n   * Update configuration\n   */\n  updateConfig(newConfig: Partial<PerformanceConfig>): void {\n    this.config = this.mergeConfig(this.config, newConfig);\n    \n    // 重新验证配置\n    const validation = validateConfig(this.config);\n    if (!validation.isValid) {\n      logger.warn('Updated performance config validation failed', { errors: validation.errors });\n    }\n  }\n\n  /**\n   * 重置配置为默认值\n   * Reset configuration to defaults\n   */\n  resetConfig(): void {\n    this.config = generateEnvironmentConfig();\n  }\n\n  /**\n   * 检查配置是否有效\n   * Check if configuration is valid\n   */\n  isConfigValid(): boolean {\n    const validation = validateConfig(this.config);\n    return validation.isValid;\n  }\n\n  /**\n   * 获取配置验证结果\n   * Get configuration validation result\n   */\n  validateCurrentConfig(): ReturnType<typeof validateConfig> {\n    return validateConfig(this.config);\n  }\n\n  /**\n   * 检查是否已初始化\n   * Check if initialized\n   */\n  isConfigInitialized(): boolean {\n    return this.isInitialized;\n  }\n\n  /**\n   * 获取特定模块的配置\n   * Get specific module configuration\n   */\n  getModuleConfig<T extends keyof PerformanceConfig>(module: T): PerformanceConfig[T] {\n    return { ...this.config[module] };\n  }\n\n  /**\n   * 更新特定模块的配置\n   * Update specific module configuration\n   */\n  updateModuleConfig<T extends keyof PerformanceConfig>(\n    module: T, \n    config: Partial<PerformanceConfig[T]>\n  ): void {\n    this.config[module] = {\n      ...this.config[module],\n      ...config,\n    };\n\n    // 验证更新后的配置\n    const validation = validateConfig(this.config);\n    if (!validation.isValid) {\n      logger.warn(`Updated ${module} config validation failed`, { errors: validation.errors });\n    }\n  }\n\n  /**\n   * 导出配置为JSON\n   * Export configuration as JSON\n   */\n  exportConfig(): string {\n    return JSON.stringify(this.config, null, 2);\n  }\n\n  /**\n   * 从JSON导入配置\n   * Import configuration from JSON\n   */\n  importConfig(configJson: string): boolean {\n    try {\n      const importedConfig = JSON.parse(configJson) as PerformanceConfig;\n      \n      // 验证导入的配置\n      const validation = validateConfig(importedConfig);\n      if (!validation.isValid) {\n        logger.error('Imported config validation failed', { errors: validation.errors });\n        return false;\n      }\n\n      this.config = importedConfig;\n      return true;\n    } catch (error) {\n      logger.error('Failed to import config', { error: error as Error });\n      return false;\n    }\n  }\n\n  /**\n   * 获取配置摘要\n   * Get configuration summary\n   */\n  getConfigSummary(): {\n    isEnabled: boolean;\n    enabledModules: string[];\n    dataRetentionTime: number;\n    maxMetrics: number;\n    thresholds: Record<string, number>;\n  } {\n    const global = this.config.global || {};\n    const component = this.config.component || {};\n    const network = this.config.network || {};\n    const bundle = this.config.bundle || {};\n\n    const enabledModules: string[] = [];\n    if (component.enabled) enabledModules.push('component');\n    if (network.enabled) enabledModules.push('network');\n    if (bundle.enabled) enabledModules.push('bundle');\n\n    return {\n      isEnabled: global.enabled || false,\n      enabledModules,\n      dataRetentionTime: global.dataRetentionTime || PERFORMANCE_CONSTANTS.DEFAULT_RETENTION_TIME,\n      maxMetrics: global.maxMetrics || PERFORMANCE_CONSTANTS.DEFAULT_MAX_METRICS,\n      thresholds: {\n        componentRenderTime: component.thresholds?.renderTime || 100,\n        networkResponseTime: network.thresholds?.responseTime || 1000,\n        bundleSize: bundle.thresholds?.size || MB, // 1MB\n      },\n    };\n  }\n\n  /**\n   * 比较两个配置\n   * Compare two configurations\n   */\n  compareConfigs(otherConfig: PerformanceConfig): {\n    isDifferent: boolean;\n    differences: string[];\n  } {\n    const differences: string[] = [];\n    const current = this.config;\n\n    // 比较全局配置\n    if (current.global?.enabled !== otherConfig.global?.enabled) {\n      differences.push('global.enabled');\n    }\n    if (current.global?.dataRetentionTime !== otherConfig.global?.dataRetentionTime) {\n      differences.push('global.dataRetentionTime');\n    }\n    if (current.global?.maxMetrics !== otherConfig.global?.maxMetrics) {\n      differences.push('global.maxMetrics');\n    }\n\n    // 比较组件配置\n    if (current.component?.enabled !== otherConfig.component?.enabled) {\n      differences.push('component.enabled');\n    }\n    if (current.component?.thresholds?.renderTime !== otherConfig.component?.thresholds?.renderTime) {\n      differences.push('component.thresholds.renderTime');\n    }\n\n    // 比较网络配置\n    if (current.network?.enabled !== otherConfig.network?.enabled) {\n      differences.push('network.enabled');\n    }\n    if (current.network?.thresholds?.responseTime !== otherConfig.network?.thresholds?.responseTime) {\n      differences.push('network.thresholds.responseTime');\n    }\n\n    // 比较打包配置\n    if (current.bundle?.enabled !== otherConfig.bundle?.enabled) {\n      differences.push('bundle.enabled');\n    }\n    if (current.bundle?.thresholds?.size !== otherConfig.bundle?.thresholds?.size) {\n      differences.push('bundle.thresholds.size');\n    }\n\n    return {\n      isDifferent: differences.length > 0,\n      differences,\n    };\n  }\n\n  /**\n   * 获取配置变更历史\n   * Get configuration change history\n   */\n  private configHistory: Array<{\n    timestamp: number;\n    config: PerformanceConfig;\n    reason?: string;\n  }> = [];\n\n  /**\n   * 记录配置变更\n   * Record configuration change\n   */\n  private recordConfigChange(reason?: string): void {\n    this.configHistory.push({\n      timestamp: Date.now(),\n      config: { ...this.config },\n      reason,\n    });\n\n    // 限制历史记录数量\n    if (this.configHistory.length > 10) {\n      this.configHistory = this.configHistory.slice(-10);\n    }\n  }\n\n  /**\n   * 获取配置变更历史\n   * Get configuration change history\n   */\n  getConfigHistory(): typeof this.configHistory {\n    return [...this.configHistory];\n  }\n\n  /**\n   * 回滚到之前的配置\n   * Rollback to previous configuration\n   */\n  rollbackConfig(steps = 1): boolean {\n    if (this.configHistory.length < steps + 1) {\n      return false;\n    }\n\n    const targetConfig = this.configHistory[this.configHistory.length - steps - 1];\n    this.config = { ...targetConfig.config };\n    this.recordConfigChange(`Rollback ${steps} steps`);\n    \n    return true;\n  }\n}\n\n/**\n * 创建配置管理器实例\n * Create configuration manager instance\n */\nexport function createConfigManager(customConfig?: Partial<PerformanceConfig>): PerformanceConfigManager {\n  return new PerformanceConfigManager(customConfig);\n}\n\n/**\n * 获取默认配置\n * Get default configuration\n */\nexport function getDefaultConfig(): PerformanceConfig {\n  return generateEnvironmentConfig();\n}\n\n/**\n * 验证配置对象\n * Validate configuration object\n */\nexport function validatePerformanceConfig(config: unknown): ReturnType<typeof validateConfig> {\n  return validateConfig(config as PerformanceConfig);\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/performance-monitoring-core-conflicts.ts","messages":[{"ruleId":"max-statements","severity":2,"message":"Method 'detectGlobalTools' has too many statements (23). Maximum allowed is 20.","line":98,"column":28,"nodeType":"FunctionExpression","messageId":"exceed","endLine":151,"endColumn":4},{"ruleId":"complexity","severity":2,"message":"Method 'detectGlobalTools' has a complexity of 16. Maximum allowed is 15.","line":98,"column":28,"nodeType":"FunctionExpression","messageId":"complex","endLine":151,"endColumn":4},{"ruleId":"no-underscore-dangle","severity":2,"message":"Unexpected dangling '_' in '__REACT_DEVTOOLS_GLOBAL_HOOK__'.","line":102,"column":9,"nodeType":"MemberExpression","messageId":"unexpectedUnderscore","endLine":102,"endColumn":55},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":102,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":102,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2118,2121],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2118,2121],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-underscore-dangle","severity":2,"message":"Unexpected dangling '_' in '__REDUX_DEVTOOLS_EXTENSION__'.","line":107,"column":9,"nodeType":"MemberExpression","messageId":"unexpectedUnderscore","endLine":107,"endColumn":53},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":107,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":107,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2251,2254],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2251,2254],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-underscore-dangle","severity":2,"message":"Unexpected dangling '_' in '__VUE_DEVTOOLS_GLOBAL_HOOK__'.","line":112,"column":9,"nodeType":"MemberExpression","messageId":"unexpectedUnderscore","endLine":112,"endColumn":53},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":112,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":112,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2380,2383],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2380,2383],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":117,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":117,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2511,2514],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2511,2514],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":122,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":122,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2610,2613],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2610,2613],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-underscore-dangle","severity":2,"message":"Unexpected dangling '_' in '__SENTRY__'.","line":122,"column":35,"nodeType":"MemberExpression","messageId":"unexpectedUnderscore","endLine":122,"endColumn":61},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":122,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":122,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2636,2639],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2636,2639],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":127,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":127,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2743,2746],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2743,2746],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":127,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":127,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2767,2770],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2767,2770],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":127,"column":66,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":127,"endColumn":69,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2789,2792],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2789,2792],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":132,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":132,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2895,2898],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2895,2898],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":136,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":136,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2978,2981],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2978,2981],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":140,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":140,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3054,3057],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3054,3057],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":144,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":144,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3127,3130],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3127,3130],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":148,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":148,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3208,3211],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3208,3211],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 3.","line":162,"column":36,"nodeType":"Literal","messageId":"noMagic","endLine":162,"endColumn":37},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 50.","line":174,"column":30,"nodeType":"Literal","messageId":"noMagic","endLine":174,"endColumn":32},{"ruleId":"no-underscore-dangle","severity":2,"message":"Unexpected dangling '_' in '__REACT_DEVTOOLS_GLOBAL_HOOK__'.","line":197,"column":11,"nodeType":"MemberExpression","messageId":"unexpectedUnderscore","endLine":197,"endColumn":57},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":197,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":197,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4626,4629],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4626,4629],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-underscore-dangle","severity":2,"message":"Unexpected dangling '_' in '__REDUX_DEVTOOLS_EXTENSION__'.","line":198,"column":11,"nodeType":"MemberExpression","messageId":"unexpectedUnderscore","endLine":198,"endColumn":55},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":198,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":198,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4704,4707],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4704,4707],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-underscore-dangle","severity":2,"message":"Unexpected dangling '_' in '__VUE_DEVTOOLS_GLOBAL_HOOK__'.","line":199,"column":11,"nodeType":"MemberExpression","messageId":"unexpectedUnderscore","endLine":199,"endColumn":55},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":199,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":199,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4780,4783],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4780,4783],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2.","line":201,"column":27,"nodeType":"Literal","messageId":"noMagic","endLine":201,"endColumn":28},{"ruleId":"no-underscore-dangle","severity":2,"message":"Unexpected dangling '_' in '__REACT_DEVTOOLS_GLOBAL_HOOK__'.","line":210,"column":11,"nodeType":"MemberExpression","messageId":"unexpectedUnderscore","endLine":210,"endColumn":57},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":210,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":210,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5074,5077],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5074,5077],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-underscore-dangle","severity":2,"message":"Unexpected dangling '_' in '__REDUX_DEVTOOLS_EXTENSION__'.","line":211,"column":11,"nodeType":"MemberExpression","messageId":"unexpectedUnderscore","endLine":211,"endColumn":55},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":211,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":211,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5169,5172],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5169,5172],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2.","line":232,"column":34,"nodeType":"Literal","messageId":"noMagic","endLine":232,"endColumn":35},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2.","line":240,"column":33,"nodeType":"Literal","messageId":"noMagic","endLine":240,"endColumn":34},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 5.","line":282,"column":32,"nodeType":"Literal","messageId":"noMagic","endLine":282,"endColumn":33},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":309,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":309,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7932,7935],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7932,7935],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-underscore-dangle","severity":2,"message":"Unexpected dangling '_' in '__PERFORMANCE_OBSERVERS__'.","line":312,"column":9,"nodeType":"MemberExpression","messageId":"unexpectedUnderscore","endLine":312,"endColumn":50},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":312,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":312,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8003,8006],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8003,8006],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-underscore-dangle","severity":2,"message":"Unexpected dangling '_' in '__PERFORMANCE_OBSERVERS__'.","line":313,"column":16,"nodeType":"MemberExpression","messageId":"unexpectedUnderscore","endLine":313,"endColumn":57},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":313,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":313,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8063,8066],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8063,8066],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2.","line":330,"column":28,"nodeType":"Literal","messageId":"noMagic","endLine":330,"endColumn":29},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2.","line":330,"column":56,"nodeType":"Literal","messageId":"noMagic","endLine":330,"endColumn":57},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":343,"column":25,"nodeType":"MemberExpression","endLine":343,"endColumn":81},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":343,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":343,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8850,8853],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8850,8853],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-implicit-coercion","severity":2,"message":"Unexpected implicit coercion encountered. Use `Boolean((window as any).__REACT_DEVTOOLS_GLOBAL_HOOK__)` instead.","line":365,"column":19,"nodeType":"UnaryExpression","messageId":"implicitCoercion","endLine":365,"endColumn":67,"fix":{"range":[9334,9382],"text":"Boolean((window as any).__REACT_DEVTOOLS_GLOBAL_HOOK__)"}},{"ruleId":"no-underscore-dangle","severity":2,"message":"Unexpected dangling '_' in '__REACT_DEVTOOLS_GLOBAL_HOOK__'.","line":365,"column":21,"nodeType":"MemberExpression","messageId":"unexpectedUnderscore","endLine":365,"endColumn":67},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":365,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":365,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9347,9350],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9347,9350],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-implicit-coercion","severity":2,"message":"Unexpected implicit coercion encountered. Use `Boolean((window as any).__REDUX_DEVTOOLS_EXTENSION__)` instead.","line":370,"column":19,"nodeType":"UnaryExpression","messageId":"implicitCoercion","endLine":370,"endColumn":65,"fix":{"range":[9519,9565],"text":"Boolean((window as any).__REDUX_DEVTOOLS_EXTENSION__)"}},{"ruleId":"no-underscore-dangle","severity":2,"message":"Unexpected dangling '_' in '__REDUX_DEVTOOLS_EXTENSION__'.","line":370,"column":21,"nodeType":"MemberExpression","messageId":"unexpectedUnderscore","endLine":370,"endColumn":65},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":370,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":370,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9532,9535],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9532,9535],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-implicit-coercion","severity":2,"message":"Unexpected implicit coercion encountered. Use `Boolean((window as any).Sentry)` instead.","line":375,"column":19,"nodeType":"UnaryExpression","messageId":"implicitCoercion","endLine":375,"endColumn":43,"fix":{"range":[9689,9713],"text":"Boolean((window as any).Sentry)"}},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":375,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":375,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9702,9705],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9702,9705],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-implicit-coercion","severity":2,"message":"Unexpected implicit coercion encountered. Use `Boolean((window as any).gtag)` instead.","line":380,"column":19,"nodeType":"UnaryExpression","messageId":"implicitCoercion","endLine":380,"endColumn":41,"fix":{"range":[9841,9863],"text":"Boolean((window as any).gtag)"}},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":380,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":380,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9854,9857],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9854,9857],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-implicit-coercion","severity":2,"message":"Unexpected implicit coercion encountered. Use `Boolean((window as any).ga)` instead.","line":380,"column":45,"nodeType":"UnaryExpression","messageId":"implicitCoercion","endLine":380,"endColumn":65,"fix":{"range":[9867,9887],"text":"Boolean((window as any).ga)"}},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":380,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":380,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9880,9883],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9880,9883],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":57,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":5,"fixableWarningCount":0,"source":"/**\n * 性能监控核心工具冲突检查\n * Performance Monitoring Core Tool Conflict Detection\n * \n * 负责检测和解决性能监控工具之间的冲突问题\n */\n\n/**\n * 工具冲突检查结果\n * Tool conflict check result\n */\nexport interface ToolConflictResult {\n  hasConflicts: boolean;\n  conflicts: string[];\n  warnings: string[];\n  recommendations: string[];\n  detectedTools: string[];\n}\n\n/**\n * 工具冲突检查器\n * Tool conflict checker\n */\nexport class PerformanceToolConflictChecker {\n  private knownTools = [\n    'React DevTools',\n    'Redux DevTools',\n    'Vue DevTools',\n    'Angular DevTools',\n    'Lighthouse',\n    'Web Vitals',\n    'Performance Observer',\n    'User Timing API',\n    'Navigation Timing API',\n    'Resource Timing API',\n    'Paint Timing API',\n    'Long Tasks API',\n    'Intersection Observer',\n    'Mutation Observer',\n    'ResizeObserver',\n    'PerformanceObserver',\n    'Chrome DevTools',\n    'Firefox DevTools',\n    'Safari DevTools',\n    'Edge DevTools',\n    'Sentry',\n    'LogRocket',\n    'FullStory',\n    'Hotjar',\n    'Google Analytics',\n    'Adobe Analytics',\n    'Mixpanel',\n    'Amplitude',\n    'New Relic',\n    'DataDog',\n    'AppDynamics',\n    'Dynatrace',\n  ];\n\n  /**\n   * 检查工具冲突\n   * Check tool conflicts\n   */\n  checkToolConflicts(): ToolConflictResult {\n    const conflicts: string[] = [];\n    const warnings: string[] = [];\n    const recommendations: string[] = [];\n    const detectedTools: string[] = [];\n\n    // 检查全局对象中的工具\n    this.detectGlobalTools(detectedTools);\n\n    // 检查性能API冲突\n    this.checkPerformanceAPIConflicts(conflicts, warnings);\n\n    // 检查开发者工具冲突\n    this.checkDevToolsConflicts(conflicts, warnings);\n\n    // 检查第三方监控工具冲突\n    this.checkThirdPartyToolConflicts(detectedTools, conflicts, warnings);\n\n    // 生成建议\n    this.generateRecommendations(detectedTools, conflicts, recommendations);\n\n    return {\n      hasConflicts: conflicts.length > 0,\n      conflicts,\n      warnings,\n      recommendations,\n      detectedTools,\n    };\n  }\n\n  /**\n   * 检测全局工具\n   * Detect global tools\n   */\n  private detectGlobalTools(detectedTools: string[]): void {\n    if (typeof window === 'undefined') return;\n\n    // 检查React DevTools\n    if ((window as any).__REACT_DEVTOOLS_GLOBAL_HOOK__) {\n      detectedTools.push('React DevTools');\n    }\n\n    // 检查Redux DevTools\n    if ((window as any).__REDUX_DEVTOOLS_EXTENSION__) {\n      detectedTools.push('Redux DevTools');\n    }\n\n    // 检查Vue DevTools\n    if ((window as any).__VUE_DEVTOOLS_GLOBAL_HOOK__) {\n      detectedTools.push('Vue DevTools');\n    }\n\n    // 检查Angular DevTools\n    if ((window as any).ng) {\n      detectedTools.push('Angular DevTools');\n    }\n\n    // 检查Sentry\n    if ((window as any).Sentry || (window as any).__SENTRY__) {\n      detectedTools.push('Sentry');\n    }\n\n    // 检查Google Analytics\n    if ((window as any).gtag || (window as any).ga || (window as any).dataLayer) {\n      detectedTools.push('Google Analytics');\n    }\n\n    // 检查其他监控工具\n    if ((window as any).LogRocket) {\n      detectedTools.push('LogRocket');\n    }\n\n    if ((window as any).FS) {\n      detectedTools.push('FullStory');\n    }\n\n    if ((window as any).hj) {\n      detectedTools.push('Hotjar');\n    }\n\n    if ((window as any).mixpanel) {\n      detectedTools.push('Mixpanel');\n    }\n\n    if ((window as any).amplitude) {\n      detectedTools.push('Amplitude');\n    }\n  }\n\n  /**\n   * 检查性能API冲突\n   * Check Performance API conflicts\n   */\n  private checkPerformanceAPIConflicts(conflicts: string[], warnings: string[]): void {\n    if (typeof window === 'undefined' || !window.performance) return;\n\n    // 检查PerformanceObserver是否被多次使用\n    const performanceObserverCount = this.countPerformanceObservers();\n    if (performanceObserverCount > 3) {\n      warnings.push(`检测到 ${performanceObserverCount} 个 PerformanceObserver 实例，可能影响性能`);\n    }\n\n    // 检查User Timing API使用情况\n    const userTimingMarks = performance.getEntriesByType('mark').length;\n    const userTimingMeasures = performance.getEntriesByType('measure').length;\n    \n    if (userTimingMarks > 100) {\n      warnings.push(`检测到 ${userTimingMarks} 个性能标记，建议定期清理`);\n    }\n\n    if (userTimingMeasures > 50) {\n      warnings.push(`检测到 ${userTimingMeasures} 个性能测量，建议定期清理`);\n    }\n\n    // 检查是否有其他工具在监听性能事件\n    if (this.hasMultiplePerformanceListeners()) {\n      conflicts.push('检测到多个工具在监听性能事件，可能导致数据重复或冲突');\n    }\n  }\n\n  /**\n   * 检查开发者工具冲突\n   * Check DevTools conflicts\n   */\n  private checkDevToolsConflicts(conflicts: string[], warnings: string[]): void {\n    if (typeof window === 'undefined') return;\n\n    // 检查是否在开发模式\n    const isDevelopment = process.env.NODE_ENV === 'development';\n    \n    if (isDevelopment) {\n      let devToolsCount = 0;\n      \n      if ((window as any).__REACT_DEVTOOLS_GLOBAL_HOOK__) devToolsCount += 1;\n      if ((window as any).__REDUX_DEVTOOLS_EXTENSION__) devToolsCount += 1;\n      if ((window as any).__VUE_DEVTOOLS_GLOBAL_HOOK__) devToolsCount += 1;\n      \n      if (devToolsCount > 2) {\n        warnings.push(`开发环境中检测到 ${devToolsCount} 个开发者工具，可能影响性能测试准确性`);\n      }\n    }\n\n    // 检查生产环境中的开发工具\n    if (!isDevelopment) {\n      const prodDevTools: string[] = [];\n      \n      if ((window as any).__REACT_DEVTOOLS_GLOBAL_HOOK__) prodDevTools.push('React DevTools');\n      if ((window as any).__REDUX_DEVTOOLS_EXTENSION__) prodDevTools.push('Redux DevTools');\n      \n      if (prodDevTools.length > 0) {\n        conflicts.push(`生产环境中检测到开发工具: ${prodDevTools.join(', ')}`);\n      }\n    }\n  }\n\n  /**\n   * 检查第三方监控工具冲突\n   * Check third-party monitoring tool conflicts\n   */\n  private checkThirdPartyToolConflicts(\n    detectedTools: string[], \n    conflicts: string[], \n    warnings: string[]\n  ): void {\n    const monitoringTools = detectedTools.filter(tool => \n      ['Sentry', 'LogRocket', 'FullStory', 'New Relic', 'DataDog'].includes(tool)\n    );\n\n    if (monitoringTools.length > 2) {\n      warnings.push(`检测到多个监控工具: ${monitoringTools.join(', ')}，可能导致性能开销`);\n    }\n\n    const analyticsTools = detectedTools.filter(tool => \n      ['Google Analytics', 'Adobe Analytics', 'Mixpanel', 'Amplitude'].includes(tool)\n    );\n\n    if (analyticsTools.length > 2) {\n      warnings.push(`检测到多个分析工具: ${analyticsTools.join(', ')}，建议整合数据收集`);\n    }\n\n    // 检查工具间的已知冲突\n    this.checkKnownConflicts(detectedTools, conflicts);\n  }\n\n  /**\n   * 检查已知冲突\n   * Check known conflicts\n   */\n  private checkKnownConflicts(detectedTools: string[], conflicts: string[]): void {\n    // LogRocket 和 FullStory 可能冲突\n    if (detectedTools.includes('LogRocket') && detectedTools.includes('FullStory')) {\n      conflicts.push('LogRocket 和 FullStory 同时使用可能导致会话录制冲突');\n    }\n\n    // 多个性能监控工具可能冲突\n    const performanceTools = detectedTools.filter(tool => \n      ['New Relic', 'DataDog', 'AppDynamics', 'Dynatrace'].includes(tool)\n    );\n    \n    if (performanceTools.length > 1) {\n      conflicts.push(`多个APM工具可能冲突: ${performanceTools.join(', ')}`);\n    }\n  }\n\n  /**\n   * 生成建议\n   * Generate recommendations\n   */\n  private generateRecommendations(\n    detectedTools: string[], \n    conflicts: string[], \n    recommendations: string[]\n  ): void {\n    if (conflicts.length > 0) {\n      recommendations.push('建议审查和整合监控工具，避免功能重复');\n      recommendations.push('考虑使用统一的监控平台来减少工具冲突');\n    }\n\n    if (detectedTools.length > 5) {\n      recommendations.push('检测到较多监控工具，建议评估每个工具的必要性');\n      recommendations.push('考虑使用条件加载来减少生产环境的工具数量');\n    }\n\n    const isDevelopment = process.env.NODE_ENV === 'development';\n    if (!isDevelopment && detectedTools.some(tool => tool.includes('DevTools'))) {\n      recommendations.push('生产环境中应移除开发者工具以提高性能');\n    }\n\n    if (detectedTools.length === 0) {\n      recommendations.push('未检测到明显的工具冲突，当前配置良好');\n    }\n  }\n\n  /**\n   * 计算PerformanceObserver数量\n   * Count PerformanceObserver instances\n   */\n  private countPerformanceObservers(): number {\n    // 这是一个估算，实际实现可能需要更复杂的检测逻辑\n    if (typeof window === 'undefined' || !window.PerformanceObserver) return 0;\n    \n    // 检查常见的性能监控库是否在使用PerformanceObserver\n    let count = 0;\n    \n    // 检查Web Vitals\n    if ((window as any).webVitals) count += 1;\n    \n    // 检查其他可能的监控工具\n    if ((window as any).__PERFORMANCE_OBSERVERS__) {\n      count += (window as any).__PERFORMANCE_OBSERVERS__.length;\n    }\n    \n    return count;\n  }\n\n  /**\n   * 检查是否有多个性能监听器\n   * Check if there are multiple performance listeners\n   */\n  private hasMultiplePerformanceListeners(): boolean {\n    if (typeof window === 'undefined') return false;\n    \n    // 检查是否有多个工具在监听load事件\n    const loadListeners = this.getEventListenerCount('load');\n    const performanceListeners = this.getEventListenerCount('DOMContentLoaded');\n    \n    return loadListeners > 2 || performanceListeners > 2;\n  }\n\n  /**\n   * 获取事件监听器数量\n   * Get event listener count\n   */\n  private getEventListenerCount(eventType: string): number {\n    // 这是一个简化的实现，实际可能需要更复杂的检测\n    if (typeof window === 'undefined') return 0;\n    \n    try {\n      // 尝试获取事件监听器信息（仅在开发环境中可用）\n      const listeners = (window as any).getEventListeners?.(window)?.[eventType];\n      return listeners ? listeners.length : 0;\n    } catch {\n      return 0;\n    }\n  }\n\n  /**\n   * 获取工具详细信息\n   * Get tool details\n   */\n  getToolDetails(toolName: string): {\n    name: string;\n    detected: boolean;\n    version?: string;\n    impact: 'low' | 'medium' | 'high';\n    description: string;\n  } | null {\n    if (typeof window === 'undefined') return null;\n\n    const toolDetails = {\n      'React DevTools': {\n        detected: !!(window as any).__REACT_DEVTOOLS_GLOBAL_HOOK__,\n        impact: 'low' as const,\n        description: 'React 开发者工具，用于调试 React 组件',\n      },\n      'Redux DevTools': {\n        detected: !!(window as any).__REDUX_DEVTOOLS_EXTENSION__,\n        impact: 'low' as const,\n        description: 'Redux 开发者工具，用于调试状态管理',\n      },\n      'Sentry': {\n        detected: !!(window as any).Sentry,\n        impact: 'medium' as const,\n        description: '错误监控和性能监控平台',\n      },\n      'Google Analytics': {\n        detected: !!(window as any).gtag || !!(window as any).ga,\n        impact: 'medium' as const,\n        description: '网站分析和用户行为跟踪工具',\n      },\n    };\n\n    const tool = toolDetails[toolName as keyof typeof toolDetails];\n    if (!tool) return null;\n\n    return {\n      name: toolName,\n      ...tool,\n    };\n  }\n\n  /**\n   * 生成冲突解决方案\n   * Generate conflict resolution\n   */\n  generateResolutionPlan(conflicts: string[]): {\n    priority: 'high' | 'medium' | 'low';\n    actions: string[];\n    timeline: string;\n  }[] {\n    return conflicts.map(conflict => {\n      if (conflict.includes('生产环境') || conflict.includes('APM工具')) {\n        return {\n          priority: 'high' as const,\n          actions: [\n            '立即审查生产环境配置',\n            '移除不必要的开发工具',\n            '整合监控工具功能',\n          ],\n          timeline: '1-2 天内完成',\n        };\n      }\n\n      if (conflict.includes('多个工具') || conflict.includes('性能事件')) {\n        return {\n          priority: 'medium' as const,\n          actions: [\n            '评估工具的必要性',\n            '实施条件加载策略',\n            '优化工具配置',\n          ],\n          timeline: '1 周内完成',\n        };\n      }\n\n      return {\n        priority: 'low' as const,\n        actions: [\n          '监控工具使用情况',\n          '定期检查工具冲突',\n          '优化工具配置',\n        ],\n        timeline: '2 周内完成',\n      };\n    });\n  }\n}\n\n/**\n * 创建工具冲突检查器\n * Create tool conflict checker\n */\nexport function createConflictChecker(): PerformanceToolConflictChecker {\n  return new PerformanceToolConflictChecker();\n}\n\n/**\n * 快速检查工具冲突\n * Quick check for tool conflicts\n */\nexport function quickConflictCheck(): ToolConflictResult {\n  const checker = new PerformanceToolConflictChecker();\n  return checker.checkToolConflicts();\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/performance-monitoring-core-metrics.ts","messages":[{"ruleId":"no-undef","severity":2,"message":"'NodeJS' is not defined.","line":23,"column":28,"nodeType":"Identifier","messageId":"undef","endLine":23,"endColumn":34},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 5.","line":36,"column":70,"nodeType":"Literal","messageId":"noMagic","endLine":36,"endColumn":71},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 60.","line":36,"column":74,"nodeType":"Literal","messageId":"noMagic","endLine":36,"endColumn":76},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 5.","line":49,"column":68,"nodeType":"Literal","messageId":"noMagic","endLine":49,"endColumn":69},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 60.","line":49,"column":72,"nodeType":"Literal","messageId":"noMagic","endLine":49,"endColumn":74},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 36.","line":70,"column":59,"nodeType":"Literal","messageId":"noMagic","endLine":70,"endColumn":61},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2.","line":70,"column":70,"nodeType":"Literal","messageId":"noMagic","endLine":70,"endColumn":71},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 9.","line":70,"column":73,"nodeType":"Literal","messageId":"noMagic","endLine":70,"endColumn":74},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 1.1.","line":101,"column":44,"nodeType":"Literal","messageId":"noMagic","endLine":101,"endColumn":47},{"ruleId":"default-case","severity":2,"message":"Expected a default case.","line":137,"column":5,"nodeType":"SwitchStatement","messageId":"missingDefaultCase","endLine":150,"endColumn":6},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 60.","line":257,"column":53,"nodeType":"Literal","messageId":"noMagic","endLine":257,"endColumn":55},{"ruleId":"no-implicit-coercion","severity":2,"message":"Unexpected implicit coercion encountered. Use `Boolean(m.id &&\n      m.name &&\n      m.type &&\n      m.source &&\n      typeof m.timestamp === 'number' &&\n      m.timestamp > 0)` instead.","line":365,"column":12,"nodeType":"UnaryExpression","messageId":"implicitCoercion","endLine":372,"endColumn":6,"fix":{"range":[8370,8506],"text":"Boolean(m.id &&\n      m.name &&\n      m.type &&\n      m.source &&\n      typeof m.timestamp === 'number' &&\n      m.timestamp > 0)"}}],"suppressedMessages":[],"errorCount":12,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"/**\n * 性能监控核心指标管理\n * Performance Monitoring Core Metrics Management\n * \n * 负责性能指标的记录、存储、清理和实时分析功能\n */\n\nimport type {\n  PerformanceMetrics,\n  PerformanceConfig,\n  PerformanceMetricType,\n  PerformanceMetricSource,\n} from './performance-monitoring-types';\nimport { MB } from '@/constants/units';\nimport { logger } from '@/lib/logger';\n\n/**\n * 指标管理器\n * Metrics manager\n */\nexport class PerformanceMetricsManager {\n  private metrics: PerformanceMetrics[] = [];\n  private cleanupInterval: NodeJS.Timeout | null = null;\n  private config: PerformanceConfig;\n\n  constructor(config: PerformanceConfig) {\n    this.config = config;\n    this.setupPeriodicCleanup();\n  }\n\n  /**\n   * 设置定期清理\n   * Setup periodic cleanup\n   */\n  private setupPeriodicCleanup(): void {\n    const cleanupInterval = this.config.global?.dataRetentionTime || 5 * 60 * 1000; // 5分钟\n    \n    this.cleanupInterval = setInterval(() => {\n      this.cleanupOldMetrics();\n    }, cleanupInterval);\n  }\n\n  /**\n   * 清理旧指标\n   * Cleanup old metrics\n   */\n  private cleanupOldMetrics(): void {\n    const now = Date.now();\n    const retentionTime = this.config.global?.dataRetentionTime || 5 * 60 * 1000;\n    const maxMetrics = this.config.global?.maxMetrics || 1000;\n\n    // 按时间清理\n    this.metrics = this.metrics.filter(metric => \n      now - metric.timestamp < retentionTime\n    );\n\n    // 按数量清理（保留最新的）\n    if (this.metrics.length > maxMetrics) {\n      this.metrics = this.metrics\n        .sort((a, b) => b.timestamp - a.timestamp)\n        .slice(0, maxMetrics);\n    }\n  }\n\n  /**\n   * 生成指标ID\n   * Generate metric ID\n   */\n  private generateMetricId(): string {\n    return `metric_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n  }\n\n  /**\n   * 记录性能指标\n   * Record performance metric\n   */\n  recordMetric(metric: Omit<PerformanceMetrics, 'timestamp'>): void {\n    if (!this.config.global?.enabled) {\n      return;\n    }\n\n    // 检查特定类型是否启用\n    const moduleConfig = this.getModuleConfig(metric.type);\n    if (!moduleConfig?.enabled) {\n      return;\n    }\n\n    const fullMetric: PerformanceMetrics = {\n      ...metric,\n      id: metric.id || this.generateMetricId(),\n      timestamp: Date.now(),\n    };\n\n    this.metrics.push(fullMetric);\n    \n    // 实时分析\n    this.analyzeRealtimeMetric(fullMetric);\n\n    // 立即清理如果超出限制\n    const maxMetrics = this.config.global?.maxMetrics || 1000;\n    if (this.metrics.length > maxMetrics * 1.1) { // 10%缓冲\n      this.cleanupOldMetrics();\n    }\n  }\n\n  /**\n   * 获取模块配置\n   * Get module configuration\n   */\n  private getModuleConfig(type: PerformanceMetricType) {\n    switch (type) {\n      case 'component':\n        return this.config.component;\n      case 'network':\n        return this.config.network;\n      case 'bundle':\n        return this.config.bundle;\n      default:\n        return null;\n    }\n  }\n\n  /**\n   * 实时分析指标\n   * Analyze realtime metric\n   */\n  private analyzeRealtimeMetric(metric: PerformanceMetrics): void {\n    // 检查是否有性能问题需要立即关注\n    const moduleConfig = this.getModuleConfig(metric.type);\n    if (!moduleConfig?.thresholds) {\n      return;\n    }\n\n    let isSlowPerformance = false;\n    let threshold = 0;\n\n    switch (metric.type) {\n      case 'component':\n        threshold = moduleConfig.thresholds.renderTime || 100;\n        isSlowPerformance = (metric.value || 0) > threshold;\n        break;\n      case 'network':\n        threshold = moduleConfig.thresholds.responseTime || 1000;\n        isSlowPerformance = (metric.value || 0) > threshold;\n        break;\n      case 'bundle':\n        threshold = moduleConfig.thresholds.size || MB; // 1MB\n        isSlowPerformance = (metric.value || 0) > threshold;\n        break;\n    }\n\n    if (isSlowPerformance) {\n      logger.warn(`Performance warning: ${metric.type} metric exceeded threshold`, {\n        metric: metric.name,\n        value: metric.value,\n        threshold,\n        source: metric.source,\n      });\n    }\n  }\n\n  /**\n   * 获取所有指标\n   * Get all metrics\n   */\n  getAllMetrics(): PerformanceMetrics[] {\n    return [...this.metrics];\n  }\n\n  /**\n   * 获取指定时间窗口内的指标\n   * Get metrics within time window\n   */\n  getMetricsInTimeWindow(timeWindow: number): PerformanceMetrics[] {\n    const now = Date.now();\n    return this.metrics.filter(metric => \n      now - metric.timestamp <= timeWindow\n    );\n  }\n\n  /**\n   * 按类型获取指标\n   * Get metrics by type\n   */\n  getMetricsByType(type: PerformanceMetricType): PerformanceMetrics[] {\n    return this.metrics.filter(metric => metric.type === type);\n  }\n\n  /**\n   * 按来源获取指标\n   * Get metrics by source\n   */\n  getMetricsBySource(source: PerformanceMetricSource): PerformanceMetrics[] {\n    return this.metrics.filter(metric => metric.source === source);\n  }\n\n  /**\n   * 获取指标统计\n   * Get metrics statistics\n   */\n  getMetricsStats(): {\n    total: number;\n    byType: Record<PerformanceMetricType, number>;\n    bySource: Record<PerformanceMetricSource, number>;\n    timeRange: {\n      oldest: number;\n      newest: number;\n      span: number;\n    };\n    averageValue: number;\n  } {\n    const stats = {\n      total: this.metrics.length,\n      byType: {} as Record<PerformanceMetricType, number>,\n      bySource: {} as Record<PerformanceMetricSource, number>,\n      timeRange: {\n        oldest: 0,\n        newest: 0,\n        span: 0,\n      },\n      averageValue: 0,\n    };\n\n    if (this.metrics.length === 0) {\n      return stats;\n    }\n\n    // 统计类型分布\n    this.metrics.forEach(metric => {\n      stats.byType[metric.type] = (stats.byType[metric.type] || 0) + 1;\n      stats.bySource[metric.source] = (stats.bySource[metric.source] || 0) + 1;\n    });\n\n    // 计算时间范围\n    const timestamps = this.metrics.map(m => m.timestamp);\n    stats.timeRange.oldest = Math.min(...timestamps);\n    stats.timeRange.newest = Math.max(...timestamps);\n    stats.timeRange.span = stats.timeRange.newest - stats.timeRange.oldest;\n\n    // 计算平均值\n    const totalValue = this.metrics.reduce((sum, metric) => sum + (metric.value || 0), 0);\n    stats.averageValue = totalValue / this.metrics.length;\n\n    return stats;\n  }\n\n  /**\n   * 计算每分钟平均指标数\n   * Calculate average metrics per minute\n   */\n  calculateAverageMetricsPerMinute(): number {\n    if (this.metrics.length === 0) {\n      return 0;\n    }\n\n    const stats = this.getMetricsStats();\n    const timeSpanMinutes = stats.timeRange.span / (60 * 1000);\n    \n    return timeSpanMinutes > 0 ? this.metrics.length / timeSpanMinutes : 0;\n  }\n\n  /**\n   * 获取最近的指标\n   * Get recent metrics\n   */\n  getRecentMetrics(count = 10): PerformanceMetrics[] {\n    return this.metrics\n      .sort((a, b) => b.timestamp - a.timestamp)\n      .slice(0, count);\n  }\n\n  /**\n   * 查找特定指标\n   * Find specific metric\n   */\n  findMetric(id: string): PerformanceMetrics | undefined {\n    return this.metrics.find(metric => metric.id === id);\n  }\n\n  /**\n   * 删除指标\n   * Remove metric\n   */\n  removeMetric(id: string): boolean {\n    const index = this.metrics.findIndex(metric => metric.id === id);\n    if (index > -1) {\n      this.metrics.splice(index, 1);\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * 清空所有指标\n   * Clear all metrics\n   */\n  clearAllMetrics(): void {\n    this.metrics = [];\n  }\n\n  /**\n   * 更新配置\n   * Update configuration\n   */\n  updateConfig(newConfig: PerformanceConfig): void {\n    this.config = newConfig;\n    \n    // 重新设置清理间隔\n    if (this.cleanupInterval) {\n      clearInterval(this.cleanupInterval);\n    }\n    this.setupPeriodicCleanup();\n  }\n\n  /**\n   * 导出指标数据\n   * Export metrics data\n   */\n  exportMetrics(): {\n    metrics: PerformanceMetrics[];\n    exportTime: number;\n    stats: ReturnType<typeof this.getMetricsStats>;\n  } {\n    return {\n      metrics: [...this.metrics],\n      exportTime: Date.now(),\n      stats: this.getMetricsStats(),\n    };\n  }\n\n  /**\n   * 导入指标数据\n   * Import metrics data\n   */\n  importMetrics(data: PerformanceMetrics[], replace = false): number {\n    if (replace) {\n      this.metrics = [];\n    }\n\n    let importedCount = 0;\n    data.forEach(metric => {\n      // 验证指标数据\n      if (this.isValidMetric(metric)) {\n        this.metrics.push(metric);\n        importedCount += 1;\n      }\n    });\n\n    // 清理重复和过期数据\n    this.cleanupOldMetrics();\n\n    return importedCount;\n  }\n\n  /**\n   * 验证指标数据\n   * Validate metric data\n   */\n  private isValidMetric(metric: unknown): metric is PerformanceMetrics {\n    if (!metric || typeof metric !== 'object') {\n      return false;\n    }\n\n    const m = metric as PerformanceMetrics;\n    return !!(\n      m.id &&\n      m.name &&\n      m.type &&\n      m.source &&\n      typeof m.timestamp === 'number' &&\n      m.timestamp > 0\n    );\n  }\n\n  /**\n   * 销毁管理器\n   * Destroy manager\n   */\n  destroy(): void {\n    if (this.cleanupInterval) {\n      clearInterval(this.cleanupInterval);\n      this.cleanupInterval = null;\n    }\n    this.metrics = [];\n  }\n}\n\n/**\n * 创建指标管理器\n * Create metrics manager\n */\nexport function createMetricsManager(config: PerformanceConfig): PerformanceMetricsManager {\n  return new PerformanceMetricsManager(config);\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/performance-monitoring-core-reports.ts","messages":[{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 60.","line":60,"column":62,"nodeType":"Literal","messageId":"noMagic","endLine":60,"endColumn":64},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 60.","line":98,"column":58,"nodeType":"Literal","messageId":"noMagic","endLine":98,"endColumn":60},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 60.","line":103,"column":68,"nodeType":"Literal","messageId":"noMagic","endLine":103,"endColumn":70},{"ruleId":"max-statements","severity":2,"message":"Method 'generateRecommendations' has too many statements (30). Maximum allowed is 20.","line":118,"column":34,"nodeType":"FunctionExpression","messageId":"exceed","endLine":182,"endColumn":4},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 50.","line":133,"column":27,"nodeType":"Literal","messageId":"noMagic","endLine":133,"endColumn":29},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 1024.","line":159,"column":67,"nodeType":"Literal","messageId":"noMagic","endLine":159,"endColumn":71},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 1024.","line":159,"column":74,"nodeType":"Literal","messageId":"noMagic","endLine":159,"endColumn":78},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 5.","line":167,"column":29,"nodeType":"Literal","messageId":"noMagic","endLine":167,"endColumn":30},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 1024.","line":167,"column":33,"nodeType":"Literal","messageId":"noMagic","endLine":167,"endColumn":37},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 1024.","line":167,"column":40,"nodeType":"Literal","messageId":"noMagic","endLine":167,"endColumn":44},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0.5.","line":221,"column":38,"nodeType":"Literal","messageId":"noMagic","endLine":221,"endColumn":41},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 80.","line":222,"column":44,"nodeType":"Literal","messageId":"noMagic","endLine":222,"endColumn":46},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 1.5.","line":223,"column":38,"nodeType":"Literal","messageId":"noMagic","endLine":223,"endColumn":41},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 60.","line":223,"column":50,"nodeType":"Literal","messageId":"noMagic","endLine":223,"endColumn":52},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2.","line":224,"column":38,"nodeType":"Literal","messageId":"noMagic","endLine":224,"endColumn":39},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 40.","line":224,"column":48,"nodeType":"Literal","messageId":"noMagic","endLine":224,"endColumn":50},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 20.","line":225,"column":12,"nodeType":"Literal","messageId":"noMagic","endLine":225,"endColumn":14},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0.3.","line":240,"column":40,"nodeType":"Literal","messageId":"noMagic","endLine":240,"endColumn":43},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0.6.","line":241,"column":40,"nodeType":"Literal","messageId":"noMagic","endLine":241,"endColumn":43},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 80.","line":241,"column":52,"nodeType":"Literal","messageId":"noMagic","endLine":241,"endColumn":54},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 60.","line":242,"column":46,"nodeType":"Literal","messageId":"noMagic","endLine":242,"endColumn":48},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 1.5.","line":243,"column":40,"nodeType":"Literal","messageId":"noMagic","endLine":243,"endColumn":43},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 40.","line":243,"column":52,"nodeType":"Literal","messageId":"noMagic","endLine":243,"endColumn":54},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 20.","line":244,"column":12,"nodeType":"Literal","messageId":"noMagic","endLine":244,"endColumn":14},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 1024.","line":255,"column":63,"nodeType":"Literal","messageId":"noMagic","endLine":255,"endColumn":67},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 1024.","line":255,"column":70,"nodeType":"Literal","messageId":"noMagic","endLine":255,"endColumn":74},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0.5.","line":259,"column":34,"nodeType":"Literal","messageId":"noMagic","endLine":259,"endColumn":37},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 80.","line":260,"column":40,"nodeType":"Literal","messageId":"noMagic","endLine":260,"endColumn":42},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2.","line":261,"column":34,"nodeType":"Literal","messageId":"noMagic","endLine":261,"endColumn":35},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 60.","line":261,"column":44,"nodeType":"Literal","messageId":"noMagic","endLine":261,"endColumn":46},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 3.","line":262,"column":34,"nodeType":"Literal","messageId":"noMagic","endLine":262,"endColumn":35},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 40.","line":262,"column":44,"nodeType":"Literal","messageId":"noMagic","endLine":262,"endColumn":46},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 20.","line":263,"column":12,"nodeType":"Literal","messageId":"noMagic","endLine":263,"endColumn":14},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 5.","line":304,"column":17,"nodeType":"Literal","messageId":"noMagic","endLine":304,"endColumn":18},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 5.","line":313,"column":17,"nodeType":"Literal","messageId":"noMagic","endLine":313,"endColumn":18},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 1024.","line":317,"column":69,"nodeType":"Literal","messageId":"noMagic","endLine":317,"endColumn":73},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 1024.","line":317,"column":76,"nodeType":"Literal","messageId":"noMagic","endLine":317,"endColumn":80},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 5.","line":322,"column":17,"nodeType":"Literal","messageId":"noMagic","endLine":322,"endColumn":18},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":360,"column":7,"nodeType":"MemberExpression","endLine":360,"endColumn":24},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":360,"column":28,"nodeType":"MemberExpression","endLine":360,"endColumn":45},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2.","line":371,"column":26,"nodeType":"Literal","messageId":"noMagic","endLine":371,"endColumn":27},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2.","line":375,"column":56,"nodeType":"Literal","messageId":"noMagic","endLine":375,"endColumn":57},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: -5.","line":385,"column":25,"nodeType":"UnaryExpression","messageId":"noMagic","endLine":385,"endColumn":27},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 5.","line":386,"column":25,"nodeType":"Literal","messageId":"noMagic","endLine":386,"endColumn":26}],"suppressedMessages":[],"errorCount":44,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 性能监控核心报告生成\n * Performance Monitoring Core Report Generation\n * \n * 负责性能报告的生成、评分计算和建议提供功能\n */\n\nimport type {\n  PerformanceMetrics,\n  PerformanceConfig,\n  PerformanceMetricType,\n  PerformanceMetricSource,\n} from './performance-monitoring-types';\n\n/**\n * 性能报告接口\n * Performance report interface\n */\nexport interface PerformanceReport {\n  /** 报告摘要 */\n  summary: {\n    totalMetrics: number;\n    recentMetrics: number;\n    sources: PerformanceMetricSource[];\n    types: PerformanceMetricType[];\n    timeRange: {\n      start: number;\n      end: number;\n    };\n    averageMetricsPerMinute: number;\n  };\n  /** 详细指标 */\n  details: PerformanceMetrics[];\n  /** 性能建议 */\n  recommendations: string[];\n  /** 性能评分 */\n  score?: {\n    overall: number;\n    component: number;\n    network: number;\n    bundle: number;\n  };\n}\n\n/**\n * 报告生成器\n * Report generator\n */\nexport class PerformanceReportGenerator {\n  private config: PerformanceConfig;\n\n  constructor(config: PerformanceConfig) {\n    this.config = config;\n  }\n\n  /**\n   * 生成性能报告\n   * Generate performance report\n   */\n  generateReport(metrics: PerformanceMetrics[], timeWindow = 60 * 1000): PerformanceReport {\n    const now = Date.now();\n    const windowStart = now - timeWindow;\n\n    // 过滤时间窗口内的指标\n    const windowMetrics = metrics.filter(metric => \n      metric.timestamp >= windowStart\n    );\n\n    // 生成报告摘要\n    const summary = this.generateSummary(windowMetrics, windowStart, now);\n    \n    // 生成建议\n    const recommendations = this.generateRecommendations(windowMetrics);\n    \n    // 计算性能评分\n    const score = this.calculatePerformanceScore(windowMetrics);\n\n    return {\n      summary,\n      details: windowMetrics,\n      recommendations,\n      score,\n    };\n  }\n\n  /**\n   * 生成报告摘要\n   * Generate report summary\n   */\n  private generateSummary(\n    metrics: PerformanceMetrics[], \n    windowStart: number, \n    windowEnd: number\n  ): PerformanceReport['summary'] {\n    const sources = [...new Set(metrics.map(m => m.source))];\n    const types = [...new Set(metrics.map(m => m.type))];\n    \n    const timeSpanMinutes = (windowEnd - windowStart) / (60 * 1000);\n    const averageMetricsPerMinute = timeSpanMinutes > 0 ? metrics.length / timeSpanMinutes : 0;\n\n    return {\n      totalMetrics: metrics.length,\n      recentMetrics: metrics.filter(m => windowEnd - m.timestamp < 60 * 1000).length, // 最近1分钟\n      sources,\n      types,\n      timeRange: {\n        start: windowStart,\n        end: windowEnd,\n      },\n      averageMetricsPerMinute,\n    };\n  }\n\n  /**\n   * 生成性能建议\n   * Generate performance recommendations\n   */\n  private generateRecommendations(metrics: PerformanceMetrics[]): string[] {\n    const recommendations: string[] = [];\n\n    // 组件性能建议\n    const componentMetrics = metrics.filter(m => m.type === 'component');\n    if (componentMetrics.length > 0) {\n      const slowComponents = componentMetrics.filter(m => \n        (m.value || 0) > (this.config.component?.thresholds?.renderTime || 100)\n      );\n      \n      if (slowComponents.length > 0) {\n        recommendations.push(`发现 ${slowComponents.length} 个组件渲染时间超过阈值，建议优化组件性能`);\n      }\n\n      const avgRenderTime = componentMetrics.reduce((sum, m) => sum + (m.value || 0), 0) / componentMetrics.length;\n      if (avgRenderTime > 50) {\n        recommendations.push('组件平均渲染时间较高，考虑使用 React.memo 或 useMemo 优化');\n      }\n    }\n\n    // 网络性能建议\n    const networkMetrics = metrics.filter(m => m.type === 'network');\n    if (networkMetrics.length > 0) {\n      const slowRequests = networkMetrics.filter(m => \n        (m.value || 0) > (this.config.network?.thresholds?.responseTime || 1000)\n      );\n      \n      if (slowRequests.length > 0) {\n        recommendations.push(`发现 ${slowRequests.length} 个网络请求响应时间超过阈值，建议优化API性能`);\n      }\n\n      const avgResponseTime = networkMetrics.reduce((sum, m) => sum + (m.value || 0), 0) / networkMetrics.length;\n      if (avgResponseTime > 500) {\n        recommendations.push('网络请求平均响应时间较高，考虑使用缓存或CDN优化');\n      }\n    }\n\n    // 打包大小建议\n    const bundleMetrics = metrics.filter(m => m.type === 'bundle');\n    if (bundleMetrics.length > 0) {\n      const largeBundles = bundleMetrics.filter(m => \n        (m.value || 0) > (this.config.bundle?.thresholds?.size || 1024 * 1024)\n      );\n      \n      if (largeBundles.length > 0) {\n        recommendations.push(`发现 ${largeBundles.length} 个打包文件大小超过阈值，建议进行代码分割`);\n      }\n\n      const totalBundleSize = bundleMetrics.reduce((sum, m) => sum + (m.value || 0), 0);\n      if (totalBundleSize > 5 * 1024 * 1024) { // 5MB\n        recommendations.push('总打包大小较大，建议使用动态导入和懒加载优化');\n      }\n    }\n\n    // 通用建议\n    if (metrics.length > 100) {\n      recommendations.push('性能指标数量较多，建议调整监控频率或增加数据清理');\n    }\n\n    if (recommendations.length === 0) {\n      recommendations.push('当前性能表现良好，继续保持！');\n    }\n\n    return recommendations;\n  }\n\n  /**\n   * 计算性能评分\n   * Calculate performance score\n   */\n  private calculatePerformanceScore(metrics: PerformanceMetrics[]): PerformanceReport['score'] {\n    const componentScore = this.calculateComponentScore(metrics);\n    const networkScore = this.calculateNetworkScore(metrics);\n    const bundleScore = this.calculateBundleScore(metrics);\n\n    // 计算总体评分（加权平均）\n    const weights = { component: 0.4, network: 0.4, bundle: 0.2 };\n    const overall = (\n      componentScore * weights.component +\n      networkScore * weights.network +\n      bundleScore * weights.bundle\n    );\n\n    return {\n      overall: Math.round(overall),\n      component: componentScore,\n      network: networkScore,\n      bundle: bundleScore,\n    };\n  }\n\n  /**\n   * 计算组件性能评分\n   * Calculate component performance score\n   */\n  private calculateComponentScore(metrics: PerformanceMetrics[]): number {\n    const componentMetrics = metrics.filter(m => m.type === 'component');\n    if (componentMetrics.length === 0) return 100;\n\n    const threshold = this.config.component?.thresholds?.renderTime || 100;\n    const avgRenderTime = componentMetrics.reduce((sum, m) => sum + (m.value || 0), 0) / componentMetrics.length;\n\n    // 评分算法：基于平均渲染时间与阈值的比较\n    if (avgRenderTime <= threshold * 0.5) return 100;\n    if (avgRenderTime <= threshold) return 80;\n    if (avgRenderTime <= threshold * 1.5) return 60;\n    if (avgRenderTime <= threshold * 2) return 40;\n    return 20;\n  }\n\n  /**\n   * 计算网络性能评分\n   * Calculate network performance score\n   */\n  private calculateNetworkScore(metrics: PerformanceMetrics[]): number {\n    const networkMetrics = metrics.filter(m => m.type === 'network');\n    if (networkMetrics.length === 0) return 100;\n\n    const threshold = this.config.network?.thresholds?.responseTime || 1000;\n    const avgResponseTime = networkMetrics.reduce((sum, m) => sum + (m.value || 0), 0) / networkMetrics.length;\n\n    // 评分算法：基于平均响应时间与阈值的比较\n    if (avgResponseTime <= threshold * 0.3) return 100;\n    if (avgResponseTime <= threshold * 0.6) return 80;\n    if (avgResponseTime <= threshold) return 60;\n    if (avgResponseTime <= threshold * 1.5) return 40;\n    return 20;\n  }\n\n  /**\n   * 计算打包性能评分\n   * Calculate bundle performance score\n   */\n  private calculateBundleScore(metrics: PerformanceMetrics[]): number {\n    const bundleMetrics = metrics.filter(m => m.type === 'bundle');\n    if (bundleMetrics.length === 0) return 100;\n\n    const threshold = this.config.bundle?.thresholds?.size || 1024 * 1024; // 1MB\n    const totalSize = bundleMetrics.reduce((sum, m) => sum + (m.value || 0), 0);\n\n    // 评分算法：基于总打包大小与阈值的比较\n    if (totalSize <= threshold * 0.5) return 100;\n    if (totalSize <= threshold) return 80;\n    if (totalSize <= threshold * 2) return 60;\n    if (totalSize <= threshold * 3) return 40;\n    return 20;\n  }\n\n  /**\n   * 生成详细的性能分析报告\n   * Generate detailed performance analysis report\n   */\n  generateDetailedReport(metrics: PerformanceMetrics[]): {\n    overview: PerformanceReport;\n    analysis: {\n      componentAnalysis: {\n        slowestComponents: Array<{ name: string; value: number; threshold: number }>;\n        renderTimeDistribution: Record<string, number>;\n        averageRenderTime: number;\n      };\n      networkAnalysis: {\n        slowestRequests: Array<{ name: string; value: number; threshold: number }>;\n        responseTimeDistribution: Record<string, number>;\n        averageResponseTime: number;\n      };\n      bundleAnalysis: {\n        largestBundles: Array<{ name: string; value: number; threshold: number }>;\n        sizeDistribution: Record<string, number>;\n        totalSize: number;\n      };\n    };\n    trends: {\n      componentTrend: 'improving' | 'stable' | 'degrading';\n      networkTrend: 'improving' | 'stable' | 'degrading';\n      bundleTrend: 'improving' | 'stable' | 'degrading';\n    };\n  } {\n    const overview = this.generateReport(metrics);\n\n    // 组件分析\n    const componentMetrics = metrics.filter(m => m.type === 'component');\n    const componentThreshold = this.config.component?.thresholds?.renderTime || 100;\n    const slowestComponents = componentMetrics\n      .filter(m => (m.value || 0) > componentThreshold)\n      .map(m => ({ name: m.name, value: m.value || 0, threshold: componentThreshold }))\n      .sort((a, b) => b.value - a.value)\n      .slice(0, 5);\n\n    // 网络分析\n    const networkMetrics = metrics.filter(m => m.type === 'network');\n    const networkThreshold = this.config.network?.thresholds?.responseTime || 1000;\n    const slowestRequests = networkMetrics\n      .filter(m => (m.value || 0) > networkThreshold)\n      .map(m => ({ name: m.name, value: m.value || 0, threshold: networkThreshold }))\n      .sort((a, b) => b.value - a.value)\n      .slice(0, 5);\n\n    // 打包分析\n    const bundleMetrics = metrics.filter(m => m.type === 'bundle');\n    const bundleThreshold = this.config.bundle?.thresholds?.size || 1024 * 1024;\n    const largestBundles = bundleMetrics\n      .filter(m => (m.value || 0) > bundleThreshold)\n      .map(m => ({ name: m.name, value: m.value || 0, threshold: bundleThreshold }))\n      .sort((a, b) => b.value - a.value)\n      .slice(0, 5);\n\n    return {\n      overview,\n      analysis: {\n        componentAnalysis: {\n          slowestComponents,\n          renderTimeDistribution: this.calculateDistribution(componentMetrics),\n          averageRenderTime: componentMetrics.reduce((sum, m) => sum + (m.value || 0), 0) / componentMetrics.length || 0,\n        },\n        networkAnalysis: {\n          slowestRequests,\n          responseTimeDistribution: this.calculateDistribution(networkMetrics),\n          averageResponseTime: networkMetrics.reduce((sum, m) => sum + (m.value || 0), 0) / networkMetrics.length || 0,\n        },\n        bundleAnalysis: {\n          largestBundles,\n          sizeDistribution: this.calculateDistribution(bundleMetrics),\n          totalSize: bundleMetrics.reduce((sum, m) => sum + (m.value || 0), 0),\n        },\n      },\n      trends: {\n        componentTrend: this.calculateTrend(componentMetrics),\n        networkTrend: this.calculateTrend(networkMetrics),\n        bundleTrend: this.calculateTrend(bundleMetrics),\n      },\n    };\n  }\n\n  /**\n   * 计算分布\n   * Calculate distribution\n   */\n  private calculateDistribution(metrics: PerformanceMetrics[]): Record<string, number> {\n    const distribution: Record<string, number> = {};\n    \n    metrics.forEach(metric => {\n      const key = metric.name;\n      distribution[key] = (distribution[key] || 0) + 1;\n    });\n\n    return distribution;\n  }\n\n  /**\n   * 计算趋势\n   * Calculate trend\n   */\n  private calculateTrend(metrics: PerformanceMetrics[]): 'improving' | 'stable' | 'degrading' {\n    if (metrics.length < 2) return 'stable';\n\n    // 按时间排序\n    const sortedMetrics = metrics.sort((a, b) => a.timestamp - b.timestamp);\n    const midPoint = Math.floor(sortedMetrics.length / 2);\n    \n    const firstHalf = sortedMetrics.slice(0, midPoint);\n    const secondHalf = sortedMetrics.slice(midPoint);\n\n    const firstAvg = firstHalf.reduce((sum, m) => sum + (m.value || 0), 0) / firstHalf.length;\n    const secondAvg = secondHalf.reduce((sum, m) => sum + (m.value || 0), 0) / secondHalf.length;\n\n    const changePercent = ((secondAvg - firstAvg) / firstAvg) * 100;\n\n    if (changePercent < -5) return 'improving'; // 性能提升\n    if (changePercent > 5) return 'degrading';  // 性能下降\n    return 'stable'; // 性能稳定\n  }\n\n  /**\n   * 更新配置\n   * Update configuration\n   */\n  updateConfig(newConfig: PerformanceConfig): void {\n    this.config = newConfig;\n  }\n}\n\n/**\n * 创建报告生成器\n * Create report generator\n */\nexport function createReportGenerator(config: PerformanceConfig): PerformanceReportGenerator {\n  return new PerformanceReportGenerator(config);\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/performance-monitoring-core.ts","messages":[{"ruleId":"no-undef","severity":2,"message":"'PerformanceMetricType' is not defined.","line":83,"column":26,"nodeType":"Identifier","messageId":"undef","endLine":83,"endColumn":47},{"ruleId":"no-undef","severity":2,"message":"'PerformanceMetricSource' is not defined.","line":91,"column":30,"nodeType":"Identifier","messageId":"undef","endLine":91,"endColumn":53},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 60.","line":107,"column":31,"nodeType":"Literal","messageId":"noMagic","endLine":107,"endColumn":33}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 性能监控核心协调器 - 主入口\n * Performance Monitoring Core Coordinator - Main Entry Point\n *\n * 统一的性能监控核心入口，整合所有性能监控功能模块\n */\n\n// 重新导出所有模块的功能\nexport * from './performance-monitoring-core-config';\nexport * from './performance-monitoring-core-metrics';\nexport * from './performance-monitoring-core-reports';\nexport * from './performance-monitoring-core-conflicts';\n\n// 导入主要功能用于向后兼容\nimport type {\n  PerformanceMetrics,\n  PerformanceConfig,\n} from './performance-monitoring-types';\n\nimport { PerformanceConfigManager } from './performance-monitoring-core-config';\nimport { PerformanceMetricsManager } from './performance-monitoring-core-metrics';\nimport { PerformanceReportGenerator, type PerformanceReport } from './performance-monitoring-core-reports';\nimport { PerformanceToolConflictChecker, type ToolConflictResult } from './performance-monitoring-core-conflicts';\n\n/**\n * 性能监控核心协调器类 - 向后兼容\n * Performance monitoring core coordinator class - Backward compatible\n */\nexport class PerformanceMonitoringCore {\n  private configManager: PerformanceConfigManager;\n  private metricsManager: PerformanceMetricsManager;\n  private reportGenerator: PerformanceReportGenerator;\n  private conflictChecker: PerformanceToolConflictChecker;\n\n  constructor(customConfig?: Partial<PerformanceConfig>) {\n    this.configManager = new PerformanceConfigManager(customConfig);\n    this.metricsManager = new PerformanceMetricsManager(this.configManager.getConfig());\n    this.reportGenerator = new PerformanceReportGenerator(this.configManager.getConfig());\n    this.conflictChecker = new PerformanceToolConflictChecker();\n  }\n\n  /**\n   * 记录性能指标\n   * Record performance metric\n   */\n  recordMetric(metric: Omit<PerformanceMetrics, 'timestamp'>): void {\n    this.metricsManager.recordMetric(metric);\n  }\n\n  /**\n   * 获取配置\n   * Get configuration\n   */\n  getConfig(): PerformanceConfig {\n    return this.configManager.getConfig();\n  }\n\n  /**\n   * 更新配置\n   * Update configuration\n   */\n  updateConfig(newConfig: Partial<PerformanceConfig>): void {\n    this.configManager.updateConfig(newConfig);\n\n    // 更新所有管理器的配置\n    const updatedConfig = this.configManager.getConfig();\n    this.metricsManager.updateConfig(updatedConfig);\n    this.reportGenerator.updateConfig(updatedConfig);\n  }\n\n  /**\n   * 获取指标\n   * Get metrics\n   */\n  getMetrics(): PerformanceMetrics[] {\n    return this.metricsManager.getAllMetrics();\n  }\n\n  /**\n   * 按类型获取指标\n   * Get metrics by type\n   */\n  getMetricsByType(type: PerformanceMetricType): PerformanceMetrics[] {\n    return this.metricsManager.getMetricsByType(type);\n  }\n\n  /**\n   * 按来源获取指标\n   * Get metrics by source\n   */\n  getMetricsBySource(source: PerformanceMetricSource): PerformanceMetrics[] {\n    return this.metricsManager.getMetricsBySource(source);\n  }\n\n  /**\n   * 获取指定时间窗口内的指标\n   * Get metrics within time window\n   */\n  getMetricsInTimeWindow(timeWindow: number): PerformanceMetrics[] {\n    return this.metricsManager.getMetricsInTimeWindow(timeWindow);\n  }\n\n  /**\n   * 生成性能报告\n   * Generate performance report\n   */\n  generateReport(timeWindow = 60 * 1000): PerformanceReport {\n    const metrics = this.metricsManager.getAllMetrics();\n    return this.reportGenerator.generateReport(metrics, timeWindow);\n  }\n\n  /**\n   * 生成详细性能报告\n   * Generate detailed performance report\n   */\n  generateDetailedReport(): ReturnType<PerformanceReportGenerator['generateDetailedReport']> {\n    const metrics = this.metricsManager.getAllMetrics();\n    return this.reportGenerator.generateDetailedReport(metrics);\n  }\n\n  /**\n   * 检查工具冲突\n   * Check tool conflicts\n   */\n  checkToolConflicts(): ToolConflictResult {\n    return this.conflictChecker.checkToolConflicts();\n  }\n\n  /**\n   * 获取工具详细信息\n   * Get tool details\n   */\n  getToolDetails(toolName: string): ReturnType<PerformanceToolConflictChecker['getToolDetails']> {\n    return this.conflictChecker.getToolDetails(toolName);\n  }\n\n  /**\n   * 获取指标统计\n   * Get metrics statistics\n   */\n  getMetricsStats(): ReturnType<PerformanceMetricsManager['getMetricsStats']> {\n    return this.metricsManager.getMetricsStats();\n  }\n\n  /**\n   * 清空所有指标\n   * Clear all metrics\n   */\n  clearAllMetrics(): void {\n    this.metricsManager.clearAllMetrics();\n  }\n\n  /**\n   * 导出指标数据\n   * Export metrics data\n   */\n  exportMetrics(): ReturnType<PerformanceMetricsManager['exportMetrics']> {\n    return this.metricsManager.exportMetrics();\n  }\n\n  /**\n   * 导入指标数据\n   * Import metrics data\n   */\n  importMetrics(data: PerformanceMetrics[], replace = false): number {\n    return this.metricsManager.importMetrics(data, replace);\n  }\n\n  /**\n   * 销毁协调器\n   * Destroy coordinator\n   */\n  destroy(): void {\n    this.metricsManager.destroy();\n  }\n}\n\n// ==================== 向后兼容的类型别名 ====================\n\n/**\n * 向后兼容的类型别名\n * Backward compatible type aliases\n */\nexport type {\n  PerformanceMonitoringCore as PerformanceCoordinator,\n};\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/performance-monitoring-integrations-bundle.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'bundleName' is defined but never used. Allowed unused args must match /^_/u.","line":21,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":40,"suggestions":[{"messageId":"removeVar","data":{"varName":"bundleName"},"fix":{"range":[486,505],"text":""},"desc":"Remove unused variable 'bundleName'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'size' is defined but never used. Allowed unused args must match /^_/u.","line":21,"column":42,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":54,"suggestions":[{"messageId":"removeVar","data":{"varName":"size"},"fix":{"range":[504,518],"text":""},"desc":"Remove unused variable 'size'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'gzipSize' is defined but never used. Allowed unused args must match /^_/u.","line":21,"column":56,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":73,"suggestions":[{"messageId":"removeVar","data":{"varName":"gzipSize"},"fix":{"range":[518,537],"text":""},"desc":"Remove unused variable 'gzipSize'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'chunkName' is defined but never used. Allowed unused args must match /^_/u.","line":22,"column":21,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":38,"suggestions":[{"messageId":"removeVar","data":{"varName":"chunkName"},"fix":{"range":[568,586],"text":""},"desc":"Remove unused variable 'chunkName'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'size' is defined but never used. Allowed unused args must match /^_/u.","line":22,"column":40,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":52,"suggestions":[{"messageId":"removeVar","data":{"varName":"size"},"fix":{"range":[585,599],"text":""},"desc":"Remove unused variable 'size'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'modules' is defined but never used. Allowed unused args must match /^_/u.","line":22,"column":54,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":71,"suggestions":[{"messageId":"removeVar","data":{"varName":"modules"},"fix":{"range":[599,618],"text":""},"desc":"Remove unused variable 'modules'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'metric' is defined but never used. Allowed unused args must match /^_/u.","line":32,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":32,"endColumn":63,"suggestions":[{"messageId":"removeVar","data":{"varName":"metric"},"fix":{"range":[845,890],"text":""},"desc":"Remove unused variable 'metric'."}]},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 10.","line":68,"column":37,"nodeType":"Literal","messageId":"noMagic","endLine":68,"endColumn":39},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 512.","line":184,"column":64,"nodeType":"Literal","messageId":"noMagic","endLine":184,"endColumn":67},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 10.","line":221,"column":17,"nodeType":"Literal","messageId":"noMagic","endLine":221,"endColumn":19},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 5.","line":226,"column":21,"nodeType":"Literal","messageId":"noMagic","endLine":226,"endColumn":22},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 1024.","line":226,"column":25,"nodeType":"Literal","messageId":"noMagic","endLine":226,"endColumn":29},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 1024.","line":226,"column":32,"nodeType":"Literal","messageId":"noMagic","endLine":226,"endColumn":36},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 1024.","line":230,"column":62,"nodeType":"Literal","messageId":"noMagic","endLine":230,"endColumn":66},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 1024.","line":230,"column":69,"nodeType":"Literal","messageId":"noMagic","endLine":230,"endColumn":73},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0.8.","line":236,"column":50,"nodeType":"Literal","messageId":"noMagic","endLine":236,"endColumn":53},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 5.","line":278,"column":44,"nodeType":"Literal","messageId":"noMagic","endLine":278,"endColumn":45},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 10.","line":281,"column":17,"nodeType":"Literal","messageId":"noMagic","endLine":281,"endColumn":19},{"ruleId":"no-shadow","severity":2,"message":"'chunks' is already declared in the upper scope on line 270 column 11.","line":295,"column":19,"nodeType":"Identifier","messageId":"noShadow","endLine":295,"endColumn":25},{"ruleId":"no-shadow","severity":2,"message":"'chunks' is already declared in the upper scope on line 270 column 11.","line":296,"column":22,"nodeType":"Identifier","messageId":"noShadow","endLine":296,"endColumn":28},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 10.","line":302,"column":17,"nodeType":"Literal","messageId":"noMagic","endLine":302,"endColumn":19},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 1024.","line":321,"column":20,"nodeType":"Literal","messageId":"noMagic","endLine":321,"endColumn":24},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 1024.","line":322,"column":15,"nodeType":"Literal","messageId":"noMagic","endLine":322,"endColumn":19},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2.","line":326,"column":28,"nodeType":"Literal","messageId":"noMagic","endLine":326,"endColumn":29},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":326,"column":34,"nodeType":"MemberExpression","endLine":326,"endColumn":50},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 5.","line":339,"column":34,"nodeType":"Literal","messageId":"noMagic","endLine":339,"endColumn":35},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 1024.","line":339,"column":38,"nodeType":"Literal","messageId":"noMagic","endLine":339,"endColumn":42},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 1024.","line":339,"column":45,"nodeType":"Literal","messageId":"noMagic","endLine":339,"endColumn":49},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2.","line":345,"column":26,"nodeType":"Literal","messageId":"noMagic","endLine":345,"endColumn":27},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 1024.","line":345,"column":30,"nodeType":"Literal","messageId":"noMagic","endLine":345,"endColumn":34},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 1024.","line":345,"column":37,"nodeType":"Literal","messageId":"noMagic","endLine":345,"endColumn":41},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 50.","line":355,"column":35,"nodeType":"Literal","messageId":"noMagic","endLine":355,"endColumn":37},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 1024.","line":390,"column":22,"nodeType":"Literal","messageId":"noMagic","endLine":390,"endColumn":26},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 1024.","line":391,"column":22,"nodeType":"Literal","messageId":"noMagic","endLine":391,"endColumn":26},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 1024.","line":392,"column":16,"nodeType":"Literal","messageId":"noMagic","endLine":392,"endColumn":20},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 1024.","line":392,"column":23,"nodeType":"Literal","messageId":"noMagic","endLine":392,"endColumn":27},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 1024.","line":402,"column":13,"nodeType":"Literal","messageId":"noMagic","endLine":402,"endColumn":17},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 1024.","line":402,"column":20,"nodeType":"Literal","messageId":"noMagic","endLine":402,"endColumn":24},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 8.","line":402,"column":27,"nodeType":"Literal","messageId":"noMagic","endLine":402,"endColumn":28},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 5.","line":403,"column":16,"nodeType":"Literal","messageId":"noMagic","endLine":403,"endColumn":17},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 1024.","line":403,"column":20,"nodeType":"Literal","messageId":"noMagic","endLine":403,"endColumn":24},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 1024.","line":403,"column":27,"nodeType":"Literal","messageId":"noMagic","endLine":403,"endColumn":31},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 8.","line":403,"column":34,"nodeType":"Literal","messageId":"noMagic","endLine":403,"endColumn":35},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 25.","line":404,"column":13,"nodeType":"Literal","messageId":"noMagic","endLine":404,"endColumn":15},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 1024.","line":404,"column":18,"nodeType":"Literal","messageId":"noMagic","endLine":404,"endColumn":22},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 1024.","line":404,"column":25,"nodeType":"Literal","messageId":"noMagic","endLine":404,"endColumn":29},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 8.","line":404,"column":32,"nodeType":"Literal","messageId":"noMagic","endLine":404,"endColumn":33},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":407,"column":20,"nodeType":"MemberExpression","endLine":407,"endColumn":43}],"suppressedMessages":[],"errorCount":48,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Bundle Analyzer 性能监控集成\n * Bundle Analyzer Performance Monitoring Integration\n * \n * 提供与Bundle Analyzer工具的集成钩子，用于监控打包大小和优化\n */\n\nimport type {\n  PerformanceConfig,\n  PerformanceMetrics,\n} from './performance-monitoring-types';\nimport { logger } from '@/lib/logger';\nimport { KB, MB } from '@/constants/units';\n\n/**\n * Bundle Analyzer 集成钩子返回类型\n * Bundle Analyzer integration hook return type\n */\nexport interface BundleAnalyzerIntegration {\n  enabled: boolean;\n  recordBundleSize: (bundleName: string, size: number, gzipSize?: number) => void;\n  recordChunkInfo: (chunkName: string, size: number, modules: string[]) => void;\n  generateSizeReport: () => Record<string, unknown>;\n}\n\n/**\n * Bundle Analyzer 集成钩子\n * Bundle Analyzer integration hook\n */\nexport function useBundleAnalyzerIntegration(\n  config: PerformanceConfig,\n  recordMetric: (metric: Omit<PerformanceMetrics, 'timestamp'>) => void\n): BundleAnalyzerIntegration {\n  const bundleData = new Map<string, { size: number; gzipSize?: number }>();\n\n  return {\n    enabled: config.bundleAnalyzer.enabled,\n\n    recordBundleSize: (bundleName: string, size: number, gzipSize?: number) => {\n      if (!config.bundleAnalyzer.enabled) return;\n\n      bundleData.set(bundleName, { size, gzipSize });\n\n      recordMetric({\n        source: 'bundle-analyzer',\n        type: 'bundle',\n        data: {\n          bundleName,\n          size,\n          gzipSize,\n          timestamp: Date.now(),\n        },\n        tags: ['bundle-analyzer', 'bundle-size'],\n        priority: 'medium',\n      });\n    },\n\n    recordChunkInfo: (chunkName: string, size: number, modules: string[]) => {\n      if (!config.bundleAnalyzer.enabled) return;\n\n      recordMetric({\n        source: 'bundle-analyzer',\n        type: 'bundle',\n        data: {\n          chunkName,\n          size,\n          moduleCount: modules.length,\n          modules: modules.slice(0, 10), // 只记录前10个模块\n          timestamp: Date.now(),\n        },\n        tags: ['bundle-analyzer', 'chunk-info'],\n        priority: 'low',\n      });\n    },\n\n    generateSizeReport: () => {\n      return Object.fromEntries(bundleData);\n    },\n  };\n}\n\n/**\n * Bundle Analyzer 配置验证\n * Bundle Analyzer configuration validation\n */\nexport function validateBundleAnalyzerConfig(config: PerformanceConfig): {\n  isValid: boolean;\n  errors: string[];\n  warnings: string[];\n} {\n  const errors: string[] = [];\n  const warnings: string[] = [];\n\n  if (!config.bundleAnalyzer) {\n    errors.push('Bundle Analyzer configuration is missing');\n    return { isValid: false, errors, warnings };\n  }\n\n  if (typeof config.bundleAnalyzer.enabled !== 'boolean') {\n    errors.push('Bundle Analyzer enabled must be a boolean');\n  }\n\n  if (config.bundleAnalyzer.enabled) {\n    if (config.bundleAnalyzer.maxBundleSize && \n        (typeof config.bundleAnalyzer.maxBundleSize !== 'number' || \n         config.bundleAnalyzer.maxBundleSize <= 0)) {\n      warnings.push('Bundle Analyzer maxBundleSize should be a positive number');\n    }\n\n    if (config.bundleAnalyzer.maxChunkSize && \n        (typeof config.bundleAnalyzer.maxChunkSize !== 'number' || \n         config.bundleAnalyzer.maxChunkSize <= 0)) {\n      warnings.push('Bundle Analyzer maxChunkSize should be a positive number');\n    }\n  }\n\n  return {\n    isValid: errors.length === 0,\n    errors,\n    warnings,\n  };\n}\n\n/**\n * Bundle Analyzer 性能分析器\n * Bundle Analyzer performance analyzer\n */\nexport class BundleAnalyzerAnalyzer {\n  private bundles = new Map<string, {\n    size: number;\n    gzipSize?: number;\n    timestamp: number;\n  }>();\n\n  private chunks = new Map<string, {\n    size: number;\n    modules: string[];\n    timestamp: number;\n  }>();\n\n  private config: PerformanceConfig;\n\n  constructor(config: PerformanceConfig) {\n    this.config = config;\n  }\n\n  /**\n   * 记录Bundle大小\n   * Record bundle size\n   */\n  recordBundleSize(bundleName: string, size: number, gzipSize?: number): void {\n    if (!this.config.bundleAnalyzer.enabled) return;\n\n    this.bundles.set(bundleName, {\n      size,\n      gzipSize,\n      timestamp: Date.now(),\n    });\n\n    // 检查是否超过大小限制\n    const maxSize = this.config.bundleAnalyzer.maxBundleSize || MB; // 1MB\n    if (size > maxSize) {\n      logger.warn(`Bundle ${bundleName} exceeds size limit`, {\n        size: this.formatSize(size),\n        maxSize: this.formatSize(maxSize),\n      });\n    }\n  }\n\n  /**\n   * 记录Chunk信息\n   * Record chunk information\n   */\n  recordChunkInfo(chunkName: string, size: number, modules: string[]): void {\n    if (!this.config.bundleAnalyzer.enabled) return;\n\n    this.chunks.set(chunkName, {\n      size,\n      modules,\n      timestamp: Date.now(),\n    });\n\n    // 检查是否超过大小限制\n    const maxSize = this.config.bundleAnalyzer.maxChunkSize || 512 * KB; // 512KB\n    if (size > maxSize) {\n      logger.warn(`Chunk ${chunkName} exceeds size limit`, {\n        size: this.formatSize(size),\n        maxSize: this.formatSize(maxSize),\n      });\n    }\n  }\n\n  /**\n   * 生成Bundle分析报告\n   * Generate bundle analysis report\n   */\n  generateBundleReport(): {\n    totalBundles: number;\n    totalSize: number;\n    totalGzipSize: number;\n    largestBundles: Array<{\n      name: string;\n      size: number;\n      gzipSize?: number;\n      compressionRatio?: number;\n    }>;\n    recommendations: string[];\n  } {\n    const bundles = Array.from(this.bundles.entries());\n    const totalSize = bundles.reduce((sum, [, bundle]) => sum + bundle.size, 0);\n    const totalGzipSize = bundles.reduce((sum, [, bundle]) => sum + (bundle.gzipSize || 0), 0);\n\n    const largestBundles = bundles\n      .map(([name, bundle]) => ({\n        name,\n        size: bundle.size,\n        gzipSize: bundle.gzipSize,\n        compressionRatio: bundle.gzipSize ? bundle.gzipSize / bundle.size : undefined,\n      }))\n      .sort((a, b) => b.size - a.size)\n      .slice(0, 10);\n\n    const recommendations: string[] = [];\n\n    // 生成优化建议\n    if (totalSize > 5 * 1024 * 1024) { // 5MB\n      recommendations.push('Total bundle size is large. Consider code splitting and lazy loading.');\n    }\n\n    const largeBundles = largestBundles.filter(b => b.size > 1024 * 1024); // 1MB\n    if (largeBundles.length > 0) {\n      recommendations.push(`${largeBundles.length} bundles are larger than 1MB. Consider splitting them.`);\n    }\n\n    const poorCompressionBundles = largestBundles.filter(b => \n      b.compressionRatio && b.compressionRatio > 0.8\n    );\n    if (poorCompressionBundles.length > 0) {\n      recommendations.push(`${poorCompressionBundles.length} bundles have poor compression ratios. Check for duplicate code.`);\n    }\n\n    return {\n      totalBundles: bundles.length,\n      totalSize,\n      totalGzipSize,\n      largestBundles,\n      recommendations,\n    };\n  }\n\n  /**\n   * 生成Chunk分析报告\n   * Generate chunk analysis report\n   */\n  generateChunkReport(): {\n    totalChunks: number;\n    totalSize: number;\n    largestChunks: Array<{\n      name: string;\n      size: number;\n      moduleCount: number;\n      topModules: string[];\n    }>;\n    duplicateModules: Array<{\n      module: string;\n      chunks: string[];\n      totalSize: number;\n    }>;\n  } {\n    const chunks = Array.from(this.chunks.entries());\n    const totalSize = chunks.reduce((sum, [, chunk]) => sum + chunk.size, 0);\n\n    const largestChunks = chunks\n      .map(([name, chunk]) => ({\n        name,\n        size: chunk.size,\n        moduleCount: chunk.modules.length,\n        topModules: chunk.modules.slice(0, 5),\n      }))\n      .sort((a, b) => b.size - a.size)\n      .slice(0, 10);\n\n    // 查找重复模块\n    const moduleChunkMap = new Map<string, string[]>();\n    chunks.forEach(([chunkName, chunk]) => {\n      chunk.modules.forEach(module => {\n        if (!moduleChunkMap.has(module)) {\n          moduleChunkMap.set(module, []);\n        }\n        moduleChunkMap.get(module)!.push(chunkName);\n      });\n    });\n\n    const duplicateModules = Array.from(moduleChunkMap.entries())\n      .filter(([, chunks]) => chunks.length > 1)\n      .map(([module, chunks]) => ({\n        module,\n        chunks,\n        totalSize: chunks.length * 1000, // 估算大小\n      }))\n      .sort((a, b) => b.totalSize - a.totalSize)\n      .slice(0, 10);\n\n    return {\n      totalChunks: chunks.length,\n      totalSize,\n      largestChunks,\n      duplicateModules,\n    };\n  }\n\n  /**\n   * 格式化文件大小\n   * Format file size\n   */\n  private formatSize(bytes: number): string {\n    const units = ['B', 'KB', 'MB', 'GB'];\n    let size = bytes;\n    let unitIndex = 0;\n\n    while (size >= 1024 && unitIndex < units.length - 1) {\n      size /= 1024;\n      unitIndex += 1;\n    }\n\n    return `${size.toFixed(2)} ${units[unitIndex]}`;\n  }\n\n  /**\n   * 获取优化建议\n   * Get optimization suggestions\n   */\n  getOptimizationSuggestions(): string[] {\n    const suggestions: string[] = [];\n    const bundleReport = this.generateBundleReport();\n    const chunkReport = this.generateChunkReport();\n\n    // Bundle优化建议\n    if (bundleReport.totalSize > 5 * 1024 * 1024) {\n      suggestions.push('Consider implementing code splitting to reduce initial bundle size');\n    }\n\n    if (bundleReport.largestBundles.length > 0) {\n      const largest = bundleReport.largestBundles[0];\n      if (largest.size > 2 * 1024 * 1024) {\n        suggestions.push(`Bundle \"${largest.name}\" is very large (${this.formatSize(largest.size)}). Consider splitting it.`);\n      }\n    }\n\n    // Chunk优化建议\n    if (chunkReport.duplicateModules.length > 0) {\n      suggestions.push(`Found ${chunkReport.duplicateModules.length} duplicate modules. Consider creating shared chunks.`);\n    }\n\n    if (chunkReport.totalChunks > 50) {\n      suggestions.push('Large number of chunks detected. Consider consolidating smaller chunks.');\n    }\n\n    return suggestions;\n  }\n\n  /**\n   * 重置所有数据\n   * Reset all data\n   */\n  reset(): void {\n    this.bundles.clear();\n    this.chunks.clear();\n  }\n}\n\n/**\n * Bundle Analyzer 工具函数\n * Bundle Analyzer utility functions\n */\nexport const BundleAnalyzerUtils = {\n  /**\n   * 计算压缩比\n   * Calculate compression ratio\n   */\n  calculateCompressionRatio(originalSize: number, compressedSize: number): number {\n    return compressedSize / originalSize;\n  },\n\n  /**\n   * 获取大小等级\n   * Get size rating\n   */\n  getSizeRating(size: number): 'small' | 'medium' | 'large' | 'huge' {\n    if (size < 100 * 1024) return 'small'; // < 100KB\n    if (size < 500 * 1024) return 'medium'; // < 500KB\n    if (size < 1024 * 1024) return 'large'; // < 1MB\n    return 'huge'; // >= 1MB\n  },\n\n  /**\n   * 估算加载时间\n   * Estimate loading time\n   */\n  estimateLoadingTime(size: number, connectionSpeed: 'slow' | 'fast' | 'average' = 'average'): number {\n    const speeds = {\n      slow: 1024 * 1024 / 8, // 1 Mbps in bytes per second\n      average: 5 * 1024 * 1024 / 8, // 5 Mbps\n      fast: 25 * 1024 * 1024 / 8, // 25 Mbps\n    };\n\n    return (size / speeds[connectionSpeed]) * 1000; // Return in milliseconds\n  },\n} as const;\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/performance-monitoring-integrations-react-scan.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'componentName' is defined but never used. Allowed unused args must match /^_/u.","line":20,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":39,"suggestions":[{"messageId":"removeVar","data":{"varName":"componentName"},"fix":{"range":[412,434],"text":""},"desc":"Remove unused variable 'componentName'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'renderCount' is defined but never used. Allowed unused args must match /^_/u.","line":20,"column":41,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":60,"suggestions":[{"messageId":"removeVar","data":{"varName":"renderCount"},"fix":{"range":[433,454],"text":""},"desc":"Remove unused variable 'renderCount'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'renderTime' is defined but never used. Allowed unused args must match /^_/u.","line":20,"column":62,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":81,"suggestions":[{"messageId":"removeVar","data":{"varName":"renderTime"},"fix":{"range":[454,475],"text":""},"desc":"Remove unused variable 'renderTime'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'componentName' is defined but never used. Allowed unused args must match /^_/u.","line":21,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":50,"suggestions":[{"messageId":"removeVar","data":{"varName":"componentName"},"fix":{"range":[514,536],"text":""},"desc":"Remove unused variable 'componentName'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'reason' is defined but never used. Allowed unused args must match /^_/u.","line":21,"column":52,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":66,"suggestions":[{"messageId":"removeVar","data":{"varName":"reason"},"fix":{"range":[535,551],"text":""},"desc":"Remove unused variable 'reason'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'metric' is defined but never used. Allowed unused args must match /^_/u.","line":31,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":31,"endColumn":63,"suggestions":[{"messageId":"removeVar","data":{"varName":"metric"},"fix":{"range":[793,838],"text":""},"desc":"Remove unused variable 'metric'."}]},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 5.","line":59,"column":33,"nodeType":"Literal","messageId":"noMagic","endLine":59,"endColumn":34},{"ruleId":"no-unused-vars","severity":2,"message":"'renderTime' is defined but never used. Allowed unused args must match /^_/u.","line":199,"column":54,"nodeType":"Identifier","messageId":"unusedVar","endLine":199,"endColumn":72,"suggestions":[{"messageId":"removeVar","data":{"varName":"renderTime"},"fix":{"range":[5394,5414],"text":""},"desc":"Remove unused variable 'renderTime'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'renderTime' is defined but never used. Allowed unused args must match /^_/u.","line":199,"column":54,"nodeType":null,"messageId":"unusedVar","endLine":199,"endColumn":64},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 10.","line":238,"column":17,"nodeType":"Literal","messageId":"noMagic","endLine":238,"endColumn":19},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 16.","line":245,"column":42,"nodeType":"Literal","messageId":"noMagic","endLine":245,"endColumn":44},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2.","line":246,"column":138,"nodeType":"Literal","messageId":"noMagic","endLine":246,"endColumn":139},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2.","line":310,"column":38,"nodeType":"Literal","messageId":"noMagic","endLine":310,"endColumn":39},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2.","line":312,"column":45,"nodeType":"Literal","messageId":"noMagic","endLine":312,"endColumn":46},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 8.","line":320,"column":22,"nodeType":"Literal","messageId":"noMagic","endLine":320,"endColumn":23},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 16.","line":321,"column":22,"nodeType":"Literal","messageId":"noMagic","endLine":321,"endColumn":24},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 32.","line":322,"column":22,"nodeType":"Literal","messageId":"noMagic","endLine":322,"endColumn":24},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 16.","line":347,"column":38,"nodeType":"Literal","messageId":"noMagic","endLine":347,"endColumn":40},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0.3.","line":352,"column":70,"nodeType":"Literal","messageId":"noMagic","endLine":352,"endColumn":73}],"suppressedMessages":[],"errorCount":19,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * React Scan 性能监控集成\n * React Scan Performance Monitoring Integration\n * \n * 提供与React Scan工具的集成钩子，用于监控React组件渲染性能\n */\n\nimport type {\n  PerformanceConfig,\n  PerformanceMetrics,\n} from './performance-monitoring-types';\nimport { logger } from '@/lib/logger';\n\n/**\n * React Scan 集成钩子返回类型\n * React Scan integration hook return type\n */\nexport interface ReactScanIntegration {\n  enabled: boolean;\n  recordRender: (componentName: string, renderCount: number, renderTime?: number) => void;\n  recordUnnecessaryRender: (componentName: string, reason: string) => void;\n  getComponentStats: () => Record<string, { renders: number; totalTime: number }>;\n}\n\n/**\n * React Scan 集成钩子\n * React Scan integration hook\n */\nexport function useReactScanIntegration(\n  config: PerformanceConfig,\n  recordMetric: (metric: Omit<PerformanceMetrics, 'timestamp'>) => void\n): ReactScanIntegration {\n  const componentStats = new Map<string, { renders: number; totalTime: number }>();\n\n  return {\n    enabled: config.reactScan.enabled,\n    \n    recordRender: (componentName: string, renderCount: number, renderTime = 0) => {\n      if (!config.reactScan.enabled) return;\n\n      // 更新组件统计\n      const current = componentStats.get(componentName) || { renders: 0, totalTime: 0 };\n      current.renders += renderCount;\n      current.totalTime += renderTime;\n      componentStats.set(componentName, current);\n\n      recordMetric({\n        source: 'react-scan',\n        type: 'component',\n        data: {\n          componentName,\n          renderCount,\n          renderTime,\n          totalRenders: current.renders,\n          averageRenderTime: current.totalTime / current.renders,\n          timestamp: Date.now(),\n        },\n        tags: ['react-scan', 'component-render'],\n        priority: renderCount > 5 ? 'high' : 'medium',\n      });\n    },\n\n    recordUnnecessaryRender: (componentName: string, reason: string) => {\n      if (!config.reactScan.enabled || !config.reactScan.trackUnnecessaryRenders) return;\n\n      recordMetric({\n        source: 'react-scan',\n        type: 'component',\n        data: {\n          componentName,\n          reason,\n          type: 'unnecessary-render',\n          timestamp: Date.now(),\n        },\n        tags: ['react-scan', 'unnecessary-render'],\n        priority: 'high',\n      });\n    },\n\n    getComponentStats: () => {\n      return Object.fromEntries(componentStats);\n    },\n  };\n}\n\n/**\n * React Scan 配置验证\n * React Scan configuration validation\n */\nexport function validateReactScanConfig(config: PerformanceConfig): {\n  isValid: boolean;\n  errors: string[];\n  warnings: string[];\n} {\n  const errors: string[] = [];\n  const warnings: string[] = [];\n\n  if (!config.reactScan) {\n    errors.push('React Scan configuration is missing');\n    return { isValid: false, errors, warnings };\n  }\n\n  if (typeof config.reactScan.enabled !== 'boolean') {\n    errors.push('React Scan enabled must be a boolean');\n  }\n\n  if (config.reactScan.enabled) {\n    if (typeof config.reactScan.trackUnnecessaryRenders !== 'boolean') {\n      warnings.push('React Scan trackUnnecessaryRenders should be a boolean');\n    }\n\n    if (config.reactScan.maxComponentsToTrack && \n        (typeof config.reactScan.maxComponentsToTrack !== 'number' || \n         config.reactScan.maxComponentsToTrack <= 0)) {\n      warnings.push('React Scan maxComponentsToTrack should be a positive number');\n    }\n\n    if (config.reactScan.renderThreshold && \n        (typeof config.reactScan.renderThreshold !== 'number' || \n         config.reactScan.renderThreshold <= 0)) {\n      warnings.push('React Scan renderThreshold should be a positive number');\n    }\n  }\n\n  return {\n    isValid: errors.length === 0,\n    errors,\n    warnings,\n  };\n}\n\n/**\n * React Scan 性能分析器\n * React Scan performance analyzer\n */\nexport class ReactScanAnalyzer {\n  private componentMetrics = new Map<string, {\n    renders: number;\n    totalTime: number;\n    lastRender: number;\n    unnecessaryRenders: number;\n  }>();\n\n  private config: PerformanceConfig;\n\n  constructor(config: PerformanceConfig) {\n    this.config = config;\n  }\n\n  /**\n   * 记录组件渲染\n   * Record component render\n   */\n  recordRender(componentName: string, renderTime: number): void {\n    if (!this.config.reactScan.enabled) return;\n\n    const current = this.componentMetrics.get(componentName) || {\n      renders: 0,\n      totalTime: 0,\n      lastRender: 0,\n      unnecessaryRenders: 0,\n    };\n\n    current.renders += 1;\n    current.totalTime += renderTime;\n    current.lastRender = Date.now();\n\n    this.componentMetrics.set(componentName, current);\n\n    // 检查是否为不必要的渲染\n    if (this.isUnnecessaryRender(componentName, renderTime)) {\n      current.unnecessaryRenders += 1;\n      this.recordUnnecessaryRender(componentName, 'High frequency rendering detected');\n    }\n  }\n\n  /**\n   * 记录不必要的渲染\n   * Record unnecessary render\n   */\n  recordUnnecessaryRender(componentName: string, reason: string): void {\n    if (!this.config.reactScan.enabled || !this.config.reactScan.trackUnnecessaryRenders) return;\n\n    const current = this.componentMetrics.get(componentName);\n    if (current) {\n      current.unnecessaryRenders += 1;\n    }\n\n    // 可以在这里添加日志或发送到监控服务\n    if (this.config.debug) {\n      logger.warn(`Unnecessary render detected for ${componentName}`, { reason });\n    }\n  }\n\n  /**\n   * 检查是否为不必要的渲染\n   * Check if render is unnecessary\n   */\n  private isUnnecessaryRender(componentName: string, renderTime: number): boolean {\n    const current = this.componentMetrics.get(componentName);\n    if (!current) return false;\n\n    const threshold = this.config.reactScan.renderThreshold || 100;\n    const timeSinceLastRender = Date.now() - current.lastRender;\n\n    // 如果渲染间隔太短，可能是不必要的渲染\n    return timeSinceLastRender < threshold;\n  }\n\n  /**\n   * 获取组件性能报告\n   * Get component performance report\n   */\n  getPerformanceReport(): {\n    totalComponents: number;\n    totalRenders: number;\n    averageRenderTime: number;\n    topSlowComponents: Array<{\n      name: string;\n      averageTime: number;\n      renders: number;\n      unnecessaryRenders: number;\n    }>;\n    recommendations: string[];\n  } {\n    const components = Array.from(this.componentMetrics.entries());\n    const totalRenders = components.reduce((sum, [, metrics]) => sum + metrics.renders, 0);\n    const totalTime = components.reduce((sum, [, metrics]) => sum + metrics.totalTime, 0);\n\n    const topSlowComponents = components\n      .map(([name, metrics]) => ({\n        name,\n        averageTime: metrics.totalTime / metrics.renders,\n        renders: metrics.renders,\n        unnecessaryRenders: metrics.unnecessaryRenders,\n      }))\n      .sort((a, b) => b.averageTime - a.averageTime)\n      .slice(0, 10);\n\n    const recommendations: string[] = [];\n\n    // 生成建议\n    if (topSlowComponents.length > 0) {\n      const slowestComponent = topSlowComponents[0];\n      if (slowestComponent.averageTime > 16) { // 超过一帧的时间\n        recommendations.push(`Consider optimizing ${slowestComponent.name} - average render time: ${slowestComponent.averageTime.toFixed(2)}ms`);\n      }\n    }\n\n    const unnecessaryRenderComponents = topSlowComponents.filter(c => c.unnecessaryRenders > 0);\n    if (unnecessaryRenderComponents.length > 0) {\n      recommendations.push(`${unnecessaryRenderComponents.length} components have unnecessary renders. Consider using React.memo or useMemo.`);\n    }\n\n    return {\n      totalComponents: components.length,\n      totalRenders,\n      averageRenderTime: totalTime / totalRenders || 0,\n      topSlowComponents,\n      recommendations,\n    };\n  }\n\n  /**\n   * 重置统计数据\n   * Reset statistics\n   */\n  reset(): void {\n    this.componentMetrics.clear();\n  }\n\n  /**\n   * 获取特定组件的统计数据\n   * Get statistics for specific component\n   */\n  getComponentStats(componentName: string): {\n    renders: number;\n    totalTime: number;\n    averageTime: number;\n    lastRender: number;\n    unnecessaryRenders: number;\n  } | null {\n    const metrics = this.componentMetrics.get(componentName);\n    if (!metrics) return null;\n\n    return {\n      renders: metrics.renders,\n      totalTime: metrics.totalTime,\n      averageTime: metrics.totalTime / metrics.renders,\n      lastRender: metrics.lastRender,\n      unnecessaryRenders: metrics.unnecessaryRenders,\n    };\n  }\n}\n\n/**\n * React Scan 工具函数\n * React Scan utility functions\n */\nexport const ReactScanUtils = {\n  /**\n   * 格式化渲染时间\n   * Format render time\n   */\n  formatRenderTime(milliseconds: number): string {\n    if (milliseconds < 1) {\n      return `${(milliseconds * 1000).toFixed(1)}μs`;\n    }\n    if (milliseconds < 1000) {\n      return `${milliseconds.toFixed(2)}ms`;\n    }\n    return `${(milliseconds / 1000).toFixed(2)}s`;\n  },\n\n  /**\n   * 获取渲染性能等级\n   * Get render performance rating\n   */\n  getRenderPerformanceRating(renderTime: number): 'excellent' | 'good' | 'fair' | 'poor' {\n    if (renderTime < 8) return 'excellent';\n    if (renderTime < 16) return 'good';\n    if (renderTime < 32) return 'fair';\n    return 'poor';\n  },\n\n  /**\n   * 计算渲染效率分数\n   * Calculate render efficiency score\n   */\n  calculateEfficiencyScore(totalRenders: number, unnecessaryRenders: number): number {\n    if (totalRenders === 0) return 100;\n    const efficiency = (totalRenders - unnecessaryRenders) / totalRenders;\n    return Math.round(efficiency * 100);\n  },\n\n  /**\n   * 生成组件优化建议\n   * Generate component optimization suggestions\n   */\n  generateOptimizationSuggestions(componentStats: {\n    renders: number;\n    averageTime: number;\n    unnecessaryRenders: number;\n  }): string[] {\n    const suggestions: string[] = [];\n\n    if (componentStats.averageTime > 16) {\n      suggestions.push('Consider breaking down this component into smaller components');\n      suggestions.push('Use React.memo to prevent unnecessary re-renders');\n    }\n\n    if (componentStats.unnecessaryRenders > componentStats.renders * 0.3) {\n      suggestions.push('High rate of unnecessary renders detected - check prop dependencies');\n      suggestions.push('Consider using useMemo or useCallback for expensive computations');\n    }\n\n    if (componentStats.renders > 100) {\n      suggestions.push('High render frequency - consider implementing virtualization if rendering lists');\n    }\n\n    return suggestions;\n  },\n} as const;\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/performance-monitoring-integrations-vitals.ts","messages":[{"ruleId":"no-duplicate-imports","severity":2,"message":"'./performance-monitoring-types' import is duplicated.","line":12,"column":1,"nodeType":"ImportDeclaration","messageId":"import","endLine":12,"endColumn":94},{"ruleId":"no-unused-vars","severity":2,"message":"'name' is defined but never used. Allowed unused args must match /^_/u.","line":20,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":32,"suggestions":[{"messageId":"removeVar","data":{"varName":"name"},"fix":{"range":[489,502],"text":""},"desc":"Remove unused variable 'name'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'value' is defined but never used. Allowed unused args must match /^_/u.","line":20,"column":34,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":47,"suggestions":[{"messageId":"removeVar","data":{"varName":"value"},"fix":{"range":[501,516],"text":""},"desc":"Remove unused variable 'value'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'rating' is defined but never used. Allowed unused args must match /^_/u.","line":20,"column":49,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":94,"suggestions":[{"messageId":"removeVar","data":{"varName":"rating"},"fix":{"range":[516,563],"text":""},"desc":"Remove unused variable 'rating'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'name' is defined but never used. Allowed unused args must match /^_/u.","line":21,"column":24,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":36,"suggestions":[{"messageId":"removeVar","data":{"varName":"name"},"fix":{"range":[597,610],"text":""},"desc":"Remove unused variable 'name'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'value' is defined but never used. Allowed unused args must match /^_/u.","line":21,"column":38,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":51,"suggestions":[{"messageId":"removeVar","data":{"varName":"value"},"fix":{"range":[609,624],"text":""},"desc":"Remove unused variable 'value'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'unit' is defined but never used. Allowed unused args must match /^_/u.","line":21,"column":53,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":66,"suggestions":[{"messageId":"removeVar","data":{"varName":"unit"},"fix":{"range":[624,639],"text":""},"desc":"Remove unused variable 'unit'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'metric' is defined but never used. Allowed unused args must match /^_/u.","line":30,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":30,"endColumn":63,"suggestions":[{"messageId":"removeVar","data":{"varName":"metric"},"fix":{"range":[798,843],"text":""},"desc":"Remove unused variable 'metric'."}]},{"ruleId":"max-statements","severity":2,"message":"Function 'checkEnvironmentCompatibility' has too many statements (30). Maximum allowed is 20.","line":87,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":147,"endColumn":2},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":134,"column":10,"nodeType":"MemberExpression","endLine":134,"endColumn":29},{"ruleId":"max-statements","severity":2,"message":"Function 'performHealthCheck' has too many statements (26). Maximum allowed is 20.","line":153,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":211,"endColumn":2},{"ruleId":"complexity","severity":2,"message":"Function 'validateWebVitalsConfig' has a complexity of 19. Maximum allowed is 15.","line":217,"column":8,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":258,"endColumn":2},{"ruleId":"prefer-destructuring","severity":2,"message":"Use object destructuring.","line":236,"column":15,"nodeType":"VariableDeclarator","messageId":"preferDestructuring","endLine":236,"endColumn":55,"fix":{"range":[6591,6631],"text":"{thresholds} = config.webVitals"}},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (4). Maximum allowed is 3.","line":238,"column":9,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":240,"endColumn":10},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (4). Maximum allowed is 3.","line":242,"column":9,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":244,"endColumn":10},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (4). Maximum allowed is 3.","line":246,"column":9,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":248,"endColumn":10},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: -50.","line":304,"column":45,"nodeType":"UnaryExpression","messageId":"noMagic","endLine":304,"endColumn":48},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: -50.","line":305,"column":47,"nodeType":"UnaryExpression","messageId":"noMagic","endLine":305,"endColumn":50},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: -50.","line":329,"column":45,"nodeType":"UnaryExpression","messageId":"noMagic","endLine":329,"endColumn":48},{"ruleId":"max-statements","severity":2,"message":"Method 'getWebVitalsReport' has too many statements (28). Maximum allowed is 20.","line":337,"column":21,"nodeType":"FunctionExpression","messageId":"exceed","endLine":403,"endColumn":4},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2.","line":360,"column":33,"nodeType":"Literal","messageId":"noMagic","endLine":360,"endColumn":34},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: -5.","line":361,"column":42,"nodeType":"UnaryExpression","messageId":"noMagic","endLine":361,"endColumn":44},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: -10.","line":362,"column":41,"nodeType":"UnaryExpression","messageId":"noMagic","endLine":362,"endColumn":44},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: -5.","line":362,"column":46,"nodeType":"UnaryExpression","messageId":"noMagic","endLine":362,"endColumn":48},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (4). Maximum allowed is 3.","line":367,"column":11,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":368,"endColumn":68},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0.9.","line":367,"column":38,"nodeType":"Literal","messageId":"noMagic","endLine":367,"endColumn":41},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 1.1.","line":368,"column":43,"nodeType":"Literal","messageId":"noMagic","endLine":368,"endColumn":46},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":372,"column":7,"nodeType":"MemberExpression","endLine":372,"endColumn":19},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 50.","line":380,"column":98,"nodeType":"Literal","messageId":"noMagic","endLine":380,"endColumn":100},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2.","line":391,"column":89,"nodeType":"Literal","messageId":"noMagic","endLine":391,"endColumn":90}],"suppressedMessages":[],"errorCount":30,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"/**\n * Web Vitals 和环境检查性能监控集成\n * Web Vitals and Environment Check Performance Monitoring Integration\n *\n * 提供与Web Vitals工具的集成钩子和环境兼容性检查功能\n */\n\nimport type {\n  PerformanceConfig,\n  PerformanceMetrics,\n} from './performance-monitoring-types';\nimport { isTestEnvironment, isDevelopmentEnvironment } from './performance-monitoring-types';\n\n/**\n * Web Vitals 集成钩子返回类型\n * Web Vitals integration hook return type\n */\nexport interface WebVitalsIntegration {\n  enabled: boolean;\n  recordWebVital: (name: string, value: number, rating: 'good' | 'needs-improvement' | 'poor') => void;\n  recordCustomMetric: (name: string, value: number, unit?: string) => void;\n}\n\n/**\n * Web Vitals 集成钩子\n * Web Vitals integration hook\n */\nexport function useWebVitalsIntegration(\n  config: PerformanceConfig,\n  recordMetric: (metric: Omit<PerformanceMetrics, 'timestamp'>) => void\n): WebVitalsIntegration {\n  return {\n    enabled: config.webVitals?.enabled || false,\n\n    recordWebVital: (name: string, value: number, rating: 'good' | 'needs-improvement' | 'poor') => {\n      if (!config.webVitals?.enabled) return;\n\n      recordMetric({\n        source: 'web-vitals',\n        type: 'page',\n        data: {\n          name,\n          value,\n          rating,\n          timestamp: Date.now(),\n        },\n        tags: ['web-vitals', name.toLowerCase()],\n        priority: rating === 'poor' ? 'high' : 'medium',\n      });\n    },\n\n    recordCustomMetric: (name: string, value: number, unit = 'ms') => {\n      if (!config.webVitals?.enabled) return;\n\n      recordMetric({\n        source: 'custom',\n        type: 'page',\n        data: {\n          name,\n          value,\n          unit,\n          timestamp: Date.now(),\n        },\n        tags: ['custom-metric'],\n        priority: 'low',\n      });\n    },\n  };\n}\n\n/**\n * 环境兼容性检查结果\n * Environment compatibility check result\n */\nexport interface EnvironmentCompatibilityResult {\n  isCompatible: boolean;\n  issues: string[];\n  recommendations: string[];\n  environment: string;\n  warnings: string[];\n}\n\n/**\n * 环境兼容性检查\n * Environment compatibility check\n */\nexport function checkEnvironmentCompatibility(): EnvironmentCompatibilityResult {\n  const issues: string[] = [];\n  const recommendations: string[] = [];\n  const warnings: string[] = [];\n  const environment = process.env.NODE_ENV || 'development';\n\n  // 检查测试环境配置\n  if (isTestEnvironment()) {\n    if (process.env.NEXT_PUBLIC_DISABLE_REACT_SCAN !== 'true') {\n      issues.push('测试环境中 React Scan 未被禁用');\n      recommendations.push('设置 NEXT_PUBLIC_DISABLE_REACT_SCAN=true');\n    }\n\n    if (process.env.NEXT_PUBLIC_ENABLE_WEB_EVAL_AGENT !== 'true') {\n      warnings.push('测试环境中 Web Eval Agent 未启用');\n      recommendations.push('考虑设置 NEXT_PUBLIC_ENABLE_WEB_EVAL_AGENT=true');\n    }\n  }\n\n  // 检查开发环境配置\n  if (isDevelopmentEnvironment()) {\n    if (process.env.NEXT_PUBLIC_DISABLE_REACT_SCAN === 'true') {\n      warnings.push('开发环境中 React Scan 被禁用');\n      recommendations.push('考虑启用 React Scan 以获得性能监控');\n    }\n\n    if (!process.env.ANALYZE && process.env.NODE_ENV === 'development') {\n      recommendations.push('考虑定期运行 ANALYZE=true npm run build 来分析包大小');\n    }\n  }\n\n  // 检查生产环境配置\n  if (environment === 'production') {\n    if (process.env.NEXT_PUBLIC_DISABLE_REACT_SCAN !== 'true') {\n      issues.push('生产环境中 React Scan 未被禁用');\n      recommendations.push('在生产环境中设置 NEXT_PUBLIC_DISABLE_REACT_SCAN=true');\n    }\n\n    if (process.env.ANALYZE === 'true') {\n      warnings.push('生产环境中启用了 Bundle Analyzer');\n      recommendations.push('生产环境中应禁用 Bundle Analyzer');\n    }\n  }\n\n  // 检查必要的环境变量\n  const requiredEnvVars = ['NODE_ENV'];\n  for (const envVar of requiredEnvVars) {\n    if (!process.env[envVar]) {\n      issues.push(`缺少必要的环境变量: ${envVar}`);\n      recommendations.push(`设置环境变量 ${envVar}`);\n    }\n  }\n\n  return {\n    isCompatible: issues.length === 0,\n    issues,\n    recommendations,\n    environment,\n    warnings,\n  };\n}\n\n/**\n * 性能监控健康检查\n * Performance monitoring health check\n */\nexport function performHealthCheck(config: PerformanceConfig): {\n  isHealthy: boolean;\n  status: Record<string, 'healthy' | 'warning' | 'error'>;\n  details: Record<string, string>;\n} {\n  const status: Record<string, 'healthy' | 'warning' | 'error'> = {};\n  const details: Record<string, string> = {};\n\n  // 检查 React Scan 状态\n  if (config.reactScan.enabled) {\n    if (isTestEnvironment()) {\n      status.reactScan = 'error';\n      details.reactScan = 'React Scan should be disabled in test environment';\n    } else if (isDevelopmentEnvironment()) {\n      status.reactScan = 'healthy';\n      details.reactScan = 'React Scan is properly configured for development';\n    } else {\n      status.reactScan = 'warning';\n      details.reactScan = 'React Scan is enabled in non-development environment';\n    }\n  } else {\n    status.reactScan = 'healthy';\n    details.reactScan = 'React Scan is disabled';\n  }\n\n  // 检查 Web Eval Agent 状态\n  if (config.webEvalAgent.enabled) {\n    if (isTestEnvironment()) {\n      status.webEvalAgent = 'healthy';\n      details.webEvalAgent = 'Web Eval Agent is properly configured for testing';\n    } else {\n      status.webEvalAgent = 'warning';\n      details.webEvalAgent = 'Web Eval Agent is enabled outside test environment';\n    }\n  } else {\n    status.webEvalAgent = 'healthy';\n    details.webEvalAgent = 'Web Eval Agent is disabled';\n  }\n\n  // 检查 Bundle Analyzer 状态\n  status.bundleAnalyzer = config.bundleAnalyzer.enabled ? 'healthy' : 'healthy';\n  details.bundleAnalyzer = config.bundleAnalyzer.enabled\n    ? 'Bundle Analyzer is enabled'\n    : 'Bundle Analyzer is disabled';\n\n  // 检查 Size Limit 状态\n  status.sizeLimit = config.sizeLimit.enabled ? 'healthy' : 'warning';\n  details.sizeLimit = config.sizeLimit.enabled\n    ? 'Size Limit monitoring is active'\n    : 'Size Limit monitoring is disabled';\n\n  const isHealthy = Object.values(status).every(s => s !== 'error');\n\n  return {\n    isHealthy,\n    status,\n    details,\n  };\n}\n\n/**\n * Web Vitals 配置验证\n * Web Vitals configuration validation\n */\nexport function validateWebVitalsConfig(config: PerformanceConfig): {\n  isValid: boolean;\n  errors: string[];\n  warnings: string[];\n} {\n  const errors: string[] = [];\n  const warnings: string[] = [];\n\n  if (config.webVitals) {\n    if (typeof config.webVitals.enabled !== 'boolean') {\n      errors.push('Web Vitals enabled must be a boolean');\n    }\n\n    if (config.webVitals.enabled) {\n      if (config.webVitals.reportAllChanges && typeof config.webVitals.reportAllChanges !== 'boolean') {\n        warnings.push('Web Vitals reportAllChanges should be a boolean');\n      }\n\n      if (config.webVitals.thresholds) {\n        const thresholds = config.webVitals.thresholds;\n\n        if (thresholds.LCP && (typeof thresholds.LCP !== 'object' || !thresholds.LCP.good || !thresholds.LCP.poor)) {\n          warnings.push('Web Vitals LCP thresholds should have good and poor values');\n        }\n\n        if (thresholds.FID && (typeof thresholds.FID !== 'object' || !thresholds.FID.good || !thresholds.FID.poor)) {\n          warnings.push('Web Vitals FID thresholds should have good and poor values');\n        }\n\n        if (thresholds.CLS && (typeof thresholds.CLS !== 'object' || !thresholds.CLS.good || !thresholds.CLS.poor)) {\n          warnings.push('Web Vitals CLS thresholds should have good and poor values');\n        }\n      }\n    }\n  }\n\n  return {\n    isValid: errors.length === 0,\n    errors,\n    warnings,\n  };\n}\n\n/**\n * Web Vitals 性能分析器\n * Web Vitals performance analyzer\n */\nexport class WebVitalsAnalyzer {\n  private vitals = new Map<string, {\n    values: number[];\n    ratings: Array<'good' | 'needs-improvement' | 'poor'>;\n    lastUpdated: number;\n  }>();\n\n  private customMetrics = new Map<string, {\n    values: number[];\n    unit: string;\n    lastUpdated: number;\n  }>();\n\n  private config: PerformanceConfig;\n\n  constructor(config: PerformanceConfig) {\n    this.config = config;\n  }\n\n  /**\n   * 记录Web Vital指标\n   * Record Web Vital metric\n   */\n  recordWebVital(name: string, value: number, rating: 'good' | 'needs-improvement' | 'poor'): void {\n    if (!this.config.webVitals?.enabled) return;\n\n    const current = this.vitals.get(name) || {\n      values: [],\n      ratings: [],\n      lastUpdated: 0,\n    };\n\n    current.values.push(value);\n    current.ratings.push(rating);\n    current.lastUpdated = Date.now();\n\n    this.vitals.set(name, current);\n\n    // 保持数组大小在合理范围内\n    if (current.values.length > 100) {\n      current.values = current.values.slice(-50);\n      current.ratings = current.ratings.slice(-50);\n    }\n  }\n\n  /**\n   * 记录自定义指标\n   * Record custom metric\n   */\n  recordCustomMetric(name: string, value: number, unit = 'ms'): void {\n    if (!this.config.webVitals?.enabled) return;\n\n    const current = this.customMetrics.get(name) || {\n      values: [],\n      unit,\n      lastUpdated: 0,\n    };\n\n    current.values.push(value);\n    current.lastUpdated = Date.now();\n\n    this.customMetrics.set(name, current);\n\n    // 保持数组大小在合理范围内\n    if (current.values.length > 100) {\n      current.values = current.values.slice(-50);\n    }\n  }\n\n  /**\n   * 获取Web Vitals报告\n   * Get Web Vitals report\n   */\n  getWebVitalsReport(): {\n    vitals: Record<string, {\n      average: number;\n      latest: number;\n      trend: 'improving' | 'stable' | 'degrading';\n      rating: 'good' | 'needs-improvement' | 'poor';\n    }>;\n    score: number;\n    recommendations: string[];\n  } {\n    const vitals: Record<string, { average: number; latest: number; score: number; grade: string }> = {};\n    let totalScore = 0;\n    let vitalCount = 0;\n\n    for (const [name, data] of this.vitals.entries()) {\n      if (data.values.length === 0) continue;\n\n      const average = data.values.reduce((sum, val) => sum + val, 0) / data.values.length;\n      const latest = data.values[data.values.length - 1];\n      const latestRating = data.ratings[data.ratings.length - 1];\n\n      // 计算趋势\n      let trend: 'improving' | 'stable' | 'degrading' = 'stable';\n      if (data.values.length >= 2) {\n        const recent = data.values.slice(-5);\n        const older = data.values.slice(-10, -5);\n        if (recent.length > 0 && older.length > 0) {\n          const recentAvg = recent.reduce((sum, val) => sum + val, 0) / recent.length;\n          const olderAvg = older.reduce((sum, val) => sum + val, 0) / older.length;\n\n          if (recentAvg < olderAvg * 0.9) trend = 'improving';\n          else if (recentAvg > olderAvg * 1.1) trend = 'degrading';\n        }\n      }\n\n      vitals[name] = {\n        average,\n        latest,\n        trend,\n        rating: latestRating,\n      };\n\n      // 计算分数\n      const ratingScore = latestRating === 'good' ? 100 : latestRating === 'needs-improvement' ? 50 : 0;\n      totalScore += ratingScore;\n      vitalCount += 1;\n    }\n\n    const score = vitalCount > 0 ? totalScore / vitalCount : 0;\n\n    // 生成建议\n    const recommendations: string[] = [];\n    for (const [name, data] of Object.entries(vitals)) {\n      if (data.rating === 'poor') {\n        recommendations.push(`${name} needs improvement (current: ${data.latest.toFixed(2)})`);\n      }\n      if (data.trend === 'degrading') {\n        recommendations.push(`${name} performance is degrading over time`);\n      }\n    }\n\n    return {\n      vitals,\n      score,\n      recommendations,\n    };\n  }\n\n  /**\n   * 重置所有数据\n   * Reset all data\n   */\n  reset(): void {\n    this.vitals.clear();\n    this.customMetrics.clear();\n  }\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/performance-monitoring-integrations-web-eval.ts","messages":[{"ruleId":"max-params","severity":2,"message":"Function has too many parameters (4). Maximum allowed is 3.","line":20,"column":26,"nodeType":"TSFunctionType","messageId":"exceed","endLine":20,"endColumn":26},{"ruleId":"no-unused-vars","severity":2,"message":"'action' is defined but never used. Allowed unused args must match /^_/u.","line":20,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":41,"suggestions":[{"messageId":"removeVar","data":{"varName":"action"},"fix":{"range":[442,457],"text":""},"desc":"Remove unused variable 'action'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'timing' is defined but never used. Allowed unused args must match /^_/u.","line":20,"column":43,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":57,"suggestions":[{"messageId":"removeVar","data":{"varName":"timing"},"fix":{"range":[456,472],"text":""},"desc":"Remove unused variable 'timing'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'success' is defined but never used. Allowed unused args must match /^_/u.","line":20,"column":59,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":75,"suggestions":[{"messageId":"removeVar","data":{"varName":"success"},"fix":{"range":[472,490],"text":""},"desc":"Remove unused variable 'success'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'details' is defined but never used. Allowed unused args must match /^_/u.","line":20,"column":77,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":110,"suggestions":[{"messageId":"removeVar","data":{"varName":"details"},"fix":{"range":[490,525],"text":""},"desc":"Remove unused variable 'details'."}]},{"ruleId":"max-params","severity":2,"message":"Function has too many parameters (5). Maximum allowed is 3.","line":21,"column":25,"nodeType":"TSFunctionType","messageId":"exceed","endLine":21,"endColumn":25},{"ruleId":"no-unused-vars","severity":2,"message":"'url' is defined but never used. Allowed unused args must match /^_/u.","line":21,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":37,"suggestions":[{"messageId":"removeVar","data":{"varName":"url"},"fix":{"range":[561,573],"text":""},"desc":"Remove unused variable 'url'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'method' is defined but never used. Allowed unused args must match /^_/u.","line":21,"column":39,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":53,"suggestions":[{"messageId":"removeVar","data":{"varName":"method"},"fix":{"range":[572,588],"text":""},"desc":"Remove unused variable 'method'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'status' is defined but never used. Allowed unused args must match /^_/u.","line":21,"column":55,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":69,"suggestions":[{"messageId":"removeVar","data":{"varName":"status"},"fix":{"range":[588,604],"text":""},"desc":"Remove unused variable 'status'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'timing' is defined but never used. Allowed unused args must match /^_/u.","line":21,"column":71,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":85,"suggestions":[{"messageId":"removeVar","data":{"varName":"timing"},"fix":{"range":[604,620],"text":""},"desc":"Remove unused variable 'timing'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'size' is defined but never used. Allowed unused args must match /^_/u.","line":21,"column":87,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":100,"suggestions":[{"messageId":"removeVar","data":{"varName":"size"},"fix":{"range":[620,635],"text":""},"desc":"Remove unused variable 'size'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'url' is defined but never used. Allowed unused args must match /^_/u.","line":22,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":31,"suggestions":[{"messageId":"removeVar","data":{"varName":"url"},"fix":{"range":[665,677],"text":""},"desc":"Remove unused variable 'url'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'timing' is defined but never used. Allowed unused args must match /^_/u.","line":22,"column":33,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":63,"suggestions":[{"messageId":"removeVar","data":{"varName":"timing"},"fix":{"range":[676,708],"text":""},"desc":"Remove unused variable 'timing'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used. Allowed unused args must match /^_/u.","line":23,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":23,"endColumn":29,"suggestions":[{"messageId":"removeVar","data":{"varName":"error"},"fix":{"range":[735,748],"text":""},"desc":"Remove unused variable 'error'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'context' is defined but never used. Allowed unused args must match /^_/u.","line":23,"column":31,"nodeType":"Identifier","messageId":"unusedVar","endLine":23,"endColumn":64,"suggestions":[{"messageId":"removeVar","data":{"varName":"context"},"fix":{"range":[747,782],"text":""},"desc":"Remove unused variable 'context'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'metric' is defined but never used. Allowed unused args must match /^_/u.","line":32,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":32,"endColumn":63,"suggestions":[{"messageId":"removeVar","data":{"varName":"metric"},"fix":{"range":[952,997],"text":""},"desc":"Remove unused variable 'metric'."}]},{"ruleId":"max-params","severity":2,"message":"Method 'recordUserInteraction' has too many parameters (4). Maximum allowed is 3.","line":37,"column":5,"nodeType":"ArrowFunctionExpression","messageId":"exceed","endLine":37,"endColumn":28},{"ruleId":"max-params","severity":2,"message":"Method 'recordNetworkRequest' has too many parameters (5). Maximum allowed is 3.","line":55,"column":5,"nodeType":"ArrowFunctionExpression","messageId":"exceed","endLine":55,"endColumn":27},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 300.","line":67,"column":48,"nodeType":"Literal","messageId":"noMagic","endLine":67,"endColumn":51},{"ruleId":"max-params","severity":2,"message":"Method 'recordInteraction' has too many parameters (4). Maximum allowed is 3.","line":200,"column":3,"nodeType":"FunctionExpression","messageId":"exceed","endLine":200,"endColumn":20},{"ruleId":"no-unused-vars","severity":2,"message":"'details' is defined but never used. Allowed unused args must match /^_/u.","line":200,"column":71,"nodeType":"Identifier","messageId":"unusedVar","endLine":200,"endColumn":104,"suggestions":[{"messageId":"removeVar","data":{"varName":"details"},"fix":{"range":[5236,5271],"text":""},"desc":"Remove unused variable 'details'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'details' is defined but never used. Allowed unused args must match /^_/u.","line":200,"column":71,"nodeType":null,"messageId":"unusedVar","endLine":200,"endColumn":78},{"ruleId":"max-params","severity":2,"message":"Method 'recordNetworkRequest' has too many parameters (5). Maximum allowed is 3.","line":228,"column":3,"nodeType":"FunctionExpression","messageId":"exceed","endLine":228,"endColumn":23},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: -500.","line":242,"column":57,"nodeType":"UnaryExpression","messageId":"noMagic","endLine":242,"endColumn":61},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: -50.","line":261,"column":45,"nodeType":"UnaryExpression","messageId":"noMagic","endLine":261,"endColumn":48},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: -50.","line":280,"column":39,"nodeType":"UnaryExpression","messageId":"noMagic","endLine":280,"endColumn":42},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 10.","line":314,"column":17,"nodeType":"Literal","messageId":"noMagic","endLine":314,"endColumn":19},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0.9.","line":326,"column":74,"nodeType":"Literal","messageId":"noMagic","endLine":326,"endColumn":77},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 300.","line":365,"column":101,"nodeType":"Literal","messageId":"noMagic","endLine":365,"endColumn":104},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 10.","line":370,"column":17,"nodeType":"Literal","messageId":"noMagic","endLine":370,"endColumn":19},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 10.","line":422,"column":17,"nodeType":"Literal","messageId":"noMagic","endLine":422,"endColumn":19}],"suppressedMessages":[],"errorCount":31,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Web Eval Agent 性能监控集成\n * Web Eval Agent Performance Monitoring Integration\n * \n * 提供与Web Eval Agent工具的集成钩子，用于监控用户交互和页面性能\n */\n\nimport type {\n  PerformanceConfig,\n  PerformanceMetrics,\n} from './performance-monitoring-types';\nimport { logger } from '@/lib/logger';\n\n/**\n * Web Eval Agent 集成钩子返回类型\n * Web Eval Agent integration hook return type\n */\nexport interface WebEvalAgentIntegration {\n  enabled: boolean;\n  recordUserInteraction: (action: string, timing: number, success: boolean, details?: Record<string, unknown>) => void;\n  recordNetworkRequest: (url: string, method: string, status: number, timing: number, size?: number) => void;\n  recordPageLoad: (url: string, timing: Record<string, number>) => void;\n  recordError: (error: Error, context?: Record<string, unknown>) => void;\n}\n\n/**\n * Web Eval Agent 集成钩子\n * Web Eval Agent integration hook\n */\nexport function useWebEvalAgentIntegration(\n  config: PerformanceConfig,\n  recordMetric: (metric: Omit<PerformanceMetrics, 'timestamp'>) => void\n): WebEvalAgentIntegration {\n  return {\n    enabled: config.webEvalAgent.enabled,\n\n    recordUserInteraction: (action: string, timing: number, success: boolean, details = {}) => {\n      if (!config.webEvalAgent.enabled) return;\n\n      recordMetric({\n        source: 'web-eval-agent',\n        type: 'user-interaction',\n        data: {\n          action,\n          timing,\n          success,\n          ...details,\n          timestamp: Date.now(),\n        },\n        tags: ['web-eval-agent', 'user-interaction'],\n        priority: success ? 'medium' : 'high',\n      });\n    },\n\n    recordNetworkRequest: (url: string, method: string, status: number, timing: number, size = 0) => {\n      if (!config.webEvalAgent.enabled || !config.webEvalAgent.captureNetwork) return;\n\n      recordMetric({\n        source: 'web-eval-agent',\n        type: 'network',\n        data: {\n          url,\n          method,\n          status,\n          timing,\n          size,\n          isSuccess: status >= 200 && status < 300,\n          timestamp: Date.now(),\n        },\n        tags: ['web-eval-agent', 'network-request'],\n        priority: timing > 1000 ? 'high' : 'medium',\n      });\n    },\n\n    recordPageLoad: (url: string, timing: Record<string, number>) => {\n      if (!config.webEvalAgent.enabled) return;\n\n      recordMetric({\n        source: 'web-eval-agent',\n        type: 'page',\n        data: {\n          url,\n          ...timing,\n          timestamp: Date.now(),\n        },\n        tags: ['web-eval-agent', 'page-load'],\n        priority: 'medium',\n      });\n    },\n\n    recordError: (error: Error, context = {}) => {\n      if (!config.webEvalAgent.enabled || !config.webEvalAgent.captureLogs) return;\n\n      recordMetric({\n        source: 'web-eval-agent',\n        type: 'user-interaction',\n        data: {\n          error: {\n            name: error.name,\n            message: error.message,\n            stack: error.stack,\n          },\n          context,\n          timestamp: Date.now(),\n        },\n        tags: ['web-eval-agent', 'error'],\n        priority: 'critical',\n      });\n    },\n  };\n}\n\n/**\n * Web Eval Agent 配置验证\n * Web Eval Agent configuration validation\n */\nexport function validateWebEvalAgentConfig(config: PerformanceConfig): {\n  isValid: boolean;\n  errors: string[];\n  warnings: string[];\n} {\n  const errors: string[] = [];\n  const warnings: string[] = [];\n\n  if (!config.webEvalAgent) {\n    errors.push('Web Eval Agent configuration is missing');\n    return { isValid: false, errors, warnings };\n  }\n\n  if (typeof config.webEvalAgent.enabled !== 'boolean') {\n    errors.push('Web Eval Agent enabled must be a boolean');\n  }\n\n  if (config.webEvalAgent.enabled) {\n    if (typeof config.webEvalAgent.captureNetwork !== 'boolean') {\n      warnings.push('Web Eval Agent captureNetwork should be a boolean');\n    }\n\n    if (typeof config.webEvalAgent.captureLogs !== 'boolean') {\n      warnings.push('Web Eval Agent captureLogs should be a boolean');\n    }\n\n    if (config.webEvalAgent.maxInteractionsPerSession && \n        (typeof config.webEvalAgent.maxInteractionsPerSession !== 'number' || \n         config.webEvalAgent.maxInteractionsPerSession <= 0)) {\n      warnings.push('Web Eval Agent maxInteractionsPerSession should be a positive number');\n    }\n  }\n\n  return {\n    isValid: errors.length === 0,\n    errors,\n    warnings,\n  };\n}\n\n/**\n * Web Eval Agent 性能分析器\n * Web Eval Agent performance analyzer\n */\nexport class WebEvalAgentAnalyzer {\n  private interactions = new Map<string, {\n    count: number;\n    totalTime: number;\n    successCount: number;\n    lastInteraction: number;\n  }>();\n\n  private networkRequests: Array<{\n    url: string;\n    method: string;\n    status: number;\n    timing: number;\n    size: number;\n    timestamp: number;\n  }> = [];\n\n  private pageLoads: Array<{\n    url: string;\n    timing: Record<string, number>;\n    timestamp: number;\n  }> = [];\n\n  private errors: Array<{\n    error: Error;\n    context: Record<string, unknown>;\n    timestamp: number;\n  }> = [];\n\n  private config: PerformanceConfig;\n\n  constructor(config: PerformanceConfig) {\n    this.config = config;\n  }\n\n  /**\n   * 记录用户交互\n   * Record user interaction\n   */\n  recordInteraction(action: string, timing: number, success: boolean, details?: Record<string, unknown>): void {\n    if (!this.config.webEvalAgent.enabled) return;\n\n    const current = this.interactions.get(action) || {\n      count: 0,\n      totalTime: 0,\n      successCount: 0,\n      lastInteraction: 0,\n    };\n\n    current.count += 1;\n    current.totalTime += timing;\n    if (success) current.successCount += 1;\n    current.lastInteraction = Date.now();\n\n    this.interactions.set(action, current);\n\n    // 检查是否超过会话限制\n    const maxInteractions = this.config.webEvalAgent.maxInteractionsPerSession || 1000;\n    if (current.count > maxInteractions) {\n      logger.warn(`Interaction ${action} has exceeded session limit`, { maxInteractions });\n    }\n  }\n\n  /**\n   * 记录网络请求\n   * Record network request\n   */\n  recordNetworkRequest(url: string, method: string, status: number, timing: number, size = 0): void {\n    if (!this.config.webEvalAgent.enabled || !this.config.webEvalAgent.captureNetwork) return;\n\n    this.networkRequests.push({\n      url,\n      method,\n      status,\n      timing,\n      size,\n      timestamp: Date.now(),\n    });\n\n    // 保持数组大小在合理范围内\n    if (this.networkRequests.length > 1000) {\n      this.networkRequests = this.networkRequests.slice(-500);\n    }\n  }\n\n  /**\n   * 记录页面加载\n   * Record page load\n   */\n  recordPageLoad(url: string, timing: Record<string, number>): void {\n    if (!this.config.webEvalAgent.enabled) return;\n\n    this.pageLoads.push({\n      url,\n      timing,\n      timestamp: Date.now(),\n    });\n\n    // 保持数组大小在合理范围内\n    if (this.pageLoads.length > 100) {\n      this.pageLoads = this.pageLoads.slice(-50);\n    }\n  }\n\n  /**\n   * 记录错误\n   * Record error\n   */\n  recordError(error: Error, context: Record<string, unknown> = {}): void {\n    if (!this.config.webEvalAgent.enabled || !this.config.webEvalAgent.captureLogs) return;\n\n    this.errors.push({\n      error,\n      context,\n      timestamp: Date.now(),\n    });\n\n    // 保持数组大小在合理范围内\n    if (this.errors.length > 100) {\n      this.errors = this.errors.slice(-50);\n    }\n  }\n\n  /**\n   * 获取用户交互报告\n   * Get user interaction report\n   */\n  getInteractionReport(): {\n    totalInteractions: number;\n    uniqueActions: number;\n    averageResponseTime: number;\n    successRate: number;\n    topSlowActions: Array<{\n      action: string;\n      averageTime: number;\n      count: number;\n      successRate: number;\n    }>;\n    recommendations: string[];\n  } {\n    const interactions = Array.from(this.interactions.entries());\n    const totalInteractions = interactions.reduce((sum, [, metrics]) => sum + metrics.count, 0);\n    const totalTime = interactions.reduce((sum, [, metrics]) => sum + metrics.totalTime, 0);\n    const totalSuccesses = interactions.reduce((sum, [, metrics]) => sum + metrics.successCount, 0);\n\n    const topSlowActions = interactions\n      .map(([action, metrics]) => ({\n        action,\n        averageTime: metrics.totalTime / metrics.count,\n        count: metrics.count,\n        successRate: metrics.successCount / metrics.count,\n      }))\n      .sort((a, b) => b.averageTime - a.averageTime)\n      .slice(0, 10);\n\n    const recommendations: string[] = [];\n\n    // 生成建议\n    if (topSlowActions.length > 0) {\n      const slowestAction = topSlowActions[0];\n      if (slowestAction.averageTime > 1000) {\n        recommendations.push(`Action \"${slowestAction.action}\" is slow (${slowestAction.averageTime.toFixed(0)}ms average)`);\n      }\n    }\n\n    const lowSuccessActions = topSlowActions.filter(a => a.successRate < 0.9);\n    if (lowSuccessActions.length > 0) {\n      recommendations.push(`${lowSuccessActions.length} actions have low success rates. Consider improving error handling.`);\n    }\n\n    return {\n      totalInteractions,\n      uniqueActions: interactions.length,\n      averageResponseTime: totalTime / totalInteractions || 0,\n      successRate: totalSuccesses / totalInteractions || 0,\n      topSlowActions,\n      recommendations,\n    };\n  }\n\n  /**\n   * 获取网络性能报告\n   * Get network performance report\n   */\n  getNetworkReport(): {\n    totalRequests: number;\n    averageResponseTime: number;\n    successRate: number;\n    totalDataTransferred: number;\n    slowestRequests: Array<{\n      url: string;\n      method: string;\n      timing: number;\n      status: number;\n    }>;\n    errorRequests: Array<{\n      url: string;\n      method: string;\n      status: number;\n      timing: number;\n    }>;\n  } {\n    const totalRequests = this.networkRequests.length;\n    const totalTime = this.networkRequests.reduce((sum, req) => sum + req.timing, 0);\n    const successfulRequests = this.networkRequests.filter(req => req.status >= 200 && req.status < 300);\n    const totalDataTransferred = this.networkRequests.reduce((sum, req) => sum + req.size, 0);\n\n    const slowestRequests = [...this.networkRequests]\n      .sort((a, b) => b.timing - a.timing)\n      .slice(0, 10)\n      .map(req => ({\n        url: req.url,\n        method: req.method,\n        timing: req.timing,\n        status: req.status,\n      }));\n\n    const errorRequests = this.networkRequests\n      .filter(req => req.status >= 400)\n      .map(req => ({\n        url: req.url,\n        method: req.method,\n        status: req.status,\n        timing: req.timing,\n      }));\n\n    return {\n      totalRequests,\n      averageResponseTime: totalTime / totalRequests || 0,\n      successRate: successfulRequests.length / totalRequests || 0,\n      totalDataTransferred,\n      slowestRequests,\n      errorRequests,\n    };\n  }\n\n  /**\n   * 获取页面加载报告\n   * Get page load report\n   */\n  getPageLoadReport(): {\n    totalPageLoads: number;\n    averageLoadTime: number;\n    slowestPages: Array<{\n      url: string;\n      loadTime: number;\n      timestamp: number;\n    }>;\n  } {\n    const totalPageLoads = this.pageLoads.length;\n    const totalLoadTime = this.pageLoads.reduce((sum, page) => {\n      return sum + (page.timing.loadComplete || page.timing.domContentLoaded || 0);\n    }, 0);\n\n    const slowestPages = this.pageLoads\n      .map(page => ({\n        url: page.url,\n        loadTime: page.timing.loadComplete || page.timing.domContentLoaded || 0,\n        timestamp: page.timestamp,\n      }))\n      .sort((a, b) => b.loadTime - a.loadTime)\n      .slice(0, 10);\n\n    return {\n      totalPageLoads,\n      averageLoadTime: totalLoadTime / totalPageLoads || 0,\n      slowestPages,\n    };\n  }\n\n  /**\n   * 重置所有数据\n   * Reset all data\n   */\n  reset(): void {\n    this.interactions.clear();\n    this.networkRequests.length = 0;\n    this.pageLoads.length = 0;\n    this.errors.length = 0;\n  }\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/performance-monitoring-integrations.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'PerformanceConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":16,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":20,"suggestions":[{"messageId":"removeVar","data":{"varName":"PerformanceConfig"},"fix":{"range":[414,432],"text":""},"desc":"Remove unused variable 'PerformanceConfig'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'PerformanceConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":16,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":16,"endColumn":20},{"ruleId":"no-unused-vars","severity":2,"message":"'PerformanceMetrics' is defined but never used. Allowed unused vars must match /^_/u.","line":17,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"PerformanceMetrics"},"fix":{"range":[431,453],"text":""},"desc":"Remove unused variable 'PerformanceMetrics'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'PerformanceMetrics' is defined but never used. Allowed unused vars must match /^_/u.","line":17,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":17,"endColumn":21},{"ruleId":"no-duplicate-imports","severity":2,"message":"'./performance-monitoring-integrations-react-scan' import is duplicated.","line":24,"column":1,"nodeType":"ImportDeclaration","messageId":"import","endLine":29,"endColumn":59},{"ruleId":"no-unused-vars","severity":2,"message":"'useReactScanIntegration' is defined but never used. Allowed unused vars must match /^_/u.","line":25,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":25,"endColumn":26,"suggestions":[{"messageId":"removeVar","data":{"varName":"useReactScanIntegration"},"fix":{"range":[606,630],"text":""},"desc":"Remove unused variable 'useReactScanIntegration'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'useReactScanIntegration' is defined but never used. Allowed unused vars must match /^_/u.","line":25,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":25,"endColumn":26},{"ruleId":"no-unused-vars","severity":2,"message":"'validateReactScanConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":26,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":26,"endColumn":26,"suggestions":[{"messageId":"removeVar","data":{"varName":"validateReactScanConfig"},"fix":{"range":[629,656],"text":""},"desc":"Remove unused variable 'validateReactScanConfig'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'validateReactScanConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":26,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":26,"endColumn":26},{"ruleId":"no-unused-vars","severity":2,"message":"'ReactScanAnalyzer' is defined but never used. Allowed unused vars must match /^_/u.","line":27,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":27,"endColumn":20,"suggestions":[{"messageId":"removeVar","data":{"varName":"ReactScanAnalyzer"},"fix":{"range":[656,677],"text":""},"desc":"Remove unused variable 'ReactScanAnalyzer'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ReactScanAnalyzer' is defined but never used. Allowed unused vars must match /^_/u.","line":27,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":27,"endColumn":20},{"ruleId":"no-unused-vars","severity":2,"message":"'ReactScanUtils' is defined but never used. Allowed unused vars must match /^_/u.","line":28,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":28,"endColumn":17,"suggestions":[{"messageId":"removeVar","data":{"varName":"ReactScanUtils"},"fix":{"range":[677,695],"text":""},"desc":"Remove unused variable 'ReactScanUtils'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ReactScanUtils' is defined but never used. Allowed unused vars must match /^_/u.","line":28,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":28,"endColumn":17},{"ruleId":"no-duplicate-imports","severity":2,"message":"'./performance-monitoring-integrations-web-eval' import is duplicated.","line":35,"column":1,"nodeType":"ImportDeclaration","messageId":"import","endLine":39,"endColumn":57},{"ruleId":"no-unused-vars","severity":2,"message":"'useWebEvalAgentIntegration' is defined but never used. Allowed unused vars must match /^_/u.","line":36,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":36,"endColumn":29,"suggestions":[{"messageId":"removeVar","data":{"varName":"useWebEvalAgentIntegration"},"fix":{"range":[867,894],"text":""},"desc":"Remove unused variable 'useWebEvalAgentIntegration'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'useWebEvalAgentIntegration' is defined but never used. Allowed unused vars must match /^_/u.","line":36,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":36,"endColumn":29},{"ruleId":"no-unused-vars","severity":2,"message":"'validateWebEvalAgentConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":37,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":37,"endColumn":29,"suggestions":[{"messageId":"removeVar","data":{"varName":"validateWebEvalAgentConfig"},"fix":{"range":[893,923],"text":""},"desc":"Remove unused variable 'validateWebEvalAgentConfig'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'validateWebEvalAgentConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":37,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":37,"endColumn":29},{"ruleId":"no-unused-vars","severity":2,"message":"'WebEvalAgentAnalyzer' is defined but never used. Allowed unused vars must match /^_/u.","line":38,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":38,"endColumn":23,"suggestions":[{"messageId":"removeVar","data":{"varName":"WebEvalAgentAnalyzer"},"fix":{"range":[923,947],"text":""},"desc":"Remove unused variable 'WebEvalAgentAnalyzer'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'WebEvalAgentAnalyzer' is defined but never used. Allowed unused vars must match /^_/u.","line":38,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":38,"endColumn":23},{"ruleId":"no-duplicate-imports","severity":2,"message":"'./performance-monitoring-integrations-bundle' import is duplicated.","line":45,"column":1,"nodeType":"ImportDeclaration","messageId":"import","endLine":50,"endColumn":55},{"ruleId":"no-unused-vars","severity":2,"message":"'useBundleAnalyzerIntegration' is defined but never used. Allowed unused vars must match /^_/u.","line":46,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":46,"endColumn":31,"suggestions":[{"messageId":"removeVar","data":{"varName":"useBundleAnalyzerIntegration"},"fix":{"range":[1117,1146],"text":""},"desc":"Remove unused variable 'useBundleAnalyzerIntegration'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'useBundleAnalyzerIntegration' is defined but never used. Allowed unused vars must match /^_/u.","line":46,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":46,"endColumn":31},{"ruleId":"no-unused-vars","severity":2,"message":"'validateBundleAnalyzerConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":47,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":47,"endColumn":31,"suggestions":[{"messageId":"removeVar","data":{"varName":"validateBundleAnalyzerConfig"},"fix":{"range":[1145,1177],"text":""},"desc":"Remove unused variable 'validateBundleAnalyzerConfig'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'validateBundleAnalyzerConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":47,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":47,"endColumn":31},{"ruleId":"no-unused-vars","severity":2,"message":"'BundleAnalyzerAnalyzer' is defined but never used. Allowed unused vars must match /^_/u.","line":48,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":48,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"BundleAnalyzerAnalyzer"},"fix":{"range":[1177,1203],"text":""},"desc":"Remove unused variable 'BundleAnalyzerAnalyzer'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'BundleAnalyzerAnalyzer' is defined but never used. Allowed unused vars must match /^_/u.","line":48,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":48,"endColumn":25},{"ruleId":"no-unused-vars","severity":2,"message":"'BundleAnalyzerUtils' is defined but never used. Allowed unused vars must match /^_/u.","line":49,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":49,"endColumn":22,"suggestions":[{"messageId":"removeVar","data":{"varName":"BundleAnalyzerUtils"},"fix":{"range":[1203,1226],"text":""},"desc":"Remove unused variable 'BundleAnalyzerUtils'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'BundleAnalyzerUtils' is defined but never used. Allowed unused vars must match /^_/u.","line":49,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":49,"endColumn":22},{"ruleId":"no-duplicate-imports","severity":2,"message":"'./performance-monitoring-integrations-vitals' import is duplicated.","line":57,"column":1,"nodeType":"ImportDeclaration","messageId":"import","endLine":63,"endColumn":55},{"ruleId":"no-unused-vars","severity":2,"message":"'useWebVitalsIntegration' is defined but never used. Allowed unused vars must match /^_/u.","line":58,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":58,"endColumn":26,"suggestions":[{"messageId":"removeVar","data":{"varName":"useWebVitalsIntegration"},"fix":{"range":[1423,1447],"text":""},"desc":"Remove unused variable 'useWebVitalsIntegration'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'useWebVitalsIntegration' is defined but never used. Allowed unused vars must match /^_/u.","line":58,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":58,"endColumn":26},{"ruleId":"no-unused-vars","severity":2,"message":"'checkEnvironmentCompatibility' is defined but never used. Allowed unused vars must match /^_/u.","line":59,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":59,"endColumn":32,"suggestions":[{"messageId":"removeVar","data":{"varName":"checkEnvironmentCompatibility"},"fix":{"range":[1446,1479],"text":""},"desc":"Remove unused variable 'checkEnvironmentCompatibility'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'checkEnvironmentCompatibility' is defined but never used. Allowed unused vars must match /^_/u.","line":59,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":59,"endColumn":32},{"ruleId":"no-unused-vars","severity":2,"message":"'performHealthCheck' is defined but never used. Allowed unused vars must match /^_/u.","line":60,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":60,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"performHealthCheck"},"fix":{"range":[1479,1501],"text":""},"desc":"Remove unused variable 'performHealthCheck'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'performHealthCheck' is defined but never used. Allowed unused vars must match /^_/u.","line":60,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":60,"endColumn":21},{"ruleId":"no-unused-vars","severity":2,"message":"'validateWebVitalsConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":61,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":61,"endColumn":26,"suggestions":[{"messageId":"removeVar","data":{"varName":"validateWebVitalsConfig"},"fix":{"range":[1501,1528],"text":""},"desc":"Remove unused variable 'validateWebVitalsConfig'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'validateWebVitalsConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":61,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":61,"endColumn":26},{"ruleId":"no-unused-vars","severity":2,"message":"'WebVitalsAnalyzer' is defined but never used. Allowed unused vars must match /^_/u.","line":62,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":62,"endColumn":20,"suggestions":[{"messageId":"removeVar","data":{"varName":"WebVitalsAnalyzer"},"fix":{"range":[1528,1549],"text":""},"desc":"Remove unused variable 'WebVitalsAnalyzer'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'WebVitalsAnalyzer' is defined but never used. Allowed unused vars must match /^_/u.","line":62,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":62,"endColumn":20}],"suppressedMessages":[],"errorCount":40,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 性能监控集成钩子和工具 - 主入口\n * Performance Monitoring Integrations - Main Entry Point\n *\n * 统一的性能监控集成入口，整合所有集成模块\n */\n\n// 重新导出所有模块的功能\nexport * from './performance-monitoring-integrations-react-scan';\nexport * from './performance-monitoring-integrations-web-eval';\nexport * from './performance-monitoring-integrations-bundle';\nexport * from './performance-monitoring-integrations-vitals';\n\n// 向后兼容的重新导出\nimport type {\n  PerformanceConfig,\n  PerformanceMetrics,\n} from './performance-monitoring-types';\n\nimport type {\n  ReactScanIntegration,\n} from './performance-monitoring-integrations-react-scan';\n\nimport {\n  useReactScanIntegration,\n  validateReactScanConfig,\n  ReactScanAnalyzer,\n  ReactScanUtils,\n} from './performance-monitoring-integrations-react-scan';\n\nimport type {\n  WebEvalAgentIntegration,\n} from './performance-monitoring-integrations-web-eval';\n\nimport {\n  useWebEvalAgentIntegration,\n  validateWebEvalAgentConfig,\n  WebEvalAgentAnalyzer,\n} from './performance-monitoring-integrations-web-eval';\n\nimport type {\n  BundleAnalyzerIntegration,\n} from './performance-monitoring-integrations-bundle';\n\nimport {\n  useBundleAnalyzerIntegration,\n  validateBundleAnalyzerConfig,\n  BundleAnalyzerAnalyzer,\n  BundleAnalyzerUtils,\n} from './performance-monitoring-integrations-bundle';\n\nimport type {\n  WebVitalsIntegration,\n  EnvironmentCompatibilityResult,\n} from './performance-monitoring-integrations-vitals';\n\nimport {\n  useWebVitalsIntegration,\n  checkEnvironmentCompatibility,\n  performHealthCheck,\n  validateWebVitalsConfig,\n  WebVitalsAnalyzer,\n} from './performance-monitoring-integrations-vitals';\n\n// ==================== 向后兼容的类型别名 ====================\n\n/**\n * 向后兼容的类型别名\n * Backward compatible type aliases\n */\nexport type {\n  // React Scan 集成\n  ReactScanIntegration as ReactScan,\n\n  // Web Eval Agent 集成\n  WebEvalAgentIntegration as WebEvalAgent,\n\n  // Bundle Analyzer 集成\n  BundleAnalyzerIntegration as BundleAnalyzer,\n\n  // Web Vitals 集成\n  WebVitalsIntegration as WebVitals,\n\n  // 环境检查\n  EnvironmentCompatibilityResult as EnvironmentCheck,\n};\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/performance-monitoring-types.ts","messages":[{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0.1.","line":289,"column":34,"nodeType":"Literal","messageId":"noMagic","endLine":289,"endColumn":37},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 5.","line":294,"column":26,"nodeType":"Literal","messageId":"noMagic","endLine":294,"endColumn":27},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 60.","line":294,"column":30,"nodeType":"Literal","messageId":"noMagic","endLine":294,"endColumn":32},{"ruleId":"complexity","severity":2,"message":"Function 'validateConfig' has a complexity of 16. Maximum allowed is 15.","line":307,"column":8,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":356,"endColumn":2}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 性能监控类型定义和配置\n * \n * 包含性能监控相关的接口定义、配置类型和环境配置逻辑\n */\n\nimport { PERFORMANCE_CONSTANTS } from '@/constants/performance';\n\n// ==================== 基础类型定义 ====================\n\n/**\n * 性能指标数据源类型\n * Performance metrics source types\n */\nexport type PerformanceMetricSource = \n  | 'react-scan'\n  | 'web-eval-agent'\n  | 'bundle-analyzer'\n  | 'size-limit'\n  | 'custom'\n  | 'web-vitals'\n  | 'lighthouse'\n  | 'user-timing';\n\n/**\n * 性能指标类型\n * Performance metrics types\n */\nexport type PerformanceMetricType = \n  | 'component'\n  | 'page'\n  | 'bundle'\n  | 'network'\n  | 'user-interaction'\n  | 'memory'\n  | 'cpu'\n  | 'rendering'\n  | 'loading';\n\n/**\n * 性能指标接口\n * Performance metrics interface\n */\nexport interface PerformanceMetrics {\n  /** 时间戳 */\n  timestamp: number;\n  /** 数据源 */\n  source: PerformanceMetricSource;\n  /** 指标类型 */\n  type: PerformanceMetricType;\n  /** 指标数据 */\n  data: Record<string, unknown>;\n  /** 指标ID (可选) */\n  id?: string;\n  /** 指标标签 (可选) */\n  tags?: string[];\n  /** 指标优先级 (可选) */\n  priority?: 'low' | 'medium' | 'high' | 'critical';\n}\n\n// ==================== 配置接口定义 ====================\n\n/**\n * React Scan 配置\n * React Scan configuration\n */\nexport interface ReactScanConfig {\n  /** 是否启用 */\n  enabled: boolean;\n  /** 是否显示工具栏 */\n  showToolbar: boolean;\n  /** 是否跟踪不必要的渲染 */\n  trackUnnecessaryRenders: boolean;\n  /** 是否显示渲染时间 */\n  showRenderTime?: boolean;\n  /** 是否显示组件名称 */\n  showComponentNames?: boolean;\n  /** 最大跟踪组件数量 */\n  maxTrackedComponents?: number;\n}\n\n/**\n * Web Eval Agent 配置\n * Web Eval Agent configuration\n */\nexport interface WebEvalAgentConfig {\n  /** 是否启用 */\n  enabled: boolean;\n  /** 是否捕获网络请求 */\n  captureNetwork: boolean;\n  /** 是否捕获日志 */\n  captureLogs: boolean;\n  /** 是否捕获截图 */\n  captureScreenshots?: boolean;\n  /** 是否捕获性能指标 */\n  capturePerformance?: boolean;\n  /** 测试超时时间 (毫秒) */\n  timeout?: number;\n}\n\n/**\n * Bundle Analyzer 配置\n * Bundle Analyzer configuration\n */\nexport interface BundleAnalyzerConfig {\n  /** 是否启用 */\n  enabled: boolean;\n  /** 是否自动打开分析器 */\n  openAnalyzer: boolean;\n  /** 分析器端口 */\n  port?: number;\n  /** 是否生成静态报告 */\n  generateStaticReport?: boolean;\n  /** 报告输出目录 */\n  reportDir?: string;\n}\n\n/**\n * Size Limit 配置\n * Size Limit configuration\n */\nexport interface SizeLimitConfig {\n  /** 是否启用 */\n  enabled: boolean;\n  /** 大小限制 (字节) */\n  limits: Record<string, number>;\n  /** 是否启用 gzip 压缩检查 */\n  gzip?: boolean;\n  /** 是否启用 brotli 压缩检查 */\n  brotli?: boolean;\n  /** 警告阈值 (百分比) */\n  warningThreshold?: number;\n}\n\n/**\n * Web Vitals 配置\n * Web Vitals configuration\n */\nexport interface WebVitalsConfig {\n  /** 是否启用 */\n  enabled: boolean;\n  /** 是否上报到分析服务 */\n  reportToAnalytics: boolean;\n  /** 采样率 (0-1) */\n  sampleRate?: number;\n  /** 是否在控制台输出 */\n  debug?: boolean;\n}\n\n/**\n * 性能监控总配置\n * Performance monitoring configuration\n */\nexport interface PerformanceConfig {\n  /** React Scan 配置 */\n  reactScan: ReactScanConfig;\n  /** Web Eval Agent 配置 */\n  webEvalAgent: WebEvalAgentConfig;\n  /** Bundle Analyzer 配置 */\n  bundleAnalyzer: BundleAnalyzerConfig;\n  /** Size Limit 配置 */\n  sizeLimit: SizeLimitConfig;\n  /** Web Vitals 配置 */\n  webVitals?: WebVitalsConfig;\n  /** 全局配置 */\n  global?: {\n    /** 是否启用性能监控 */\n    enabled: boolean;\n    /** 数据保留时间 (毫秒) */\n    dataRetentionTime: number;\n    /** 最大指标数量 */\n    maxMetrics: number;\n    /** 是否在生产环境启用 */\n    enableInProduction: boolean;\n  };\n}\n\n// ==================== 环境检测和配置生成 ====================\n\n/**\n * 环境类型\n * Environment types\n */\nexport type Environment = 'development' | 'production' | 'test' | 'staging';\n\n/**\n * 获取当前环境\n * Get current environment\n */\nexport function getCurrentEnvironment(): Environment {\n  if (process.env.NODE_ENV === 'test' || process.env.PLAYWRIGHT_TEST === 'true') {\n    return 'test';\n  }\n  if (process.env.NODE_ENV === 'production') {\n    return 'production';\n  }\n  if (process.env.NODE_ENV === 'development') {\n    return 'development';\n  }\n  if (process.env.VERCEL_ENV === 'preview' || process.env.NODE_ENV === 'staging') {\n    return 'staging';\n  }\n  return 'development';\n}\n\n/**\n * 检查是否为测试环境\n * Check if in test environment\n */\nexport function isTestEnvironment(): boolean {\n  return getCurrentEnvironment() === 'test';\n}\n\n/**\n * 检查是否为开发环境\n * Check if in development environment\n */\nexport function isDevelopmentEnvironment(): boolean {\n  return getCurrentEnvironment() === 'development';\n}\n\n/**\n * 检查是否为生产环境\n * Check if in production environment\n */\nexport function isProductionEnvironment(): boolean {\n  return getCurrentEnvironment() === 'production';\n}\n\n/**\n * 根据环境生成默认配置\n * Generate default configuration based on environment\n */\nexport function generateEnvironmentConfig(): PerformanceConfig {\n  const environment = getCurrentEnvironment();\n  const isProduction = environment === 'production';\n  const isTest = environment === 'test';\n  const isDevelopment = environment === 'development';\n\n  return {\n    reactScan: {\n      enabled: \n        isDevelopment &&\n        !isTest &&\n        process.env.NEXT_PUBLIC_DISABLE_REACT_SCAN !== 'true',\n      showToolbar: isDevelopment && !isTest,\n      trackUnnecessaryRenders: isDevelopment,\n      showRenderTime: isDevelopment,\n      showComponentNames: isDevelopment,\n      maxTrackedComponents: 100,\n    },\n    webEvalAgent: {\n      enabled: \n        isTest || \n        process.env.NEXT_PUBLIC_ENABLE_WEB_EVAL_AGENT === 'true',\n      captureNetwork: true,\n      captureLogs: true,\n      captureScreenshots: isTest,\n      capturePerformance: true,\n      timeout: 30000,\n    },\n    bundleAnalyzer: {\n      enabled: process.env.ANALYZE === 'true',\n      openAnalyzer: !isProduction,\n      port: 8888,\n      generateStaticReport: isProduction,\n      reportDir: './bundle-analysis',\n    },\n    sizeLimit: {\n      enabled: true,\n      limits: {\n        main: \n          PERFORMANCE_CONSTANTS.BUNDLE_LIMITS.MAIN_BUNDLE *\n          PERFORMANCE_CONSTANTS.BUNDLE_LIMITS.KB_TO_BYTES,\n        framework:\n          PERFORMANCE_CONSTANTS.BUNDLE_LIMITS.FRAMEWORK_BUNDLE *\n          PERFORMANCE_CONSTANTS.BUNDLE_LIMITS.KB_TO_BYTES,\n        css:\n          PERFORMANCE_CONSTANTS.BUNDLE_LIMITS.CSS_BUNDLE *\n          PERFORMANCE_CONSTANTS.BUNDLE_LIMITS.KB_TO_BYTES,\n      },\n      gzip: true,\n      brotli: true,\n      warningThreshold: 0.9, // 90%\n    },\n    webVitals: {\n      enabled: true,\n      reportToAnalytics: isProduction,\n      sampleRate: isProduction ? 0.1 : 1.0, // 生产环境10%采样\n      debug: isDevelopment,\n    },\n    global: {\n      enabled: true,\n      dataRetentionTime: 5 * 60 * 1000, // 5分钟\n      maxMetrics: 1000,\n      enableInProduction: false,\n    },\n  };\n}\n\n// ==================== 配置验证 ====================\n\n/**\n * 验证配置的有效性\n * Validate configuration\n */\nexport function validateConfig(config: PerformanceConfig): {\n  isValid: boolean;\n  errors: string[];\n  warnings: string[];\n} {\n  const errors: string[] = [];\n  const warnings: string[] = [];\n\n  // 验证 Size Limit 配置\n  if (config.sizeLimit.enabled) {\n    Object.entries(config.sizeLimit.limits).forEach(([key, limit]) => {\n      if (typeof limit !== 'number' || limit <= 0) {\n        errors.push(`Size limit for \"${key}\" must be a positive number`);\n      }\n    });\n  }\n\n  // 验证 Web Vitals 配置\n  if (config.webVitals?.enabled) {\n    if (config.webVitals.sampleRate && \n        (config.webVitals.sampleRate < 0 || config.webVitals.sampleRate > 1)) {\n      errors.push('Web Vitals sample rate must be between 0 and 1');\n    }\n  }\n\n  // 验证全局配置\n  if (config.global?.enabled) {\n    if (config.global.dataRetentionTime <= 0) {\n      errors.push('Data retention time must be positive');\n    }\n    if (config.global.maxMetrics <= 0) {\n      errors.push('Max metrics must be positive');\n    }\n  }\n\n  // 生成警告\n  if (config.reactScan.enabled && isProductionEnvironment()) {\n    warnings.push('React Scan is enabled in production environment');\n  }\n\n  if (config.bundleAnalyzer.enabled && config.bundleAnalyzer.openAnalyzer && isProductionEnvironment()) {\n    warnings.push('Bundle analyzer auto-open is enabled in production');\n  }\n\n  return {\n    isValid: errors.length === 0,\n    errors,\n    warnings,\n  };\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/react-scan-config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/resend-core.ts","messages":[{"ruleId":"require-await","severity":2,"message":"Async method 'checkConnection' has no 'await' expression.","line":199,"column":3,"nodeType":"FunctionExpression","messageId":"missingAwait","endLine":199,"endColumn":31,"suggestions":[{"messageId":"removeAsync","fix":{"range":[5368,5374],"text":""},"desc":"Remove 'async'."}]},{"ruleId":"no-unreachable","severity":2,"message":"Unreachable code.","line":208,"column":13,"nodeType":"BlockStatement","messageId":"unreachableCode","endLine":210,"endColumn":6}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Resend邮件服务核心类\n * Resend email service core class\n */\n\nimport { Resend } from 'resend';\nimport { env } from '@/../env.mjs';\nimport { logger } from './logger';\nimport { EmailTemplateData } from './validations';\nimport { ResendUtils, EMAIL_CONFIG } from './resend-utils';\nimport { ResendTemplates } from './resend-templates';\n\n/**\n * Resend邮件服务配置\n * Resend email service configuration\n */\nexport class ResendService {\n  private resend: Resend | null = null;\n  private isConfigured: boolean = false;\n  private emailConfig: {\n    from: string;\n    replyTo: string;\n    supportEmail: string;\n  };\n\n  constructor() {\n    this.emailConfig = {\n      from: env.EMAIL_FROM || EMAIL_CONFIG.from,\n      replyTo: env.EMAIL_REPLY_TO || EMAIL_CONFIG.replyTo,\n      supportEmail: env.EMAIL_REPLY_TO || EMAIL_CONFIG.supportEmail,\n    };\n\n    this.initializeResend();\n  }\n\n  /**\n   * 初始化Resend服务\n   * Initialize Resend service\n   */\n  private initializeResend(): void {\n    try {\n      if (!env.RESEND_API_KEY) {\n        logger.warn('Resend API key missing - email service will be disabled');\n        return;\n      }\n\n      this.resend = new Resend(env.RESEND_API_KEY);\n      this.isConfigured = true;\n\n      logger.info('Resend email service initialized successfully', {\n        from: this.emailConfig.from,\n        replyTo: this.emailConfig.replyTo,\n      });\n    } catch (error) {\n      logger.error('Failed to initialize Resend service', {\n        error: error instanceof Error ? error.message : 'Unknown error',\n      });\n    }\n  }\n\n  /**\n   * 检查服务是否已配置\n   * Check if service is configured\n   */\n  public isReady(): boolean {\n    return this.isConfigured && this.resend !== null;\n  }\n\n  /**\n   * 发送联系表单邮件给管理员\n   * Send contact form email to admin\n   */\n  public async sendContactFormEmail(data: EmailTemplateData): Promise<string> {\n    if (!this.isReady()) {\n      throw new Error('Resend service is not configured');\n    }\n\n    try {\n      // 验证和清理邮件数据\n      const validatedData = ResendUtils.validateEmailData(data);\n      const sanitizedData = ResendUtils.sanitizeEmailData(validatedData);\n\n      // 构建邮件内容\n      const subject = ResendUtils.generateContactSubject(sanitizedData);\n      const htmlContent = ResendTemplates.generateContactEmailHtml(sanitizedData);\n      const textContent = ResendTemplates.generateContactEmailText(sanitizedData);\n\n      // 发送邮件\n      const result = await this.resend!.emails.send({\n        from: this.emailConfig.from,\n        to: [this.emailConfig.replyTo],\n        replyTo: sanitizedData.email,\n        subject,\n        html: htmlContent,\n        text: textContent,\n        tags: ResendUtils.getContactFormTags(),\n      });\n\n      if (result.error) {\n        throw new Error(`Resend API error: ${result.error.message}`);\n      }\n\n      logger.info('Contact form email sent successfully', {\n        messageId: result.data?.id,\n        to: this.emailConfig.replyTo,\n        from: sanitizedData.email,\n        subject,\n      });\n\n      return result.data?.id || 'unknown';\n    } catch (error) {\n      logger.error('Failed to send contact form email', {\n        error: error instanceof Error ? error.message : 'Unknown error',\n        email: data.email,\n      });\n      throw new Error('Failed to send email');\n    }\n  }\n\n  /**\n   * 发送确认邮件给用户\n   * Send confirmation email to user\n   */\n  public async sendConfirmationEmail(data: EmailTemplateData): Promise<string> {\n    if (!this.isReady()) {\n      throw new Error('Resend service is not configured');\n    }\n\n    try {\n      const validatedData = ResendUtils.validateEmailData(data);\n      const sanitizedData = ResendUtils.sanitizeEmailData(validatedData);\n\n      const subject = ResendUtils.generateConfirmationSubject();\n      const htmlContent = ResendTemplates.generateConfirmationEmailHtml(sanitizedData);\n      const textContent = ResendTemplates.generateConfirmationEmailText(sanitizedData);\n\n      const result = await this.resend!.emails.send({\n        from: this.emailConfig.from,\n        to: [sanitizedData.email],\n        replyTo: this.emailConfig.supportEmail,\n        subject,\n        html: htmlContent,\n        text: textContent,\n        tags: ResendUtils.getConfirmationTags(),\n      });\n\n      if (result.error) {\n        throw new Error(`Resend API error: ${result.error.message}`);\n      }\n\n      logger.info('Confirmation email sent successfully', {\n        messageId: result.data?.id,\n        to: sanitizedData.email,\n        subject,\n      });\n\n      return result.data?.id || 'unknown';\n    } catch (error) {\n      logger.error('Failed to send confirmation email', {\n        error: error instanceof Error ? error.message : 'Unknown error',\n        email: data.email,\n      });\n      throw new Error('Failed to send confirmation email');\n    }\n  }\n\n  /**\n   * 获取邮件发送统计\n   * Get email sending statistics\n   */\n  public getEmailStats(): {\n    sent: number;\n    delivered: number;\n    bounced: number;\n    complained: number;\n  } {\n    // Note: Resend doesn't provide built-in analytics API\n    // This would need to be implemented with webhook tracking\n    return {\n      sent: 0,\n      delivered: 0,\n      bounced: 0,\n      complained: 0,\n    };\n  }\n\n  /**\n   * 获取邮件配置\n   * Get email configuration\n   */\n  public getEmailConfig(): typeof this.emailConfig {\n    return { ...this.emailConfig };\n  }\n\n  /**\n   * 检查API连接状态\n   * Check API connection status\n   */\n  public async checkConnection(): Promise<boolean> {\n    if (!this.isReady()) {\n      return false;\n    }\n\n    try {\n      // 尝试获取域名信息来测试连接\n      // Note: This is a placeholder - Resend doesn't have a ping endpoint\n      return true;\n    } catch {\n      return false;\n    }\n  }\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/resend-templates.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/resend-utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/resend.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/security-crypto.ts","messages":[{"ruleId":"max-params","severity":2,"message":"Async function 'verifyHMAC' has too many parameters (4). Maximum allowed is 3.","line":171,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":171,"endColumn":33},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 16.","line":196,"column":54,"nodeType":"Literal","messageId":"noMagic","endLine":196,"endColumn":56},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 12.","line":197,"column":52,"nodeType":"Literal","messageId":"noMagic","endLine":197,"endColumn":54},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 16.","line":230,"column":30,"nodeType":"Literal","messageId":"noMagic","endLine":230,"endColumn":32},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2.","line":230,"column":43,"nodeType":"Literal","messageId":"noMagic","endLine":230,"endColumn":44},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 16.","line":233,"column":30,"nodeType":"Literal","messageId":"noMagic","endLine":233,"endColumn":32},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2.","line":233,"column":43,"nodeType":"Literal","messageId":"noMagic","endLine":233,"endColumn":44},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 16.","line":236,"column":30,"nodeType":"Literal","messageId":"noMagic","endLine":236,"endColumn":32},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2.","line":236,"column":43,"nodeType":"Literal","messageId":"noMagic","endLine":236,"endColumn":44},{"ruleId":"max-params","severity":2,"message":"Async function 'decryptData' has too many parameters (4). Maximum allowed is 3.","line":244,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":244,"endColumn":34},{"ruleId":"no-return-await","severity":2,"message":"Redundant use of `await` on a return value.","line":299,"column":10,"nodeType":"Identifier","messageId":"redundantUseOfAwait","endLine":303,"endColumn":4,"suggestions":[{"messageId":"removeAwait","fix":{"range":[6914,6920],"text":""},"desc":"Remove redundant `await`."}]},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 16.","line":312,"column":28,"nodeType":"Literal","messageId":"noMagic","endLine":312,"endColumn":30},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2.","line":312,"column":41,"nodeType":"Literal","messageId":"noMagic","endLine":312,"endColumn":42},{"ruleId":"no-return-await","severity":2,"message":"Redundant use of `await` on a return value.","line":324,"column":10,"nodeType":"Identifier","messageId":"redundantUseOfAwait","endLine":330,"endColumn":4,"suggestions":[{"messageId":"removeAwait","fix":{"range":[7559,7565],"text":""},"desc":"Remove redundant `await`."}]}],"suppressedMessages":[],"errorCount":14,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 加密和密码哈希工具\n * Cryptography and password hashing utilities\n */\n\n/**\n * Crypto constants\n */\nconst CRYPTO_CONSTANTS = {\n  SALT_BYTE_LENGTH: 16,\n  HEX_CHARS_PER_BYTE: 2,\n  HEX_BASE: 16,\n  HEX_PAD_LENGTH: 2,\n} as const;\n\n/**\n * Hash password using Web Crypto API\n */\nexport async function hashPassword(\n  password: string,\n  salt?: string,\n): Promise<string> {\n  const encoder = new TextEncoder();\n  const saltBytes = salt\n    ? encoder.encode(salt)\n    : crypto.getRandomValues(\n        new Uint8Array(CRYPTO_CONSTANTS.SALT_BYTE_LENGTH),\n      );\n  const passwordBytes = encoder.encode(password);\n\n  const combined = new Uint8Array(saltBytes.length + passwordBytes.length);\n  combined.set(saltBytes);\n  combined.set(passwordBytes, saltBytes.length);\n\n  const hashBuffer = await crypto.subtle.digest('SHA-256', combined);\n  const hashArray = Array.from(new Uint8Array(hashBuffer));\n  const hashHex = hashArray\n    .map((b) =>\n      b\n        .toString(CRYPTO_CONSTANTS.HEX_BASE)\n        .padStart(CRYPTO_CONSTANTS.HEX_PAD_LENGTH, '0'),\n    )\n    .join('');\n\n  const saltHex = Array.from(saltBytes)\n    .map((b) =>\n      b\n        .toString(CRYPTO_CONSTANTS.HEX_BASE)\n        .padStart(CRYPTO_CONSTANTS.HEX_PAD_LENGTH, '0'),\n    )\n    .join('');\n\n  return `${saltHex}:${hashHex}`;\n}\n\n/**\n * Verify password against hash\n */\nexport async function verifyPassword(\n  password: string,\n  hash: string,\n): Promise<boolean> {\n  try {\n    const [saltHex, expectedHash] = hash.split(':');\n    if (!saltHex || !expectedHash) {\n      return false;\n    }\n\n    const salt = saltHex.match(/.{2}/g)?.map((byte) => parseInt(byte, 16));\n    if (!salt) {\n      return false;\n    }\n\n    const saltBytes = new Uint8Array(salt);\n    const actualHash = await hashPassword(\n      password,\n      new TextDecoder().decode(saltBytes),\n    );\n\n    return actualHash === hash;\n  } catch {\n    return false;\n  }\n}\n\n/**\n * Generate a cryptographically secure random salt\n */\nexport function generateSalt(length: number = CRYPTO_CONSTANTS.SALT_BYTE_LENGTH): string {\n  const saltBytes = crypto.getRandomValues(new Uint8Array(length));\n  return Array.from(saltBytes)\n    .map((b) =>\n      b\n        .toString(CRYPTO_CONSTANTS.HEX_BASE)\n        .padStart(CRYPTO_CONSTANTS.HEX_PAD_LENGTH, '0'),\n    )\n    .join('');\n}\n\n/**\n * Hash data using SHA-256\n */\nexport async function sha256Hash(data: string): Promise<string> {\n  const encoder = new TextEncoder();\n  const dataBytes = encoder.encode(data);\n  const hashBuffer = await crypto.subtle.digest('SHA-256', dataBytes);\n  const hashArray = Array.from(new Uint8Array(hashBuffer));\n  \n  return hashArray\n    .map((b) =>\n      b\n        .toString(CRYPTO_CONSTANTS.HEX_BASE)\n        .padStart(CRYPTO_CONSTANTS.HEX_PAD_LENGTH, '0'),\n    )\n    .join('');\n}\n\n/**\n * Hash data using SHA-512\n */\nexport async function sha512Hash(data: string): Promise<string> {\n  const encoder = new TextEncoder();\n  const dataBytes = encoder.encode(data);\n  const hashBuffer = await crypto.subtle.digest('SHA-512', dataBytes);\n  const hashArray = Array.from(new Uint8Array(hashBuffer));\n  \n  return hashArray\n    .map((b) =>\n      b\n        .toString(CRYPTO_CONSTANTS.HEX_BASE)\n        .padStart(CRYPTO_CONSTANTS.HEX_PAD_LENGTH, '0'),\n    )\n    .join('');\n}\n\n/**\n * Generate HMAC signature\n */\nexport async function generateHMAC(\n  data: string,\n  secret: string,\n  algorithm: 'SHA-256' | 'SHA-512' = 'SHA-256',\n): Promise<string> {\n  const encoder = new TextEncoder();\n  const keyData = encoder.encode(secret);\n  const messageData = encoder.encode(data);\n\n  const key = await crypto.subtle.importKey(\n    'raw',\n    keyData,\n    { name: 'HMAC', hash: algorithm },\n    false,\n    ['sign'],\n  );\n\n  const signature = await crypto.subtle.sign('HMAC', key, messageData);\n  const signatureArray = Array.from(new Uint8Array(signature));\n  \n  return signatureArray\n    .map((b) =>\n      b\n        .toString(CRYPTO_CONSTANTS.HEX_BASE)\n        .padStart(CRYPTO_CONSTANTS.HEX_PAD_LENGTH, '0'),\n    )\n    .join('');\n}\n\n/**\n * Verify HMAC signature\n */\nexport async function verifyHMAC(\n  data: string,\n  signature: string,\n  secret: string,\n  algorithm: 'SHA-256' | 'SHA-512' = 'SHA-256',\n): Promise<boolean> {\n  try {\n    const expectedSignature = await generateHMAC(data, secret, algorithm);\n    return expectedSignature === signature;\n  } catch {\n    return false;\n  }\n}\n\n/**\n * Encrypt data using AES-GCM\n */\nexport async function encryptData(\n  data: string,\n  password: string,\n): Promise<{ encrypted: string; iv: string; salt: string }> {\n  const encoder = new TextEncoder();\n  const dataBytes = encoder.encode(data);\n  \n  // Generate salt and IV\n  const salt = crypto.getRandomValues(new Uint8Array(16));\n  const iv = crypto.getRandomValues(new Uint8Array(12));\n  \n  // Derive key from password\n  const passwordKey = await crypto.subtle.importKey(\n    'raw',\n    encoder.encode(password),\n    'PBKDF2',\n    false,\n    ['deriveKey'],\n  );\n  \n  const key = await crypto.subtle.deriveKey(\n    {\n      name: 'PBKDF2',\n      salt,\n      iterations: 100000,\n      hash: 'SHA-256',\n    },\n    passwordKey,\n    { name: 'AES-GCM', length: 256 },\n    false,\n    ['encrypt'],\n  );\n  \n  // Encrypt data\n  const encrypted = await crypto.subtle.encrypt(\n    { name: 'AES-GCM', iv },\n    key,\n    dataBytes,\n  );\n  \n  return {\n    encrypted: Array.from(new Uint8Array(encrypted))\n      .map((b) => b.toString(16).padStart(2, '0'))\n      .join(''),\n    iv: Array.from(iv)\n      .map((b) => b.toString(16).padStart(2, '0'))\n      .join(''),\n    salt: Array.from(salt)\n      .map((b) => b.toString(16).padStart(2, '0'))\n      .join(''),\n  };\n}\n\n/**\n * Decrypt data using AES-GCM\n */\nexport async function decryptData(\n  encryptedHex: string,\n  ivHex: string,\n  saltHex: string,\n  password: string,\n): Promise<string> {\n  const encoder = new TextEncoder();\n  \n  // Convert hex strings back to bytes\n  const encrypted = new Uint8Array(\n    encryptedHex.match(/.{2}/g)?.map((byte) => parseInt(byte, 16)) || [],\n  );\n  const iv = new Uint8Array(\n    ivHex.match(/.{2}/g)?.map((byte) => parseInt(byte, 16)) || [],\n  );\n  const salt = new Uint8Array(\n    saltHex.match(/.{2}/g)?.map((byte) => parseInt(byte, 16)) || [],\n  );\n  \n  // Derive key from password\n  const passwordKey = await crypto.subtle.importKey(\n    'raw',\n    encoder.encode(password),\n    'PBKDF2',\n    false,\n    ['deriveKey'],\n  );\n  \n  const key = await crypto.subtle.deriveKey(\n    {\n      name: 'PBKDF2',\n      salt,\n      iterations: 100000,\n      hash: 'SHA-256',\n    },\n    passwordKey,\n    { name: 'AES-GCM', length: 256 },\n    false,\n    ['decrypt'],\n  );\n  \n  // Decrypt data\n  const decrypted = await crypto.subtle.decrypt(\n    { name: 'AES-GCM', iv },\n    key,\n    encrypted,\n  );\n  \n  return new TextDecoder().decode(decrypted);\n}\n\n/**\n * Generate a secure random key for encryption\n */\nexport async function generateEncryptionKey(): Promise<CryptoKey> {\n  return await crypto.subtle.generateKey(\n    { name: 'AES-GCM', length: 256 },\n    true,\n    ['encrypt', 'decrypt'],\n  );\n}\n\n/**\n * Export encryption key to raw format\n */\nexport async function exportKey(key: CryptoKey): Promise<string> {\n  const exported = await crypto.subtle.exportKey('raw', key);\n  return Array.from(new Uint8Array(exported))\n    .map((b) => b.toString(16).padStart(2, '0'))\n    .join('');\n}\n\n/**\n * Import encryption key from raw format\n */\nexport async function importKey(keyHex: string): Promise<CryptoKey> {\n  const keyBytes = new Uint8Array(\n    keyHex.match(/.{2}/g)?.map((byte) => parseInt(byte, 16)) || [],\n  );\n  \n  return await crypto.subtle.importKey(\n    'raw',\n    keyBytes,\n    { name: 'AES-GCM' },\n    true,\n    ['encrypt', 'decrypt'],\n  );\n}\n\n/**\n * Constant-time string comparison to prevent timing attacks\n */\nexport function constantTimeCompare(a: string, b: string): boolean {\n  if (a.length !== b.length) {\n    return false;\n  }\n  \n  let result = 0;\n  for (let i = 0; i < a.length; i++) {\n    result |= a.charCodeAt(i) ^ b.charCodeAt(i);\n  }\n  \n  return result === 0;\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/security-file-upload.ts","messages":[{"ruleId":"max-statements","severity":2,"message":"Function 'validateFileUpload' has too many statements (31). Maximum allowed is 20.","line":82,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":192,"endColumn":2},{"ruleId":"complexity","severity":2,"message":"Function 'validateFileUpload' has a complexity of 18. Maximum allowed is 15.","line":82,"column":8,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":192,"endColumn":2},{"ruleId":"prefer-destructuring","severity":2,"message":"Use object destructuring.","line":108,"column":5,"nodeType":"AssignmentExpression","messageId":"preferDestructuring","endLine":108,"endColumn":40},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":111,"column":19,"nodeType":"MemberExpression","endLine":111,"endColumn":47},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2.","line":143,"column":22,"nodeType":"Literal","messageId":"noMagic","endLine":143,"endColumn":23},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":145,"column":23,"nodeType":"MemberExpression","endLine":145,"endColumn":31},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 255.","line":173,"column":25,"nodeType":"Literal","messageId":"noMagic","endLine":173,"endColumn":28},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0xFF.","line":204,"column":22,"nodeType":"Literal","messageId":"noMagic","endLine":204,"endColumn":26},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0xD8.","line":204,"column":28,"nodeType":"Literal","messageId":"noMagic","endLine":204,"endColumn":32},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0xFF.","line":204,"column":34,"nodeType":"Literal","messageId":"noMagic","endLine":204,"endColumn":38},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0x89.","line":205,"column":21,"nodeType":"Literal","messageId":"noMagic","endLine":205,"endColumn":25},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0x50.","line":205,"column":27,"nodeType":"Literal","messageId":"noMagic","endLine":205,"endColumn":31},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0x4E.","line":205,"column":33,"nodeType":"Literal","messageId":"noMagic","endLine":205,"endColumn":37},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0x47.","line":205,"column":39,"nodeType":"Literal","messageId":"noMagic","endLine":205,"endColumn":43},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0x47.","line":206,"column":21,"nodeType":"Literal","messageId":"noMagic","endLine":206,"endColumn":25},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0x49.","line":206,"column":27,"nodeType":"Literal","messageId":"noMagic","endLine":206,"endColumn":31},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0x46.","line":206,"column":33,"nodeType":"Literal","messageId":"noMagic","endLine":206,"endColumn":37},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0x25.","line":207,"column":27,"nodeType":"Literal","messageId":"noMagic","endLine":207,"endColumn":31},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0x50.","line":207,"column":33,"nodeType":"Literal","messageId":"noMagic","endLine":207,"endColumn":37},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0x44.","line":207,"column":39,"nodeType":"Literal","messageId":"noMagic","endLine":207,"endColumn":43},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0x46.","line":207,"column":45,"nodeType":"Literal","messageId":"noMagic","endLine":207,"endColumn":49},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0x50.","line":208,"column":27,"nodeType":"Literal","messageId":"noMagic","endLine":208,"endColumn":31},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0x4B.","line":208,"column":33,"nodeType":"Literal","messageId":"noMagic","endLine":208,"endColumn":37},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0x03.","line":208,"column":39,"nodeType":"Literal","messageId":"noMagic","endLine":208,"endColumn":43},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0x04.","line":208,"column":45,"nodeType":"Literal","messageId":"noMagic","endLine":208,"endColumn":49},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":217,"column":73,"nodeType":"MemberExpression","endLine":217,"endColumn":95},{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":228,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":228,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":228,"column":12,"nodeType":null,"messageId":"unusedVar","endLine":228,"endColumn":17},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 255.","line":244,"column":19,"nodeType":"Literal","messageId":"noMagic","endLine":244,"endColumn":22},{"ruleId":"security/detect-object-injection","severity":2,"message":"Function Call Object Injection Sink","line":331,"column":39,"nodeType":"MemberExpression","endLine":331,"endColumn":51},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":335,"column":34,"nodeType":"MemberExpression","endLine":335,"endColumn":46}],"suppressedMessages":[],"errorCount":31,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 文件上传安全验证工具\n * File upload security validation utilities\n */\n\n/**\n * File upload constants\n */\nconst FILE_UPLOAD_CONSTANTS = {\n  MAX_FILE_SIZE_MB: 10,\n  BYTES_PER_MB: 1024,\n  KB_TO_BYTES: 1024,\n} as const;\n\n/**\n * File validation result interface\n */\nexport interface FileValidationResult {\n  valid: boolean;\n  error?: string;\n  warnings?: string[];\n}\n\n/**\n * Allowed file types configuration\n */\nexport const ALLOWED_FILE_TYPES = {\n  images: [\n    'image/jpeg',\n    'image/png',\n    'image/gif',\n    'image/webp',\n    'image/svg+xml',\n  ],\n  documents: [\n    'application/pdf',\n    'text/plain',\n    'text/csv',\n    'application/msword',\n    'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\n    'application/vnd.ms-excel',\n    'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\n  ],\n  archives: [\n    'application/zip',\n    'application/x-rar-compressed',\n    'application/x-7z-compressed',\n  ],\n} as const;\n\n/**\n * Dangerous file extensions that should never be allowed\n */\nconst DANGEROUS_EXTENSIONS = [\n  '.exe',\n  '.bat',\n  '.cmd',\n  '.scr',\n  '.pif',\n  '.js',\n  '.vbs',\n  '.jar',\n  '.com',\n  '.msi',\n  '.dll',\n  '.app',\n  '.deb',\n  '.rpm',\n  '.dmg',\n  '.pkg',\n  '.sh',\n  '.ps1',\n  '.php',\n  '.asp',\n  '.aspx',\n  '.jsp',\n] as const;\n\n/**\n * Validate file upload security\n */\nexport function validateFileUpload(\n  file: File,\n  options: {\n    maxSizeMB?: number;\n    allowedTypes?: string[];\n    allowedCategories?: Array<keyof typeof ALLOWED_FILE_TYPES>;\n  } = {},\n): FileValidationResult {\n  const warnings: string[] = [];\n\n  // Check file size\n  const maxSize = (options.maxSizeMB || FILE_UPLOAD_CONSTANTS.MAX_FILE_SIZE_MB) *\n    FILE_UPLOAD_CONSTANTS.BYTES_PER_MB *\n    FILE_UPLOAD_CONSTANTS.KB_TO_BYTES;\n\n  if (file.size > maxSize) {\n    return {\n      valid: false,\n      error: `File size exceeds ${options.maxSizeMB || FILE_UPLOAD_CONSTANTS.MAX_FILE_SIZE_MB}MB limit`,\n    };\n  }\n\n  // Determine allowed types\n  let allowedTypes: string[] = [];\n\n  if (options.allowedTypes) {\n    allowedTypes = options.allowedTypes;\n  } else if (options.allowedCategories) {\n    allowedTypes = options.allowedCategories.flatMap(\n      category => ALLOWED_FILE_TYPES[category] || []\n    );\n  } else {\n    // Default: allow images and documents\n    allowedTypes = [\n      ...ALLOWED_FILE_TYPES.images,\n      ...ALLOWED_FILE_TYPES.documents,\n    ];\n  }\n\n  // Check file type\n  if (!allowedTypes.includes(file.type)) {\n    return {\n      valid: false,\n      error: `File type '${file.type}' is not allowed. Allowed types: ${allowedTypes.join(', ')}`\n    };\n  }\n\n  // Check file name for dangerous extensions\n  const fileName = file.name.toLowerCase();\n\n  for (const ext of DANGEROUS_EXTENSIONS) {\n    if (fileName.endsWith(ext)) {\n      return {\n        valid: false,\n        error: `File extension '${ext}' is not allowed for security reasons`\n      };\n    }\n  }\n\n  // Check for double extensions (e.g., file.pdf.exe)\n  const parts = fileName.split('.');\n  if (parts.length > 2) {\n    for (let i = 1; i < parts.length - 1; i++) {\n      const ext = `.${parts[i]}`;\n      if (DANGEROUS_EXTENSIONS.includes(ext)) {\n        return {\n          valid: false,\n          error: `File contains dangerous extension '${ext}' in filename`,\n        };\n      }\n    }\n  }\n\n  // Check for suspicious file names\n  const suspiciousPatterns = [\n    /^con\\./i,\n    /^prn\\./i,\n    /^aux\\./i,\n    /^nul\\./i,\n    /^com[1-9]\\./i,\n    /^lpt[1-9]\\./i,\n  ];\n\n  for (const pattern of suspiciousPatterns) {\n    if (pattern.test(fileName)) {\n      warnings.push('File name matches a reserved system name pattern');\n      break;\n    }\n  }\n\n  // Check file name length\n  if (fileName.length > 255) {\n    return {\n      valid: false,\n      error: 'File name is too long (maximum 255 characters)',\n    };\n  }\n\n  // Check for null bytes in filename\n  if (fileName.includes('\\0')) {\n    return {\n      valid: false,\n      error: 'File name contains invalid characters',\n    };\n  }\n\n  return {\n    valid: true,\n    warnings: warnings.length > 0 ? warnings : undefined\n  };\n}\n\n/**\n * Validate file content based on file signature (magic numbers)\n */\nexport async function validateFileSignature(file: File): Promise<FileValidationResult> {\n  try {\n    const buffer = await file.arrayBuffer();\n    const bytes = new Uint8Array(buffer);\n\n    // Check for common file signatures\n    const signatures = {\n      'image/jpeg': [0xFF, 0xD8, 0xFF],\n      'image/png': [0x89, 0x50, 0x4E, 0x47],\n      'image/gif': [0x47, 0x49, 0x46],\n      'application/pdf': [0x25, 0x50, 0x44, 0x46],\n      'application/zip': [0x50, 0x4B, 0x03, 0x04],\n    };\n\n    // Get the declared MIME type\n    const declaredType = file.type;\n    const expectedSignature = signatures[declaredType as keyof typeof signatures];\n\n    if (expectedSignature) {\n      const actualSignature = Array.from(bytes.slice(0, expectedSignature.length));\n      const matches = expectedSignature.every((byte, index) => byte === actualSignature[index]);\n\n      if (!matches) {\n        return {\n          valid: false,\n          error: `File signature does not match declared type '${declaredType}'`,\n        };\n      }\n    }\n\n    return { valid: true };\n  } catch (error) {\n    return {\n      valid: false,\n      error: 'Failed to validate file signature',\n    };\n  }\n}\n\n/**\n * Sanitize file name for safe storage\n */\nexport function sanitizeFileName(fileName: string): string {\n  return fileName\n    .replace(/[^a-zA-Z0-9._-]/g, '_') // Replace special chars with underscore\n    .replace(/_{2,}/g, '_') // Replace multiple underscores with single\n    .replace(/^_+|_+$/g, '') // Remove leading/trailing underscores\n    .substring(0, 255); // Limit length\n}\n\n/**\n * Generate safe file name with timestamp\n */\nexport function generateSafeFileName(originalName: string, prefix?: string): string {\n  const timestamp = Date.now();\n  const extension = originalName.split('.').pop() || '';\n  const baseName = originalName.replace(/\\.[^/.]+$/, ''); // Remove extension\n  const sanitizedBase = sanitizeFileName(baseName);\n\n  const parts = [\n    prefix,\n    sanitizedBase,\n    timestamp,\n  ].filter(Boolean);\n\n  return `${parts.join('_')}.${extension}`;\n}\n\n/**\n * Check if file is an image\n */\nexport function isImageFile(file: File): boolean {\n  return ALLOWED_FILE_TYPES.images.includes(file.type);\n}\n\n/**\n * Check if file is a document\n */\nexport function isDocumentFile(file: File): boolean {\n  return ALLOWED_FILE_TYPES.documents.includes(file.type);\n}\n\n/**\n * Get file category\n */\nexport function getFileCategory(file: File): keyof typeof ALLOWED_FILE_TYPES | 'unknown' {\n  for (const [category, types] of Object.entries(ALLOWED_FILE_TYPES)) {\n    if (types.includes(file.type)) {\n      return category as keyof typeof ALLOWED_FILE_TYPES;\n    }\n  }\n  return 'unknown';\n}\n\n/**\n * Validate multiple files\n */\nexport function validateMultipleFiles(\n  files: FileList | File[],\n  options: {\n    maxFiles?: number;\n    maxTotalSizeMB?: number;\n    maxSizeMB?: number;\n    allowedTypes?: string[];\n    allowedCategories?: Array<keyof typeof ALLOWED_FILE_TYPES>;\n  } = {},\n): FileValidationResult {\n  const fileArray = Array.from(files);\n\n  // Check file count\n  if (options.maxFiles && fileArray.length > options.maxFiles) {\n    return {\n      valid: false,\n      error: `Too many files. Maximum allowed: ${options.maxFiles}`,\n    };\n  }\n\n  // Check total size\n  if (options.maxTotalSizeMB) {\n    const totalSize = fileArray.reduce((sum, file) => sum + file.size, 0);\n    const maxTotalSize = options.maxTotalSizeMB *\n      FILE_UPLOAD_CONSTANTS.BYTES_PER_MB *\n      FILE_UPLOAD_CONSTANTS.KB_TO_BYTES;\n\n    if (totalSize > maxTotalSize) {\n      return {\n        valid: false,\n        error: `Total file size exceeds ${options.maxTotalSizeMB}MB limit`,\n      };\n    }\n  }\n\n  // Validate each file\n  for (let i = 0; i < fileArray.length; i++) {\n    const result = validateFileUpload(fileArray[i], options);\n    if (!result.valid) {\n      return {\n        valid: false,\n        error: `File ${i + 1} (${fileArray[i].name}): ${result.error}`,\n      };\n    }\n  }\n\n  return { valid: true };\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/security-headers.ts","messages":[{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":67,"column":7,"nodeType":"MemberExpression","endLine":67,"endColumn":28},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":276,"column":53,"nodeType":"MemberExpression","endLine":276,"endColumn":68},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":277,"column":64,"nodeType":"MemberExpression","endLine":277,"endColumn":79}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 安全头部和配置工具\n * Security headers and configuration utilities\n */\n\nimport { env } from '../../env.mjs';\nimport { logger } from '@/lib/logger';\n\n/**\n * Security headers for API responses\n */\nexport function getApiSecurityHeaders(): Record<string, string> {\n  return {\n    'X-Content-Type-Options': 'nosniff',\n    'X-Frame-Options': 'DENY',\n    'X-XSS-Protection': '1; mode=block',\n    'Referrer-Policy': 'strict-origin-when-cross-origin',\n    'Cache-Control': 'no-store, no-cache, must-revalidate, proxy-revalidate',\n    'Pragma': 'no-cache',\n    'Expires': '0',\n  };\n}\n\n/**\n * Security headers for web pages\n */\nexport function getWebSecurityHeaders(nonce?: string): Record<string, string> {\n  const headers: Record<string, string> = {\n    'X-Content-Type-Options': 'nosniff',\n    'X-Frame-Options': 'SAMEORIGIN',\n    'X-XSS-Protection': '1; mode=block',\n    'Referrer-Policy': 'strict-origin-when-cross-origin',\n    'Permissions-Policy': 'camera=(), microphone=(), geolocation=()',\n  };\n\n  // Add CSP header with nonce if provided\n  if (nonce) {\n    headers['Content-Security-Policy'] = generateCSP(nonce);\n  }\n\n  return headers;\n}\n\n/**\n * Generate Content Security Policy\n */\nexport function generateCSP(nonce?: string): string {\n  const policies = [\n    \"default-src 'self'\",\n    \"script-src 'self' 'unsafe-inline' 'unsafe-eval' https://challenges.cloudflare.com\",\n    \"style-src 'self' 'unsafe-inline' https://fonts.googleapis.com\",\n    \"font-src 'self' https://fonts.gstatic.com\",\n    \"img-src 'self' data: https: blob:\",\n    \"connect-src 'self' https://api.resend.com https://api.airtable.com https://challenges.cloudflare.com\",\n    \"frame-src 'self' https://challenges.cloudflare.com\",\n    \"object-src 'none'\",\n    \"base-uri 'self'\",\n    \"form-action 'self'\",\n    \"frame-ancestors 'self'\",\n    \"upgrade-insecure-requests\",\n  ];\n\n  if (nonce) {\n    // Replace 'unsafe-inline' with nonce for scripts\n    const scriptIndex = policies.findIndex(p => p.startsWith('script-src'));\n    if (scriptIndex !== -1) {\n      policies[scriptIndex] = `script-src 'self' 'nonce-${nonce}' https://challenges.cloudflare.com`;\n    }\n  }\n\n  return policies.join('; ');\n}\n\n/**\n * Generate strict CSP for production\n */\nexport function generateStrictCSP(nonce: string): string {\n  return [\n    \"default-src 'none'\",\n    `script-src 'self' 'nonce-${nonce}' https://challenges.cloudflare.com`,\n    \"style-src 'self' https://fonts.googleapis.com\",\n    \"font-src 'self' https://fonts.gstatic.com\",\n    \"img-src 'self' data: https:\",\n    \"connect-src 'self' https://api.resend.com https://api.airtable.com https://challenges.cloudflare.com\",\n    \"frame-src https://challenges.cloudflare.com\",\n    \"object-src 'none'\",\n    \"base-uri 'self'\",\n    \"form-action 'self'\",\n    \"frame-ancestors 'none'\",\n    \"upgrade-insecure-requests\",\n  ].join('; ');\n}\n\n/**\n * CORS headers configuration\n */\nexport function getCORSHeaders(origin?: string): Record<string, string> {\n  const allowedOrigins = [\n    'http://localhost:3000',\n    'http://localhost:3001',\n    'https://tucsenberg.com',\n    'https://www.tucsenberg.com',\n  ];\n\n  const headers: Record<string, string> = {\n    'Access-Control-Allow-Methods': 'GET, POST, PUT, DELETE, OPTIONS',\n    'Access-Control-Allow-Headers': 'Content-Type, Authorization, X-Requested-With',\n    'Access-Control-Max-Age': '86400', // 24 hours\n  };\n\n  if (origin && allowedOrigins.includes(origin)) {\n    headers['Access-Control-Allow-Origin'] = origin;\n    headers['Access-Control-Allow-Credentials'] = 'true';\n  } else if (process.env.NODE_ENV === 'development') {\n    headers['Access-Control-Allow-Origin'] = '*';\n  }\n\n  return headers;\n}\n\n/**\n * Verify Turnstile token\n */\nexport async function verifyTurnstileToken(\n  token: string,\n  remoteip?: string,\n): Promise<boolean> {\n  try {\n    const response = await fetch('/api/verify-turnstile', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({ token, remoteip }),\n    });\n\n    const result = await response.json();\n    return result.success === true;\n  } catch (error) {\n    logger.error('Error verifying Turnstile token', { error: error as Error });\n    return false;\n  }\n}\n\n/**\n * Security configuration check\n */\nexport function checkSecurityConfig(testMode = false): {\n  configured: boolean;\n  issues: string[];\n  recommendations: string[];\n} {\n  const issues: string[] = [];\n  const recommendations: string[] = [];\n\n  // Use process.env directly in tests to avoid env validation issues\n  const nodeEnv = process.env.NODE_ENV;\n  const turnstileKey =\n    testMode || process.env.NODE_ENV === 'test'\n      ? process.env.TURNSTILE_SECRET_KEY\n      : env.TURNSTILE_SECRET_KEY;\n  const sentryDsn =\n    testMode || process.env.NODE_ENV === 'test'\n      ? process.env.SENTRY_DSN\n      : env.SENTRY_DSN;\n  const securityMode =\n    testMode || process.env.NODE_ENV === 'test'\n      ? process.env.NEXT_PUBLIC_SECURITY_MODE\n      : env.NEXT_PUBLIC_SECURITY_MODE;\n\n  // Check environment variables\n  if (!turnstileKey && nodeEnv === 'production') {\n    issues.push('Turnstile secret key not configured in production');\n  }\n\n  if (!sentryDsn && nodeEnv === 'production') {\n    recommendations.push('Consider configuring Sentry for error monitoring');\n  }\n\n  if (securityMode === 'relaxed' && nodeEnv === 'production') {\n    issues.push('Security mode is set to relaxed in production');\n  }\n\n  return {\n    configured: issues.length === 0,\n    issues,\n    recommendations,\n  };\n}\n\n/**\n * Security middleware configuration\n */\nexport interface SecurityMiddlewareConfig {\n  enableCSP: boolean;\n  enableHSTS: boolean;\n  enableXSSProtection: boolean;\n  enableFrameOptions: boolean;\n  enableContentTypeOptions: boolean;\n  enableReferrerPolicy: boolean;\n  enablePermissionsPolicy: boolean;\n}\n\n/**\n * Get security middleware headers\n */\nexport function getSecurityMiddlewareHeaders(\n  config: Partial<SecurityMiddlewareConfig> = {},\n  nonce?: string,\n): Record<string, string> {\n  const defaultConfig: SecurityMiddlewareConfig = {\n    enableCSP: true,\n    enableHSTS: true,\n    enableXSSProtection: true,\n    enableFrameOptions: true,\n    enableContentTypeOptions: true,\n    enableReferrerPolicy: true,\n    enablePermissionsPolicy: true,\n  };\n\n  const finalConfig = { ...defaultConfig, ...config };\n  const headers: Record<string, string> = {};\n\n  if (finalConfig.enableCSP) {\n    headers['Content-Security-Policy'] = generateCSP(nonce);\n  }\n\n  if (finalConfig.enableHSTS) {\n    headers['Strict-Transport-Security'] = 'max-age=31536000; includeSubDomains; preload';\n  }\n\n  if (finalConfig.enableXSSProtection) {\n    headers['X-XSS-Protection'] = '1; mode=block';\n  }\n\n  if (finalConfig.enableFrameOptions) {\n    headers['X-Frame-Options'] = 'SAMEORIGIN';\n  }\n\n  if (finalConfig.enableContentTypeOptions) {\n    headers['X-Content-Type-Options'] = 'nosniff';\n  }\n\n  if (finalConfig.enableReferrerPolicy) {\n    headers['Referrer-Policy'] = 'strict-origin-when-cross-origin';\n  }\n\n  if (finalConfig.enablePermissionsPolicy) {\n    headers['Permissions-Policy'] = 'camera=(), microphone=(), geolocation=()';\n  }\n\n  return headers;\n}\n\n/**\n * Validate security headers in response\n */\nexport function validateSecurityHeaders(headers: Record<string, string>): {\n  valid: boolean;\n  missing: string[];\n  recommendations: string[];\n} {\n  const requiredHeaders = [\n    'X-Content-Type-Options',\n    'X-Frame-Options',\n    'X-XSS-Protection',\n    'Referrer-Policy',\n  ];\n\n  const recommendedHeaders = [\n    'Content-Security-Policy',\n    'Strict-Transport-Security',\n    'Permissions-Policy',\n  ];\n\n  const missing = requiredHeaders.filter(header => !headers[header]);\n  const recommendations = recommendedHeaders.filter(header => !headers[header]);\n\n  return {\n    valid: missing.length === 0,\n    missing,\n    recommendations,\n  };\n}\n\n/**\n * Generate security report\n */\nexport function generateSecurityReport(): {\n  timestamp: string;\n  environment: string;\n  config: ReturnType<typeof checkSecurityConfig>;\n  headers: ReturnType<typeof validateSecurityHeaders>;\n} {\n  const mockHeaders = getSecurityMiddlewareHeaders();\n  \n  return {\n    timestamp: new Date().toISOString(),\n    environment: process.env.NODE_ENV || 'unknown',\n    config: checkSecurityConfig(),\n    headers: validateSecurityHeaders(mockHeaders),\n  };\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/security-rate-limit.ts","messages":[{"ruleId":"security/detect-object-injection","severity":2,"message":"Variable Assigned to Object Injection Sink","line":177,"column":16,"nodeType":"MemberExpression","endLine":177,"endColumn":38},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2.","line":240,"column":59,"nodeType":"Literal","messageId":"noMagic","endLine":240,"endColumn":60}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 速率限制工具\n * Rate limiting utilities\n */\n\n/**\n * Rate limiting constants\n */\nconst RATE_LIMIT_CONSTANTS = {\n  DEFAULT_MAX_REQUESTS: 10,\n  DEFAULT_WINDOW_MS: 60000, // 1 minute\n  CLEANUP_INTERVAL_MINUTES: 5,\n  MINUTES_TO_MS: 60,\n  SECONDS_TO_MS: 1000,\n} as const;\n\n/**\n * Rate limit entry interface\n */\ninterface RateLimitEntry {\n  count: number;\n  resetTime: number;\n}\n\n/**\n * Rate limit store\n */\nconst rateLimitStore = new Map<string, RateLimitEntry>();\n\n/**\n * Rate limiting utility\n */\nexport function rateLimit(\n  identifier: string,\n  maxRequests: number = RATE_LIMIT_CONSTANTS.DEFAULT_MAX_REQUESTS,\n  windowMs: number = RATE_LIMIT_CONSTANTS.DEFAULT_WINDOW_MS,\n): boolean {\n  const now = Date.now();\n  const entry = rateLimitStore.get(identifier);\n\n  if (!entry || now > entry.resetTime) {\n    // First request or window expired\n    rateLimitStore.set(identifier, {\n      count: 1,\n      resetTime: now + windowMs,\n    });\n    return true;\n  }\n\n  if (entry.count >= maxRequests) {\n    // Rate limit exceeded\n    return false;\n  }\n\n  // Increment count\n  entry.count += 1;\n  rateLimitStore.set(identifier, entry);\n  return true;\n}\n\n/**\n * Get rate limit status for an identifier\n */\nexport function getRateLimitStatus(identifier: string): {\n  remaining: number;\n  resetTime: number;\n  isLimited: boolean;\n} {\n  const now = Date.now();\n  const entry = rateLimitStore.get(identifier);\n\n  if (!entry || now > entry.resetTime) {\n    return {\n      remaining: RATE_LIMIT_CONSTANTS.DEFAULT_MAX_REQUESTS - 1,\n      resetTime: now + RATE_LIMIT_CONSTANTS.DEFAULT_WINDOW_MS,\n      isLimited: false,\n    };\n  }\n\n  const remaining = Math.max(0, RATE_LIMIT_CONSTANTS.DEFAULT_MAX_REQUESTS - entry.count);\n  return {\n    remaining,\n    resetTime: entry.resetTime,\n    isLimited: remaining === 0,\n  };\n}\n\n/**\n * Clean up expired rate limit entries\n */\nexport function cleanupRateLimit(): void {\n  const now = Date.now();\n  for (const [key, entry] of rateLimitStore.entries()) {\n    if (now > entry.resetTime) {\n      rateLimitStore.delete(key);\n    }\n  }\n}\n\n/**\n * Reset rate limit for a specific identifier\n */\nexport function resetRateLimit(identifier: string): void {\n  rateLimitStore.delete(identifier);\n}\n\n/**\n * Get all active rate limit entries (for debugging)\n */\nexport function getActiveLimits(): Array<{\n  identifier: string;\n  count: number;\n  resetTime: number;\n  remaining: number;\n}> {\n  const now = Date.now();\n  const active: Array<{\n    identifier: string;\n    count: number;\n    resetTime: number;\n    remaining: number;\n  }> = [];\n\n  for (const [identifier, entry] of rateLimitStore.entries()) {\n    if (now <= entry.resetTime) {\n      active.push({\n        identifier,\n        count: entry.count,\n        resetTime: entry.resetTime,\n        remaining: Math.max(0, RATE_LIMIT_CONSTANTS.DEFAULT_MAX_REQUESTS - entry.count),\n      });\n    }\n  }\n\n  return active;\n}\n\n/**\n * Advanced rate limiting with different tiers\n */\nexport interface RateLimitTier {\n  name: string;\n  maxRequests: number;\n  windowMs: number;\n}\n\nconst defaultTiers: Record<string, RateLimitTier> = {\n  strict: {\n    name: 'strict',\n    maxRequests: 5,\n    windowMs: 60000, // 1 minute\n  },\n  normal: {\n    name: 'normal',\n    maxRequests: 10,\n    windowMs: 60000, // 1 minute\n  },\n  relaxed: {\n    name: 'relaxed',\n    maxRequests: 20,\n    windowMs: 60000, // 1 minute\n  },\n  premium: {\n    name: 'premium',\n    maxRequests: 100,\n    windowMs: 60000, // 1 minute\n  },\n};\n\n/**\n * Rate limit with tier support\n */\nexport function rateLimitWithTier(\n  identifier: string,\n  tierName: keyof typeof defaultTiers = 'normal',\n): boolean {\n  const tier = defaultTiers[tierName];\n  if (!tier) {\n    throw new Error(`Unknown rate limit tier: ${tierName}`);\n  }\n\n  return rateLimit(identifier, tier.maxRequests, tier.windowMs);\n}\n\n/**\n * Create custom rate limit tier\n */\nexport function createRateLimitTier(\n  name: string,\n  maxRequests: number,\n  windowMs: number,\n): RateLimitTier {\n  return { name, maxRequests, windowMs };\n}\n\n/**\n * Sliding window rate limiter\n */\ninterface SlidingWindowEntry {\n  timestamps: number[];\n}\n\nconst slidingWindowStore = new Map<string, SlidingWindowEntry>();\n\n/**\n * Sliding window rate limiting\n */\nexport function slidingWindowRateLimit(\n  identifier: string,\n  maxRequests: number = RATE_LIMIT_CONSTANTS.DEFAULT_MAX_REQUESTS,\n  windowMs: number = RATE_LIMIT_CONSTANTS.DEFAULT_WINDOW_MS,\n): boolean {\n  const now = Date.now();\n  const windowStart = now - windowMs;\n  \n  let entry = slidingWindowStore.get(identifier);\n  if (!entry) {\n    entry = { timestamps: [] };\n    slidingWindowStore.set(identifier, entry);\n  }\n\n  // Remove old timestamps outside the window\n  entry.timestamps = entry.timestamps.filter(timestamp => timestamp > windowStart);\n\n  // Check if we're within the limit\n  if (entry.timestamps.length >= maxRequests) {\n    return false;\n  }\n\n  // Add current timestamp\n  entry.timestamps.push(now);\n  return true;\n}\n\n/**\n * Clean up sliding window entries\n */\nexport function cleanupSlidingWindow(): void {\n  const now = Date.now();\n  const maxAge = RATE_LIMIT_CONSTANTS.DEFAULT_WINDOW_MS * 2; // Keep entries for 2x window size\n\n  for (const [key, entry] of slidingWindowStore.entries()) {\n    const oldestTimestamp = Math.min(...entry.timestamps);\n    if (now - oldestTimestamp > maxAge) {\n      slidingWindowStore.delete(key);\n    }\n  }\n}\n\n// Clean up rate limit entries every 5 minutes\nif (typeof setInterval !== 'undefined') {\n  setInterval(\n    () => {\n      cleanupRateLimit();\n      cleanupSlidingWindow();\n    },\n    RATE_LIMIT_CONSTANTS.CLEANUP_INTERVAL_MINUTES *\n      RATE_LIMIT_CONSTANTS.MINUTES_TO_MS *\n      RATE_LIMIT_CONSTANTS.SECONDS_TO_MS,\n  );\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/security-tokens.ts","messages":[{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 16.","line":51,"column":34,"nodeType":"Literal","messageId":"noMagic","endLine":51,"endColumn":36},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0x0f.","line":55,"column":28,"nodeType":"Literal","messageId":"noMagic","endLine":55,"endColumn":32},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0x40.","line":55,"column":36,"nodeType":"Literal","messageId":"noMagic","endLine":55,"endColumn":40},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0x3f.","line":56,"column":28,"nodeType":"Literal","messageId":"noMagic","endLine":56,"endColumn":32},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0x80.","line":56,"column":36,"nodeType":"Literal","messageId":"noMagic","endLine":56,"endColumn":40},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 16.","line":59,"column":21,"nodeType":"Literal","messageId":"noMagic","endLine":59,"endColumn":23},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2.","line":59,"column":34,"nodeType":"Literal","messageId":"noMagic","endLine":59,"endColumn":35},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 8.","line":63,"column":24,"nodeType":"Literal","messageId":"noMagic","endLine":63,"endColumn":25},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 8.","line":64,"column":21,"nodeType":"Literal","messageId":"noMagic","endLine":64,"endColumn":22},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 12.","line":64,"column":24,"nodeType":"Literal","messageId":"noMagic","endLine":64,"endColumn":26},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 12.","line":65,"column":21,"nodeType":"Literal","messageId":"noMagic","endLine":65,"endColumn":23},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 16.","line":65,"column":25,"nodeType":"Literal","messageId":"noMagic","endLine":65,"endColumn":27},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 16.","line":66,"column":21,"nodeType":"Literal","messageId":"noMagic","endLine":66,"endColumn":23},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 20.","line":66,"column":25,"nodeType":"Literal","messageId":"noMagic","endLine":66,"endColumn":27},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 20.","line":67,"column":21,"nodeType":"Literal","messageId":"noMagic","endLine":67,"endColumn":23},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 32.","line":67,"column":25,"nodeType":"Literal","messageId":"noMagic","endLine":67,"endColumn":27},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 16.","line":73,"column":31,"nodeType":"Literal","messageId":"noMagic","endLine":73,"endColumn":33},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0x3.","line":74,"column":36,"nodeType":"Literal","messageId":"noMagic","endLine":74,"endColumn":39},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0x8.","line":74,"column":42,"nodeType":"Literal","messageId":"noMagic","endLine":74,"endColumn":45},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 16.","line":75,"column":23,"nodeType":"Literal","messageId":"noMagic","endLine":75,"endColumn":25},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 48.","line":83,"column":42,"nodeType":"Literal","messageId":"noMagic","endLine":83,"endColumn":44},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 64.","line":91,"column":30,"nodeType":"Literal","messageId":"noMagic","endLine":91,"endColumn":32},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 32.","line":98,"column":30,"nodeType":"Literal","messageId":"noMagic","endLine":98,"endColumn":32},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 16.","line":105,"column":30,"nodeType":"Literal","messageId":"noMagic","endLine":105,"endColumn":32},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":120,"column":24,"nodeType":"MemberExpression","endLine":120,"endColumn":32},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":144,"column":23,"nodeType":"MemberExpression","endLine":144,"endColumn":31},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2.","line":190,"column":39,"nodeType":"Literal","messageId":"noMagic","endLine":190,"endColumn":40},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 60.","line":210,"column":46,"nodeType":"Literal","messageId":"noMagic","endLine":210,"endColumn":48}],"suppressedMessages":[],"errorCount":28,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 安全令牌生成工具\n * Security token generation utilities\n */\n\n/**\n * Token generation constants\n */\nconst TOKEN_CONSTANTS = {\n  // Token generation\n  DEFAULT_TOKEN_LENGTH: 32,\n  HEX_RADIX: 2,\n  HEX_PAD_LENGTH: 2,\n  HEX_BASE: 16,\n} as const;\n\n/**\n * Generate a secure random string\n */\nexport function generateSecureToken(\n  length: number = TOKEN_CONSTANTS.DEFAULT_TOKEN_LENGTH,\n): string {\n  if (typeof crypto !== 'undefined' && crypto.getRandomValues) {\n    // Generate half the length in bytes since each byte becomes 2 hex characters\n    const byteLength = Math.ceil(length / TOKEN_CONSTANTS.HEX_RADIX);\n    const array = new Uint8Array(byteLength);\n    crypto.getRandomValues(array);\n    const hex = Array.from(array, (byte) =>\n      byte\n        .toString(TOKEN_CONSTANTS.HEX_BASE)\n        .padStart(TOKEN_CONSTANTS.HEX_PAD_LENGTH, '0'),\n    ).join('');\n    return hex.substring(0, length);\n  }\n\n  // Fallback for environments without crypto.getRandomValues\n  const chars =\n    'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n  let result = '';\n  for (let i = 0; i < length; i++) {\n    result += chars.charAt(Math.floor(Math.random() * chars.length));\n  }\n  return result;\n}\n\n/**\n * Generate a secure random UUID v4\n */\nexport function generateUUID(): string {\n  if (typeof crypto !== 'undefined' && crypto.getRandomValues) {\n    const array = new Uint8Array(16);\n    crypto.getRandomValues(array);\n    \n    // Set version (4) and variant bits\n    array[6] = (array[6] & 0x0f) | 0x40;\n    array[8] = (array[8] & 0x3f) | 0x80;\n    \n    const hex = Array.from(array, (byte) =>\n      byte.toString(16).padStart(2, '0')\n    ).join('');\n    \n    return [\n      hex.substring(0, 8),\n      hex.substring(8, 12),\n      hex.substring(12, 16),\n      hex.substring(16, 20),\n      hex.substring(20, 32),\n    ].join('-');\n  }\n\n  // Fallback UUID generation\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, (c) => {\n    const r = Math.random() * 16 | 0;\n    const v = c === 'x' ? r : (r & 0x3 | 0x8);\n    return v.toString(16);\n  });\n}\n\n/**\n * Generate a secure random API key\n */\nexport function generateApiKey(prefix: string = 'sk'): string {\n  const randomPart = generateSecureToken(48);\n  return `${prefix}_${randomPart}`;\n}\n\n/**\n * Generate a secure session token\n */\nexport function generateSessionToken(): string {\n  return generateSecureToken(64);\n}\n\n/**\n * Generate a secure CSRF token\n */\nexport function generateCsrfToken(): string {\n  return generateSecureToken(32);\n}\n\n/**\n * Generate a secure nonce for CSP\n */\nexport function generateNonce(): string {\n  return generateSecureToken(16);\n}\n\n/**\n * Generate a secure one-time password (OTP)\n */\nexport function generateOTP(length: number = 6): string {\n  const digits = '0123456789';\n  let result = '';\n  \n  if (typeof crypto !== 'undefined' && crypto.getRandomValues) {\n    const array = new Uint8Array(length);\n    crypto.getRandomValues(array);\n    \n    for (let i = 0; i < length; i++) {\n      result += digits[array[i] % digits.length];\n    }\n  } else {\n    // Fallback\n    for (let i = 0; i < length; i++) {\n      result += digits[Math.floor(Math.random() * digits.length)];\n    }\n  }\n  \n  return result;\n}\n\n/**\n * Generate a secure verification code (alphanumeric)\n */\nexport function generateVerificationCode(length: number = 8): string {\n  const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';\n  let result = '';\n  \n  if (typeof crypto !== 'undefined' && crypto.getRandomValues) {\n    const array = new Uint8Array(length);\n    crypto.getRandomValues(array);\n    \n    for (let i = 0; i < length; i++) {\n      result += chars[array[i] % chars.length];\n    }\n  } else {\n    // Fallback\n    for (let i = 0; i < length; i++) {\n      result += chars[Math.floor(Math.random() * chars.length)];\n    }\n  }\n  \n  return result;\n}\n\n/**\n * Validate token format\n */\nexport function isValidToken(token: string, expectedLength?: number): boolean {\n  if (typeof token !== 'string' || token.length === 0) {\n    return false;\n  }\n\n  // Check if token contains only valid characters (alphanumeric and some special chars)\n  const validTokenRegex = /^[a-zA-Z0-9_-]+$/;\n  if (!validTokenRegex.test(token)) {\n    return false;\n  }\n\n  // Check length if specified\n  if (expectedLength && token.length !== expectedLength) {\n    return false;\n  }\n\n  return true;\n}\n\n/**\n * Validate UUID format\n */\nexport function isValidUUID(uuid: string): boolean {\n  const uuidRegex = /^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;\n  return uuidRegex.test(uuid);\n}\n\n/**\n * Generate a secure random salt for password hashing\n */\nexport function generateSalt(length: number = 16): string {\n  return generateSecureToken(length * 2); // Double length for hex representation\n}\n\n/**\n * Token expiration utilities\n */\nexport interface TokenWithExpiry {\n  token: string;\n  expiresAt: number;\n}\n\n/**\n * Create a token with expiration\n */\nexport function createTokenWithExpiry(\n  tokenLength: number = 32,\n  expiryMinutes: number = 60,\n): TokenWithExpiry {\n  return {\n    token: generateSecureToken(tokenLength),\n    expiresAt: Date.now() + (expiryMinutes * 60 * 1000),\n  };\n}\n\n/**\n * Check if token is expired\n */\nexport function isTokenExpired(tokenWithExpiry: TokenWithExpiry): boolean {\n  return Date.now() > tokenWithExpiry.expiresAt;\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/security-validation.ts","messages":[{"ruleId":"security/detect-unsafe-regex","severity":2,"message":"Unsafe Regular Expression","line":133,"column":14,"nodeType":"Literal","endLine":133,"endColumn":67},{"ruleId":"security/detect-unsafe-regex","severity":2,"message":"Unsafe Regular Expression","line":134,"column":14,"nodeType":"Literal","endLine":134,"endColumn":67}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 安全验证工具\n * Security validation utilities\n */\n\n/**\n * Security constants for validation\n */\nconst VALIDATION_CONSTANTS = {\n  // Email validation\n  MAX_EMAIL_LENGTH: 254,\n} as const;\n\n/**\n * Sanitize user input to prevent XSS attacks\n */\nexport function sanitizeInput(input: string): string {\n  if (typeof input !== 'string') {\n    return '';\n  }\n\n  return input\n    .replace(/[<>]/g, '') // Remove angle brackets\n    .replace(/javascript:/gi, '') // Remove javascript: protocol\n    .replace(/on\\w+=/gi, '') // Remove event handlers\n    .replace(/data:/gi, '') // Remove data: protocol\n    .trim();\n}\n\n/**\n * Validate email address format\n */\nexport function isValidEmail(email: string): boolean {\n  const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n  return (\n    emailRegex.test(email) &&\n    email.length <= VALIDATION_CONSTANTS.MAX_EMAIL_LENGTH\n  );\n}\n\n/**\n * Validate URL format and protocol\n */\nexport function isValidUrl(\n  url: string,\n  allowedProtocols: string[] = ['http:', 'https:'],\n): boolean {\n  try {\n    const urlObj = new URL(url);\n    return allowedProtocols.includes(urlObj.protocol);\n  } catch {\n    return false;\n  }\n}\n\n/**\n * Validate and sanitize file path to prevent path traversal attacks\n */\nexport function sanitizeFilePath(filePath: string): string {\n  if (typeof filePath !== 'string') {\n    return '';\n  }\n\n  // Remove dangerous path components\n  return filePath\n    .replace(/\\.\\./g, '') // Remove parent directory references\n    .replace(/[<>:\"|?*]/g, '') // Remove invalid filename characters\n    .replace(/^\\/+/, '') // Remove leading slashes\n    .trim();\n}\n\n/**\n * Validate input length\n */\nexport function validateInputLength(\n  input: string,\n  minLength: number = 0,\n  maxLength: number = 1000,\n): { valid: boolean; error?: string } {\n  if (typeof input !== 'string') {\n    return { valid: false, error: 'Input must be a string' };\n  }\n\n  if (input.length < minLength) {\n    return { valid: false, error: `Input must be at least ${minLength} characters` };\n  }\n\n  if (input.length > maxLength) {\n    return { valid: false, error: `Input must be no more than ${maxLength} characters` };\n  }\n\n  return { valid: true };\n}\n\n/**\n * Check if string contains only allowed characters\n */\nexport function validateCharacters(\n  input: string,\n  allowedPattern: RegExp,\n): { valid: boolean; error?: string } {\n  if (typeof input !== 'string') {\n    return { valid: false, error: 'Input must be a string' };\n  }\n\n  if (!allowedPattern.test(input)) {\n    return { valid: false, error: 'Input contains invalid characters' };\n  }\n\n  return { valid: true };\n}\n\n/**\n * Validate phone number format\n */\nexport function isValidPhoneNumber(phone: string): boolean {\n  // International phone number validation\n  const phoneRegex = /^[+]?[1-9][\\d]{0,15}$/;\n  const cleanPhone = phone.replace(/[\\s\\-()]/g, '');\n  return phoneRegex.test(cleanPhone);\n}\n\n/**\n * Validate and sanitize HTML content\n */\nexport function sanitizeHtml(html: string): string {\n  if (typeof html !== 'string') {\n    return '';\n  }\n\n  // Basic HTML sanitization - remove script tags and dangerous attributes\n  return html\n    .replace(/<script\\b[^<]*(?:(?!<\\/script>)<[^<]*)*<\\/script>/gi, '')\n    .replace(/<iframe\\b[^<]*(?:(?!<\\/iframe>)<[^<]*)*<\\/iframe>/gi, '')\n    .replace(/on\\w+\\s*=\\s*[\"'][^\"']*[\"']/gi, '')\n    .replace(/javascript:/gi, '')\n    .replace(/data:/gi, '')\n    .trim();\n}\n\n/**\n * Validate JSON string\n */\nexport function isValidJson(jsonString: string): boolean {\n  try {\n    JSON.parse(jsonString);\n    return true;\n  } catch {\n    return false;\n  }\n}\n\n/**\n * Validate and sanitize user input for database queries\n */\nexport function sanitizeForDatabase(input: string): string {\n  if (typeof input !== 'string') {\n    return '';\n  }\n\n  // Basic SQL injection prevention\n  return input\n    .replace(/['\";\\\\]/g, '') // Remove quotes and backslashes\n    .replace(/--/g, '') // Remove SQL comments\n    .replace(/\\/\\*/g, '') // Remove block comment start\n    .replace(/\\*\\//g, '') // Remove block comment end\n    .trim();\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/security.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/seo-metadata.ts","messages":[],"suppressedMessages":[{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":164,"column":7,"nodeType":"MemberExpression","endLine":164,"endColumn":28,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/site-config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/structured-data-generators.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/structured-data-helpers.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/structured-data-types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/structured-data.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/tech-stack-data.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/theme-analytics-core.ts","messages":[{"ruleId":"max-params","severity":2,"message":"Method 'recordThemeSwitch' has too many parameters (5). Maximum allowed is 3.","line":57,"column":3,"nodeType":"FunctionExpression","messageId":"exceed","endLine":57,"endColumn":20},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 5.","line":175,"column":39,"nodeType":"Literal","messageId":"noMagic","endLine":175,"endColumn":40},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 3.","line":184,"column":19,"nodeType":"Literal","messageId":"noMagic","endLine":184,"endColumn":20},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 50.","line":245,"column":38,"nodeType":"Literal","messageId":"noMagic","endLine":245,"endColumn":40},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 30.","line":248,"column":19,"nodeType":"Literal","messageId":"noMagic","endLine":248,"endColumn":21}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\n/**\n * 主题分析核心类\n * Theme analytics core class\n */\n\nimport * as Sentry from '@sentry/nextjs';\nimport type { \n  ThemePerformanceMetrics, \n  ThemeUsageStats, \n  ThemeSwitchPattern,\n  ThemeAnalyticsConfig,\n  ThemePerformanceSummary\n} from './theme-analytics-types';\nimport { ThemeAnalyticsUtils } from './theme-analytics-utils';\n\n/**\n * 主题分析管理器\n * 负责收集、分析和报告主题相关的性能和使用数据\n */\nexport class ThemeAnalytics {\n  private config: ThemeAnalyticsConfig;\n  private performanceMetrics: ThemePerformanceMetrics[] = [];\n  private usageStats: Map<string, ThemeUsageStats> = new Map();\n  private switchPatterns: ThemeSwitchPattern[] = [];\n  private currentTheme: string = 'system';\n  private sessionStartTime: number = Date.now();\n  private lastSwitchTime: number = 0;\n\n  /**\n   * 获取当前主题\n   */\n  getCurrentTheme(): string {\n    return this.currentTheme;\n  }\n\n  constructor(config?: Partial<ThemeAnalyticsConfig>) {\n    this.config = {\n      enabled: process.env.NODE_ENV === 'production',\n      performanceThreshold: 100, // 100ms\n      sampleRate: 0.1, // 10% 采样\n      enableDetailedTracking: true,\n      enableUserBehaviorAnalysis: true,\n      ...config,\n    };\n\n    // 初始化Sentry自定义标签\n    if (this.config.enabled) {\n      Sentry.setTag('feature', 'theme-analytics');\n    }\n  }\n\n  /**\n   * 记录主题切换性能\n   */\n  recordThemeSwitch(\n    fromTheme: string,\n    toTheme: string,\n    startTime: number,\n    endTime: number,\n    supportsViewTransitions: boolean = false,\n  ): void {\n    if (!this.config.enabled || !ThemeAnalyticsUtils.shouldSample(this.config.sampleRate)) {\n      return;\n    }\n\n    const switchDuration = endTime - startTime;\n    const now = Date.now();\n\n    const metrics: ThemePerformanceMetrics = {\n      switchDuration,\n      fromTheme,\n      toTheme,\n      timestamp: now,\n      userAgent: typeof navigator !== 'undefined' ? navigator.userAgent : '',\n      viewportSize: ThemeAnalyticsUtils.getViewportSize(),\n      supportsViewTransitions,\n    };\n\n    // 存储性能指标\n    this.performanceMetrics.push(metrics);\n    this.lastSwitchTime = now;\n\n    // 更新使用统计\n    ThemeAnalyticsUtils.updateUsageStats(this.usageStats, toTheme, now, this.lastSwitchTime);\n\n    // 发送到Sentry\n    ThemeAnalyticsUtils.sendPerformanceMetrics(metrics);\n\n    // 检查性能阈值\n    if (switchDuration > this.config.performanceThreshold) {\n      ThemeAnalyticsUtils.reportPerformanceIssue(metrics);\n    }\n\n    // 分析切换模式\n    if (this.config.enableUserBehaviorAnalysis) {\n      ThemeAnalyticsUtils.analyzeSwitchPattern(this.switchPatterns, fromTheme, toTheme, switchDuration);\n    }\n\n    // 清理旧数据\n    this.cleanupOldData();\n  }\n\n  /**\n   * 记录主题偏好\n   */\n  recordThemePreference(theme: string): void {\n    if (!this.config.enabled) return;\n\n    this.currentTheme = theme;\n\n    // 发送用户偏好数据到Sentry\n    Sentry.setUser({\n      themePreference: theme,\n    });\n\n    Sentry.addBreadcrumb({\n      category: 'theme',\n      message: `User selected theme: ${theme}`,\n      level: 'info',\n      data: {\n        theme,\n        timestamp: Date.now(),\n      },\n    });\n\n    // 记录主题偏好事件\n    Sentry.addBreadcrumb({\n      category: 'user-preference',\n      message: `Theme preference set to ${theme}`,\n      level: 'info',\n      data: {\n        theme,\n        sessionDuration: Date.now() - this.sessionStartTime,\n      },\n    });\n  }\n\n  /**\n   * 获取性能摘要\n   */\n  getPerformanceSummary(): ThemePerformanceSummary {\n    return ThemeAnalyticsUtils.generatePerformanceSummary(this.performanceMetrics, this.usageStats);\n  }\n\n  /**\n   * 获取主题使用统计\n   */\n  getUsageStatistics(): ThemeUsageStats[] {\n    return Array.from(this.usageStats.values()).sort(\n      (a, b) => b.count - a.count,\n    );\n  }\n\n  /**\n   * 发送性能报告到Sentry\n   */\n  sendPerformanceReport(): void {\n    if (!this.config.enabled) return;\n\n    const summary = this.getPerformanceSummary();\n    const usageStats = this.getUsageStatistics();\n\n    // 发送性能摘要\n    Sentry.addBreadcrumb({\n      category: 'theme-analytics',\n      message: 'Theme performance report',\n      level: 'info',\n      data: ThemeAnalyticsUtils.formatPerformanceData(summary),\n    });\n\n    // 发送使用统计\n    Sentry.setContext('theme-usage', {\n      statistics: usageStats.slice(0, 5), // 只发送前5个最常用的主题\n      totalThemes: usageStats.length,\n      sessionDuration: Date.now() - this.sessionStartTime,\n    });\n\n    // 发送切换模式分析\n    if (this.config.enableUserBehaviorAnalysis && this.switchPatterns.length > 0) {\n      const topPatterns = this.switchPatterns\n        .sort((a, b) => b.frequency - a.frequency)\n        .slice(0, 3);\n\n      Sentry.setContext('theme-patterns', {\n        topPatterns: topPatterns.map(p => ({\n          sequence: p.sequence.join(' → '),\n          frequency: p.frequency,\n          avgDuration: Math.round(p.avgDuration),\n        })),\n      });\n    }\n\n    // 发送自定义事件\n    Sentry.captureMessage('Theme Analytics Report', 'info');\n  }\n\n  /**\n   * 重置分析数据\n   */\n  reset(): void {\n    this.performanceMetrics = [];\n    this.usageStats.clear();\n    this.switchPatterns = [];\n    this.sessionStartTime = Date.now();\n    this.lastSwitchTime = 0;\n  }\n\n  /**\n   * 获取配置\n   */\n  getConfig(): ThemeAnalyticsConfig {\n    return { ...this.config };\n  }\n\n  /**\n   * 更新配置\n   */\n  updateConfig(newConfig: Partial<ThemeAnalyticsConfig>): void {\n    this.config = { ...this.config, ...newConfig };\n  }\n\n  /**\n   * 清理旧数据\n   */\n  private cleanupOldData(): void {\n    const hoursInDay = 24;\n    const minutesInHour = 60;\n    const secondsInMinute = 60;\n    const millisecondsInSecond = 1000;\n    const maxAge = hoursInDay * minutesInHour * secondsInMinute * millisecondsInSecond; // 24小时\n\n    ThemeAnalyticsUtils.cleanupOldData(this.performanceMetrics, maxAge);\n\n    // 清理使用统计中的过期数据\n    const cutoffTime = Date.now() - maxAge;\n    for (const [theme, stats] of this.usageStats.entries()) {\n      if (stats.lastUsed < cutoffTime) {\n        this.usageStats.delete(theme);\n      }\n    }\n\n    // 清理切换模式数据（保留最近的模式）\n    if (this.switchPatterns.length > 50) {\n      this.switchPatterns = this.switchPatterns\n        .sort((a, b) => b.frequency - a.frequency)\n        .slice(0, 30);\n    }\n  }\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/theme-analytics-types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/theme-analytics-utils.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'ThemeAnalyticsConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":11,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":23,"suggestions":[{"messageId":"removeVar","data":{"varName":"ThemeAnalyticsConfig"},"fix":{"range":[183,207],"text":""},"desc":"Remove unused variable 'ThemeAnalyticsConfig'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ThemeAnalyticsConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":11,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":11,"endColumn":23},{"ruleId":"max-params","severity":2,"message":"Static method 'updateUsageStats' has too many parameters (4). Maximum allowed is 3.","line":85,"column":3,"nodeType":"FunctionExpression","messageId":"exceed","endLine":85,"endColumn":26},{"ruleId":"max-params","severity":2,"message":"Static method 'analyzeSwitchPattern' has too many parameters (4). Maximum allowed is 3.","line":109,"column":3,"nodeType":"FunctionExpression","messageId":"exceed","endLine":109,"endColumn":30},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2.","line":124,"column":66,"nodeType":"Literal","messageId":"noMagic","endLine":124,"endColumn":67},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 24.","line":140,"column":22,"nodeType":"Literal","messageId":"noMagic","endLine":140,"endColumn":24},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 60.","line":140,"column":27,"nodeType":"Literal","messageId":"noMagic","endLine":140,"endColumn":29},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 60.","line":140,"column":32,"nodeType":"Literal","messageId":"noMagic","endLine":140,"endColumn":34}],"suppressedMessages":[],"errorCount":8,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 主题分析工具函数\n * Theme analytics utility functions\n */\n\nimport * as Sentry from '@sentry/nextjs';\nimport type { \n  ThemePerformanceMetrics, \n  ThemeUsageStats, \n  ThemeSwitchPattern,\n  ThemeAnalyticsConfig,\n  ThemePerformanceSummary\n} from './theme-analytics-types';\n\n/**\n * 主题分析工具类\n */\nexport class ThemeAnalyticsUtils {\n  /**\n   * 检查是否应该采样\n   */\n  static shouldSample(sampleRate: number): boolean {\n    // 使用crypto.getRandomValues()替代Math.random()以提高安全性\n    if (typeof crypto !== 'undefined' && crypto.getRandomValues) {\n      const array = new Uint32Array(1);\n      crypto.getRandomValues(array);\n      const maxUint32 = 0xffffffff;\n      const randomValue = array[0] / maxUint32;\n      return randomValue < sampleRate;\n    }\n    \n    // 降级到Math.random()\n    return Math.random() < sampleRate;\n  }\n\n  /**\n   * 获取视口大小\n   */\n  static getViewportSize(): { width: number; height: number } {\n    if (typeof window !== 'undefined') {\n      return {\n        width: window.innerWidth,\n        height: window.innerHeight,\n      };\n    }\n    return { width: 0, height: 0 };\n  }\n\n  /**\n   * 发送性能指标到Sentry\n   */\n  static sendPerformanceMetrics(metrics: ThemePerformanceMetrics): void {\n    Sentry.addBreadcrumb({\n      category: 'theme-performance',\n      message: `Theme switched from ${metrics.fromTheme} to ${metrics.toTheme}`,\n      level: 'info',\n      data: {\n        duration: metrics.switchDuration,\n        supportsViewTransitions: metrics.supportsViewTransitions,\n      },\n    });\n  }\n\n  /**\n   * 报告性能问题\n   */\n  static reportPerformanceIssue(metrics: ThemePerformanceMetrics): void {\n    Sentry.captureMessage(\n      `Slow theme switch detected: ${metrics.switchDuration}ms`,\n      'warning',\n    );\n\n    Sentry.setContext('theme-performance', {\n      fromTheme: metrics.fromTheme,\n      toTheme: metrics.toTheme,\n      duration: metrics.switchDuration,\n      viewportSize: metrics.viewportSize,\n      supportsViewTransitions: metrics.supportsViewTransitions,\n    });\n  }\n\n  /**\n   * 更新使用统计\n   */\n  static updateUsageStats(\n    usageStats: Map<string, ThemeUsageStats>,\n    theme: string,\n    timestamp: number,\n    lastSwitchTime: number,\n  ): void {\n    const existing = usageStats.get(theme);\n    if (existing) {\n      existing.count += 1;\n      existing.lastUsed = timestamp;\n      existing.sessionDuration += timestamp - lastSwitchTime;\n    } else {\n      usageStats.set(theme, {\n        theme,\n        count: 1,\n        lastUsed: timestamp,\n        sessionDuration: 0,\n      });\n    }\n  }\n\n  /**\n   * 分析切换模式\n   */\n  static analyzeSwitchPattern(\n    switchPatterns: ThemeSwitchPattern[],\n    fromTheme: string,\n    toTheme: string,\n    duration: number,\n  ): void {\n    const sequence = [fromTheme, toTheme];\n    const sequenceKey = sequence.join('-');\n    \n    const existing = switchPatterns.find(p => \n      p.sequence.join('-') === sequenceKey\n    );\n\n    if (existing) {\n      existing.frequency += 1;\n      existing.avgDuration = (existing.avgDuration + duration) / 2;\n    } else {\n      switchPatterns.push({\n        sequence,\n        frequency: 1,\n        avgDuration: duration,\n        timeOfDay: new Date().getHours(),\n      });\n    }\n  }\n\n  /**\n   * 清理旧数据\n   */\n  static cleanupOldData(\n    performanceMetrics: ThemePerformanceMetrics[],\n    maxAge: number = 24 * 60 * 60 * 1000, // 24小时\n  ): void {\n    const cutoffTime = Date.now() - maxAge;\n    \n    // 清理性能指标\n    const validMetrics = performanceMetrics.filter(\n      metric => metric.timestamp > cutoffTime\n    );\n    \n    // 清空原数组并添加有效数据\n    performanceMetrics.length = 0;\n    performanceMetrics.push(...validMetrics);\n  }\n\n  /**\n   * 生成性能摘要\n   */\n  static generatePerformanceSummary(\n    performanceMetrics: ThemePerformanceMetrics[],\n    usageStats: Map<string, ThemeUsageStats>,\n  ): ThemePerformanceSummary {\n    if (performanceMetrics.length === 0) {\n      return {\n        totalSwitches: 0,\n        averageDuration: 0,\n        slowSwitches: 0,\n        fastestSwitch: 0,\n        slowestSwitch: 0,\n        mostUsedTheme: 'system',\n        viewTransitionSupport: false,\n      };\n    }\n\n    const durations = performanceMetrics.map(m => m.switchDuration);\n    const averageDuration = durations.reduce((a, b) => a + b, 0) / durations.length;\n    const slowSwitches = durations.filter(d => d > 100).length; // 超过100ms的切换\n    const fastestSwitch = Math.min(...durations);\n    const slowestSwitch = Math.max(...durations);\n    \n    // 找出最常用的主题\n    const usageArray = Array.from(usageStats.values());\n    const mostUsedTheme = usageArray.length > 0 \n      ? usageArray.reduce((a, b) => a.count > b.count ? a : b).theme\n      : 'system';\n\n    // 检查View Transitions支持\n    const viewTransitionSupport = performanceMetrics.some(m => m.supportsViewTransitions);\n\n    return {\n      totalSwitches: performanceMetrics.length,\n      averageDuration,\n      slowSwitches,\n      fastestSwitch,\n      slowestSwitch,\n      mostUsedTheme,\n      viewTransitionSupport,\n    };\n  }\n\n  /**\n   * 格式化性能数据用于报告\n   */\n  static formatPerformanceData(summary: ThemePerformanceSummary): Record<string, unknown> {\n    return {\n      total_switches: summary.totalSwitches,\n      avg_duration_ms: Math.round(summary.averageDuration),\n      slow_switches: summary.slowSwitches,\n      fastest_switch_ms: summary.fastestSwitch,\n      slowest_switch_ms: summary.slowestSwitch,\n      most_used_theme: summary.mostUsedTheme,\n      view_transition_support: summary.viewTransitionSupport,\n    };\n  }\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/theme-analytics.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/translation-benchmarks.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/translation-manager-core.ts","messages":[{"ruleId":"require-await","severity":2,"message":"Async method 'validateTranslations' has no 'await' expression.","line":78,"column":3,"nodeType":"FunctionExpression","messageId":"missingAwait","endLine":78,"endColumn":29,"suggestions":[{"messageId":"removeAsync","fix":{"range":[2304,2310],"text":""},"desc":"Remove 'async'."}]},{"ruleId":"require-await","severity":2,"message":"Async method 'generateQualityReport' has no 'await' expression.","line":85,"column":3,"nodeType":"FunctionExpression","messageId":"missingAwait","endLine":85,"endColumn":30,"suggestions":[{"messageId":"removeAsync","fix":{"range":[2465,2471],"text":""},"desc":"Remove 'async'."}]},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":185,"column":12,"nodeType":"MemberExpression","endLine":185,"endColumn":36},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":204,"column":7,"nodeType":"MemberExpression","endLine":204,"endColumn":20}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Locale } from '@/types/i18n';\nimport {\n  QualityReport,\n  TranslationManagerConfig,\n  TranslationQualityCheck,\n  ValidationReport,\n} from '@/types/translation-manager';\nimport { TranslationManagerSecurity } from './translation-manager-security';\nimport { TranslationQualityManager } from './translation-manager-quality';\nimport { logger } from '@/lib/logger';\n\n/**\n * 翻译管理器核心类\n */\nexport class TranslationManagerCore implements TranslationQualityCheck {\n  private config: TranslationManagerConfig;\n  private translations: Partial<Record<Locale, Record<string, unknown>>> = {};\n  private qualityManager: TranslationQualityManager;\n\n  constructor(config: TranslationManagerConfig) {\n    this.config = config;\n    this.qualityManager = new TranslationQualityManager(config);\n  }\n\n  /**\n   * 加载翻译文件\n   */\n  private async loadTranslations(): Promise<void> {\n    const fs = await import('fs');\n    const path = await import('path');\n\n    for (const locale of this.config.locales) {\n      const filePath = path.join(this.config.messagesDir, `${locale}.json`);\n\n      try {\n        const content = await fs.promises.readFile(filePath, 'utf-8');\n        const translations = JSON.parse(content) as Record<string, unknown>;\n        TranslationManagerSecurity.setTranslationsForLocale(this.translations, locale, translations);\n      } catch (error) {\n        logger.warn(`Failed to load translations for ${locale}`, { error: error as Error });\n        TranslationManagerSecurity.setTranslationsForLocale(this.translations, locale, {});\n      }\n    }\n  }\n\n  /**\n   * 初始化Lingo.dev集成\n   */\n  private initializeLingoIntegration(): void {\n    if (!this.config.lingo.apiKey || !this.config.lingo.projectId) {\n      logger.warn('Lingo.dev integration enabled but missing API key or project ID');\n    } else {\n      logger.info('Lingo.dev integration initialized');\n    }\n  }\n\n  /**\n   * 初始化翻译管理器\n   */\n  async initialize(): Promise<void> {\n    try {\n      await this.loadTranslations();\n\n      if (this.config.lingo.enabled) {\n        this.initializeLingoIntegration();\n      }\n\n      logger.info('Translation manager initialized successfully');\n    } catch (error) {\n      logger.error('Failed to initialize translation manager', { error: error as Error });\n      throw error;\n    }\n  }\n\n  /**\n   * 验证翻译\n   */\n  async validateTranslations(): Promise<ValidationReport> {\n    return this.qualityManager.validateTranslations(this.translations);\n  }\n\n  /**\n   * 生成质量报告\n   */\n  async generateQualityReport(): Promise<QualityReport> {\n    return this.qualityManager.generateQualityReport(this.translations);\n  }\n\n  /**\n   * 获取指定语言的翻译数据\n   */\n  getTranslations(locale: Locale): Record<string, unknown> {\n    return TranslationManagerSecurity.getTranslationsForLocale(this.translations, locale);\n  }\n\n  /**\n   * 设置指定语言的翻译数据\n   */\n  setTranslations(locale: Locale, translations: Record<string, unknown>): void {\n    TranslationManagerSecurity.setTranslationsForLocale(this.translations, locale, translations);\n  }\n\n  /**\n   * 获取所有翻译数据\n   */\n  getAllTranslations(): Partial<Record<Locale, Record<string, unknown>>> {\n    return { ...this.translations };\n  }\n\n  /**\n   * 重新加载翻译文件\n   */\n  async reload(): Promise<void> {\n    this.translations = {};\n    await this.loadTranslations();\n  }\n\n  /**\n   * 获取配置信息\n   */\n  getConfig(): TranslationManagerConfig {\n    return { ...this.config };\n  }\n\n  /**\n   * 更新配置信息\n   */\n  updateConfig(newConfig: Partial<TranslationManagerConfig>): void {\n    this.config = { ...this.config, ...newConfig };\n    this.qualityManager = new TranslationQualityManager(this.config);\n  }\n\n  /**\n   * 检查翻译键是否存在\n   */\n  hasTranslation(locale: Locale, key: string): boolean {\n    if (!TranslationManagerSecurity.isValidTranslationKey(key)) {\n      return false;\n    }\n\n    const translations = this.getTranslations(locale);\n    return TranslationManagerSecurity.getNestedValue(translations, key) !== undefined;\n  }\n\n  /**\n   * 获取翻译值\n   */\n  getTranslation(locale: Locale, key: string): unknown {\n    if (!TranslationManagerSecurity.isValidTranslationKey(key)) {\n      return undefined;\n    }\n\n    const translations = this.getTranslations(locale);\n    return TranslationManagerSecurity.getNestedValue(translations, key);\n  }\n\n  /**\n   * 设置翻译值\n   */\n  setTranslation(locale: Locale, key: string, value: unknown): void {\n    if (!TranslationManagerSecurity.isValidTranslationKey(key)) {\n      logger.warn(`Invalid translation key: ${key}`);\n      return;\n    }\n\n    const translations = this.getTranslations(locale);\n    const updatedTranslations = TranslationManagerSecurity.mergeTranslations(translations, {\n      [key]: value,\n    });\n\n    this.setTranslations(locale, updatedTranslations);\n  }\n\n  /**\n   * 删除翻译键\n   */\n  deleteTranslation(locale: Locale, key: string): void {\n    if (!TranslationManagerSecurity.isValidTranslationKey(key)) {\n      logger.warn(`Invalid translation key: ${key}`);\n      return;\n    }\n\n    const translations = this.getTranslations(locale);\n    const updatedTranslations = { ...translations };\n    delete updatedTranslations[key];\n\n    this.setTranslations(locale, updatedTranslations);\n  }\n\n  /**\n   * 获取翻译统计信息\n   */\n  getStatistics(): Record<Locale, { total: number; translated: number; missing: number }> {\n    const stats: Record<Locale, { total: number; translated: number; missing: number }> = {} as Record<Locale, { total: number; translated: number; missing: number }>;\n\n    for (const locale of this.config.locales) {\n      const translations = this.getTranslations(locale);\n      const keys = Object.keys(translations);\n      const translatedKeys = keys.filter(key => {\n        const value = TranslationManagerSecurity.getNestedValue(translations, key);\n        return value !== undefined && value !== null && value !== '';\n      });\n\n      stats[locale] = {\n        total: keys.length,\n        translated: translatedKeys.length,\n        missing: keys.length - translatedKeys.length,\n      };\n    }\n\n    return stats;\n  }\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/translation-manager-quality.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'QualityTrendReport' is defined but never used. Allowed unused vars must match /^_/u.","line":8,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"QualityTrendReport"},"fix":{"range":[134,156],"text":""},"desc":"Remove unused variable 'QualityTrendReport'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'QualityTrendReport' is defined but never used. Allowed unused vars must match /^_/u.","line":8,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":21},{"ruleId":"no-unused-vars","severity":2,"message":"'DETECTION_SCORING' is defined but never used. Allowed unused vars must match /^_/u.","line":13,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":20,"suggestions":[{"messageId":"removeVar","data":{"varName":"DETECTION_SCORING"},"fix":{"range":[255,273],"text":""},"desc":"Remove unused variable 'DETECTION_SCORING'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'DETECTION_SCORING' is defined but never used. Allowed unused vars must match /^_/u.","line":13,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":13,"endColumn":20},{"ruleId":"no-unused-vars","severity":2,"message":"'PERFORMANCE_THRESHOLDS' is defined but never used. Allowed unused vars must match /^_/u.","line":14,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"PERFORMANCE_THRESHOLDS"},"fix":{"range":[272,298],"text":""},"desc":"Remove unused variable 'PERFORMANCE_THRESHOLDS'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'PERFORMANCE_THRESHOLDS' is defined but never used. Allowed unused vars must match /^_/u.","line":14,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":14,"endColumn":25},{"ruleId":"no-unused-vars","severity":2,"message":"'getNestedValue' is defined but never used. Allowed unused vars must match /^_/u.","line":23,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":23,"endColumn":17,"suggestions":[{"messageId":"removeVar","data":{"varName":"getNestedValue"},"fix":{"range":[534,552],"text":""},"desc":"Remove unused variable 'getNestedValue'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'getNestedValue' is defined but never used. Allowed unused vars must match /^_/u.","line":23,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":23,"endColumn":17},{"ruleId":"no-restricted-syntax","severity":2,"message":"Using 'ForInStatement' is not allowed.","line":159,"column":5,"nodeType":"ForInStatement","messageId":"restrictedSyntax","endLine":179,"endColumn":6},{"ruleId":"require-await","severity":2,"message":"Async method 'getQualityTrends' has no 'await' expression.","line":249,"column":3,"nodeType":"FunctionExpression","messageId":"missingAwait","endLine":249,"endColumn":33,"suggestions":[{"messageId":"removeAsync","fix":{"range":[7217,7223],"text":""},"desc":"Remove 'async'."}]}],"suppressedMessages":[],"errorCount":10,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Locale } from '@/types/i18n';\nimport {\n  LocaleQualityReport,\n  QualityIssue,\n  QualityReport,\n  QualityScore,\n  QualityTrend,\n  QualityTrendReport,\n  TranslationManagerConfig,\n  ValidationReport,\n} from '@/types/translation-manager';\nimport {\n  DETECTION_SCORING,\n  PERFORMANCE_THRESHOLDS,\n  QUALITY_SCORING,\n} from '@/constants/i18n-constants';\nimport { TranslationQualityChecker } from './translation-quality-checker';\nimport {\n  calculateConfidence,\n  flattenTranslations,\n  generateRecommendations,\n  generateSuggestions,\n  getNestedValue,\n  isEmptyTranslation,\n} from './translation-utils';\nimport { TranslationManagerSecurity } from './translation-manager-security';\n\n/**\n * 翻译质量管理器\n * 负责翻译质量检查、评分和报告生成\n */\nexport class TranslationQualityManager {\n  private config: TranslationManagerConfig;\n  private qualityChecker: TranslationQualityChecker;\n\n  constructor(config: TranslationManagerConfig) {\n    this.config = config;\n    this.qualityChecker = new TranslationQualityChecker(config);\n  }\n\n  /**\n   * 验证翻译\n   */\n  async validateTranslations(\n    translations: Partial<Record<Locale, Record<string, unknown>>>,\n  ): Promise<ValidationReport> {\n    const issues: QualityIssue[] = [];\n    const byLocale: Record<Locale, LocaleQualityReport> = {} as Record<Locale, LocaleQualityReport>;\n\n    for (const locale of this.config.locales) {\n      const localeTranslations = TranslationManagerSecurity.getTranslationsForLocale(translations, locale);\n      const flatTranslations = flattenTranslations(localeTranslations);\n\n      // 检查缺失的翻译\n      const missingKeys = this.findMissingTranslations(flatTranslations, locale);\n      issues.push(...missingKeys);\n\n      // 检查空翻译\n      const emptyKeys = this.findEmptyTranslations(flatTranslations, locale);\n      issues.push(...emptyKeys);\n\n      // 质量检查\n      const qualityIssues = await this.qualityChecker.checkTranslations(\n        flatTranslations,\n        locale,\n      );\n      issues.push(...qualityIssues);\n\n      // 生成本地化报告\n      const localeReport: LocaleQualityReport = {\n        locale,\n        totalKeys: Object.keys(flatTranslations).length,\n        translatedKeys: Object.keys(flatTranslations).filter(\n          key => !isEmptyTranslation(TranslationManagerSecurity.getTranslationValue(flatTranslations, key) || ''),\n        ).length,\n        missingKeys: missingKeys.length,\n        emptyKeys: emptyKeys.length,\n        qualityIssues: qualityIssues.length,\n        score: this.calculateQualityScore(flatTranslations, qualityIssues),\n      };\n\n      TranslationManagerSecurity.setQualityScoreForLocale(byLocale, locale, localeReport.score);\n    }\n\n    return {\n      isValid: issues.length === 0,\n      issues,\n      byLocale,\n      summary: {\n        totalIssues: issues.length,\n        criticalIssues: issues.filter(issue => issue.severity === 'critical').length,\n        warningIssues: issues.filter(issue => issue.severity === 'warning').length,\n        infoIssues: issues.filter(issue => issue.severity === 'info').length,\n      },\n    };\n  }\n\n  /**\n   * 生成质量报告\n   */\n  async generateQualityReport(\n    translations: Partial<Record<Locale, Record<string, unknown>>>,\n  ): Promise<QualityReport> {\n    const validation = await this.validateTranslations(translations);\n    const trends = await this.getQualityTrends();\n\n    return {\n      timestamp: new Date().toISOString(),\n      validation,\n      trends: {\n        period: '30d',\n        trends,\n      },\n      recommendations: generateRecommendations(validation.issues),\n      suggestions: generateSuggestions(validation.issues),\n    };\n  }\n\n  /**\n   * 查找缺失的翻译\n   */\n  private findMissingTranslations(\n    flatTranslations: Record<string, string>,\n    locale: Locale,\n  ): QualityIssue[] {\n    const issues: QualityIssue[] = [];\n    const requiredKeys = this.config.requiredKeys || [];\n\n    for (const key of requiredKeys) {\n      if (!TranslationManagerSecurity.isValidTranslationKey(key)) {\n        continue;\n      }\n\n      const value = TranslationManagerSecurity.getTranslationValue(flatTranslations, key);\n      if (!value) {\n        issues.push({\n          type: 'missing_translation',\n          severity: 'critical',\n          locale,\n          key,\n          message: `Missing translation for key: ${key}`,\n          suggestion: `Add translation for key \"${key}\" in ${locale} locale`,\n        });\n      }\n    }\n\n    return issues;\n  }\n\n  /**\n   * 查找空翻译\n   */\n  private findEmptyTranslations(\n    flatTranslations: Record<string, string>,\n    locale: Locale,\n  ): QualityIssue[] {\n    const issues: QualityIssue[] = [];\n\n    for (const key in flatTranslations) {\n      if (!Object.prototype.hasOwnProperty.call(flatTranslations, key)) {\n        continue;\n      }\n\n      if (!TranslationManagerSecurity.isValidTranslationKey(key)) {\n        continue;\n      }\n\n      const value = TranslationManagerSecurity.getTranslationValue(flatTranslations, key);\n      if (value && isEmptyTranslation(value)) {\n        issues.push({\n          type: 'empty_translation',\n          severity: 'warning',\n          locale,\n          key,\n          message: `Empty translation for key: ${key}`,\n          suggestion: `Provide content for key \"${key}\" in ${locale} locale`,\n        });\n      }\n    }\n\n    return issues;\n  }\n\n  /**\n   * 计算质量评分\n   */\n  private calculateQualityScore(\n    flatTranslations: Record<string, string>,\n    qualityIssues: QualityIssue[],\n  ): QualityScore {\n    const totalKeys = Object.keys(flatTranslations).length;\n    const translatedKeys = Object.keys(flatTranslations).filter(\n      key => {\n        const value = TranslationManagerSecurity.getTranslationValue(flatTranslations, key);\n        return value && !isEmptyTranslation(value);\n      },\n    ).length;\n\n    const completeness = totalKeys > 0 ? (translatedKeys / totalKeys) * 100 : 0;\n    const accuracy = this.calculateAccuracy(qualityIssues);\n    const consistency = this.calculateConsistency(flatTranslations);\n\n    const overall = (completeness + accuracy + consistency) / 3;\n\n    return {\n      overall: Math.round(overall * 100) / 100,\n      completeness: Math.round(completeness * 100) / 100,\n      accuracy: Math.round(accuracy * 100) / 100,\n      consistency: Math.round(consistency * 100) / 100,\n      confidence: calculateConfidence(qualityIssues),\n    };\n  }\n\n  /**\n   * 计算准确性评分\n   */\n  private calculateAccuracy(qualityIssues: QualityIssue[]): number {\n    const criticalIssues = qualityIssues.filter(issue => issue.severity === 'critical').length;\n    const warningIssues = qualityIssues.filter(issue => issue.severity === 'warning').length;\n\n    // 基础分数\n    let score = 100;\n\n    // 扣分规则\n    score -= criticalIssues * QUALITY_SCORING.CRITICAL_PENALTY;\n    score -= warningIssues * QUALITY_SCORING.WARNING_PENALTY;\n\n    return Math.max(0, score);\n  }\n\n  /**\n   * 计算一致性评分\n   */\n  private calculateConsistency(flatTranslations: Record<string, string>): number {\n    // 简化的一致性检查\n    // 实际实现可以包括术语一致性、格式一致性等\n    const values = Object.values(flatTranslations);\n    const uniqueValues = new Set(values);\n\n    // 如果有重复的翻译值，可能存在一致性问题\n    const duplicateRatio = (values.length - uniqueValues.size) / values.length;\n    \n    return Math.max(0, 100 - duplicateRatio * 50);\n  }\n\n  /**\n   * 获取质量趋势\n   */\n  private async getQualityTrends(): Promise<QualityTrend[]> {\n    // 这里可以实现质量趋势分析\n    // 例如从历史数据中获取质量变化趋势\n    return Promise.resolve([]);\n  }\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/translation-manager-security.ts","messages":[{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":94,"column":5,"nodeType":"MemberExpression","endLine":94,"endColumn":16},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":118,"column":14,"nodeType":"MemberExpression","endLine":118,"endColumn":35},{"ruleId":"no-restricted-syntax","severity":2,"message":"Using 'ForInStatement' is not allowed.","line":155,"column":5,"nodeType":"ForInStatement","messageId":"restrictedSyntax","endLine":163,"endColumn":6},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":158,"column":11,"nodeType":"MemberExpression","endLine":158,"endColumn":22},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":158,"column":25,"nodeType":"MemberExpression","endLine":158,"endColumn":36},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":184,"column":19,"nodeType":"MemberExpression","endLine":184,"endColumn":31}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Locale } from '@/types/i18n';\nimport { QualityScore } from '@/types/translation-manager';\n\n/**\n * 翻译管理器安全工具类\n * 提供安全的数据访问和设置方法，防止 Object Injection Sink\n */\nexport class TranslationManagerSecurity {\n  /**\n   * 安全地获取指定语言的翻译数据\n   * 使用类型安全的方式避免 Object Injection Sink\n   */\n  static getTranslationsForLocale(\n    translations: Partial<Record<Locale, Record<string, unknown>>>,\n    locale: Locale,\n  ): Record<string, unknown> {\n    // 使用 switch 语句替代动态属性访问\n    switch (locale) {\n      case 'en':\n        return translations.en || {};\n      case 'zh':\n        return translations.zh || {};\n      default:\n        return {};\n    }\n  }\n\n  /**\n   * 安全地设置指定语言的翻译数据\n   */\n  static setTranslationsForLocale(\n    translations: Partial<Record<Locale, Record<string, unknown>>>,\n    locale: Locale,\n    data: Record<string, unknown>,\n  ): void {\n    // 使用 switch 语句替代动态属性访问\n    switch (locale) {\n      case 'en':\n        translations.en = data;\n        break;\n      case 'zh':\n        translations.zh = data;\n        break;\n      default:\n        // 忽略不支持的语言\n        break;\n    }\n  }\n\n  /**\n   * 安全地设置质量评分数据\n   */\n  static setQualityScoreForLocale(\n    byLocale: Record<Locale, QualityScore>,\n    locale: Locale,\n    score: QualityScore,\n  ): void {\n    // 使用 switch 语句替代动态属性访问\n    switch (locale) {\n      case 'en':\n        byLocale.en = score;\n        break;\n      case 'zh':\n        byLocale.zh = score;\n        break;\n      default:\n        // 忽略不支持的语言\n        break;\n    }\n  }\n\n  /**\n   * 安全地设置翻译结果\n   * 验证键名以防止 Object Injection Sink\n   */\n  static setTranslationResult(\n    result: Record<string, string>,\n    key: string,\n    translation: string,\n  ): void {\n    // 验证键名格式，只允许字母、数字、点、下划线和连字符\n    if (!/^[a-zA-Z0-9._-]+$/.test(key)) {\n      console.warn(`Invalid translation key format: ${key}`);\n      return;\n    }\n\n    // 验证键名长度\n    if (key.length > 200) {\n      console.warn(`Translation key too long: ${key}`);\n      return;\n    }\n\n    // 安全地设置值\n    result[key] = translation;\n  }\n\n  /**\n   * 安全地获取扁平化翻译值\n   */\n  static getTranslationValue(\n    flatTranslations: Record<string, string>,\n    key: string,\n  ): string | undefined {\n    // 验证键名格式\n    if (!/^[a-zA-Z0-9._-]+$/.test(key)) {\n      console.warn(`Invalid translation key format: ${key}`);\n      return undefined;\n    }\n\n    // 验证键名长度\n    if (key.length > 200) {\n      console.warn(`Translation key too long: ${key}`);\n      return undefined;\n    }\n\n    // 使用 Object.prototype.hasOwnProperty 安全检查\n    if (Object.prototype.hasOwnProperty.call(flatTranslations, key)) {\n      return flatTranslations[key];\n    }\n\n    return undefined;\n  }\n\n  /**\n   * 验证翻译键名是否安全\n   */\n  static isValidTranslationKey(key: string): boolean {\n    // 检查格式\n    if (!/^[a-zA-Z0-9._-]+$/.test(key)) {\n      return false;\n    }\n\n    // 检查长度\n    if (key.length > 200) {\n      return false;\n    }\n\n    // 检查是否为空\n    if (key.trim().length === 0) {\n      return false;\n    }\n\n    return true;\n  }\n\n  /**\n   * 安全地合并翻译对象\n   */\n  static mergeTranslations(\n    target: Record<string, unknown>,\n    source: Record<string, unknown>,\n  ): Record<string, unknown> {\n    const result = { ...target };\n\n    for (const key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        if (this.isValidTranslationKey(key)) {\n          result[key] = source[key];\n        } else {\n          console.warn(`Skipping invalid translation key: ${key}`);\n        }\n      }\n    }\n\n    return result;\n  }\n\n  /**\n   * 安全地获取嵌套对象值\n   */\n  static getNestedValue(\n    obj: Record<string, unknown>,\n    path: string,\n  ): unknown {\n    const keys = path.split('.');\n    let current = obj;\n\n    for (const key of keys) {\n      if (!this.isValidTranslationKey(key)) {\n        return undefined;\n      }\n\n      if (current && typeof current === 'object' && Object.prototype.hasOwnProperty.call(current, key)) {\n        current = current[key] as Record<string, unknown>;\n      } else {\n        return undefined;\n      }\n    }\n\n    return current;\n  }\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/translation-manager.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/translation-quality-checker.ts","messages":[{"ruleId":"max-statements","severity":2,"message":"Async method 'checkLingoTranslation' has too many statements (25). Maximum allowed is 20.","line":43,"column":30,"nodeType":"FunctionExpression","messageId":"exceed","endLine":125,"endColumn":4}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Locale } from '@/types/i18n';\nimport {\n  QualityIssue,\n  QualityScore,\n  TranslationManagerConfig,\n  ValidationReport,\n} from '@/types/translation-manager';\nimport {\n  PERFORMANCE_THRESHOLDS,\n  QUALITY_WEIGHTS,\n  VALIDATION_THRESHOLDS,\n} from '@/constants/i18n-constants';\nimport {\n  calculateConfidence,\n  checkTerminologyConsistency,\n  extractPlaceholders,\n  flattenTranslations,\n  generateRecommendations,\n  generateSuggestions,\n  getNestedValue,\n} from './translation-utils';\n\n/**\n * 翻译质量检查器\n */\nexport class TranslationQualityChecker {\n  private config: TranslationManagerConfig;\n  private translations: Partial<Record<Locale, Record<string, unknown>>> = {};\n  private qualityCache: Map<string, QualityScore> = new Map();\n  private terminologyMap: Map<string, string> = new Map();\n\n  constructor(\n    config: TranslationManagerConfig,\n    translations: Partial<Record<Locale, Record<string, unknown>>>,\n  ) {\n    this.config = config;\n    this.translations = translations;\n  }\n\n  /**\n   * 检查Lingo.dev翻译质量\n   */\n  async checkLingoTranslation(\n    key: string,\n    aiTranslation: string,\n    humanTranslation?: string,\n  ): Promise<QualityScore> {\n    const cacheKey = `${key}:${aiTranslation}`;\n\n    // 检查缓存\n    if (this.qualityCache.has(cacheKey)) {\n      return this.qualityCache.get(cacheKey)!;\n    }\n\n    const issues: QualityIssue[] = [];\n    let score = 100;\n\n    // 基础质量检查\n    if (aiTranslation.trim().length === 0) {\n      issues.push({\n        type: 'length',\n        severity: 'critical',\n        message: 'Translation is empty',\n        suggestion: 'Provide a non-empty translation',\n      });\n      score -= VALIDATION_THRESHOLDS.EMPTY_TRANSLATION_PENALTY;\n    }\n\n    // 占位符检查\n    const aiPlaceholders = extractPlaceholders(aiTranslation);\n    if (humanTranslation) {\n      const humanPlaceholders = extractPlaceholders(humanTranslation);\n\n      if (\n        JSON.stringify(aiPlaceholders.sort()) !==\n        JSON.stringify(humanPlaceholders.sort())\n      ) {\n        issues.push({\n          type: 'placeholder',\n          severity: 'high',\n          message: 'Placeholder mismatch between AI and human translation',\n          suggestion: 'Ensure all placeholders are preserved',\n        });\n        score -= VALIDATION_THRESHOLDS.PLACEHOLDER_MISMATCH_PENALTY;\n      }\n    }\n\n    // 长度比例检查\n    if (humanTranslation) {\n      const lengthRatio = aiTranslation.length / humanTranslation.length;\n      if (\n        lengthRatio > VALIDATION_THRESHOLDS.MAX_LENGTH_RATIO ||\n        lengthRatio < VALIDATION_THRESHOLDS.MIN_LENGTH_RATIO\n      ) {\n        issues.push({\n          type: 'length',\n          severity: 'medium',\n          message: `Translation length ratio is unusual: ${lengthRatio.toFixed(QUALITY_WEIGHTS.LENGTH_PENALTY / QUALITY_WEIGHTS.LENGTH_PENALTY)}`,\n          suggestion: 'Review translation for completeness and accuracy',\n        });\n        score -= QUALITY_WEIGHTS.GRAMMAR_PENALTY;\n      }\n    }\n\n    // 术语一致性检查\n    const terminologyIssues = await checkTerminologyConsistency(\n      key,\n      aiTranslation,\n      this.terminologyMap,\n    );\n    issues.push(...terminologyIssues);\n    score -= terminologyIssues.length * QUALITY_WEIGHTS.LENGTH_PENALTY;\n\n    const qualityScore: QualityScore = {\n      score: Math.max(0, score),\n      confidence: calculateConfidence(issues),\n      issues,\n      suggestions: generateSuggestions(issues),\n    };\n\n    // 缓存结果\n    this.qualityCache.set(cacheKey, qualityScore);\n\n    return qualityScore;\n  }\n\n  /**\n   * 验证翻译一致性\n   */\n  validateTranslationConsistency(\n    translations: Record<string, string>,\n  ): Promise<ValidationReport> {\n    const issues: QualityIssue[] = [];\n    let totalScore = 0;\n    let validTranslations = 0;\n\n    for (const [key, translation] of Object.entries(translations)) {\n      if (!translation || translation.trim().length === 0) {\n        issues.push({\n          type: 'consistency',\n          severity: 'high',\n          message: `Missing translation for key: ${key}`,\n        });\n        continue;\n      }\n\n      // 检查占位符一致性\n      const placeholders = extractPlaceholders(translation);\n      const expectedPlaceholders = this.getExpectedPlaceholders(key);\n\n      if (\n        JSON.stringify(placeholders.sort()) !==\n        JSON.stringify(expectedPlaceholders.sort())\n      ) {\n        issues.push({\n          type: 'placeholder',\n          severity: 'medium',\n          message: `Placeholder inconsistency in key: ${key}`,\n        });\n      }\n\n      validTranslations += 1;\n      totalScore += PERFORMANCE_THRESHOLDS.MAX_MEMORY_USAGE; // 基础分数\n    }\n\n    const averageScore =\n      validTranslations > 0 ? totalScore / validTranslations : 0;\n    const finalScore = Math.max(\n      0,\n      averageScore - issues.length * QUALITY_WEIGHTS.LENGTH_PENALTY,\n    );\n\n    return Promise.resolve({\n      isValid:\n        issues.filter(\n          (issue) => issue.severity === 'critical' || issue.severity === 'high',\n        ).length === 0,\n      score: finalScore,\n      issues,\n      recommendations: generateRecommendations(issues),\n      timestamp: new Date().toISOString(),\n    });\n  }\n\n  /**\n   * 获取预期占位符\n   */\n  private getExpectedPlaceholders(key: string): string[] {\n    // 从默认语言获取预期占位符\n    const defaultTranslation = getNestedValue(\n      this.translations[this.config.defaultLocale] || {},\n      key,\n    );\n\n    if (!defaultTranslation) {\n      return [];\n    }\n\n    return extractPlaceholders(defaultTranslation);\n  }\n\n  /**\n   * 获取翻译键总数\n   */\n  getTotalTranslationKeys(): number {\n    const defaultTranslations =\n      this.translations[this.config.defaultLocale] || {};\n    return Object.keys(flattenTranslations(defaultTranslations)).length;\n  }\n\n  /**\n   * 设置术语映射\n   */\n  setTerminologyMap(terminologyMap: Map<string, string>): void {\n    this.terminologyMap = terminologyMap;\n  }\n\n  /**\n   * 清除质量缓存\n   */\n  clearQualityCache(): void {\n    this.qualityCache.clear();\n  }\n\n  /**\n   * 获取缓存统计\n   */\n  getCacheStats(): { size: number; hitRate: number } {\n    return {\n      size: this.qualityCache.size,\n      hitRate: 0, // 需要实现命中率统计\n    };\n  }\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/translation-quality-types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/translation-quality.ts","messages":[{"ruleId":"max-params","severity":2,"message":"Async method 'validateAITranslation' has too many parameters (5). Maximum allowed is 3.","line":46,"column":3,"nodeType":"FunctionExpression","messageId":"exceed","endLine":46,"endColumn":30},{"ruleId":"require-await","severity":2,"message":"Async method 'generateQualityReport' has no 'await' expression.","line":159,"column":3,"nodeType":"FunctionExpression","messageId":"missingAwait","endLine":159,"endColumn":30,"suggestions":[{"messageId":"removeAsync","fix":{"range":[3852,3858],"text":""},"desc":"Remove 'async'."}]},{"ruleId":"require-await","severity":2,"message":"Async method 'validateContextConsistency' has no 'await' expression.","line":166,"column":3,"nodeType":"FunctionExpression","messageId":"missingAwait","endLine":166,"endColumn":43,"suggestions":[{"messageId":"removeAsync","fix":{"range":[4039,4045],"text":""},"desc":"Remove 'async'."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 翻译质量检查和AI翻译验证工具\n * 提供翻译质量评估、AI翻译验证和质量基准对比功能\n */\nimport { Locale } from '@/types/i18n';\nimport {\n  QualityIssue,\n  QualityScore,\n  TranslationManagerConfig,\n  ValidationReport,\n} from '@/types/translation-manager';\nimport { TranslationBenchmarks } from './translation-benchmarks';\nimport { TranslationManager } from './translation-manager';\nimport {\n  BatchTranslationInput,\n  QualityComparison,\n} from './translation-quality-types';\nimport { TranslationValidators } from './translation-validators';\n\n// 导入拆分的模块\nexport * from './translation-quality-types';\n\n/**\n * 翻译质量分析器\n */\nexport class TranslationQualityAnalyzer {\n  private translationManager: TranslationManager;\n  private benchmarks: TranslationBenchmarks;\n\n  constructor(config: TranslationManagerConfig) {\n    this.translationManager = new TranslationManager(config);\n    this.benchmarks = new TranslationBenchmarks();\n  }\n\n  /**\n   * 初始化质量分析器\n   */\n  async initialize(): Promise<void> {\n    await this.translationManager.initialize();\n    this.benchmarks.initialize();\n  }\n\n  /**\n   * 验证AI翻译质量\n   */\n  async validateAITranslation(\n    key: string,\n    originalText: string,\n    aiTranslation: string,\n    targetLocale: Locale,\n    humanTranslation?: string,\n  ): Promise<QualityScore> {\n    const issues: QualityIssue[] = [];\n    let totalPenalty = 0;\n\n    // 基础验证\n    const basicResult = TranslationValidators.performBasicValidation(\n      originalText,\n      aiTranslation,\n    );\n    issues.push(...basicResult.issues);\n    totalPenalty += basicResult.penalty;\n\n    // 语言特定验证\n    const languageResult =\n      TranslationValidators.performLanguageSpecificValidation(\n        aiTranslation,\n        targetLocale,\n      );\n    issues.push(...languageResult.issues);\n    totalPenalty += languageResult.penalty;\n\n    // 上下文一致性验证\n    const contextResult = await this.validateContextConsistency(\n      key,\n      aiTranslation,\n      targetLocale,\n    );\n    issues.push(...contextResult.issues);\n    totalPenalty += contextResult.penalty;\n\n    // 与人工翻译对比（如果提供）\n    if (humanTranslation) {\n      const humanResult = TranslationValidators.compareWithHumanTranslation(\n        aiTranslation,\n        humanTranslation,\n      );\n      issues.push(...humanResult.issues);\n      totalPenalty += humanResult.penalty;\n    }\n\n    // 计算最终分数\n    const baseScore = 100;\n    const finalScore = Math.max(0, baseScore - totalPenalty);\n\n    const confidence = this.calculateConfidence(issues, Boolean(humanTranslation));\n    const suggestions = this.generateImprovementSuggestions(issues);\n\n    return {\n      score: finalScore,\n      confidence,\n      issues,\n      suggestions,\n      // 分类分数\n      grammar: Math.max(\n        0,\n        100 - issues.filter((i) => i.type === 'grammar').length * 10,\n      ),\n      consistency: Math.max(\n        0,\n        100 - issues.filter((i) => i.type === 'consistency').length * 15,\n      ),\n      terminology: Math.max(\n        0,\n        100 - issues.filter((i) => i.type === 'terminology').length * 12,\n      ),\n      fluency: Math.max(\n        0,\n        100 - issues.filter((i) => i.type === 'fluency').length * 8,\n      ),\n    };\n  }\n\n  /**\n   * 批量验证翻译质量\n   */\n  async batchValidateTranslations(\n    translations: BatchTranslationInput[],\n  ): Promise<QualityScore[]> {\n    const results: QualityScore[] = [];\n\n    for (const translation of translations) {\n      const result = await this.validateAITranslation(\n        translation.key,\n        translation.original,\n        translation.translated,\n        translation.locale,\n        translation.humanReference,\n      );\n      results.push(result);\n    }\n\n    return results;\n  }\n\n  /**\n   * 与质量基准对比\n   */\n  compareWithBenchmark(\n    currentScore: QualityScore,\n    locale: Locale,\n  ): QualityComparison {\n    return this.benchmarks.compareWithBenchmark(currentScore, locale);\n  }\n\n  /**\n   * 生成质量报告\n   */\n  async generateQualityReport(_locale?: Locale): Promise<ValidationReport> {\n    return this.translationManager.validateTranslationConsistency({});\n  }\n\n  /**\n   * 验证上下文一致性\n   */\n  private async validateContextConsistency(\n    key: string,\n    translation: string,\n    locale: Locale,\n  ): Promise<{ issues: QualityIssue[]; penalty: number }> {\n    const issues: QualityIssue[] = [];\n    let penalty = 0;\n\n    // 检查术语一致性\n    const terminologyIssues = this.checkTerminologyConsistency(\n      key,\n      translation,\n      locale,\n    );\n    issues.push(...terminologyIssues);\n    penalty += terminologyIssues.length * 5;\n\n    // 检查上下文相关性\n    const contextIssues = TranslationValidators.checkContextRelevance(\n      key,\n      translation,\n    );\n    issues.push(...contextIssues);\n    penalty += contextIssues.length * 8;\n\n    return { issues, penalty };\n  }\n\n  /**\n   * 检查术语一致性\n   */\n  private checkTerminologyConsistency(\n    _key: string,\n    _translation: string,\n    _locale: Locale,\n  ): QualityIssue[] {\n    // 这里可以实现术语词典检查\n    return [];\n  }\n\n  /**\n   * 计算置信度\n   */\n  private calculateConfidence(\n    issues: QualityIssue[],\n    hasHumanReference: boolean,\n  ): number {\n    let confidence = 0.8; // 基础置信度\n\n    if (hasHumanReference) {\n      confidence += 0.2; // 有人工参考提高置信度\n    }\n\n    // 根据问题严重程度调整置信度\n    const highSeverityIssues = issues.filter(\n      (i) => i.severity === 'high',\n    ).length;\n    const mediumSeverityIssues = issues.filter(\n      (i) => i.severity === 'medium',\n    ).length;\n\n    confidence -= highSeverityIssues * 0.1;\n    confidence -= mediumSeverityIssues * 0.05;\n\n    return Math.max(0.1, Math.min(1.0, confidence));\n  }\n\n  /**\n   * 生成改进建议\n   */\n  private generateImprovementSuggestions(issues: QualityIssue[]): string[] {\n    const suggestions = new Set<string>();\n\n    issues.forEach((issue) => {\n      if (issue.suggestion) {\n        suggestions.add(issue.suggestion);\n      }\n    });\n\n    return Array.from(suggestions);\n  }\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/translation-utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/translation-validators.ts","messages":[{"ruleId":"default-case","severity":2,"message":"Expected a default case.","line":89,"column":5,"nodeType":"SwitchStatement","messageId":"missingDefaultCase","endLine":115,"endColumn":6}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 翻译验证器工具类\n */\nimport { Locale } from '@/types/i18n';\nimport { QualityIssue } from '@/types/translation-manager';\nimport { VALIDATION_THRESHOLDS } from '@/constants/i18n-constants';\nimport { ValidationResult } from './translation-quality-types';\n\nexport class TranslationValidators {\n  /**\n   * 基础验证\n   */\n  static performBasicValidation(\n    original: string,\n    translation: string,\n  ): ValidationResult {\n    const issues: QualityIssue[] = [];\n    let penalty = 0;\n\n    // 检查空翻译\n    if (!translation.trim()) {\n      issues.push({\n        type: 'missing',\n        severity: 'high',\n        message: 'Translation is empty',\n        suggestion: 'Provide a translation for this text',\n      });\n      penalty += VALIDATION_THRESHOLDS.EMPTY_TRANSLATION_PENALTY;\n    }\n\n    // 检查占位符\n    const originalPlaceholders = this.extractPlaceholders(original);\n    const translatedPlaceholders = this.extractPlaceholders(translation);\n\n    if (originalPlaceholders.length !== translatedPlaceholders.length) {\n      issues.push({\n        type: 'placeholder',\n        severity: 'high',\n        message: 'Placeholder count mismatch',\n        suggestion: 'Ensure all placeholders are preserved in translation',\n      });\n      penalty += VALIDATION_THRESHOLDS.PLACEHOLDER_MISMATCH_PENALTY;\n    }\n\n    // 检查缺失的占位符\n    const missingPlaceholders = originalPlaceholders.filter(\n      (ph) => !translatedPlaceholders.includes(ph),\n    );\n    if (missingPlaceholders.length > 0) {\n      issues.push({\n        type: 'placeholder',\n        severity: 'high',\n        message: `Missing placeholders: ${missingPlaceholders.join(', ')}`,\n        suggestion: 'Add missing placeholders to translation',\n      });\n      penalty +=\n        VALIDATION_THRESHOLDS.LENGTH_DIFFERENCE_THRESHOLD *\n        missingPlaceholders.length;\n    }\n\n    // 检查长度差异\n    const lengthRatio = translation.length / original.length;\n    if (\n      lengthRatio > VALIDATION_THRESHOLDS.MAX_LENGTH_RATIO ||\n      lengthRatio < VALIDATION_THRESHOLDS.MIN_LENGTH_RATIO\n    ) {\n      issues.push({\n        type: 'length',\n        severity: 'medium',\n        message: 'Translation length significantly different from original',\n        suggestion: 'Review translation for completeness and conciseness',\n      });\n      penalty += 10;\n    }\n\n    return { issues, penalty };\n  }\n\n  /**\n   * 语言特定验证\n   */\n  static performLanguageSpecificValidation(\n    translation: string,\n    locale: Locale,\n  ): ValidationResult {\n    const issues: QualityIssue[] = [];\n    let penalty = 0;\n\n    switch (locale) {\n      case 'zh':\n        // 中文特定检查\n        if (this.containsTraditionalChinese(translation)) {\n          issues.push({\n            type: 'language',\n            severity: 'medium',\n            message: 'Contains traditional Chinese characters',\n            suggestion: 'Use simplified Chinese for zh locale',\n          });\n          penalty += 5;\n        }\n        break;\n\n      case 'en':\n        // 英文特定检查\n        if (this.hasGrammarIssues(translation)) {\n          issues.push({\n            type: 'grammar',\n            severity: 'medium',\n            message: 'Potential grammar issues detected',\n            suggestion: 'Review grammar and sentence structure',\n          });\n          penalty += 8;\n        }\n        break;\n    }\n\n    return { issues, penalty };\n  }\n\n  /**\n   * 与人工翻译对比\n   */\n  static compareWithHumanTranslation(\n    aiTranslation: string,\n    humanTranslation: string,\n  ): ValidationResult {\n    const issues: QualityIssue[] = [];\n    let penalty = 0;\n\n    const similarity = this.calculateSimilarity(\n      aiTranslation,\n      humanTranslation,\n    );\n\n    if (similarity < 0.3) {\n      issues.push({\n        type: 'accuracy',\n        severity: 'high',\n        message: 'AI translation significantly differs from human reference',\n        suggestion: 'Review translation accuracy and meaning preservation',\n      });\n      penalty += 25;\n    } else if (similarity < 0.6) {\n      issues.push({\n        type: 'accuracy',\n        severity: 'medium',\n        message: 'AI translation moderately differs from human reference',\n        suggestion: 'Consider adjusting translation for better accuracy',\n      });\n      penalty += 15;\n    }\n\n    // 检查关键术语\n    const humanTerms = this.extractKeyTerms(humanTranslation);\n    const aiTerms = this.extractKeyTerms(aiTranslation);\n    const missingTerms = humanTerms.filter((term) => !aiTerms.includes(term));\n\n    if (missingTerms.length > 0) {\n      issues.push({\n        type: 'terminology',\n        severity: 'medium',\n        message: `Missing key terms: ${missingTerms.slice(0, 3).join(', ')}`,\n        suggestion: 'Include important terminology from reference translation',\n      });\n      penalty += 10;\n    }\n\n    return { issues, penalty };\n  }\n\n  /**\n   * 检查上下文相关性\n   */\n  static checkContextRelevance(\n    key: string,\n    translation: string,\n  ): QualityIssue[] {\n    const issues: QualityIssue[] = [];\n\n    // 根据键名检查上下文相关性\n    if (key.includes('error') && !this.containsErrorTerms(translation)) {\n      issues.push({\n        type: 'context',\n        severity: 'medium',\n        message: 'Error context not reflected in translation',\n        suggestion: 'Include error-related terminology',\n      });\n    }\n\n    return issues;\n  }\n\n  // 工具方法\n  private static extractPlaceholders(text: string): string[] {\n    const matches = text.match(/\\{[^}]+\\}/g) || [];\n    return matches.map((match) => match.slice(1, -1));\n  }\n\n  private static containsTraditionalChinese(text: string): boolean {\n    // 简单的繁体字检测\n    const traditionalChars = /[繁體字檢測]/;\n    return traditionalChars.test(text);\n  }\n\n  private static hasGrammarIssues(text: string): boolean {\n    // 简单的语法检查\n    const commonIssues = /\\b(a a|the the|and and|or or)\\b/i;\n    return commonIssues.test(text);\n  }\n\n  private static containsErrorTerms(text: string): boolean {\n    const errorTerms = ['error', 'failed', 'invalid', '错误', '失败', '无效'];\n    return errorTerms.some((term) =>\n      text.toLowerCase().includes(term.toLowerCase()),\n    );\n  }\n\n  private static calculateSimilarity(text1: string, text2: string): number {\n    const words1 = text1.toLowerCase().split(/\\s+/);\n    const words2 = text2.toLowerCase().split(/\\s+/);\n\n    const intersection = words1.filter((word) => words2.includes(word));\n    const union = [...new Set([...words1, ...words2])];\n\n    return intersection.length / union.length;\n  }\n\n  private static extractKeyTerms(text: string): string[] {\n    return text.split(/\\s+/).filter((word) => word.length > 3);\n  }\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/validations.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/web-vitals-monitor.ts","messages":[{"ruleId":"max-statements","severity":2,"message":"Method 'setupPerformanceObservers' has too many statements (21). Maximum allowed is 20.","line":104,"column":36,"nodeType":"FunctionExpression","messageId":"exceed","endLine":179,"endColumn":4}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { logger } from '@/lib/logger';\n\n/**\n * 扩展的PerformanceEntry接口，包含Layout Shift特定属性\n */\ninterface LayoutShiftEntry extends PerformanceEntry {\n  hadRecentInput: boolean;\n  value: number;\n}\n\n/**\n * 扩展的PerformanceEntry接口，包含First Input Delay特定属性\n */\ninterface FirstInputEntry extends PerformanceEntry {\n  processingStart: number;\n}\n\n/**\n * Web Vitals 性能指标接口\n */\nexport interface WebVitalsMetrics {\n  /** 累积布局偏移 (Cumulative Layout Shift) */\n  cls: number;\n  /** 首次输入延迟 (First Input Delay) */\n  fid: number;\n  /** 最大内容绘制 (Largest Contentful Paint) */\n  lcp: number;\n  /** 首次内容绘制 (First Contentful Paint) */\n  fcp?: number;\n  /** 首字节时间 (Time to First Byte) */\n  ttfb?: number;\n  /** 交互到下次绘制 (Interaction to Next Paint) */\n  inp?: number;\n}\n\n/**\n * 性能指标评级\n */\nexport interface MetricRating {\n  value: number;\n  rating: 'good' | 'needs-improvement' | 'poor';\n}\n\n/**\n * Web Vitals 性能监控类\n *\n * 基于现有性能监控组件模式，提供核心Web Vitals指标的收集和分析。\n * 支持开发环境显示和生产环境静默收集。\n */\nexport class WebVitalsMonitor {\n  private static instance: WebVitalsMonitor;\n  private metrics: Partial<WebVitalsMetrics> = {};\n  private observers: PerformanceObserver[] = [];\n  private isInitialized = false;\n\n  // Web Vitals 阈值配置\n  private static readonly THRESHOLDS = {\n    CLS: { good: 0.1, poor: 0.25 },\n    FID: { good: 100, poor: 300 },\n    LCP: { good: 2500, poor: 4000 },\n    FCP: { good: 1800, poor: 3000 },\n    TTFB: { good: 800, poor: 1800 },\n    INP: { good: 200, poor: 500 },\n  } as const;\n\n  private constructor() {\n    this.initialize();\n  }\n\n  /**\n   * 获取单例实例\n   */\n  static getInstance(): WebVitalsMonitor {\n    if (!WebVitalsMonitor.instance) {\n      WebVitalsMonitor.instance = new WebVitalsMonitor();\n    }\n    return WebVitalsMonitor.instance;\n  }\n\n  /**\n   * 初始化监控\n   */\n  private initialize(): void {\n    if (this.isInitialized || typeof window === 'undefined') {\n      return;\n    }\n\n    try {\n      this.setupPerformanceObservers();\n      this.setupNavigationTiming();\n      this.isInitialized = true;\n    } catch (error) {\n      logger.warn('Web Vitals monitoring initialization failed', {\n        error: error instanceof Error ? error.message : String(error),\n      });\n    }\n  }\n\n  /**\n   * 设置性能观察器\n   */\n  private setupPerformanceObservers(): void {\n    // CLS (Cumulative Layout Shift)\n    if ('PerformanceObserver' in window) {\n      try {\n        const clsObserver = new PerformanceObserver((list) => {\n          let clsValue = 0;\n          for (const entry of list.getEntries()) {\n            const layoutShiftEntry = entry as LayoutShiftEntry;\n            if (!layoutShiftEntry.hadRecentInput) {\n              clsValue += layoutShiftEntry.value;\n            }\n          }\n          this.recordCLS(clsValue);\n        });\n        clsObserver.observe({ type: 'layout-shift', buffered: true });\n        this.observers.push(clsObserver);\n      } catch (error) {\n        logger.warn('CLS observer setup failed', {\n          error: error instanceof Error ? error.message : String(error),\n        });\n      }\n\n      // LCP (Largest Contentful Paint)\n      try {\n        const lcpObserver = new PerformanceObserver((list) => {\n          const entries = list.getEntries();\n          const lastEntry = entries[entries.length - 1];\n          if (lastEntry) {\n            this.recordLCP(lastEntry.startTime);\n          }\n        });\n        lcpObserver.observe({\n          type: 'largest-contentful-paint',\n          buffered: true,\n        });\n        this.observers.push(lcpObserver);\n      } catch (error) {\n        logger.warn('LCP observer setup failed', {\n          error: error instanceof Error ? error.message : String(error),\n        });\n      }\n\n      // FID (First Input Delay)\n      try {\n        const fidObserver = new PerformanceObserver((list) => {\n          for (const entry of list.getEntries()) {\n            const firstInputEntry = entry as FirstInputEntry;\n            this.recordFID(firstInputEntry.processingStart - entry.startTime);\n          }\n        });\n        fidObserver.observe({ type: 'first-input', buffered: true });\n        this.observers.push(fidObserver);\n      } catch (error) {\n        logger.warn('FID observer setup failed', {\n          error: error instanceof Error ? error.message : String(error),\n        });\n      }\n\n      // FCP (First Contentful Paint)\n      try {\n        const fcpObserver = new PerformanceObserver((list) => {\n          for (const entry of list.getEntries()) {\n            if (entry.name === 'first-contentful-paint') {\n              this.recordFCP(entry.startTime);\n            }\n          }\n        });\n        fcpObserver.observe({ type: 'paint', buffered: true });\n        this.observers.push(fcpObserver);\n      } catch (error) {\n        logger.warn('FCP observer setup failed', {\n          error: error instanceof Error ? error.message : String(error),\n        });\n      }\n    }\n  }\n\n  /**\n   * 设置导航时间监控\n   */\n  private setupNavigationTiming(): void {\n    if ('performance' in window && 'getEntriesByType' in performance) {\n      // 使用 setTimeout 确保导航时间数据可用\n      setTimeout(() => {\n        const navigationEntries = performance.getEntriesByType(\n          'navigation',\n        ) as PerformanceNavigationTiming[];\n        if (navigationEntries.length > 0) {\n          const [navigation] = navigationEntries;\n          if (\n            navigation &&\n            navigation.responseStart &&\n            navigation.requestStart\n          ) {\n            const ttfb = navigation.responseStart - navigation.requestStart;\n            this.recordTTFB(ttfb);\n          }\n        }\n      }, 0);\n    }\n  }\n\n  /**\n   * 记录 CLS 指标\n   */\n  recordCLS(value: number): void {\n    this.metrics.cls = (this.metrics.cls || 0) + value;\n  }\n\n  /**\n   * 记录 FID 指标\n   */\n  recordFID(value: number): void {\n    if (!this.metrics.fid || value > this.metrics.fid) {\n      this.metrics.fid = value;\n    }\n  }\n\n  /**\n   * 记录 LCP 指标\n   */\n  recordLCP(value: number): void {\n    this.metrics.lcp = value;\n  }\n\n  /**\n   * 记录 FCP 指标\n   */\n  recordFCP(value: number): void {\n    this.metrics.fcp = value;\n  }\n\n  /**\n   * 记录 TTFB 指标\n   */\n  recordTTFB(value: number): void {\n    this.metrics.ttfb = value;\n  }\n\n  /**\n   * 获取性能指标评级\n   */\n  private getMetricRating(\n    metric: keyof typeof WebVitalsMonitor.THRESHOLDS,\n    value: number,\n  ): MetricRating {\n    // 安全的属性访问，防止对象注入攻击\n    const allowedMetrics = ['CLS', 'FID', 'LCP', 'FCP', 'TTFB', 'INP'] as const;\n    if (!allowedMetrics.includes(metric as (typeof allowedMetrics)[number])) {\n      throw new Error(`Invalid metric: ${metric}`);\n    }\n    const safeThresholds = new Map(Object.entries(WebVitalsMonitor.THRESHOLDS));\n    const thresholds = safeThresholds.get(metric) || { good: 0, poor: 0 };\n    let rating: 'good' | 'needs-improvement' | 'poor';\n\n    if (value <= thresholds.good) {\n      rating = 'good';\n    } else if (value <= thresholds.poor) {\n      rating = 'needs-improvement';\n    } else {\n      rating = 'poor';\n    }\n\n    return { value, rating };\n  }\n\n  /**\n   * 获取性能摘要\n   */\n  getPerformanceSummary(): {\n    metrics: WebVitalsMetrics;\n    ratings: Record<string, MetricRating>;\n    score: number;\n  } {\n    const metrics: WebVitalsMetrics = {\n      cls: this.metrics.cls || 0,\n      fid: this.metrics.fid || 0,\n      lcp: this.metrics.lcp || 0,\n      ...(this.metrics.fcp !== undefined && { fcp: this.metrics.fcp }),\n      ...(this.metrics.ttfb !== undefined && { ttfb: this.metrics.ttfb }),\n      ...(this.metrics.inp !== undefined && { inp: this.metrics.inp }),\n    };\n\n    const ratings = {\n      cls: this.getMetricRating('CLS', metrics.cls),\n      fid: this.getMetricRating('FID', metrics.fid),\n      lcp: this.getMetricRating('LCP', metrics.lcp),\n      ...(metrics.fcp && { fcp: this.getMetricRating('FCP', metrics.fcp) }),\n      ...(metrics.ttfb && { ttfb: this.getMetricRating('TTFB', metrics.ttfb) }),\n    };\n\n    // 计算总体性能评分\n    const ratingValues = Object.values(ratings);\n    const goodCount = ratingValues.filter((r) => r.rating === 'good').length;\n    const score = Math.round((goodCount / ratingValues.length) * 100);\n\n    return { metrics, ratings, score };\n  }\n\n  /**\n   * 发送性能报告\n   */\n  sendReport(): void {\n    const summary = this.getPerformanceSummary();\n\n    // 开发环境输出到日志\n    if (process.env.NODE_ENV === 'development') {\n      logger.info('Web Vitals Performance Report', {\n        ratings: summary.ratings,\n        score: summary.score,\n        metrics: summary.metrics,\n      });\n    }\n\n    // 生产环境可以发送到分析服务\n    // 这里可以集成 Google Analytics、Vercel Analytics 等\n  }\n\n  /**\n   * 清理监控器\n   */\n  cleanup(): void {\n    this.observers.forEach((observer) => {\n      try {\n        observer.disconnect();\n      } catch (error) {\n        logger.warn('Failed to disconnect performance observer', {\n          error: error instanceof Error ? error.message : String(error),\n        });\n      }\n    });\n    this.observers = [];\n    this.isInitialized = false;\n  }\n}\n\n/**\n * 获取 Web Vitals 监控实例\n */\nexport const webVitalsMonitor = WebVitalsMonitor.getInstance();\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/web-vitals/alert-helpers.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/web-vitals/alert-notifications.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/web-vitals/alert-system-checker.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/web-vitals/alert-system-core.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/web-vitals/alert-system-sender.ts","messages":[{"ruleId":"max-params","severity":2,"message":"Async method 'sendAlert' has too many parameters (4). Maximum allowed is 3.","line":76,"column":3,"nodeType":"FunctionExpression","messageId":"exceed","endLine":76,"endColumn":18},{"ruleId":"no-unused-vars","severity":2,"message":"'alert' is defined but never used. Allowed unused args must match /^_/u.","line":120,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":120,"endColumn":46,"suggestions":[{"messageId":"removeVar","data":{"varName":"alert"},"fix":{"range":[2723,2753],"text":""},"desc":"Remove unused variable 'alert'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 性能预警系统 - 预警发送器\n * Performance Alert System - Alert Sender\n */\n\nimport { ALERT_SYSTEM_CONSTANTS } from '@/constants/performance-constants';\nimport { sendConsoleAlerts, sendWebhookNotification, storeAlerts } from './alert-notifications';\nimport type { PerformanceAlertConfig } from './types';\nimport type { AlertInfo } from './alert-system-checker';\n\n/**\n * 预警历史记录接口\n */\nexport interface AlertHistoryEntry {\n  id: string;\n  timestamp: number;\n  severity: 'warning' | 'critical';\n  message: string;\n  metric?: string;\n  value?: number;\n  threshold?: number;\n  level?: 'warning' | 'critical'; // 为了兼容测试\n}\n\n/**\n * 性能预警发送器类\n * Performance alert sender class\n */\nexport class AlertSystemSender {\n  private alertHistory: AlertHistoryEntry[] = [];\n\n  /**\n   * 发送预警\n   */\n  sendAlerts(\n    alerts: AlertInfo[],\n    config: PerformanceAlertConfig,\n  ): void {\n    // 添加到历史记录\n    alerts.forEach((alert) => {\n      const historyEntry: AlertHistoryEntry = {\n        id: this.generateAlertId(),\n        timestamp: Date.now(),\n        severity: alert.severity,\n        message: alert.message,\n        level: alert.severity, // 为了兼容测试\n        ...(alert.metric && { metric: alert.metric }),\n        ...(alert.value !== undefined && { value: alert.value }),\n        ...(alert.threshold !== undefined && { threshold: alert.threshold }),\n      };\n      this.alertHistory.push(historyEntry);\n    });\n\n    // 限制历史记录大小\n    this.limitHistorySize();\n\n    // 控制台通知\n    if (config.channels.console) {\n      sendConsoleAlerts(alerts);\n    }\n\n    // 存储通知\n    if (config.channels.storage) {\n      storeAlerts(alerts);\n    }\n\n    // 回调通知\n    if (config.channels.callback) {\n      this.sendCallbackAlerts(alerts, config.channels.callback);\n    }\n  }\n\n  /**\n   * 发送单个警报 (测试方法)\n   */\n  async sendAlert(\n    severity: 'warning' | 'critical',\n    message: string,\n    config: PerformanceAlertConfig,\n    data?: Record<string, unknown>,\n  ): Promise<void> {\n    const alert: AlertInfo = {\n      type: 'metric',\n      severity,\n      message,\n      ...data,\n    };\n\n    // 直接添加到历史记录，不通过sendAlerts避免重复\n    const alertId = this.generateAlertId();\n    const historyEntry: AlertHistoryEntry = {\n      id: alertId,\n      timestamp: Date.now(),\n      severity,\n      message,\n      level: severity, // 为了兼容测试\n      ...data,\n    };\n    this.alertHistory.push(historyEntry);\n\n    // 限制历史记录大小\n    this.limitHistorySize();\n\n    // 直接发送通知，不通过sendAlerts避免重复添加历史\n    if (config.channels.console) {\n      sendConsoleAlerts([alert]);\n    }\n\n    // 处理webhook通知\n    if (config.channels?.webhook) {\n      await sendWebhookNotification(alert, config.channels.webhook);\n    }\n  }\n\n  /**\n   * 发送回调预警\n   */\n  private sendCallbackAlerts(\n    alerts: AlertInfo[],\n    callback: (alert: Record<string, unknown>) => void,\n  ): void {\n    alerts.forEach((alert) => {\n      const performanceAlert = {\n        id: this.generateAlertId(),\n        timestamp: Date.now(),\n        severity: alert.severity,\n        metric: alert.metric || 'unknown',\n        value: alert.value || 0,\n        threshold: alert.threshold || 0,\n        message: alert.message,\n        url: typeof window !== 'undefined' ? window.location.href : '',\n        userAgent: typeof navigator !== 'undefined' ? navigator.userAgent : '',\n        context: {},\n      };\n      callback(performanceAlert);\n    });\n  }\n\n  /**\n   * 获取警报历史 (测试方法)\n   */\n  getAlertHistory(): AlertHistoryEntry[] {\n    return [...this.alertHistory];\n  }\n\n  /**\n   * 清除警报历史 (测试方法)\n   */\n  clearAlertHistory(): void {\n    this.alertHistory = [];\n  }\n\n  /**\n   * 清除历史记录的别名方法 (测试兼容)\n   */\n  clearHistory(): void {\n    this.clearAlertHistory();\n  }\n\n  /**\n   * 生成唯一的警报ID\n   */\n  private generateAlertId(): string {\n    const timestamp = Date.now();\n    const randomPart = Math.random()\n      .toString(ALERT_SYSTEM_CONSTANTS.RANDOM_ID_BASE)\n      .substr(\n        ALERT_SYSTEM_CONSTANTS.RANDOM_ID_START,\n        ALERT_SYSTEM_CONSTANTS.RANDOM_ID_LENGTH,\n      );\n    return `alert-${timestamp}-${randomPart}`;\n  }\n\n  /**\n   * 限制历史记录大小\n   */\n  private limitHistorySize(): void {\n    if (this.alertHistory.length > 100) {\n      this.alertHistory.splice(0, this.alertHistory.length - 100);\n    }\n  }\n\n  /**\n   * 获取历史记录统计\n   */\n  getHistoryStats(): {\n    total: number;\n    warnings: number;\n    criticals: number;\n    lastAlert?: AlertHistoryEntry;\n  } {\n    const warnings = this.alertHistory.filter(alert => alert.severity === 'warning').length;\n    const criticals = this.alertHistory.filter(alert => alert.severity === 'critical').length;\n    const lastAlert = this.alertHistory[this.alertHistory.length - 1];\n\n    return {\n      total: this.alertHistory.length,\n      warnings,\n      criticals,\n      lastAlert,\n    };\n  }\n\n  /**\n   * 根据条件过滤历史记录\n   */\n  filterHistory(filter: {\n    severity?: 'warning' | 'critical';\n    metric?: string;\n    startTime?: number;\n    endTime?: number;\n  }): AlertHistoryEntry[] {\n    return this.alertHistory.filter(alert => {\n      if (filter.severity && alert.severity !== filter.severity) return false;\n      if (filter.metric && alert.metric !== filter.metric) return false;\n      if (filter.startTime && alert.timestamp < filter.startTime) return false;\n      if (filter.endTime && alert.timestamp > filter.endTime) return false;\n      return true;\n    });\n  }\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/web-vitals/alert-system.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/web-vitals/baseline-manager.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/web-vitals/collector.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/web-vitals/constants.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/web-vitals/index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/web-vitals/monitoring-manager-core.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/web-vitals/monitoring-manager.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/web-vitals/monitoring-report-generator.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/web-vitals/monitoring-utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/web-vitals/observers.ts","messages":[],"suppressedMessages":[{"ruleId":"no-unreachable-loop","severity":2,"message":"Invalid loop. Its body allows only one iteration.","line":82,"column":9,"nodeType":"ForOfStatement","messageId":"invalid","endLine":88,"endColumn":10,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/web-vitals/regression-detector.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/web-vitals/types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/web-vitals/web-vitals-collector-analyzer.ts","messages":[{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 3.","line":26,"column":51,"nodeType":"Literal","messageId":"noMagic","endLine":26,"endColumn":52},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2.","line":91,"column":36,"nodeType":"Literal","messageId":"noMagic","endLine":91,"endColumn":37},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 1024.","line":91,"column":40,"nodeType":"Literal","messageId":"noMagic","endLine":91,"endColumn":44},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 1024.","line":91,"column":47,"nodeType":"Literal","messageId":"noMagic","endLine":91,"endColumn":51},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 1024.","line":94,"column":49,"nodeType":"Literal","messageId":"noMagic","endLine":94,"endColumn":53},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 1024.","line":94,"column":56,"nodeType":"Literal","messageId":"noMagic","endLine":94,"endColumn":60},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 25.","line":109,"column":16,"nodeType":"Literal","messageId":"noMagic","endLine":109,"endColumn":18},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 10.","line":111,"column":16,"nodeType":"Literal","messageId":"noMagic","endLine":111,"endColumn":18},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 30.","line":116,"column":16,"nodeType":"Literal","messageId":"noMagic","endLine":116,"endColumn":18},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 15.","line":118,"column":16,"nodeType":"Literal","messageId":"noMagic","endLine":118,"endColumn":18},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 25.","line":123,"column":16,"nodeType":"Literal","messageId":"noMagic","endLine":123,"endColumn":18},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 10.","line":125,"column":16,"nodeType":"Literal","messageId":"noMagic","endLine":125,"endColumn":18},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 10.","line":130,"column":16,"nodeType":"Literal","messageId":"noMagic","endLine":130,"endColumn":18},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 1800.","line":131,"column":30,"nodeType":"Literal","messageId":"noMagic","endLine":131,"endColumn":34},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 5.","line":132,"column":16,"nodeType":"Literal","messageId":"noMagic","endLine":132,"endColumn":17},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 800.","line":136,"column":24,"nodeType":"Literal","messageId":"noMagic","endLine":136,"endColumn":27},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 10.","line":137,"column":16,"nodeType":"Literal","messageId":"noMagic","endLine":137,"endColumn":18},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 600.","line":138,"column":31,"nodeType":"Literal","messageId":"noMagic","endLine":138,"endColumn":34},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 5.","line":139,"column":16,"nodeType":"Literal","messageId":"noMagic","endLine":139,"endColumn":17},{"ruleId":"max-params","severity":2,"message":"Method 'buildDiagnosticResult' has too many parameters (4). Maximum allowed is 3.","line":162,"column":3,"nodeType":"FunctionExpression","messageId":"exceed","endLine":162,"endColumn":34}],"suppressedMessages":[],"errorCount":20,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Web Vitals 收集器分析器\n * Web Vitals collector analyzer\n */\n\n'use client';\n\nimport { WEB_VITALS_CONSTANTS } from '@/constants/test-constants';\nimport { PERFORMANCE_THRESHOLDS } from './constants';\nimport type { DetailedWebVitals } from './types';\n\n/**\n * Web Vitals 性能分析器\n * 负责性能指标分析和诊断报告生成\n */\nexport class WebVitalsCollectorAnalyzer {\n  /**\n   * 分析 CLS 指标并生成问题和建议\n   */\n  protected analyzeCLS(\n    cls: number,\n    issues: string[],\n    recommendations: string[],\n  ): void {\n    if (cls > PERFORMANCE_THRESHOLDS.CLS_NEEDS_IMPROVEMENT) {\n      issues.push(`累积布局偏移 (CLS) 过高: ${cls.toFixed(3)}`);\n      recommendations.push(\n        '为图片和广告设置明确的尺寸，避免动态内容插入导致布局偏移',\n      );\n      recommendations.push(\n        '使用 CSS aspect-ratio 属性预留空间，避免内容加载时的布局变化',\n      );\n      recommendations.push(\n        '确保字体加载不会导致文本重新布局，使用 font-display: swap',\n      );\n    }\n  }\n\n  /**\n   * 分析 LCP 指标并生成问题和建议\n   */\n  protected analyzeLCP(\n    lcp: number,\n    issues: string[],\n    recommendations: string[],\n  ): void {\n    if (lcp > PERFORMANCE_THRESHOLDS.LCP_NEEDS_IMPROVEMENT) {\n      issues.push(`最大内容绘制 (LCP) 过慢: ${lcp.toFixed(0)}ms`);\n      recommendations.push('优化图片加载，使用现代图片格式如 WebP');\n      recommendations.push('减少服务器响应时间，优化后端性能');\n      recommendations.push('使用 CDN 加速资源加载');\n    }\n  }\n\n  /**\n   * 分析 FID 指标并生成问题和建议\n   */\n  protected analyzeFID(\n    fid: number,\n    issues: string[],\n    recommendations: string[],\n  ): void {\n    if (fid > PERFORMANCE_THRESHOLDS.FID_NEEDS_IMPROVEMENT) {\n      issues.push(`首次输入延迟 (FID) 过高: ${fid.toFixed(0)}ms`);\n      recommendations.push(\n        '减少 JavaScript 执行时间，考虑代码分割和懒加载',\n      );\n      recommendations.push('优化第三方脚本，延迟非关键脚本的加载');\n      recommendations.push('使用 Web Workers 处理计算密集型任务');\n    }\n  }\n\n  /**\n   * 分析资源加载性能并生成问题和建议\n   */\n  protected analyzeResourceTiming(\n    resourceTiming: DetailedWebVitals['resourceTiming'],\n    issues: string[],\n    recommendations: string[],\n  ): void {\n    if (\n      resourceTiming.slowResources.length > 0 &&\n      resourceTiming.slowResources[0].duration > 500\n    ) {\n      issues.push(\n        `发现慢速资源: ${resourceTiming.slowResources[0].name} (${resourceTiming.slowResources[0].duration.toFixed(0)}ms)`,\n      );\n      recommendations.push('优化慢速资源的加载，考虑压缩或使用 CDN');\n    }\n\n    if (resourceTiming.totalSize > 2 * 1024 * 1024) {\n      // 2MB\n      issues.push(\n        `总资源大小过大: ${(resourceTiming.totalSize / 1024 / 1024).toFixed(1)}MB`,\n      );\n      recommendations.push('减少资源大小，启用 gzip 压缩');\n    }\n  }\n\n  /**\n   * 计算性能评分\n   */\n  protected calculatePerformanceScore(metrics: DetailedWebVitals): number {\n    const { PERFECT_SCORE } = WEB_VITALS_CONSTANTS;\n    let score = PERFECT_SCORE;\n\n    // CLS 评分\n    if (metrics.cls > PERFORMANCE_THRESHOLDS.CLS_NEEDS_IMPROVEMENT) {\n      score -= 25;\n    } else if (metrics.cls > PERFORMANCE_THRESHOLDS.CLS_GOOD) {\n      score -= 10;\n    }\n\n    // LCP 评分\n    if (metrics.lcp > PERFORMANCE_THRESHOLDS.LCP_NEEDS_IMPROVEMENT) {\n      score -= 30;\n    } else if (metrics.lcp > PERFORMANCE_THRESHOLDS.LCP_GOOD) {\n      score -= 15;\n    }\n\n    // FID 评分\n    if (metrics.fid > PERFORMANCE_THRESHOLDS.FID_NEEDS_IMPROVEMENT) {\n      score -= 25;\n    } else if (metrics.fid > PERFORMANCE_THRESHOLDS.FID_GOOD) {\n      score -= 10;\n    }\n\n    // FCP 评分\n    if (metrics.fcp > 3000) {\n      score -= 10;\n    } else if (metrics.fcp > 1800) {\n      score -= 5;\n    }\n\n    // TTFB 评分\n    if (metrics.ttfb > 800) {\n      score -= 10;\n    } else if (metrics.ttfb > 600) {\n      score -= 5;\n    }\n\n    return Math.max(0, score);\n  }\n\n  /**\n   * 执行所有性能指标分析\n   */\n  protected performMetricsAnalysis(\n    metrics: DetailedWebVitals,\n    issues: string[],\n    recommendations: string[],\n  ): void {\n    this.analyzeCLS(metrics.cls, issues, recommendations);\n    this.analyzeLCP(metrics.lcp, issues, recommendations);\n    this.analyzeFID(metrics.fid, issues, recommendations);\n    this.analyzeResourceTiming(metrics.resourceTiming, issues, recommendations);\n  }\n\n  /**\n   * 构建诊断报告结果对象\n   */\n  protected buildDiagnosticResult(\n    metrics: DetailedWebVitals,\n    issues: string[],\n    recommendations: string[],\n    score: number,\n  ): {\n    metrics: DetailedWebVitals;\n    analysis: {\n      issues: string[];\n      recommendations: string[];\n      score: number;\n    };\n  } {\n    return {\n      metrics,\n      analysis: {\n        issues,\n        recommendations,\n        score,\n      },\n    };\n  }\n\n  /**\n   * 生成完整的诊断报告\n   */\n  public generateDiagnosticReport(metrics: DetailedWebVitals): {\n    metrics: DetailedWebVitals;\n    analysis: {\n      issues: string[];\n      recommendations: string[];\n      score: number;\n    };\n  } {\n    const issues: string[] = [];\n    const recommendations: string[] = [];\n\n    // 执行所有分析\n    this.performMetricsAnalysis(metrics, issues, recommendations);\n\n    // 计算性能评分\n    const score = this.calculatePerformanceScore(metrics);\n\n    // 构建并返回结果\n    return this.buildDiagnosticResult(metrics, issues, recommendations, score);\n  }\n\n  /**\n   * 分析性能趋势\n   */\n  public analyzePerformanceTrend(\n    currentMetrics: DetailedWebVitals,\n    previousMetrics: DetailedWebVitals,\n  ): {\n    trend: 'improving' | 'declining' | 'stable';\n    changes: Array<{\n      metric: string;\n      current: number;\n      previous: number;\n      change: number;\n      changePercent: number;\n    }>;\n  } {\n    const changes = [\n      {\n        metric: 'LCP',\n        current: currentMetrics.lcp,\n        previous: previousMetrics.lcp,\n        change: currentMetrics.lcp - previousMetrics.lcp,\n        changePercent: previousMetrics.lcp > 0 \n          ? ((currentMetrics.lcp - previousMetrics.lcp) / previousMetrics.lcp) * 100 \n          : 0,\n      },\n      {\n        metric: 'FID',\n        current: currentMetrics.fid,\n        previous: previousMetrics.fid,\n        change: currentMetrics.fid - previousMetrics.fid,\n        changePercent: previousMetrics.fid > 0 \n          ? ((currentMetrics.fid - previousMetrics.fid) / previousMetrics.fid) * 100 \n          : 0,\n      },\n      {\n        metric: 'CLS',\n        current: currentMetrics.cls,\n        previous: previousMetrics.cls,\n        change: currentMetrics.cls - previousMetrics.cls,\n        changePercent: previousMetrics.cls > 0 \n          ? ((currentMetrics.cls - previousMetrics.cls) / previousMetrics.cls) * 100 \n          : 0,\n      },\n    ];\n\n    // 计算总体趋势\n    const improvingCount = changes.filter(c => c.change < 0).length;\n    const decliningCount = changes.filter(c => c.change > 0).length;\n    \n    let trend: 'improving' | 'declining' | 'stable';\n    if (improvingCount > decliningCount) {\n      trend = 'improving';\n    } else if (decliningCount > improvingCount) {\n      trend = 'declining';\n    } else {\n      trend = 'stable';\n    }\n\n    return { trend, changes };\n  }\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/web-vitals/web-vitals-collector-base.ts","messages":[{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 10.","line":112,"column":17,"nodeType":"Literal","messageId":"noMagic","endLine":112,"endColumn":19}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Web Vitals 收集器基础类\n * Web Vitals collector base class\n */\n\n'use client';\n\nimport { DEVICE_DEFAULTS } from './constants';\nimport { WebVitalsObservers } from './observers';\nimport type { DetailedWebVitals } from './types';\n\n/**\n * Web Vitals 收集器基础类\n * 负责基础数据收集和初始化\n */\nexport class WebVitalsCollectorBase {\n  protected metrics: Partial<DetailedWebVitals> = {};\n  protected webVitalsObservers: WebVitalsObservers;\n  protected isCollecting = false;\n\n  constructor() {\n    this.webVitalsObservers = new WebVitalsObservers(this.metrics);\n    this.initializeCollection();\n  }\n\n  protected initializeCollection() {\n    if (typeof window === 'undefined' || this.isCollecting) return;\n\n    this.isCollecting = true;\n    this.collectBasicPageInfo();\n    this.collectDeviceInfo();\n    this.collectNetworkInfo();\n    this.collectNavigationTiming();\n    this.collectResourceTiming();\n    this.collectWebVitals();\n  }\n\n  protected collectBasicPageInfo() {\n    this.metrics.page = {\n      url: window.location.href,\n      referrer: document.referrer,\n      title: document.title,\n      timestamp: Date.now(),\n    };\n  }\n\n  protected collectDeviceInfo() {\n    const nav = navigator as Navigator & {\n      deviceMemory?: number;\n      hardwareConcurrency?: number;\n    };\n    this.metrics.device = {\n      ...(nav.deviceMemory !== undefined && { memory: nav.deviceMemory }),\n      ...(nav.hardwareConcurrency !== undefined && {\n        cores: nav.hardwareConcurrency,\n      }),\n      viewport: {\n        width: window.innerWidth,\n        height: window.innerHeight,\n      },\n    };\n  }\n\n  protected collectNetworkInfo() {\n    const nav = navigator as Navigator & {\n      connection?: {\n        effectiveType: string;\n        downlink: number;\n        rtt: number;\n        saveData: boolean;\n      };\n    };\n    if (nav.connection) {\n      this.metrics.connection = {\n        effectiveType: nav.connection.effectiveType,\n        downlink: nav.connection.downlink,\n        rtt: nav.connection.rtt,\n        saveData: nav.connection.saveData,\n      };\n    }\n  }\n\n  protected collectNavigationTiming() {\n    const navigation = performance.getEntriesByType(\n      'navigation',\n    )[0] as PerformanceNavigationTiming;\n    if (navigation) {\n      // 使用 startTime 作为基准时间点（相当于 navigationStart）\n      this.metrics.fcp = navigation.responseEnd - navigation.startTime;\n      this.metrics.domContentLoaded =\n        navigation.domContentLoadedEventEnd - navigation.startTime;\n      this.metrics.loadComplete =\n        navigation.loadEventEnd - navigation.startTime;\n      this.metrics.ttfb = navigation.responseStart - navigation.startTime;\n    }\n  }\n\n  protected collectResourceTiming() {\n    const resources = performance.getEntriesByType(\n      'resource',\n    ) as PerformanceResourceTiming[];\n\n    const slowResources = resources\n      .filter((resource) => resource.duration > 100) // 超过100ms的资源\n      .map((resource) => ({\n        name: resource.name,\n        duration: resource.duration,\n        size: resource.transferSize || 0,\n        type: this.getResourceType(resource.name),\n      }))\n      .sort((a, b) => b.duration - a.duration)\n      .slice(0, 10); // 只保留前10个最慢的资源\n\n    this.metrics.resourceTiming = {\n      totalResources: resources.length,\n      slowResources,\n      totalSize: resources.reduce((sum, r) => sum + (r.transferSize || 0), 0),\n      totalDuration: resources.reduce((sum, r) => sum + r.duration, 0),\n    };\n  }\n\n  protected getResourceType(url: string): string {\n    if (url.includes('.js')) return 'JavaScript';\n    if (url.includes('.css')) return 'CSS';\n    if (url.match(/\\.(jpg|jpeg|png|gif|webp|svg)$/i)) return 'Image';\n    if (url.match(/\\.(woff|woff2|ttf|otf)$/i)) return 'Font';\n    if (url.includes('api/') || url.includes('/api/')) return 'API';\n    return 'Other';\n  }\n\n  protected collectWebVitals() {\n    // 启动所有 Web Vitals 观察器\n    this.webVitalsObservers.startAllObservers();\n  }\n\n  /**\n   * 获取默认的资源时间信息\n   */\n  protected getDefaultResourceTiming() {\n    return {\n      totalResources: 0,\n      slowResources: [],\n      totalSize: 0,\n      totalDuration: 0,\n    };\n  }\n\n  /**\n   * 获取默认的连接信息\n   */\n  protected getDefaultConnection() {\n    return {\n      effectiveType: 'unknown' as const,\n      downlink: 0,\n      rtt: 0,\n      saveData: false,\n    };\n  }\n\n  /**\n   * 获取默认的设备信息\n   */\n  protected getDefaultDevice() {\n    return {\n      memory:\n        (navigator as Navigator & { deviceMemory?: number }).deviceMemory ||\n        DEVICE_DEFAULTS.MEMORY_GB,\n      cores: navigator.hardwareConcurrency || DEVICE_DEFAULTS.CPU_CORES,\n      viewport: {\n        width: window?.innerWidth || 0,\n        height: window?.innerHeight || 0,\n      },\n    };\n  }\n\n  /**\n   * 获取默认的页面信息\n   */\n  protected getDefaultPage() {\n    return {\n      url: '',\n      referrer: '',\n      title: '',\n      timestamp: Date.now(),\n    };\n  }\n\n  public getDetailedMetrics(): DetailedWebVitals {\n    // 确保所有必需的字段都有默认值\n    return {\n      cls: this.metrics.cls || 0,\n      fid: this.metrics.fid || 0,\n      lcp: this.metrics.lcp || 0,\n      fcp: this.metrics.fcp || 0,\n      ttfb: this.metrics.ttfb || 0,\n      domContentLoaded: this.metrics.domContentLoaded || 0,\n      loadComplete: this.metrics.loadComplete || 0,\n      page: this.metrics.page || this.getDefaultPage(),\n      device: this.metrics.device || this.getDefaultDevice(),\n      connection: this.metrics.connection || this.getDefaultConnection(),\n      resourceTiming: this.metrics.resourceTiming || this.getDefaultResourceTiming(),\n    };\n  }\n\n  public cleanup() {\n    this.webVitalsObservers.cleanup();\n    this.isCollecting = false;\n  }\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/whatsapp-core.ts","messages":[{"ruleId":"require-await","severity":2,"message":"Async method 'sendMessage' has no 'await' expression.","line":46,"column":3,"nodeType":"FunctionExpression","messageId":"missingAwait","endLine":46,"endColumn":20,"suggestions":[{"messageId":"removeAsync","fix":{"range":[1289,1295],"text":""},"desc":"Remove 'async'."}]},{"ruleId":"require-await","severity":2,"message":"Async method 'sendTextMessage' has no 'await' expression.","line":50,"column":3,"nodeType":"FunctionExpression","messageId":"missingAwait","endLine":50,"endColumn":24,"suggestions":[{"messageId":"removeAsync","fix":{"range":[1432,1438],"text":""},"desc":"Remove 'async'."}]},{"ruleId":"require-await","severity":2,"message":"Async method 'sendImageMessage' has no 'await' expression.","line":58,"column":3,"nodeType":"FunctionExpression","messageId":"missingAwait","endLine":58,"endColumn":25,"suggestions":[{"messageId":"removeAsync","fix":{"range":[1632,1638],"text":""},"desc":"Remove 'async'."}]},{"ruleId":"max-params","severity":2,"message":"Async method 'sendTemplateMessage' has too many parameters (4). Maximum allowed is 3.","line":66,"column":3,"nodeType":"FunctionExpression","messageId":"exceed","endLine":66,"endColumn":28},{"ruleId":"require-await","severity":2,"message":"Async method 'sendTemplateMessage' has no 'await' expression.","line":66,"column":3,"nodeType":"FunctionExpression","messageId":"missingAwait","endLine":66,"endColumn":28,"suggestions":[{"messageId":"removeAsync","fix":{"range":[1835,1841],"text":""},"desc":"Remove 'async'."}]},{"ruleId":"max-params","severity":2,"message":"Async method 'sendButtonMessage' has too many parameters (5). Maximum allowed is 3.","line":75,"column":3,"nodeType":"FunctionExpression","messageId":"exceed","endLine":75,"endColumn":26},{"ruleId":"require-await","severity":2,"message":"Async method 'sendButtonMessage' has no 'await' expression.","line":75,"column":3,"nodeType":"FunctionExpression","messageId":"missingAwait","endLine":75,"endColumn":26,"suggestions":[{"messageId":"removeAsync","fix":{"range":[2100,2106],"text":""},"desc":"Remove 'async'."}]},{"ruleId":"max-params","severity":2,"message":"Async method 'sendListMessage' has too many parameters (5). Maximum allowed is 3.","line":85,"column":3,"nodeType":"FunctionExpression","messageId":"exceed","endLine":85,"endColumn":24},{"ruleId":"require-await","severity":2,"message":"Async method 'sendListMessage' has no 'await' expression.","line":85,"column":3,"nodeType":"FunctionExpression","messageId":"missingAwait","endLine":85,"endColumn":24,"suggestions":[{"messageId":"removeAsync","fix":{"range":[2408,2414],"text":""},"desc":"Remove 'async'."}]},{"ruleId":"require-await","severity":2,"message":"Async method 'getMediaUrl' has no 'await' expression.","line":99,"column":3,"nodeType":"FunctionExpression","messageId":"missingAwait","endLine":99,"endColumn":20,"suggestions":[{"messageId":"removeAsync","fix":{"range":[2831,2837],"text":""},"desc":"Remove 'async'."}]},{"ruleId":"require-await","severity":2,"message":"Async method 'downloadMedia' has no 'await' expression.","line":103,"column":3,"nodeType":"FunctionExpression","messageId":"missingAwait","endLine":103,"endColumn":22,"suggestions":[{"messageId":"removeAsync","fix":{"range":[2950,2956],"text":""},"desc":"Remove 'async'."}]},{"ruleId":"require-await","severity":2,"message":"Async method 'uploadMedia' has no 'await' expression.","line":107,"column":3,"nodeType":"FunctionExpression","messageId":"missingAwait","endLine":107,"endColumn":20,"suggestions":[{"messageId":"removeAsync","fix":{"range":[3073,3079],"text":""},"desc":"Remove 'async'."}]}],"suppressedMessages":[],"errorCount":12,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * WhatsApp Business API 核心服务类\n * 整合消息发送和媒体处理功能\n */\n\nimport type {\n  SendMessageRequest,\n  WhatsAppServiceResponse,\n} from '@/types/whatsapp';\nimport { WhatsAppMessageService } from './whatsapp-messages';\nimport { WhatsAppMediaService } from './whatsapp-media';\nimport { WhatsAppUtils } from './whatsapp-utils';\n\n/**\n * WhatsApp 核心服务类\n */\nexport class WhatsAppService {\n  private messageService: WhatsAppMessageService;\n  private mediaService: WhatsAppMediaService;\n  private readonly accessToken: string;\n  private readonly phoneNumberId: string;\n\n  constructor(accessToken?: string, phoneNumberId?: string) {\n    this.accessToken = accessToken || process.env.WHATSAPP_ACCESS_TOKEN || '';\n    this.phoneNumberId =\n      phoneNumberId || process.env.WHATSAPP_PHONE_NUMBER_ID || '';\n\n    // 只在运行时检查，构建时跳过验证\n    if (\n      process.env.NODE_ENV !== 'production' &&\n      typeof window === 'undefined'\n    ) {\n      // 构建时跳过验证\n      return;\n    }\n\n    if (!this.accessToken || !this.phoneNumberId) {\n      throw new Error('WhatsApp access token and phone number ID are required');\n    }\n\n    this.messageService = new WhatsAppMessageService(this.accessToken, this.phoneNumberId);\n    this.mediaService = new WhatsAppMediaService(this.accessToken, this.phoneNumberId);\n  }\n\n  // 消息发送方法代理\n  async sendMessage(message: SendMessageRequest): Promise<WhatsAppServiceResponse> {\n    return this.messageService.sendMessage(message);\n  }\n\n  async sendTextMessage(\n    to: string,\n    text: string,\n    previewUrl?: boolean,\n  ): Promise<WhatsAppServiceResponse> {\n    return this.messageService.sendTextMessage(to, text, previewUrl);\n  }\n\n  async sendImageMessage(\n    to: string,\n    imageUrl: string,\n    caption?: string,\n  ): Promise<WhatsAppServiceResponse> {\n    return this.messageService.sendImageMessage(to, imageUrl, caption);\n  }\n\n  async sendTemplateMessage(\n    to: string,\n    templateName: string,\n    languageCode: string,\n    parameters?: string[],\n  ): Promise<WhatsAppServiceResponse> {\n    return this.messageService.sendTemplateMessage(to, templateName, languageCode, parameters);\n  }\n\n  async sendButtonMessage(\n    to: string,\n    bodyText: string,\n    buttons: Array<{ id: string; title: string }>,\n    headerText?: string,\n    footerText?: string,\n  ): Promise<WhatsAppServiceResponse> {\n    return this.messageService.sendButtonMessage(to, bodyText, buttons, headerText, footerText);\n  }\n\n  async sendListMessage(\n    to: string,\n    bodyText: string,\n    buttonText: string,\n    sections: Array<{\n      title?: string;\n      rows: Array<{ id: string; title: string; description?: string }>;\n    }>,\n    options?: { headerText?: string; footerText?: string },\n  ): Promise<WhatsAppServiceResponse> {\n    return this.messageService.sendListMessage(to, bodyText, buttonText, sections, options);\n  }\n\n  // 媒体处理方法代理\n  async getMediaUrl(mediaId: string): Promise<string | null> {\n    return this.mediaService.getMediaUrl(mediaId);\n  }\n\n  async downloadMedia(mediaId: string): Promise<Buffer | null> {\n    return this.mediaService.downloadMedia(mediaId);\n  }\n\n  async uploadMedia(\n    file: Buffer | Blob,\n    type: 'image' | 'document' | 'audio' | 'video' | 'sticker',\n    filename?: string,\n  ): Promise<string | null> {\n    return this.mediaService.uploadMedia(file, type, filename);\n  }\n\n  // 工具方法代理\n  static validatePhoneNumber = WhatsAppUtils.validatePhoneNumber;\n  static formatPhoneNumber = WhatsAppUtils.formatPhoneNumber;\n  static validateMessageLength = WhatsAppUtils.validateMessageLength;\n\n  // 获取服务实例\n  getMessageService(): WhatsAppMessageService {\n    return this.messageService;\n  }\n\n  getMediaService(): WhatsAppMediaService {\n    return this.mediaService;\n  }\n\n  // 配置信息\n  getConfig(): { accessToken: string; phoneNumberId: string } {\n    return {\n      accessToken: this.accessToken,\n      phoneNumberId: this.phoneNumberId,\n    };\n  }\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/whatsapp-media.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/whatsapp-messages.ts","messages":[{"ruleId":"no-return-await","severity":2,"message":"Redundant use of `await` on a return value.","line":84,"column":12,"nodeType":"Identifier","messageId":"redundantUseOfAwait","endLine":84,"endColumn":43,"suggestions":[{"messageId":"removeAwait","fix":{"range":[1981,1987],"text":""},"desc":"Remove redundant `await`."}]},{"ruleId":"no-return-await","severity":2,"message":"Redundant use of `await` on a return value.","line":106,"column":12,"nodeType":"Identifier","messageId":"redundantUseOfAwait","endLine":106,"endColumn":43,"suggestions":[{"messageId":"removeAwait","fix":{"range":[2413,2419],"text":""},"desc":"Remove redundant `await`."}]},{"ruleId":"max-params","severity":2,"message":"Async method 'sendTemplateMessage' has too many parameters (4). Maximum allowed is 3.","line":112,"column":3,"nodeType":"FunctionExpression","messageId":"exceed","endLine":112,"endColumn":28},{"ruleId":"no-return-await","severity":2,"message":"Redundant use of `await` on a return value.","line":143,"column":12,"nodeType":"Identifier","messageId":"redundantUseOfAwait","endLine":143,"endColumn":43,"suggestions":[{"messageId":"removeAwait","fix":{"range":[3225,3231],"text":""},"desc":"Remove redundant `await`."}]},{"ruleId":"max-params","severity":2,"message":"Async method 'sendButtonMessage' has too many parameters (5). Maximum allowed is 3.","line":149,"column":3,"nodeType":"FunctionExpression","messageId":"exceed","endLine":149,"endColumn":26},{"ruleId":"no-return-await","severity":2,"message":"Redundant use of `await` on a return value.","line":189,"column":12,"nodeType":"Identifier","messageId":"redundantUseOfAwait","endLine":189,"endColumn":43,"suggestions":[{"messageId":"removeAwait","fix":{"range":[4223,4229],"text":""},"desc":"Remove redundant `await`."}]},{"ruleId":"max-params","severity":2,"message":"Async method 'sendListMessage' has too many parameters (5). Maximum allowed is 3.","line":195,"column":3,"nodeType":"FunctionExpression","messageId":"exceed","endLine":195,"endColumn":24},{"ruleId":"no-return-await","severity":2,"message":"Redundant use of `await` on a return value.","line":236,"column":12,"nodeType":"Identifier","messageId":"redundantUseOfAwait","endLine":236,"endColumn":43,"suggestions":[{"messageId":"removeAwait","fix":{"range":[5333,5339],"text":""},"desc":"Remove redundant `await`."}]}],"suppressedMessages":[],"errorCount":8,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * WhatsApp Business API 消息发送服务\n * 提供各种类型消息的发送功能\n */\n\nimport type {\n  ImageMessage,\n  InteractiveMessage,\n  SendMessageRequest,\n  TextMessage,\n  WhatsAppServiceResponse,\n} from '@/types/whatsapp';\nimport { logger } from '@/lib/logger';\n\n/**\n * WhatsApp 消息发送类\n */\nexport class WhatsAppMessageService {\n  private readonly baseUrl = 'https://graph.facebook.com/v18.0';\n  private readonly accessToken: string;\n  private readonly phoneNumberId: string;\n\n  constructor(accessToken: string, phoneNumberId: string) {\n    this.accessToken = accessToken;\n    this.phoneNumberId = phoneNumberId;\n  }\n\n  /**\n   * 发送消息的通用方法\n   */\n  async sendMessage(message: SendMessageRequest): Promise<WhatsAppServiceResponse> {\n    try {\n      const response = await fetch(\n        `${this.baseUrl}/${this.phoneNumberId}/messages`,\n        {\n          method: 'POST',\n          headers: {\n            'Authorization': `Bearer ${this.accessToken}`,\n            'Content-Type': 'application/json',\n          },\n          body: JSON.stringify(message),\n        },\n      );\n\n      const data = await response.json();\n\n      if (!response.ok) {\n        const error = data as { error?: { message?: string } };\n        throw new Error(error.error?.message || 'Failed to send message');\n      }\n\n      return {\n        success: true,\n        data: data,\n      };\n    } catch (error) {\n      logger.error('WhatsApp API Error', {}, error instanceof Error ? error : new Error(String(error)));\n      return {\n        success: false,\n        error: error instanceof Error ? error.message : 'Unknown error',\n      };\n    }\n  }\n\n  /**\n   * 发送文本消息\n   */\n  async sendTextMessage(\n    to: string,\n    text: string,\n    previewUrl: boolean = false,\n  ): Promise<WhatsAppServiceResponse> {\n    const message: TextMessage = {\n      messaging_product: 'whatsapp',\n      recipient_type: 'individual',\n      to,\n      type: 'text',\n      text: {\n        body: text,\n        preview_url: previewUrl,\n      },\n    };\n\n    return await this.sendMessage(message);\n  }\n\n  /**\n   * 发送图片消息\n   */\n  async sendImageMessage(\n    to: string,\n    imageUrl: string,\n    caption?: string,\n  ): Promise<WhatsAppServiceResponse> {\n    const message: ImageMessage = {\n      messaging_product: 'whatsapp',\n      recipient_type: 'individual',\n      to,\n      type: 'image',\n      image: {\n        link: imageUrl,\n        ...(caption && { caption }),\n      },\n    };\n\n    return await this.sendMessage(message);\n  }\n\n  /**\n   * 发送模板消息\n   */\n  async sendTemplateMessage(\n    to: string,\n    templateName: string,\n    languageCode: string,\n    parameters?: string[],\n  ): Promise<WhatsAppServiceResponse> {\n    const message: SendMessageRequest = {\n      messaging_product: 'whatsapp',\n      recipient_type: 'individual',\n      to,\n      type: 'template',\n      template: {\n        name: templateName,\n        language: {\n          code: languageCode,\n          policy: 'deterministic',\n        },\n        ...(parameters && {\n          components: [\n            {\n              type: 'body',\n              parameters: parameters.map((param) => ({\n                type: 'text',\n                text: param,\n              })),\n            },\n          ],\n        }),\n      },\n    };\n\n    return await this.sendMessage(message);\n  }\n\n  /**\n   * 发送交互式按钮消息\n   */\n  async sendButtonMessage(\n    to: string,\n    bodyText: string,\n    buttons: Array<{ id: string; title: string }>,\n    headerText?: string,\n    footerText?: string,\n  ): Promise<WhatsAppServiceResponse> {\n    const message: InteractiveMessage = {\n      messaging_product: 'whatsapp',\n      recipient_type: 'individual',\n      to,\n      type: 'interactive',\n      interactive: {\n        type: 'button',\n        ...(headerText && {\n          header: {\n            type: 'text',\n            text: headerText,\n          },\n        }),\n        body: {\n          text: bodyText,\n        },\n        ...(footerText && {\n          footer: {\n            text: footerText,\n          },\n        }),\n        action: {\n          buttons: buttons.map((button) => ({\n            type: 'reply',\n            reply: {\n              id: button.id,\n              title: button.title,\n            },\n          })),\n        },\n      },\n    };\n\n    return await this.sendMessage(message);\n  }\n\n  /**\n   * 发送列表消息\n   */\n  async sendListMessage(\n    to: string,\n    bodyText: string,\n    buttonText: string,\n    sections: Array<{\n      title?: string;\n      rows: Array<{ id: string; title: string; description?: string }>;\n    }>,\n    options?: { headerText?: string; footerText?: string },\n  ): Promise<WhatsAppServiceResponse> {\n    const message: InteractiveMessage = {\n      messaging_product: 'whatsapp',\n      recipient_type: 'individual',\n      to,\n      type: 'interactive',\n      interactive: {\n        type: 'list',\n        ...(options?.headerText && {\n          header: {\n            type: 'text',\n            text: options.headerText,\n          },\n        }),\n        body: {\n          text: bodyText,\n        },\n        ...(options?.footerText && {\n          footer: {\n            text: options.footerText,\n          },\n        }),\n        action: {\n          button: buttonText,\n          sections: sections.map((section) => ({\n            title: section.title || '',\n            rows: section.rows,\n          })),\n        },\n      },\n    };\n\n    return await this.sendMessage(message);\n  }\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/whatsapp-service.ts","messages":[{"ruleId":"max-params","severity":2,"message":"Arrow function has too many parameters (4). Maximum allowed is 3.","line":54,"column":3,"nodeType":"ArrowFunctionExpression","messageId":"exceed","endLine":54,"endColumn":5}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * WhatsApp Business API 服务 - 统一导出入口\n * 提供完整的WhatsApp消息发送和管理功能\n */\n\n// 导出核心服务类\nexport { WhatsAppService } from './whatsapp-core';\n\n// 导出子服务类\nexport { WhatsAppMessageService } from './whatsapp-messages';\nexport { WhatsAppMediaService } from './whatsapp-media';\nexport { WhatsAppUtils } from './whatsapp-utils';\n\n// 导出类型\nexport type {\n  SendMessageRequest,\n  WhatsAppServiceResponse,\n} from '@/types/whatsapp';\n\n// 延迟初始化的单例实例\nimport { WhatsAppService } from './whatsapp-core';\nimport type { SendMessageRequest } from '@/types/whatsapp';\n\nlet whatsappServiceInstance: WhatsAppService | null = null;\n\nfunction getWhatsAppService(): WhatsAppService {\n  if (!whatsappServiceInstance) {\n    whatsappServiceInstance = new WhatsAppService();\n  }\n  return whatsappServiceInstance;\n}\n\n// 导出便捷函数\nexport const sendWhatsAppMessage = (message: SendMessageRequest) =>\n  getWhatsAppService().sendMessage(message);\n\nexport const sendWhatsAppText = (\n  to: string,\n  text: string,\n  previewUrl?: boolean,\n) => getWhatsAppService().sendTextMessage(to, text, previewUrl);\n\nexport const sendWhatsAppImage = (\n  to: string,\n  imageUrl: string,\n  caption?: string,\n) => getWhatsAppService().sendImageMessage(to, imageUrl, caption);\n\nexport const sendWhatsAppTemplate = (\n  to: string,\n  templateName: string,\n  languageCode: string,\n  parameters?: string[],\n) =>\n  getWhatsAppService().sendTemplateMessage(\n    to,\n    templateName,\n    languageCode,\n    parameters,\n  );\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/whatsapp-utils.ts","messages":[{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 1024.","line":43,"column":23,"nodeType":"Literal","messageId":"noMagic","endLine":43,"endColumn":27},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 3.","line":51,"column":50,"nodeType":"Literal","messageId":"noMagic","endLine":51,"endColumn":51},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 256.","line":59,"column":27,"nodeType":"Literal","messageId":"noMagic","endLine":59,"endColumn":30},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 20.","line":61,"column":30,"nodeType":"Literal","messageId":"noMagic","endLine":61,"endColumn":32},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 10.","line":69,"column":44,"nodeType":"Literal","messageId":"noMagic","endLine":69,"endColumn":46},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 24.","line":79,"column":27,"nodeType":"Literal","messageId":"noMagic","endLine":79,"endColumn":29},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 72.","line":80,"column":85,"nodeType":"Literal","messageId":"noMagic","endLine":80,"endColumn":87},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 36.","line":88,"column":56,"nodeType":"Literal","messageId":"noMagic","endLine":88,"endColumn":58},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2.","line":88,"column":67,"nodeType":"Literal","messageId":"noMagic","endLine":88,"endColumn":68},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 9.","line":88,"column":70,"nodeType":"Literal","messageId":"noMagic","endLine":88,"endColumn":71},{"ruleId":"no-new","severity":2,"message":"Do not use 'new' for side effects.","line":96,"column":7,"nodeType":"ExpressionStatement","messageId":"noNewStatement","endLine":96,"endColumn":20}],"suppressedMessages":[],"errorCount":11,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * WhatsApp Business API 工具函数\n * 提供验证、格式化等辅助功能\n */\n\n/**\n * WhatsApp 工具类\n */\nexport class WhatsAppUtils {\n  /**\n   * 验证电话号码格式\n   */\n  static validatePhoneNumber(phoneNumber: string): boolean {\n    // 基本验证：应该包含国家代码，只包含数字\n    const phoneRegex = /^\\d{10,15}$/;\n    return phoneRegex.test(phoneNumber.replace(/\\D/g, ''));\n  }\n\n  /**\n   * 格式化电话号码（移除非数字字符）\n   */\n  static formatPhoneNumber(phoneNumber: string): string {\n    return phoneNumber.replace(/\\D/g, '');\n  }\n\n  /**\n   * 检查消息长度限制\n   */\n  static validateMessageLength(\n    message: string,\n    maxLength: number = 4096,\n  ): boolean {\n    return message.length <= maxLength;\n  }\n\n  /**\n   * 验证模板参数\n   */\n  static validateTemplateParameters(parameters: string[]): boolean {\n    return parameters.every(param => \n      typeof param === 'string' && \n      param.length > 0 && \n      param.length <= 1024\n    );\n  }\n\n  /**\n   * 验证按钮配置\n   */\n  static validateButtons(buttons: Array<{ id: string; title: string }>): boolean {\n    if (buttons.length === 0 || buttons.length > 3) {\n      return false;\n    }\n\n    return buttons.every(button => \n      typeof button.id === 'string' && \n      typeof button.title === 'string' &&\n      button.id.length > 0 && \n      button.id.length <= 256 &&\n      button.title.length > 0 && \n      button.title.length <= 20\n    );\n  }\n\n  /**\n   * 验证列表行配置\n   */\n  static validateListRows(rows: Array<{ id: string; title: string; description?: string }>): boolean {\n    if (rows.length === 0 || rows.length > 10) {\n      return false;\n    }\n\n    return rows.every(row => \n      typeof row.id === 'string' && \n      typeof row.title === 'string' &&\n      row.id.length > 0 && \n      row.id.length <= 200 &&\n      row.title.length > 0 && \n      row.title.length <= 24 &&\n      (!row.description || (row.description.length > 0 && row.description.length <= 72))\n    );\n  }\n\n  /**\n   * 生成唯一的消息ID\n   */\n  static generateMessageId(): string {\n    return `msg_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n  }\n\n  /**\n   * 检查URL格式\n   */\n  static validateUrl(url: string): boolean {\n    try {\n      new URL(url);\n      return true;\n    } catch {\n      return false;\n    }\n  }\n\n  /**\n   * 检查媒体类型\n   */\n  static validateMediaType(type: string): boolean {\n    const validTypes = ['image', 'document', 'audio', 'video', 'sticker'];\n    return validTypes.includes(type);\n  }\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/lib/whatsapp.ts","messages":[{"ruleId":"no-undef","severity":2,"message":"'error' is not defined.","line":61,"column":13,"nodeType":"Identifier","messageId":"undef","endLine":61,"endColumn":18},{"ruleId":"max-params","severity":2,"message":"Async method 'sendTemplateMessage' has too many parameters (4). Maximum allowed is 3.","line":68,"column":3,"nodeType":"FunctionExpression","messageId":"exceed","endLine":68,"endColumn":28},{"ruleId":"no-undef","severity":2,"message":"'error' is not defined.","line":94,"column":13,"nodeType":"Identifier","messageId":"undef","endLine":94,"endColumn":18},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (4). Maximum allowed is 3.","line":127,"column":11,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":129,"endColumn":12},{"ruleId":"no-undef","severity":2,"message":"'error' is not defined.","line":137,"column":13,"nodeType":"Identifier","messageId":"undef","endLine":137,"endColumn":18}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import WhatsApp from 'whatsapp';\nimport { env } from '../../env.mjs';\nimport { logger } from './logger';\n\n/**\n * WhatsApp webhook消息体类型定义\n */\ninterface WhatsAppWebhookBody {\n  entry?: Array<{\n    changes?: Array<{\n      value?: {\n        messages?: Array<{\n          from: string;\n          text?: { body: string };\n        }>;\n      };\n    }>;\n  }>;\n}\n\n/**\n * WhatsApp Business API 服务类\n * 提供发送消息、处理 webhook 等功能\n */\nexport class WhatsAppService {\n  private client: WhatsApp;\n\n  constructor() {\n    if (!env.WHATSAPP_ACCESS_TOKEN) {\n      throw new Error('WHATSAPP_ACCESS_TOKEN is required');\n    }\n\n    // WhatsApp constructor expects phoneNumberId as number\n    const phoneNumberId = env.WHATSAPP_PHONE_NUMBER_ID\n      ? parseInt(env.WHATSAPP_PHONE_NUMBER_ID, 10)\n      : 0;\n    this.client = new WhatsApp(phoneNumberId);\n    // Set token separately if needed\n    if (env.WHATSAPP_ACCESS_TOKEN) {\n      (this.client as { token?: string }).token = env.WHATSAPP_ACCESS_TOKEN;\n    }\n  }\n\n  /**\n   * 发送文本消息\n   */\n  async sendTextMessage(to: string, message: string) {\n    try {\n      // WhatsApp API expects recipient as second parameter\n      const recipient = parseInt(to, 10);\n      const response = await this.client.messages.text(\n        {\n          body: message,\n        },\n        recipient,\n      );\n      return response;\n    } catch (_error) {\n    // 忽略错误变量\n      logger.error('Failed to send WhatsApp message', {}, _error instanceof Error ? _error : new Error(String(_error)));\n      throw error;\n    }\n  }\n\n  /**\n   * 发送模板消息\n   */\n  async sendTemplateMessage(\n    to: string,\n    templateName: string,\n    languageCode: string = 'en',\n    components?: Array<Record<string, unknown>>,\n  ) {\n    try {\n      // WhatsApp API expects recipient as second parameter\n      const recipient = parseInt(to, 10);\n      // WhatsApp template message with correct structure\n      const templateObject = {\n        name: templateName,\n        language: {\n          policy: 'deterministic' as const,\n          code: languageCode,\n        },\n        ...(components && { components }),\n      };\n      const response = await this.client.messages.template(\n        templateObject as unknown as Parameters<typeof this.client.messages.template>[0],\n        recipient,\n      );\n      return response;\n    } catch (_error) {\n    // 忽略错误变量\n      logger.error('Failed to send WhatsApp template message', {}, _error instanceof Error ? _error : new Error(String(_error)));\n      throw error;\n    }\n  }\n\n  /**\n   * 验证 webhook 签名\n   */\n  verifyWebhook(mode: string, token: string, challenge: string): string | null {\n    if (mode === 'subscribe' && token === env.WHATSAPP_WEBHOOK_VERIFY_TOKEN) {\n      return challenge;\n    }\n    return null;\n  }\n\n  /**\n   * 处理接收到的消息\n   */\n  async handleIncomingMessage(body: WhatsAppWebhookBody) {\n    try {\n      const entry = body.entry?.[0];\n      const changes = entry?.changes?.[0];\n      const value = changes?.value;\n\n      if (value?.messages) {\n        const [message] = value.messages;\n        if (message) {\n          const { from } = message;\n          const messageBody = message.text?.body;\n\n          // 使用logger替代console.log\n          logger.info(`Received WhatsApp message from ${from}: ${messageBody}`);\n\n          // 这里可以添加自动回复逻辑\n          if (messageBody) {\n            await this.sendAutoReply(from, messageBody);\n          }\n        }\n      }\n\n      return { success: true };\n    } catch (_error) {\n    // 忽略错误变量\n      logger.error('Failed to handle incoming WhatsApp message', {}, _error instanceof Error ? _error : new Error(String(_error)));\n      throw error;\n    }\n  }\n\n  /**\n   * 自动回复逻辑\n   */\n  private async sendAutoReply(to: string, receivedMessage: string) {\n    // 简单的自动回复逻辑\n    const lowerMessage = receivedMessage.toLowerCase();\n\n    let replyMessage = '';\n\n    if (lowerMessage.includes('hello') || lowerMessage.includes('hi')) {\n      replyMessage =\n        'Hello! Thank you for contacting us. How can we help you today?';\n    } else if (lowerMessage.includes('help')) {\n      replyMessage =\n        \"We're here to help! Please describe your question or concern.\";\n    } else if (\n      lowerMessage.includes('price') ||\n      lowerMessage.includes('cost')\n    ) {\n      replyMessage =\n        'For pricing information, please visit our website or contact our sales team.';\n    } else {\n      replyMessage =\n        'Thank you for your message. Our team will get back to you soon!';\n    }\n\n    await this.sendTextMessage(to, replyMessage);\n  }\n}\n\n// 单例实例\nlet whatsappService: WhatsAppService | null = null;\n\nexport function getWhatsAppService(): WhatsAppService {\n  if (!whatsappService) {\n    whatsappService = new WhatsAppService();\n  }\n  return whatsappService;\n}\n\n// 消息类型定义\nexport interface WhatsAppMessage {\n  to: string;\n  type: 'text' | 'template' | 'media';\n  content: {\n    body?: string;\n    templateName?: string;\n    languageCode?: string;\n    components?: Array<Record<string, unknown>>;\n    mediaUrl?: string;\n    caption?: string;\n  };\n}\n\n// 发送消息的通用函数\nexport function sendWhatsAppMessage(message: WhatsAppMessage) {\n  const service = getWhatsAppService();\n\n  switch (message.type) {\n    case 'text':\n      return service.sendTextMessage(message.to, message.content.body!);\n\n    case 'template':\n      return service.sendTemplateMessage(\n        message.to,\n        message.content.templateName!,\n        message.content.languageCode,\n        message.content.components,\n      );\n\n    default:\n      throw new Error(`Unsupported message type: ${message.type}`);\n  }\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/scripts/test-web-vitals.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/services/__tests__/url-generator.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/services/url-generator-cjs.js","messages":[],"suppressedMessages":[{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":51,"column":8,"nodeType":"MemberExpression","endLine":51,"endColumn":30,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":54,"column":10,"nodeType":"MemberExpression","endLine":54,"endColumn":40,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":54,"column":10,"nodeType":"MemberExpression","endLine":54,"endColumn":32,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/services/url-generator.ts","messages":[],"suppressedMessages":[{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":130,"column":7,"nodeType":"MemberExpression","endLine":130,"endColumn":25,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":246,"column":11,"nodeType":"MemberExpression","endLine":246,"endColumn":24,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/shared/__tests__/utils.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/shared/utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/test/browser-setup.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/test/mock-templates.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/test/mock-utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/test/setup.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":14,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":14,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[402,405],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[402,405],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-empty-object-type","severity":2,"message":"An interface declaring no members is equivalent to its supertype.","line":14,"column":13,"nodeType":"Identifier","messageId":"noEmptyInterfaceWithSuper","endLine":14,"endColumn":22,"suggestions":[{"messageId":"replaceEmptyInterfaceWithSuper","fix":{"range":[378,449],"text":"type Assertion<T = any> = TestingLibraryMatchers<T, void>"},"desc":"Replace empty interface with a type alias."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-empty-object-type","severity":2,"message":"An interface declaring no members is equivalent to its supertype.","line":16,"column":13,"nodeType":"Identifier","messageId":"noEmptyInterfaceWithSuper","endLine":16,"endColumn":41,"suggestions":[{"messageId":"replaceEmptyInterfaceWithSuper","fix":{"range":[522,613],"text":"type AsymmetricMatchersContaining = TestingLibraryMatchers<unknown, void>"},"desc":"Replace empty interface with a type alias."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Vitest 测试环境设置文件\n * 配置全局测试环境、Mock和工具函数\n */\n\nimport '@testing-library/jest-dom/vitest';\nimport React from 'react';\n// 扩展 Vitest 的 expect 断言\nimport type { TestingLibraryMatchers } from '@testing-library/jest-dom/matchers';\nimport { afterEach, beforeEach, vi } from 'vitest';\n\ndeclare module 'vitest' {\n  // eslint-disable-next-line @typescript-eslint/no-empty-object-type\n  interface Assertion<T = any> extends TestingLibraryMatchers<T, void> {}\n  // eslint-disable-next-line @typescript-eslint/no-empty-object-type\n  interface AsymmetricMatchersContaining\n    extends TestingLibraryMatchers<unknown, void> {}\n}\n\n// Mock Next.js router\nvi.mock('next/router', () => ({\n  useRouter: vi.fn(() => ({\n    route: '/',\n    pathname: '/',\n    query: {},\n    asPath: '/',\n    push: vi.fn(),\n    pop: vi.fn(),\n    reload: vi.fn(),\n    back: vi.fn(),\n    prefetch: vi.fn().mockResolvedValue(undefined),\n    beforePopState: vi.fn(),\n    events: {\n      on: vi.fn(),\n      off: vi.fn(),\n      emit: vi.fn(),\n    },\n    isFallback: false,\n  })),\n}));\n\n// Mock Next.js navigation (App Router)\nvi.mock('next/navigation', () => ({\n  useRouter: vi.fn(() => ({\n    push: vi.fn(),\n    replace: vi.fn(),\n    prefetch: vi.fn(),\n    back: vi.fn(),\n    forward: vi.fn(),\n    refresh: vi.fn(),\n  })),\n  useSearchParams: vi.fn(() => new URLSearchParams()),\n  usePathname: vi.fn(() => '/'),\n  useParams: vi.fn(() => ({})),\n}));\n\n// Mock next-intl - 提供实际的翻译映射\nconst mockTranslations: Record<string, string> = {\n  'navigation.home': 'Home',\n  'navigation.about': 'About',\n  'navigation.services': 'Services',\n  'navigation.products': 'Products',\n  'navigation.blog': 'Blog',\n  'navigation.diagnostics': 'Diagnostics',\n  'navigation.contact': 'Contact',\n};\n\nvi.mock('next-intl', () => ({\n  useTranslations: vi.fn(() => (key: string) => {\n    const safeTranslations = new Map(Object.entries(mockTranslations));\n    return safeTranslations.get(key) || key;\n  }),\n  useLocale: vi.fn(() => 'en'),\n  useMessages: vi.fn(() => ({})),\n  useFormatter: vi.fn(() => ({\n    dateTime: vi.fn(),\n    number: vi.fn(),\n    relativeTime: vi.fn(),\n  })),\n}));\n\n// Mock next-intl/server\nvi.mock('next-intl/server', () => ({\n  getTranslations: vi.fn(() => (key: string) => key),\n  getLocale: vi.fn(() => 'en'),\n  getMessages: vi.fn(() => ({})),\n  getFormatter: vi.fn(() => ({\n    dateTime: vi.fn(),\n    number: vi.fn(),\n    relativeTime: vi.fn(),\n  })),\n}));\n\n// Mock next-themes\nvi.mock('next-themes', () => ({\n  useTheme: vi.fn(() => ({\n    theme: 'light',\n    setTheme: vi.fn(),\n    resolvedTheme: 'light',\n    themes: ['light', 'dark', 'system'],\n    systemTheme: 'light',\n  })),\n  ThemeProvider: ({ children }: { children: React.ReactNode }) => children,\n}));\n\n// Mock environment variables - use Object.defineProperty for read-only properties\ntry {\n  if (!process.env.NODE_ENV) {\n    Object.defineProperty(process.env, 'NODE_ENV', {\n      value: 'test',\n      writable: false,\n      enumerable: true,\n      configurable: true,\n    });\n  }\n} catch {\n  // Environment variable already set, ignore\n}\n\n// Enhanced matchMedia mock for accessibility testing\nObject.defineProperty(window, 'matchMedia', {\n  writable: true,\n  value: vi.fn().mockImplementation((query: string) => ({\n    matches: false,\n    media: query,\n    onchange: null,\n    addListener: vi.fn(), // Deprecated but still used by some libraries\n    removeListener: vi.fn(), // Deprecated but still used by some libraries\n    addEventListener: vi.fn(),\n    removeEventListener: vi.fn(),\n    dispatchEvent: vi.fn(),\n  })),\n});\n\n// Mock ResizeObserver for React components that use it\nglobalThis.ResizeObserver = vi.fn().mockImplementation(() => ({\n  observe: vi.fn(),\n  unobserve: vi.fn(),\n  disconnect: vi.fn(),\n}));\n\n// Mock IntersectionObserver for React components that use it\nglobalThis.IntersectionObserver = vi.fn().mockImplementation(() => ({\n  observe: vi.fn(),\n  unobserve: vi.fn(),\n  disconnect: vi.fn(),\n}));\n\n// Mock PerformanceObserver for performance monitoring\nconst MockPerformanceObserver = vi.fn().mockImplementation((_callback) => ({\n  observe: vi.fn(),\n  unobserve: vi.fn(),\n  disconnect: vi.fn(),\n  takeRecords: vi.fn().mockReturnValue([]),\n}));\n\n// 添加静态属性\nObject.defineProperty(MockPerformanceObserver, 'supportedEntryTypes', {\n  value: ['navigation', 'resource', 'measure', 'mark'],\n  writable: false,\n  enumerable: true,\n  configurable: true,\n});\n\nglobalThis.PerformanceObserver = MockPerformanceObserver as unknown;\n\n// Mock environment variables - 使用vi.stubEnv而不是直接修改process.env\nvi.stubEnv('NODE_ENV', 'test');\nvi.stubEnv('NEXT_PUBLIC_SITE_URL', 'https://tucsenberg.com');\nvi.stubEnv('NEXT_PUBLIC_VERCEL_URL', 'tucsenberg.vercel.app');\n\n// Mock server-side environment variables for API testing\nvi.stubEnv('TURNSTILE_SECRET_KEY', 'test-secret-key');\nvi.stubEnv('RESEND_API_KEY', 'test-resend-key');\nvi.stubEnv('AIRTABLE_API_KEY', 'test-airtable-key');\nvi.stubEnv('AIRTABLE_BASE_ID', 'test-base-id');\nvi.stubEnv('AIRTABLE_TABLE_NAME', 'test-table');\nvi.stubEnv('EMAIL_FROM', 'test@example.com');\nvi.stubEnv('EMAIL_REPLY_TO', 'reply@example.com');\nvi.stubEnv('CSP_REPORT_URI', 'https://example.com/csp-report');\nvi.stubEnv('ADMIN_TOKEN', 'test-admin-token');\n\n// Mock @t3-oss/env-nextjs to prevent server-side environment variable access errors\nvi.mock('../../env.mjs', () => ({\n  env: {\n    NODE_ENV: 'test',\n    TURNSTILE_SECRET_KEY: 'test-secret-key',\n    RESEND_API_KEY: 'test-resend-key',\n    AIRTABLE_API_KEY: 'test-airtable-key',\n    AIRTABLE_BASE_ID: 'test-base-id',\n    AIRTABLE_TABLE_NAME: 'test-table',\n    EMAIL_FROM: 'test@example.com',\n    EMAIL_REPLY_TO: 'reply@example.com',\n    CSP_REPORT_URI: 'https://example.com/csp-report',\n    ADMIN_TOKEN: 'test-admin-token',\n    NEXT_PUBLIC_SITE_URL: 'https://tucsenberg.com',\n    NEXT_PUBLIC_VERCEL_URL: 'tucsenberg.vercel.app',\n  },\n}));\n\n// Mock validations module for API tests\nvi.mock('../lib/validations', () => ({\n  contactFormSchema: {\n    extend: vi.fn(() => ({\n      safeParse: vi.fn(() => ({\n        success: true,\n        data: {},\n      })),\n    })),\n    safeParse: vi.fn(() => ({\n      success: true,\n      data: {},\n    })),\n  },\n}));\n\n// Mock requestAnimationFrame for animations\nglobalThis.requestAnimationFrame = vi.fn((cb) => {\n  setTimeout(cb, 0);\n  return 1;\n});\nglobalThis.cancelAnimationFrame = vi.fn((id) => clearTimeout(id as unknown));\n\n// Mock localStorage and sessionStorage\nconst createStorageMock = () => {\n  const store = new Map<string, string>();\n  return {\n    getItem: vi.fn((key: string) => store.get(key) || null),\n    setItem: vi.fn((key: string, value: string) => {\n      store.set(key, value.toString());\n    }),\n    removeItem: vi.fn((key: string) => {\n      store.delete(key);\n    }),\n    clear: vi.fn(() => {\n      store.clear();\n    }),\n    get length() {\n      return store.size;\n    },\n    key: vi.fn((index: number) => {\n      const keys = Array.from(store.keys());\n      // 安全的数组访问，避免对象注入\n      return index >= 0 && index < keys.length ? keys.at(index) || null : null;\n    }),\n  };\n};\n\nObject.defineProperty(window, 'localStorage', {\n  value: createStorageMock(),\n});\n\nObject.defineProperty(window, 'sessionStorage', {\n  value: createStorageMock(),\n});\n\n// Mock CSS.supports for CSS feature detection\nObject.defineProperty(window, 'CSS', {\n  value: {\n    supports: vi.fn().mockReturnValue(true),\n  },\n});\n\n// Mock document.startViewTransition for theme transitions\nObject.defineProperty(document, 'startViewTransition', {\n  value: vi.fn((callback?: () => void) => {\n    callback?.();\n    return Promise.resolve();\n  }),\n  writable: true,\n});\n\n// Setup DOM container for React Testing Library\nif (typeof document !== 'undefined') {\n  // Create a root container for React Testing Library\n  const container = document.createElement('div');\n  container.id = 'test-container';\n  document.body.appendChild(container);\n}\n\n// Global test setup\nbeforeEach(() => {\n  // Reset all mocks before each test\n  vi.clearAllMocks();\n\n  // Set up environment variables for API tests\n  vi.stubEnv('ADMIN_API_TOKEN', 'test-admin-token');\n\n  // Reset DOM - 安全的DOM重置\n  if (typeof document !== 'undefined' && document.body) {\n    try {\n      document.body.innerHTML = '<div id=\"test-container\"></div>';\n    } catch {\n      // 如果DOM操作失败，创建新的body元素\n      const newBody = document.createElement('body');\n      newBody.innerHTML = '<div id=\"test-container\"></div>';\n      if (document.documentElement) {\n        document.documentElement.replaceChild(newBody, document.body);\n      }\n    }\n  }\n\n  // Reset localStorage (only if window is available)\n  if (typeof window !== 'undefined') {\n    if (window.localStorage) {\n      window.localStorage.clear();\n    }\n    if (window.sessionStorage) {\n      window.sessionStorage.clear();\n    }\n  }\n});\n\nafterEach(() => {\n  // Cleanup after each test\n  vi.clearAllTimers();\n  vi.restoreAllMocks();\n});\n\n// Console error suppression for known issues\nconst originalError = console.error;\nbeforeEach(() => {\n  console.error = (...args: unknown[]) => {\n    if (\n      typeof args[0] === 'string' &&\n      (args[0].includes('Warning: ReactDOM.render is deprecated') ||\n        args[0].includes('Warning: React.createFactory() is deprecated') ||\n        args[0].includes('Warning: componentWillReceiveProps has been renamed'))\n    ) {\n      return;\n    }\n    originalError.call(console, ...args);\n  };\n});\n\nafterEach(() => {\n  console.error = originalError;\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/test/test-template.example.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/test/utils.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/testing/templates/component-test-template.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/testing/utils/theme-test-utilities.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/types/__tests__/global.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/types/__tests__/index.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/types/content.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/types/global.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/types/i18n-enhanced.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/types/i18n.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/types/index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/types/test-types.ts","messages":[{"ruleId":"max-params","severity":2,"message":"Function has too many parameters (5). Maximum allowed is 3.","line":274,"column":22,"nodeType":"TSFunctionType","messageId":"exceed","endLine":274,"endColumn":22}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * 测试相关的TypeScript类型定义\n * 用于替换测试文件中的any类型，提升类型安全性\n */\n\n// ============================================================================\n// DOM Mock Types - 用于测试中的DOM元素模拟\n// ============================================================================\n\n/**\n * Mock DOM元素接口\n * 用于模拟测试中的HTML元素\n * 使用交叉类型提供HTMLElement兼容性，同时保留必需的Mock属性\n */\nexport interface MockDOMElement {\n  id: string;\n  textContent: string | null;\n  setAttribute: (_name: string, _value: string) => void;\n  style: Record<string, string>;\n  parentNode: {\n    removeChild: (_child: MockDOMElement) => MockDOMElement;\n  } | null;\n  // 添加HTMLElement的关键属性以提供类型兼容性\n  [key: string]: unknown;\n}\n\n/**\n * Mock键盘事件接口\n * 用于模拟键盘交互测试\n * 使用交叉类型提供KeyboardEvent兼容性，同时保留必需的Mock属性\n */\nexport interface MockKeyboardEvent {\n  key: string;\n  preventDefault: () => void;\n  stopPropagation?: () => void;\n  target?: MockDOMElement;\n  currentTarget?: MockDOMElement;\n  // 添加KeyboardEvent的关键属性以提供类型兼容性\n  [key: string]: unknown;\n}\n\n/**\n * Mock鼠标事件接口\n * 用于模拟鼠标交互测试\n */\nexport interface MockMouseEvent {\n  type: string;\n  button: number;\n  clientX: number;\n  clientY: number;\n  preventDefault: () => void;\n  stopPropagation?: () => void;\n  target?: MockDOMElement;\n  currentTarget?: MockDOMElement;\n}\n\n// ============================================================================\n// Environment Mock Types - 用于环境变量和全局对象模拟\n// ============================================================================\n\n/**\n * Mock环境变量接口\n * 用于测试中的process.env模拟\n */\nexport interface MockProcessEnv {\n  NODE_ENV?: string;\n  [key: string]: string | undefined;\n}\n\n/**\n * Mock Crypto API接口\n * 用于测试中的加密API模拟\n */\nexport interface MockCrypto {\n  getRandomValues: ((_array: Uint8Array) => Uint8Array) | null;\n  randomUUID?: () => string;\n  subtle?: {\n    digest: (_algorithm: string, _data: ArrayBuffer) => Promise<ArrayBuffer>;\n  };\n}\n\n/**\n * Mock全局对象接口\n * 用于测试中的全局对象模拟\n */\nexport interface MockGlobal {\n  crypto: MockCrypto;\n  window?: {\n    matchMedia: (_query: string) => MediaQueryList;\n    location: {\n      href: string;\n      pathname: string;\n      search: string;\n    };\n  };\n}\n\n// ============================================================================\n// Test Analytics Types - 用于主题分析测试的数据类型\n// ============================================================================\n\n/**\n * 主题切换模式类型\n */\nexport type ThemeMode = 'light' | 'dark' | 'system';\n\n/**\n * 性能指标接口\n * 用于主题切换性能测试\n */\nexport interface MockPerformanceMetric {\n  switchDuration: number;\n  fromTheme: ThemeMode;\n  toTheme: ThemeMode;\n  timestamp: number | null;\n  userAgent: string;\n  viewportSize: {\n    width: number;\n    height: number;\n  };\n  supportsViewTransitions: boolean;\n}\n\n/**\n * 主题切换模式接口\n * 用于分析主题切换行为模式\n */\nexport interface MockSwitchPattern {\n  sequence: [ThemeMode, ThemeMode];\n  frequency: number;\n  lastOccurrence: number;\n}\n\n/**\n * 分析配置接口\n * 用于主题分析器配置测试\n */\nexport interface MockAnalyticsConfig {\n  enabled: boolean;\n  sampleRate: number;\n  maxRecords?: number;\n  debugMode?: boolean;\n}\n\n// ============================================================================\n// Test Utility Types - 用于测试工具函数的类型\n// ============================================================================\n\n/**\n * Jest Mock函数类型\n * 用于类型化Jest模拟函数\n */\nexport type MockFunction<T extends (..._args: unknown[]) => unknown> = T & {\n  mock: {\n    calls: unknown[][];\n    results: Array<{ type: 'return' | 'throw'; value: unknown }>;\n    instances: unknown[];\n  };\n  mockReturnValue: (_value: ReturnType<T>) => MockFunction<T>;\n  mockImplementation: (_fn: T) => MockFunction<T>;\n  mockResolvedValue: (_value: Awaited<ReturnType<T>>) => MockFunction<T>;\n  mockRejectedValue: (_value: unknown) => MockFunction<T>;\n};\n\n/**\n * 测试回调函数类型\n * 用于异步测试的回调\n */\nexport type TestCallback = (_done?: () => void) => void;\n\n/**\n * 测试配置接口\n * 用于测试设置和配置\n */\nexport interface TestConfig {\n  timeout?: number;\n  retries?: number;\n  skipCI?: boolean;\n  mockTimers?: boolean;\n}\n\n/**\n * 颜色测试数据接口\n * 用于颜色系统测试\n */\nexport interface MockColorData {\n  [key: string]: {\n    l: number;\n    c: number;\n    h: number;\n    alpha?: number;\n  };\n}\n\n// ============================================================================\n// Type Guards - 用于类型检查的工具函数\n// ============================================================================\n\n/**\n * 检查是否为Mock DOM元素\n */\nexport function isMockDOMElement(obj: unknown): obj is MockDOMElement {\n  return (\n    typeof obj === 'object' &&\n    obj !== null &&\n    'id' in obj &&\n    'textContent' in obj &&\n    'setAttribute' in obj\n  );\n}\n\n/**\n * 检查是否为Mock键盘事件\n */\nexport function isMockKeyboardEvent(obj: unknown): obj is MockKeyboardEvent {\n  return (\n    typeof obj === 'object' &&\n    obj !== null &&\n    'key' in obj &&\n    'preventDefault' in obj\n  );\n}\n\n/**\n * 检查是否为有效的主题模式\n */\nexport function isValidThemeMode(mode: string): mode is ThemeMode {\n  return ['light', 'dark', 'system'].includes(mode);\n}\n\n// ============================================================================\n// Accessibility Test Types - 用于无障碍功能测试的类型\n// ============================================================================\n\n/**\n * 无障碍管理器私有属性接口\n * 用于测试中访问私有属性\n */\nexport interface AccessibilityManagerPrivate {\n  liveRegion: MockDOMElement | null;\n  language: string;\n  announcements: string[];\n}\n\n/**\n * 无障碍测试配置接口\n */\nexport interface AccessibilityTestConfig {\n  language?: string;\n  enableAnnouncements?: boolean;\n  mockLiveRegion?: boolean;\n}\n\n// ============================================================================\n// Theme Analytics Private Types - 用于主题分析器私有属性测试\n// ============================================================================\n\n/**\n * 主题分析器私有属性接口\n * 用于测试中访问私有属性\n */\nexport interface ThemeAnalyticsPrivate {\n  performanceMetrics: MockPerformanceMetric[];\n  switchPatterns: MockSwitchPattern[];\n  config: MockAnalyticsConfig;\n  isEnabled: boolean;\n}\n\n/**\n * 主题分析器实例类型\n * 结合公共接口和私有属性\n */\nexport type ThemeAnalyticsInstance = {\n  recordThemeSwitch: (\n    _fromTheme: ThemeMode,\n    _toTheme: ThemeMode,\n    _startTime: number,\n    _endTime: number,\n    _supportsViewTransitions?: boolean,\n  ) => void;\n  recordThemePreference: (_theme: ThemeMode) => void;\n  getPerformanceSummary: () => {\n    totalSwitches: number;\n    averageDuration: number;\n    fastestSwitch: number;\n    slowestSwitch: number;\n  };\n} & ThemeAnalyticsPrivate;\n\n// ============================================================================\n// Color System Test Types - 用于颜色系统测试的类型\n// ============================================================================\n\n/**\n * 不完整的主题颜色类型\n * 用于测试边界情况\n */\nexport interface IncompleteThemeColors {\n  background?: {\n    l: number;\n    c: number;\n    h: number;\n    alpha?: number;\n  };\n  [key: string]:\n    | {\n        l: number;\n        c: number;\n        h: number;\n        alpha?: number;\n      }\n    | undefined;\n}\n\n/**\n * CSS变量生成测试类型\n */\nexport interface CSSVariablesTest {\n  input: MockColorData | IncompleteThemeColors;\n  prefix?: string;\n  expected: Record<string, string>;\n}\n\n// ============================================================================\n// Jest Extended Types - Jest相关的扩展类型\n// ============================================================================\n\n/**\n * Jest模拟函数的扩展类型\n * 支持更复杂的模拟场景\n */\nexport type ExtendedMockFunction<\n  T extends (..._args: unknown[]) => unknown = (..._args: unknown[]) => unknown,\n> = MockFunction<T> & {\n  mockReturnValueOnce: (_value: ReturnType<T>) => ExtendedMockFunction<T>;\n  mockResolvedValueOnce: (\n    _value: Awaited<ReturnType<T>>,\n  ) => ExtendedMockFunction<T>;\n  mockRejectedValueOnce: (_error: unknown) => ExtendedMockFunction<T>;\n};\n\n/**\n * Jest间谍函数类型\n */\nexport type SpyFunction<T = unknown> = T & {\n  mockRestore: () => void;\n  mockClear: () => void;\n  mockReset: () => void;\n};\n\n/**\n * 测试套件配置接口\n */\nexport interface TestSuiteConfig {\n  name: string;\n  timeout?: number;\n  beforeEach?: () => void | Promise<void>;\n  afterEach?: () => void | Promise<void>;\n  beforeAll?: () => void | Promise<void>;\n  afterAll?: () => void | Promise<void>;\n}\n\n// ============================================================================\n// Pattern Matching Types - 用于模式匹配测试的类型\n// ============================================================================\n\n/**\n * 模式匹配结果接口\n * 用于测试中的模式识别\n */\nexport interface PatternMatchResult {\n  pattern: MockSwitchPattern;\n  confidence: number;\n  occurrences: number;\n}\n\n/**\n * 测试数据生成器类型\n */\nexport type TestDataGenerator<T> = (_count: number) => T[];\n\n/**\n * 测试断言辅助类型\n */\nexport interface TestAssertion<T> {\n  actual: T;\n  expected: T;\n  message?: string;\n}\n\n// ============================================================================\n// Export All Types - 导出所有类型的便捷接口\n// ============================================================================\n\n/**\n * 所有测试类型的联合类型\n * 用于类型检查和文档生成\n */\nexport type AllTestTypes =\n  | MockDOMElement\n  | MockKeyboardEvent\n  | MockMouseEvent\n  | MockProcessEnv\n  | MockCrypto\n  | MockGlobal\n  | MockPerformanceMetric\n  | MockSwitchPattern\n  | MockAnalyticsConfig\n  | AccessibilityManagerPrivate\n  | ThemeAnalyticsPrivate\n  | IncompleteThemeColors\n  | CSSVariablesTest;\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/types/translation-manager.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/types/whatsapp-api-config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/types/whatsapp-api-config/constants.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/types/whatsapp-api-config/defaults.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/types/whatsapp-api-config/errors.ts","messages":[{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 131.","line":40,"column":3,"nodeType":"Literal","messageId":"noMagic","endLine":40,"endColumn":6},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 131000.","line":41,"column":3,"nodeType":"Literal","messageId":"noMagic","endLine":41,"endColumn":9},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 131014.","line":42,"column":3,"nodeType":"Literal","messageId":"noMagic","endLine":42,"endColumn":9},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 131016.","line":43,"column":3,"nodeType":"Literal","messageId":"noMagic","endLine":43,"endColumn":9},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 131052.","line":44,"column":3,"nodeType":"Literal","messageId":"noMagic","endLine":44,"endColumn":9},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 131053.","line":45,"column":3,"nodeType":"Literal","messageId":"noMagic","endLine":45,"endColumn":9}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * WhatsApp API 错误处理\n * WhatsApp API Error Handling\n */\n\nimport type { ErrorCode } from './types';\nimport type { ApiConfig, WebhookConfig } from './interfaces';\n\n/**\n * 错误代码映射\n * Error code mappings\n */\nexport const ERROR_CODE_MESSAGES: Record<ErrorCode, string> = {\n  100: 'Generic user error',\n  131: 'Generic temporary error',\n  132: 'Generic limit reached',\n  133: 'Generic permission error',\n  136: 'Generic authentication error',\n  190: 'Access token error',\n  368: 'Temporarily blocked for policies violations',\n  131000: 'Generic temporary error',\n  131005: 'Request limit reached',\n  131008: 'Required parameter is missing',\n  131009: 'Parameter value is not valid',\n  131014: 'Request timeout',\n  131016: 'Service temporarily unavailable',\n  131021: 'Recipient phone number not valid',\n  131026: 'Message undeliverable',\n  131047: 'Re-engagement message',\n  131051: 'Unsupported message type',\n  131052: 'Media download error',\n  131053: 'Media upload error'\n};\n\n/**\n * 可重试的错误代码\n * Retryable error codes\n */\nexport const RETRYABLE_ERROR_CODES: ErrorCode[] = [\n  131,      // Generic temporary error\n  131000,   // Generic temporary error\n  131014,   // Request timeout\n  131016,   // Service temporarily unavailable\n  131052,   // Media download error\n  131053    // Media upload error\n];\n\n/**\n * 配置验证函数\n * Configuration validation functions\n */\nexport function validateApiConfig(config: Partial<ApiConfig>): string[] {\n  const errors: string[] = [];\n  \n  if (!config.accessToken) {\n    errors.push('Access token is required');\n  }\n  \n  if (!config.phoneNumberId) {\n    errors.push('Phone number ID is required');\n  }\n  \n  if (config.timeout && config.timeout <= 0) {\n    errors.push('Timeout must be greater than 0');\n  }\n  \n  if (config.retries && config.retries < 0) {\n    errors.push('Retries must be non-negative');\n  }\n  \n  if (config.retryDelay && config.retryDelay <= 0) {\n    errors.push('Retry delay must be greater than 0');\n  }\n  \n  return errors;\n}\n\nexport function validateWebhookConfig(config: Partial<WebhookConfig>): string[] {\n  const errors: string[] = [];\n  \n  if (!config.url) {\n    errors.push('Webhook URL is required');\n  }\n  \n  if (!config.verifyToken) {\n    errors.push('Verify token is required');\n  }\n  \n  if (config.fields && !Array.isArray(config.fields)) {\n    errors.push('Fields must be an array');\n  }\n  \n  if (config.timeout && config.timeout <= 0) {\n    errors.push('Timeout must be greater than 0');\n  }\n  \n  return errors;\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/types/whatsapp-api-config/interfaces.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'config' is defined but never used. Allowed unused args must match /^_/u.","line":126,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":126,"endColumn":53,"suggestions":[{"messageId":"removeVar","data":{"varName":"config"},"fix":{"range":[2353,2384],"text":""},"desc":"Remove unused variable 'config'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'response' is defined but never used. Allowed unused args must match /^_/u.","line":127,"column":23,"nodeType":"Identifier","messageId":"unusedVar","endLine":127,"endColumn":56,"suggestions":[{"messageId":"removeVar","data":{"varName":"response"},"fix":{"range":[2437,2470],"text":""},"desc":"Remove unused variable 'response'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used. Allowed unused args must match /^_/u.","line":128,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":128,"endColumn":34,"suggestions":[{"messageId":"removeVar","data":{"varName":"error"},"fix":{"range":[2520,2534],"text":""},"desc":"Remove unused variable 'error'."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * WhatsApp API 基础配置接口\n * WhatsApp API Basic Configuration Interfaces\n */\n\n/**\n * API配置\n * API configuration\n */\nexport interface ApiConfig {\n  baseUrl: string;\n  version: string;\n  accessToken: string;\n  phoneNumberId: string;\n  businessAccountId?: string;\n  timeout?: number;\n  retries?: number;\n  retryDelay?: number;\n  userAgent?: string;\n  webhookSecret?: string;\n}\n\n/**\n * 扩展API配置\n * Extended API configuration\n */\nexport interface ExtendedApiConfig extends ApiConfig {\n  // 安全配置\n  security: {\n    validateWebhookSignature: boolean;\n    allowedOrigins?: string[];\n    rateLimiting: {\n      enabled: boolean;\n      maxRequests: number;\n      windowMs: number;\n    };\n  };\n\n  // 日志配置\n  logging: {\n    enabled: boolean;\n    level: 'debug' | 'info' | 'warn' | 'error';\n    includeRequestBody: boolean;\n    includeResponseBody: boolean;\n  };\n\n  // 缓存配置\n  cache: {\n    enabled: boolean;\n    ttl: number;\n    maxSize: number;\n    strategy: 'memory' | 'redis' | 'file';\n  };\n\n  // 重试配置\n  retry: {\n    enabled: boolean;\n    maxAttempts: number;\n    backoffStrategy: 'linear' | 'exponential' | 'fixed';\n    baseDelay: number;\n    maxDelay: number;\n    retryableStatusCodes: number[];\n  };\n\n  // 监控配置\n  monitoring: {\n    enabled: boolean;\n    metricsEndpoint?: string;\n    healthCheckInterval: number;\n    alertThresholds: {\n      errorRate: number;\n      responseTime: number;\n    };\n  };\n}\n\n/**\n * 环境配置\n * Environment configuration\n */\nexport interface EnvironmentConfig {\n  environment: 'development' | 'staging' | 'production';\n  debug: boolean;\n  apiConfig: ApiConfig;\n  features: {\n    enableWebhooks: boolean;\n    enableAnalytics: boolean;\n    enableTemplates: boolean;\n    enableBatchRequests: boolean;\n  };\n}\n\n/**\n * Webhook配置\n * Webhook configuration\n */\nexport interface WebhookConfig {\n  url: string;\n  verifyToken: string;\n  secret?: string;\n  fields: string[];\n  enableSignatureVerification: boolean;\n  timeout: number;\n  retryPolicy: {\n    maxRetries: number;\n    backoffMultiplier: number;\n    initialDelay: number;\n    maxDelay: number;\n  };\n}\n\n/**\n * 客户端配置\n * Client configuration\n */\nexport interface ClientConfig {\n  api: ApiConfig;\n  webhook?: WebhookConfig;\n  defaultRequestOptions: {\n    timeout: number;\n    retries: number;\n    retryDelay: number;\n    headers: Record<string, string>;\n  };\n  interceptors: {\n    request?: Array<(config: Record<string, unknown>) => Record<string, unknown>>;\n    response?: Array<(response: Record<string, unknown>) => Record<string, unknown>>;\n    error?: Array<(error: unknown) => unknown>;\n  };\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/types/whatsapp-api-config/types.ts","messages":[{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 131.","line":99,"column":5,"nodeType":"Literal","messageId":"noMagic","endLine":99,"endColumn":8},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 132.","line":100,"column":5,"nodeType":"Literal","messageId":"noMagic","endLine":100,"endColumn":8},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 133.","line":101,"column":5,"nodeType":"Literal","messageId":"noMagic","endLine":101,"endColumn":8},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 136.","line":102,"column":5,"nodeType":"Literal","messageId":"noMagic","endLine":102,"endColumn":8},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 190.","line":103,"column":5,"nodeType":"Literal","messageId":"noMagic","endLine":103,"endColumn":8},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 368.","line":104,"column":5,"nodeType":"Literal","messageId":"noMagic","endLine":104,"endColumn":8},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 131000.","line":105,"column":5,"nodeType":"Literal","messageId":"noMagic","endLine":105,"endColumn":11},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 131005.","line":106,"column":5,"nodeType":"Literal","messageId":"noMagic","endLine":106,"endColumn":11},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 131008.","line":107,"column":5,"nodeType":"Literal","messageId":"noMagic","endLine":107,"endColumn":11},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 131009.","line":108,"column":5,"nodeType":"Literal","messageId":"noMagic","endLine":108,"endColumn":11},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 131014.","line":109,"column":5,"nodeType":"Literal","messageId":"noMagic","endLine":109,"endColumn":11},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 131016.","line":110,"column":5,"nodeType":"Literal","messageId":"noMagic","endLine":110,"endColumn":11},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 131021.","line":111,"column":5,"nodeType":"Literal","messageId":"noMagic","endLine":111,"endColumn":11},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 131026.","line":112,"column":5,"nodeType":"Literal","messageId":"noMagic","endLine":112,"endColumn":11},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 131047.","line":113,"column":5,"nodeType":"Literal","messageId":"noMagic","endLine":113,"endColumn":11},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 131051.","line":114,"column":5,"nodeType":"Literal","messageId":"noMagic","endLine":114,"endColumn":11},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 131052.","line":115,"column":5,"nodeType":"Literal","messageId":"noMagic","endLine":115,"endColumn":11},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 131053.","line":116,"column":5,"nodeType":"Literal","messageId":"noMagic","endLine":116,"endColumn":11}],"suppressedMessages":[],"errorCount":18,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * WhatsApp API 类型定义\n * WhatsApp API Type Definitions\n */\n\n/**\n * API端点类型\n * API endpoint types\n */\nexport type ApiEndpoint = \n  | 'messages'\n  | 'media'\n  | 'phone_numbers'\n  | 'business_profile'\n  | 'message_templates'\n  | 'analytics'\n  | 'batch'\n  | 'webhooks'\n  | 'account'\n  | 'apps';\n\n/**\n * HTTP方法类型\n * HTTP method types\n */\nexport type HttpMethod = 'GET' | 'POST' | 'PUT' | 'DELETE' | 'PATCH';\n\n/**\n * API版本类型\n * API version types\n */\nexport type ApiVersion = 'v17.0' | 'v18.0' | 'v19.0' | 'v20.0';\n\n/**\n * 消息类型\n * Message types\n */\nexport type MessageType = \n  | 'text'\n  | 'template'\n  | 'image'\n  | 'document'\n  | 'audio'\n  | 'video'\n  | 'location'\n  | 'contacts'\n  | 'interactive'\n  | 'reaction'\n  | 'sticker';\n\n/**\n * 媒体类型\n * Media types\n */\nexport type MediaType = 'image' | 'document' | 'audio' | 'video' | 'sticker';\n\n/**\n * 模板类别\n * Template categories\n */\nexport type TemplateCategory = 'AUTHENTICATION' | 'MARKETING' | 'UTILITY';\n\n/**\n * 模板状态\n * Template status\n */\nexport type TemplateStatusType = 'APPROVED' | 'PENDING' | 'REJECTED' | 'DISABLED' | 'PAUSED';\n\n/**\n * 质量评级\n * Quality rating\n */\nexport type QualityRating = 'GREEN' | 'YELLOW' | 'RED' | 'UNKNOWN';\n\n/**\n * 吞吐量级别\n * Throughput level\n */\nexport type ThroughputLevel = 'STANDARD' | 'HIGH';\n\n/**\n * 分析粒度\n * Analytics granularity\n */\nexport type AnalyticsGranularity = 'HALF_HOUR' | 'DAY' | 'MONTH';\n\n/**\n * 分析指标类型\n * Analytics metric types\n */\nexport type AnalyticsMetricType = 'cost' | 'conversation' | 'phone_number_quality_score';\n\n/**\n * 错误代码类型\n * Error code types\n */\nexport type ErrorCode = \n  | 100  // Generic user error\n  | 131  // Generic temporary error\n  | 132  // Generic limit reached\n  | 133  // Generic permission error\n  | 136  // Generic authentication error\n  | 190  // Access token error\n  | 368  // Temporarily blocked for policies violations\n  | 131000 // Generic temporary error\n  | 131005 // Request limit reached\n  | 131008 // Required parameter is missing\n  | 131009 // Parameter value is not valid\n  | 131014 // Request timeout\n  | 131016 // Service temporarily unavailable\n  | 131021 // Recipient phone number not valid\n  | 131026 // Message undeliverable\n  | 131047 // Re-engagement message\n  | 131051 // Unsupported message type\n  | 131052 // Media download error\n  | 131053 // Media upload error;\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/types/whatsapp-api-config/utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/types/whatsapp-api-errors.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'ErrorCode' is defined but never used. Allowed unused vars must match /^_/u.","line":8,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":24,"suggestions":[{"messageId":"removeVar","data":{"varName":"ErrorCode"},"fix":{"range":[110,165],"text":""},"desc":"Remove unused variable 'ErrorCode'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ErrorCode' is defined but never used. Allowed unused vars must match /^_/u.","line":8,"column":15,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":24},{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used. Allowed unused args must match /^_/u.","line":188,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":188,"endColumn":36,"suggestions":[{"messageId":"removeVar","data":{"varName":"error"},"fix":{"range":[3476,3495],"text":""},"desc":"Remove unused variable 'error'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used. Allowed unused args must match /^_/u.","line":189,"column":19,"nodeType":"Identifier","messageId":"unusedVar","endLine":189,"endColumn":38,"suggestions":[{"messageId":"removeVar","data":{"varName":"error"},"fix":{"range":[3527,3547],"text":""},"desc":"Remove unused variable 'error'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'attempt' is defined but never used. Allowed unused args must match /^_/u.","line":189,"column":40,"nodeType":"Identifier","messageId":"unusedVar","endLine":189,"endColumn":55,"suggestions":[{"messageId":"removeVar","data":{"varName":"attempt"},"fix":{"range":[3546,3563],"text":""},"desc":"Remove unused variable 'attempt'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used. Allowed unused args must match /^_/u.","line":191,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":191,"endColumn":33,"suggestions":[{"messageId":"removeVar","data":{"varName":"error"},"fix":{"range":[3611,3630],"text":""},"desc":"Remove unused variable 'error'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used. Allowed unused args must match /^_/u.","line":192,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":192,"endColumn":33,"suggestions":[{"messageId":"removeVar","data":{"varName":"error"},"fix":{"range":[3654,3674],"text":""},"desc":"Remove unused variable 'error'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'attempt' is defined but never used. Allowed unused args must match /^_/u.","line":192,"column":35,"nodeType":"Identifier","messageId":"unusedVar","endLine":192,"endColumn":50,"suggestions":[{"messageId":"removeVar","data":{"varName":"attempt"},"fix":{"range":[3673,3690],"text":""},"desc":"Remove unused variable 'attempt'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used. Allowed unused args must match /^_/u.","line":193,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":193,"endColumn":46,"suggestions":[{"messageId":"removeVar","data":{"varName":"error"},"fix":{"range":[3727,3746],"text":""},"desc":"Remove unused variable 'error'."}]},{"ruleId":"prefer-destructuring","severity":2,"message":"Use object destructuring.","line":405,"column":7,"nodeType":"AssignmentExpression","messageId":"preferDestructuring","endLine":405,"endColumn":36},{"ruleId":"max-statements","severity":2,"message":"Method 'generateSuggestions' has too many statements (25). Maximum allowed is 20.","line":425,"column":22,"nodeType":"FunctionExpression","messageId":"exceed","endLine":464,"endColumn":4},{"ruleId":"max-params","severity":2,"message":"Method 'calculateRetryDelay' has too many parameters (4). Maximum allowed is 3.","line":470,"column":3,"nodeType":"FunctionExpression","messageId":"exceed","endLine":470,"endColumn":22},{"ruleId":"prefer-exponentiation-operator","severity":2,"message":"Use the '**' operator instead of 'Math.pow'.","line":476,"column":31,"nodeType":"CallExpression","messageId":"useExponentiation","endLine":476,"endColumn":64,"fix":{"range":[10989,11022],"text":"multiplier**(attempt - 1)"}},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 36.","line":490,"column":57,"nodeType":"Literal","messageId":"noMagic","endLine":490,"endColumn":59},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2.","line":490,"column":68,"nodeType":"Literal","messageId":"noMagic","endLine":490,"endColumn":69},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 9.","line":490,"column":71,"nodeType":"Literal","messageId":"noMagic","endLine":490,"endColumn":72}],"suppressedMessages":[],"errorCount":16,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"/**\n * WhatsApp API 错误处理类型定义\n * WhatsApp API Error Handling Type Definitions\n *\n * 提供API错误处理相关的类型定义和工具函数\n */\n\nimport type { ErrorCode } from './whatsapp-api-config';\n\n/**\n * 基础API错误响应\n * Base API error response\n */\nexport interface WhatsAppApiErrorResponse {\n  code: number;\n  title: string;\n  message: string;\n  error_data?: {\n    details: string;\n    messaging_product?: string;\n    fbtrace_id?: string;\n  };\n  href?: string;\n}\n\n/**\n * 完整API错误\n * Complete API error\n */\nexport interface WhatsAppApiError {\n  error: {\n    message: string;\n    type: string;\n    code: number;\n    error_subcode?: number;\n    fbtrace_id: string;\n    error_user_title?: string;\n    error_user_msg?: string;\n    is_transient?: boolean;\n  };\n}\n\n/**\n * 网络错误\n * Network error\n */\nexport interface NetworkError {\n  name: 'NetworkError';\n  message: string;\n  code: 'NETWORK_ERROR' | 'TIMEOUT' | 'CONNECTION_REFUSED' | 'DNS_ERROR';\n  originalError?: Error;\n  retryable: boolean;\n}\n\n/**\n * 验证错误\n * Validation error\n */\nexport interface ValidationError {\n  name: 'ValidationError';\n  message: string;\n  code: 'INVALID_PARAMETER' | 'MISSING_PARAMETER' | 'INVALID_FORMAT';\n  field?: string;\n  value?: string | number | boolean | Record<string, unknown> | unknown[];\n  retryable: false;\n}\n\n/**\n * 认证错误\n * Authentication error\n */\nexport interface AuthenticationError {\n  name: 'AuthenticationError';\n  message: string;\n  code: 'INVALID_TOKEN' | 'EXPIRED_TOKEN' | 'INSUFFICIENT_PERMISSIONS';\n  retryable: false;\n}\n\n/**\n * 速率限制错误\n * Rate limit error\n */\nexport interface RateLimitError {\n  name: 'RateLimitError';\n  message: string;\n  code: 'RATE_LIMIT_EXCEEDED';\n  retryAfter?: number;\n  limit?: number;\n  remaining?: number;\n  resetTime?: number;\n  retryable: true;\n}\n\n/**\n * 业务逻辑错误\n * Business logic error\n */\nexport interface BusinessLogicError {\n  name: 'BusinessLogicError';\n  message: string;\n  code: 'INVALID_PHONE_NUMBER' | 'MESSAGE_UNDELIVERABLE' | 'TEMPLATE_NOT_APPROVED' | 'MEDIA_TOO_LARGE';\n  details?: Record<string, string | number | boolean | Record<string, unknown> | unknown[]>;\n  retryable: boolean;\n}\n\n/**\n * 服务器错误\n * Server error\n */\nexport interface ServerError {\n  name: 'ServerError';\n  message: string;\n  code: 'INTERNAL_SERVER_ERROR' | 'SERVICE_UNAVAILABLE' | 'BAD_GATEWAY';\n  statusCode: number;\n  retryable: boolean;\n}\n\n/**\n * 错误联合类型\n * Error union type\n */\nexport type WhatsAppError =\n  | WhatsAppApiError\n  | NetworkError\n  | ValidationError\n  | AuthenticationError\n  | RateLimitError\n  | BusinessLogicError\n  | ServerError;\n\n/**\n * 错误严重程度\n * Error severity\n */\nexport type ErrorSeverity = 'low' | 'medium' | 'high' | 'critical';\n\n/**\n * 错误分类\n * Error category\n */\nexport type ErrorCategory =\n  | 'network'\n  | 'authentication'\n  | 'validation'\n  | 'rate_limit'\n  | 'business_logic'\n  | 'server'\n  | 'unknown';\n\n/**\n * 错误上下文\n * Error context\n */\nexport interface ErrorContext {\n  requestId?: string;\n  timestamp: string;\n  endpoint: string;\n  method: string;\n  phoneNumberId?: string;\n  userId?: string;\n  messageId?: string;\n  retryCount?: number;\n  userAgent?: string;\n  ipAddress?: string;\n}\n\n/**\n * 错误详情\n * Error details\n */\nexport interface ErrorDetails {\n  error: WhatsAppError;\n  context: ErrorContext;\n  severity: ErrorSeverity;\n  category: ErrorCategory;\n  retryable: boolean;\n  retryAfter?: number;\n  suggestions?: string[];\n}\n\n/**\n * 错误处理策略\n * Error handling strategy\n */\nexport interface ErrorHandlingStrategy {\n  name: string;\n  description: string;\n  shouldRetry: (error: ErrorDetails) => boolean;\n  getRetryDelay: (error: ErrorDetails, attempt: number) => number;\n  maxRetries: number;\n  onError?: (error: ErrorDetails) => void;\n  onRetry?: (error: ErrorDetails, attempt: number) => void;\n  onMaxRetriesExceeded?: (error: ErrorDetails) => void;\n}\n\n/**\n * 错误统计\n * Error statistics\n */\nexport interface ErrorStatistics {\n  total: number;\n  byCategory: Record<ErrorCategory, number>;\n  bySeverity: Record<ErrorSeverity, number>;\n  byCode: Record<string, number>;\n  retryableCount: number;\n  nonRetryableCount: number;\n  averageRetryCount: number;\n  lastOccurrence?: string;\n}\n\n/**\n * 错误报告\n * Error report\n */\nexport interface ErrorReport {\n  id: string;\n  timestamp: string;\n  error: ErrorDetails;\n  stackTrace?: string;\n  userAgent?: string;\n  environment: string;\n  version: string;\n  additionalData?: Record<string, string | number | boolean | Record<string, unknown> | unknown[]>;\n}\n\n/**\n * 错误处理配置\n * Error handling configuration\n */\nexport interface ErrorHandlingConfig {\n  enableRetry: boolean;\n  maxRetries: number;\n  retryDelay: number;\n  retryMultiplier: number;\n  maxRetryDelay: number;\n  enableLogging: boolean;\n  enableReporting: boolean;\n  reportingEndpoint?: string;\n  customStrategies?: Record<string, ErrorHandlingStrategy>;\n}\n\n/**\n * 错误类型守卫函数\n * Error type guard functions\n */\nexport function isWhatsAppApiError(error: unknown): error is WhatsAppApiError {\n  return (\n    error &&\n    typeof error === 'object' &&\n    typeof (error as Record<string, unknown>).error === 'object' &&\n    'message' in ((error as Record<string, unknown>).error as Record<string, unknown>) &&\n    'type' in ((error as Record<string, unknown>).error as Record<string, unknown>) &&\n    'code' in ((error as Record<string, unknown>).error as Record<string, unknown>)\n  );\n}\n\nexport function isNetworkError(error: unknown): error is NetworkError {\n  return (\n    error &&\n    typeof error === 'object' &&\n    (error as Record<string, unknown>).name === 'NetworkError'\n  );\n}\n\nexport function isValidationError(error: unknown): error is ValidationError {\n  return (\n    error &&\n    typeof error === 'object' &&\n    (error as Record<string, unknown>).name === 'ValidationError'\n  );\n}\n\nexport function isAuthenticationError(error: unknown): error is AuthenticationError {\n  return (\n    error &&\n    typeof error === 'object' &&\n    (error as Record<string, unknown>).name === 'AuthenticationError'\n  );\n}\n\nexport function isRateLimitError(error: unknown): error is RateLimitError {\n  return (\n    error &&\n    typeof error === 'object' &&\n    (error as Record<string, unknown>).name === 'RateLimitError'\n  );\n}\n\nexport function isBusinessLogicError(error: unknown): error is BusinessLogicError {\n  return (\n    error &&\n    typeof error === 'object' &&\n    (error as Record<string, unknown>).name === 'BusinessLogicError'\n  );\n}\n\nexport function isServerError(error: unknown): error is ServerError {\n  return (\n    error &&\n    typeof error === 'object' &&\n    error.name === 'ServerError'\n  );\n}\n\n/**\n * 错误工具函数\n * Error utility functions\n */\nexport const ErrorUtils = {\n  /**\n   * 分类错误\n   * Categorize error\n   */\n  categorizeError(error: WhatsAppError): ErrorCategory {\n    if (isNetworkError(error)) return 'network';\n    if (isAuthenticationError(error)) return 'authentication';\n    if (isValidationError(error)) return 'validation';\n    if (isRateLimitError(error)) return 'rate_limit';\n    if (isBusinessLogicError(error)) return 'business_logic';\n    if (isServerError(error)) return 'server';\n    return 'unknown';\n  },\n\n  /**\n   * 评估错误严重程度\n   * Assess error severity\n   */\n  assessSeverity(error: WhatsAppError): ErrorSeverity {\n    if (isAuthenticationError(error)) return 'critical';\n    if (isServerError(error) && error.statusCode >= 500) return 'high';\n    if (isRateLimitError(error)) return 'medium';\n    if (isValidationError(error)) return 'low';\n    if (isBusinessLogicError(error)) {\n      if (error.code === 'INVALID_PHONE_NUMBER') return 'medium';\n      if (error.code === 'MESSAGE_UNDELIVERABLE') return 'high';\n      return 'low';\n    }\n    return 'medium';\n  },\n\n  /**\n   * 检查错误是否可重试\n   * Check if error is retryable\n   */\n  isRetryable(error: WhatsAppError): boolean {\n    if (isNetworkError(error)) return error.retryable;\n    if (isAuthenticationError(error)) return false;\n    if (isValidationError(error)) return false;\n    if (isRateLimitError(error)) return true;\n    if (isBusinessLogicError(error)) return error.retryable;\n    if (isServerError(error)) return error.retryable;\n    if (isWhatsAppApiError(error)) {\n      return error.error.is_transient || false;\n    }\n    return false;\n  },\n\n  /**\n   * 格式化错误消息\n   * Format error message\n   */\n  formatErrorMessage(error: WhatsAppError): string {\n    if (isWhatsAppApiError(error)) {\n      const { message, type, code } = error.error;\n      return `[${type}:${code}] ${message}`;\n    }\n\n    if ('message' in error) {\n      return `[${error.name}] ${error.message}`;\n    }\n\n    return 'Unknown error occurred';\n  },\n\n  /**\n   * 提取错误代码\n   * Extract error code\n   */\n  extractErrorCode(error: WhatsAppError): string | number {\n    if (isWhatsAppApiError(error)) {\n      return error.error.code;\n    }\n\n    if ('code' in error) {\n      return error.code;\n    }\n\n    return 'UNKNOWN';\n  },\n\n  /**\n   * 创建错误详情\n   * Create error details\n   */\n  createErrorDetails(\n    error: WhatsAppError,\n    context: ErrorContext\n  ): ErrorDetails {\n    const category = ErrorUtils.categorizeError(error);\n    const severity = ErrorUtils.assessSeverity(error);\n    const retryable = ErrorUtils.isRetryable(error);\n\n    let retryAfter: number | undefined;\n    if (isRateLimitError(error)) {\n      retryAfter = error.retryAfter;\n    }\n\n    const suggestions = ErrorUtils.generateSuggestions(error);\n\n    return {\n      error,\n      context,\n      severity,\n      category,\n      retryable,\n      retryAfter,\n      suggestions,\n    };\n  },\n\n  /**\n   * 生成错误建议\n   * Generate error suggestions\n   */\n  generateSuggestions(error: WhatsAppError): string[] {\n    const suggestions: string[] = [];\n\n    if (isAuthenticationError(error)) {\n      suggestions.push('Check your access token');\n      suggestions.push('Verify token permissions');\n      suggestions.push('Ensure token has not expired');\n    }\n\n    if (isValidationError(error)) {\n      suggestions.push('Check request parameters');\n      suggestions.push('Validate input format');\n      suggestions.push('Review API documentation');\n    }\n\n    if (isRateLimitError(error)) {\n      suggestions.push('Implement exponential backoff');\n      suggestions.push('Reduce request frequency');\n      suggestions.push('Consider upgrading your plan');\n    }\n\n    if (isNetworkError(error)) {\n      suggestions.push('Check network connectivity');\n      suggestions.push('Verify API endpoint URL');\n      suggestions.push('Try again later');\n    }\n\n    if (isBusinessLogicError(error)) {\n      if (error.code === 'INVALID_PHONE_NUMBER') {\n        suggestions.push('Verify phone number format');\n        suggestions.push('Include country code');\n      }\n      if (error.code === 'MESSAGE_UNDELIVERABLE') {\n        suggestions.push('Check recipient status');\n        suggestions.push('Verify phone number is active');\n      }\n    }\n\n    return suggestions;\n  },\n\n  /**\n   * 计算重试延迟\n   * Calculate retry delay\n   */\n  calculateRetryDelay(\n    attempt: number,\n    baseDelay: number = 1000,\n    multiplier: number = 2,\n    maxDelay: number = 30000\n  ): number {\n    const delay = baseDelay * Math.pow(multiplier, attempt - 1);\n    return Math.min(delay, maxDelay);\n  },\n\n  /**\n   * 创建错误报告\n   * Create error report\n   */\n  createErrorReport(\n    errorDetails: ErrorDetails,\n    environment: string = 'production',\n    version: string = '1.0.0'\n  ): ErrorReport {\n    return {\n      id: `error_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n      timestamp: new Date().toISOString(),\n      error: errorDetails,\n      environment,\n      version,\n    };\n  },\n};\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/types/whatsapp-api-requests.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/types/whatsapp-api-requests/account-app-requests.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/types/whatsapp-api-requests/api-types.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'status' is defined but never used. Allowed unused args must match /^_/u.","line":26,"column":21,"nodeType":"Identifier","messageId":"unusedVar","endLine":26,"endColumn":35,"suggestions":[{"messageId":"removeVar","data":{"varName":"status"},"fix":{"range":[1110,1124],"text":""},"desc":"Remove unused variable 'status'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * WhatsApp API 通用请求类型\n * WhatsApp API Generic Request Types\n */\n\n// 导入所有请求类型\nimport type { SendMessageRequest } from './message-requests';\nimport type { MediaUploadRequest, AnalyticsRequest } from './media-analytics-requests';\nimport type { BatchRequest, BusinessProfileUpdateRequest } from './batch-business-requests';\nimport type { TemplateCreateRequest, TemplateDeleteRequest, TemplateStatusUpdateRequest } from './template-requests';\nimport type { PhoneNumberRegistrationRequest, PhoneNumberVerificationRequest, WebhookSubscriptionRequest, MessageMarkRequest } from './phone-webhook-requests';\nimport type { UserBlockRequest, QualityRatingRequest } from './user-quality-requests';\nimport type { AccountInfoRequest, AppSettingsRequest } from './account-app-requests';\nimport type { MessageReactionRequest, MessageForwardRequest, GroupMessageRequest } from './message-actions-requests';\n\n/**\n * 请求选项\n * Request options\n */\nexport interface ApiRequestOptions {\n  timeout?: number;\n  retries?: number;\n  retryDelay?: number;\n  headers?: Record<string, string>;\n  signal?: AbortSignal;\n  validateStatus?: (status: number) => boolean;\n}\n\n/**\n * 通用API请求包装器\n * Generic API request wrapper\n */\nexport interface ApiRequest<T = unknown> {\n  method: 'GET' | 'POST' | 'PUT' | 'DELETE';\n  endpoint: string;\n  data?: T;\n  params?: Record<string, string | number | boolean>;\n  options?: ApiRequestOptions;\n}\n\n/**\n * 请求类型联合\n * Request type union\n */\nexport type WhatsAppApiRequest =\n  | SendMessageRequest\n  | MediaUploadRequest\n  | AnalyticsRequest\n  | BatchRequest\n  | BusinessProfileUpdateRequest\n  | TemplateCreateRequest\n  | TemplateDeleteRequest\n  | PhoneNumberRegistrationRequest\n  | PhoneNumberVerificationRequest\n  | WebhookSubscriptionRequest\n  | MessageMarkRequest\n  | UserBlockRequest\n  | QualityRatingRequest\n  | TemplateStatusUpdateRequest\n  | AccountInfoRequest\n  | AppSettingsRequest\n  | MessageReactionRequest\n  | MessageForwardRequest\n  | GroupMessageRequest;\n\n/**\n * 请求验证函数\n * Request validation functions\n */\nexport function isSendMessageRequest(request: unknown): request is SendMessageRequest {\n  return (\n    request &&\n    typeof request === 'object' &&\n    (request as Record<string, unknown>).messaging_product === 'whatsapp' &&\n    (request as Record<string, unknown>).recipient_type === 'individual' &&\n    typeof (request as Record<string, unknown>).to === 'string' &&\n    typeof (request as Record<string, unknown>).type === 'string'\n  );\n}\n\nexport function isMediaUploadRequest(request: unknown): request is MediaUploadRequest {\n  return (\n    request &&\n    typeof request === 'object' &&\n    (request as Record<string, unknown>).messaging_product === 'whatsapp' &&\n    (request as Record<string, unknown>).file &&\n    typeof (request as Record<string, unknown>).type === 'string'\n  );\n}\n\nexport function isAnalyticsRequest(request: unknown): request is AnalyticsRequest {\n  return (\n    request &&\n    typeof request === 'object' &&\n    typeof (request as Record<string, unknown>).start === 'string' &&\n    typeof (request as Record<string, unknown>).end === 'string' &&\n    typeof (request as Record<string, unknown>).granularity === 'string'\n  );\n}\n\nexport function isBatchRequest(request: unknown): request is BatchRequest {\n  return (\n    request &&\n    typeof request === 'object' &&\n    Array.isArray(request.requests)\n  );\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/types/whatsapp-api-requests/batch-business-requests.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/types/whatsapp-api-requests/media-analytics-requests.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/types/whatsapp-api-requests/message-actions-requests.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/types/whatsapp-api-requests/message-requests.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'WhatsAppContact' is defined but never used. Allowed unused vars must match /^_/u.","line":7,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":30,"suggestions":[{"messageId":"removeVar","data":{"varName":"WhatsAppContact"},"fix":{"range":[153,169],"text":""},"desc":"Remove unused variable 'WhatsAppContact'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'WhatsAppContact' is defined but never used. Allowed unused vars must match /^_/u.","line":7,"column":15,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":30}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * WhatsApp API 消息相关请求类型\n * WhatsApp API Message Request Types\n */\n\nimport type { TemplateMessage } from '../whatsapp-template-types';\nimport type { WhatsAppContact, LocationData, ContactData } from '../whatsapp-base-types';\n\n/**\n * 发送消息请求\n * Send message request\n */\nexport interface SendMessageRequest {\n  messaging_product: 'whatsapp';\n  recipient_type: 'individual';\n  to: string;\n  type: 'text' | 'template' | 'image' | 'document' | 'audio' | 'video' | 'location' | 'contacts' | 'interactive';\n  text?: {\n    preview_url?: boolean;\n    body: string;\n  };\n  template?: TemplateMessage;\n  image?: {\n    id?: string;\n    link?: string;\n    caption?: string;\n  };\n  document?: {\n    id?: string;\n    link?: string;\n    caption?: string;\n    filename?: string;\n  };\n  audio?: {\n    id?: string;\n    link?: string;\n  };\n  video?: {\n    id?: string;\n    link?: string;\n    caption?: string;\n  };\n  location?: LocationData;\n  contacts?: ContactData[];\n  interactive?: {\n    type: 'button' | 'list';\n    header?: {\n      type: 'text' | 'image' | 'document' | 'video';\n      text?: string;\n      image?: {\n        id?: string;\n        link?: string;\n      };\n      document?: {\n        id?: string;\n        link?: string;\n        filename?: string;\n      };\n      video?: {\n        id?: string;\n        link?: string;\n      };\n    };\n    body?: {\n      text: string;\n    };\n    footer?: {\n      text: string;\n    };\n    action: {\n      buttons?: Array<{\n        type: 'reply';\n        reply: {\n          id: string;\n          title: string;\n        };\n      }>;\n      button?: string;\n      sections?: Array<{\n        title?: string;\n        rows: Array<{\n          id: string;\n          title: string;\n          description?: string;\n        }>;\n      }>;\n    };\n  };\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/types/whatsapp-api-requests/phone-webhook-requests.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/types/whatsapp-api-requests/request-builders.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/types/whatsapp-api-requests/template-requests.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/types/whatsapp-api-requests/user-quality-requests.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/types/whatsapp-api-responses.ts","messages":[{"ruleId":"@typescript-eslint/no-empty-object-type","severity":2,"message":"An interface declaring no members is equivalent to its supertype.","line":27,"column":18,"nodeType":"Identifier","messageId":"noEmptyInterfaceWithSuper","endLine":27,"endColumn":37,"suggestions":[{"messageId":"replaceEmptyInterfaceWithSuper","fix":{"range":[465,525],"text":"type WhatsAppApiResponse = SendMessageResponse"},"desc":"Replace empty interface with a type alias."}]},{"ruleId":"no-implicit-coercion","severity":2,"message":"Unexpected implicit coercion encountered. Use `Boolean(response.data)` instead.","line":417,"column":30,"nodeType":"UnaryExpression","messageId":"implicitCoercion","endLine":417,"endColumn":45,"fix":{"range":[7921,7936],"text":"Boolean(response.data)"}},{"ruleId":"no-implicit-coercion","severity":2,"message":"Unexpected implicit coercion encountered. Use `Boolean(response.error)` instead.","line":421,"column":31,"nodeType":"UnaryExpression","messageId":"implicitCoercion","endLine":421,"endColumn":47,"fix":{"range":[8108,8124],"text":"Boolean(response.error)"}},{"ruleId":"no-implicit-coercion","severity":2,"message":"Unexpected implicit coercion encountered. Use `Boolean(response.paging?.next || response.paging?.cursors?.after)` instead.","line":475,"column":12,"nodeType":"UnaryExpression","messageId":"implicitCoercion","endLine":475,"endColumn":72,"fix":{"range":[9260,9320],"text":"Boolean(response.paging?.next || response.paging?.cursors?.after)"}},{"ruleId":"no-implicit-coercion","severity":2,"message":"Unexpected implicit coercion encountered. Use `Boolean(response.paging?.previous || response.paging?.cursors?.before)` instead.","line":483,"column":12,"nodeType":"UnaryExpression","messageId":"implicitCoercion","endLine":483,"endColumn":77,"fix":{"range":[9461,9526],"text":"Boolean(response.paging?.previous || response.paging?.cursors?.before)"}}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":4,"fixableWarningCount":0,"source":"/**\n * WhatsApp API 响应类型定义\n * WhatsApp API Response Type Definitions\n *\n * 提供WhatsApp Business API响应相关的类型定义\n */\n\n/**\n * 发送消息响应\n * Send message response\n */\nexport interface SendMessageResponse {\n  messaging_product: 'whatsapp';\n  contacts: Array<{\n    input: string;\n    wa_id: string;\n  }>;\n  messages: Array<{\n    id: string;\n  }>;\n}\n\n/**\n * WhatsApp API 原始响应类型（与 SendMessageResponse 相同）\n * WhatsApp API raw response type (same as SendMessageResponse)\n */\nexport interface WhatsAppApiResponse extends SendMessageResponse {}\n\n/**\n * 服务层响应包装类型\n * Service layer response wrapper type\n */\nexport interface WhatsAppServiceResponse {\n  success: boolean;\n  data?: WhatsAppApiResponse;\n  error?: string;\n  timestamp?: string;\n  requestId?: string;\n}\n\n/**\n * 媒体上传响应\n * Media upload response\n */\nexport interface MediaUploadResponse {\n  id: string;\n}\n\n/**\n * 媒体检索响应\n * Media retrieve response\n */\nexport interface MediaRetrieveResponse {\n  url: string;\n  mime_type: string;\n  sha256: string;\n  file_size: number;\n  id: string;\n}\n\n/**\n * 电话号码信息\n * Phone number information\n */\nexport interface PhoneNumberInfo {\n  verified_name: string;\n  display_phone_number: string;\n  id: string;\n  quality_rating: 'GREEN' | 'YELLOW' | 'RED' | 'UNKNOWN';\n  throughput: {\n    level: 'STANDARD' | 'HIGH';\n  };\n  webhook_configuration?: {\n    webhook_url: string;\n    webhook_fields: string[];\n  };\n}\n\n/**\n * 电话号码列表响应\n * Phone numbers list response\n */\nexport interface PhoneNumbersResponse {\n  data: PhoneNumberInfo[];\n  paging?: {\n    cursors?: {\n      before?: string;\n      after?: string;\n    };\n    next?: string;\n    previous?: string;\n  };\n}\n\n/**\n * 业务档案\n * Business profile\n */\nexport interface BusinessProfile {\n  about?: string;\n  address?: string;\n  description?: string;\n  email?: string;\n  profile_picture_url?: string;\n  websites?: string[];\n  vertical?: string;\n  messaging_product: 'whatsapp';\n}\n\n/**\n * 业务档案响应\n * Business profile response\n */\nexport interface BusinessProfileResponse {\n  data: BusinessProfile[];\n}\n\n/**\n * 模板状态\n * Template status\n */\nexport interface TemplateStatus {\n  name: string;\n  status: 'APPROVED' | 'PENDING' | 'REJECTED' | 'DISABLED' | 'PAUSED';\n  category: 'AUTHENTICATION' | 'MARKETING' | 'UTILITY';\n  language: string;\n  id: string;\n  components?: Array<{\n    type: 'HEADER' | 'BODY' | 'FOOTER' | 'BUTTONS';\n    format?: 'TEXT' | 'IMAGE' | 'DOCUMENT' | 'VIDEO';\n    text?: string;\n    buttons?: Array<{\n      type: 'QUICK_REPLY' | 'URL' | 'PHONE_NUMBER';\n      text: string;\n      url?: string;\n      phone_number?: string;\n    }>;\n  }>;\n  created_time?: string;\n  modified_time?: string;\n}\n\n/**\n * 模板列表响应\n * Templates list response\n */\nexport interface TemplatesResponse {\n  data: TemplateStatus[];\n  paging?: {\n    cursors?: {\n      before?: string;\n      after?: string;\n    };\n    next?: string;\n    previous?: string;\n  };\n}\n\n/**\n * 分析数据点\n * Analytics data point\n */\nexport interface AnalyticsDataPoint {\n  start: string;\n  end: string;\n  sent: number;\n  delivered: number;\n  read: number;\n  cost?: number;\n  conversation_analytics?: {\n    conversation_opened: number;\n    conversation_closed: number;\n    conversation_expired: number;\n  };\n}\n\n/**\n * 分析响应\n * Analytics response\n */\nexport interface AnalyticsResponse {\n  data: Array<{\n    name: string;\n    period: string;\n    data_points: AnalyticsDataPoint[];\n  }>;\n  paging?: {\n    cursors?: {\n      before?: string;\n      after?: string;\n    };\n    next?: string;\n    previous?: string;\n  };\n}\n\n/**\n * 批量响应\n * Batch response\n */\nexport interface BatchResponse {\n  responses: Array<{\n    code: number;\n    headers: Array<{\n      name: string;\n      value: string;\n    }>;\n    body: string;\n  }>;\n}\n\n/**\n * 速率限制信息\n * Rate limit information\n */\nexport interface RateLimitInfo {\n  app_id: string;\n  application_quota_usage: number;\n  business_quota_usage: number;\n  call_count: number;\n  total_cputime: number;\n  total_time: number;\n  type: 'application' | 'business';\n}\n\n/**\n * 账户信息响应\n * Account info response\n */\nexport interface AccountInfoResponse {\n  id: string;\n  name: string;\n  timezone_offset_minutes: number;\n  message_template_namespace: string;\n  account_review_status: 'APPROVED' | 'PENDING' | 'REJECTED';\n  business_verification_status: 'VERIFIED' | 'UNVERIFIED' | 'PENDING';\n  country: string;\n  currency: string;\n  primary_business_location: string;\n}\n\n/**\n * 应用设置响应\n * App settings response\n */\nexport interface AppSettingsResponse {\n  data: {\n    application: {\n      name: string;\n      description?: string;\n      category?: string;\n    };\n    webhooks: {\n      callback_url: string;\n      fields: string[];\n      verify_token: string;\n    };\n  };\n}\n\n/**\n * 质量评级响应\n * Quality rating response\n */\nexport interface QualityRatingResponse {\n  quality_score: number;\n  quality_rating: 'GREEN' | 'YELLOW' | 'RED' | 'UNKNOWN';\n  previous_quality_rating?: 'GREEN' | 'YELLOW' | 'RED' | 'UNKNOWN';\n  event?: 'FLAGGED' | 'QUALITY_SCORE_CHANGED';\n}\n\n/**\n * 消息状态响应\n * Message status response\n */\nexport interface MessageStatusResponse {\n  success: boolean;\n}\n\n/**\n * 用户阻止状态响应\n * User block status response\n */\nexport interface UserBlockStatusResponse {\n  success: boolean;\n  action: 'block' | 'unblock';\n}\n\n/**\n * Webhook验证响应\n * Webhook verification response\n */\nexport interface WebhookVerificationResponse {\n  challenge: string;\n}\n\n/**\n * 分页信息\n * Pagination information\n */\nexport interface PaginationCursors {\n  before?: string;\n  after?: string;\n}\n\nexport interface PaginationInfo {\n  cursors?: PaginationCursors;\n  next?: string;\n  previous?: string;\n}\n\n/**\n * 分页响应包装器\n * Paginated response wrapper\n */\nexport interface PaginatedResponse<T> {\n  data: T[];\n  paging?: PaginationInfo;\n}\n\n/**\n * 通用API响应包装器\n * Generic API response wrapper\n */\nexport interface ApiResponse<T = unknown> {\n  success: boolean;\n  data?: T;\n  error?: WhatsAppApiError;\n  rateLimitInfo?: RateLimitInfo;\n  requestId?: string;\n  timestamp?: string;\n  version?: string;\n}\n\n/**\n * 错误响应类型\n * Error response types\n */\nexport interface WhatsAppApiErrorResponse {\n  code: number;\n  title: string;\n  message: string;\n  error_data?: {\n    details: string;\n    messaging_product?: string;\n    fbtrace_id?: string;\n  };\n  href?: string;\n}\n\nexport interface WhatsAppApiError {\n  error: {\n    message: string;\n    type: string;\n    code: number;\n    error_subcode?: number;\n    fbtrace_id: string;\n    error_user_title?: string;\n    error_user_msg?: string;\n  };\n}\n\n/**\n * 响应类型联合\n * Response type union\n */\nexport type WhatsAppApiResponseType =\n  | SendMessageResponse\n  | MediaUploadResponse\n  | MediaRetrieveResponse\n  | PhoneNumbersResponse\n  | BusinessProfileResponse\n  | TemplatesResponse\n  | AnalyticsResponse\n  | BatchResponse\n  | AccountInfoResponse\n  | AppSettingsResponse\n  | QualityRatingResponse\n  | MessageStatusResponse\n  | UserBlockStatusResponse\n  | WebhookVerificationResponse;\n\n/**\n * 响应验证函数\n * Response validation functions\n */\nexport function isSendMessageResponse(response: unknown): response is SendMessageResponse {\n  return (\n    response &&\n    typeof response === 'object' &&\n    (response as Record<string, unknown>).messaging_product === 'whatsapp' &&\n    Array.isArray((response as Record<string, unknown>).contacts) &&\n    Array.isArray((response as Record<string, unknown>).messages)\n  );\n}\n\nexport function isMediaUploadResponse(response: unknown): response is MediaUploadResponse {\n  return (\n    response &&\n    typeof response === 'object' &&\n    typeof (response as Record<string, unknown>).id === 'string'\n  );\n}\n\nexport function isWhatsAppApiError(error: unknown): error is WhatsAppApiError {\n  return (\n    error &&\n    typeof error === 'object' &&\n    typeof error.error === 'object' &&\n    'message' in error.error &&\n    'type' in error.error &&\n    'code' in error.error\n  );\n}\n\nexport function isSuccessResponse<T>(response: ApiResponse<T>): response is ApiResponse<T> & { success: true; data: T } {\n  return response.success && !!response.data;\n}\n\nexport function isErrorResponse<T>(response: ApiResponse<T>): response is ApiResponse<T> & { success: false; error: WhatsAppApiError } {\n  return !response.success && !!response.error;\n}\n\n/**\n * 响应处理工具函数\n * Response handling utility functions\n */\nexport const ResponseUtils = {\n  /**\n   * 提取消息ID\n   * Extract message ID\n   */\n  extractMessageId(response: SendMessageResponse): string | null {\n    return response.messages?.[0]?.id || null;\n  },\n\n  /**\n   * 提取联系人信息\n   * Extract contact info\n   */\n  extractContactInfo(response: SendMessageResponse): { input: string; wa_id: string } | null {\n    return response.contacts?.[0] || null;\n  },\n\n  /**\n   * 检查是否为成功响应\n   * Check if response is successful\n   */\n  isSuccess(response: WhatsAppServiceResponse): boolean {\n    return response.success && !response.error;\n  },\n\n  /**\n   * 格式化错误信息\n   * Format error message\n   */\n  formatError(error: WhatsAppApiError): string {\n    const { message, type, code } = error.error;\n    return `[${type}:${code}] ${message}`;\n  },\n\n  /**\n   * 提取分页信息\n   * Extract pagination info\n   */\n  extractPaginationInfo<T>(response: PaginatedResponse<T>): PaginationInfo | null {\n    return response.paging || null;\n  },\n\n  /**\n   * 检查是否有下一页\n   * Check if has next page\n   */\n  hasNextPage<T>(response: PaginatedResponse<T>): boolean {\n    return !!(response.paging?.next || response.paging?.cursors?.after);\n  },\n\n  /**\n   * 检查是否有上一页\n   * Check if has previous page\n   */\n  hasPreviousPage<T>(response: PaginatedResponse<T>): boolean {\n    return !!(response.paging?.previous || response.paging?.cursors?.before);\n  },\n};\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/types/whatsapp-api-types.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'TemplateMessage' is defined but never used. Allowed unused vars must match /^_/u.","line":15,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":30,"suggestions":[{"messageId":"removeVar","data":{"varName":"TemplateMessage"},"fix":{"range":[327,392],"text":""},"desc":"Remove unused variable 'TemplateMessage'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'TemplateMessage' is defined but never used. Allowed unused vars must match /^_/u.","line":15,"column":15,"nodeType":null,"messageId":"unusedVar","endLine":15,"endColumn":30},{"ruleId":"no-unused-vars","severity":2,"message":"'WhatsAppContact' is defined but never used. Allowed unused vars must match /^_/u.","line":16,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":30,"suggestions":[{"messageId":"removeVar","data":{"varName":"WhatsAppContact"},"fix":{"range":[407,423],"text":""},"desc":"Remove unused variable 'WhatsAppContact'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'WhatsAppContact' is defined but never used. Allowed unused vars must match /^_/u.","line":16,"column":15,"nodeType":null,"messageId":"unusedVar","endLine":16,"endColumn":30},{"ruleId":"no-unused-vars","severity":2,"message":"'LocationData' is defined but never used. Allowed unused vars must match /^_/u.","line":16,"column":32,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":44,"suggestions":[{"messageId":"removeVar","data":{"varName":"LocationData"},"fix":{"range":[422,436],"text":""},"desc":"Remove unused variable 'LocationData'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'LocationData' is defined but never used. Allowed unused vars must match /^_/u.","line":16,"column":32,"nodeType":null,"messageId":"unusedVar","endLine":16,"endColumn":44},{"ruleId":"no-unused-vars","severity":2,"message":"'ContactData' is defined but never used. Allowed unused vars must match /^_/u.","line":16,"column":46,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":57,"suggestions":[{"messageId":"removeVar","data":{"varName":"ContactData"},"fix":{"range":[436,449],"text":""},"desc":"Remove unused variable 'ContactData'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ContactData' is defined but never used. Allowed unused vars must match /^_/u.","line":16,"column":46,"nodeType":null,"messageId":"unusedVar","endLine":16,"endColumn":57},{"ruleId":"no-unused-vars","severity":2,"message":"'BusinessProfileUpdateRequest' is defined but never used. Allowed unused vars must match /^_/u.","line":23,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":23,"endColumn":31,"suggestions":[{"messageId":"removeVar","data":{"varName":"BusinessProfileUpdateRequest"},"fix":{"range":[575,607],"text":""},"desc":"Remove unused variable 'BusinessProfileUpdateRequest'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'BusinessProfileUpdateRequest' is defined but never used. Allowed unused vars must match /^_/u.","line":23,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":23,"endColumn":31},{"ruleId":"no-unused-vars","severity":2,"message":"'TemplateCreateRequest' is defined but never used. Allowed unused vars must match /^_/u.","line":24,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":24,"suggestions":[{"messageId":"removeVar","data":{"varName":"TemplateCreateRequest"},"fix":{"range":[607,632],"text":""},"desc":"Remove unused variable 'TemplateCreateRequest'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'TemplateCreateRequest' is defined but never used. Allowed unused vars must match /^_/u.","line":24,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":24,"endColumn":24},{"ruleId":"no-unused-vars","severity":2,"message":"'TemplateDeleteRequest' is defined but never used. Allowed unused vars must match /^_/u.","line":25,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":25,"endColumn":24,"suggestions":[{"messageId":"removeVar","data":{"varName":"TemplateDeleteRequest"},"fix":{"range":[632,657],"text":""},"desc":"Remove unused variable 'TemplateDeleteRequest'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'TemplateDeleteRequest' is defined but never used. Allowed unused vars must match /^_/u.","line":25,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":25,"endColumn":24},{"ruleId":"no-unused-vars","severity":2,"message":"'PhoneNumberRegistrationRequest' is defined but never used. Allowed unused vars must match /^_/u.","line":26,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":26,"endColumn":33,"suggestions":[{"messageId":"removeVar","data":{"varName":"PhoneNumberRegistrationRequest"},"fix":{"range":[657,691],"text":""},"desc":"Remove unused variable 'PhoneNumberRegistrationRequest'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'PhoneNumberRegistrationRequest' is defined but never used. Allowed unused vars must match /^_/u.","line":26,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":26,"endColumn":33},{"ruleId":"no-unused-vars","severity":2,"message":"'PhoneNumberVerificationRequest' is defined but never used. Allowed unused vars must match /^_/u.","line":27,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":27,"endColumn":33,"suggestions":[{"messageId":"removeVar","data":{"varName":"PhoneNumberVerificationRequest"},"fix":{"range":[691,725],"text":""},"desc":"Remove unused variable 'PhoneNumberVerificationRequest'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'PhoneNumberVerificationRequest' is defined but never used. Allowed unused vars must match /^_/u.","line":27,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":27,"endColumn":33},{"ruleId":"no-unused-vars","severity":2,"message":"'WebhookSubscriptionRequest' is defined but never used. Allowed unused vars must match /^_/u.","line":28,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":28,"endColumn":29,"suggestions":[{"messageId":"removeVar","data":{"varName":"WebhookSubscriptionRequest"},"fix":{"range":[725,755],"text":""},"desc":"Remove unused variable 'WebhookSubscriptionRequest'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'WebhookSubscriptionRequest' is defined but never used. Allowed unused vars must match /^_/u.","line":28,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":28,"endColumn":29},{"ruleId":"no-unused-vars","severity":2,"message":"'MessageMarkRequest' is defined but never used. Allowed unused vars must match /^_/u.","line":29,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":29,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"MessageMarkRequest"},"fix":{"range":[755,777],"text":""},"desc":"Remove unused variable 'MessageMarkRequest'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'MessageMarkRequest' is defined but never used. Allowed unused vars must match /^_/u.","line":29,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":29,"endColumn":21},{"ruleId":"no-unused-vars","severity":2,"message":"'UserBlockRequest' is defined but never used. Allowed unused vars must match /^_/u.","line":30,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":30,"endColumn":19,"suggestions":[{"messageId":"removeVar","data":{"varName":"UserBlockRequest"},"fix":{"range":[777,797],"text":""},"desc":"Remove unused variable 'UserBlockRequest'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'UserBlockRequest' is defined but never used. Allowed unused vars must match /^_/u.","line":30,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":30,"endColumn":19},{"ruleId":"no-unused-vars","severity":2,"message":"'QualityRatingRequest' is defined but never used. Allowed unused vars must match /^_/u.","line":31,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":31,"endColumn":23,"suggestions":[{"messageId":"removeVar","data":{"varName":"QualityRatingRequest"},"fix":{"range":[797,821],"text":""},"desc":"Remove unused variable 'QualityRatingRequest'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'QualityRatingRequest' is defined but never used. Allowed unused vars must match /^_/u.","line":31,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":31,"endColumn":23},{"ruleId":"no-unused-vars","severity":2,"message":"'TemplateStatusUpdateRequest' is defined but never used. Allowed unused vars must match /^_/u.","line":32,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":32,"endColumn":30,"suggestions":[{"messageId":"removeVar","data":{"varName":"TemplateStatusUpdateRequest"},"fix":{"range":[821,852],"text":""},"desc":"Remove unused variable 'TemplateStatusUpdateRequest'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'TemplateStatusUpdateRequest' is defined but never used. Allowed unused vars must match /^_/u.","line":32,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":32,"endColumn":30},{"ruleId":"no-unused-vars","severity":2,"message":"'AccountInfoRequest' is defined but never used. Allowed unused vars must match /^_/u.","line":33,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":33,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"AccountInfoRequest"},"fix":{"range":[852,874],"text":""},"desc":"Remove unused variable 'AccountInfoRequest'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'AccountInfoRequest' is defined but never used. Allowed unused vars must match /^_/u.","line":33,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":33,"endColumn":21},{"ruleId":"no-unused-vars","severity":2,"message":"'AppSettingsRequest' is defined but never used. Allowed unused vars must match /^_/u.","line":34,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":34,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"AppSettingsRequest"},"fix":{"range":[874,896],"text":""},"desc":"Remove unused variable 'AppSettingsRequest'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'AppSettingsRequest' is defined but never used. Allowed unused vars must match /^_/u.","line":34,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":34,"endColumn":21},{"ruleId":"no-unused-vars","severity":2,"message":"'MessageReactionRequest' is defined but never used. Allowed unused vars must match /^_/u.","line":35,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":35,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"MessageReactionRequest"},"fix":{"range":[896,922],"text":""},"desc":"Remove unused variable 'MessageReactionRequest'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'MessageReactionRequest' is defined but never used. Allowed unused vars must match /^_/u.","line":35,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":35,"endColumn":25},{"ruleId":"no-unused-vars","severity":2,"message":"'MessageForwardRequest' is defined but never used. Allowed unused vars must match /^_/u.","line":36,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":36,"endColumn":24,"suggestions":[{"messageId":"removeVar","data":{"varName":"MessageForwardRequest"},"fix":{"range":[922,947],"text":""},"desc":"Remove unused variable 'MessageForwardRequest'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'MessageForwardRequest' is defined but never used. Allowed unused vars must match /^_/u.","line":36,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":36,"endColumn":24},{"ruleId":"no-unused-vars","severity":2,"message":"'GroupMessageRequest' is defined but never used. Allowed unused vars must match /^_/u.","line":37,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":37,"endColumn":22,"suggestions":[{"messageId":"removeVar","data":{"varName":"GroupMessageRequest"},"fix":{"range":[947,970],"text":""},"desc":"Remove unused variable 'GroupMessageRequest'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'GroupMessageRequest' is defined but never used. Allowed unused vars must match /^_/u.","line":37,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":37,"endColumn":22},{"ruleId":"no-unused-vars","severity":2,"message":"'WhatsAppApiRequest' is defined but never used. Allowed unused vars must match /^_/u.","line":40,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":40,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"WhatsAppApiRequest"},"fix":{"range":[1005,1027],"text":""},"desc":"Remove unused variable 'WhatsAppApiRequest'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'WhatsAppApiRequest' is defined but never used. Allowed unused vars must match /^_/u.","line":40,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":40,"endColumn":21},{"ruleId":"no-unused-vars","severity":2,"message":"'PhoneNumberInfo' is defined but never used. Allowed unused vars must match /^_/u.","line":50,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":50,"endColumn":18,"suggestions":[{"messageId":"removeVar","data":{"varName":"PhoneNumberInfo"},"fix":{"range":[1216,1235],"text":""},"desc":"Remove unused variable 'PhoneNumberInfo'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'PhoneNumberInfo' is defined but never used. Allowed unused vars must match /^_/u.","line":50,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":50,"endColumn":18},{"ruleId":"no-unused-vars","severity":2,"message":"'BusinessProfile' is defined but never used. Allowed unused vars must match /^_/u.","line":52,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":52,"endColumn":18,"suggestions":[{"messageId":"removeVar","data":{"varName":"BusinessProfile"},"fix":{"range":[1259,1278],"text":""},"desc":"Remove unused variable 'BusinessProfile'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'BusinessProfile' is defined but never used. Allowed unused vars must match /^_/u.","line":52,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":52,"endColumn":18},{"ruleId":"no-unused-vars","severity":2,"message":"'TemplateStatus' is defined but never used. Allowed unused vars must match /^_/u.","line":54,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":54,"endColumn":17,"suggestions":[{"messageId":"removeVar","data":{"varName":"TemplateStatus"},"fix":{"range":[1305,1323],"text":""},"desc":"Remove unused variable 'TemplateStatus'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'TemplateStatus' is defined but never used. Allowed unused vars must match /^_/u.","line":54,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":54,"endColumn":17},{"ruleId":"no-unused-vars","severity":2,"message":"'AnalyticsDataPoint' is defined but never used. Allowed unused vars must match /^_/u.","line":56,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":56,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"AnalyticsDataPoint"},"fix":{"range":[1344,1366],"text":""},"desc":"Remove unused variable 'AnalyticsDataPoint'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'AnalyticsDataPoint' is defined but never used. Allowed unused vars must match /^_/u.","line":56,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":56,"endColumn":21},{"ruleId":"no-unused-vars","severity":2,"message":"'RateLimitInfo' is defined but never used. Allowed unused vars must match /^_/u.","line":59,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":59,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"RateLimitInfo"},"fix":{"range":[1404,1421],"text":""},"desc":"Remove unused variable 'RateLimitInfo'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'RateLimitInfo' is defined but never used. Allowed unused vars must match /^_/u.","line":59,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":59,"endColumn":16},{"ruleId":"no-unused-vars","severity":2,"message":"'AccountInfoResponse' is defined but never used. Allowed unused vars must match /^_/u.","line":60,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":60,"endColumn":22,"suggestions":[{"messageId":"removeVar","data":{"varName":"AccountInfoResponse"},"fix":{"range":[1421,1444],"text":""},"desc":"Remove unused variable 'AccountInfoResponse'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'AccountInfoResponse' is defined but never used. Allowed unused vars must match /^_/u.","line":60,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":60,"endColumn":22},{"ruleId":"no-unused-vars","severity":2,"message":"'AppSettingsResponse' is defined but never used. Allowed unused vars must match /^_/u.","line":61,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":61,"endColumn":22,"suggestions":[{"messageId":"removeVar","data":{"varName":"AppSettingsResponse"},"fix":{"range":[1444,1467],"text":""},"desc":"Remove unused variable 'AppSettingsResponse'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'AppSettingsResponse' is defined but never used. Allowed unused vars must match /^_/u.","line":61,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":61,"endColumn":22},{"ruleId":"no-unused-vars","severity":2,"message":"'QualityRatingResponse' is defined but never used. Allowed unused vars must match /^_/u.","line":62,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":62,"endColumn":24,"suggestions":[{"messageId":"removeVar","data":{"varName":"QualityRatingResponse"},"fix":{"range":[1467,1492],"text":""},"desc":"Remove unused variable 'QualityRatingResponse'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'QualityRatingResponse' is defined but never used. Allowed unused vars must match /^_/u.","line":62,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":62,"endColumn":24},{"ruleId":"no-unused-vars","severity":2,"message":"'MessageStatusResponse' is defined but never used. Allowed unused vars must match /^_/u.","line":63,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":63,"endColumn":24,"suggestions":[{"messageId":"removeVar","data":{"varName":"MessageStatusResponse"},"fix":{"range":[1492,1517],"text":""},"desc":"Remove unused variable 'MessageStatusResponse'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'MessageStatusResponse' is defined but never used. Allowed unused vars must match /^_/u.","line":63,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":63,"endColumn":24},{"ruleId":"no-unused-vars","severity":2,"message":"'UserBlockStatusResponse' is defined but never used. Allowed unused vars must match /^_/u.","line":64,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":64,"endColumn":26,"suggestions":[{"messageId":"removeVar","data":{"varName":"UserBlockStatusResponse"},"fix":{"range":[1517,1544],"text":""},"desc":"Remove unused variable 'UserBlockStatusResponse'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'UserBlockStatusResponse' is defined but never used. Allowed unused vars must match /^_/u.","line":64,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":64,"endColumn":26},{"ruleId":"no-unused-vars","severity":2,"message":"'WebhookVerificationResponse' is defined but never used. Allowed unused vars must match /^_/u.","line":65,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":65,"endColumn":30,"suggestions":[{"messageId":"removeVar","data":{"varName":"WebhookVerificationResponse"},"fix":{"range":[1544,1575],"text":""},"desc":"Remove unused variable 'WebhookVerificationResponse'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'WebhookVerificationResponse' is defined but never used. Allowed unused vars must match /^_/u.","line":65,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":65,"endColumn":30},{"ruleId":"no-unused-vars","severity":2,"message":"'WhatsAppApiResponseType' is defined but never used. Allowed unused vars must match /^_/u.","line":72,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":72,"endColumn":26,"suggestions":[{"messageId":"removeVar","data":{"varName":"WhatsAppApiResponseType"},"fix":{"range":[1698,1725],"text":""},"desc":"Remove unused variable 'WhatsAppApiResponseType'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'WhatsAppApiResponseType' is defined but never used. Allowed unused vars must match /^_/u.","line":72,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":72,"endColumn":26},{"ruleId":"no-unused-vars","severity":2,"message":"'EnvironmentConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":79,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":79,"endColumn":20,"suggestions":[{"messageId":"removeVar","data":{"varName":"EnvironmentConfig"},"fix":{"range":[1826,1847],"text":""},"desc":"Remove unused variable 'EnvironmentConfig'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'EnvironmentConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":79,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":79,"endColumn":20},{"ruleId":"no-unused-vars","severity":2,"message":"'ApiVersion' is defined but never used. Allowed unused vars must match /^_/u.","line":84,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":84,"endColumn":13,"suggestions":[{"messageId":"removeVar","data":{"varName":"ApiVersion"},"fix":{"range":[1909,1923],"text":""},"desc":"Remove unused variable 'ApiVersion'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ApiVersion' is defined but never used. Allowed unused vars must match /^_/u.","line":84,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":84,"endColumn":13},{"ruleId":"no-unused-vars","severity":2,"message":"'TemplateStatusType' is defined but never used. Allowed unused vars must match /^_/u.","line":88,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":88,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"TemplateStatusType"},"fix":{"range":[1971,1993],"text":""},"desc":"Remove unused variable 'TemplateStatusType'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'TemplateStatusType' is defined but never used. Allowed unused vars must match /^_/u.","line":88,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":88,"endColumn":21},{"ruleId":"no-unused-vars","severity":2,"message":"'ThroughputLevel' is defined but never used. Allowed unused vars must match /^_/u.","line":90,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":90,"endColumn":18,"suggestions":[{"messageId":"removeVar","data":{"varName":"ThroughputLevel"},"fix":{"range":[2010,2029],"text":""},"desc":"Remove unused variable 'ThroughputLevel'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ThroughputLevel' is defined but never used. Allowed unused vars must match /^_/u.","line":90,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":90,"endColumn":18},{"ruleId":"no-unused-vars","severity":2,"message":"'AnalyticsGranularity' is defined but never used. Allowed unused vars must match /^_/u.","line":91,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":91,"endColumn":23,"suggestions":[{"messageId":"removeVar","data":{"varName":"AnalyticsGranularity"},"fix":{"range":[2029,2053],"text":""},"desc":"Remove unused variable 'AnalyticsGranularity'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'AnalyticsGranularity' is defined but never used. Allowed unused vars must match /^_/u.","line":91,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":91,"endColumn":23},{"ruleId":"no-unused-vars","severity":2,"message":"'AnalyticsMetricType' is defined but never used. Allowed unused vars must match /^_/u.","line":92,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":92,"endColumn":22,"suggestions":[{"messageId":"removeVar","data":{"varName":"AnalyticsMetricType"},"fix":{"range":[2053,2076],"text":""},"desc":"Remove unused variable 'AnalyticsMetricType'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'AnalyticsMetricType' is defined but never used. Allowed unused vars must match /^_/u.","line":92,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":92,"endColumn":22},{"ruleId":"no-unused-vars","severity":2,"message":"'ErrorSeverity' is defined but never used. Allowed unused vars must match /^_/u.","line":121,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":121,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"ErrorSeverity"},"fix":{"range":[2622,2639],"text":""},"desc":"Remove unused variable 'ErrorSeverity'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ErrorSeverity' is defined but never used. Allowed unused vars must match /^_/u.","line":121,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":121,"endColumn":16},{"ruleId":"no-unused-vars","severity":2,"message":"'ErrorCategory' is defined but never used. Allowed unused vars must match /^_/u.","line":122,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":122,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"ErrorCategory"},"fix":{"range":[2639,2656],"text":""},"desc":"Remove unused variable 'ErrorCategory'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ErrorCategory' is defined but never used. Allowed unused vars must match /^_/u.","line":122,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":122,"endColumn":16},{"ruleId":"no-unused-vars","severity":2,"message":"'ErrorContext' is defined but never used. Allowed unused vars must match /^_/u.","line":123,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":123,"endColumn":15,"suggestions":[{"messageId":"removeVar","data":{"varName":"ErrorContext"},"fix":{"range":[2656,2672],"text":""},"desc":"Remove unused variable 'ErrorContext'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ErrorContext' is defined but never used. Allowed unused vars must match /^_/u.","line":123,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":123,"endColumn":15},{"ruleId":"no-unused-vars","severity":2,"message":"'ErrorDetails' is defined but never used. Allowed unused vars must match /^_/u.","line":124,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":124,"endColumn":15,"suggestions":[{"messageId":"removeVar","data":{"varName":"ErrorDetails"},"fix":{"range":[2672,2688],"text":""},"desc":"Remove unused variable 'ErrorDetails'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ErrorDetails' is defined but never used. Allowed unused vars must match /^_/u.","line":124,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":124,"endColumn":15},{"ruleId":"no-unused-vars","severity":2,"message":"'ErrorHandlingStrategy' is defined but never used. Allowed unused vars must match /^_/u.","line":125,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":125,"endColumn":24,"suggestions":[{"messageId":"removeVar","data":{"varName":"ErrorHandlingStrategy"},"fix":{"range":[2688,2713],"text":""},"desc":"Remove unused variable 'ErrorHandlingStrategy'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ErrorHandlingStrategy' is defined but never used. Allowed unused vars must match /^_/u.","line":125,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":125,"endColumn":24},{"ruleId":"no-unused-vars","severity":2,"message":"'ErrorStatistics' is defined but never used. Allowed unused vars must match /^_/u.","line":126,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":126,"endColumn":18,"suggestions":[{"messageId":"removeVar","data":{"varName":"ErrorStatistics"},"fix":{"range":[2713,2732],"text":""},"desc":"Remove unused variable 'ErrorStatistics'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ErrorStatistics' is defined but never used. Allowed unused vars must match /^_/u.","line":126,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":126,"endColumn":18},{"ruleId":"no-unused-vars","severity":2,"message":"'ErrorReport' is defined but never used. Allowed unused vars must match /^_/u.","line":127,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":127,"endColumn":14,"suggestions":[{"messageId":"removeVar","data":{"varName":"ErrorReport"},"fix":{"range":[2732,2747],"text":""},"desc":"Remove unused variable 'ErrorReport'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ErrorReport' is defined but never used. Allowed unused vars must match /^_/u.","line":127,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":127,"endColumn":14},{"ruleId":"no-unused-vars","severity":2,"message":"'ErrorHandlingConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":128,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":128,"endColumn":22,"suggestions":[{"messageId":"removeVar","data":{"varName":"ErrorHandlingConfig"},"fix":{"range":[2747,2770],"text":""},"desc":"Remove unused variable 'ErrorHandlingConfig'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ErrorHandlingConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":128,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":128,"endColumn":22}],"suppressedMessages":[],"errorCount":92,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * WhatsApp API 类型定义 - 主入口\n * WhatsApp API Type Definitions - Main Entry Point\n *\n * 统一的WhatsApp Business API类型入口，整合所有API相关类型定义\n */\n\n// 重新导出所有模块的功能\nexport * from './whatsapp-api-requests';\nexport * from './whatsapp-api-responses';\nexport * from './whatsapp-api-config';\nexport * from './whatsapp-api-errors';\n\n// 向后兼容的重新导出\nimport type { TemplateMessage } from './whatsapp-template-types';\nimport type { WhatsAppContact, LocationData, ContactData } from './whatsapp-base-types';\n\nimport type {\n  SendMessageRequest,\n  MediaUploadRequest,\n  AnalyticsRequest,\n  BatchRequest,\n  BusinessProfileUpdateRequest,\n  TemplateCreateRequest,\n  TemplateDeleteRequest,\n  PhoneNumberRegistrationRequest,\n  PhoneNumberVerificationRequest,\n  WebhookSubscriptionRequest,\n  MessageMarkRequest,\n  UserBlockRequest,\n  QualityRatingRequest,\n  TemplateStatusUpdateRequest,\n  AccountInfoRequest,\n  AppSettingsRequest,\n  MessageReactionRequest,\n  MessageForwardRequest,\n  GroupMessageRequest,\n  ApiRequestOptions,\n  ApiRequest,\n  WhatsAppApiRequest,\n  RequestBuilders,\n} from './whatsapp-api-requests';\n\nimport type {\n  SendMessageResponse,\n  WhatsAppApiResponse,\n  WhatsAppServiceResponse,\n  MediaUploadResponse,\n  MediaRetrieveResponse,\n  PhoneNumberInfo,\n  PhoneNumbersResponse,\n  BusinessProfile,\n  BusinessProfileResponse,\n  TemplateStatus,\n  TemplatesResponse,\n  AnalyticsDataPoint,\n  AnalyticsResponse,\n  BatchResponse,\n  RateLimitInfo,\n  AccountInfoResponse,\n  AppSettingsResponse,\n  QualityRatingResponse,\n  MessageStatusResponse,\n  UserBlockStatusResponse,\n  WebhookVerificationResponse,\n  PaginationCursors,\n  PaginationInfo,\n  PaginatedResponse,\n  ApiResponse,\n  WhatsAppApiErrorResponse,\n  WhatsAppApiError,\n  WhatsAppApiResponseType,\n  ResponseUtils,\n} from './whatsapp-api-responses';\n\nimport type {\n  ApiConfig,\n  ExtendedApiConfig,\n  EnvironmentConfig,\n  WebhookConfig,\n  ClientConfig,\n  ApiEndpoint,\n  HttpMethod,\n  ApiVersion,\n  MessageType,\n  MediaType,\n  TemplateCategory,\n  TemplateStatusType,\n  QualityRating,\n  ThroughputLevel,\n  AnalyticsGranularity,\n  AnalyticsMetricType,\n  ErrorCode,\n  API_ENDPOINTS,\n  HTTP_METHODS,\n  API_VERSIONS,\n  MESSAGE_TYPES,\n  MEDIA_TYPES,\n  TEMPLATE_CATEGORIES,\n  TEMPLATE_STATUSES,\n  QUALITY_RATINGS,\n  THROUGHPUT_LEVELS,\n  ANALYTICS_GRANULARITIES,\n  ANALYTICS_METRIC_TYPES,\n  DEFAULT_API_CONFIG,\n  DEFAULT_WEBHOOK_CONFIG,\n  DEFAULT_REQUEST_OPTIONS,\n  ERROR_CODE_MESSAGES,\n  RETRYABLE_ERROR_CODES,\n  ConfigUtils,\n} from './whatsapp-api-config';\n\nimport type {\n  WhatsAppError,\n  NetworkError,\n  ValidationError,\n  AuthenticationError,\n  RateLimitError,\n  BusinessLogicError,\n  ServerError,\n  ErrorSeverity,\n  ErrorCategory,\n  ErrorContext,\n  ErrorDetails,\n  ErrorHandlingStrategy,\n  ErrorStatistics,\n  ErrorReport,\n  ErrorHandlingConfig,\n  ErrorUtils,\n} from './whatsapp-api-errors';\n\n// ==================== 向后兼容的类型别名 ====================\n\n/**\n * 向后兼容的类型别名\n * Backward compatible type aliases\n */\nexport type {\n  // 请求类型\n  SendMessageRequest as SendRequest,\n  MediaUploadRequest as UploadRequest,\n  AnalyticsRequest as AnalyticsReq,\n  BatchRequest as BatchReq,\n  ApiRequest as Request,\n  ApiRequestOptions as RequestOptions,\n\n  // 响应类型\n  SendMessageResponse as SendResponse,\n  WhatsAppApiResponse as ApiResponse,\n  WhatsAppServiceResponse as ServiceResponse,\n  MediaUploadResponse as UploadResponse,\n  MediaRetrieveResponse as RetrieveResponse,\n  PhoneNumbersResponse as PhoneNumbersResp,\n  BusinessProfileResponse as BusinessProfileResp,\n  TemplatesResponse as TemplatesResp,\n  AnalyticsResponse as AnalyticsResp,\n  BatchResponse as BatchResp,\n  ApiResponse as Response,\n\n  // 配置类型\n  ApiConfig as Config,\n  ExtendedApiConfig as ExtendedConfig,\n  WebhookConfig as WebhookConf,\n  ClientConfig as ClientConf,\n\n  // 错误类型\n  WhatsAppApiError as ApiError,\n  WhatsAppApiErrorResponse as ErrorResponse,\n  WhatsAppError as Error,\n  NetworkError as NetError,\n  ValidationError as ValidError,\n  AuthenticationError as AuthError,\n  RateLimitError as RateLimitErr,\n  BusinessLogicError as BusinessError,\n  ServerError as ServError,\n\n  // 工具类型\n  ApiEndpoint as Endpoint,\n  HttpMethod as Method,\n  MessageType as MsgType,\n  MediaType as MediaT,\n  TemplateCategory as TemplateCategory,\n  QualityRating as Quality,\n  ErrorCode as ErrCode,\n\n  // 分页类型\n  PaginatedResponse as PagedResponse,\n  PaginationInfo as PageInfo,\n  PaginationCursors as PageCursors,\n};\n\n/**\n * 向后兼容的导出别名\n * Backward compatible export aliases\n */\nexport {\n  // 常量\n  API_ENDPOINTS,\n  HTTP_METHODS,\n  API_VERSIONS,\n  MESSAGE_TYPES,\n  MEDIA_TYPES,\n  TEMPLATE_CATEGORIES,\n  TEMPLATE_STATUSES,\n  QUALITY_RATINGS,\n  THROUGHPUT_LEVELS,\n  ANALYTICS_GRANULARITIES,\n  ANALYTICS_METRIC_TYPES,\n\n  // 默认配置\n  DEFAULT_API_CONFIG,\n  DEFAULT_WEBHOOK_CONFIG,\n  DEFAULT_REQUEST_OPTIONS,\n\n  // 错误相关\n  ERROR_CODE_MESSAGES,\n  RETRYABLE_ERROR_CODES,\n\n  // 工具函数\n  ConfigUtils,\n  ResponseUtils,\n  ErrorUtils,\n  RequestBuilders,\n};\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/types/whatsapp-base-types.ts","messages":[{"ruleId":"@typescript-eslint/no-empty-object-type","severity":2,"message":"An interface declaring no members is equivalent to its supertype.","line":62,"column":18,"nodeType":"Identifier","messageId":"noEmptyInterfaceWithSuper","endLine":62,"endColumn":28,"suggestions":[{"messageId":"replaceEmptyInterfaceWithSuper","fix":{"range":[1154,1247],"text":"type ImageMedia = MediaObject"},"desc":"Replace empty interface with a type alias."}]},{"ruleId":"@typescript-eslint/no-empty-object-type","severity":2,"message":"An interface declaring no members is equivalent to its supertype.","line":70,"column":18,"nodeType":"Identifier","messageId":"noEmptyInterfaceWithSuper","endLine":70,"endColumn":28,"suggestions":[{"messageId":"replaceEmptyInterfaceWithSuper","fix":{"range":[1333,1426],"text":"type VideoMedia = MediaObject"},"desc":"Replace empty interface with a type alias."}]},{"ruleId":"no-implicit-coercion","severity":2,"message":"Unexpected implicit coercion encountered. Use `Boolean(message.text)` instead.","line":167,"column":37,"nodeType":"UnaryExpression","messageId":"implicitCoercion","endLine":167,"endColumn":51,"fix":{"range":[3353,3367],"text":"Boolean(message.text)"}},{"ruleId":"no-implicit-coercion","severity":2,"message":"Unexpected implicit coercion encountered. Use `Boolean(message.image)` instead.","line":171,"column":38,"nodeType":"UnaryExpression","messageId":"implicitCoercion","endLine":171,"endColumn":53,"fix":{"range":[3547,3562],"text":"Boolean(message.image)"}},{"ruleId":"no-implicit-coercion","severity":2,"message":"Unexpected implicit coercion encountered. Use `Boolean(message.document)` instead.","line":175,"column":41,"nodeType":"UnaryExpression","messageId":"implicitCoercion","endLine":175,"endColumn":59,"fix":{"range":[3754,3772],"text":"Boolean(message.document)"}},{"ruleId":"no-implicit-coercion","severity":2,"message":"Unexpected implicit coercion encountered. Use `Boolean(message.audio)` instead.","line":179,"column":38,"nodeType":"UnaryExpression","messageId":"implicitCoercion","endLine":179,"endColumn":53,"fix":{"range":[3952,3967],"text":"Boolean(message.audio)"}},{"ruleId":"no-implicit-coercion","severity":2,"message":"Unexpected implicit coercion encountered. Use `Boolean(message.video)` instead.","line":183,"column":38,"nodeType":"UnaryExpression","messageId":"implicitCoercion","endLine":183,"endColumn":53,"fix":{"range":[4147,4162],"text":"Boolean(message.video)"}},{"ruleId":"no-implicit-coercion","severity":2,"message":"Unexpected implicit coercion encountered. Use `Boolean(message.location)` instead.","line":187,"column":41,"nodeType":"UnaryExpression","messageId":"implicitCoercion","endLine":187,"endColumn":59,"fix":{"range":[4354,4372],"text":"Boolean(message.location)"}},{"ruleId":"no-implicit-coercion","severity":2,"message":"Unexpected implicit coercion encountered. Use `Boolean(message.contacts)` instead.","line":191,"column":41,"nodeType":"UnaryExpression","messageId":"implicitCoercion","endLine":191,"endColumn":59,"fix":{"range":[4564,4582],"text":"Boolean(message.contacts)"}}],"suppressedMessages":[],"errorCount":9,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":7,"fixableWarningCount":0,"source":"/**\n * WhatsApp API Base Type Definitions\n *\n * This module provides fundamental type definitions for WhatsApp Business API integration,\n * including basic contact and message structures.\n */\n\n// Base WhatsApp API Types\nexport interface WhatsAppContact {\n  input: string;\n  wa_id: string;\n}\n\nexport interface WhatsAppMessage {\n  id: string;\n  from: string;\n  timestamp: string;\n  type: 'text' | 'image' | 'document' | 'audio' | 'video' | 'location' | 'contacts' | 'template';\n  text?: {\n    body: string;\n  };\n  image?: {\n    id: string;\n    mime_type: string;\n    sha256: string;\n    caption?: string;\n  };\n  document?: {\n    id: string;\n    filename: string;\n    mime_type: string;\n    sha256: string;\n    caption?: string;\n  };\n  audio?: {\n    id: string;\n    mime_type: string;\n    sha256: string;\n  };\n  video?: {\n    id: string;\n    mime_type: string;\n    sha256: string;\n    caption?: string;\n  };\n  location?: {\n    latitude: number;\n    longitude: number;\n    name?: string;\n    address?: string;\n  };\n  contacts?: WhatsAppContact[];\n}\n\n// Media Types\nexport interface MediaObject {\n  id?: string;\n  link?: string;\n  caption?: string;\n}\n\nexport interface ImageMedia extends MediaObject {\n  // Image-specific properties can be added here\n}\n\nexport interface DocumentMedia extends MediaObject {\n  filename?: string;\n}\n\nexport interface VideoMedia extends MediaObject {\n  // Video-specific properties can be added here\n}\n\nexport interface AudioMedia {\n  id?: string;\n  link?: string;\n  // Audio doesn't typically have captions\n}\n\n// Location Types\nexport interface LocationData {\n  latitude: number;\n  longitude: number;\n  name?: string;\n  address?: string;\n}\n\n// Contact Types\nexport interface ContactName {\n  formatted_name: string;\n  first_name?: string;\n  last_name?: string;\n  middle_name?: string;\n  suffix?: string;\n  prefix?: string;\n}\n\nexport interface ContactPhone {\n  phone?: string;\n  type?: 'CELL' | 'MAIN' | 'IPHONE' | 'HOME' | 'WORK';\n  wa_id?: string;\n}\n\nexport interface ContactEmail {\n  email?: string;\n  type?: 'WORK' | 'HOME';\n}\n\nexport interface ContactUrl {\n  url?: string;\n  type?: 'WORK' | 'HOME';\n}\n\nexport interface ContactAddress {\n  street?: string;\n  city?: string;\n  state?: string;\n  zip?: string;\n  country?: string;\n  country_code?: string;\n  type?: 'WORK' | 'HOME';\n}\n\nexport interface ContactOrg {\n  company?: string;\n  department?: string;\n  title?: string;\n}\n\nexport interface ContactData {\n  name: ContactName;\n  phones?: ContactPhone[];\n  emails?: ContactEmail[];\n  urls?: ContactUrl[];\n  addresses?: ContactAddress[];\n  org?: ContactOrg;\n  birthday?: string; // YYYY-MM-DD format\n}\n\n// Message Status Types\nexport type MessageStatus = 'sent' | 'delivered' | 'read' | 'failed';\n\nexport interface MessageStatusUpdate {\n  id: string;\n  status: MessageStatus;\n  timestamp: string;\n  recipient_id: string;\n  errors?: WhatsAppError[];\n}\n\n// Error Types (Basic)\nexport interface WhatsAppError {\n  code: number;\n  title: string;\n  message: string;\n  error_data?: {\n    details: string;\n  };\n}\n\n// Utility Types\nexport type MessageType = WhatsAppMessage['type'];\nexport type MediaType = 'image' | 'document' | 'audio' | 'video';\n\n// Type Guards\nexport function isTextMessage(message: WhatsAppMessage): message is WhatsAppMessage & { text: NonNullable<WhatsAppMessage['text']> } {\n  return message.type === 'text' && !!message.text;\n}\n\nexport function isImageMessage(message: WhatsAppMessage): message is WhatsAppMessage & { image: NonNullable<WhatsAppMessage['image']> } {\n  return message.type === 'image' && !!message.image;\n}\n\nexport function isDocumentMessage(message: WhatsAppMessage): message is WhatsAppMessage & { document: NonNullable<WhatsAppMessage['document']> } {\n  return message.type === 'document' && !!message.document;\n}\n\nexport function isAudioMessage(message: WhatsAppMessage): message is WhatsAppMessage & { audio: NonNullable<WhatsAppMessage['audio']> } {\n  return message.type === 'audio' && !!message.audio;\n}\n\nexport function isVideoMessage(message: WhatsAppMessage): message is WhatsAppMessage & { video: NonNullable<WhatsAppMessage['video']> } {\n  return message.type === 'video' && !!message.video;\n}\n\nexport function isLocationMessage(message: WhatsAppMessage): message is WhatsAppMessage & { location: NonNullable<WhatsAppMessage['location']> } {\n  return message.type === 'location' && !!message.location;\n}\n\nexport function isContactsMessage(message: WhatsAppMessage): message is WhatsAppMessage & { contacts: NonNullable<WhatsAppMessage['contacts']> } {\n  return message.type === 'contacts' && !!message.contacts;\n}\n\n// Constants\nexport const WHATSAPP_MESSAGE_TYPES = [\n  'text',\n  'image',\n  'document',\n  'audio',\n  'video',\n  'location',\n  'contacts',\n  'template'\n] as const;\n\nexport const WHATSAPP_MESSAGE_STATUSES = [\n  'sent',\n  'delivered',\n  'read',\n  'failed'\n] as const;\n\nexport const SUPPORTED_MEDIA_TYPES = [\n  'image',\n  'document',\n  'audio',\n  'video'\n] as const;\n\n// Validation Helpers\nexport function isValidMessageType(type: string): type is MessageType {\n  return WHATSAPP_MESSAGE_TYPES.includes(type as MessageType);\n}\n\nexport function isValidMessageStatus(status: string): status is MessageStatus {\n  return WHATSAPP_MESSAGE_STATUSES.includes(status as MessageStatus);\n}\n\nexport function isValidMediaType(type: string): type is MediaType {\n  return SUPPORTED_MEDIA_TYPES.includes(type as MediaType);\n}\n\n// Message Validation\nexport interface MessageValidationResult {\n  isValid: boolean;\n  errors: string[];\n}\n\nexport function validateWhatsAppMessage(message: Partial<WhatsAppMessage>): MessageValidationResult {\n  const errors: string[] = [];\n\n  if (!message.id) {\n    errors.push('Message ID is required');\n  }\n\n  if (!message.from) {\n    errors.push('Message sender is required');\n  }\n\n  if (!message.timestamp) {\n    errors.push('Message timestamp is required');\n  }\n\n  if (!message.type || !isValidMessageType(message.type)) {\n    errors.push('Valid message type is required');\n  }\n\n  // Type-specific validation\n  if (message.type === 'text' && !message.text?.body) {\n    errors.push('Text message must have body content');\n  }\n\n  if (message.type === 'location' && message.location) {\n    if (typeof message.location.latitude !== 'number' || typeof message.location.longitude !== 'number') {\n      errors.push('Location message must have valid latitude and longitude');\n    }\n  }\n\n  return {\n    isValid: errors.length === 0,\n    errors\n  };\n}\n\n// Export commonly used types with shorter names\nexport type {\n  WhatsAppContact as Contact,\n  WhatsAppMessage as Message,\n  WhatsAppError as Error,\n  MessageStatusUpdate as StatusUpdate,\n  LocationData as Location,\n  ContactData as ContactInfo\n};\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/types/whatsapp-message-types.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'WhatsAppContact' is defined but never used. Allowed unused vars must match /^_/u.","line":9,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":30,"suggestions":[{"messageId":"removeVar","data":{"varName":"WhatsAppContact"},"fix":{"range":[293,309],"text":""},"desc":"Remove unused variable 'WhatsAppContact'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'WhatsAppContact' is defined but never used. Allowed unused vars must match /^_/u.","line":9,"column":15,"nodeType":null,"messageId":"unusedVar","endLine":9,"endColumn":30},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 4096.","line":289,"column":55,"nodeType":"Literal","messageId":"noMagic","endLine":289,"endColumn":59},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 3.","line":308,"column":40,"nodeType":"Literal","messageId":"noMagic","endLine":308,"endColumn":41},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 20.","line":316,"column":39,"nodeType":"Literal","messageId":"noMagic","endLine":316,"endColumn":41},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 10.","line":326,"column":41,"nodeType":"Literal","messageId":"noMagic","endLine":326,"endColumn":43},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 10.","line":337,"column":40,"nodeType":"Literal","messageId":"noMagic","endLine":337,"endColumn":42}],"suppressedMessages":[],"errorCount":7,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * WhatsApp Specific Message Type Definitions\n *\n * This module provides type definitions for specific WhatsApp message types\n * including text, image, interactive, and other specialized message formats.\n */\n\nimport type { TemplateMessage } from './whatsapp-template-types';\nimport type { WhatsAppContact, LocationData, ContactData } from './whatsapp-base-types';\n\n// Base Message Structure\ninterface BaseMessage {\n  messaging_product: 'whatsapp';\n  recipient_type: 'individual';\n  to: string;\n}\n\n// Text Message Types\nexport interface TextMessage extends BaseMessage {\n  type: 'text';\n  text: {\n    preview_url?: boolean;\n    body: string;\n  };\n}\n\n// Image Message Types\nexport interface ImageMessage extends BaseMessage {\n  type: 'image';\n  image: {\n    id?: string;\n    link?: string;\n    caption?: string;\n  };\n}\n\n// Document Message Types\nexport interface DocumentMessage extends BaseMessage {\n  type: 'document';\n  document: {\n    id?: string;\n    link?: string;\n    caption?: string;\n    filename?: string;\n  };\n}\n\n// Audio Message Types\nexport interface AudioMessage extends BaseMessage {\n  type: 'audio';\n  audio: {\n    id?: string;\n    link?: string;\n  };\n}\n\n// Video Message Types\nexport interface VideoMessage extends BaseMessage {\n  type: 'video';\n  video: {\n    id?: string;\n    link?: string;\n    caption?: string;\n  };\n}\n\n// Location Message Types\nexport interface LocationMessage extends BaseMessage {\n  type: 'location';\n  location: LocationData;\n}\n\n// Contacts Message Types\nexport interface ContactsMessage extends BaseMessage {\n  type: 'contacts';\n  contacts: ContactData[];\n}\n\n// Template Message Types\nexport interface TemplateMessageRequest extends BaseMessage {\n  type: 'template';\n  template: TemplateMessage;\n}\n\n// Interactive Message Types\nexport interface InteractiveButton {\n  type: 'reply';\n  reply: {\n    id: string;\n    title: string;\n  };\n}\n\nexport interface InteractiveListRow {\n  id: string;\n  title: string;\n  description?: string;\n}\n\nexport interface InteractiveListSection {\n  title?: string;\n  rows: InteractiveListRow[];\n}\n\nexport interface InteractiveHeader {\n  type: 'text' | 'image' | 'document' | 'video';\n  text?: string;\n  image?: {\n    id?: string;\n    link?: string;\n  };\n  document?: {\n    id?: string;\n    link?: string;\n    filename?: string;\n  };\n  video?: {\n    id?: string;\n    link?: string;\n  };\n}\n\nexport interface InteractiveBody {\n  text: string;\n}\n\nexport interface InteractiveFooter {\n  text: string;\n}\n\nexport interface InteractiveButtonAction {\n  buttons: InteractiveButton[];\n}\n\nexport interface InteractiveListAction {\n  button: string;\n  sections: InteractiveListSection[];\n}\n\nexport interface InteractiveMessage extends BaseMessage {\n  type: 'interactive';\n  interactive: {\n    type: 'button' | 'list';\n    header?: InteractiveHeader;\n    body: InteractiveBody;\n    footer?: InteractiveFooter;\n    action: InteractiveButtonAction | InteractiveListAction;\n  };\n}\n\n// Reaction Message Types\nexport interface ReactionMessage extends BaseMessage {\n  type: 'reaction';\n  reaction: {\n    message_id: string;\n    emoji: string;\n  };\n}\n\n// Sticker Message Types\nexport interface StickerMessage extends BaseMessage {\n  type: 'sticker';\n  sticker: {\n    id?: string;\n    link?: string;\n  };\n}\n\n// Union Types\nexport type WhatsAppOutgoingMessage = \n  | TextMessage\n  | ImageMessage\n  | DocumentMessage\n  | AudioMessage\n  | VideoMessage\n  | LocationMessage\n  | ContactsMessage\n  | TemplateMessageRequest\n  | InteractiveMessage\n  | ReactionMessage\n  | StickerMessage;\n\nexport type MediaMessage = ImageMessage | DocumentMessage | AudioMessage | VideoMessage | StickerMessage;\nexport type InteractiveMessageType = 'button' | 'list';\n\n// Message Builder Types\nexport interface MessageBuilder {\n  to: string;\n  type: WhatsAppOutgoingMessage['type'];\n}\n\nexport interface TextMessageBuilder extends MessageBuilder {\n  type: 'text';\n  body: string;\n  preview_url?: boolean;\n}\n\nexport interface MediaMessageBuilder extends MessageBuilder {\n  type: 'image' | 'document' | 'audio' | 'video' | 'sticker';\n  media_id?: string;\n  media_link?: string;\n  caption?: string;\n  filename?: string; // For documents\n}\n\nexport interface InteractiveMessageBuilder extends MessageBuilder {\n  type: 'interactive';\n  interactive_type: InteractiveMessageType;\n  header?: Omit<InteractiveHeader, 'type'> & { type?: InteractiveHeader['type'] };\n  body: string;\n  footer?: string;\n  buttons?: Array<{ id: string; title: string }>;\n  list_button?: string;\n  sections?: InteractiveListSection[];\n}\n\n// Type Guards\nexport function isTextMessage(message: WhatsAppOutgoingMessage): message is TextMessage {\n  return message.type === 'text';\n}\n\nexport function isImageMessage(message: WhatsAppOutgoingMessage): message is ImageMessage {\n  return message.type === 'image';\n}\n\nexport function isDocumentMessage(message: WhatsAppOutgoingMessage): message is DocumentMessage {\n  return message.type === 'document';\n}\n\nexport function isAudioMessage(message: WhatsAppOutgoingMessage): message is AudioMessage {\n  return message.type === 'audio';\n}\n\nexport function isVideoMessage(message: WhatsAppOutgoingMessage): message is VideoMessage {\n  return message.type === 'video';\n}\n\nexport function isLocationMessage(message: WhatsAppOutgoingMessage): message is LocationMessage {\n  return message.type === 'location';\n}\n\nexport function isContactsMessage(message: WhatsAppOutgoingMessage): message is ContactsMessage {\n  return message.type === 'contacts';\n}\n\nexport function isTemplateMessage(message: WhatsAppOutgoingMessage): message is TemplateMessageRequest {\n  return message.type === 'template';\n}\n\nexport function isInteractiveMessage(message: WhatsAppOutgoingMessage): message is InteractiveMessage {\n  return message.type === 'interactive';\n}\n\nexport function isReactionMessage(message: WhatsAppOutgoingMessage): message is ReactionMessage {\n  return message.type === 'reaction';\n}\n\nexport function isStickerMessage(message: WhatsAppOutgoingMessage): message is StickerMessage {\n  return message.type === 'sticker';\n}\n\nexport function isMediaMessage(message: WhatsAppOutgoingMessage): message is MediaMessage {\n  return ['image', 'document', 'audio', 'video', 'sticker'].includes(message.type);\n}\n\nexport function isButtonInteractive(interactive: InteractiveMessage['interactive']): interactive is InteractiveMessage['interactive'] & { type: 'button'; action: InteractiveButtonAction } {\n  return interactive.type === 'button';\n}\n\nexport function isListInteractive(interactive: InteractiveMessage['interactive']): interactive is InteractiveMessage['interactive'] & { type: 'list'; action: InteractiveListAction } {\n  return interactive.type === 'list';\n}\n\n// Message Validation\nexport interface MessageValidationResult {\n  isValid: boolean;\n  errors: string[];\n  warnings: string[];\n}\n\nexport function validateTextMessage(message: TextMessage): MessageValidationResult {\n  const errors: string[] = [];\n  const warnings: string[] = [];\n\n  if (!message.text.body || message.text.body.trim().length === 0) {\n    errors.push('Text message body cannot be empty');\n  }\n\n  if (message.text.body && message.text.body.length > 4096) {\n    errors.push('Text message body cannot exceed 4096 characters');\n  }\n\n  return { isValid: errors.length === 0, errors, warnings };\n}\n\nexport function validateInteractiveMessage(message: InteractiveMessage): MessageValidationResult {\n  const errors: string[] = [];\n  const warnings: string[] = [];\n\n  if (!message.interactive.body.text || message.interactive.body.text.trim().length === 0) {\n    errors.push('Interactive message body cannot be empty');\n  }\n\n  if (message.interactive.type === 'button') {\n    const action = message.interactive.action as InteractiveButtonAction;\n    if (!action.buttons || action.buttons.length === 0) {\n      errors.push('Button interactive message must have at least one button');\n    } else if (action.buttons.length > 3) {\n      errors.push('Button interactive message cannot have more than 3 buttons');\n    }\n\n    action.buttons?.forEach((button, index) => {\n      if (!button.reply.id || !button.reply.title) {\n        errors.push(`Button ${index + 1} must have both id and title`);\n      }\n      if (button.reply.title.length > 20) {\n        warnings.push(`Button ${index + 1} title should not exceed 20 characters`);\n      }\n    });\n  }\n\n  if (message.interactive.type === 'list') {\n    const action = message.interactive.action as InteractiveListAction;\n    if (!action.sections || action.sections.length === 0) {\n      errors.push('List interactive message must have at least one section');\n    } else if (action.sections.length > 10) {\n      errors.push('List interactive message cannot have more than 10 sections');\n    }\n\n    if (!action.button) {\n      errors.push('List interactive message must have a button text');\n    }\n\n    action.sections?.forEach((section, sectionIndex) => {\n      if (!section.rows || section.rows.length === 0) {\n        errors.push(`Section ${sectionIndex + 1} must have at least one row`);\n      } else if (section.rows.length > 10) {\n        errors.push(`Section ${sectionIndex + 1} cannot have more than 10 rows`);\n      }\n\n      section.rows?.forEach((row, rowIndex) => {\n        if (!row.id || !row.title) {\n          errors.push(`Section ${sectionIndex + 1}, Row ${rowIndex + 1} must have both id and title`);\n        }\n      });\n    });\n  }\n\n  return { isValid: errors.length === 0, errors, warnings };\n}\n\n// Constants\nexport const MESSAGE_TYPES = [\n  'text',\n  'image',\n  'document',\n  'audio',\n  'video',\n  'location',\n  'contacts',\n  'template',\n  'interactive',\n  'reaction',\n  'sticker'\n] as const;\n\nexport const MEDIA_MESSAGE_TYPES = [\n  'image',\n  'document',\n  'audio',\n  'video',\n  'sticker'\n] as const;\n\nexport const INTERACTIVE_TYPES = [\n  'button',\n  'list'\n] as const;\n\n// Export commonly used types with shorter names\nexport type {\n  WhatsAppOutgoingMessage as OutgoingMessage,\n  TextMessage as Text,\n  ImageMessage as Image,\n  InteractiveMessage as Interactive,\n  TemplateMessageRequest as Template\n};\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/types/whatsapp-service-config.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'key' is defined but never used. Allowed unused args must match /^_/u.","line":156,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":156,"endColumn":20,"suggestions":[{"messageId":"removeVar","data":{"varName":"key"},"fix":{"range":[4631,4642],"text":""},"desc":"Remove unused variable 'key'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'key' is defined but never used. Allowed unused args must match /^_/u.","line":158,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":158,"endColumn":20,"suggestions":[{"messageId":"removeVar","data":{"varName":"key"},"fix":{"range":[4698,4710],"text":""},"desc":"Remove unused variable 'key'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'value' is defined but never used. Allowed unused args must match /^_/u.","line":158,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":158,"endColumn":30,"suggestions":[{"messageId":"removeVar","data":{"varName":"value"},"fix":{"range":[4709,4719],"text":""},"desc":"Remove unused variable 'value'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'ttl' is defined but never used. Allowed unused args must match /^_/u.","line":158,"column":32,"nodeType":"Identifier","messageId":"unusedVar","endLine":158,"endColumn":44,"suggestions":[{"messageId":"removeVar","data":{"varName":"ttl"},"fix":{"range":[4719,4733],"text":""},"desc":"Remove unused variable 'ttl'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'key' is defined but never used. Allowed unused args must match /^_/u.","line":160,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":160,"endColumn":23,"suggestions":[{"messageId":"removeVar","data":{"varName":"key"},"fix":{"range":[4788,4799],"text":""},"desc":"Remove unused variable 'key'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'message' is defined but never used. Allowed unused args must match /^_/u.","line":200,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":200,"endColumn":26,"suggestions":[{"messageId":"removeVar","data":{"varName":"message"},"fix":{"range":[5753,5769],"text":""},"desc":"Remove unused variable 'message'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'context' is defined but never used. Allowed unused args must match /^_/u.","line":200,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":200,"endColumn":61,"suggestions":[{"messageId":"removeVar","data":{"varName":"context"},"fix":{"range":[5768,5803],"text":""},"desc":"Remove unused variable 'context'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'message' is defined but never used. Allowed unused args must match /^_/u.","line":202,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":202,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"message"},"fix":{"range":[5849,5865],"text":""},"desc":"Remove unused variable 'message'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'context' is defined but never used. Allowed unused args must match /^_/u.","line":202,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":202,"endColumn":60,"suggestions":[{"messageId":"removeVar","data":{"varName":"context"},"fix":{"range":[5864,5899],"text":""},"desc":"Remove unused variable 'context'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'message' is defined but never used. Allowed unused args must match /^_/u.","line":204,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":204,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"message"},"fix":{"range":[5948,5964],"text":""},"desc":"Remove unused variable 'message'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'context' is defined but never used. Allowed unused args must match /^_/u.","line":204,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":204,"endColumn":60,"suggestions":[{"messageId":"removeVar","data":{"varName":"context"},"fix":{"range":[5963,5998],"text":""},"desc":"Remove unused variable 'context'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'message' is defined but never used. Allowed unused args must match /^_/u.","line":206,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":206,"endColumn":26,"suggestions":[{"messageId":"removeVar","data":{"varName":"message"},"fix":{"range":[6046,6062],"text":""},"desc":"Remove unused variable 'message'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used. Allowed unused args must match /^_/u.","line":206,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":206,"endColumn":41,"suggestions":[{"messageId":"removeVar","data":{"varName":"error"},"fix":{"range":[6061,6076],"text":""},"desc":"Remove unused variable 'error'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'context' is defined but never used. Allowed unused args must match /^_/u.","line":206,"column":43,"nodeType":"Identifier","messageId":"unusedVar","endLine":206,"endColumn":76,"suggestions":[{"messageId":"removeVar","data":{"varName":"context"},"fix":{"range":[6076,6111],"text":""},"desc":"Remove unused variable 'context'."}]},{"ruleId":"no-implicit-coercion","severity":2,"message":"Unexpected implicit coercion encountered. Use `Boolean(config.accessToken &&\n    config.phoneNumberId &&\n    config.verifyToken &&\n    typeof config.accessToken === 'string' &&\n    typeof config.phoneNumberId === 'string' &&\n    typeof config.verifyToken === 'string')` instead.","line":303,"column":10,"nodeType":"UnaryExpression","messageId":"implicitCoercion","endLine":310,"endColumn":4,"fix":{"range":[8336,8560],"text":"Boolean(config.accessToken &&\n    config.phoneNumberId &&\n    config.verifyToken &&\n    typeof config.accessToken === 'string' &&\n    typeof config.phoneNumberId === 'string' &&\n    typeof config.verifyToken === 'string')"}},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 300000.","line":318,"column":71,"nodeType":"Literal","messageId":"noMagic","endLine":318,"endColumn":77},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 10.","line":322,"column":68,"nodeType":"Literal","messageId":"noMagic","endLine":322,"endColumn":70}],"suppressedMessages":[],"errorCount":17,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"/**\n * WhatsApp Service Configuration Types\n *\n * This module provides type definitions for WhatsApp service configuration,\n * service options, and environment-specific configurations.\n */\n\n// ==================== Basic Configuration Types ====================\n\n/**\n * WhatsApp API Configuration\n * Core configuration required for WhatsApp Business API integration\n */\nexport interface WhatsAppConfig {\n  /** Access token for WhatsApp Business API */\n  accessToken: string;\n  /** Phone number ID from WhatsApp Business Account */\n  phoneNumberId: string;\n  /** Verification token for webhook validation */\n  verifyToken: string;\n  /** Webhook URL for receiving messages (optional) */\n  webhookUrl?: string;\n  /** API version to use (optional, defaults to latest) */\n  apiVersion?: string;\n  /** Business Account ID (optional) */\n  businessAccountId?: string;\n  /** App secret for additional security (optional) */\n  appSecret?: string;\n}\n\n/**\n * WhatsApp Service Options\n * Optional configuration for service behavior and performance tuning\n */\nexport interface WhatsAppServiceOptions {\n  /** Request timeout in milliseconds (default: 30000) */\n  timeout?: number;\n  /** Maximum number of retry attempts (default: 3) */\n  retries?: number;\n  /** Initial retry delay in milliseconds (default: 1000) */\n  retryDelay?: number;\n  /** Maximum retry delay in milliseconds (default: 10000) */\n  maxRetryDelay?: number;\n  /** Retry delay multiplier for exponential backoff (default: 2) */\n  retryMultiplier?: number;\n  /** Enable service logging (default: true) */\n  enableLogging?: boolean;\n  /** Logging level (default: 'info') */\n  logLevel?: 'debug' | 'info' | 'warn' | 'error';\n  /** Enable message validation before sending (default: true) */\n  validateMessages?: boolean;\n  /** Rate limiting strategy (default: 'exponential') */\n  rateLimitStrategy?: 'exponential' | 'linear' | 'fixed';\n  /** Maximum rate limit attempts (default: 5) */\n  rateLimitMaxAttempts?: number;\n}\n\n/**\n * Environment-specific Configuration\n * Allows different configurations for different environments\n */\nexport interface ServiceEnvironmentConfig {\n  /** Development environment configuration */\n  development: WhatsAppConfig;\n  /** Staging environment configuration */\n  staging: WhatsAppConfig;\n  /** Production environment configuration */\n  production: WhatsAppConfig;\n}\n\n// ==================== Retry and Circuit Breaker Configuration ====================\n\n/**\n * Retry Configuration\n * Configuration for retry logic and exponential backoff\n */\nexport interface RetryConfig {\n  /** Maximum number of retry attempts */\n  maxAttempts: number;\n  /** Base delay between retries in milliseconds */\n  baseDelay: number;\n  /** Maximum delay between retries in milliseconds */\n  maxDelay: number;\n  /** Multiplier for exponential backoff */\n  multiplier: number;\n  /** Add random jitter to prevent thundering herd */\n  jitter: boolean;\n}\n\n/**\n * Circuit Breaker Configuration\n * Configuration for circuit breaker pattern implementation\n */\nexport interface CircuitBreakerConfig {\n  /** Number of failures before opening circuit */\n  failureThreshold: number;\n  /** Time to wait before attempting recovery in milliseconds */\n  recoveryTimeout: number;\n  /** Period for monitoring failures in milliseconds */\n  monitoringPeriod: number;\n  /** List of expected error types that should trigger circuit breaker */\n  expectedErrors: string[];\n}\n\n/**\n * Circuit Breaker State\n * Current state of the circuit breaker\n */\nexport interface CircuitBreakerState {\n  /** Current circuit state */\n  state: 'closed' | 'open' | 'half-open';\n  /** Current failure count */\n  failureCount: number;\n  /** Timestamp of last failure */\n  lastFailureTime?: number;\n  /** Timestamp when next attempt is allowed */\n  nextAttemptTime?: number;\n}\n\n// ==================== Cache Configuration ====================\n\n/**\n * Cache Configuration\n * Configuration for caching mechanisms\n */\nexport interface CacheConfig {\n  /** Time to live in milliseconds */\n  ttl: number;\n  /** Maximum number of entries in cache */\n  maxSize: number;\n  /** Cache eviction strategy */\n  strategy: 'lru' | 'fifo' | 'lfu';\n}\n\n/**\n * Cache Entry\n * Individual cache entry with metadata\n */\nexport interface CacheEntry<T> {\n  /** Cached value */\n  value: T;\n  /** Timestamp when entry was created */\n  timestamp: number;\n  /** Time to live for this entry */\n  ttl: number;\n  /** Number of times this entry has been accessed */\n  accessCount: number;\n}\n\n/**\n * Cache Interface\n * Generic cache interface for different cache implementations\n */\nexport interface Cache<T> {\n  /** Get value from cache */\n  get: (key: string) => T | undefined;\n  /** Set value in cache */\n  set: (key: string, value: T, ttl?: number) => void;\n  /** Delete value from cache */\n  delete: (key: string) => boolean;\n  /** Clear all cache entries */\n  clear: () => void;\n  /** Get current cache size */\n  size: () => number;\n  /** Get all cache keys */\n  keys: () => string[];\n}\n\n// ==================== Logging Configuration ====================\n\n/**\n * Log Entry\n * Structure for individual log entries\n */\nexport interface LogEntry {\n  /** Timestamp of log entry */\n  timestamp: number;\n  /** Log level */\n  level: 'debug' | 'info' | 'warn' | 'error';\n  /** Log message */\n  message: string;\n  /** Additional context data */\n  context?: Record<string, unknown>;\n  /** Error object if applicable */\n  error?: Error;\n  /** Trace ID for request tracking */\n  traceId?: string;\n  /** Phone number ID for WhatsApp context */\n  phoneNumberId?: string;\n  /** Message ID for message-specific logs */\n  messageId?: string;\n}\n\n/**\n * Logger Interface\n * Standard logging interface for the service\n */\nexport interface Logger {\n  /** Log debug message */\n  debug: (message: string, context?: Record<string, unknown>) => void;\n  /** Log info message */\n  info: (message: string, context?: Record<string, unknown>) => void;\n  /** Log warning message */\n  warn: (message: string, context?: Record<string, unknown>) => void;\n  /** Log error message */\n  error: (message: string, error?: Error, context?: Record<string, unknown>) => void;\n}\n\n// ==================== Utility Types ====================\n\n/**\n * Message Type Enumeration\n * All supported WhatsApp message types\n */\nexport type MessageType = \n  | 'text' \n  | 'image' \n  | 'document' \n  | 'audio' \n  | 'video' \n  | 'location' \n  | 'contacts' \n  | 'template' \n  | 'interactive';\n\n/**\n * Message Status Enumeration\n * All possible message delivery statuses\n */\nexport type MessageStatus = 'sent' | 'delivered' | 'read' | 'failed';\n\n/**\n * Service Environment Enumeration\n * Supported deployment environments\n */\nexport type ServiceEnvironment = 'development' | 'staging' | 'production';\n\n/**\n * Log Level Enumeration\n * Supported logging levels\n */\nexport type LogLevel = 'debug' | 'info' | 'warn' | 'error';\n\n// ==================== Default Configurations ====================\n\n/**\n * Default Service Options\n * Sensible defaults for WhatsApp service configuration\n */\nexport const DEFAULT_SERVICE_OPTIONS: Required<WhatsAppServiceOptions> = {\n  timeout: 30000,\n  retries: 3,\n  retryDelay: 1000,\n  maxRetryDelay: 10000,\n  retryMultiplier: 2,\n  enableLogging: true,\n  logLevel: 'info',\n  validateMessages: true,\n  rateLimitStrategy: 'exponential',\n  rateLimitMaxAttempts: 5\n};\n\n/**\n * Default Retry Configuration\n * Sensible defaults for retry logic\n */\nexport const DEFAULT_RETRY_CONFIG: RetryConfig = {\n  maxAttempts: 3,\n  baseDelay: 1000,\n  maxDelay: 10000,\n  multiplier: 2,\n  jitter: true\n};\n\n/**\n * Default Circuit Breaker Configuration\n * Sensible defaults for circuit breaker pattern\n */\nexport const DEFAULT_CIRCUIT_BREAKER_CONFIG: CircuitBreakerConfig = {\n  failureThreshold: 5,\n  recoveryTimeout: 60000,\n  monitoringPeriod: 10000,\n  expectedErrors: ['WhatsAppRateLimitError', 'WhatsAppNetworkError']\n};\n\n/**\n * Default Cache Configuration\n * Sensible defaults for caching\n */\nexport const DEFAULT_CACHE_CONFIG: CacheConfig = {\n  ttl: 300000, // 5 minutes\n  maxSize: 1000,\n  strategy: 'lru'\n};\n\n// ==================== Configuration Validation ====================\n\n/**\n * Validate WhatsApp Configuration\n * Ensures all required configuration fields are present and valid\n */\nexport function validateWhatsAppConfig(config: Partial<WhatsAppConfig>): config is WhatsAppConfig {\n  return !!(\n    config.accessToken &&\n    config.phoneNumberId &&\n    config.verifyToken &&\n    typeof config.accessToken === 'string' &&\n    typeof config.phoneNumberId === 'string' &&\n    typeof config.verifyToken === 'string'\n  );\n}\n\n/**\n * Validate Service Options\n * Ensures service options are within acceptable ranges\n */\nexport function validateServiceOptions(options: WhatsAppServiceOptions): boolean {\n  if (options.timeout && (options.timeout < 1000 || options.timeout > 300000)) {\n    return false; // Timeout should be between 1s and 5min\n  }\n  \n  if (options.retries && (options.retries < 0 || options.retries > 10)) {\n    return false; // Retries should be between 0 and 10\n  }\n  \n  if (options.retryDelay && options.retryDelay < 100) {\n    return false; // Retry delay should be at least 100ms\n  }\n  \n  return true;\n}\n\n/**\n * Merge Configuration with Defaults\n * Combines user configuration with default values\n */\nexport function mergeWithDefaults(\n  config: WhatsAppConfig,\n  options?: WhatsAppServiceOptions\n): { config: WhatsAppConfig; options: Required<WhatsAppServiceOptions> } {\n  return {\n    config: {\n      apiVersion: 'v18.0',\n      ...config\n    },\n    options: {\n      ...DEFAULT_SERVICE_OPTIONS,\n      ...options\n    }\n  };\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/types/whatsapp-service-errors.ts","messages":[{"ruleId":"max-params","severity":2,"message":"Constructor has too many parameters (5). Maximum allowed is 3.","line":27,"column":3,"nodeType":"FunctionExpression","messageId":"exceed","endLine":27,"endColumn":14},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 429.","line":67,"column":23,"nodeType":"Literal","messageId":"noMagic","endLine":67,"endColumn":26},{"ruleId":"max-params","severity":2,"message":"Constructor has too many parameters (4). Maximum allowed is 3.","line":98,"column":3,"nodeType":"FunctionExpression","messageId":"exceed","endLine":98,"endColumn":14},{"ruleId":"max-params","severity":2,"message":"Constructor has too many parameters (4). Maximum allowed is 3.","line":203,"column":3,"nodeType":"FunctionExpression","messageId":"exceed","endLine":203,"endColumn":14},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 429.","line":209,"column":20,"nodeType":"Literal","messageId":"noMagic","endLine":209,"endColumn":23},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 60.","line":232,"column":32,"nodeType":"Literal","messageId":"noMagic","endLine":232,"endColumn":34},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 429.","line":413,"column":18,"nodeType":"Literal","messageId":"noMagic","endLine":413,"endColumn":21}],"suppressedMessages":[],"errorCount":7,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * WhatsApp Service Error Types and Classes\n *\n * This module provides comprehensive error handling types and classes\n * for WhatsApp Business API integration, including specific error types\n * for different failure scenarios.\n */\n\n// ==================== Base Error Class ====================\n\n/**\n * Base WhatsApp Error Class\n * All WhatsApp-related errors extend from this base class\n */\nexport class WhatsAppError extends Error {\n  /** HTTP status code or custom error code */\n  public readonly code: number;\n  /** Error type identifier */\n  public readonly type: string;\n  /** Additional error subcode for more specific error identification */\n  public readonly subcode?: number;\n  /** Trace ID for request tracking */\n  public readonly traceId?: string;\n  /** Timestamp when error occurred */\n  public readonly timestamp: number;\n\n  constructor(\n    message: string,\n    code: number = 500,\n    type: string = 'WhatsAppError',\n    subcode?: number,\n    traceId?: string\n  ) {\n    super(message);\n    this.name = 'WhatsAppError';\n    this.code = code;\n    this.type = type;\n    this.subcode = subcode;\n    this.traceId = traceId;\n    this.timestamp = Date.now();\n\n    // Ensure proper prototype chain for instanceof checks\n    Object.setPrototypeOf(this, WhatsAppError.prototype);\n  }\n\n  /**\n   * Convert error to JSON for logging and serialization\n   */\n  toJSON() {\n    return {\n      name: this.name,\n      message: this.message,\n      code: this.code,\n      type: this.type,\n      subcode: this.subcode,\n      traceId: this.traceId,\n      timestamp: this.timestamp,\n      stack: this.stack\n    };\n  }\n\n  /**\n   * Check if error is retryable based on error type and code\n   */\n  isRetryable(): boolean {\n    // Rate limit errors are retryable\n    if (this.code === 429) return true;\n\n    // Network errors are retryable\n    if (this.code >= 500) return true;\n\n    // Timeout errors are retryable\n    if (this.type === 'NetworkError' && this instanceof WhatsAppNetworkError) {\n      return this.isTimeout === true;\n    }\n\n    return false;\n  }\n}\n\n// ==================== Specific Error Classes ====================\n\n/**\n * WhatsApp API Error\n * Errors returned directly from WhatsApp Business API\n */\nexport class WhatsAppApiError extends WhatsAppError {\n  /** Original API error details */\n  public readonly apiError?: {\n    error_data?: {\n      messaging_product: string;\n      details: string;\n    };\n    error_subcode?: number;\n    fbtrace_id?: string;\n  };\n\n  constructor(\n    message: string,\n    code: number,\n    apiError?: WhatsAppApiError['apiError'],\n    traceId?: string\n  ) {\n    super(\n      message,\n      code,\n      'ApiError',\n      apiError?.error_subcode,\n      traceId || apiError?.fbtrace_id\n    );\n    this.name = 'WhatsAppApiError';\n    this.apiError = apiError;\n  }\n\n  /**\n   * Convert to JSON with API error details\n   */\n  toJSON() {\n    return {\n      ...super.toJSON(),\n      apiError: this.apiError\n    };\n  }\n\n  /**\n   * Get detailed error message including API details\n   */\n  getDetailedMessage(): string {\n    if (this.apiError?.error_data?.details) {\n      return `${this.message}: ${this.apiError.error_data.details}`;\n    }\n    return this.message;\n  }\n}\n\n/**\n * WhatsApp Validation Error\n * Errors related to invalid input data or configuration\n */\nexport class WhatsAppValidationError extends WhatsAppError {\n  /** Field that failed validation */\n  public readonly field?: string;\n  /** Value that failed validation */\n  public readonly value?: unknown;\n\n  constructor(\n    message: string,\n    field?: string,\n    value?: unknown\n  ) {\n    super(message, 400, 'ValidationError');\n    this.name = 'WhatsAppValidationError';\n    this.field = field;\n    this.value = value;\n  }\n\n  /**\n   * Convert to JSON with validation details\n   */\n  toJSON() {\n    return {\n      ...super.toJSON(),\n      field: this.field,\n      value: this.value\n    };\n  }\n\n  /**\n   * Create validation error for specific field\n   */\n  static forField(field: string, value: unknown, reason: string): WhatsAppValidationError {\n    return new WhatsAppValidationError(\n      `Validation failed for field '${field}': ${reason}`,\n      field,\n      value\n    );\n  }\n\n  /**\n   * Create validation error for required field\n   */\n  static requiredField(field: string): WhatsAppValidationError {\n    return new WhatsAppValidationError(\n      `Required field '${field}' is missing`,\n      field,\n      undefined\n    );\n  }\n}\n\n/**\n * WhatsApp Rate Limit Error\n * Errors related to API rate limiting\n */\nexport class WhatsAppRateLimitError extends WhatsAppError {\n  /** Seconds to wait before retrying */\n  public readonly retryAfter?: number;\n  /** Rate limit quota */\n  public readonly limit?: number;\n  /** Remaining requests in current window */\n  public readonly remaining?: number;\n\n  constructor(\n    message: string,\n    retryAfter?: number,\n    limit?: number,\n    remaining?: number\n  ) {\n    super(message, 429, 'RateLimitError');\n    this.name = 'WhatsAppRateLimitError';\n    this.retryAfter = retryAfter;\n    this.limit = limit;\n    this.remaining = remaining;\n  }\n\n  /**\n   * Convert to JSON with rate limit details\n   */\n  toJSON() {\n    return {\n      ...super.toJSON(),\n      retryAfter: this.retryAfter,\n      limit: this.limit,\n      remaining: this.remaining\n    };\n  }\n\n  /**\n   * Get retry delay in milliseconds\n   */\n  getRetryDelay(): number {\n    return (this.retryAfter || 60) * 1000; // Default to 60 seconds\n  }\n\n  /**\n   * Check if rate limit has expired\n   */\n  canRetryNow(): boolean {\n    if (!this.retryAfter) return true;\n    return Date.now() - this.timestamp >= this.getRetryDelay();\n  }\n}\n\n/**\n * WhatsApp Network Error\n * Errors related to network connectivity and timeouts\n */\nexport class WhatsAppNetworkError extends WhatsAppError {\n  /** Original network error */\n  public readonly originalError?: Error;\n  /** Whether this was a timeout error */\n  public readonly isTimeout?: boolean;\n\n  constructor(\n    message: string,\n    originalError?: Error,\n    isTimeout?: boolean\n  ) {\n    super(message, 500, 'NetworkError');\n    this.name = 'WhatsAppNetworkError';\n    this.originalError = originalError;\n    this.isTimeout = isTimeout;\n  }\n\n  /**\n   * Convert to JSON with network error details\n   */\n  toJSON() {\n    return {\n      ...super.toJSON(),\n      originalError: this.originalError?.message,\n      isTimeout: this.isTimeout\n    };\n  }\n\n  /**\n   * Create timeout error\n   */\n  static timeout(timeoutMs: number): WhatsAppNetworkError {\n    return new WhatsAppNetworkError(\n      `Request timed out after ${timeoutMs}ms`,\n      undefined,\n      true\n    );\n  }\n\n  /**\n   * Create connection error\n   */\n  static connection(originalError: Error): WhatsAppNetworkError {\n    return new WhatsAppNetworkError(\n      `Network connection failed: ${originalError.message}`,\n      originalError,\n      false\n    );\n  }\n}\n\n/**\n * WhatsApp Authentication Error\n * Errors related to authentication and authorization\n */\nexport class WhatsAppAuthError extends WhatsAppError {\n  /** Whether the token has expired */\n  public readonly tokenExpired?: boolean;\n  /** Whether the token is invalid */\n  public readonly tokenInvalid?: boolean;\n\n  constructor(\n    message: string,\n    tokenExpired?: boolean,\n    tokenInvalid?: boolean\n  ) {\n    super(message, 401, 'AuthError');\n    this.name = 'WhatsAppAuthError';\n    this.tokenExpired = tokenExpired;\n    this.tokenInvalid = tokenInvalid;\n  }\n\n  /**\n   * Convert to JSON with auth details\n   */\n  toJSON() {\n    return {\n      ...super.toJSON(),\n      tokenExpired: this.tokenExpired,\n      tokenInvalid: this.tokenInvalid\n    };\n  }\n\n  /**\n   * Create expired token error\n   */\n  static expiredToken(): WhatsAppAuthError {\n    return new WhatsAppAuthError(\n      'Access token has expired',\n      true,\n      false\n    );\n  }\n\n  /**\n   * Create invalid token error\n   */\n  static invalidToken(): WhatsAppAuthError {\n    return new WhatsAppAuthError(\n      'Access token is invalid',\n      false,\n      true\n    );\n  }\n}\n\n// ==================== Error Type Guards ====================\n\n/**\n * Check if error is a WhatsApp error\n */\nexport function isWhatsAppError(error: unknown): error is WhatsAppError {\n  return error instanceof WhatsAppError;\n}\n\n/**\n * Check if error is a WhatsApp API error\n */\nexport function isWhatsAppApiError(error: unknown): error is WhatsAppApiError {\n  return error instanceof WhatsAppApiError;\n}\n\n/**\n * Check if error is a WhatsApp validation error\n */\nexport function isWhatsAppValidationError(error: unknown): error is WhatsAppValidationError {\n  return error instanceof WhatsAppValidationError;\n}\n\n/**\n * Check if error is a WhatsApp rate limit error\n */\nexport function isWhatsAppRateLimitError(error: unknown): error is WhatsAppRateLimitError {\n  return error instanceof WhatsAppRateLimitError;\n}\n\n/**\n * Check if error is a WhatsApp network error\n */\nexport function isWhatsAppNetworkError(error: unknown): error is WhatsAppNetworkError {\n  return error instanceof WhatsAppNetworkError;\n}\n\n/**\n * Check if error is a WhatsApp authentication error\n */\nexport function isWhatsAppAuthError(error: unknown): error is WhatsAppAuthError {\n  return error instanceof WhatsAppAuthError;\n}\n\n// ==================== Error Utilities ====================\n\n/**\n * Create error from API response\n */\nexport function createErrorFromApiResponse(\n  response: { status: number; data?: Record<string, unknown> },\n  traceId?: string\n): WhatsAppError {\n  const { status, data } = response;\n\n  if (status === 401) {\n    return WhatsAppAuthError.invalidToken();\n  }\n\n  if (status === 429) {\n    const retryAfter = data?.error?.retry_after;\n    return new WhatsAppRateLimitError(\n      'Rate limit exceeded',\n      retryAfter\n    );\n  }\n\n  if (data?.error) {\n    return new WhatsAppApiError(\n      data.error.message || 'API Error',\n      status,\n      data.error,\n      traceId\n    );\n  }\n\n  return new WhatsAppError(\n    `HTTP ${status} Error`,\n    status,\n    'HttpError',\n    undefined,\n    traceId\n  );\n}\n\n/**\n * Get error severity level\n */\nexport function getErrorSeverity(error: WhatsAppError): 'low' | 'medium' | 'high' | 'critical' {\n  if (error instanceof WhatsAppAuthError) return 'critical';\n  if (error instanceof WhatsAppValidationError) return 'medium';\n  if (error instanceof WhatsAppRateLimitError) return 'medium';\n  if (error instanceof WhatsAppNetworkError) return error.isTimeout ? 'medium' : 'high';\n  if (error instanceof WhatsAppApiError) {\n    return error.code >= 500 ? 'high' : 'medium';\n  }\n  return 'medium';\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/types/whatsapp-service-interface.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'config' is defined but never used. Allowed unused args must match /^_/u.","line":42,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":42,"endColumn":38,"suggestions":[{"messageId":"removeVar","data":{"varName":"config"},"fix":{"range":[1030,1053],"text":""},"desc":"Remove unused variable 'config'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'options' is defined but never used. Allowed unused args must match /^_/u.","line":42,"column":40,"nodeType":"Identifier","messageId":"unusedVar","endLine":42,"endColumn":72,"suggestions":[{"messageId":"removeVar","data":{"varName":"options"},"fix":{"range":[1052,1086],"text":""},"desc":"Remove unused variable 'options'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'request' is defined but never used. Allowed unused args must match /^_/u.","line":74,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":74,"endColumn":33,"suggestions":[{"messageId":"removeVar","data":{"varName":"request"},"fix":{"range":[1821,1837],"text":""},"desc":"Remove unused variable 'request'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'requests' is defined but never used. Allowed unused args must match /^_/u.","line":81,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":81,"endColumn":41,"suggestions":[{"messageId":"removeVar","data":{"varName":"requests"},"fix":{"range":[2050,2069],"text":""},"desc":"Remove unused variable 'requests'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'to' is defined but never used. Allowed unused args must match /^_/u.","line":89,"column":21,"nodeType":"Identifier","messageId":"unusedVar","endLine":89,"endColumn":31,"suggestions":[{"messageId":"removeVar","data":{"varName":"to"},"fix":{"range":[2278,2289],"text":""},"desc":"Remove unused variable 'to'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'text' is defined but never used. Allowed unused args must match /^_/u.","line":89,"column":33,"nodeType":"Identifier","messageId":"unusedVar","endLine":89,"endColumn":45,"suggestions":[{"messageId":"removeVar","data":{"varName":"text"},"fix":{"range":[2288,2302],"text":""},"desc":"Remove unused variable 'text'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'to' is defined but never used. Allowed unused args must match /^_/u.","line":99,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":99,"endColumn":15,"suggestions":[{"messageId":"removeVar","data":{"varName":"to"},"fix":{"range":[2578,2589],"text":""},"desc":"Remove unused variable 'to'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'templateName' is defined but never used. Allowed unused args must match /^_/u.","line":100,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":100,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"templateName"},"fix":{"range":[2588,2615],"text":""},"desc":"Remove unused variable 'templateName'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'templateData' is defined but never used. Allowed unused args must match /^_/u.","line":101,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":101,"endColumn":43,"suggestions":[{"messageId":"removeVar","data":{"varName":"templateData"},"fix":{"range":[2615,2660],"text":""},"desc":"Remove unused variable 'templateData'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'file' is defined but never used. Allowed unused args must match /^_/u.","line":112,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":112,"endColumn":36,"suggestions":[{"messageId":"removeVar","data":{"varName":"file"},"fix":{"range":[2955,2975],"text":""},"desc":"Remove unused variable 'file'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'type' is defined but never used. Allowed unused args must match /^_/u.","line":112,"column":38,"nodeType":"Identifier","messageId":"unusedVar","endLine":112,"endColumn":50,"suggestions":[{"messageId":"removeVar","data":{"varName":"type"},"fix":{"range":[2974,2988],"text":""},"desc":"Remove unused variable 'type'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'mediaId' is defined but never used. Allowed unused args must match /^_/u.","line":119,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":119,"endColumn":32,"suggestions":[{"messageId":"removeVar","data":{"varName":"mediaId"},"fix":{"range":[3170,3185],"text":""},"desc":"Remove unused variable 'mediaId'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'url' is defined but never used. Allowed unused args must match /^_/u.","line":126,"column":19,"nodeType":"Identifier","messageId":"unusedVar","endLine":126,"endColumn":30,"suggestions":[{"messageId":"removeVar","data":{"varName":"url"},"fix":{"range":[3354,3365],"text":""},"desc":"Remove unused variable 'url'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'phoneNumber' is defined but never used. Allowed unused args must match /^_/u.","line":135,"column":25,"nodeType":"Identifier","messageId":"unusedVar","endLine":135,"endColumn":44,"suggestions":[{"messageId":"removeVar","data":{"varName":"phoneNumber"},"fix":{"range":[3619,3638],"text":""},"desc":"Remove unused variable 'phoneNumber'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'phoneNumber' is defined but never used. Allowed unused args must match /^_/u.","line":142,"column":23,"nodeType":"Identifier","messageId":"unusedVar","endLine":142,"endColumn":42,"suggestions":[{"messageId":"removeVar","data":{"varName":"phoneNumber"},"fix":{"range":[3819,3838],"text":""},"desc":"Remove unused variable 'phoneNumber'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'message' is defined but never used. Allowed unused args must match /^_/u.","line":149,"column":21,"nodeType":"Identifier","messageId":"unusedVar","endLine":149,"endColumn":37,"suggestions":[{"messageId":"removeVar","data":{"varName":"message"},"fix":{"range":[4004,4020],"text":""},"desc":"Remove unused variable 'message'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'event' is defined but never used. Allowed unused args must match /^_/u.","line":158,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":158,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"event"},"fix":{"range":[4220,4234],"text":""},"desc":"Remove unused variable 'event'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'listener' is defined but never used. Allowed unused args must match /^_/u.","line":158,"column":23,"nodeType":"Identifier","messageId":"unusedVar","endLine":158,"endColumn":56,"suggestions":[{"messageId":"removeVar","data":{"varName":"listener"},"fix":{"range":[4233,4268],"text":""},"desc":"Remove unused variable 'listener'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'data' is defined but never used. Allowed unused args must match /^_/u.","line":158,"column":34,"nodeType":"Identifier","messageId":"unusedVar","endLine":158,"endColumn":47,"suggestions":[{"messageId":"removeVar","data":{"varName":"data"},"fix":{"range":[4246,4259],"text":""},"desc":"Remove unused variable 'data'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'event' is defined but never used. Allowed unused args must match /^_/u.","line":165,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":165,"endColumn":22,"suggestions":[{"messageId":"removeVar","data":{"varName":"event"},"fix":{"range":[4417,4431],"text":""},"desc":"Remove unused variable 'event'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'listener' is defined but never used. Allowed unused args must match /^_/u.","line":165,"column":24,"nodeType":"Identifier","messageId":"unusedVar","endLine":165,"endColumn":57,"suggestions":[{"messageId":"removeVar","data":{"varName":"listener"},"fix":{"range":[4430,4465],"text":""},"desc":"Remove unused variable 'listener'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'data' is defined but never used. Allowed unused args must match /^_/u.","line":165,"column":35,"nodeType":"Identifier","messageId":"unusedVar","endLine":165,"endColumn":48,"suggestions":[{"messageId":"removeVar","data":{"varName":"data"},"fix":{"range":[4443,4456],"text":""},"desc":"Remove unused variable 'data'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'event' is defined but never used. Allowed unused args must match /^_/u.","line":172,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":172,"endColumn":23,"suggestions":[{"messageId":"removeVar","data":{"varName":"event"},"fix":{"range":[4577,4591],"text":""},"desc":"Remove unused variable 'event'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'data' is defined but never used. Allowed unused args must match /^_/u.","line":172,"column":25,"nodeType":"Identifier","messageId":"unusedVar","endLine":172,"endColumn":38,"suggestions":[{"messageId":"removeVar","data":{"varName":"data"},"fix":{"range":[4590,4605],"text":""},"desc":"Remove unused variable 'data'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'payload' is defined but never used. Allowed unused args must match /^_/u.","line":278,"column":31,"nodeType":"Identifier","messageId":"unusedVar","endLine":278,"endColumn":47,"suggestions":[{"messageId":"removeVar","data":{"varName":"payload"},"fix":{"range":[6861,6877],"text":""},"desc":"Remove unused variable 'payload'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'config' is defined but never used. Allowed unused args must match /^_/u.","line":318,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":318,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"config"},"fix":{"range":[7834,7857],"text":""},"desc":"Remove unused variable 'config'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'options' is defined but never used. Allowed unused args must match /^_/u.","line":319,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":319,"endColumn":35,"suggestions":[{"messageId":"removeVar","data":{"varName":"options"},"fix":{"range":[7856,7892],"text":""},"desc":"Remove unused variable 'options'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'config' is defined but never used. Allowed unused args must match /^_/u.","line":328,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":328,"endColumn":38,"suggestions":[{"messageId":"removeVar","data":{"varName":"config"},"fix":{"range":[8083,8105],"text":""},"desc":"Remove unused variable 'config'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'options' is defined but never used. Allowed unused args must match /^_/u.","line":330,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":330,"endColumn":48,"suggestions":[{"messageId":"removeVar","data":{"varName":"options"},"fix":{"range":[8163,8194],"text":""},"desc":"Remove unused variable 'options'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'env' is defined but never used. Allowed unused args must match /^_/u.","line":332,"column":21,"nodeType":"Identifier","messageId":"unusedVar","endLine":332,"endColumn":44,"suggestions":[{"messageId":"removeVar","data":{"varName":"env"},"fix":{"range":[8260,8283],"text":""},"desc":"Remove unused variable 'env'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'level' is defined but never used. Allowed unused args must match /^_/u.","line":334,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":334,"endColumn":33,"suggestions":[{"messageId":"removeVar","data":{"varName":"level"},"fix":{"range":[8344,8359],"text":""},"desc":"Remove unused variable 'level'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'feature' is defined but never used. Allowed unused args must match /^_/u.","line":336,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":336,"endColumn":32,"suggestions":[{"messageId":"removeVar","data":{"varName":"feature"},"fix":{"range":[8429,8445],"text":""},"desc":"Remove unused variable 'feature'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'enabled' is defined but never used. Allowed unused args must match /^_/u.","line":336,"column":34,"nodeType":"Identifier","messageId":"unusedVar","endLine":336,"endColumn":50,"suggestions":[{"messageId":"removeVar","data":{"varName":"enabled"},"fix":{"range":[8444,8462],"text":""},"desc":"Remove unused variable 'enabled'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'service' is defined but never used. Allowed unused args must match /^_/u.","line":353,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":353,"endColumn":49,"suggestions":[{"messageId":"removeVar","data":{"varName":"service"},"fix":{"range":[8843,8876],"text":""},"desc":"Remove unused variable 'service'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'plugin' is defined but never used. Allowed unused args must match /^_/u.","line":364,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":364,"endColumn":35,"suggestions":[{"messageId":"removeVar","data":{"varName":"plugin"},"fix":{"range":[9094,9115],"text":""},"desc":"Remove unused variable 'plugin'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'pluginName' is defined but never used. Allowed unused args must match /^_/u.","line":366,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":366,"endColumn":34,"suggestions":[{"messageId":"removeVar","data":{"varName":"pluginName"},"fix":{"range":[9168,9186],"text":""},"desc":"Remove unused variable 'pluginName'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'service' is defined but never used. Allowed unused args must match /^_/u.","line":370,"column":19,"nodeType":"Identifier","messageId":"unusedVar","endLine":370,"endColumn":52,"suggestions":[{"messageId":"removeVar","data":{"varName":"service"},"fix":{"range":[9316,9349],"text":""},"desc":"Remove unused variable 'service'."}]},{"ruleId":"no-implicit-coercion","severity":2,"message":"Unexpected implicit coercion encountered. Use `Boolean(typeof service.initialize === 'function' &&\n    typeof service.getStatus === 'function' &&\n    typeof service.getHealth === 'function' &&\n    typeof service.sendMessage === 'function' &&\n    typeof service.on === 'function' &&\n    typeof service.off === 'function')` instead.","line":385,"column":10,"nodeType":"UnaryExpression","messageId":"implicitCoercion","endLine":392,"endColumn":4,"fix":{"range":[9776,10052],"text":"Boolean(typeof service.initialize === 'function' &&\n    typeof service.getStatus === 'function' &&\n    typeof service.getHealth === 'function' &&\n    typeof service.sendMessage === 'function' &&\n    typeof service.on === 'function' &&\n    typeof service.off === 'function')"}}],"suppressedMessages":[],"errorCount":38,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"/**\n * WhatsApp Service Interface and Utility Types\n *\n * This module provides the main service interface definition,\n * utility types, and common type aliases for the WhatsApp service.\n */\n\nimport type {\n  WhatsAppConfig,\n  WhatsAppServiceOptions,\n  MessageType,\n  MessageStatus,\n  ServiceEnvironment,\n  LogLevel\n} from './whatsapp-service-config';\n\nimport type {\n  ServiceStatus,\n  ServiceHealth,\n  ServiceMetrics,\n  WhatsAppServiceEvent\n} from './whatsapp-service-monitoring';\n\nimport type {\n  WhatsAppError\n} from './whatsapp-service-errors';\n\n// ==================== Main Service Interface ====================\n\n/**\n * WhatsApp Service Interface\n * Main interface that all WhatsApp service implementations must follow\n */\nexport interface WhatsAppServiceInterface {\n  // ==================== Configuration Methods ====================\n  \n  /**\n   * Initialize the service with configuration and options\n   * @param config - WhatsApp API configuration\n   * @param options - Optional service configuration\n   */\n  initialize: (config: WhatsAppConfig, options?: WhatsAppServiceOptions) => Promise<void>;\n  \n  /**\n   * Get current service status\n   * @returns Current service status including health and metrics\n   */\n  getStatus: () => ServiceStatus;\n  \n  /**\n   * Perform health check and get health status\n   * @returns Promise resolving to current health status\n   */\n  getHealth: () => Promise<ServiceHealth>;\n  \n  /**\n   * Get service metrics\n   * @returns Current service metrics\n   */\n  getMetrics: () => ServiceMetrics;\n  \n  /**\n   * Reset service metrics\n   */\n  resetMetrics: () => void;\n\n  // ==================== Messaging Methods ====================\n  \n  /**\n   * Send a single message\n   * @param request - Message request object\n   * @returns Promise resolving to message response\n   */\n  sendMessage: (request: unknown) => Promise<unknown>;\n  \n  /**\n   * Send multiple messages in bulk\n   * @param requests - Array of message request objects\n   * @returns Promise resolving to array of message responses\n   */\n  sendBulkMessages: (requests: unknown[]) => Promise<unknown[]>;\n  \n  /**\n   * Send a text message\n   * @param to - Recipient phone number\n   * @param text - Message text\n   * @returns Promise resolving to message response\n   */\n  sendTextMessage: (to: string, text: string) => Promise<unknown>;\n  \n  /**\n   * Send a template message\n   * @param to - Recipient phone number\n   * @param templateName - Template name\n   * @param templateData - Template parameters\n   * @returns Promise resolving to message response\n   */\n  sendTemplateMessage: (\n    to: string, \n    templateName: string, \n    templateData?: Record<string, unknown>\n  ) => Promise<unknown>;\n\n  // ==================== Media Methods ====================\n  \n  /**\n   * Upload media file\n   * @param file - File to upload (File object or Buffer)\n   * @param type - Media type\n   * @returns Promise resolving to media upload response with ID\n   */\n  uploadMedia: (file: File | Buffer, type: string) => Promise<{ id: string }>;\n  \n  /**\n   * Get media URL from media ID\n   * @param mediaId - Media ID from upload\n   * @returns Promise resolving to media URL\n   */\n  getMediaUrl: (mediaId: string) => Promise<{ url: string }>;\n  \n  /**\n   * Download media from URL\n   * @param url - Media URL\n   * @returns Promise resolving to media buffer\n   */\n  downloadMedia: (url: string) => Promise<Buffer>;\n\n  // ==================== Utility Methods ====================\n  \n  /**\n   * Validate phone number format\n   * @param phoneNumber - Phone number to validate\n   * @returns True if phone number is valid\n   */\n  validatePhoneNumber: (phoneNumber: string) => boolean;\n  \n  /**\n   * Format phone number to WhatsApp format\n   * @param phoneNumber - Phone number to format\n   * @returns Formatted phone number\n   */\n  formatPhoneNumber: (phoneNumber: string) => string;\n  \n  /**\n   * Validate message content\n   * @param message - Message object to validate\n   * @returns True if message is valid\n   */\n  validateMessage: (message: unknown) => boolean;\n\n  // ==================== Event Methods ====================\n  \n  /**\n   * Add event listener\n   * @param event - Event name\n   * @param listener - Event listener function\n   */\n  on: (event: string, listener: (data: unknown) => void) => void;\n  \n  /**\n   * Remove event listener\n   * @param event - Event name\n   * @param listener - Event listener function to remove\n   */\n  off: (event: string, listener: (data: unknown) => void) => void;\n  \n  /**\n   * Emit event\n   * @param event - Event name\n   * @param data - Event data\n   */\n  emit: (event: string, data: unknown) => void;\n  \n  /**\n   * Remove all event listeners\n   */\n  removeAllListeners: () => void;\n\n  // ==================== Lifecycle Methods ====================\n  \n  /**\n   * Start the service\n   * @returns Promise that resolves when service is started\n   */\n  start: () => Promise<void>;\n  \n  /**\n   * Stop the service\n   * @returns Promise that resolves when service is stopped\n   */\n  stop: () => Promise<void>;\n  \n  /**\n   * Restart the service\n   * @returns Promise that resolves when service is restarted\n   */\n  restart: () => Promise<void>;\n  \n  /**\n   * Check if service is running\n   * @returns True if service is running\n   */\n  isRunning: () => boolean;\n}\n\n// ==================== Request/Response Types ====================\n\n/**\n * Generic API Request\n * Base structure for API requests\n */\nexport interface ApiRequest {\n  /** Request method */\n  method: 'GET' | 'POST' | 'PUT' | 'DELETE';\n  /** Request endpoint */\n  endpoint: string;\n  /** Request headers */\n  headers?: Record<string, string>;\n  /** Request body */\n  body?: unknown;\n  /** Request timeout in milliseconds */\n  timeout?: number;\n}\n\n/**\n * Generic API Response\n * Base structure for API responses\n */\nexport interface ApiResponse<T = unknown> {\n  /** Response status code */\n  status: number;\n  /** Response headers */\n  headers: Record<string, string>;\n  /** Response data */\n  data: T;\n  /** Response timestamp */\n  timestamp: number;\n  /** Request duration in milliseconds */\n  duration: number;\n}\n\n/**\n * Message Request\n * Base structure for message requests\n */\nexport interface MessageRequest {\n  /** Recipient phone number */\n  to: string;\n  /** Message type */\n  type: MessageType;\n  /** Message content */\n  content: unknown;\n  /** Optional message metadata */\n  metadata?: Record<string, unknown>;\n}\n\n/**\n * Message Response\n * Base structure for message responses\n */\nexport interface MessageResponse {\n  /** WhatsApp message ID */\n  messageId: string;\n  /** Message status */\n  status: MessageStatus;\n  /** Response timestamp */\n  timestamp: number;\n  /** Additional response data */\n  data?: unknown;\n}\n\n// ==================== Webhook Types ====================\n\n/**\n * Webhook Handler\n * Function signature for webhook handlers\n */\nexport type WebhookHandler = (payload: unknown) => Promise<void> | void;\n\n/**\n * Webhook Configuration\n * Configuration for webhook handling\n */\nexport interface WebhookConfig {\n  /** Webhook URL */\n  url: string;\n  /** Verification token */\n  verifyToken: string;\n  /** Whether to validate webhook signatures */\n  validateSignature: boolean;\n  /** App secret for signature validation */\n  appSecret?: string;\n}\n\n// ==================== Type Aliases ====================\n\n/**\n * Shorter type aliases for commonly used types\n */\nexport type {\n  WhatsAppConfig as Config,\n  WhatsAppServiceOptions as ServiceOptions,\n  ServiceStatus as Status,\n  ServiceHealth as Health,\n  ServiceMetrics as Metrics,\n  WhatsAppServiceInterface as ServiceInterface,\n  WhatsAppServiceEvent as ServiceEvent,\n  WhatsAppError as ServiceError\n};\n\n// ==================== Factory Types ====================\n\n/**\n * Service Factory Function\n * Function signature for creating service instances\n */\nexport type ServiceFactory = (\n  config: WhatsAppConfig,\n  options?: WhatsAppServiceOptions\n) => WhatsAppServiceInterface;\n\n/**\n * Service Builder\n * Builder pattern interface for service configuration\n */\nexport interface ServiceBuilder {\n  /** Set configuration */\n  withConfig: (config: WhatsAppConfig) => ServiceBuilder;\n  /** Set options */\n  withOptions: (options: WhatsAppServiceOptions) => ServiceBuilder;\n  /** Set environment */\n  withEnvironment: (env: ServiceEnvironment) => ServiceBuilder;\n  /** Set log level */\n  withLogLevel: (level: LogLevel) => ServiceBuilder;\n  /** Enable/disable features */\n  withFeature: (feature: string, enabled: boolean) => ServiceBuilder;\n  /** Build service instance */\n  build: () => WhatsAppServiceInterface;\n}\n\n// ==================== Plugin Types ====================\n\n/**\n * Service Plugin\n * Interface for service plugins/extensions\n */\nexport interface ServicePlugin {\n  /** Plugin name */\n  name: string;\n  /** Plugin version */\n  version: string;\n  /** Initialize plugin */\n  initialize: (service: WhatsAppServiceInterface) => Promise<void>;\n  /** Cleanup plugin */\n  cleanup: () => Promise<void>;\n}\n\n/**\n * Plugin Manager\n * Interface for managing service plugins\n */\nexport interface PluginManager {\n  /** Register plugin */\n  register: (plugin: ServicePlugin) => void;\n  /** Unregister plugin */\n  unregister: (pluginName: string) => void;\n  /** Get registered plugins */\n  getPlugins: () => ServicePlugin[];\n  /** Initialize all plugins */\n  initializeAll: (service: WhatsAppServiceInterface) => Promise<void>;\n  /** Cleanup all plugins */\n  cleanupAll: () => Promise<void>;\n}\n\n// ==================== Utility Functions ====================\n\n/**\n * Check if object implements WhatsApp service interface\n */\nexport function isWhatsAppService(obj: unknown): obj is WhatsAppServiceInterface {\n  if (!obj || typeof obj !== 'object') return false;\n  \n  const service = obj as Partial<WhatsAppServiceInterface>;\n  \n  return !!(\n    typeof service.initialize === 'function' &&\n    typeof service.getStatus === 'function' &&\n    typeof service.getHealth === 'function' &&\n    typeof service.sendMessage === 'function' &&\n    typeof service.on === 'function' &&\n    typeof service.off === 'function'\n  );\n}\n\n/**\n * Create default service status\n */\nexport function createDefaultServiceStatus(): ServiceStatus {\n  return {\n    isInitialized: false,\n    isConnected: false,\n    lastActivity: Date.now(),\n    health: {\n      status: 'healthy',\n      lastCheck: Date.now(),\n      responseTime: 0,\n      errorRate: 0,\n      uptime: 100,\n      details: {\n        api: 'available',\n        webhook: 'not_configured',\n        phoneNumber: 'unverified'\n      }\n    },\n    metrics: {\n      messagesSent: 0,\n      messagesDelivered: 0,\n      messagesRead: 0,\n      messagesFailed: 0,\n      apiCalls: 0,\n      apiErrors: 0,\n      averageResponseTime: 0,\n      uptime: 100,\n      lastReset: Date.now()\n    },\n    config: {\n      phoneNumberId: '',\n      apiVersion: 'v18.0',\n      webhookConfigured: false\n    }\n  };\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/types/whatsapp-service-monitoring.ts","messages":[{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 10.","line":326,"column":19,"nodeType":"Literal","messageId":"noMagic","endLine":326,"endColumn":21},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 95.","line":326,"column":57,"nodeType":"Literal","messageId":"noMagic","endLine":326,"endColumn":59},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 5.","line":331,"column":19,"nodeType":"Literal","messageId":"noMagic","endLine":331,"endColumn":20},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2000.","line":331,"column":39,"nodeType":"Literal","messageId":"noMagic","endLine":331,"endColumn":43},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 99.","line":331,"column":56,"nodeType":"Literal","messageId":"noMagic","endLine":331,"endColumn":58},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 5.","line":399,"column":45,"nodeType":"Literal","messageId":"noMagic","endLine":399,"endColumn":46},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2000.","line":400,"column":51,"nodeType":"Literal","messageId":"noMagic","endLine":400,"endColumn":55},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0.1.","line":401,"column":53,"nodeType":"Literal","messageId":"noMagic","endLine":401,"endColumn":56}],"suppressedMessages":[],"errorCount":8,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * WhatsApp Service Monitoring and Health Types\n *\n * This module provides type definitions for service health monitoring,\n * metrics collection, status tracking, and event handling.\n */\n\n// ==================== Service Health Types ====================\n\n/**\n * Service Health Status\n * Overall health assessment of the WhatsApp service\n */\nexport interface ServiceHealth {\n  /** Overall service status */\n  status: 'healthy' | 'degraded' | 'unhealthy';\n  /** Timestamp of last health check */\n  lastCheck: number;\n  /** Average response time in milliseconds */\n  responseTime?: number;\n  /** Error rate as percentage (0-100) */\n  errorRate?: number;\n  /** Service uptime as percentage (0-100) */\n  uptime?: number;\n  /** Detailed health information */\n  details?: {\n    /** API availability status */\n    api: 'available' | 'unavailable';\n    /** Webhook configuration status */\n    webhook: 'configured' | 'not_configured' | 'error';\n    /** Phone number verification status */\n    phoneNumber: 'verified' | 'unverified' | 'error';\n  };\n}\n\n/**\n * Service Metrics\n * Quantitative metrics for service performance monitoring\n */\nexport interface ServiceMetrics {\n  /** Total number of messages sent */\n  messagesSent: number;\n  /** Total number of messages delivered */\n  messagesDelivered: number;\n  /** Total number of messages read by recipients */\n  messagesRead: number;\n  /** Total number of failed message attempts */\n  messagesFailed: number;\n  /** Total number of API calls made */\n  apiCalls: number;\n  /** Total number of API errors encountered */\n  apiErrors: number;\n  /** Average response time for API calls in milliseconds */\n  averageResponseTime: number;\n  /** Service uptime as percentage (0-100) */\n  uptime: number;\n  /** Timestamp when metrics were last reset */\n  lastReset: number;\n}\n\n/**\n * Service Status\n * Complete status information for the WhatsApp service\n */\nexport interface ServiceStatus {\n  /** Whether the service has been initialized */\n  isInitialized: boolean;\n  /** Whether the service is currently connected */\n  isConnected: boolean;\n  /** Timestamp of last service activity */\n  lastActivity: number;\n  /** Current health status */\n  health: ServiceHealth;\n  /** Performance metrics */\n  metrics: ServiceMetrics;\n  /** Configuration summary */\n  config: {\n    /** Phone number ID being used */\n    phoneNumberId: string;\n    /** API version being used */\n    apiVersion: string;\n    /** Whether webhook is configured */\n    webhookConfigured: boolean;\n  };\n}\n\n// ==================== Event Types ====================\n\n/**\n * Base Service Event\n * Common structure for all service events\n */\nexport interface ServiceEvent {\n  /** Event type identifier */\n  type: string;\n  /** Timestamp when event occurred */\n  timestamp: number;\n  /** Event-specific data */\n  data: Record<string, unknown>;\n  /** Source of the event */\n  source: 'api' | 'webhook' | 'service';\n}\n\n/**\n * Message Sent Event\n * Fired when a message is successfully sent\n */\nexport interface MessageSentEvent extends ServiceEvent {\n  type: 'message_sent';\n  data: {\n    /** WhatsApp message ID */\n    messageId: string;\n    /** Recipient phone number */\n    to: string;\n    /** Type of message sent */\n    messageType: string;\n    /** Timestamp when message was sent */\n    sentAt: number;\n  };\n}\n\n/**\n * Message Delivered Event\n * Fired when a message is delivered to recipient\n */\nexport interface MessageDeliveredEvent extends ServiceEvent {\n  type: 'message_delivered';\n  data: {\n    /** WhatsApp message ID */\n    messageId: string;\n    /** Recipient phone number */\n    to: string;\n    /** Timestamp when message was delivered */\n    deliveredAt: number;\n  };\n}\n\n/**\n * Message Read Event\n * Fired when a message is read by recipient\n */\nexport interface MessageReadEvent extends ServiceEvent {\n  type: 'message_read';\n  data: {\n    /** WhatsApp message ID */\n    messageId: string;\n    /** Recipient phone number */\n    to: string;\n    /** Timestamp when message was read */\n    readAt: number;\n  };\n}\n\n/**\n * Message Failed Event\n * Fired when a message fails to send\n */\nexport interface MessageFailedEvent extends ServiceEvent {\n  type: 'message_failed';\n  data: {\n    /** WhatsApp message ID (if available) */\n    messageId?: string;\n    /** Recipient phone number */\n    to: string;\n    /** Error that caused the failure */\n    error: {\n      code: number;\n      message: string;\n      type: string;\n    };\n    /** Timestamp when failure occurred */\n    failedAt: number;\n  };\n}\n\n/**\n * Error Event\n * Fired when a service error occurs\n */\nexport interface ErrorEvent extends ServiceEvent {\n  type: 'error';\n  data: {\n    /** Error object */\n    error: {\n      name: string;\n      message: string;\n      code: number;\n      type: string;\n      stack?: string;\n    };\n    /** Additional context */\n    context?: Record<string, unknown>;\n  };\n}\n\n/**\n * Health Check Event\n * Fired when a health check is performed\n */\nexport interface HealthCheckEvent extends ServiceEvent {\n  type: 'health_check';\n  data: {\n    /** Health status result */\n    status: 'healthy' | 'degraded' | 'unhealthy';\n    /** Response time for health check */\n    responseTime: number;\n    /** Any issues detected */\n    issues?: string[];\n  };\n}\n\n/**\n * Rate Limit Event\n * Fired when rate limiting occurs\n */\nexport interface RateLimitEvent extends ServiceEvent {\n  type: 'rate_limit';\n  data: {\n    /** Seconds to wait before retrying */\n    retryAfter: number;\n    /** Current rate limit */\n    limit?: number;\n    /** Remaining requests */\n    remaining?: number;\n  };\n}\n\n/**\n * Union type for all WhatsApp service events\n */\nexport type WhatsAppServiceEvent = \n  | MessageSentEvent \n  | MessageDeliveredEvent \n  | MessageReadEvent\n  | MessageFailedEvent\n  | ErrorEvent \n  | HealthCheckEvent\n  | RateLimitEvent;\n\n// ==================== Monitoring Configuration ====================\n\n/**\n * Health Check Configuration\n * Configuration for automated health checks\n */\nexport interface HealthCheckConfig {\n  /** Interval between health checks in milliseconds */\n  interval: number;\n  /** Timeout for health check requests in milliseconds */\n  timeout: number;\n  /** Number of consecutive failures before marking as unhealthy */\n  failureThreshold: number;\n  /** Number of consecutive successes before marking as healthy */\n  successThreshold: number;\n  /** Whether to perform deep health checks */\n  deepCheck: boolean;\n}\n\n/**\n * Metrics Collection Configuration\n * Configuration for metrics collection and aggregation\n */\nexport interface MetricsConfig {\n  /** Whether to collect metrics */\n  enabled: boolean;\n  /** Interval for metrics collection in milliseconds */\n  collectionInterval: number;\n  /** How long to retain metrics in milliseconds */\n  retentionPeriod: number;\n  /** Whether to aggregate metrics */\n  aggregateMetrics: boolean;\n  /** Metrics aggregation window in milliseconds */\n  aggregationWindow: number;\n}\n\n/**\n * Alert Configuration\n * Configuration for service alerts and notifications\n */\nexport interface AlertConfig {\n  /** Whether alerts are enabled */\n  enabled: boolean;\n  /** Error rate threshold for alerts (percentage) */\n  errorRateThreshold: number;\n  /** Response time threshold for alerts (milliseconds) */\n  responseTimeThreshold: number;\n  /** Failure count threshold for alerts */\n  failureCountThreshold: number;\n  /** Cooldown period between alerts in milliseconds */\n  alertCooldown: number;\n}\n\n// ==================== Monitoring Utilities ====================\n\n/**\n * Calculate service uptime percentage\n */\nexport function calculateUptime(\n  totalTime: number,\n  downTime: number\n): number {\n  if (totalTime <= 0) return 100;\n  return Math.max(0, Math.min(100, ((totalTime - downTime) / totalTime) * 100));\n}\n\n/**\n * Calculate error rate percentage\n */\nexport function calculateErrorRate(\n  totalRequests: number,\n  errorCount: number\n): number {\n  if (totalRequests <= 0) return 0;\n  return Math.min(100, (errorCount / totalRequests) * 100);\n}\n\n/**\n * Determine health status based on metrics\n */\nexport function determineHealthStatus(\n  errorRate: number,\n  responseTime: number,\n  uptime: number\n): 'healthy' | 'degraded' | 'unhealthy' {\n  // Unhealthy thresholds\n  if (errorRate > 10 || responseTime > 5000 || uptime < 95) {\n    return 'unhealthy';\n  }\n  \n  // Degraded thresholds\n  if (errorRate > 5 || responseTime > 2000 || uptime < 99) {\n    return 'degraded';\n  }\n  \n  return 'healthy';\n}\n\n/**\n * Create default service metrics\n */\nexport function createDefaultMetrics(): ServiceMetrics {\n  return {\n    messagesSent: 0,\n    messagesDelivered: 0,\n    messagesRead: 0,\n    messagesFailed: 0,\n    apiCalls: 0,\n    apiErrors: 0,\n    averageResponseTime: 0,\n    uptime: 100,\n    lastReset: Date.now()\n  };\n}\n\n/**\n * Create default health status\n */\nexport function createDefaultHealth(): ServiceHealth {\n  return {\n    status: 'healthy',\n    lastCheck: Date.now(),\n    responseTime: 0,\n    errorRate: 0,\n    uptime: 100,\n    details: {\n      api: 'available',\n      webhook: 'not_configured',\n      phoneNumber: 'unverified'\n    }\n  };\n}\n\n/**\n * Update metrics with new data point\n */\nexport function updateMetrics(\n  current: ServiceMetrics,\n  update: Partial<ServiceMetrics>\n): ServiceMetrics {\n  return {\n    ...current,\n    ...update,\n    // Recalculate average response time if new response time provided\n    averageResponseTime: update.averageResponseTime !== undefined \n      ? update.averageResponseTime\n      : current.averageResponseTime\n  };\n}\n\n/**\n * Check if service needs attention based on metrics\n */\nexport function needsAttention(\n  health: ServiceHealth,\n  metrics: ServiceMetrics\n): boolean {\n  return (\n    health.status !== 'healthy' ||\n    (health.errorRate && health.errorRate > 5) ||\n    (health.responseTime && health.responseTime > 2000) ||\n    metrics.messagesFailed > metrics.messagesSent * 0.1\n  );\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/types/whatsapp-service-types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/types/whatsapp-template-types.ts","messages":[{"ruleId":"complexity","severity":2,"message":"Function 'validateTemplateParameter' has a complexity of 19. Maximum allowed is 15.","line":205,"column":8,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":253,"endColumn":2},{"ruleId":"default-case","severity":2,"message":"Expected a default case.","line":213,"column":3,"nodeType":"SwitchStatement","messageId":"missingDefaultCase","endLine":246,"endColumn":4}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * WhatsApp Template Message Type Definitions\n *\n * This module provides type definitions for WhatsApp Business API template messages,\n * including template parameters, components, and language settings.\n */\n\n// Template Parameter Types\nexport interface TemplateParameter {\n  type: 'text' | 'currency' | 'date_time' | 'image' | 'document' | 'video';\n  text?: string;\n  currency?: {\n    fallback_value: string;\n    code: string;\n    amount_1000: number;\n  };\n  date_time?: {\n    fallback_value: string;\n  };\n  image?: {\n    id?: string;\n    link?: string;\n  };\n  document?: {\n    id?: string;\n    link?: string;\n    filename?: string;\n  };\n  video?: {\n    id?: string;\n    link?: string;\n  };\n}\n\n// Template Component Types\nexport interface TemplateComponent {\n  type: 'header' | 'body' | 'footer' | 'button';\n  sub_type?: 'quick_reply' | 'url' | 'phone_number';\n  index?: number;\n  parameters?: TemplateParameter[];\n}\n\n// Template Language Configuration\nexport interface TemplateLanguage {\n  policy: 'deterministic';\n  code: string;\n}\n\n// Main Template Message Structure\nexport interface TemplateMessage {\n  name: string;\n  language: TemplateLanguage;\n  components?: TemplateComponent[];\n}\n\n// Extended Template Types\nexport interface HeaderComponent extends TemplateComponent {\n  type: 'header';\n  parameters?: Array<TemplateParameter & {\n    type: 'text' | 'image' | 'document' | 'video';\n  }>;\n}\n\nexport interface BodyComponent extends TemplateComponent {\n  type: 'body';\n  parameters?: Array<TemplateParameter & {\n    type: 'text' | 'currency' | 'date_time';\n  }>;\n}\n\nexport interface FooterComponent extends TemplateComponent {\n  type: 'footer';\n  parameters?: Array<TemplateParameter & {\n    type: 'text';\n  }>;\n}\n\nexport interface ButtonComponent extends TemplateComponent {\n  type: 'button';\n  sub_type: 'quick_reply' | 'url' | 'phone_number';\n  index: number;\n  parameters?: Array<TemplateParameter & {\n    type: 'text';\n  }>;\n}\n\n// Template Builder Types\nexport interface TemplateBuilder {\n  name: string;\n  language: string;\n  components: TemplateComponent[];\n}\n\nexport interface TemplateValidationResult {\n  isValid: boolean;\n  errors: string[];\n  warnings: string[];\n}\n\n// Template Parameter Builder Helpers\nexport interface TextParameterBuilder {\n  type: 'text';\n  text: string;\n}\n\nexport interface CurrencyParameterBuilder {\n  type: 'currency';\n  fallback_value: string;\n  code: string;\n  amount_1000: number;\n}\n\nexport interface DateTimeParameterBuilder {\n  type: 'date_time';\n  fallback_value: string;\n}\n\nexport interface MediaParameterBuilder {\n  type: 'image' | 'document' | 'video';\n  id?: string;\n  link?: string;\n  filename?: string; // Only for documents\n}\n\n// Template Utility Types\nexport type TemplateComponentType = TemplateComponent['type'];\nexport type TemplateParameterType = TemplateParameter['type'];\nexport type ButtonSubType = ButtonComponent['sub_type'];\n\n// Template Constants\nexport const TEMPLATE_COMPONENT_TYPES = [\n  'header',\n  'body',\n  'footer',\n  'button'\n] as const;\n\nexport const TEMPLATE_PARAMETER_TYPES = [\n  'text',\n  'currency',\n  'date_time',\n  'image',\n  'document',\n  'video'\n] as const;\n\nexport const BUTTON_SUB_TYPES = [\n  'quick_reply',\n  'url',\n  'phone_number'\n] as const;\n\nexport const SUPPORTED_LANGUAGE_CODES = [\n  'en_US', // English (US)\n  'en_GB', // English (UK)\n  'es_ES', // Spanish (Spain)\n  'es_MX', // Spanish (Mexico)\n  'pt_BR', // Portuguese (Brazil)\n  'fr_FR', // French (France)\n  'de_DE', // German (Germany)\n  'it_IT', // Italian (Italy)\n  'ru_RU', // Russian (Russia)\n  'ar_AR', // Arabic\n  'hi_IN', // Hindi (India)\n  'zh_CN', // Chinese (Simplified)\n  'zh_TW', // Chinese (Traditional)\n  'ja_JP', // Japanese (Japan)\n  'ko_KR', // Korean (South Korea)\n] as const;\n\n// Type Guards\nexport function isValidTemplateComponentType(type: string): type is TemplateComponentType {\n  return TEMPLATE_COMPONENT_TYPES.includes(type as TemplateComponentType);\n}\n\nexport function isValidTemplateParameterType(type: string): type is TemplateParameterType {\n  return TEMPLATE_PARAMETER_TYPES.includes(type as TemplateParameterType);\n}\n\nexport function isValidButtonSubType(subType: string): subType is ButtonSubType {\n  return BUTTON_SUB_TYPES.includes(subType as ButtonSubType);\n}\n\nexport function isValidLanguageCode(code: string): code is typeof SUPPORTED_LANGUAGE_CODES[number] {\n  return SUPPORTED_LANGUAGE_CODES.includes(code as typeof SUPPORTED_LANGUAGE_CODES[number]);\n}\n\nexport function isHeaderComponent(component: TemplateComponent): component is HeaderComponent {\n  return component.type === 'header';\n}\n\nexport function isBodyComponent(component: TemplateComponent): component is BodyComponent {\n  return component.type === 'body';\n}\n\nexport function isFooterComponent(component: TemplateComponent): component is FooterComponent {\n  return component.type === 'footer';\n}\n\nexport function isButtonComponent(component: TemplateComponent): component is ButtonComponent {\n  return component.type === 'button';\n}\n\n// Template Validation Functions\nexport function validateTemplateParameter(parameter: TemplateParameter): TemplateValidationResult {\n  const errors: string[] = [];\n  const warnings: string[] = [];\n\n  if (!isValidTemplateParameterType(parameter.type)) {\n    errors.push(`Invalid parameter type: ${parameter.type}`);\n  }\n\n  switch (parameter.type) {\n    case 'text':\n      if (!parameter.text) {\n        errors.push('Text parameter must have text value');\n      }\n      break;\n    case 'currency':\n      if (!parameter.currency) {\n        errors.push('Currency parameter must have currency object');\n      } else {\n        if (!parameter.currency.code) {\n          errors.push('Currency parameter must have currency code');\n        }\n        if (!parameter.currency.fallback_value) {\n          errors.push('Currency parameter must have fallback value');\n        }\n        if (typeof parameter.currency.amount_1000 !== 'number') {\n          errors.push('Currency parameter must have numeric amount_1000');\n        }\n      }\n      break;\n    case 'date_time':\n      if (!parameter.date_time?.fallback_value) {\n        errors.push('Date time parameter must have fallback value');\n      }\n      break;\n    case 'image':\n    case 'document':\n    case 'video':\n      if (!parameter[parameter.type]?.id && !parameter[parameter.type]?.link) {\n        errors.push(`${parameter.type} parameter must have either id or link`);\n      }\n      break;\n  }\n\n  return {\n    isValid: errors.length === 0,\n    errors,\n    warnings\n  };\n}\n\nexport function validateTemplateComponent(component: TemplateComponent): TemplateValidationResult {\n  const errors: string[] = [];\n  const warnings: string[] = [];\n\n  if (!isValidTemplateComponentType(component.type)) {\n    errors.push(`Invalid component type: ${component.type}`);\n  }\n\n  if (component.type === 'button') {\n    if (!component.sub_type) {\n      errors.push('Button component must have sub_type');\n    } else if (!isValidButtonSubType(component.sub_type)) {\n      errors.push(`Invalid button sub_type: ${component.sub_type}`);\n    }\n\n    if (typeof component.index !== 'number') {\n      errors.push('Button component must have numeric index');\n    }\n  }\n\n  if (component.parameters) {\n    component.parameters.forEach((param, index) => {\n      const paramValidation = validateTemplateParameter(param);\n      if (!paramValidation.isValid) {\n        errors.push(...paramValidation.errors.map(err => `Parameter ${index}: ${err}`));\n      }\n      warnings.push(...paramValidation.warnings.map(warn => `Parameter ${index}: ${warn}`));\n    });\n  }\n\n  return {\n    isValid: errors.length === 0,\n    errors,\n    warnings\n  };\n}\n\nexport function validateTemplateMessage(template: TemplateMessage): TemplateValidationResult {\n  const errors: string[] = [];\n  const warnings: string[] = [];\n\n  if (!template.name) {\n    errors.push('Template must have a name');\n  }\n\n  if (!template.language?.code) {\n    errors.push('Template must have language code');\n  } else if (!isValidLanguageCode(template.language.code)) {\n    warnings.push(`Language code ${template.language.code} may not be supported`);\n  }\n\n  if (template.language?.policy !== 'deterministic') {\n    errors.push('Template language policy must be \"deterministic\"');\n  }\n\n  if (template.components) {\n    template.components.forEach((component, index) => {\n      const componentValidation = validateTemplateComponent(component);\n      if (!componentValidation.isValid) {\n        errors.push(...componentValidation.errors.map(err => `Component ${index}: ${err}`));\n      }\n      warnings.push(...componentValidation.warnings.map(warn => `Component ${index}: ${warn}`));\n    });\n  }\n\n  return {\n    isValid: errors.length === 0,\n    errors,\n    warnings\n  };\n}\n\n// Template Builder Helper Functions\nexport function createTextParameter(text: string): TextParameterBuilder {\n  return {\n    type: 'text',\n    text\n  };\n}\n\nexport function createCurrencyParameter(\n  code: string,\n  amount_1000: number,\n  fallback_value: string\n): CurrencyParameterBuilder {\n  return {\n    type: 'currency',\n    code,\n    amount_1000,\n    fallback_value\n  };\n}\n\nexport function createDateTimeParameter(fallback_value: string): DateTimeParameterBuilder {\n  return {\n    type: 'date_time',\n    fallback_value\n  };\n}\n\nexport function createMediaParameter(\n  type: 'image' | 'document' | 'video',\n  options: { id?: string; link?: string; filename?: string }\n): MediaParameterBuilder {\n  return {\n    type,\n    ...options\n  };\n}\n\n// Export commonly used types with shorter names\nexport type {\n  TemplateMessage as Template,\n  TemplateComponent as Component,\n  TemplateParameter as Parameter,\n  TemplateLanguage as Language\n};\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/types/whatsapp-webhook-base.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/types/whatsapp-webhook-events.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'event' is defined but never used. Allowed unused args must match /^_/u.","line":163,"column":24,"nodeType":"Identifier","messageId":"unusedVar","endLine":163,"endColumn":51,"suggestions":[{"messageId":"removeVar","data":{"varName":"event"},"fix":{"range":[3370,3397],"text":""},"desc":"Remove unused variable 'event'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'event' is defined but never used. Allowed unused args must match /^_/u.","line":164,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":164,"endColumn":47,"suggestions":[{"messageId":"removeVar","data":{"varName":"event"},"fix":{"range":[3445,3470],"text":""},"desc":"Remove unused variable 'event'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'event' is defined but never used. Allowed unused args must match /^_/u.","line":165,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":165,"endColumn":43,"suggestions":[{"messageId":"removeVar","data":{"varName":"event"},"fix":{"range":[3516,3539],"text":""},"desc":"Remove unused variable 'event'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'event' is defined but never used. Allowed unused args must match /^_/u.","line":166,"column":24,"nodeType":"Identifier","messageId":"unusedVar","endLine":166,"endColumn":51,"suggestions":[{"messageId":"removeVar","data":{"varName":"event"},"fix":{"range":[3589,3616],"text":""},"desc":"Remove unused variable 'event'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'event' is defined but never used. Allowed unused args must match /^_/u.","line":167,"column":25,"nodeType":"Identifier","messageId":"unusedVar","endLine":167,"endColumn":53,"suggestions":[{"messageId":"removeVar","data":{"varName":"event"},"fix":{"range":[3667,3695],"text":""},"desc":"Remove unused variable 'event'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'event' is defined but never used. Allowed unused args must match /^_/u.","line":168,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":168,"endColumn":47,"suggestions":[{"messageId":"removeVar","data":{"varName":"event"},"fix":{"range":[3743,3768],"text":""},"desc":"Remove unused variable 'event'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'event' is defined but never used. Allowed unused args must match /^_/u.","line":169,"column":23,"nodeType":"Identifier","messageId":"unusedVar","endLine":169,"endColumn":49,"suggestions":[{"messageId":"removeVar","data":{"varName":"event"},"fix":{"range":[3817,3843],"text":""},"desc":"Remove unused variable 'event'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'event' is defined but never used. Allowed unused args must match /^_/u.","line":170,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":170,"endColumn":57,"suggestions":[{"messageId":"removeVar","data":{"varName":"event"},"fix":{"range":[3896,3926],"text":""},"desc":"Remove unused variable 'event'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'event' is defined but never used. Allowed unused args must match /^_/u.","line":171,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":171,"endColumn":42,"suggestions":[{"messageId":"removeVar","data":{"varName":"event"},"fix":{"range":[3974,3994],"text":""},"desc":"Remove unused variable 'event'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'event' is defined but never used. Allowed unused args must match /^_/u.","line":172,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":172,"endColumn":38,"suggestions":[{"messageId":"removeVar","data":{"varName":"event"},"fix":{"range":[4034,4058],"text":""},"desc":"Remove unused variable 'event'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'event' is defined but never used. Allowed unused args must match /^_/u.","line":173,"column":21,"nodeType":"Identifier","messageId":"unusedVar","endLine":173,"endColumn":35,"suggestions":[{"messageId":"removeVar","data":{"varName":"event"},"fix":{"range":[4105,4119],"text":""},"desc":"Remove unused variable 'event'."}]},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 2.","line":346,"column":14,"nodeType":"Literal","messageId":"noMagic","endLine":346,"endColumn":15},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 3.","line":348,"column":14,"nodeType":"Literal","messageId":"noMagic","endLine":348,"endColumn":15},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 4.","line":350,"column":14,"nodeType":"Literal","messageId":"noMagic","endLine":350,"endColumn":15},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 5.","line":352,"column":14,"nodeType":"Literal","messageId":"noMagic","endLine":352,"endColumn":15},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 6.","line":354,"column":14,"nodeType":"Literal","messageId":"noMagic","endLine":354,"endColumn":15},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 7.","line":356,"column":14,"nodeType":"Literal","messageId":"noMagic","endLine":356,"endColumn":15},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 8.","line":359,"column":14,"nodeType":"Literal","messageId":"noMagic","endLine":359,"endColumn":15},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 9.","line":361,"column":14,"nodeType":"Literal","messageId":"noMagic","endLine":361,"endColumn":15},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 10.","line":363,"column":14,"nodeType":"Literal","messageId":"noMagic","endLine":363,"endColumn":16},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 24.","line":385,"column":72,"nodeType":"Literal","messageId":"noMagic","endLine":385,"endColumn":74},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 60.","line":385,"column":77,"nodeType":"Literal","messageId":"noMagic","endLine":385,"endColumn":79},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 60.","line":385,"column":82,"nodeType":"Literal","messageId":"noMagic","endLine":385,"endColumn":84}],"suppressedMessages":[],"errorCount":23,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * WhatsApp Webhook 事件类型定义\n * WhatsApp Webhook Event Type Definitions\n *\n * 提供WhatsApp webhook事件的类型定义和处理接口\n */\n\nimport type { WhatsAppContact } from './whatsapp-base-types';\nimport type { MessageStatusUpdate, WebhookError } from './whatsapp-webhook-base';\nimport type { IncomingWhatsAppMessage } from './whatsapp-webhook-messages';\n\n/**\n * 消息接收事件\n * Message received event\n */\nexport interface MessageReceivedEvent {\n  type: 'message_received';\n  timestamp: string;\n  phone_number_id: string;\n  from: string;\n  message: IncomingWhatsAppMessage;\n  contact?: WhatsAppContact;\n}\n\n/**\n * 消息状态事件\n * Message status event\n */\nexport interface MessageStatusEvent {\n  type: 'message_status';\n  timestamp: string;\n  phone_number_id: string;\n  status_update: MessageStatusUpdate;\n}\n\n/**\n * Webhook错误事件\n * Webhook error event\n */\nexport interface WebhookErrorEvent {\n  type: 'webhook_error';\n  timestamp: string;\n  phone_number_id: string;\n  error: WebhookError;\n}\n\n/**\n * 消息读取事件\n * Message read event\n */\nexport interface MessageReadEvent {\n  type: 'message_read';\n  timestamp: string;\n  phone_number_id: string;\n  from: string;\n  message_id: string;\n  read_timestamp: string;\n}\n\n/**\n * 消息传递事件\n * Message delivery event\n */\nexport interface MessageDeliveryEvent {\n  type: 'message_delivery';\n  timestamp: string;\n  phone_number_id: string;\n  to: string;\n  message_id: string;\n  delivery_timestamp: string;\n}\n\n/**\n * 用户状态变更事件\n * User status change event\n */\nexport interface UserStatusChangeEvent {\n  type: 'user_status_change';\n  timestamp: string;\n  phone_number_id: string;\n  from: string;\n  status: 'online' | 'offline' | 'typing' | 'recording';\n}\n\n/**\n * 账户更新事件\n * Account update event\n */\nexport interface AccountUpdateEvent {\n  type: 'account_update';\n  timestamp: string;\n  phone_number_id: string;\n  update_type: 'profile' | 'business_info' | 'settings';\n  changes: Record<string, string | number | boolean | Record<string, unknown> | unknown[]>;\n}\n\n/**\n * 模板状态事件\n * Template status event\n */\nexport interface TemplateStatusEvent {\n  type: 'template_status';\n  timestamp: string;\n  phone_number_id: string;\n  template_id: string;\n  template_name: string;\n  status: 'approved' | 'rejected' | 'pending' | 'disabled';\n  reason?: string;\n}\n\n/**\n * 电话号码质量更新事件\n * Phone number quality update event\n */\nexport interface PhoneNumberQualityEvent {\n  type: 'phone_number_quality';\n  timestamp: string;\n  phone_number_id: string;\n  quality_score: number;\n  quality_rating: 'green' | 'yellow' | 'red';\n  previous_rating?: 'green' | 'yellow' | 'red';\n}\n\n/**\n * 安全事件\n * Security event\n */\nexport interface SecurityEvent {\n  type: 'security_event';\n  timestamp: string;\n  phone_number_id: string;\n  event_type: 'suspicious_activity' | 'rate_limit_exceeded' | 'unauthorized_access';\n  details: {\n    source_ip?: string;\n    user_agent?: string;\n    request_count?: number;\n    description: string;\n  };\n  severity: 'low' | 'medium' | 'high' | 'critical';\n}\n\n/**\n * Webhook事件联合类型\n * Union type for webhook events\n */\nexport type WebhookEvent =\n  | MessageReceivedEvent\n  | MessageStatusEvent\n  | WebhookErrorEvent\n  | MessageReadEvent\n  | MessageDeliveryEvent\n  | UserStatusChangeEvent\n  | AccountUpdateEvent\n  | TemplateStatusEvent\n  | PhoneNumberQualityEvent\n  | SecurityEvent;\n\n/**\n * 事件处理器接口\n * Event handler interface\n */\nexport interface WebhookProcessor {\n  onMessageReceived?: (event: MessageReceivedEvent) => Promise<void> | void;\n  onMessageStatus?: (event: MessageStatusEvent) => Promise<void> | void;\n  onMessageRead?: (event: MessageReadEvent) => Promise<void> | void;\n  onMessageDelivery?: (event: MessageDeliveryEvent) => Promise<void> | void;\n  onUserStatusChange?: (event: UserStatusChangeEvent) => Promise<void> | void;\n  onAccountUpdate?: (event: AccountUpdateEvent) => Promise<void> | void;\n  onTemplateStatus?: (event: TemplateStatusEvent) => Promise<void> | void;\n  onPhoneNumberQuality?: (event: PhoneNumberQualityEvent) => Promise<void> | void;\n  onSecurityEvent?: (event: SecurityEvent) => Promise<void> | void;\n  onError?: (event: WebhookErrorEvent) => Promise<void> | void;\n  onUnknownEvent?: (event: unknown) => Promise<void> | void;\n}\n\n/**\n * 事件过滤器\n * Event filter\n */\nexport interface EventFilter {\n  event_types?: string[];\n  phone_number_ids?: string[];\n  sender_filters?: {\n    include?: string[];\n    exclude?: string[];\n  };\n  time_range?: {\n    start: string;\n    end: string;\n  };\n  custom_filters?: Array<{\n    field: string;\n    operator: 'equals' | 'contains' | 'starts_with' | 'ends_with' | 'regex';\n    value: string;\n  }>;\n}\n\n/**\n * 事件处理配置\n * Event processing configuration\n */\nexport interface EventProcessingConfig {\n  parallel_processing: boolean;\n  max_concurrent_events: number;\n  timeout_ms: number;\n  retry_failed_events: boolean;\n  max_retries: number;\n  retry_delay_ms: number;\n  dead_letter_queue: boolean;\n  event_ordering: 'fifo' | 'priority' | 'none';\n}\n\n/**\n * 事件统计\n * Event statistics\n */\nexport interface EventStatistics {\n  total_events: number;\n  events_by_type: Record<string, number>;\n  processing_times: {\n    average_ms: number;\n    min_ms: number;\n    max_ms: number;\n    p95_ms: number;\n    p99_ms: number;\n  };\n  error_rate: number;\n  success_rate: number;\n  last_processed_at?: string;\n}\n\n/**\n * 事件批处理\n * Event batch\n */\nexport interface EventBatch {\n  batch_id: string;\n  events: WebhookEvent[];\n  created_at: string;\n  processed_at?: string;\n  status: 'pending' | 'processing' | 'completed' | 'failed';\n  error?: string;\n}\n\n/**\n * 事件常量\n * Event constants\n */\nexport const WEBHOOK_EVENT_TYPES = [\n  'message_received',\n  'message_status',\n  'message_read',\n  'message_delivery',\n  'user_status_change',\n  'account_update',\n  'template_status',\n  'phone_number_quality',\n  'security_event',\n  'webhook_error'\n] as const;\n\nexport const MESSAGE_EVENT_TYPES = [\n  'message_received',\n  'message_status',\n  'message_read',\n  'message_delivery'\n] as const;\n\nexport const SYSTEM_EVENT_TYPES = [\n  'account_update',\n  'template_status',\n  'phone_number_quality',\n  'security_event',\n  'webhook_error'\n] as const;\n\n/**\n * 事件类型\n * Event types\n */\nexport type WebhookEventType = typeof WEBHOOK_EVENT_TYPES[number];\nexport type MessageEventType = typeof MESSAGE_EVENT_TYPES[number];\nexport type SystemEventType = typeof SYSTEM_EVENT_TYPES[number];\n\n/**\n * 类型守卫函数\n * Type guard functions\n */\nexport function isMessageReceivedEvent(event: WebhookEvent): event is MessageReceivedEvent {\n  return event.type === 'message_received';\n}\n\nexport function isMessageStatusEvent(event: WebhookEvent): event is MessageStatusEvent {\n  return event.type === 'message_status';\n}\n\nexport function isMessageReadEvent(event: WebhookEvent): event is MessageReadEvent {\n  return event.type === 'message_read';\n}\n\nexport function isMessageDeliveryEvent(event: WebhookEvent): event is MessageDeliveryEvent {\n  return event.type === 'message_delivery';\n}\n\nexport function isUserStatusChangeEvent(event: WebhookEvent): event is UserStatusChangeEvent {\n  return event.type === 'user_status_change';\n}\n\nexport function isAccountUpdateEvent(event: WebhookEvent): event is AccountUpdateEvent {\n  return event.type === 'account_update';\n}\n\nexport function isTemplateStatusEvent(event: WebhookEvent): event is TemplateStatusEvent {\n  return event.type === 'template_status';\n}\n\nexport function isPhoneNumberQualityEvent(event: WebhookEvent): event is PhoneNumberQualityEvent {\n  return event.type === 'phone_number_quality';\n}\n\nexport function isSecurityEvent(event: WebhookEvent): event is SecurityEvent {\n  return event.type === 'security_event';\n}\n\nexport function isWebhookErrorEvent(event: WebhookEvent): event is WebhookErrorEvent {\n  return event.type === 'webhook_error';\n}\n\nexport function isMessageEvent(event: WebhookEvent): event is MessageReceivedEvent | MessageStatusEvent | MessageReadEvent | MessageDeliveryEvent {\n  return MESSAGE_EVENT_TYPES.includes(event.type as MessageEventType);\n}\n\nexport function isSystemEvent(event: WebhookEvent): event is AccountUpdateEvent | TemplateStatusEvent | PhoneNumberQualityEvent | SecurityEvent | WebhookErrorEvent {\n  return SYSTEM_EVENT_TYPES.includes(event.type as SystemEventType);\n}\n\n/**\n * 事件工具函数\n * Event utility functions\n */\nexport function getEventPriority(event: WebhookEvent): number {\n  switch (event.type) {\n    case 'security_event':\n      return 1; // Highest priority\n    case 'webhook_error':\n      return 2;\n    case 'message_received':\n      return 3;\n    case 'message_status':\n      return 4;\n    case 'template_status':\n      return 5;\n    case 'phone_number_quality':\n      return 6;\n    case 'account_update':\n      return 7;\n    case 'message_read':\n    case 'message_delivery':\n      return 8;\n    case 'user_status_change':\n      return 9; // Lowest priority\n    default:\n      return 10;\n  }\n}\n\nexport function shouldRetryEvent(event: WebhookEvent, error: Error): boolean {\n  // Don't retry security events or webhook errors\n  if (event.type === 'security_event' || event.type === 'webhook_error') {\n    return false;\n  }\n\n  // Don't retry on client errors (4xx)\n  if (error.message.includes('4')) {\n    return false;\n  }\n\n  return true;\n}\n\nexport function getEventTimestamp(event: WebhookEvent): Date {\n  return new Date(event.timestamp);\n}\n\nexport function isEventExpired(event: WebhookEvent, maxAgeMs: number = 24 * 60 * 60 * 1000): boolean {\n  const eventTime = getEventTimestamp(event);\n  const now = new Date();\n  return (now.getTime() - eventTime.getTime()) > maxAgeMs;\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/types/whatsapp-webhook-messages.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/types/whatsapp-webhook-types.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'WhatsAppContact' is defined but never used. Allowed unused vars must match /^_/u.","line":15,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":30,"suggestions":[{"messageId":"removeVar","data":{"varName":"WhatsAppContact"},"fix":{"range":[371,387],"text":""},"desc":"Remove unused variable 'WhatsAppContact'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'WhatsAppContact' is defined but never used. Allowed unused vars must match /^_/u.","line":15,"column":15,"nodeType":null,"messageId":"unusedVar","endLine":15,"endColumn":30},{"ruleId":"no-unused-vars","severity":2,"message":"'WhatsAppMessage' is defined but never used. Allowed unused vars must match /^_/u.","line":15,"column":32,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":47,"suggestions":[{"messageId":"removeVar","data":{"varName":"WhatsAppMessage"},"fix":{"range":[386,403],"text":""},"desc":"Remove unused variable 'WhatsAppMessage'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'WhatsAppMessage' is defined but never used. Allowed unused vars must match /^_/u.","line":15,"column":32,"nodeType":null,"messageId":"unusedVar","endLine":15,"endColumn":47},{"ruleId":"no-unused-vars","severity":2,"message":"'WhatsAppError' is defined but never used. Allowed unused vars must match /^_/u.","line":15,"column":49,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":62,"suggestions":[{"messageId":"removeVar","data":{"varName":"WhatsAppError"},"fix":{"range":[403,418],"text":""},"desc":"Remove unused variable 'WhatsAppError'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'WhatsAppError' is defined but never used. Allowed unused vars must match /^_/u.","line":15,"column":49,"nodeType":null,"messageId":"unusedVar","endLine":15,"endColumn":62},{"ruleId":"no-unused-vars","severity":2,"message":"'MessageStatus' is defined but never used. Allowed unused vars must match /^_/u.","line":15,"column":64,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":77,"suggestions":[{"messageId":"removeVar","data":{"varName":"MessageStatus"},"fix":{"range":[418,433],"text":""},"desc":"Remove unused variable 'MessageStatus'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'MessageStatus' is defined but never used. Allowed unused vars must match /^_/u.","line":15,"column":64,"nodeType":null,"messageId":"unusedVar","endLine":15,"endColumn":77},{"ruleId":"no-unused-vars","severity":2,"message":"'MessageContext' is defined but never used. Allowed unused vars must match /^_/u.","line":22,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":17,"suggestions":[{"messageId":"removeVar","data":{"varName":"MessageContext"},"fix":{"range":[552,570],"text":""},"desc":"Remove unused variable 'MessageContext'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'MessageContext' is defined but never used. Allowed unused vars must match /^_/u.","line":22,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":22,"endColumn":17},{"ruleId":"no-unused-vars","severity":2,"message":"'WebhookSecurityConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":28,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":28,"endColumn":24,"suggestions":[{"messageId":"removeVar","data":{"varName":"WebhookSecurityConfig"},"fix":{"range":[698,723],"text":""},"desc":"Remove unused variable 'WebhookSecurityConfig'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'WebhookSecurityConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":28,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":28,"endColumn":24},{"ruleId":"no-unused-vars","severity":2,"message":"'WebhookRetryConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":29,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":29,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"WebhookRetryConfig"},"fix":{"range":[723,745],"text":""},"desc":"Remove unused variable 'WebhookRetryConfig'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'WebhookRetryConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":29,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":29,"endColumn":21},{"ruleId":"no-unused-vars","severity":2,"message":"'WebhookMonitoringConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":30,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":30,"endColumn":26,"suggestions":[{"messageId":"removeVar","data":{"varName":"WebhookMonitoringConfig"},"fix":{"range":[745,772],"text":""},"desc":"Remove unused variable 'WebhookMonitoringConfig'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'WebhookMonitoringConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":30,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":30,"endColumn":26},{"ruleId":"no-unused-vars","severity":2,"message":"'WebhookStatus' is defined but never used. Allowed unused vars must match /^_/u.","line":31,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":31,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"WebhookStatus"},"fix":{"range":[772,789],"text":""},"desc":"Remove unused variable 'WebhookStatus'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'WebhookStatus' is defined but never used. Allowed unused vars must match /^_/u.","line":31,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":31,"endColumn":16},{"ruleId":"no-unused-vars","severity":2,"message":"'WebhookMetadata' is defined but never used. Allowed unused vars must match /^_/u.","line":32,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":32,"endColumn":18,"suggestions":[{"messageId":"removeVar","data":{"varName":"WebhookMetadata"},"fix":{"range":[789,808],"text":""},"desc":"Remove unused variable 'WebhookMetadata'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'WebhookMetadata' is defined but never used. Allowed unused vars must match /^_/u.","line":32,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":32,"endColumn":18},{"ruleId":"no-unused-vars","severity":2,"message":"'WebhookBatchConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":33,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":33,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"WebhookBatchConfig"},"fix":{"range":[808,830],"text":""},"desc":"Remove unused variable 'WebhookBatchConfig'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'WebhookBatchConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":33,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":33,"endColumn":21},{"ruleId":"no-unused-vars","severity":2,"message":"'WebhookFilterConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":34,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":34,"endColumn":22,"suggestions":[{"messageId":"removeVar","data":{"varName":"WebhookFilterConfig"},"fix":{"range":[830,853],"text":""},"desc":"Remove unused variable 'WebhookFilterConfig'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'WebhookFilterConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":34,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":34,"endColumn":22},{"ruleId":"no-unused-vars","severity":2,"message":"'WebhookTransformConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":35,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":35,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"WebhookTransformConfig"},"fix":{"range":[853,879],"text":""},"desc":"Remove unused variable 'WebhookTransformConfig'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'WebhookTransformConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":35,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":35,"endColumn":25},{"ruleId":"no-unused-vars","severity":2,"message":"'CompleteWebhookConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":36,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":36,"endColumn":24,"suggestions":[{"messageId":"removeVar","data":{"varName":"CompleteWebhookConfig"},"fix":{"range":[879,904],"text":""},"desc":"Remove unused variable 'CompleteWebhookConfig'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CompleteWebhookConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":36,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":36,"endColumn":24},{"ruleId":"no-unused-vars","severity":2,"message":"'WEBHOOK_FIELDS' is defined but never used. Allowed unused vars must match /^_/u.","line":37,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":37,"endColumn":17,"suggestions":[{"messageId":"removeVar","data":{"varName":"WEBHOOK_FIELDS"},"fix":{"range":[904,922],"text":""},"desc":"Remove unused variable 'WEBHOOK_FIELDS'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'WEBHOOK_FIELDS' is defined but never used. Allowed unused vars must match /^_/u.","line":37,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":37,"endColumn":17},{"ruleId":"no-unused-vars","severity":2,"message":"'IncomingOrderMessage' is defined but never used. Allowed unused vars must match /^_/u.","line":51,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":51,"endColumn":23,"suggestions":[{"messageId":"removeVar","data":{"varName":"IncomingOrderMessage"},"fix":{"range":[1230,1254],"text":""},"desc":"Remove unused variable 'IncomingOrderMessage'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'IncomingOrderMessage' is defined but never used. Allowed unused vars must match /^_/u.","line":51,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":51,"endColumn":23},{"ruleId":"no-unused-vars","severity":2,"message":"'IncomingSystemMessage' is defined but never used. Allowed unused vars must match /^_/u.","line":52,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":52,"endColumn":24,"suggestions":[{"messageId":"removeVar","data":{"varName":"IncomingSystemMessage"},"fix":{"range":[1254,1279],"text":""},"desc":"Remove unused variable 'IncomingSystemMessage'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'IncomingSystemMessage' is defined but never used. Allowed unused vars must match /^_/u.","line":52,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":52,"endColumn":24},{"ruleId":"no-unused-vars","severity":2,"message":"'IncomingButtonMessage' is defined but never used. Allowed unused vars must match /^_/u.","line":53,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":53,"endColumn":24,"suggestions":[{"messageId":"removeVar","data":{"varName":"IncomingButtonMessage"},"fix":{"range":[1279,1304],"text":""},"desc":"Remove unused variable 'IncomingButtonMessage'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'IncomingButtonMessage' is defined but never used. Allowed unused vars must match /^_/u.","line":53,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":53,"endColumn":24},{"ruleId":"no-unused-vars","severity":2,"message":"'IncomingTemplateReply' is defined but never used. Allowed unused vars must match /^_/u.","line":54,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":54,"endColumn":24,"suggestions":[{"messageId":"removeVar","data":{"varName":"IncomingTemplateReply"},"fix":{"range":[1304,1329],"text":""},"desc":"Remove unused variable 'IncomingTemplateReply'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'IncomingTemplateReply' is defined but never used. Allowed unused vars must match /^_/u.","line":54,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":54,"endColumn":24},{"ruleId":"no-unused-vars","severity":2,"message":"'INCOMING_MESSAGE_TYPES' is defined but never used. Allowed unused vars must match /^_/u.","line":56,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":56,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"INCOMING_MESSAGE_TYPES"},"fix":{"range":[1356,1382],"text":""},"desc":"Remove unused variable 'INCOMING_MESSAGE_TYPES'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'INCOMING_MESSAGE_TYPES' is defined but never used. Allowed unused vars must match /^_/u.","line":56,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":56,"endColumn":25},{"ruleId":"no-unused-vars","severity":2,"message":"'MEDIA_MESSAGE_TYPES' is defined but never used. Allowed unused vars must match /^_/u.","line":57,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":57,"endColumn":22,"suggestions":[{"messageId":"removeVar","data":{"varName":"MEDIA_MESSAGE_TYPES"},"fix":{"range":[1382,1405],"text":""},"desc":"Remove unused variable 'MEDIA_MESSAGE_TYPES'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'MEDIA_MESSAGE_TYPES' is defined but never used. Allowed unused vars must match /^_/u.","line":57,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":57,"endColumn":22},{"ruleId":"no-unused-vars","severity":2,"message":"'INTERACTIVE_MESSAGE_TYPES' is defined but never used. Allowed unused vars must match /^_/u.","line":58,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":58,"endColumn":28,"suggestions":[{"messageId":"removeVar","data":{"varName":"INTERACTIVE_MESSAGE_TYPES"},"fix":{"range":[1405,1434],"text":""},"desc":"Remove unused variable 'INTERACTIVE_MESSAGE_TYPES'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'INTERACTIVE_MESSAGE_TYPES' is defined but never used. Allowed unused vars must match /^_/u.","line":58,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":58,"endColumn":28},{"ruleId":"no-unused-vars","severity":2,"message":"'MessageReadEvent' is defined but never used. Allowed unused vars must match /^_/u.","line":65,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":65,"endColumn":19,"suggestions":[{"messageId":"removeVar","data":{"varName":"MessageReadEvent"},"fix":{"range":[1554,1574],"text":""},"desc":"Remove unused variable 'MessageReadEvent'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'MessageReadEvent' is defined but never used. Allowed unused vars must match /^_/u.","line":65,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":65,"endColumn":19},{"ruleId":"no-unused-vars","severity":2,"message":"'MessageDeliveryEvent' is defined but never used. Allowed unused vars must match /^_/u.","line":66,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":66,"endColumn":23,"suggestions":[{"messageId":"removeVar","data":{"varName":"MessageDeliveryEvent"},"fix":{"range":[1574,1598],"text":""},"desc":"Remove unused variable 'MessageDeliveryEvent'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'MessageDeliveryEvent' is defined but never used. Allowed unused vars must match /^_/u.","line":66,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":66,"endColumn":23},{"ruleId":"no-unused-vars","severity":2,"message":"'UserStatusChangeEvent' is defined but never used. Allowed unused vars must match /^_/u.","line":67,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":67,"endColumn":24,"suggestions":[{"messageId":"removeVar","data":{"varName":"UserStatusChangeEvent"},"fix":{"range":[1598,1623],"text":""},"desc":"Remove unused variable 'UserStatusChangeEvent'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'UserStatusChangeEvent' is defined but never used. Allowed unused vars must match /^_/u.","line":67,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":67,"endColumn":24},{"ruleId":"no-unused-vars","severity":2,"message":"'AccountUpdateEvent' is defined but never used. Allowed unused vars must match /^_/u.","line":68,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":68,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"AccountUpdateEvent"},"fix":{"range":[1623,1645],"text":""},"desc":"Remove unused variable 'AccountUpdateEvent'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'AccountUpdateEvent' is defined but never used. Allowed unused vars must match /^_/u.","line":68,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":68,"endColumn":21},{"ruleId":"no-unused-vars","severity":2,"message":"'TemplateStatusEvent' is defined but never used. Allowed unused vars must match /^_/u.","line":69,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":69,"endColumn":22,"suggestions":[{"messageId":"removeVar","data":{"varName":"TemplateStatusEvent"},"fix":{"range":[1645,1668],"text":""},"desc":"Remove unused variable 'TemplateStatusEvent'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'TemplateStatusEvent' is defined but never used. Allowed unused vars must match /^_/u.","line":69,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":69,"endColumn":22},{"ruleId":"no-unused-vars","severity":2,"message":"'PhoneNumberQualityEvent' is defined but never used. Allowed unused vars must match /^_/u.","line":70,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":70,"endColumn":26,"suggestions":[{"messageId":"removeVar","data":{"varName":"PhoneNumberQualityEvent"},"fix":{"range":[1668,1695],"text":""},"desc":"Remove unused variable 'PhoneNumberQualityEvent'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'PhoneNumberQualityEvent' is defined but never used. Allowed unused vars must match /^_/u.","line":70,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":70,"endColumn":26},{"ruleId":"no-unused-vars","severity":2,"message":"'SecurityEvent' is defined but never used. Allowed unused vars must match /^_/u.","line":71,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":71,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"SecurityEvent"},"fix":{"range":[1695,1712],"text":""},"desc":"Remove unused variable 'SecurityEvent'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'SecurityEvent' is defined but never used. Allowed unused vars must match /^_/u.","line":71,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":71,"endColumn":16},{"ruleId":"no-unused-vars","severity":2,"message":"'EventFilter' is defined but never used. Allowed unused vars must match /^_/u.","line":74,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":74,"endColumn":14,"suggestions":[{"messageId":"removeVar","data":{"varName":"EventFilter"},"fix":{"range":[1748,1763],"text":""},"desc":"Remove unused variable 'EventFilter'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'EventFilter' is defined but never used. Allowed unused vars must match /^_/u.","line":74,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":74,"endColumn":14},{"ruleId":"no-unused-vars","severity":2,"message":"'EventProcessingConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":75,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":75,"endColumn":24,"suggestions":[{"messageId":"removeVar","data":{"varName":"EventProcessingConfig"},"fix":{"range":[1763,1788],"text":""},"desc":"Remove unused variable 'EventProcessingConfig'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'EventProcessingConfig' is defined but never used. Allowed unused vars must match /^_/u.","line":75,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":75,"endColumn":24},{"ruleId":"no-unused-vars","severity":2,"message":"'EventStatistics' is defined but never used. Allowed unused vars must match /^_/u.","line":76,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":76,"endColumn":18,"suggestions":[{"messageId":"removeVar","data":{"varName":"EventStatistics"},"fix":{"range":[1788,1807],"text":""},"desc":"Remove unused variable 'EventStatistics'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'EventStatistics' is defined but never used. Allowed unused vars must match /^_/u.","line":76,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":76,"endColumn":18},{"ruleId":"no-unused-vars","severity":2,"message":"'EventBatch' is defined but never used. Allowed unused vars must match /^_/u.","line":77,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":77,"endColumn":13,"suggestions":[{"messageId":"removeVar","data":{"varName":"EventBatch"},"fix":{"range":[1807,1821],"text":""},"desc":"Remove unused variable 'EventBatch'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'EventBatch' is defined but never used. Allowed unused vars must match /^_/u.","line":77,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":77,"endColumn":13},{"ruleId":"no-unused-vars","severity":2,"message":"'WEBHOOK_EVENT_TYPES' is defined but never used. Allowed unused vars must match /^_/u.","line":78,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":78,"endColumn":22,"suggestions":[{"messageId":"removeVar","data":{"varName":"WEBHOOK_EVENT_TYPES"},"fix":{"range":[1821,1844],"text":""},"desc":"Remove unused variable 'WEBHOOK_EVENT_TYPES'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'WEBHOOK_EVENT_TYPES' is defined but never used. Allowed unused vars must match /^_/u.","line":78,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":78,"endColumn":22},{"ruleId":"no-unused-vars","severity":2,"message":"'WebhookUtils' is defined but never used. Allowed unused vars must match /^_/u.","line":82,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":82,"endColumn":15,"suggestions":[{"messageId":"removeVar","data":{"varName":"WebhookUtils"},"fix":{"range":[1894,1907],"text":""},"desc":"Remove unused variable 'WebhookUtils'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'WebhookUtils' is defined but never used. Allowed unused vars must match /^_/u.","line":82,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":82,"endColumn":15},{"ruleId":"no-unused-vars","severity":2,"message":"'isWebhookVerificationRequest' is defined but never used. Allowed unused vars must match /^_/u.","line":83,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":83,"endColumn":31,"suggestions":[{"messageId":"removeVar","data":{"varName":"isWebhookVerificationRequest"},"fix":{"range":[1906,1938],"text":""},"desc":"Remove unused variable 'isWebhookVerificationRequest'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'isWebhookVerificationRequest' is defined but never used. Allowed unused vars must match /^_/u.","line":83,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":83,"endColumn":31},{"ruleId":"no-unused-vars","severity":2,"message":"'createWebhookVerificationResponse' is defined but never used. Allowed unused vars must match /^_/u.","line":84,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":84,"endColumn":36,"suggestions":[{"messageId":"removeVar","data":{"varName":"createWebhookVerificationResponse"},"fix":{"range":[1938,1975],"text":""},"desc":"Remove unused variable 'createWebhookVerificationResponse'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'createWebhookVerificationResponse' is defined but never used. Allowed unused vars must match /^_/u.","line":84,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":84,"endColumn":36},{"ruleId":"no-unused-vars","severity":2,"message":"'createWebhookError' is defined but never used. Allowed unused vars must match /^_/u.","line":85,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":85,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"createWebhookError"},"fix":{"range":[1975,1997],"text":""},"desc":"Remove unused variable 'createWebhookError'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'createWebhookError' is defined but never used. Allowed unused vars must match /^_/u.","line":85,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":85,"endColumn":21},{"ruleId":"no-unused-vars","severity":2,"message":"'isRetryableError' is defined but never used. Allowed unused vars must match /^_/u.","line":86,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":86,"endColumn":19,"suggestions":[{"messageId":"removeVar","data":{"varName":"isRetryableError"},"fix":{"range":[1997,2017],"text":""},"desc":"Remove unused variable 'isRetryableError'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'isRetryableError' is defined but never used. Allowed unused vars must match /^_/u.","line":86,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":86,"endColumn":19},{"ruleId":"no-unused-vars","severity":2,"message":"'isTimestampValid' is defined but never used. Allowed unused vars must match /^_/u.","line":87,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":87,"endColumn":19,"suggestions":[{"messageId":"removeVar","data":{"varName":"isTimestampValid"},"fix":{"range":[2017,2037],"text":""},"desc":"Remove unused variable 'isTimestampValid'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'isTimestampValid' is defined but never used. Allowed unused vars must match /^_/u.","line":87,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":87,"endColumn":19}],"suppressedMessages":[],"errorCount":80,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * WhatsApp Webhook 类型定义 - 主入口\n * WhatsApp Webhook Type Definitions - Main Entry Point\n *\n * 统一的WhatsApp Business API webhook类型入口，整合所有webhook相关类型定义\n */\n\n// 重新导出所有模块的功能\nexport * from './whatsapp-webhook-base';\nexport * from './whatsapp-webhook-messages';\nexport * from './whatsapp-webhook-events';\nexport * from './whatsapp-webhook-utils';\n\n// 向后兼容的重新导出\nimport type { WhatsAppContact, WhatsAppMessage, WhatsAppError, MessageStatus } from './whatsapp-base-types';\n\nimport type {\n  WebhookEntry,\n  WebhookPayload,\n  MessageStatusUpdate,\n  WebhookError,\n  MessageContext,\n  WebhookVerificationRequest,\n  WebhookVerificationResponse,\n  WebhookConfig,\n  WebhookSubscription,\n  WebhookProcessingResult,\n  WebhookSecurityConfig,\n  WebhookRetryConfig,\n  WebhookMonitoringConfig,\n  WebhookStatus,\n  WebhookMetadata,\n  WebhookBatchConfig,\n  WebhookFilterConfig,\n  WebhookTransformConfig,\n  CompleteWebhookConfig,\n  WEBHOOK_FIELDS,\n} from './whatsapp-webhook-base';\n\nimport type {\n  IncomingTextMessage,\n  IncomingImageMessage,\n  IncomingDocumentMessage,\n  IncomingAudioMessage,\n  IncomingVideoMessage,\n  IncomingLocationMessage,\n  IncomingContactsMessage,\n  IncomingInteractiveMessage,\n  IncomingReactionMessage,\n  IncomingStickerMessage,\n  IncomingOrderMessage,\n  IncomingSystemMessage,\n  IncomingButtonMessage,\n  IncomingTemplateReply,\n  IncomingWhatsAppMessage,\n  INCOMING_MESSAGE_TYPES,\n  MEDIA_MESSAGE_TYPES,\n  INTERACTIVE_MESSAGE_TYPES,\n} from './whatsapp-webhook-messages';\n\nimport type {\n  MessageReceivedEvent,\n  MessageStatusEvent,\n  WebhookErrorEvent,\n  MessageReadEvent,\n  MessageDeliveryEvent,\n  UserStatusChangeEvent,\n  AccountUpdateEvent,\n  TemplateStatusEvent,\n  PhoneNumberQualityEvent,\n  SecurityEvent,\n  WebhookEvent,\n  WebhookProcessor,\n  EventFilter,\n  EventProcessingConfig,\n  EventStatistics,\n  EventBatch,\n  WEBHOOK_EVENT_TYPES,\n} from './whatsapp-webhook-events';\n\nimport {\n  WebhookUtils,\n  isWebhookVerificationRequest,\n  createWebhookVerificationResponse,\n  createWebhookError,\n  isRetryableError,\n  isTimestampValid,\n} from './whatsapp-webhook-utils';\n\n// ==================== 向后兼容的类型别名 ====================\n\n/**\n * 向后兼容的类型别名\n * Backward compatible type aliases\n */\nexport type {\n  // 基础类型\n  WebhookPayload as Webhook,\n  WebhookEntry as Entry,\n  MessageStatusUpdate as StatusUpdate,\n  WebhookError as Error,\n\n  // 消息类型\n  IncomingWhatsAppMessage as IncomingMessage,\n  IncomingTextMessage as TextMessage,\n  IncomingImageMessage as ImageMessage,\n  IncomingDocumentMessage as DocumentMessage,\n  IncomingAudioMessage as AudioMessage,\n  IncomingVideoMessage as VideoMessage,\n  IncomingLocationMessage as LocationMessage,\n  IncomingContactsMessage as ContactsMessage,\n  IncomingInteractiveMessage as InteractiveMessage,\n  IncomingReactionMessage as ReactionMessage,\n  IncomingStickerMessage as StickerMessage,\n\n  // 事件类型\n  MessageReceivedEvent as MessageEvent,\n  MessageStatusEvent as StatusEvent,\n  WebhookErrorEvent as ErrorEvent,\n  WebhookEvent as Event,\n\n  // 配置类型\n  WebhookConfig as Config,\n  WebhookSubscription as Subscription,\n  WebhookProcessor as Processor,\n  WebhookProcessingResult as ProcessingResult,\n\n  // 验证类型\n  WebhookVerificationRequest as VerificationRequest,\n  WebhookVerificationResponse as VerificationResponse,\n};\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/types/whatsapp-webhook-utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/types/whatsapp-webhook-utils/functions.ts","messages":[{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 600.","line":45,"column":44,"nodeType":"Literal","messageId":"noMagic","endLine":45,"endColumn":47}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * WhatsApp Webhook 工具函数\n * WhatsApp Webhook Utility Functions\n */\n\nimport type {\n  WebhookVerificationRequest,\n  WebhookError\n} from '../whatsapp-webhook-base';\n\n/**\n * Webhook验证工具函数\n * Webhook verification utility functions\n */\nexport function isWebhookVerificationRequest(query: unknown): query is WebhookVerificationRequest {\n  return (\n    query &&\n    typeof query === 'object' &&\n    'hub.mode' in query &&\n    'hub.challenge' in query &&\n    'hub.verify_token' in query &&\n    query['hub.mode'] === 'subscribe'\n  );\n}\n\nexport function createWebhookVerificationResponse(challenge: string) {\n  return { challenge };\n}\n\n/**\n * 错误处理工具函数\n * Error handling utility functions\n */\nexport function createWebhookError(code: number, message: string, details?: string): WebhookError {\n  return {\n    code,\n    title: 'Webhook Error',\n    message,\n    error_data: details ? { details } : undefined,\n  };\n}\n\nexport function isRetryableError(error: WebhookError): boolean {\n  // 5xx 错误通常可以重试\n  return error.code >= 500 && error.code < 600;\n}\n\n/**\n * 时间工具函数\n * Time utility functions\n */\nexport function isTimestampValid(timestamp: string, maxAgeSeconds: number = 300): boolean {\n  try {\n    const eventTime = new Date(timestamp);\n    const now = new Date();\n    const ageSeconds = (now.getTime() - eventTime.getTime()) / 1000;\n    return ageSeconds <= maxAgeSeconds;\n  } catch {\n    return false;\n  }\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/types/whatsapp-webhook-utils/interfaces.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'context' is defined but never used. Allowed unused args must match /^_/u.","line":103,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":103,"endColumn":59,"suggestions":[{"messageId":"removeVar","data":{"varName":"context"},"fix":{"range":[2215,2248],"text":""},"desc":"Remove unused variable 'context'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * WhatsApp Webhook 工具接口定义\n * WhatsApp Webhook Utility Interface Definitions\n */\n\nimport type { WebhookEvent } from '../whatsapp-webhook-events';\n\n/**\n * Webhook解析结果\n * Webhook parsing result\n */\nexport interface WebhookParsingResult {\n  success: boolean;\n  events: WebhookEvent[];\n  errors: Array<{\n    entry_id?: string;\n    error: string;\n    raw_data?: Record<string, unknown> | string | unknown[];\n  }>;\n  metadata: {\n    total_entries: number;\n    parsed_entries: number;\n    total_events: number;\n    parsing_time_ms: number;\n  };\n}\n\n/**\n * Webhook验证结果\n * Webhook validation result\n */\nexport interface WebhookValidationResult {\n  is_valid: boolean;\n  errors: string[];\n  warnings: string[];\n  signature_valid?: boolean;\n  timestamp_valid?: boolean;\n  payload_valid?: boolean;\n}\n\n/**\n * Webhook签名验证配置\n * Webhook signature verification configuration\n */\nexport interface SignatureVerificationConfig {\n  app_secret: string;\n  signature_header: string;\n  timestamp_header?: string;\n  max_timestamp_age_seconds?: number;\n  algorithm: 'sha1' | 'sha256';\n}\n\n/**\n * Webhook处理上下文\n * Webhook processing context\n */\nexport interface WebhookProcessingContext {\n  request_id: string;\n  timestamp: string;\n  source_ip?: string;\n  user_agent?: string;\n  headers: Record<string, string>;\n  processing_start_time: number;\n  retry_count?: number;\n  batch_id?: string;\n}\n\n/**\n * Webhook响应配置\n * Webhook response configuration\n */\nexport interface WebhookResponseConfig {\n  success_status_code: number;\n  error_status_code: number;\n  include_processing_time: boolean;\n  include_event_count: boolean;\n  custom_headers?: Record<string, string>;\n  response_format: 'json' | 'text' | 'empty';\n}\n\n/**\n * Webhook重复检测配置\n * Webhook deduplication configuration\n */\nexport interface DeduplicationConfig {\n  enabled: boolean;\n  key_fields: string[];\n  window_minutes: number;\n  storage_type: 'memory' | 'redis' | 'database';\n  max_entries: number;\n}\n\n/**\n * Webhook限流配置\n * Webhook rate limiting configuration\n */\nexport interface RateLimitConfig {\n  enabled: boolean;\n  max_requests_per_minute: number;\n  max_requests_per_hour: number;\n  burst_limit: number;\n  key_generator: 'ip' | 'phone_number' | 'custom';\n  custom_key_function?: (context: WebhookProcessingContext) => string;\n}\n\n/**\n * Webhook健康检查结果\n * Webhook health check result\n */\nexport interface WebhookHealthCheck {\n  status: 'healthy' | 'degraded' | 'unhealthy';\n  checks: {\n    endpoint_reachable: boolean;\n    signature_verification: boolean;\n    event_processing: boolean;\n    error_rate_acceptable: boolean;\n    response_time_acceptable: boolean;\n  };\n  metrics: {\n    uptime_percentage: number;\n    average_response_time_ms: number;\n    error_rate_percentage: number;\n    last_successful_event?: string;\n    last_error?: string;\n  };\n  recommendations: string[];\n}\n\n/**\n * Webhook调试信息\n * Webhook debug information\n */\nexport interface WebhookDebugInfo {\n  request: {\n    method: string;\n    url: string;\n    headers: Record<string, string>;\n    body: string;\n    timestamp: string;\n  };\n  processing: {\n    parsed_events: WebhookEvent[];\n    validation_result: WebhookValidationResult;\n    processing_time_ms: number;\n    errors: string[];\n  };\n  response: {\n    status_code: number;\n    headers: Record<string, string>;\n    body: string;\n    timestamp: string;\n  };\n}\n\n/**\n * 事件聚合结果\n * Event aggregation result\n */\nexport interface EventAggregationResult {\n  time_period: {\n    start: string;\n    end: string;\n    duration_minutes: number;\n  };\n  totals: {\n    events: number;\n    unique_senders: number;\n    unique_recipients: number;\n    messages: number;\n    errors: number;\n  };\n  by_type: Record<string, number>;\n  by_hour: Array<{\n    hour: string;\n    count: number;\n  }>;\n  top_senders: Array<{\n    phone_number: string;\n    count: number;\n  }>;\n  error_summary: Array<{\n    error_code: number;\n    count: number;\n    message: string;\n  }>;\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/types/whatsapp-webhook-utils/webhook-utils.ts","messages":[{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":189,"column":22,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":189,"endColumn":39},{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":200,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":200,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":200,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":200,"endColumn":19},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0.95.","line":284,"column":69,"nodeType":"Literal","messageId":"noMagic","endLine":284,"endColumn":73},{"ruleId":"no-magic-numbers","severity":2,"message":"No magic number: 0.99.","line":285,"column":69,"nodeType":"Literal","messageId":"noMagic","endLine":285,"endColumn":73}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * WhatsApp Webhook 工具类\n * WhatsApp Webhook Utility Class\n */\n\nimport type {\n  WebhookPayload,\n  WebhookEntry,\n} from '../whatsapp-webhook-base';\nimport type { IncomingWhatsAppMessage } from '../whatsapp-webhook-messages';\nimport type { WebhookEvent, EventFilter, EventStatistics } from '../whatsapp-webhook-events';\nimport type {\n  WebhookParsingResult,\n  WebhookValidationResult,\n  SignatureVerificationConfig,\n} from './interfaces';\n\n/**\n * Webhook工具函数\n * Webhook utility functions\n */\nexport class WebhookUtils {\n  /**\n   * 解析Webhook载荷为事件\n   * Parse webhook payload into events\n   */\n  static parseWebhookPayload(payload: WebhookPayload): WebhookParsingResult {\n    const startTime = Date.now();\n    const events: WebhookEvent[] = [];\n    const errors: Array<{ entry_id?: string; error: string; raw_data?: Record<string, unknown> | string | unknown[] }> = [];\n\n    try {\n      for (const entry of payload.entry) {\n        try {\n          const entryEvents = this.parseWebhookEntry(entry);\n          events.push(...entryEvents);\n        } catch (error) {\n          errors.push({\n            entry_id: entry.id,\n            error: error instanceof Error ? error.message : 'Unknown parsing error',\n            raw_data: entry,\n          });\n        }\n      }\n\n      return {\n        success: errors.length === 0,\n        events,\n        errors,\n        metadata: {\n          total_entries: payload.entry.length,\n          parsed_entries: payload.entry.length - errors.length,\n          total_events: events.length,\n          parsing_time_ms: Date.now() - startTime,\n        },\n      };\n    } catch (error) {\n      return {\n        success: false,\n        events: [],\n        errors: [{\n          error: error instanceof Error ? error.message : 'Failed to parse webhook payload',\n          raw_data: payload,\n        }],\n        metadata: {\n          total_entries: payload.entry?.length || 0,\n          parsed_entries: 0,\n          total_events: 0,\n          parsing_time_ms: Date.now() - startTime,\n        },\n      };\n    }\n  }\n\n  /**\n   * 解析单个Webhook条目\n   * Parse single webhook entry\n   */\n  private static parseWebhookEntry(entry: WebhookEntry): WebhookEvent[] {\n    const events: WebhookEvent[] = [];\n    const timestamp = new Date().toISOString();\n\n    for (const change of entry.changes) {\n      const { value } = change;\n      const phoneNumberId = value.metadata.phone_number_id;\n\n      // 处理消息\n      if (value.messages) {\n        for (const message of value.messages) {\n          const contact = value.contacts?.find(c => c.wa_id === message.from);\n          events.push({\n            type: 'message_received',\n            timestamp,\n            phone_number_id: phoneNumberId,\n            from: message.from,\n            message: message as IncomingWhatsAppMessage,\n            contact,\n          });\n        }\n      }\n\n      // 处理状态更新\n      if (value.statuses) {\n        for (const status of value.statuses) {\n          events.push({\n            type: 'message_status',\n            timestamp,\n            phone_number_id: phoneNumberId,\n            status_update: status,\n          });\n        }\n      }\n\n      // 处理错误\n      if (value.errors) {\n        for (const error of value.errors) {\n          events.push({\n            type: 'webhook_error',\n            timestamp,\n            phone_number_id: phoneNumberId,\n            error,\n          });\n        }\n      }\n    }\n\n    return events;\n  }\n\n  /**\n   * 验证Webhook载荷\n   * Validate webhook payload\n   */\n  static validateWebhookPayload(payload: unknown): WebhookValidationResult {\n    const errors: string[] = [];\n    const warnings: string[] = [];\n\n    // 基本结构验证\n    if (!payload || typeof payload !== 'object') {\n      errors.push('Payload must be an object');\n      return { is_valid: false, errors, warnings };\n    }\n\n    if (payload.object !== 'whatsapp_business_account') {\n      errors.push('Invalid object type, expected \"whatsapp_business_account\"');\n    }\n\n    if (!Array.isArray(payload.entry)) {\n      errors.push('Entry must be an array');\n    } else {\n      // 验证每个条目\n      payload.entry.forEach((entry: Record<string, unknown>, index: number) => {\n        if (!entry.id) {\n          errors.push(`Entry ${index}: Missing id`);\n        }\n        if (!Array.isArray(entry.changes)) {\n          errors.push(`Entry ${index}: Changes must be an array`);\n        } else {\n          entry.changes.forEach((change: Record<string, unknown>, changeIndex: number) => {\n            if (!change.value) {\n              errors.push(`Entry ${index}, Change ${changeIndex}: Missing value`);\n            }\n            if (!change.value?.metadata?.phone_number_id) {\n              errors.push(`Entry ${index}, Change ${changeIndex}: Missing phone_number_id`);\n            }\n          });\n        }\n      });\n    }\n\n    return {\n      is_valid: errors.length === 0,\n      errors,\n      warnings,\n      payload_valid: errors.length === 0,\n    };\n  }\n\n  /**\n   * 验证Webhook签名\n   * Verify webhook signature\n   */\n  static verifyWebhookSignature(\n    payload: string,\n    signature: string,\n    config: SignatureVerificationConfig\n  ): boolean {\n    try {\n      const crypto = require('crypto');\n      const expectedSignature = crypto\n        .createHmac(config.algorithm, config.app_secret)\n        .update(payload)\n        .digest('hex');\n\n      const receivedSignature = signature.replace(/^sha\\d+=/, '');\n      return crypto.timingSafeEqual(\n        Buffer.from(expectedSignature, 'hex'),\n        Buffer.from(receivedSignature, 'hex')\n      );\n    } catch (error) {\n      return false;\n    }\n  }\n\n  /**\n   * 生成事件唯一键\n   * Generate event unique key\n   */\n  static generateEventKey(event: WebhookEvent): string {\n    switch (event.type) {\n      case 'message_received':\n        return `msg_${event.message.id}_${event.timestamp}`;\n      case 'message_status':\n        return `status_${event.status_update.id}_${event.status_update.status}_${event.timestamp}`;\n      default:\n        return `${event.type}_${event.phone_number_id}_${event.timestamp}`;\n    }\n  }\n\n  /**\n   * 过滤事件\n   * Filter events\n   */\n  static filterEvents(events: WebhookEvent[], filter: EventFilter): WebhookEvent[] {\n    return events.filter(event => {\n      // 事件类型过滤\n      if (filter.event_types && !filter.event_types.includes(event.type)) {\n        return false;\n      }\n\n      // 电话号码过滤\n      if (filter.phone_number_ids && !filter.phone_number_ids.includes(event.phone_number_id)) {\n        return false;\n      }\n\n      // 发送者过滤\n      if (filter.sender_filters && 'from' in event) {\n        const from = (event as Record<string, unknown>).from as string;\n        if (filter.sender_filters.include && !filter.sender_filters.include.includes(from)) {\n          return false;\n        }\n        if (filter.sender_filters.exclude && filter.sender_filters.exclude.includes(from)) {\n          return false;\n        }\n      }\n\n      // 时间范围过滤\n      if (filter.time_range) {\n        const eventTime = new Date(event.timestamp);\n        const startTime = new Date(filter.time_range.start);\n        const endTime = new Date(filter.time_range.end);\n        if (eventTime < startTime || eventTime > endTime) {\n          return false;\n        }\n      }\n\n      return true;\n    });\n  }\n\n  /**\n   * 聚合事件统计\n   * Aggregate event statistics\n   */\n  static aggregateEventStatistics(events: WebhookEvent[]): EventStatistics {\n    const eventsByType: Record<string, number> = {};\n    const processingTimes: number[] = [];\n\n    events.forEach(event => {\n      eventsByType[event.type] = (eventsByType[event.type] || 0) + 1;\n      // 模拟处理时间（实际应用中应该记录真实的处理时间）\n      processingTimes.push(Math.random() * 100);\n    });\n\n    processingTimes.sort((a, b) => a - b);\n\n    return {\n      total_events: events.length,\n      events_by_type: eventsByType,\n      processing_times: {\n        average_ms: processingTimes.reduce((a, b) => a + b, 0) / processingTimes.length || 0,\n        min_ms: processingTimes[0] || 0,\n        max_ms: processingTimes[processingTimes.length - 1] || 0,\n        p95_ms: processingTimes[Math.floor(processingTimes.length * 0.95)] || 0,\n        p99_ms: processingTimes[Math.floor(processingTimes.length * 0.99)] || 0,\n      },\n      error_rate: 0, // 应该基于实际错误计算\n      success_rate: 1, // 应该基于实际成功率计算\n      last_processed_at: events.length > 0 ? new Date().toISOString() : undefined,\n    };\n  }\n}\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/src/types/whatsapp.ts","messages":[{"ruleId":"no-undef","severity":2,"message":"'WhatsAppConfig' is not defined.","line":94,"column":3,"nodeType":"Identifier","messageId":"undef","endLine":94,"endColumn":17},{"ruleId":"no-undef","severity":2,"message":"'WhatsAppMessage' is not defined.","line":94,"column":29,"nodeType":"Identifier","messageId":"undef","endLine":94,"endColumn":44},{"ruleId":"no-undef","severity":2,"message":"'SendMessageRequest' is not defined.","line":94,"column":57,"nodeType":"Identifier","messageId":"undef","endLine":94,"endColumn":75},{"ruleId":"no-undef","severity":2,"message":"'SendMessageResponse' is not defined.","line":95,"column":3,"nodeType":"Identifier","messageId":"undef","endLine":95,"endColumn":22},{"ruleId":"no-undef","severity":2,"message":"'TemplateMessage' is not defined.","line":95,"column":40,"nodeType":"Identifier","messageId":"undef","endLine":95,"endColumn":55},{"ruleId":"no-undef","severity":2,"message":"'WebhookPayload' is not defined.","line":95,"column":69,"nodeType":"Identifier","messageId":"undef","endLine":95,"endColumn":83}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * WhatsApp API Type Definitions - Main Entry Point\n *\n * This file serves as a unified entry point for all WhatsApp Business API type definitions,\n * re-exporting all related functionality from modular type files.\n */\n\n// 基础类型 - Base Types\nexport {\n  type WhatsAppContact, type WhatsAppMessage, type WhatsAppError, type MessageStatus,\n  type MessageStatusUpdate, type LocationData, type ContactData, type MessageType, type MediaType,\n  type MediaObject, type ImageMedia, type DocumentMedia, type VideoMedia, type AudioMedia,\n  type ContactName, type ContactPhone, type ContactEmail, type ContactUrl, type ContactAddress, type ContactOrg,\n  isTextMessage, isImageMessage, isDocumentMessage, isAudioMessage, isVideoMessage, isLocationMessage, isContactsMessage,\n  validateWhatsAppMessage, type MessageValidationResult,\n  WHATSAPP_MESSAGE_TYPES, WHATSAPP_MESSAGE_STATUSES, SUPPORTED_MEDIA_TYPES,\n  isValidMessageType, isValidMessageStatus, isValidMediaType,\n  type Contact, type Message, type Error, type StatusUpdate, type Location, type ContactInfo,\n} from './whatsapp-base-types';\n\n// 模板消息类型 - Template Types\nexport {\n  type TemplateParameter, type TemplateComponent, type TemplateLanguage, type TemplateMessage,\n  type HeaderComponent, type BodyComponent, type FooterComponent, type ButtonComponent,\n  type TemplateBuilder, type TemplateValidationResult, type TextParameterBuilder, type CurrencyParameterBuilder,\n  type DateTimeParameterBuilder, type MediaParameterBuilder, type TemplateComponentType, type TemplateParameterType, type ButtonSubType,\n  TEMPLATE_COMPONENT_TYPES, TEMPLATE_PARAMETER_TYPES, BUTTON_SUB_TYPES, SUPPORTED_LANGUAGE_CODES,\n  isValidTemplateComponentType, isValidTemplateParameterType, isValidButtonSubType, isValidLanguageCode,\n  isHeaderComponent, isBodyComponent, isFooterComponent, isButtonComponent,\n  validateTemplateParameter, validateTemplateComponent, validateTemplateMessage,\n  createTextParameter, createCurrencyParameter, createDateTimeParameter, createMediaParameter,\n  type Template, type Component, type Parameter, type Language,\n} from './whatsapp-template-types';\n\n// 特定消息类型 - Message Types\nexport {\n  type TextMessage, type ImageMessage, type DocumentMessage, type AudioMessage, type VideoMessage,\n  type LocationMessage, type ContactsMessage, type TemplateMessageRequest, type InteractiveMessage,\n  type InteractiveButton, type InteractiveListRow, type InteractiveListSection, type InteractiveHeader,\n  type InteractiveBody, type InteractiveFooter, type InteractiveButtonAction, type InteractiveListAction,\n  type ReactionMessage, type StickerMessage, type WhatsAppOutgoingMessage, type MediaMessage, type InteractiveMessageType,\n  type MessageBuilder, type TextMessageBuilder, type MediaMessageBuilder, type InteractiveMessageBuilder,\n  isTextMessage as isOutgoingTextMessage, isImageMessage as isOutgoingImageMessage, isDocumentMessage as isOutgoingDocumentMessage,\n  isAudioMessage as isOutgoingAudioMessage, isVideoMessage as isOutgoingVideoMessage, isLocationMessage as isOutgoingLocationMessage,\n  isContactsMessage as isOutgoingContactsMessage, isTemplateMessage, isInteractiveMessage, isReactionMessage, isStickerMessage,\n  isMediaMessage, isButtonInteractive, isListInteractive, validateTextMessage, validateInteractiveMessage,\n  MESSAGE_TYPES, MEDIA_MESSAGE_TYPES, INTERACTIVE_TYPES,\n  type OutgoingMessage, type Text, type Image, type Interactive, type Template as TemplateRequest,\n} from './whatsapp-message-types';\n\n// API 请求和响应类型 - API Types\nexport {\n  type SendMessageRequest, type SendMessageResponse, type WhatsAppApiResponse, type WhatsAppServiceResponse,\n  type WhatsAppApiErrorResponse, type WhatsAppApiError, type MediaUploadRequest, type MediaUploadResponse, type MediaRetrieveResponse,\n  type PhoneNumberInfo, type PhoneNumbersResponse, type BusinessProfile, type BusinessProfileResponse,\n  type TemplateStatus, type TemplatesResponse, type AnalyticsRequest, type AnalyticsDataPoint, type AnalyticsResponse,\n  type RateLimitInfo, type ApiConfig, type ApiRequestOptions, type PaginationCursors, type PaginationInfo, type PaginatedResponse,\n  type ApiRequest, type ApiResponse, type BatchRequest, type BatchResponse, type ApiEndpoint, type HttpMethod,\n  isSuccessResponse, isErrorResponse, isWhatsAppApiError, API_ENDPOINTS, HTTP_METHODS, API_VERSIONS, DEFAULT_API_CONFIG,\n  type SendRequest, type SendResponse, type ApiResponse as ApiResponseType, type ServiceResponse, type ApiError, type UploadRequest, type UploadResponse,\n} from './whatsapp-api-types';\n\n// Webhook 类型 - Webhook Types\nexport {\n  type WebhookEntry, type WebhookPayload, type MessageStatusUpdate, type WebhookError,\n  type IncomingTextMessage, type IncomingImageMessage, type IncomingDocumentMessage, type IncomingAudioMessage,\n  type IncomingVideoMessage, type IncomingLocationMessage, type IncomingContactsMessage, type IncomingInteractiveMessage,\n  type IncomingReactionMessage, type IncomingStickerMessage, type IncomingWhatsAppMessage, type MessageContext,\n  type MessageReceivedEvent, type MessageStatusEvent, type WebhookErrorEvent, type WebhookEvent,\n  type WebhookVerificationRequest, type WebhookVerificationResponse, type WebhookConfig, type WebhookSubscription,\n  type WebhookProcessor, type WebhookProcessingResult,\n  isIncomingTextMessage, isIncomingImageMessage, isIncomingDocumentMessage, isIncomingAudioMessage,\n  isIncomingVideoMessage, isIncomingLocationMessage, isIncomingContactsMessage, isIncomingInteractiveMessage,\n  isIncomingReactionMessage, isIncomingStickerMessage, isMessageReceivedEvent, isMessageStatusEvent, isWebhookErrorEvent,\n  isValidWebhookPayload, isValidWebhookVerification, WEBHOOK_FIELDS, INCOMING_MESSAGE_TYPES, WEBHOOK_EVENT_TYPES,\n  type Webhook, type IncomingMessage, type MessageEvent, type StatusEvent, type Processor,\n} from './whatsapp-webhook-types';\n\n// 服务配置和错误类型 - Service Types\nexport {\n  type WhatsAppConfig, type WhatsAppServiceOptions, type ServiceEnvironmentConfig,\n  WhatsAppError, WhatsAppApiError, WhatsAppValidationError, WhatsAppRateLimitError, WhatsAppNetworkError,\n  type ServiceHealth, type ServiceMetrics, type ServiceStatus, type RetryConfig, type CircuitBreakerConfig, type CircuitBreakerState,\n  type LogEntry, type Logger, type CacheConfig, type CacheEntry, type Cache,\n  type ServiceEvent, type MessageSentEvent, type MessageDeliveredEvent, type ErrorEvent, type WhatsAppServiceEvent,\n  type WhatsAppServiceInterface, type MessageType as ServiceMessageType, type MessageStatus as ServiceMessageStatus,\n  type ServiceEnvironment, type LogLevel, DEFAULT_SERVICE_OPTIONS, DEFAULT_RETRY_CONFIG, DEFAULT_CIRCUIT_BREAKER_CONFIG, DEFAULT_CACHE_CONFIG,\n  isWhatsAppError, isWhatsAppApiError, isWhatsAppValidationError, isWhatsAppRateLimitError, isWhatsAppNetworkError,\n  type Config, type ServiceOptions, type Status, type Health, type Metrics, type ServiceInterface,\n} from './whatsapp-service-types';\n\n// 向后兼容的通用别名 - Backward Compatibility Aliases\nexport type {\n  WhatsAppConfig as Config, WhatsAppMessage as Message, SendMessageRequest as SendRequest,\n  SendMessageResponse as SendResponse, TemplateMessage as Template, WebhookPayload as Webhook\n};\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/tests/e2e/basic-navigation.spec.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/tests/e2e/debug-dom.spec.ts","messages":[{"ruleId":"max-statements","severity":1,"message":"Async arrow function has too many statements (117). Maximum allowed is 50.","line":10,"column":70,"nodeType":"ArrowFunctionExpression","messageId":"exceed","endLine":297,"endColumn":4},{"ruleId":"complexity","severity":1,"message":"Async arrow function has a complexity of 23. Maximum allowed is 20.","line":10,"column":70,"nodeType":"ArrowFunctionExpression","messageId":"complex","endLine":297,"endColumn":4},{"ruleId":"security/detect-object-injection","severity":2,"message":"Variable Assigned to Object Injection Sink","line":104,"column":24,"nodeType":"MemberExpression","endLine":104,"endColumn":34},{"ruleId":"security/detect-object-injection","severity":2,"message":"Variable Assigned to Object Injection Sink","line":124,"column":25,"nodeType":"MemberExpression","endLine":124,"endColumn":46},{"ruleId":"security/detect-object-injection","severity":2,"message":"Variable Assigned to Object Injection Sink","line":174,"column":25,"nodeType":"MemberExpression","endLine":174,"endColumn":44},{"ruleId":"security/detect-object-injection","severity":2,"message":"Variable Assigned to Object Injection Sink","line":202,"column":25,"nodeType":"MemberExpression","endLine":202,"endColumn":41}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { expect, test } from '@playwright/test';\nimport type {\n  MockPerformanceNavigationEntry,\n  MockReactFiberNode,\n  MockWindowWithReact,\n  MockNextHydrationStatus\n} from '@/types/test-types';\n\ntest.describe('DOM Structure Debug', () => {\n  test('should debug page DOM structure and find language switcher', async ({\n    page,\n  }) => {\n    console.log('🔍 Starting DOM structure debug...');\n\n    // 导航到首页\n    await page.goto('/');\n    await page.waitForLoadState('networkidle');\n\n    // 等待页面稳定\n    await page.waitForTimeout(3000);\n\n    console.log('📍 Current URL:', page.url());\n\n    // 检查页面基本结构\n    const title = await page.title();\n    console.log('📄 Page title:', title);\n\n    // 检查HTML lang属性\n    const htmlLang = await page.locator('html').getAttribute('lang');\n    console.log('🌐 HTML lang attribute:', htmlLang);\n\n    // 检查body是否存在\n    const bodyExists = (await page.locator('body').count()) > 0;\n    console.log('📦 Body exists:', bodyExists);\n\n    // 检查header是否存在\n    const headerExists = (await page.locator('header').count()) > 0;\n    console.log('🏠 Header exists:', headerExists);\n\n    // 如果header不存在，检查整个页面结构\n    if (!headerExists) {\n      console.log('❌ Header not found! Investigating page structure...');\n\n      // 检查完整的body HTML结构\n      const bodyHTML = await page.locator('body').innerHTML();\n      console.log('📦 Complete body HTML:');\n      console.log(\n        bodyHTML.substring(0, 2000) +\n          (bodyHTML.length > 2000 ? '...[truncated]' : ''),\n      );\n\n      // 检查是否有任何React组件渲染\n      const reactElements = await page\n        .locator('[data-reactroot], #__next, [id*=\"react\"]')\n        .all();\n      console.log(`⚛️ React elements found: ${reactElements.length}`);\n\n      // 检查是否有Next.js相关元素\n      const nextElements = await page\n        .locator('[id*=\"next\"], [class*=\"next\"]')\n        .all();\n      console.log(`🔄 Next.js elements found: ${nextElements.length}`);\n\n      // 检查main元素\n      const mainExists = (await page.locator('main').count()) > 0;\n      console.log('📄 Main element exists:', mainExists);\n\n      // 检查footer元素\n      const footerExists = (await page.locator('footer').count()) > 0;\n      console.log('🦶 Footer element exists:', footerExists);\n\n      // 检查是否有任何导航相关元素\n      const navElements = await page.locator('nav').all();\n      console.log(`🧭 Navigation elements found: ${navElements.length}`);\n\n      // 检查页面是否完全加载\n      const readyState = await page.evaluate(() => document.readyState);\n      console.log('📊 Document ready state:', readyState);\n\n      // 检查是否有加载错误\n      const networkFailures = await page.evaluate(() => {\n        return window.performance\n          .getEntriesByType('navigation')\n          .map((entry: PerformanceEntry) => ({\n            name: entry.name,\n            transferSize: (entry as MockPerformanceNavigationEntry).transferSize,\n            responseStatus: (entry as MockPerformanceNavigationEntry).responseStatus,\n          }));\n      });\n      console.log('🌐 Network status:', networkFailures);\n    }\n\n    if (headerExists) {\n      // 获取header的完整HTML\n      const headerHTML = await page.locator('header').innerHTML();\n      console.log('🏠 Header HTML structure:');\n      console.log(headerHTML);\n\n      // 检查header内的所有按钮\n      const buttons = await page.locator('header button').all();\n      console.log(`🔘 Found ${buttons.length} buttons in header:`);\n\n      for (let i = 0; i < buttons.length; i++) {\n        const button = buttons[i];\n        const testId = await button?.getAttribute('data-testid');\n        const className = await button?.getAttribute('class');\n        const ariaLabel = await button?.getAttribute('aria-label');\n        const text = await button?.textContent();\n\n        console.log(`  Button ${i + 1}:`);\n        console.log(`    - data-testid: ${testId}`);\n        console.log(`    - class: ${className}`);\n        console.log(`    - aria-label: ${ariaLabel}`);\n        console.log(`    - text: ${text}`);\n      }\n\n      // 检查所有带有data-testid的元素\n      const elementsWithTestId = await page.locator('[data-testid]').all();\n      console.log(\n        `🏷️ Found ${elementsWithTestId.length} elements with data-testid:`,\n      );\n\n      for (let i = 0; i < elementsWithTestId.length; i++) {\n        const element = elementsWithTestId[i];\n        const testId = await element?.getAttribute('data-testid');\n        const tagName = await element?.evaluate((el) =>\n          el.tagName.toLowerCase(),\n        );\n        const isVisible = await element?.isVisible();\n\n        console.log(\n          `  Element ${i + 1}: <${tagName}> data-testid=\"${testId}\" visible=${isVisible}`,\n        );\n      }\n\n      // 专门检查语言切换相关元素\n      console.log('🌐 Checking language switcher elements:');\n\n      // 检查language-dropdown-trigger\n      const dropdownTrigger = page.getByTestId('language-dropdown-trigger');\n      const triggerCount = await dropdownTrigger.count();\n      console.log(`  - language-dropdown-trigger count: ${triggerCount}`);\n\n      if (triggerCount > 0) {\n        const isVisible = await dropdownTrigger.isVisible();\n        const isEnabled = await dropdownTrigger.isEnabled();\n        console.log(\n          `  - language-dropdown-trigger visible: ${isVisible}, enabled: ${isEnabled}`,\n        );\n      }\n\n      // 检查language-toggle-button\n      const toggleButton = page.getByTestId('language-toggle-button');\n      const toggleCount = await toggleButton.count();\n      console.log(`  - language-toggle-button count: ${toggleCount}`);\n\n      if (toggleCount > 0) {\n        const isVisible = await toggleButton.isVisible();\n        const isEnabled = await toggleButton.isEnabled();\n        console.log(\n          `  - language-toggle-button visible: ${isVisible}, enabled: ${isEnabled}`,\n        );\n      }\n\n      // 检查包含\"language\"的所有元素\n      const languageElements = await page\n        .locator('[data-testid*=\"language\"]')\n        .all();\n      console.log(\n        `  - Elements with \"language\" in data-testid: ${languageElements.length}`,\n      );\n\n      for (let i = 0; i < languageElements.length; i++) {\n        const element = languageElements[i];\n        const testId = await element?.getAttribute('data-testid');\n        const isVisible = await element?.isVisible();\n        console.log(`    - ${testId}: visible=${isVisible}`);\n      }\n\n      // 检查可能的语言切换按钮（通过文本）\n      const enButtons = await page.locator('button:has-text(\"EN\")').all();\n      const zhButtons = await page.locator('button:has-text(\"中文\")').all();\n      const globeButtons = await page\n        .locator(\n          'button:has([class*=\"lucide-globe\"], [class*=\"lucide-languages\"])',\n        )\n        .all();\n\n      console.log(`  - Buttons with \"EN\" text: ${enButtons.length}`);\n      console.log(`  - Buttons with \"中文\" text: ${zhButtons.length}`);\n      console.log(\n        `  - Buttons with globe/languages icon: ${globeButtons.length}`,\n      );\n\n      // 检查DropdownMenu相关元素\n      const dropdownMenus = await page\n        .locator('[data-testid*=\"dropdown\"]')\n        .all();\n      console.log(`  - Dropdown menu elements: ${dropdownMenus.length}`);\n\n      for (let i = 0; i < dropdownMenus.length; i++) {\n        const element = dropdownMenus[i];\n        const testId = await element?.getAttribute('data-testid');\n        const isVisible = await element?.isVisible();\n        console.log(`    - ${testId}: visible=${isVisible}`);\n      }\n    }\n\n    // 检查是否有JavaScript错误\n    const errors: string[] = [];\n    page.on('pageerror', (error) => {\n      errors.push(error.message);\n    });\n\n    // 等待一下看是否有错误\n    await page.waitForTimeout(1000);\n\n    if (errors.length > 0) {\n      console.log('❌ JavaScript errors found:');\n      errors.forEach((error, index) => {\n        console.log(`  ${index + 1}. ${error}`);\n      });\n    } else {\n      console.log('✅ No JavaScript errors detected');\n    }\n\n    // 检查控制台消息\n    const messages: string[] = [];\n    page.on('console', (msg) => {\n      if (msg.type() === 'error' || msg.type() === 'warning') {\n        messages.push(`${msg.type()}: ${msg.text()}`);\n      }\n    });\n\n    await page.waitForTimeout(1000);\n\n    if (messages.length > 0) {\n      console.log('⚠️ Console messages:');\n      messages.forEach((message, index) => {\n        console.log(`  ${index + 1}. ${message}`);\n      });\n    }\n\n    // 检查React hydration状态\n    const isHydrated = await page.evaluate(() => {\n      // 检查React是否已经hydrated\n      const reactRoot =\n        document.querySelector('[data-reactroot]') ||\n        document.querySelector('#__next');\n      if (reactRoot) {\n        return true;\n      }\n\n      // 检查是否有React fiber节点\n      const bodyElement = document.body as MockReactFiberNode;\n      if (bodyElement && bodyElement._reactInternalFiber) {\n        return true;\n      }\n\n      // 检查window上的React相关对象\n      const windowWithReact = window as MockWindowWithReact;\n      return (\n        Boolean(windowWithReact.React) ||\n        Boolean(windowWithReact.__REACT_DEVTOOLS_GLOBAL_HOOK__)\n      );\n    });\n\n    console.log('⚛️ React hydration status:', isHydrated);\n\n    // 检查Next.js hydration状态\n    const nextHydrationStatus = await page.evaluate((): MockNextHydrationStatus => {\n      const windowWithNext = window as MockWindowWithReact;\n      return {\n        hasNextData: Boolean(windowWithNext.__NEXT_DATA__),\n        hasNextRouter: Boolean(windowWithNext.__NEXT_ROUTER__),\n        documentReadyState: document.readyState,\n        scriptsLoaded: document.querySelectorAll('script[src*=\"_next\"]').length,\n      };\n    });\n\n    console.log('🔄 Next.js hydration status:', nextHydrationStatus);\n\n    // 等待更长时间看React是否会hydrate\n    console.log('⏳ Waiting for potential React hydration...');\n    await page.waitForTimeout(5000);\n\n    // 再次检查header\n    const headerExistsAfterWait = (await page.locator('header').count()) > 0;\n    console.log('🏠 Header exists after wait:', headerExistsAfterWait);\n\n    // 最终验证：页面应该有内容\n    const bodyContent = await page.textContent('body');\n    expect(bodyContent).toBeTruthy();\n    expect(bodyContent!.length).toBeGreaterThan(100);\n\n    console.log('✅ DOM structure debug completed');\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/tests/e2e/debug-language-dropdown.spec.ts","messages":[{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":34,"column":26,"nodeType":"MemberExpression","endLine":34,"endColumn":36},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":35,"column":28,"nodeType":"MemberExpression","endLine":35,"endColumn":38}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { test } from '@playwright/test';\n\ntest.describe('Debug Language Dropdown', () => {\n  test('should debug language dropdown rendering', async ({ page }) => {\n    // 测试根路径重定向 - 直接访问根路径看是否能正确重定向到/en\n    console.log('Testing root path redirect...');\n    await page.goto('http://localhost:3000/');\n\n    // 等待页面加载和可能的重定向\n    await page.waitForLoadState('networkidle');\n\n    // 检查当前URL是否正确重定向到/en\n    const currentUrl = page.url();\n    console.log('Current URL after redirect:', currentUrl);\n\n    // 检查页面HTML结构\n    const html = await page.content();\n    console.log('=== PAGE HTML ===');\n    console.log(html.substring(0, 2000)); // 只显示前2000个字符\n\n    // 检查是否有我们的组件\n    const languageDropdown = await page\n      .locator('[data-testid=\"language-dropdown-trigger\"]')\n      .count();\n    console.log('Language dropdown count:', languageDropdown);\n\n    // 检查是否有任何按钮\n    const allButtons = await page.locator('button').count();\n    console.log('Total buttons on page:', allButtons);\n\n    // 列出所有按钮的内容\n    const buttons = await page.locator('button').all();\n    for (let i = 0; i < buttons.length; i++) {\n      const text = await buttons[i]?.textContent();\n      const testId = await buttons[i]?.getAttribute('data-testid');\n      console.log(`Button ${i}: \"${text}\" (testid: ${testId})`);\n    }\n\n    // 检查header是否存在\n    const header = await page.locator('header').count();\n    console.log('Header count:', header);\n\n    if (header > 0) {\n      const headerContent = await page.locator('header').textContent();\n      console.log('Header content:', headerContent);\n    }\n\n    // 检查是否有任何包含\"Language\"或\"语言\"的元素\n    const languageElements = await page\n      .locator('text=/Language|语言|中文|English/i')\n      .count();\n    console.log('Elements containing language text:', languageElements);\n\n    // 截图保存\n    await page.screenshot({\n      path: 'debug-language-dropdown.png',\n      fullPage: true,\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/tests/e2e/global-setup.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/tests/e2e/global-teardown.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/tests/e2e/homepage.spec.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/tests/e2e/i18n-redirect-validation.spec.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/tests/e2e/i18n.spec.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/tests/e2e/navigation.spec.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/tests/e2e/performance.spec.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/tests/e2e/safe-navigation.spec.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/tests/e2e/test-environment-setup.ts","messages":[{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":37,"column":5,"nodeType":"MemberExpression","endLine":37,"endColumn":21},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":52,"column":12,"nodeType":"MemberExpression","endLine":52,"endColumn":28},{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":78,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":78,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":78,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":78,"endColumn":19},{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":111,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":111,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":111,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":111,"endColumn":19},{"ruleId":"no-unused-vars","severity":2,"message":"'jsError' is defined but never used.","line":189,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":189,"endColumn":21},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'jsError' is defined but never used.","line":189,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":189,"endColumn":21}],"suppressedMessages":[],"errorCount":8,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import type { Page } from '@playwright/test';\n// import { FullConfig } from '@playwright/test'; // TODO: Use when needed\n\n/**\n * 测试环境设置\n *\n * 专门为 E2E 测试配置环境，确保测试工具之间不会相互干扰\n */\n\n/**\n * 禁用开发工具的环境变量设置\n */\nexport const TEST_ENV_VARS = {\n  // 禁用 React Scan 以避免 DOM 干扰\n  NEXT_PUBLIC_DISABLE_REACT_SCAN: 'true',\n\n  // 设置测试环境标识\n  NODE_ENV: 'test',\n  PLAYWRIGHT_TEST: 'true',\n\n  // 禁用其他可能干扰测试的开发工具\n  NEXT_PUBLIC_DISABLE_DEV_TOOLS: 'true',\n  NEXT_PUBLIC_DISABLE_PERFORMANCE_MONITOR: 'true',\n\n  // 测试专用配置\n  NEXT_PUBLIC_TEST_MODE: 'true',\n} as const;\n\n/**\n * 为测试环境配置环境变量\n */\nexport function setupTestEnvironment() {\n  console.log('🧪 Setting up test environment...');\n\n  // 设置测试环境变量\n  Object.entries(TEST_ENV_VARS).forEach(([key, value]) => {\n    process.env[key] = value;\n    console.log(`   ${key}=${value}`);\n  });\n\n  console.log('✅ Test environment configured');\n}\n\n/**\n * 清理测试环境\n */\nexport function cleanupTestEnvironment() {\n  console.log('🧹 Cleaning up test environment...');\n\n  // 清理测试环境变量（可选）\n  Object.keys(TEST_ENV_VARS).forEach((key) => {\n    delete process.env[key];\n  });\n\n  console.log('✅ Test environment cleaned up');\n}\n\n/**\n * 检查页面是否存在干扰元素\n */\nexport async function checkForInterferingElements(page: Page) {\n  const interferingElements = [\n    '#react-scan-toolbar-root',\n    '[data-testid=\"react-scan-indicator\"]',\n    '[data-testid=\"react-scan-control-panel\"]',\n    '.react-scan-overlay',\n  ];\n\n  const foundElements: string[] = [];\n\n  for (const selector of interferingElements) {\n    try {\n      const element = await page.locator(selector);\n      const count = await element.count();\n      if (count > 0) {\n        foundElements.push(selector);\n      }\n    } catch (error) {\n      // 忽略查找错误\n    }\n  }\n\n  if (foundElements.length > 0) {\n    console.warn('⚠️  Found interfering elements:', foundElements);\n    return foundElements;\n  }\n\n  return [];\n}\n\n/**\n * 移除页面中的干扰元素\n */\nexport async function removeInterferingElements(page: Page) {\n  console.log('🧹 Removing interfering elements...');\n\n  const interferingSelectors = [\n    '#react-scan-toolbar-root',\n    '[data-testid=\"react-scan-indicator\"]',\n    '[data-testid=\"react-scan-control-panel\"]',\n    '.react-scan-overlay',\n    '.react-scan-toolbar',\n  ];\n\n  for (const selector of interferingSelectors) {\n    try {\n      await page.evaluate((sel: string) => {\n        const elements = document.querySelectorAll(sel);\n        elements.forEach((el) => el.remove());\n      }, selector);\n    } catch (error) {\n      // 忽略移除错误\n    }\n  }\n\n  console.log('✅ Interfering elements removed');\n}\n\n/**\n * 等待页面稳定（无干扰元素）\n */\nexport async function waitForStablePage(page: Page, timeout = 5000) {\n  console.log('⏳ Waiting for page to stabilize...');\n\n  const startTime = Date.now();\n\n  while (Date.now() - startTime < timeout) {\n    const interferingElements = await checkForInterferingElements(page);\n\n    if (interferingElements.length === 0) {\n      console.log('✅ Page is stable');\n      return true;\n    }\n\n    // 尝试移除干扰元素\n    await removeInterferingElements(page);\n\n    // 等待一小段时间再检查\n    await page.waitForTimeout(100);\n  }\n\n  console.warn('⚠️  Page did not stabilize within timeout');\n  return false;\n}\n\n/**\n * 安全点击元素（避免干扰）\n */\nexport async function safeClick(\n  page: Page,\n  selector: string,\n  options: unknown = {},\n) {\n  console.log(`🖱️  Safe clicking: ${selector}`);\n\n  // 首先移除干扰元素\n  await removeInterferingElements(page);\n\n  // 等待元素可见\n  await page.waitForSelector(selector, { state: 'visible', timeout: 5000 });\n\n  // 滚动到元素位置\n  await page.locator(selector).scrollIntoViewIfNeeded();\n\n  // 等待元素稳定\n  await page.waitForTimeout(100);\n\n  // 再次检查并移除干扰元素\n  await removeInterferingElements(page);\n\n  try {\n    // 尝试点击\n    await page.locator(selector).click(options);\n    console.log(`✅ Successfully clicked: ${selector}`);\n    return true;\n  } catch (error) {\n    console.warn(`⚠️  Click failed for ${selector}:`, (error as Error).message);\n\n    // 尝试使用 JavaScript 点击\n    try {\n      await page.evaluate((sel: string) => {\n        const element = document.querySelector(sel);\n        if (element) {\n          (element as HTMLElement).click();\n        }\n      }, selector);\n      console.log(`✅ JavaScript click succeeded: ${selector}`);\n      return true;\n    } catch (jsError) {\n      console.error(`❌ Both click methods failed for ${selector}`);\n      return false;\n    }\n  }\n}\n\nconst testEnvironmentUtils = {\n  setupTestEnvironment,\n  cleanupTestEnvironment,\n  checkForInterferingElements,\n  removeInterferingElements,\n  waitForStablePage,\n  safeClick,\n  TEST_ENV_VARS,\n};\n\nexport default testEnvironmentUtils;\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/tests/e2e/web-eval-basic.spec.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/tests/e2e/web-eval-integration.spec.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":154,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":154,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":154,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":154,"endColumn":19},{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":184,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":184,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":184,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":184,"endColumn":19}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { expect, test } from '@playwright/test';\n\ntest.describe('Web Eval Agent Integration', () => {\n  test('should capture network requests for analysis', async ({ page }) => {\n    const networkRequests: Array<{\n      url: string;\n      method: string;\n      status: number;\n      timing: number;\n    }> = [];\n\n    // Monitor network requests\n    page.on('response', async (response) => {\n      const request = response.request();\n      // Note: Playwright Response doesn't have timing() method\n      // We'll use a simple timestamp approach instead\n\n      networkRequests.push({\n        url: response.url(),\n        method: request.method(),\n        status: response.status(),\n        timing: Date.now(), // Simple timestamp instead of detailed timing\n      });\n    });\n\n    await page.goto('/');\n    await page.waitForLoadState('networkidle');\n\n    // Verify we captured network requests\n    expect(networkRequests.length).toBeGreaterThan(0);\n\n    // Check for critical resources\n    const htmlRequest = networkRequests.find(\n      (req) => req.url.includes('localhost:3000') && req.method === 'GET',\n    );\n    expect(htmlRequest).toBeDefined();\n    expect(htmlRequest?.status).toBe(200);\n\n    console.log(`Captured ${networkRequests.length} network requests`);\n    console.log('Network requests:', JSON.stringify(networkRequests, null, 2));\n  });\n\n  test('should capture console logs for debugging', async ({ page }) => {\n    const consoleLogs: Array<{\n      type: string;\n      text: string;\n      timestamp: number;\n    }> = [];\n\n    // Monitor console messages\n    page.on('console', (msg) => {\n      consoleLogs.push({\n        type: msg.type(),\n        text: msg.text(),\n        timestamp: Date.now(),\n      });\n    });\n\n    await page.goto('/');\n    await page.waitForLoadState('networkidle');\n\n    // Trigger some console output\n    await page.evaluate(() => {\n      console.log('Web Eval Agent test log');\n      console.info('Test info message');\n    });\n\n    // Verify we captured console logs\n    const testLog = consoleLogs.find((log) =>\n      log.text.includes('Web Eval Agent test log'),\n    );\n    expect(testLog).toBeDefined();\n    expect(testLog?.type).toBe('log');\n\n    console.log(`Captured ${consoleLogs.length} console messages`);\n    console.log('Console logs:', JSON.stringify(consoleLogs, null, 2));\n  });\n\n  test('should measure page performance metrics', async ({ page }) => {\n    await page.goto('/');\n\n    // Measure performance metrics\n    const metrics = await page.evaluate(() => {\n      return new Promise((resolve) => {\n        const observer = new PerformanceObserver((list) => {\n          const entries = list.getEntries();\n          const performanceData: Record<string, unknown> = {};\n\n          entries.forEach((entry) => {\n            if (entry.entryType === 'navigation') {\n              const navEntry = entry as PerformanceNavigationTiming;\n              performanceData.navigation = {\n                domContentLoaded:\n                  navEntry.domContentLoadedEventEnd - navEntry.fetchStart,\n                loadComplete: navEntry.loadEventEnd - navEntry.fetchStart,\n                firstByte: navEntry.responseStart - navEntry.fetchStart,\n              };\n            }\n\n            if (entry.entryType === 'paint') {\n              if (entry.name === 'first-contentful-paint') {\n                performanceData.fcp = entry.startTime;\n              }\n            }\n          });\n\n          resolve(performanceData);\n        });\n\n        observer.observe({ entryTypes: ['navigation', 'paint'] });\n\n        // Fallback timeout\n        setTimeout(() => resolve({}), 3000);\n      });\n    });\n\n    console.log('Performance metrics:', JSON.stringify(metrics, null, 2));\n\n    // Verify reasonable performance\n    if (metrics && typeof metrics === 'object' && 'navigation' in metrics) {\n      const { navigation } = metrics as unknown;\n      if (navigation && navigation.loadComplete) {\n        expect(navigation.loadComplete).toBeLessThan(5000); // 5 seconds max\n      }\n    }\n  });\n\n  test('should test user interaction flows', async ({ page }) => {\n    await page.goto('/');\n\n    // Test basic interactions that Web Eval Agent would analyze\n    const interactions: Array<{\n      action: string;\n      element: string;\n      success: boolean;\n      timing: number;\n    }> = [];\n\n    // Test navigation interaction\n    const startTime = Date.now();\n    try {\n      const navLinks = page.locator('nav a').first();\n      if (await navLinks.isVisible()) {\n        await navLinks.click();\n        await page.waitForLoadState('networkidle');\n\n        interactions.push({\n          action: 'navigation_click',\n          element: 'nav_link',\n          success: true,\n          timing: Date.now() - startTime,\n        });\n      }\n    } catch (error) {\n      interactions.push({\n        action: 'navigation_click',\n        element: 'nav_link',\n        success: false,\n        timing: Date.now() - startTime,\n      });\n    }\n\n    // Test theme toggle if available\n    const themeToggleStart = Date.now();\n    try {\n      const themeToggle = page\n        .locator('[data-testid=\"theme-toggle\"]')\n        .or(\n          page\n            .locator('button:has-text(\"🌙\")')\n            .or(page.locator('button:has-text(\"☀️\")')),\n        );\n\n      if (await themeToggle.first().isVisible()) {\n        await themeToggle.first().click();\n\n        interactions.push({\n          action: 'theme_toggle',\n          element: 'theme_button',\n          success: true,\n          timing: Date.now() - themeToggleStart,\n        });\n      }\n    } catch (error) {\n      interactions.push({\n        action: 'theme_toggle',\n        element: 'theme_button',\n        success: false,\n        timing: Date.now() - themeToggleStart,\n      });\n    }\n\n    console.log('User interactions:', JSON.stringify(interactions, null, 2));\n\n    // Verify at least one interaction was successful\n    const successfulInteractions = interactions.filter((i) => i.success);\n    expect(successfulInteractions.length).toBeGreaterThan(0);\n  });\n\n  test('should validate accessibility for Web Eval Agent', async ({ page }) => {\n    await page.goto('/');\n\n    // Basic accessibility checks that Web Eval Agent would perform\n    const accessibilityIssues: string[] = [];\n\n    // Check for missing alt text\n    const images = page.locator('img');\n    const imageCount = await images.count();\n\n    for (let i = 0; i < imageCount; i++) {\n      const img = images.nth(i);\n      const alt = await img.getAttribute('alt');\n      const src = await img.getAttribute('src');\n\n      if (!alt && src && !src.includes('data:')) {\n        accessibilityIssues.push(`Image missing alt text: ${src}`);\n      }\n    }\n\n    // Check for proper heading hierarchy\n    const headings = await page\n      .locator('h1, h2, h3, h4, h5, h6')\n      .allTextContents();\n    if (headings.length === 0) {\n      accessibilityIssues.push('No headings found on page');\n    }\n\n    // Check for form labels\n    const inputs = page.locator(\n      'input[type=\"text\"], input[type=\"email\"], textarea',\n    );\n    const inputCount = await inputs.count();\n\n    for (let i = 0; i < inputCount; i++) {\n      const input = inputs.nth(i);\n      const id = await input.getAttribute('id');\n      const ariaLabel = await input.getAttribute('aria-label');\n\n      if (id) {\n        const label = page.locator(`label[for=\"${id}\"]`);\n        const hasLabel = (await label.count()) > 0;\n\n        if (!hasLabel && !ariaLabel) {\n          accessibilityIssues.push(`Input missing label: ${id}`);\n        }\n      }\n    }\n\n    console.log('Accessibility issues found:', accessibilityIssues);\n\n    // For now, just log issues - in production you might want to fail the test\n    if (accessibilityIssues.length > 0) {\n      console.warn(`Found ${accessibilityIssues.length} accessibility issues`);\n    }\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/tests/error-scenarios/comprehensive-error-handling.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/tests/error-scenarios/error-boundary-core.test.tsx","messages":[],"suppressedMessages":[{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":101,"column":10,"nodeType":"MemberExpression","endLine":101,"endColumn":27,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/tests/error-scenarios/error-boundary.test.tsx","messages":[{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":132,"column":45,"nodeType":"MemberExpression","endLine":132,"endColumn":62}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * ErrorBoundary Component Error Handling Tests\n *\n * 全面测试错误边界组件的错误捕获、恢复和用户体验功能\n */\n\nimport React from 'react';\nimport { render, screen, waitFor } from '@testing-library/react';\nimport userEvent from '@testing-library/user-event';\nimport { afterEach, beforeEach, describe, expect, it, vi } from 'vitest';\nimport { ErrorBoundary } from '@/components/error-boundary';\n\n// Mock next-intl\nconst mockUseTranslations = vi.fn();\nvi.mock('next-intl', () => ({\n  useTranslations: () => mockUseTranslations,\n}));\n\n// Mock UI components\nvi.mock('@/components/ui/button', () => ({\n  Button: ({ children, onClick, variant, className, ...props }: React.ComponentProps<\"div\">) => (\n    <button\n      data-testid='error-boundary-button'\n      onClick={onClick}\n      data-variant={variant}\n      className={className}\n      {...props}\n    >\n      {children}\n    </button>\n  ),\n}));\n\nvi.mock('@/components/ui/card', () => ({\n  Card: ({ children, className, ...props }: React.ComponentProps<\"div\">) => (\n    <div\n      data-testid='error-boundary-card'\n      className={className}\n      {...props}\n    >\n      {children}\n    </div>\n  ),\n  CardContent: ({ children, className, ...props }: React.ComponentProps<\"div\">) => (\n    <div\n      data-testid='error-boundary-card-content'\n      className={className}\n      {...props}\n    >\n      {children}\n    </div>\n  ),\n  CardDescription: ({ children, className, ...props }: React.ComponentProps<\"div\">) => (\n    <div\n      data-testid='error-boundary-card-description'\n      className={className}\n      {...props}\n    >\n      {children}\n    </div>\n  ),\n  CardHeader: ({ children, className, ...props }: React.ComponentProps<\"div\">) => (\n    <div\n      data-testid='error-boundary-card-header'\n      className={className}\n      {...props}\n    >\n      {children}\n    </div>\n  ),\n  CardTitle: ({ children, className, ...props }: React.ComponentProps<\"div\">) => (\n    <h2\n      data-testid='error-boundary-card-title'\n      className={className}\n      {...props}\n    >\n      {children}\n    </h2>\n  ),\n}));\n\n// Mock Lucide icons\nvi.mock('lucide-react', () => ({\n  AlertTriangle: ({ className }: React.ComponentProps<\"div\">) => (\n    <span\n      data-testid='alert-triangle-icon'\n      className={className}\n    >\n      ⚠️\n    </span>\n  ),\n  RefreshCw: ({ className }: React.ComponentProps<\"div\">) => (\n    <span\n      data-testid='refresh-icon'\n      className={className}\n    >\n      🔄\n    </span>\n  ),\n}));\n\n// 创建会抛出错误的测试组件\nfunction ThrowErrorComponent({\n  shouldThrow = true,\n  errorMessage = 'Test error',\n}: {\n  shouldThrow?: boolean;\n  errorMessage?: string;\n}) {\n  if (shouldThrow) {\n    throw new Error(errorMessage);\n  }\n  return <div data-testid='normal-component'>Normal component</div>;\n}\n\ndescribe('ErrorBoundary Error Handling Tests', () => {\n  const user = userEvent.setup();\n  const consoleSpy = vi.spyOn(console, 'error').mockImplementation(() => {});\n\n  beforeEach(() => {\n    vi.clearAllMocks();\n\n    // Setup default translations\n    mockUseTranslations.mockImplementation((key: string) => {\n      const translations: Record<string, string> = {\n        error: 'Error',\n        retry: 'Try Again',\n        errorMessage: 'Something went wrong. Please try refreshing the page.',\n      };\n\n      return (\n        (Object.hasOwn(translations, key) ? translations[key] : null) || key\n      );\n    });\n\n    // Clear console spy\n    consoleSpy.mockClear();\n  });\n\n  afterEach(() => {\n    vi.restoreAllMocks();\n  });\n\n  describe('Error Catching and Display', () => {\n    it('should catch and display error when child component throws', async () => {\n      render(\n        <ErrorBoundary>\n          <ThrowErrorComponent\n            shouldThrow={true}\n            errorMessage='Component crashed'\n          />\n        </ErrorBoundary>,\n      );\n\n      // Verify error boundary UI is displayed\n      expect(screen.getByTestId('error-boundary-card')).toBeInTheDocument();\n      expect(screen.getByTestId('alert-triangle-icon')).toBeInTheDocument();\n      expect(screen.getByTestId('error-boundary-card-title')).toHaveTextContent(\n        'Error',\n      );\n      expect(\n        screen.getByTestId('error-boundary-card-description'),\n      ).toHaveTextContent(\n        'Something went wrong. Please try refreshing the page.',\n      );\n\n      // Verify retry button is present\n      const retryButton = screen.getByTestId('error-boundary-button');\n      expect(retryButton).toBeInTheDocument();\n      expect(retryButton).toHaveTextContent('Try Again');\n      expect(screen.getByTestId('refresh-icon')).toBeInTheDocument();\n    });\n\n    it('should render children normally when no error occurs', async () => {\n      render(\n        <ErrorBoundary>\n          <ThrowErrorComponent shouldThrow={false} />\n        </ErrorBoundary>,\n      );\n\n      // Verify normal component is rendered\n      expect(screen.getByTestId('normal-component')).toBeInTheDocument();\n      expect(\n        screen.queryByTestId('error-boundary-card'),\n      ).not.toBeInTheDocument();\n    });\n\n    it('should handle different error types correctly', async () => {\n      const errorTypes = [\n        { message: 'Network error', expected: 'Network error' },\n        { message: 'Validation failed', expected: 'Validation failed' },\n        { message: 'Permission denied', expected: 'Permission denied' },\n        { message: '', expected: '' }, // Empty error message\n      ];\n\n      for (const { message } of errorTypes) {\n        const { unmount } = render(\n          <ErrorBoundary>\n            <ThrowErrorComponent\n              shouldThrow={true}\n              errorMessage={message}\n            />\n          </ErrorBoundary>,\n        );\n\n        expect(screen.getByTestId('error-boundary-card')).toBeInTheDocument();\n        unmount();\n      }\n    });\n  });\n\n  describe('Error Recovery Mechanism', () => {\n    it('should reset error state when retry button is clicked', async () => {\n      let componentKey = 0;\n      let shouldThrow = true;\n\n      const TestWrapper = ({ key }: { key: number }) => (\n        <ErrorBoundary key={key}>\n          <ThrowErrorComponent shouldThrow={shouldThrow} />\n        </ErrorBoundary>\n      );\n\n      const { rerender } = render(<TestWrapper key={componentKey} />);\n\n      // Verify error state\n      expect(screen.getByTestId('error-boundary-card')).toBeInTheDocument();\n\n      // Simulate successful retry by changing component state and key\n      shouldThrow = false;\n      componentKey++;\n\n      // Click retry button (this will reset the error boundary state)\n      const retryButton = screen.getByTestId('error-boundary-button');\n      await user.click(retryButton);\n\n      // Re-render with new key to force remount and updated state\n      rerender(<TestWrapper key={componentKey} />);\n\n      // Verify error boundary is reset and normal component is shown\n      expect(\n        screen.queryByTestId('error-boundary-card'),\n      ).not.toBeInTheDocument();\n      expect(screen.getByTestId('normal-component')).toBeInTheDocument();\n    });\n\n    it('should handle multiple error-recovery cycles', async () => {\n      let componentKey = 0;\n      let shouldThrow = true;\n\n      const TestWrapper = ({ key }: { key: number }) => (\n        <ErrorBoundary key={key}>\n          <ThrowErrorComponent shouldThrow={shouldThrow} />\n        </ErrorBoundary>\n      );\n\n      const { rerender } = render(<TestWrapper key={componentKey} />);\n\n      // First error\n      expect(screen.getByTestId('error-boundary-card')).toBeInTheDocument();\n\n      // First recovery\n      shouldThrow = false;\n      componentKey++;\n      await user.click(screen.getByTestId('error-boundary-button'));\n      rerender(<TestWrapper key={componentKey} />);\n      expect(screen.getByTestId('normal-component')).toBeInTheDocument();\n\n      // Second error\n      shouldThrow = true;\n      componentKey++;\n      rerender(<TestWrapper key={componentKey} />);\n      expect(screen.getByTestId('error-boundary-card')).toBeInTheDocument();\n\n      // Second recovery\n      shouldThrow = false;\n      componentKey++;\n      await user.click(screen.getByTestId('error-boundary-button'));\n      rerender(<TestWrapper key={componentKey} />);\n      expect(screen.getByTestId('normal-component')).toBeInTheDocument();\n    });\n  });\n\n  describe('Custom Fallback Support', () => {\n    it('should render custom fallback when provided', async () => {\n      const customFallback = (\n        <div data-testid='custom-fallback'>Custom error message</div>\n      );\n\n      render(\n        <ErrorBoundary fallback={customFallback}>\n          <ThrowErrorComponent shouldThrow={true} />\n        </ErrorBoundary>,\n      );\n\n      // Verify custom fallback is rendered instead of default\n      expect(screen.getByTestId('custom-fallback')).toBeInTheDocument();\n      expect(\n        screen.queryByTestId('error-boundary-card'),\n      ).not.toBeInTheDocument();\n    });\n\n    it('should use default fallback when custom fallback is not provided', async () => {\n      render(\n        <ErrorBoundary>\n          <ThrowErrorComponent shouldThrow={true} />\n        </ErrorBoundary>,\n      );\n\n      // Verify default fallback is rendered\n      expect(screen.getByTestId('error-boundary-card')).toBeInTheDocument();\n      expect(screen.queryByTestId('custom-fallback')).not.toBeInTheDocument();\n    });\n  });\n\n  describe('Error Logging and Monitoring', () => {\n    it('should log errors in development environment', async () => {\n      // Create a fresh spy for this test\n      const localConsoleSpy = vi\n        .spyOn(console, 'error')\n        .mockImplementation(() => {});\n\n      render(\n        <ErrorBoundary>\n          <ThrowErrorComponent\n            shouldThrow={true}\n            errorMessage='Development error'\n          />\n        </ErrorBoundary>,\n      );\n\n      // Verify error boundary is displayed (which means error was caught)\n      expect(screen.getByTestId('error-boundary-card')).toBeInTheDocument();\n\n      // Wait for componentDidCatch to be called (it's async)\n      await waitFor(\n        () => {\n          expect(localConsoleSpy).toHaveBeenCalledWith(\n            'ErrorBoundary caught an error:',\n            expect.any(Error),\n            expect.any(Object),\n          );\n        },\n        { timeout: 2000 },\n      );\n\n      // Restore the spy\n      localConsoleSpy.mockRestore();\n    });\n\n    it('should handle production environment logging', async () => {\n      // Mock production environment using vi.stubEnv\n      vi.stubEnv('NODE_ENV', 'production');\n\n      render(\n        <ErrorBoundary>\n          <ThrowErrorComponent\n            shouldThrow={true}\n            errorMessage='Production error'\n          />\n        </ErrorBoundary>,\n      );\n\n      // In production, should not log to console (would use Sentry instead)\n      // This test verifies the component doesn't crash in production\n      expect(screen.getByTestId('error-boundary-card')).toBeInTheDocument();\n\n      // Restore environment\n      vi.unstubAllEnvs();\n    });\n  });\n\n  describe('Accessibility and User Experience', () => {\n    it('should provide proper accessibility attributes', async () => {\n      render(\n        <ErrorBoundary>\n          <ThrowErrorComponent shouldThrow={true} />\n        </ErrorBoundary>,\n      );\n\n      const errorCard = screen.getByTestId('error-boundary-card');\n      const retryButton = screen.getByTestId('error-boundary-button');\n\n      // Verify accessibility structure\n      expect(errorCard).toBeInTheDocument();\n      expect(retryButton).toBeInTheDocument();\n\n      // Verify button is focusable\n      retryButton.focus();\n      expect(document.activeElement).toBe(retryButton);\n    });\n\n    it('should support keyboard navigation', async () => {\n      render(\n        <ErrorBoundary>\n          <ThrowErrorComponent shouldThrow={true} />\n        </ErrorBoundary>,\n      );\n\n      const retryButton = screen.getByTestId('error-boundary-button');\n\n      // Verify button is focusable\n      expect(retryButton).toHaveAttribute('tabIndex', '0');\n\n      // Test keyboard activation\n      retryButton.focus();\n      expect(retryButton).toHaveFocus();\n\n      // Test that button can be activated with keyboard\n      // We don't test the actual retry functionality here, just keyboard accessibility\n      expect(retryButton).toBeEnabled();\n\n      // Test Space key activation as well\n      await user.keyboard('{Space}');\n\n      // Verify the error boundary is still showing (since component still throws)\n      expect(screen.getByTestId('error-boundary-card')).toBeInTheDocument();\n    });\n  });\n\n  describe('Edge Cases and Boundary Conditions', () => {\n    it('should handle null/undefined children gracefully', async () => {\n      render(\n        <ErrorBoundary>\n          {null}\n          {undefined}\n        </ErrorBoundary>,\n      );\n\n      // Should render without errors\n      expect(\n        screen.queryByTestId('error-boundary-card'),\n      ).not.toBeInTheDocument();\n    });\n\n    it('should handle errors with missing error messages', async () => {\n      render(\n        <ErrorBoundary>\n          <ThrowErrorComponent\n            shouldThrow={true}\n            errorMessage=''\n          />\n        </ErrorBoundary>,\n      );\n\n      // Should still render error boundary\n      expect(screen.getByTestId('error-boundary-card')).toBeInTheDocument();\n    });\n\n    it('should handle very long error messages', async () => {\n      const longErrorMessage = 'A'.repeat(1000);\n\n      render(\n        <ErrorBoundary>\n          <ThrowErrorComponent\n            shouldThrow={true}\n            errorMessage={longErrorMessage}\n          />\n        </ErrorBoundary>,\n      );\n\n      // Should render without layout issues\n      expect(screen.getByTestId('error-boundary-card')).toBeInTheDocument();\n    });\n\n    it('should handle special characters in error messages', async () => {\n      const specialCharError = '错误信息 🚨 <script>alert(\"xss\")</script>';\n\n      render(\n        <ErrorBoundary>\n          <ThrowErrorComponent\n            shouldThrow={true}\n            errorMessage={specialCharError}\n          />\n        </ErrorBoundary>,\n      );\n\n      // Should render safely without XSS\n      expect(screen.getByTestId('error-boundary-card')).toBeInTheDocument();\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/tests/error-scenarios/error-handling-summary.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/tests/error-scenarios/form-validation-basic.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/tests/error-scenarios/form-validation-boundary.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/tests/error-scenarios/form-validation-security.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/tests/error-scenarios/network-errors.test.ts","messages":[{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (4). Maximum allowed is 3.","line":72,"column":11,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":74,"endColumn":12},{"ruleId":"no-unused-vars","severity":2,"message":"'primaryError' is defined but never used.","line":110,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":110,"endColumn":26},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'primaryError' is defined but never used.","line":110,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":110,"endColumn":26},{"ruleId":"no-unused-vars","severity":2,"message":"'fallbackError' is defined but never used.","line":114,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":114,"endColumn":29},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'fallbackError' is defined but never used.","line":114,"column":16,"nodeType":null,"messageId":"unusedVar","endLine":114,"endColumn":29},{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":239,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":239,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":239,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":239,"endColumn":23},{"ruleId":"no-unused-vars","severity":2,"message":"'callCount' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":348,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":348,"endColumn":20},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'callCount' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":348,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":348,"endColumn":20}],"suppressedMessages":[],"errorCount":9,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Network Error Handling Tests\n *\n * 全面测试网络错误处理机制，包括：\n * - 网络超时处理\n * - 连接失败处理\n * - 间歇性网络错误\n * - 慢网络处理\n * - 重试机制\n * - 降级策略\n */\n\nimport { afterEach, beforeEach, describe, expect, it, vi } from 'vitest';\nimport {\n  APIErrorSimulator,\n  ErrorRecoveryTester,\n  NetworkErrorSimulator,\n} from './setup';\n\n// Mock fetch for testing\nconst originalFetch = global.fetch;\n\n// 模拟API客户端\nclass TestAPIClient {\n  private baseURL: string;\n  private retryAttempts: number;\n  private retryDelay: number;\n\n  constructor(\n    baseURL: string = '/api',\n    retryAttempts: number = 3,\n    retryDelay: number = 100,\n  ) {\n    // 减少重试延迟\n    this.baseURL = baseURL;\n    this.retryAttempts = retryAttempts;\n    this.retryDelay = retryDelay;\n  }\n\n  async get(endpoint: string): Promise<unknown> {\n    return this.request('GET', endpoint);\n  }\n\n  async post(endpoint: string, data?: unknown): Promise<unknown> {\n    return this.request('POST', endpoint, data);\n  }\n\n  private async request(\n    method: string,\n    endpoint: string,\n    data?: unknown,\n  ): Promise<unknown> {\n    const url = `${this.baseURL}${endpoint}`;\n    let lastError: Error | null = null;\n\n    for (let attempt = 0; attempt <= this.retryAttempts; attempt++) {\n      try {\n        const response = await fetch(url, {\n          method,\n          headers: {\n            'Content-Type': 'application/json',\n          },\n          ...(data && { body: JSON.stringify(data) }),\n        });\n\n        if (!response.ok) {\n          const httpError = new Error(\n            `HTTP ${response.status}: ${response.statusText}`,\n          );\n\n          // Don't retry on 4xx client errors (client-side issues)\n          if (response.status >= 400 && response.status < 500) {\n            throw httpError;\n          }\n\n          throw httpError;\n        }\n\n        return await response.json();\n      } catch (error) {\n        lastError = error as Error;\n\n        // Don't retry on 4xx errors or on the last attempt\n        if (attempt === this.retryAttempts) {\n          break;\n        }\n\n        // Check if it's a 4xx error and don't retry\n        if (lastError.message.includes('HTTP 4')) {\n          break;\n        }\n\n        // Wait before retrying\n        await new Promise((resolve) => setTimeout(resolve, this.retryDelay));\n      }\n    }\n\n    throw lastError;\n  }\n\n  // 带降级策略的请求\n  async requestWithFallback<T>(\n    primaryEndpoint: string,\n    fallbackEndpoint: string,\n    defaultValue: T,\n  ): Promise<{ data: T; source: 'primary' | 'fallback' | 'default' }> {\n    try {\n      const data = await this.get(primaryEndpoint);\n      return { data, source: 'primary' };\n    } catch (primaryError) {\n      try {\n        const data = await this.get(fallbackEndpoint);\n        return { data, source: 'fallback' };\n      } catch (fallbackError) {\n        return { data: defaultValue, source: 'default' };\n      }\n    }\n  }\n}\n\ndescribe('Network Error Handling Tests', () => {\n  let networkSimulator: NetworkErrorSimulator;\n  let apiSimulator: APIErrorSimulator;\n  let recoveryTester: ErrorRecoveryTester;\n  let apiClient: TestAPIClient;\n\n  beforeEach(() => {\n    networkSimulator = new NetworkErrorSimulator();\n    apiSimulator = new APIErrorSimulator();\n    recoveryTester = new ErrorRecoveryTester();\n    apiClient = new TestAPIClient();\n    vi.clearAllMocks();\n  });\n\n  afterEach(() => {\n    networkSimulator.restore();\n    global.fetch = originalFetch;\n    vi.restoreAllMocks();\n  });\n\n  describe('Network Timeout Handling', () => {\n    it('should handle network timeout errors correctly', async () => {\n      networkSimulator.simulateTimeout(1000);\n\n      await expect(apiClient.get('/test')).rejects.toThrow('Network timeout');\n    });\n\n    it('should retry on timeout and eventually succeed', async () => {\n      let callCount = 0;\n      global.fetch = vi.fn().mockImplementation(() => {\n        callCount++;\n        if (callCount <= 2) {\n          return Promise.reject(new Error('Network timeout'));\n        }\n        return Promise.resolve({\n          ok: true,\n          json: async () => ({ success: true, data: 'success' }),\n        });\n      });\n\n      const result = await apiClient.get('/test');\n      expect(result).toEqual({ success: true, data: 'success' });\n      expect(callCount).toBe(3); // 2 failures + 1 success\n    });\n\n    it('should fail after maximum retry attempts on persistent timeout', async () => {\n      networkSimulator.simulateTimeout(100);\n\n      const startTime = Date.now();\n      await expect(apiClient.get('/test')).rejects.toThrow('Network timeout');\n      const endTime = Date.now();\n\n      // Should have attempted retries (4 total attempts with delays)\n      expect(endTime - startTime).toBeGreaterThan(300); // 3 retry delays of 100ms each\n    }, 10000); // 为这个测试设置10秒超时\n  });\n\n  describe('Connection Failure Handling', () => {\n    it('should handle connection failure errors', async () => {\n      networkSimulator.simulateConnectionFailure();\n\n      await expect(apiClient.get('/test')).rejects.toThrow(\n        'Network connection failed',\n      );\n    });\n\n    it('should handle DNS resolution failures', async () => {\n      global.fetch = vi\n        .fn()\n        .mockRejectedValue(new Error('getaddrinfo ENOTFOUND api.example.com'));\n\n      await expect(apiClient.get('/test')).rejects.toThrow(\n        'getaddrinfo ENOTFOUND',\n      );\n    });\n\n    it('should handle CORS errors', async () => {\n      global.fetch = vi\n        .fn()\n        .mockRejectedValue(\n          new Error(\"CORS policy: No 'Access-Control-Allow-Origin' header\"),\n        );\n\n      await expect(apiClient.get('/test')).rejects.toThrow('CORS policy');\n    });\n  });\n\n  describe('Intermittent Network Errors', () => {\n    it('should handle intermittent network failures with retry', async () => {\n      let callCount = 0;\n      global.fetch = vi.fn().mockImplementation(() => {\n        callCount++;\n        // Fail first 2 calls, succeed on 3rd\n        if (callCount <= 2) {\n          return Promise.reject(new Error('Intermittent network failure'));\n        }\n        return Promise.resolve({\n          ok: true,\n          json: async () => ({ success: true, attempt: callCount }),\n        });\n      });\n\n      const result = await apiClient.get('/test');\n      expect(result).toEqual({ success: true, attempt: 3 });\n      expect(callCount).toBe(3);\n    });\n\n    it('should handle random network failures', async () => {\n      // Simulate 70% failure rate\n      networkSimulator.simulateIntermittentFailure(0.7);\n\n      const results = [];\n      const attempts = 10;\n\n      for (let i = 0; i < attempts; i++) {\n        try {\n          await apiClient.get('/test');\n          results.push('success');\n        } catch (error) {\n          results.push('failure');\n        }\n      }\n\n      // Should have some failures due to 70% failure rate\n      const failures = results.filter((r) => r === 'failure').length;\n      expect(failures).toBeGreaterThan(0);\n    });\n  });\n\n  describe('Slow Network Handling', () => {\n    it('should handle slow network responses', async () => {\n      networkSimulator.simulateSlowNetwork(1000); // 减少延迟时间\n\n      const startTime = Date.now();\n\n      global.fetch = vi.fn().mockImplementation(\n        () =>\n          new Promise((resolve) => {\n            setTimeout(() => {\n              resolve({\n                ok: true,\n                json: async () => ({ success: true, data: 'slow response' }),\n              });\n            }, 1000); // 减少到1秒\n          }),\n      );\n\n      const result = await apiClient.get('/test');\n      const endTime = Date.now();\n\n      expect(result).toEqual({ success: true, data: 'slow response' });\n      expect(endTime - startTime).toBeGreaterThanOrEqual(1000); // 调整期望值\n    }, 10000); // 为这个测试设置10秒超时\n\n    it('should timeout on extremely slow responses', async () => {\n      // Simulate request that takes longer than timeout\n      global.fetch = vi.fn().mockImplementation(\n        () =>\n          new Promise((_, reject) => {\n            setTimeout(() => {\n              reject(new Error('Request timeout'));\n            }, 2000); // 减少到2秒，避免测试超时\n          }),\n      );\n\n      await expect(apiClient.get('/test')).rejects.toThrow('Request timeout');\n    }, 15000); // 为这个特定测试设置15秒超时\n  });\n\n  describe('HTTP Status Error Handling', () => {\n    it('should handle 4xx client errors correctly', async () => {\n      const clientErrors = [400, 401, 403, 404, 422, 429];\n\n      for (const status of clientErrors) {\n        apiSimulator.simulateHTTPError(status);\n\n        await expect(apiClient.get('/test')).rejects.toThrow(`HTTP ${status}`);\n      }\n    }, 20000); // 为循环测试设置20秒超时\n\n    it('should handle 5xx server errors correctly', async () => {\n      const serverErrors = [500, 502, 503, 504];\n\n      for (const status of serverErrors) {\n        apiSimulator.simulateHTTPError(status);\n\n        await expect(apiClient.get('/test')).rejects.toThrow(`HTTP ${status}`);\n      }\n    }, 20000); // 为循环测试设置20秒超时\n\n    it('should retry on 5xx errors but not on 4xx errors', async () => {\n      let callCount = 0;\n\n      // First test: 500 error (should retry)\n      global.fetch = vi.fn().mockImplementation(() => {\n        callCount++;\n        return Promise.resolve({\n          ok: false,\n          status: 500,\n          statusText: 'Internal Server Error',\n        });\n      });\n\n      await expect(apiClient.get('/test')).rejects.toThrow('HTTP 500');\n      expect(callCount).toBe(4); // 1 initial + 3 retries\n\n      // Reset for second test\n      callCount = 0;\n\n      // Second test: 404 error (should not retry)\n      global.fetch = vi.fn().mockImplementation(() => {\n        callCount++;\n        return Promise.resolve({\n          ok: false,\n          status: 404,\n          statusText: 'Not Found',\n        });\n      });\n\n      await expect(apiClient.get('/test')).rejects.toThrow('HTTP 404');\n      expect(callCount).toBe(1); // No retries for 4xx errors\n    });\n  });\n\n  describe('Fallback and Degradation Strategies', () => {\n    it('should use fallback endpoint when primary fails', async () => {\n      // Primary endpoint fails\n      let callCount = 0;\n      global.fetch = vi.fn().mockImplementation((url) => {\n        callCount++;\n        if (url.includes('/primary')) {\n          return Promise.reject(new Error('Primary endpoint failed'));\n        }\n        if (url.includes('/fallback')) {\n          return Promise.resolve({\n            ok: true,\n            json: async () => ({ success: true, source: 'fallback' }),\n          });\n        }\n        return Promise.reject(new Error('Unknown endpoint'));\n      });\n\n      const result = await apiClient.requestWithFallback(\n        '/primary',\n        '/fallback',\n        { success: false, source: 'default' },\n      );\n\n      expect(result).toEqual({\n        data: { success: true, source: 'fallback' },\n        source: 'fallback',\n      });\n    });\n\n    it('should use default value when both primary and fallback fail', async () => {\n      global.fetch = vi\n        .fn()\n        .mockRejectedValue(new Error('All endpoints failed'));\n\n      const result = await apiClient.requestWithFallback(\n        '/primary',\n        '/fallback',\n        { success: false, source: 'default' },\n      );\n\n      expect(result).toEqual({\n        data: { success: false, source: 'default' },\n        source: 'default',\n      });\n    });\n\n    it('should prefer primary endpoint when available', async () => {\n      global.fetch = vi.fn().mockImplementation((url) => {\n        if (url.includes('/primary')) {\n          return Promise.resolve({\n            ok: true,\n            json: async () => ({ success: true, source: 'primary' }),\n          });\n        }\n        return Promise.resolve({\n          ok: true,\n          json: async () => ({ success: true, source: 'fallback' }),\n        });\n      });\n\n      const result = await apiClient.requestWithFallback(\n        '/primary',\n        '/fallback',\n        { success: false, source: 'default' },\n      );\n\n      expect(result).toEqual({\n        data: { success: true, source: 'primary' },\n        source: 'primary',\n      });\n    });\n  });\n\n  describe('Error Recovery Mechanisms', () => {\n    it('should test retry mechanism with configurable attempts', async () => {\n      const operation = vi\n        .fn()\n        .mockRejectedValueOnce(new Error('Attempt 1 failed'))\n        .mockRejectedValueOnce(new Error('Attempt 2 failed'))\n        .mockResolvedValueOnce('Success');\n\n      const result = await recoveryTester.testRetryMechanism(\n        operation,\n        'test-operation',\n        3,\n        2,\n      );\n\n      expect(result.success).toBe(true);\n      expect(result.attempts).toBe(3);\n      expect(operation).toHaveBeenCalledTimes(3);\n    });\n\n    it('should test fallback mechanism', async () => {\n      const primaryOperation = vi.fn().mockImplementation(() => {\n        throw new Error('Primary failed');\n      });\n      const fallbackOperation = vi.fn().mockReturnValue('Fallback success');\n\n      const result = recoveryTester.testFallbackMechanism(\n        primaryOperation,\n        fallbackOperation,\n      );\n\n      expect(result.result).toBe('Fallback success');\n      expect(result.usedFallback).toBe(true);\n      expect(primaryOperation).toHaveBeenCalledTimes(1);\n      expect(fallbackOperation).toHaveBeenCalledTimes(1);\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/tests/error-scenarios/setup.ts","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used. Allowed unused args must match /^_/u.","line":228,"column":45,"nodeType":"Identifier","messageId":"unusedVar","endLine":228,"endColumn":57,"suggestions":[{"messageId":"removeVar","data":{"varName":"error"},"fix":{"range":[5365,5377],"text":""},"desc":"Remove unused variable 'error'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used. Allowed unused args must match /^_/u.","line":233,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":233,"endColumn":30,"suggestions":[{"messageId":"removeVar","data":{"varName":"error"},"fix":{"range":[5512,5524],"text":""},"desc":"Remove unused variable 'error'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":327,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":327,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":327,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":327,"endColumn":19}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Error Scenarios Testing Setup\n *\n * 提供全面的错误处理测试基础设施，包括：\n * - 网络错误模拟\n * - API错误处理\n * - 边界条件测试\n * - 异常情况处理\n * - 错误恢复机制\n */\n\nimport React, { ReactElement } from 'react';\nimport { render, RenderOptions } from '@testing-library/react';\nimport { vi } from 'vitest';\n\n// 错误类型定义\nexport interface ErrorScenario {\n  name: string;\n  type: 'network' | 'api' | 'validation' | 'boundary' | 'system';\n  description: string;\n  setup: () => void;\n  cleanup: () => void;\n  expectedBehavior: string;\n}\n\n// 网络错误模拟器\nexport class NetworkErrorSimulator {\n  private originalFetch: typeof global.fetch;\n\n  constructor() {\n    this.originalFetch = global.fetch;\n  }\n\n  // 模拟网络超时\n  simulateTimeout(delay: number = 5000): void {\n    global.fetch = vi.fn().mockImplementation(\n      () =>\n        new Promise((_, reject) => {\n          setTimeout(() => reject(new Error('Network timeout')), delay);\n        }),\n    );\n  }\n\n  // 模拟网络连接失败\n  simulateConnectionFailure(): void {\n    global.fetch = vi\n      .fn()\n      .mockRejectedValue(\n        new Error('Failed to fetch: Network connection failed'),\n      );\n  }\n\n  // 模拟间歇性网络错误\n  simulateIntermittentFailure(failureRate: number = 0.5): void {\n    global.fetch = vi.fn().mockImplementation((url, options) => {\n      if (\n        crypto &&\n        crypto.getRandomValues(new Uint32Array(1))[0]! / 2 ** 32 < failureRate\n      ) {\n        return Promise.reject(new Error('Intermittent network failure'));\n      }\n      return this.originalFetch(url, options);\n    });\n  }\n\n  // 模拟慢网络\n  simulateSlowNetwork(delay: number = 2000): void {\n    global.fetch = vi.fn().mockImplementation(\n      (url, options) =>\n        new Promise((resolve) => {\n          setTimeout(() => {\n            resolve(this.originalFetch(url, options));\n          }, delay);\n        }),\n    );\n  }\n\n  // 恢复原始fetch\n  restore(): void {\n    global.fetch = this.originalFetch;\n  }\n}\n\n// API错误模拟器\nexport class APIErrorSimulator {\n  // 模拟HTTP状态码错误\n  simulateHTTPError(status: number, message?: string): void {\n    global.fetch = vi.fn().mockResolvedValue({\n      ok: false,\n      status,\n      statusText: this.getStatusText(status),\n      json: async () => ({\n        success: false,\n        error: message || this.getDefaultErrorMessage(status),\n      }),\n    } as Response);\n  }\n\n  // 模拟服务器内部错误\n  simulateServerError(): void {\n    this.simulateHTTPError(500, 'Internal Server Error');\n  }\n\n  // 模拟认证错误\n  simulateAuthError(): void {\n    this.simulateHTTPError(401, 'Unauthorized');\n  }\n\n  // 模拟权限错误\n  simulatePermissionError(): void {\n    this.simulateHTTPError(403, 'Forbidden');\n  }\n\n  // 模拟资源不存在错误\n  simulateNotFoundError(): void {\n    this.simulateHTTPError(404, 'Resource not found');\n  }\n\n  // 模拟请求过于频繁错误\n  simulateRateLimitError(): void {\n    this.simulateHTTPError(429, 'Too Many Requests');\n  }\n\n  // 模拟无效JSON响应\n  simulateInvalidJSONResponse(): void {\n    global.fetch = vi.fn().mockResolvedValue({\n      ok: true,\n      status: 200,\n      headers: new Headers(),\n      redirected: false,\n      statusText: 'OK',\n      type: 'basic' as Response['type'],\n      url: '',\n      body: null,\n      bodyUsed: false,\n      clone: vi.fn(),\n      arrayBuffer: vi.fn(),\n      blob: vi.fn(),\n      formData: vi.fn(),\n      text: vi.fn(),\n      bytes: vi.fn().mockResolvedValue(new Uint8Array()),\n      json: async () => {\n        throw new Error('Unexpected token in JSON');\n      },\n    } as Response);\n  }\n\n  private getStatusText(status: number): string {\n    const statusTexts = new Map([\n      [400, 'Bad Request'],\n      [401, 'Unauthorized'],\n      [403, 'Forbidden'],\n      [404, 'Not Found'],\n      [429, 'Too Many Requests'],\n      [500, 'Internal Server Error'],\n      [502, 'Bad Gateway'],\n      [503, 'Service Unavailable'],\n    ]);\n    return statusTexts.get(status) || 'Unknown Error';\n  }\n\n  private getDefaultErrorMessage(status: number): string {\n    const messages = new Map([\n      [400, 'The request was invalid'],\n      [401, 'Authentication required'],\n      [403, 'Access denied'],\n      [404, 'The requested resource was not found'],\n      [429, 'Too many requests, please try again later'],\n      [500, 'An internal server error occurred'],\n      [502, 'Bad gateway'],\n      [503, 'Service temporarily unavailable'],\n    ]);\n    return messages.get(status) || 'An unknown error occurred';\n  }\n}\n\n// 边界条件测试工具\nexport class BoundaryConditionTester {\n  // 生成极大字符串\n  generateLargeString(size: number): string {\n    return 'a'.repeat(size);\n  }\n\n  // 生成特殊字符字符串\n  generateSpecialCharString(): string {\n    return '!@#$%^&*()_+-=[]{}|;:,.<>?`~\\'\"\\\\';\n  }\n\n  // 生成Unicode字符串\n  generateUnicodeString(): string {\n    return '你好世界🌍🚀💻🎉';\n  }\n\n  // 生成SQL注入尝试字符串\n  generateSQLInjectionString(): string {\n    return \"'; DROP TABLE users; --\";\n  }\n\n  // 生成XSS尝试字符串\n  generateXSSString(): string {\n    return '<script>alert(\"XSS\")</script>';\n  }\n\n  // 生成极大数字\n  generateLargeNumber(): number {\n    return Number.MAX_SAFE_INTEGER;\n  }\n\n  // 生成负数\n  generateNegativeNumber(): number {\n    return -1000000;\n  }\n\n  // 生成无效日期\n  generateInvalidDate(): string {\n    return '2023-13-45';\n  }\n\n  // 生成空值变体\n  generateNullVariants(): Array<unknown> {\n    return [null, undefined, '', 0, false, NaN, {}, []];\n  }\n}\n\n// 错误边界测试组件工厂\nexport function createTestErrorBoundary() {\n  return class TestErrorBoundary extends React.Component<\n    { children: React.ReactNode; onError?: (error: Error) => void },\n    { hasError: boolean; error?: Error }\n  > {\n    constructor(props: {\n      children: React.ReactNode;\n      onError?: (error: Error) => void;\n    }) {\n      super(props);\n      this.state = { hasError: false };\n    }\n\n    static getDerivedStateFromError(error: Error) {\n      return { hasError: true, error };\n    }\n\n    override componentDidCatch(error: Error, errorInfo: React.ErrorInfo) {\n      this.props.onError?.(error);\n      console.error('Test Error Boundary caught error:', error, errorInfo);\n    }\n\n    override render() {\n      if (this.state.hasError) {\n        return React.createElement(\n          'div',\n          { 'data-testid': 'test-error-boundary' },\n          React.createElement('h2', null, 'Test Error Boundary'),\n          React.createElement('p', null, `Error: ${this.state.error?.message}`),\n        );\n      }\n\n      return this.props.children;\n    }\n  };\n}\n\n// 错误场景渲染器\nexport function renderWithErrorScenario(\n  ui: ReactElement,\n  scenario: ErrorScenario,\n  options?: RenderOptions,\n) {\n  // 设置错误场景\n  scenario.setup();\n\n  try {\n    const result = render(ui, options);\n    return {\n      ...result,\n      cleanup: () => {\n        scenario.cleanup();\n        result.unmount();\n      },\n    };\n  } catch (error) {\n    scenario.cleanup();\n    throw error;\n  }\n}\n\n// 错误恢复测试工具\nexport class ErrorRecoveryTester {\n  // 测试重试机制\n  async testRetryMechanism(\n    operation: () => Promise<unknown>,\n    _operationId: string,\n    maxRetries: number = 3,\n    backoffMs: number = 10,\n  ): Promise<{ success: boolean; attempts: number; lastError?: Error | null }> {\n    let attempts = 0;\n    let lastError: Error | null = null;\n\n    for (let i = 0; i <= maxRetries; i++) {\n      attempts++;\n      try {\n        await operation();\n        return { success: true, attempts };\n      } catch (error) {\n        lastError = error as Error;\n        if (i === maxRetries) {\n          break;\n        }\n        // 简单的退避延迟\n        if (backoffMs > 0) {\n          await new Promise((resolve) => setTimeout(resolve, backoffMs));\n        }\n      }\n    }\n\n    return { success: false, attempts, lastError };\n  }\n\n  // 测试降级机制\n  testFallbackMechanism<T>(\n    primaryOperation: () => T,\n    fallbackOperation: () => T,\n  ): { result: T; usedFallback: boolean } {\n    try {\n      const result = primaryOperation();\n      return { result, usedFallback: false };\n    } catch (error) {\n      const result = fallbackOperation();\n      return { result, usedFallback: true };\n    }\n  }\n}\n\n// 导出所有工具\nexport const errorTestingUtils = {\n  NetworkErrorSimulator,\n  APIErrorSimulator,\n  BoundaryConditionTester,\n  ErrorRecoveryTester,\n  createTestErrorBoundary,\n  renderWithErrorScenario,\n};\n\n// 常用错误场景预设\nexport const commonErrorScenarios: ErrorScenario[] = [\n  {\n    name: 'Network Timeout',\n    type: 'network',\n    description: 'Simulates network request timeout',\n    setup: () => new NetworkErrorSimulator().simulateTimeout(),\n    cleanup: () => new NetworkErrorSimulator().restore(),\n    expectedBehavior: 'Should show timeout error message and retry option',\n  },\n  {\n    name: 'Server Error',\n    type: 'api',\n    description: 'Simulates 500 Internal Server Error',\n    setup: () => new APIErrorSimulator().simulateServerError(),\n    cleanup: () => vi.restoreAllMocks(),\n    expectedBehavior:\n      'Should show generic error message and contact support option',\n  },\n  {\n    name: 'Authentication Error',\n    type: 'api',\n    description: 'Simulates 401 Unauthorized error',\n    setup: () => new APIErrorSimulator().simulateAuthError(),\n    cleanup: () => vi.restoreAllMocks(),\n    expectedBehavior: 'Should redirect to login page',\n  },\n];\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/tests/error-scenarios/system-errors.test.ts","messages":[{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":44,"column":11,"nodeType":"MemberExpression","endLine":44,"endColumn":35},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":198,"column":7,"nodeType":"MemberExpression","endLine":198,"endColumn":19},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":199,"column":41,"nodeType":"MemberExpression","endLine":199,"endColumn":53}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * System Error and Exception Handling Tests\n *\n * 全面测试系统级错误处理，包括：\n * - 内存不足错误\n * - 文件系统错误\n * - 权限错误\n * - 资源耗尽\n * - 异步错误处理\n * - 未捕获异常\n */\n\nimport { afterEach, beforeEach, describe, expect, it, vi } from 'vitest';\n\n// 模拟系统错误场景\nclass SystemErrorSimulator {\n  // 模拟内存不足错误\n  simulateOutOfMemoryError(): void {\n    const originalError = global.Error;\n    global.Error = class extends originalError {\n      constructor(message?: string) {\n        super(message);\n        if (message?.includes('memory')) {\n          this.name = 'RangeError';\n          this.message = 'Maximum call stack size exceeded';\n        }\n      }\n    } as unknown;\n  }\n\n  // 模拟文件系统错误\n  simulateFileSystemError(\n    errorType: 'ENOENT' | 'EACCES' | 'EMFILE' | 'ENOSPC',\n  ): Error {\n    const errorMessages = {\n      ENOENT: 'ENOENT: no such file or directory',\n      EACCES: 'EACCES: permission denied',\n      EMFILE: 'EMFILE: too many open files',\n      ENOSPC: 'ENOSPC: no space left on device',\n    };\n\n    const error = new Error(\n      Object.hasOwn(errorMessages, errorType)\n        ? errorMessages[errorType]\n        : 'Unknown error',\n    );\n    (error as unknown).code = errorType;\n    (error as unknown).errno = -2;\n    return error;\n  }\n\n  // 模拟网络资源耗尽\n  simulateResourceExhaustion(): void {\n    global.fetch = vi\n      .fn()\n      .mockRejectedValue(new Error('ECONNRESET: Connection reset by peer'));\n  }\n\n  // 模拟异步操作超时\n  simulateAsyncTimeout(delay: number = 5000): Promise<never> {\n    return new Promise((_, reject) => {\n      setTimeout(() => {\n        reject(new Error('Operation timed out'));\n      }, delay);\n    });\n  }\n\n  // 恢复原始状态\n  restore(): void {\n    vi.restoreAllMocks();\n  }\n}\n\n// 错误处理器类\nclass ErrorHandler {\n  private errorLog: Array<{ error: Error; timestamp: Date; context?: Record<string, unknown> }> =\n    [];\n  private retryAttempts: Map<string, number> = new Map();\n\n  // 处理系统错误\n  handleSystemError(\n    error: Error,\n    context?: Record<string, unknown>,\n  ): { handled: boolean; action: string } {\n    this.logError(error, context);\n\n    // 根据错误类型决定处理策略\n    if (error.message.includes('ENOENT')) {\n      return { handled: true, action: 'create_missing_resource' };\n    }\n\n    if (error.message.includes('EACCES')) {\n      return { handled: true, action: 'request_permissions' };\n    }\n\n    if (error.message.includes('EMFILE')) {\n      return { handled: true, action: 'close_unused_files' };\n    }\n\n    if (error.message.includes('ENOSPC')) {\n      return { handled: true, action: 'cleanup_disk_space' };\n    }\n\n    if (error.message.includes('timeout')) {\n      return { handled: true, action: 'retry_with_backoff' };\n    }\n\n    if (\n      error.message.includes('memory') ||\n      error.message.includes('stack size exceeded')\n    ) {\n      return { handled: true, action: 'garbage_collect' };\n    }\n\n    return { handled: false, action: 'escalate_to_admin' };\n  }\n\n  // 重试机制\n  async retryOperation<T>(\n    operation: () => Promise<T>,\n    operationId: string,\n    maxRetries: number = 3,\n    backoffMs: number = 1000,\n  ): Promise<T> {\n    const currentAttempts = this.retryAttempts.get(operationId) || 0;\n\n    try {\n      const result = await operation();\n      this.retryAttempts.delete(operationId); // 成功后清除重试计数\n      return result;\n    } catch (error) {\n      if (currentAttempts >= maxRetries) {\n        this.retryAttempts.delete(operationId);\n        throw new Error(\n          `Operation failed after ${maxRetries} retries: ${(error as Error).message}`,\n        );\n      }\n\n      this.retryAttempts.set(operationId, currentAttempts + 1);\n\n      // 指数退避\n      const delay = backoffMs * 2 ** currentAttempts;\n      await new Promise((resolve) => setTimeout(resolve, delay));\n\n      return this.retryOperation(operation, operationId, maxRetries, backoffMs);\n    }\n  }\n\n  // 降级处理\n  async handleWithFallback<T>(\n    primaryOperation: () => Promise<T>,\n    fallbackOperation: () => Promise<T>,\n    defaultValue: T,\n  ): Promise<{ result: T; source: 'primary' | 'fallback' | 'default' }> {\n    try {\n      const result = await primaryOperation();\n      return { result, source: 'primary' };\n    } catch (primaryError) {\n      this.logError(primaryError as Error, { operation: 'primary' });\n\n      try {\n        const result = await fallbackOperation();\n        return { result, source: 'fallback' };\n      } catch (fallbackError) {\n        this.logError(fallbackError as Error, { operation: 'fallback' });\n        return { result: defaultValue, source: 'default' };\n      }\n    }\n  }\n\n  // 记录错误\n  private logError(error: Error, context?: Record<string, unknown>): void {\n    this.errorLog.push({\n      error,\n      timestamp: new Date(),\n      context,\n    });\n  }\n\n  // 获取错误日志\n  getErrorLog(): Array<{ error: Error; timestamp: Date; context?: Record<string, unknown> }> {\n    return [...this.errorLog];\n  }\n\n  // 清除错误日志\n  clearErrorLog(): void {\n    this.errorLog = [];\n  }\n\n  // 获取错误统计\n  getErrorStats(): { total: number; byType: Record<string, number> } {\n    const total = this.errorLog.length;\n    const byType: Record<string, number> = {};\n\n    this.errorLog.forEach(({ error }) => {\n      const type = error.constructor.name;\n\n      byType[type] =\n        ((Object.hasOwn(byType, type) ? byType[type] : null) || 0) + 1;\n    });\n\n    return { total, byType };\n  }\n}\n\ndescribe('System Error and Exception Handling Tests', () => {\n  let systemSimulator: SystemErrorSimulator;\n  let errorHandler: ErrorHandler;\n\n  beforeEach(() => {\n    systemSimulator = new SystemErrorSimulator();\n    errorHandler = new ErrorHandler();\n    vi.clearAllMocks();\n  });\n\n  afterEach(() => {\n    systemSimulator.restore();\n    vi.restoreAllMocks();\n  });\n\n  describe('File System Error Handling', () => {\n    it('should handle file not found errors', () => {\n      const error = systemSimulator.simulateFileSystemError('ENOENT');\n      const result = errorHandler.handleSystemError(error);\n\n      expect(result.handled).toBe(true);\n      expect(result.action).toBe('create_missing_resource');\n    });\n\n    it('should handle permission denied errors', () => {\n      const error = systemSimulator.simulateFileSystemError('EACCES');\n      const result = errorHandler.handleSystemError(error);\n\n      expect(result.handled).toBe(true);\n      expect(result.action).toBe('request_permissions');\n    });\n\n    it('should handle too many open files errors', () => {\n      const error = systemSimulator.simulateFileSystemError('EMFILE');\n      const result = errorHandler.handleSystemError(error);\n\n      expect(result.handled).toBe(true);\n      expect(result.action).toBe('close_unused_files');\n    });\n\n    it('should handle disk space errors', () => {\n      const error = systemSimulator.simulateFileSystemError('ENOSPC');\n      const result = errorHandler.handleSystemError(error);\n\n      expect(result.handled).toBe(true);\n      expect(result.action).toBe('cleanup_disk_space');\n    });\n  });\n\n  describe('Memory and Resource Management', () => {\n    it('should handle out of memory errors', () => {\n      const memoryError = new Error('Maximum call stack size exceeded');\n      const result = errorHandler.handleSystemError(memoryError);\n\n      expect(result.handled).toBe(true);\n      expect(result.action).toBe('garbage_collect');\n    });\n\n    it('should handle resource exhaustion', async () => {\n      systemSimulator.simulateResourceExhaustion();\n\n      expect(global.fetch).toHaveBeenCalledTimes(0);\n\n      // Test that fetch will reject\n      await expect(fetch('/test')).rejects.toThrow('ECONNRESET');\n    });\n\n    it('should handle large memory allocations gracefully', () => {\n      // Simulate attempting to allocate large amounts of memory\n      const largeArrayTest = () => {\n        try {\n          // This would normally cause memory issues\n          const largeArray = new Array(Number.MAX_SAFE_INTEGER);\n          return largeArray;\n        } catch (error) {\n          return errorHandler.handleSystemError(error as Error);\n        }\n      };\n\n      const result = largeArrayTest();\n      expect(result).toBeDefined();\n    });\n  });\n\n  describe('Async Error Handling', () => {\n    it('should handle async operation timeouts', async () => {\n      const timeoutPromise = systemSimulator.simulateAsyncTimeout(100);\n\n      await expect(timeoutPromise).rejects.toThrow('Operation timed out');\n    });\n\n    it('should handle unhandled promise rejections', async () => {\n      const unhandledRejections: Array<{ reason: unknown; promise: Promise<unknown> }> =\n        [];\n\n      // Mock unhandled rejection handler\n      const originalHandler = process.listeners('unhandledRejection');\n      process.removeAllListeners('unhandledRejection');\n\n      process.on('unhandledRejection', (reason, promise) => {\n        unhandledRejections.push({ reason, promise });\n      });\n\n      // Create unhandled rejection\n      Promise.reject(new Error('Unhandled async error'));\n\n      // Wait for event loop\n      await new Promise((resolve) => setTimeout(resolve, 10));\n\n      expect(unhandledRejections).toHaveLength(1);\n      expect(unhandledRejections[0]?.reason.message).toBe(\n        'Unhandled async error',\n      );\n\n      // Restore original handlers\n      process.removeAllListeners('unhandledRejection');\n      originalHandler.forEach((handler) => {\n        process.on('unhandledRejection', handler as unknown);\n      });\n    });\n\n    it('should handle concurrent async errors', async () => {\n      const operations = Array.from({ length: 10 }, (_, i) =>\n        Promise.reject(new Error(`Async error ${i}`)),\n      );\n\n      const results = await Promise.allSettled(operations);\n\n      expect(results).toHaveLength(10);\n      results.forEach((result, index) => {\n        expect(result.status).toBe('rejected');\n        expect((result as PromiseRejectedResult).reason.message).toBe(\n          `Async error ${index}`,\n        );\n      });\n    });\n  });\n\n  describe('Retry Mechanisms', () => {\n    it('should retry failed operations with exponential backoff', async () => {\n      let attemptCount = 0;\n      const failingOperation = async () => {\n        attemptCount++;\n        if (attemptCount < 3) {\n          throw new Error(`Attempt ${attemptCount} failed`);\n        }\n        return `Success on attempt ${attemptCount}`;\n      };\n\n      const result = await errorHandler.retryOperation(\n        failingOperation,\n        'test-operation',\n        3,\n        10, // Short delay for testing\n      );\n\n      expect(result).toBe('Success on attempt 3');\n      expect(attemptCount).toBe(3);\n    });\n\n    it('should fail after maximum retry attempts', async () => {\n      const alwaysFailingOperation = async () => {\n        throw new Error('Always fails');\n      };\n\n      await expect(\n        errorHandler.retryOperation(\n          alwaysFailingOperation,\n          'failing-operation',\n          2,\n          10,\n        ),\n      ).rejects.toThrow('Operation failed after 2 retries');\n    });\n\n    it('should handle retry with different error types', async () => {\n      const errorTypes = ['Network error', 'Timeout error', 'Server error'];\n      let attemptCount = 0;\n\n      const varyingErrorOperation = async () => {\n        const errorType = errorTypes[attemptCount % errorTypes.length];\n        attemptCount++;\n\n        if (attemptCount < 4) {\n          throw new Error(errorType);\n        }\n        return 'Success';\n      };\n\n      const result = await errorHandler.retryOperation(\n        varyingErrorOperation,\n        'varying-error-operation',\n        5,\n        10,\n      );\n\n      expect(result).toBe('Success');\n      expect(attemptCount).toBe(4);\n    });\n  });\n\n  describe('Fallback and Degradation', () => {\n    it('should use fallback when primary operation fails', async () => {\n      const primaryOperation = async () => {\n        throw new Error('Primary failed');\n      };\n\n      const fallbackOperation = async () => {\n        return 'Fallback success';\n      };\n\n      const result = await errorHandler.handleWithFallback(\n        primaryOperation,\n        fallbackOperation,\n        'Default value',\n      );\n\n      expect(result.result).toBe('Fallback success');\n      expect(result.source).toBe('fallback');\n    });\n\n    it('should use default value when both operations fail', async () => {\n      const primaryOperation = async () => {\n        throw new Error('Primary failed');\n      };\n\n      const fallbackOperation = async () => {\n        throw new Error('Fallback failed');\n      };\n\n      const result = await errorHandler.handleWithFallback(\n        primaryOperation,\n        fallbackOperation,\n        'Default value',\n      );\n\n      expect(result.result).toBe('Default value');\n      expect(result.source).toBe('default');\n    });\n\n    it('should prefer primary operation when successful', async () => {\n      const primaryOperation = async () => {\n        return 'Primary success';\n      };\n\n      const fallbackOperation = async () => {\n        return 'Fallback success';\n      };\n\n      const result = await errorHandler.handleWithFallback(\n        primaryOperation,\n        fallbackOperation,\n        'Default value',\n      );\n\n      expect(result.result).toBe('Primary success');\n      expect(result.source).toBe('primary');\n    });\n  });\n\n  describe('Error Logging and Monitoring', () => {\n    it('should log all errors with timestamps', () => {\n      const errors = [\n        new Error('Error 1'),\n        new Error('Error 2'),\n        new Error('Error 3'),\n      ];\n\n      errors.forEach((error) => {\n        errorHandler.handleSystemError(error);\n      });\n\n      const errorLog = errorHandler.getErrorLog();\n      expect(errorLog).toHaveLength(3);\n\n      errorLog.forEach((entry, index) => {\n        expect(entry.error.message).toBe(`Error ${index + 1}`);\n        expect(entry.timestamp).toBeInstanceOf(Date);\n      });\n    });\n\n    it('should provide error statistics', () => {\n      const errors = [\n        new Error('Error 1'),\n        new TypeError('Type Error'),\n        new RangeError('Range Error'),\n        new Error('Error 2'),\n      ];\n\n      errors.forEach((error) => {\n        errorHandler.handleSystemError(error);\n      });\n\n      const stats = errorHandler.getErrorStats();\n      expect(stats.total).toBe(4);\n      expect(stats.byType.Error).toBe(2);\n      expect(stats.byType.TypeError).toBe(1);\n      expect(stats.byType.RangeError).toBe(1);\n    });\n\n    it('should clear error logs when requested', () => {\n      errorHandler.handleSystemError(new Error('Test error'));\n      expect(errorHandler.getErrorLog()).toHaveLength(1);\n\n      errorHandler.clearErrorLog();\n      expect(errorHandler.getErrorLog()).toHaveLength(0);\n    });\n  });\n\n  describe('Unknown Error Handling', () => {\n    it('should handle unknown error types gracefully', () => {\n      const unknownError = new Error('Unknown system error');\n      const result = errorHandler.handleSystemError(unknownError);\n\n      expect(result.handled).toBe(false);\n      expect(result.action).toBe('escalate_to_admin');\n    });\n\n    it('should handle non-Error objects thrown as errors', () => {\n      const nonErrorObject = { message: 'Not an Error object', code: 500 };\n\n      // Simulate handling non-Error objects\n      const handleNonError = (obj: unknown) => {\n        try {\n          throw obj;\n        } catch (caught) {\n          if (caught instanceof Error) {\n            return errorHandler.handleSystemError(caught);\n          }\n          // Convert to Error\n          const error = new Error(String((caught as unknown)?.message || caught));\n          return errorHandler.handleSystemError(error);\n        }\n      };\n\n      const result = handleNonError(nonErrorObject);\n      expect(result).toBeDefined();\n      expect(result.handled).toBe(false);\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/tests/integration/api/test-content.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/tests/integration/components/footer-i18n-branding.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/tests/integration/components/footer-responsive-accessibility.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/tests/integration/components/footer-structure-navigation.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/tests/integration/components/footer.test.tsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'label' is defined but never used. Allowed unused args must match /^_/u.","line":136,"column":34,"nodeType":"Identifier","messageId":"unusedVar","endLine":136,"endColumn":39,"suggestions":[{"messageId":"removeVar","data":{"varName":"label"},"fix":{"range":[3462,3469],"text":""},"desc":"Remove unused variable 'label'."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'label' is defined but never used. Allowed unused args must match /^_/u.","line":136,"column":34,"nodeType":null,"messageId":"unusedVar","endLine":136,"endColumn":39},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":172,"column":45,"nodeType":"MemberExpression","endLine":172,"endColumn":62},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":338,"column":15,"nodeType":"MemberExpression","endLine":338,"endColumn":39}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Integration Tests for Footer Component\n *\n * Tests the complete footer functionality including:\n * - Navigation link integration\n * - Internationalization\n * - Social media links\n * - Company branding\n * - Responsive behavior\n */\n\nimport React from 'react';\nimport { render, screen } from '@testing-library/react';\nimport userEvent from '@testing-library/user-event';\nimport { afterEach, beforeEach, describe, expect, it, vi } from 'vitest';\nimport { Footer } from '@/components/layout/footer';\n\n// Mock next-intl hooks\nconst mockUseTranslations = vi.fn();\nconst mockUseLocale = vi.fn();\n\nvi.mock('next-intl', () => ({\n  useTranslations: () => mockUseTranslations,\n  useLocale: () => mockUseLocale(),\n}));\n\n// Mock Next.js Link component\nconst mockLinkClick = vi.fn();\nvi.mock('next/link', () => ({\n  default: ({ children, href, className, ...props }: React.ComponentProps<\"div\">) => (\n    <a\n      data-testid={`footer-link-${href.replace(/[^a-zA-Z0-9]/g, '-')}`}\n      href={href}\n      className={className}\n      onClick={() => mockLinkClick(href)}\n      {...props}\n    >\n      {children}\n    </a>\n  ),\n}));\n\nvi.mock('@/lib/footer-config', () => {\n  const mockFooterConfig = {\n    company: {\n      name: 'Tucsenberg',\n      description: 'Enterprise solutions provider',\n    },\n    sections: [\n      {\n        key: 'products',\n        titleKey: 'footer.sections.products.title',\n        links: [\n          {\n            translationKey: 'footer.sections.products.links.solutions',\n            href: '/solutions',\n            external: false,\n          },\n          {\n            translationKey: 'footer.sections.products.links.services',\n            href: '/services',\n            external: false,\n          },\n        ],\n      },\n      {\n        key: 'company',\n        titleKey: 'footer.sections.company.title',\n        links: [\n          {\n            translationKey: 'footer.sections.company.links.about',\n            href: '/about',\n            external: false,\n          },\n          {\n            translationKey: 'footer.sections.company.links.contact',\n            href: '/contact',\n            external: false,\n          },\n        ],\n      },\n      {\n        key: 'legal',\n        titleKey: 'footer.sections.legal.title',\n        links: [\n          {\n            translationKey: 'footer.sections.legal.links.privacy',\n            href: '/privacy',\n            external: false,\n          },\n          {\n            translationKey: 'footer.sections.legal.links.terms',\n            href: '/terms',\n            external: false,\n          },\n        ],\n      },\n    ],\n    socialLinks: [\n      {\n        key: 'linkedin',\n        href: 'https://linkedin.com/company/tucsenberg',\n        icon: 'linkedin',\n        label: 'LinkedIn',\n        ariaLabel: 'LinkedIn',\n      },\n      {\n        key: 'twitter',\n        href: 'https://twitter.com/tucsenberg',\n        icon: 'twitter',\n        label: 'Twitter',\n        ariaLabel: 'Twitter',\n      },\n    ],\n  };\n\n  return {\n    FOOTER_CONFIG: mockFooterConfig,\n    getCopyrightText: (locale: string) =>\n      locale === 'en'\n        ? '© 2024 Tucsenberg. All rights reserved.'\n        : '© 2024 Tucsenberg. 保留所有权利。',\n  };\n});\n\n// Mock social icons component\nvi.mock('@/components/ui/social-icons', () => ({\n  ExternalLinkIcon: ({ size }: React.ComponentProps<\"div\">) => (\n    <span\n      data-testid='external-link-icon'\n      data-size={size}\n    >\n      🔗\n    </span>\n  ),\n  SocialIconLink: ({ href, icon, label, ariaLabel, ...props }: React.ComponentProps<\"div\">) => (\n    <a\n      data-testid={`social-link-${icon}`}\n      href={href}\n      aria-label={ariaLabel}\n      target='_blank'\n      rel='noopener noreferrer'\n      {...props}\n    >\n      {icon === 'linkedin' ? '💼' : '🐦'}\n    </a>\n  ),\n}));\n\ndescribe('Footer Integration Tests', () => {\n  const user = userEvent.setup();\n\n  beforeEach(() => {\n    vi.clearAllMocks();\n\n    // Setup default translations\n    mockUseTranslations.mockImplementation((key: string) => {\n      const translations: Record<string, string> = {\n        'footer.sections.products.title': 'Products',\n        'footer.sections.products.links.solutions': 'Solutions',\n        'footer.sections.products.links.services': 'Services',\n        'footer.sections.company.title': 'Company',\n        'footer.sections.company.links.about': 'About Us',\n        'footer.sections.company.links.contact': 'Contact',\n        'footer.sections.legal.title': 'Legal',\n        'footer.sections.legal.links.privacy': 'Privacy Policy',\n        'footer.sections.legal.links.terms': 'Terms of Service',\n        'footer.sections.social.title': 'Follow Us',\n      };\n\n      return (\n        (Object.hasOwn(translations, key) ? translations[key] : null) || key\n      );\n    });\n\n    mockUseLocale.mockReturnValue('en');\n  });\n\n  afterEach(() => {\n    vi.restoreAllMocks();\n  });\n\n  describe('Complete Footer Structure Integration', () => {\n    it('should render complete footer with all sections', async () => {\n      render(<Footer />);\n\n      // Verify main footer container\n      const footer = screen.getByRole('contentinfo');\n      expect(footer).toBeInTheDocument();\n      expect(footer).toHaveClass('border-t', 'border-gray-200', 'bg-white');\n\n      // Verify company logo section\n      const companyLogo = screen.getByText('Tucsenberg');\n      expect(companyLogo).toBeInTheDocument();\n\n      // Verify all navigation sections are present\n      expect(screen.getByText('Products')).toBeInTheDocument();\n      expect(screen.getByText('Company')).toBeInTheDocument();\n      expect(screen.getByText('Legal')).toBeInTheDocument();\n\n      // Verify social section\n      expect(screen.getByText('Follow Us')).toBeInTheDocument();\n    });\n\n    it('should render all navigation links correctly', async () => {\n      render(<Footer />);\n\n      // Products section links\n      expect(screen.getByText('Solutions')).toBeInTheDocument();\n      expect(screen.getByText('Services')).toBeInTheDocument();\n\n      // Company section links\n      expect(screen.getByText('About Us')).toBeInTheDocument();\n      expect(screen.getByText('Contact')).toBeInTheDocument();\n\n      // Legal section links\n      expect(screen.getByText('Privacy Policy')).toBeInTheDocument();\n      expect(screen.getByText('Terms of Service')).toBeInTheDocument();\n    });\n  });\n\n  describe('Navigation Integration', () => {\n    it('should handle internal link navigation correctly', async () => {\n      render(<Footer />);\n\n      const aboutLink = screen.getByTestId('footer-link--about');\n      await user.click(aboutLink);\n\n      expect(mockLinkClick).toHaveBeenCalledWith('/about');\n    });\n\n    it('should handle all internal navigation links', async () => {\n      render(<Footer />);\n\n      const internalLinks = [\n        { testId: 'footer-link--solutions', href: '/solutions' },\n        { testId: 'footer-link--services', href: '/services' },\n        { testId: 'footer-link--about', href: '/about' },\n        { testId: 'footer-link--contact', href: '/contact' },\n        { testId: 'footer-link--privacy', href: '/privacy' },\n        { testId: 'footer-link--terms', href: '/terms' },\n      ];\n\n      for (const link of internalLinks) {\n        const linkElement = screen.getByTestId(link.testId);\n        expect(linkElement).toBeInTheDocument();\n        expect(linkElement).toHaveAttribute('href', link.href);\n      }\n    });\n\n    it('should handle external links with proper attributes', async () => {\n      // Test that the footer renders correctly with current configuration\n      render(<Footer />);\n\n      // Verify footer structure is correct\n      const footer = screen.getByRole('contentinfo');\n      expect(footer).toBeInTheDocument();\n\n      // Note: This test covers the external link branch in FooterLinkComponent\n      // The external link functionality is tested through the social media links\n      // which are external by nature (target=\"_blank\", rel=\"noopener noreferrer\")\n      const socialLinks = screen.getAllByTestId(/social-link-/);\n      expect(socialLinks.length).toBeGreaterThan(0);\n\n      // Verify social links have external attributes\n      socialLinks.forEach((link) => {\n        expect(link).toHaveAttribute('target', '_blank');\n        expect(link).toHaveAttribute('rel', 'noopener noreferrer');\n      });\n    });\n  });\n\n  describe('Social Media Integration', () => {\n    it('should render all social media links correctly', async () => {\n      render(<Footer />);\n\n      const linkedinLink = screen.getByTestId('social-link-linkedin');\n      expect(linkedinLink).toBeInTheDocument();\n      expect(linkedinLink).toHaveAttribute(\n        'href',\n        'https://linkedin.com/company/tucsenberg',\n      );\n      expect(linkedinLink).toHaveAttribute('aria-label', 'LinkedIn');\n\n      const twitterLink = screen.getByTestId('social-link-twitter');\n      expect(twitterLink).toBeInTheDocument();\n      expect(twitterLink).toHaveAttribute(\n        'href',\n        'https://twitter.com/tucsenberg',\n      );\n      expect(twitterLink).toHaveAttribute('aria-label', 'Twitter');\n    });\n\n    it('should handle social link clicks correctly', async () => {\n      render(<Footer />);\n\n      const linkedinLink = screen.getByTestId('social-link-linkedin');\n\n      // Verify link attributes for external navigation\n      expect(linkedinLink).toHaveAttribute('target', '_blank');\n      expect(linkedinLink).toHaveAttribute('rel', 'noopener noreferrer');\n    });\n  });\n\n  describe('Internationalization Integration', () => {\n    it('should display correct content for English locale', async () => {\n      mockUseLocale.mockReturnValue('en');\n\n      render(<Footer />);\n\n      // Verify English translations are used\n      expect(mockUseTranslations).toHaveBeenCalled();\n      expect(screen.getByText('Products')).toBeInTheDocument();\n      expect(screen.getByText('Company')).toBeInTheDocument();\n      expect(screen.getByText('Legal')).toBeInTheDocument();\n    });\n\n    it('should display correct content for Chinese locale', async () => {\n      mockUseLocale.mockReturnValue('zh');\n\n      // Setup Chinese translations\n      mockUseTranslations.mockImplementation((key: string) => {\n        const chineseTranslations: Record<string, string> = {\n          'footer.sections.products.title': '产品',\n          'footer.sections.products.links.solutions': '解决方案',\n          'footer.sections.products.links.services': '服务',\n          'footer.sections.company.title': '公司',\n          'footer.sections.company.links.about': '关于我们',\n          'footer.sections.company.links.contact': '联系我们',\n          'footer.sections.legal.title': '法律',\n          'footer.sections.legal.links.privacy': '隐私政策',\n          'footer.sections.legal.links.terms': '服务条款',\n          'footer.social.title': '关注我们',\n        };\n\n        return (\n          (Object.hasOwn(chineseTranslations, key)\n            ? chineseTranslations[key]\n            : null) || key\n        );\n      });\n\n      render(<Footer />);\n\n      expect(screen.getByText('产品')).toBeInTheDocument();\n      expect(screen.getByText('公司')).toBeInTheDocument();\n      expect(screen.getByText('法律')).toBeInTheDocument();\n    });\n\n    it('should handle missing translations gracefully', async () => {\n      mockUseTranslations.mockImplementation((key: string) => `missing.${key}`);\n\n      expect(() => render(<Footer />)).not.toThrow();\n\n      const footer = screen.getByRole('contentinfo');\n      expect(footer).toBeInTheDocument();\n    });\n  });\n\n  describe('Company Branding Integration', () => {\n    it('should display company logo and branding correctly', async () => {\n      render(<Footer />);\n\n      const companyLink = screen.getByLabelText('Tucsenberg homepage');\n      expect(companyLink).toBeInTheDocument();\n      expect(companyLink).toHaveAttribute('href', '/');\n\n      const companyName = screen.getByText('Tucsenberg');\n      expect(companyName).toBeInTheDocument();\n\n      // Verify logo placeholder\n      const logoPlaceholder = companyName.parentElement?.querySelector('div');\n      expect(logoPlaceholder).toHaveTextContent('T'); // First letter of company name\n    });\n\n    it('should display copyright information correctly', async () => {\n      render(<Footer />);\n\n      const copyrightText = screen.getByText(\n        '© 2024 Tucsenberg. All rights reserved.',\n      );\n      expect(copyrightText).toBeInTheDocument();\n    });\n  });\n\n  describe('Responsive Behavior Integration', () => {\n    it('should apply correct responsive grid classes', async () => {\n      render(<Footer />);\n\n      const gridContainer = screen\n        .getByRole('contentinfo')\n        .querySelector('.grid');\n      expect(gridContainer).toHaveClass(\n        'grid',\n        'grid-cols-1',\n        'gap-8',\n        'md:grid-cols-5',\n      );\n    });\n\n    it('should handle responsive column spans correctly', async () => {\n      render(<Footer />);\n\n      const footer = screen.getByRole('contentinfo');\n\n      // Company logo section should span 1 column on md+\n      const logoSection = footer.querySelector('.md\\\\:col-span-1');\n      expect(logoSection).toBeInTheDocument();\n    });\n  });\n\n  describe('Accessibility Integration', () => {\n    it('should provide proper semantic structure', async () => {\n      render(<Footer />);\n\n      const footer = screen.getByRole('contentinfo');\n      expect(footer).toBeInTheDocument();\n\n      // Verify proper heading structure would be present\n      // (Note: This would depend on the actual implementation of section titles)\n    });\n\n    it('should provide proper ARIA labels for interactive elements', async () => {\n      render(<Footer />);\n\n      const companyLink = screen.getByLabelText('Tucsenberg homepage');\n      expect(companyLink).toBeInTheDocument();\n\n      const socialLinks = screen.getAllByRole('link', {\n        name: /LinkedIn|Twitter/,\n      });\n      expect(socialLinks).toHaveLength(2);\n    });\n  });\n\n  describe('Error Recovery Integration', () => {\n    it('should handle missing footer configuration gracefully', async () => {\n      // Test with minimal configuration\n      render(<Footer />);\n\n      const footer = screen.getByRole('contentinfo');\n      expect(footer).toBeInTheDocument();\n    });\n\n    it('should handle locale detection errors gracefully', async () => {\n      mockUseLocale.mockReturnValue(undefined);\n\n      render(<Footer />);\n\n      const footer = screen.getByRole('contentinfo');\n      expect(footer).toBeInTheDocument();\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/tests/integration/components/header.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/tests/integration/components/language-toggle.test.tsx","messages":[{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":140,"column":45,"nodeType":"MemberExpression","endLine":140,"endColumn":62}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Integration Tests for LanguageToggle Component\n *\n * Tests the complete language switching workflow including:\n * - User interaction flows\n * - Transition states\n * - Internationalization integration\n * - Navigation behavior\n * - Loading states\n */\n\nimport React from 'react';\nimport { render, screen } from '@testing-library/react';\nimport userEvent from '@testing-library/user-event';\nimport { afterEach, beforeEach, describe, expect, it, vi } from 'vitest';\nimport { LanguageToggle } from '@/components/language-toggle';\n\n// Mock next-intl hooks\nconst mockUseTranslations = vi.fn();\nconst mockUseLocale = vi.fn();\nconst mockUsePathname = vi.fn();\n\nvi.mock('next-intl', () => ({\n  useTranslations: () => mockUseTranslations,\n  useLocale: () => mockUseLocale(),\n}));\n\n// Mock next-intl navigation\nvi.mock('next-intl/navigation', () => ({\n  usePathname: () => mockUsePathname(),\n  createNavigation: () => ({\n    Link: ({ children, href, locale, onClick, className, ...props }: React.ComponentProps<\"div\">) => (\n      <a\n        data-testid={`language-link-${locale}`}\n        href={href}\n        data-locale={locale}\n        className={className}\n        onClick={(e) => {\n          mockLinkClick({ href, locale });\n          onClick?.(e);\n        }}\n        {...props}\n      >\n        {children}\n      </a>\n    ),\n    usePathname: () => mockUsePathname(),\n  }),\n}));\n\n// Mock Link click tracking\nconst mockLinkClick = vi.fn();\n\n// Mock React hooks\nconst mockStartTransition = vi.fn();\nvi.mock('react', async () => {\n  const actual = await vi.importActual('react');\n  return {\n    ...actual,\n    useTransition: () => [false, mockStartTransition],\n    useState: vi.fn((initial) => {\n      const state = vi.fn(() => initial);\n      const setState = vi.fn();\n      return [state(), setState];\n    }),\n  };\n});\n\n// Mock UI components\nvi.mock('@/components/ui/dropdown-menu', () => ({\n  DropdownMenu: ({ children }: React.ComponentProps<\"div\">) => (\n    <div data-testid='language-dropdown-menu'>{children}</div>\n  ),\n  DropdownMenuTrigger: ({ children, asChild: _asChild }: React.ComponentProps<\"div\">) => (\n    <div data-testid='language-dropdown-trigger'>{children}</div>\n  ),\n  DropdownMenuContent: ({ children, align }: React.ComponentProps<\"div\">) => (\n    <div\n      data-testid='language-dropdown-content'\n      data-align={align}\n    >\n      {children}\n    </div>\n  ),\n  DropdownMenuItem: ({ children, asChild: _asChild }: React.ComponentProps<\"div\">) => (\n    <div data-testid='language-dropdown-item'>{children}</div>\n  ),\n}));\n\nvi.mock('@/components/ui/button', () => ({\n  Button: ({ children, variant, size, disabled, ...props }: React.ComponentProps<\"div\">) => (\n    <button\n      data-testid='language-toggle-button'\n      data-variant={variant}\n      data-size={size}\n      disabled={disabled}\n      {...props}\n    >\n      {children}\n    </button>\n  ),\n}));\n\n// Mock Lucide icons\nvi.mock('lucide-react', () => ({\n  Languages: () => <span data-testid='languages-icon'>🌐</span>,\n  Loader2: ({ className }: React.ComponentProps<\"div\">) => (\n    <span\n      data-testid='loader-icon'\n      className={className}\n    >\n      ⏳\n    </span>\n  ),\n  Check: ({ className }: React.ComponentProps<\"div\">) => (\n    <span\n      data-testid='check-icon'\n      className={className}\n    >\n      ✓\n    </span>\n  ),\n}));\n\ndescribe('LanguageToggle Integration Tests', () => {\n  const user = userEvent.setup();\n\n  beforeEach(() => {\n    vi.clearAllMocks();\n\n    // Setup default mock returns\n    mockUseTranslations.mockImplementation((key: string) => {\n      const translations: Record<string, string> = {\n        toggle: 'Toggle language',\n        english: 'English',\n        chinese: '中文',\n      };\n\n      return (\n        (Object.hasOwn(translations, key) ? translations[key] : null) || key\n      );\n    });\n\n    mockUseLocale.mockReturnValue('en');\n    mockUsePathname.mockReturnValue('/about');\n    mockStartTransition.mockImplementation((fn) => fn());\n  });\n\n  afterEach(() => {\n    vi.restoreAllMocks();\n  });\n\n  describe('Complete Language Switching Workflow', () => {\n    it('should complete full language switch from English to Chinese', async () => {\n      render(<LanguageToggle />);\n\n      // 1. Initial state verification\n      const toggleButton = screen.getByTestId('language-toggle-button');\n      expect(toggleButton).toBeInTheDocument();\n      expect(toggleButton).not.toBeDisabled();\n\n      // 2. Verify current language indicator\n      const checkIcon = screen.getByTestId('check-icon');\n      expect(checkIcon).toBeInTheDocument();\n\n      // 3. Click on Chinese language option\n      const chineseLink = screen.getByTestId('language-link-zh');\n      expect(chineseLink).toBeInTheDocument();\n      expect(chineseLink).toHaveAttribute('data-locale', 'zh');\n\n      await user.click(chineseLink);\n\n      // 4. Verify navigation was triggered\n      expect(mockLinkClick).toHaveBeenCalledWith({\n        href: '/about',\n        locale: 'zh',\n      });\n\n      // 5. Verify transition was started\n      expect(mockStartTransition).toHaveBeenCalled();\n    });\n\n    it('should handle language switch from Chinese to English', async () => {\n      // Setup Chinese as current locale\n      mockUseLocale.mockReturnValue('zh');\n\n      render(<LanguageToggle />);\n\n      const englishLink = screen.getByTestId('language-link-en');\n      await user.click(englishLink);\n\n      expect(mockLinkClick).toHaveBeenCalledWith({\n        href: '/about',\n        locale: 'en',\n      });\n    });\n  });\n\n  describe('Loading States Integration', () => {\n    it('should show loading state during transition', async () => {\n      // Mock the component to simulate loading state\n      const MockLanguageToggle = () => (\n        <div data-testid='language-dropdown-menu'>\n          <div data-testid='language-dropdown-trigger'>\n            <button\n              data-testid='language-toggle-button'\n              data-variant='outline'\n              data-size='icon'\n              disabled\n            >\n              <span data-testid='languages-icon'>🌐</span>\n              <span\n                data-testid='loader-icon'\n                className='animate-spin'\n              >\n                ⏳\n              </span>\n              <span className='sr-only'>Toggle language</span>\n            </button>\n          </div>\n        </div>\n      );\n\n      render(<MockLanguageToggle />);\n\n      // Verify loading state is shown\n      const toggleButton = screen.getByTestId('language-toggle-button');\n      expect(toggleButton).toBeDisabled();\n\n      const loaderIcon = screen.getByTestId('loader-icon');\n      expect(loaderIcon).toBeInTheDocument();\n      expect(loaderIcon).toHaveClass('animate-spin');\n    });\n\n    it('should show individual language loading indicators', async () => {\n      // Mock the component to simulate specific language switching\n      const MockLanguageToggleWithLoader = () => (\n        <div data-testid='language-dropdown-menu'>\n          <div data-testid='language-dropdown-trigger'>\n            <button data-testid='language-toggle-button'>\n              <span data-testid='languages-icon'>🌐</span>\n            </button>\n          </div>\n          <div data-testid='language-dropdown-content'>\n            <div data-testid='language-dropdown-item'>\n              <a\n                data-testid='language-link-zh'\n                className='flex items-center'\n              >\n                <span>ZH</span>\n                <span>中文</span>\n                <span\n                  data-testid='loader-icon'\n                  className='animate-spin'\n                >\n                  ⏳\n                </span>\n              </a>\n            </div>\n          </div>\n        </div>\n      );\n\n      render(<MockLanguageToggleWithLoader />);\n\n      // Should show loader for Chinese option\n      const chineseSection = screen.getByTestId('language-link-zh');\n      const loaderInChinese = chineseSection.querySelector(\n        '[data-testid=\"loader-icon\"]',\n      );\n      expect(loaderInChinese).toBeInTheDocument();\n    });\n  });\n\n  describe('Internationalization Integration', () => {\n    it('should use correct translations for interface elements', async () => {\n      render(<LanguageToggle />);\n\n      // Verify translations are called correctly\n      expect(mockUseTranslations).toHaveBeenCalledWith('toggle');\n      expect(mockUseTranslations).toHaveBeenCalledWith('english');\n      expect(mockUseTranslations).toHaveBeenCalledWith('chinese');\n\n      // Verify screen reader text\n      const toggleButton = screen.getByTestId('language-toggle-button');\n      const srText = toggleButton.querySelector('.sr-only');\n      expect(srText).toHaveTextContent('Toggle language');\n    });\n\n    it('should handle missing translations gracefully', async () => {\n      // Mock missing translations\n      mockUseTranslations.mockImplementation((key: string) => `missing.${key}`);\n\n      expect(() => render(<LanguageToggle />)).not.toThrow();\n\n      const toggleButton = screen.getByTestId('language-toggle-button');\n      expect(toggleButton).toBeInTheDocument();\n    });\n  });\n\n  describe('Navigation Integration', () => {\n    it('should preserve current pathname during language switch', async () => {\n      const testPaths = ['/about', '/contact', '/products/item-1'];\n\n      for (const path of testPaths) {\n        mockUsePathname.mockReturnValue(path);\n\n        const { unmount } = render(<LanguageToggle />);\n\n        const englishLinks = screen.getAllByTestId('language-link-en');\n        const chineseLinks = screen.getAllByTestId('language-link-zh');\n\n        // 取第一个匹配的元素\n        expect(englishLinks[0]).toHaveAttribute('href', path);\n        expect(chineseLinks[0]).toHaveAttribute('href', path);\n\n        // 清理DOM以避免重复元素\n        unmount();\n      }\n    });\n\n    it('should handle complex pathnames with parameters', async () => {\n      mockUsePathname.mockReturnValue(\n        '/products/category/electronics?sort=price',\n      );\n\n      render(<LanguageToggle />);\n\n      const links = screen.getAllByTestId(/language-link-/);\n      links.forEach((link) => {\n        expect(link).toHaveAttribute(\n          'href',\n          '/products/category/electronics?sort=price',\n        );\n      });\n    });\n  });\n\n  describe('Accessibility Integration', () => {\n    it('should provide proper ARIA labels and roles', async () => {\n      render(<LanguageToggle />);\n\n      const toggleButton = screen.getByTestId('language-toggle-button');\n      const srText = toggleButton.querySelector('.sr-only');\n      expect(srText).toBeInTheDocument();\n      expect(srText).toHaveTextContent('Toggle language');\n    });\n\n    it('should support keyboard navigation', async () => {\n      render(<LanguageToggle />);\n\n      const toggleButton = screen.getByTestId('language-toggle-button');\n\n      // Test keyboard focus\n      toggleButton.focus();\n      expect(document.activeElement).toBe(toggleButton);\n\n      // Test keyboard activation\n      await user.keyboard('{Enter}');\n      // Dropdown should be accessible via keyboard\n      expect(\n        screen.getByTestId('language-dropdown-content'),\n      ).toBeInTheDocument();\n    });\n  });\n\n  describe('Error Recovery Integration', () => {\n    it('should handle locale detection errors gracefully', async () => {\n      mockUseLocale.mockReturnValue(undefined);\n\n      expect(() => render(<LanguageToggle />)).not.toThrow();\n\n      const toggleButton = screen.getByTestId('language-toggle-button');\n      expect(toggleButton).toBeInTheDocument();\n    });\n\n    it('should handle pathname errors gracefully', async () => {\n      mockUsePathname.mockReturnValue('');\n\n      expect(() => render(<LanguageToggle />)).not.toThrow();\n\n      const links = screen.getAllByTestId(/language-link-/);\n      links.forEach((link) => {\n        expect(link).toHaveAttribute('href', '');\n      });\n    });\n\n    it('should handle transition errors gracefully', async () => {\n      mockStartTransition.mockImplementation(() => {\n        throw new Error('Transition failed');\n      });\n\n      render(<LanguageToggle />);\n\n      const chineseLink = screen.getByTestId('language-link-zh');\n\n      // Should not crash when transition fails\n      expect(() => user.click(chineseLink)).not.toThrow();\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/tests/integration/components/theme-toggle.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/tests/integration/i18n-components.test.tsx","messages":[{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":203,"column":16,"nodeType":"MemberExpression","endLine":203,"endColumn":68}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { fireEvent, render, screen } from '@testing-library/react';\nimport { NextIntlClientProvider } from 'next-intl';\nimport React from 'react';\nimport { beforeEach, describe, expect, it, vi } from 'vitest';\n\n/**\n * i18n 组件集成测试\n *\n * 测试策略：\n * - 在 JSDOM 环境下测试 i18n 组件行为\n * - 使用 NextIntlClientProvider 提供真实的 i18n 上下文\n * - 测试语言切换、消息显示、格式化等功能\n * - 不依赖 SSR 环境，专注于客户端行为\n */\n\n// Mock配置 - 使用vi.hoisted确保Mock在模块导入前设置\nconst {\n  mockUseLocale,\n  mockUseTranslations,\n  mockUsePathname,\n  mockUseRouter,\n  mockLink,\n  mockRouting,\n  mockEnMessages,\n  mockZhMessages,\n} = vi.hoisted(() => ({\n  mockUseLocale: vi.fn(),\n  mockUseTranslations: vi.fn(),\n  mockUsePathname: vi.fn(),\n  mockUseRouter: vi.fn(),\n  mockLink: vi.fn(),\n  mockRouting: {\n    locales: ['en', 'zh'],\n    defaultLocale: 'en',\n  },\n  mockEnMessages: {\n    common: {\n      loading: 'Loading...',\n      error: 'Error occurred',\n      success: 'Success',\n    },\n    navigation: {\n      home: 'Home',\n      about: 'About',\n      contact: 'Contact',\n    },\n    language: {\n      toggle: 'Toggle language',\n      selectLanguage: 'Select Language',\n      english: 'English',\n      chinese: 'Chinese',\n    },\n  },\n  mockZhMessages: {\n    common: {\n      loading: '加载中...',\n      error: '发生错误',\n      success: '成功',\n    },\n    navigation: {\n      home: '首页',\n      about: '关于',\n      contact: '联系',\n    },\n    language: {\n      toggle: '切换语言',\n      selectLanguage: '选择语言',\n      english: '英语',\n      chinese: '中文',\n    },\n  },\n}));\n\n// Mock next-intl hooks\nvi.mock('next-intl', () => ({\n  useLocale: mockUseLocale,\n  useTranslations: mockUseTranslations,\n  NextIntlClientProvider: ({ children, locale }: { children: React.ReactNode; locale: string }) => (\n    <div data-testid={`intl-provider-${locale}`}>{children}</div>\n  ),\n}));\n\n// Mock next-intl/navigation\nvi.mock('next-intl/navigation', () => ({\n  usePathname: mockUsePathname,\n  useRouter: mockUseRouter,\n  Link: mockLink,\n  routing: mockRouting,\n}));\n\n// Mock locale detection hooks\nvi.mock('@/lib/locale-detection', () => ({\n  useClientLocaleDetection: () => ({\n    detectClientLocale: vi.fn().mockReturnValue({\n      locale: 'en',\n      source: 'browser',\n      confidence: 0.9,\n    }),\n  }),\n}));\n\nvi.mock('@/lib/locale-storage', () => ({\n  useLocaleStorage: () => ({\n    getStats: vi.fn().mockReturnValue({\n      switchCount: 0,\n      lastSwitch: null,\n      preferredLocale: null,\n    }),\n  }),\n}));\n\n// 测试组件：简单的翻译组件\nfunction TestTranslationComponent({\n  namespace = 'common',\n}: {\n  namespace?: string;\n}) {\n  const t = mockUseTranslations(namespace);\n\n  return (\n    <div data-testid='translation-component'>\n      <h1 data-testid='loading-text'>{t('loading')}</h1>\n      <p data-testid='error-text'>{t('error')}</p>\n      <span data-testid='success-text'>{t('success')}</span>\n    </div>\n  );\n}\n\n// 测试组件：导航组件\nfunction TestNavigationComponent() {\n  const t = mockUseTranslations('navigation');\n\n  return (\n    <nav data-testid='navigation-component'>\n      <span data-testid='home-link'>{t('home')}</span>\n      <span data-testid='about-link'>{t('about')}</span>\n      <span data-testid='contact-link'>{t('contact')}</span>\n    </nav>\n  );\n}\n\n// 测试组件：语言切换组件\nfunction TestLanguageSwitcher() {\n  const locale = mockUseLocale();\n  const t = mockUseTranslations('language');\n\n  const handleLanguageSwitch = (newLocale: string) => {\n    mockUseLocale.mockReturnValue(newLocale);\n  };\n\n  return (\n    <div data-testid='language-switcher'>\n      <button\n        data-testid='language-toggle'\n        onClick={() => handleLanguageSwitch(locale === 'en' ? 'zh' : 'en')}\n      >\n        {t('toggle')}\n      </button>\n      <div data-testid='current-locale'>{locale}</div>\n      <div data-testid='select-language-text'>{t('selectLanguage')}</div>\n      <div data-testid='english-text'>{t('english')}</div>\n      <div data-testid='chinese-text'>{t('chinese')}</div>\n    </div>\n  );\n}\n\n// 辅助函数：渲染带有i18n上下文的组件\nfunction renderWithI18n(component: React.ReactElement, locale: string = 'en') {\n  const messages = locale === 'en' ? mockEnMessages : mockZhMessages;\n\n  return render(\n    <NextIntlClientProvider\n      locale={locale}\n      messages={messages}\n    >\n      {component}\n    </NextIntlClientProvider>,\n  );\n}\n\ndescribe('i18n 组件集成测试', () => {\n  beforeEach(() => {\n    vi.clearAllMocks();\n\n    // 设置默认Mock返回值\n    mockUseLocale.mockReturnValue('en');\n    mockUsePathname.mockReturnValue('/');\n    mockUseRouter.mockReturnValue({\n      push: vi.fn(),\n      replace: vi.fn(),\n      back: vi.fn(),\n      forward: vi.fn(),\n      refresh: vi.fn(),\n      prefetch: vi.fn(),\n    });\n\n    // 设置翻译函数Mock\n    mockUseTranslations.mockImplementation((namespace: string) => {\n      return (key: string) => {\n        const messages =\n          mockUseLocale() === 'en' ? mockEnMessages : mockZhMessages;\n        const namespaceMessages = messages[namespace as keyof typeof messages];\n        return (namespaceMessages as Record<string, string>)?.[key] || key;\n      };\n    });\n\n    mockLink.mockImplementation(({ children, href, ...props }: React.ComponentProps<'a'> & { href: string }) => (\n      <a\n        href={href}\n        {...props}\n      >\n        {children}\n      </a>\n    ));\n  });\n\n  describe('基础翻译功能', () => {\n    it('应该正确显示英文翻译', () => {\n      renderWithI18n(<TestTranslationComponent />, 'en');\n\n      expect(screen.getByTestId('loading-text')).toHaveTextContent(\n        'Loading...',\n      );\n      expect(screen.getByTestId('error-text')).toHaveTextContent(\n        'Error occurred',\n      );\n      expect(screen.getByTestId('success-text')).toHaveTextContent('Success');\n    });\n\n    it('应该正确显示中文翻译', () => {\n      mockUseLocale.mockReturnValue('zh');\n      renderWithI18n(<TestTranslationComponent />, 'zh');\n\n      expect(screen.getByTestId('loading-text')).toHaveTextContent('加载中...');\n      expect(screen.getByTestId('error-text')).toHaveTextContent('发生错误');\n      expect(screen.getByTestId('success-text')).toHaveTextContent('成功');\n    });\n\n    it('应该支持不同的命名空间', () => {\n      renderWithI18n(<TestTranslationComponent namespace='navigation' />, 'en');\n\n      // 由于使用了navigation命名空间，应该显示navigation的翻译\n      expect(screen.getByTestId('loading-text')).toHaveTextContent('loading');\n      expect(screen.getByTestId('error-text')).toHaveTextContent('error');\n      expect(screen.getByTestId('success-text')).toHaveTextContent('success');\n    });\n  });\n\n  describe('导航组件翻译', () => {\n    it('应该正确显示英文导航', () => {\n      renderWithI18n(<TestNavigationComponent />, 'en');\n\n      expect(screen.getByTestId('home-link')).toHaveTextContent('Home');\n      expect(screen.getByTestId('about-link')).toHaveTextContent('About');\n      expect(screen.getByTestId('contact-link')).toHaveTextContent('Contact');\n    });\n\n    it('应该正确显示中文导航', () => {\n      mockUseLocale.mockReturnValue('zh');\n      renderWithI18n(<TestNavigationComponent />, 'zh');\n\n      expect(screen.getByTestId('home-link')).toHaveTextContent('首页');\n      expect(screen.getByTestId('about-link')).toHaveTextContent('关于');\n      expect(screen.getByTestId('contact-link')).toHaveTextContent('联系');\n    });\n  });\n\n  describe('语言切换功能', () => {\n    it('应该显示当前语言', () => {\n      renderWithI18n(<TestLanguageSwitcher />, 'en');\n\n      expect(screen.getByTestId('current-locale')).toHaveTextContent('en');\n      expect(screen.getByTestId('language-toggle')).toHaveTextContent(\n        'Toggle language',\n      );\n    });\n\n    it('应该支持语言切换按钮点击', async () => {\n      renderWithI18n(<TestLanguageSwitcher />, 'en');\n\n      const toggleButton = screen.getByTestId('language-toggle');\n      fireEvent.click(toggleButton);\n\n      // 验证Mock函数被调用\n      expect(mockUseLocale).toHaveBeenCalled();\n    });\n\n    it('应该显示语言选择相关文本', () => {\n      renderWithI18n(<TestLanguageSwitcher />, 'en');\n\n      expect(screen.getByTestId('select-language-text')).toHaveTextContent(\n        'Select Language',\n      );\n      expect(screen.getByTestId('english-text')).toHaveTextContent('English');\n      expect(screen.getByTestId('chinese-text')).toHaveTextContent('Chinese');\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/tests/integration/pages/home.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/tests/unit/i18n.test.ts","messages":[{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":209,"column":24,"nodeType":"MemberExpression","endLine":209,"endColumn":32},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":209,"column":49,"nodeType":"MemberExpression","endLine":209,"endColumn":57},{"ruleId":"security/detect-object-injection","severity":2,"message":"Function Call Object Injection Sink","line":210,"column":46,"nodeType":"MemberExpression","endLine":210,"endColumn":54}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { beforeEach, describe, expect, it, vi } from 'vitest';\n\n/**\n * i18n 核心功能单元测试\n *\n * 测试策略：\n * - 不依赖 SSR 环境\n * - 专注于核心逻辑测试\n * - 使用 Mock 模拟外部依赖\n * - 覆盖 locale 检测、消息加载、格式化等核心功能\n */\n\n// Mock配置 - 使用vi.hoisted确保Mock在模块导入前设置\nconst { mockRouting, mockEnMessages, mockZhMessages, mockGetFormats } =\n  vi.hoisted(() => ({\n    mockRouting: {\n      locales: ['en', 'zh'] as const,\n      defaultLocale: 'en' as const,\n      pathnames: {},\n    },\n    mockEnMessages: {\n      common: {\n        loading: 'Loading...',\n        error: 'Error occurred',\n        success: 'Success',\n      },\n      navigation: {\n        home: 'Home',\n        about: 'About',\n        contact: 'Contact',\n      },\n      seo: {\n        title: 'Tucsenberg Web Frontier',\n        description: 'Modern B2B Enterprise Web Platform',\n        siteName: 'Tucsenberg Web Frontier',\n      },\n    },\n    mockZhMessages: {\n      common: {\n        loading: '加载中...',\n        error: '发生错误',\n        success: '成功',\n      },\n      navigation: {\n        home: '首页',\n        about: '关于',\n        contact: '联系',\n      },\n      seo: {\n        title: 'Tucsenberg Web Frontier',\n        description: '现代化B2B企业网络平台',\n        siteName: 'Tucsenberg Web Frontier',\n      },\n    },\n    mockGetFormats: vi.fn(),\n    mockDetectLocale: vi.fn(),\n    mockLoadMessages: vi.fn(),\n  }));\n\n// Mock routing配置\nvi.mock('@/i18n/routing', () => ({\n  routing: mockRouting,\n}));\n\n// Mock 消息文件\nvi.mock('../../../messages/en.json', () => ({\n  default: mockEnMessages,\n}));\n\nvi.mock('../../../messages/zh.json', () => ({\n  default: mockZhMessages,\n}));\n\n// Mock 格式化函数\nvi.mock('@/i18n/formats', () => ({\n  getFormats: mockGetFormats,\n}));\n\ndescribe('i18n 核心功能单元测试', () => {\n  beforeEach(() => {\n    vi.clearAllMocks();\n\n    // 重置环境变量\n    vi.stubEnv('NODE_ENV', 'test');\n    vi.stubEnv('PLAYWRIGHT_TEST', 'false');\n\n    // 设置默认的格式化配置\n    mockGetFormats.mockReturnValue({\n      dateTime: {\n        short: {\n          day: 'numeric' as const,\n          month: 'short' as const,\n          year: 'numeric' as const,\n        },\n      },\n      number: {\n        currency: {\n          style: 'currency' as const,\n          currency: 'USD',\n        },\n      },\n    });\n  });\n\n  describe('Locale 检测和验证', () => {\n    it('应该正确验证有效的 locale', () => {\n      const validLocales = ['en', 'zh'];\n\n      validLocales.forEach((locale) => {\n        expect(mockRouting.locales).toContain(locale);\n      });\n    });\n\n    it('应该识别无效的 locale', () => {\n      const invalidLocales = ['fr', 'de', 'ja', 'invalid'];\n\n      invalidLocales.forEach((locale) => {\n        expect(mockRouting.locales).not.toContain(locale);\n      });\n    });\n\n    it('应该提供默认 locale', () => {\n      expect(mockRouting.defaultLocale).toBe('en');\n      expect(mockRouting.locales).toContain(mockRouting.defaultLocale);\n    });\n\n    it('应该处理 locale 回退逻辑', () => {\n      // 模拟 locale 回退函数\n      const fallbackToDefault = (locale: string | null | undefined) => {\n        if (!locale || !mockRouting.locales.includes(locale as string)) {\n          return mockRouting.defaultLocale;\n        }\n        return locale;\n      };\n\n      expect(fallbackToDefault(null)).toBe('en');\n      expect(fallbackToDefault(undefined)).toBe('en');\n      expect(fallbackToDefault('')).toBe('en');\n      expect(fallbackToDefault('invalid')).toBe('en');\n      expect(fallbackToDefault('zh')).toBe('zh');\n      expect(fallbackToDefault('en')).toBe('en');\n    });\n  });\n\n  describe('消息加载和缓存', () => {\n    it('应该正确加载英文消息', async () => {\n      // 模拟消息加载函数\n      const loadMessages = async (locale: string) => {\n        if (locale === 'en') {\n          return mockEnMessages;\n        } else if (locale === 'zh') {\n          return mockZhMessages;\n        }\n        throw new Error(`Unsupported locale: ${locale}`);\n      };\n\n      const enMessages = await loadMessages('en');\n      expect(enMessages).toEqual(mockEnMessages);\n      expect(enMessages.common.loading).toBe('Loading...');\n      expect(enMessages.navigation.home).toBe('Home');\n    });\n\n    it('应该正确加载中文消息', async () => {\n      const loadMessages = async (locale: string) => {\n        if (locale === 'en') {\n          return mockEnMessages;\n        } else if (locale === 'zh') {\n          return mockZhMessages;\n        }\n        throw new Error(`Unsupported locale: ${locale}`);\n      };\n\n      const zhMessages = await loadMessages('zh');\n      expect(zhMessages).toEqual(mockZhMessages);\n      expect(zhMessages.common.loading).toBe('加载中...');\n      expect(zhMessages.navigation.home).toBe('首页');\n    });\n\n    it('应该处理消息加载错误', async () => {\n      const loadMessages = async (locale: string) => {\n        if (locale === 'invalid') {\n          throw new Error(`Unsupported locale: ${locale}`);\n        }\n        return mockEnMessages;\n      };\n\n      await expect(loadMessages('invalid')).rejects.toThrow(\n        'Unsupported locale: invalid',\n      );\n    });\n\n    it('应该验证消息结构完整性', () => {\n      // 验证必需的消息键存在\n      const requiredKeys = [\n        'common.loading',\n        'common.error',\n        'common.success',\n        'navigation.home',\n        'navigation.about',\n        'seo.title',\n        'seo.description',\n      ];\n\n      const validateMessages = (messages: Record<string, unknown>) => {\n        const flattenKeys = (obj: Record<string, unknown>, prefix = ''): string[] => {\n          let keys: string[] = [];\n          Object.keys(obj).forEach((key) => {\n            const fullKey = prefix ? `${prefix}.${key}` : key;\n            if (typeof obj[key] === 'object' && obj[key] !== null) {\n              keys = keys.concat(flattenKeys(obj[key], fullKey));\n            } else {\n              keys.push(fullKey);\n            }\n          });\n          return keys;\n        };\n\n        const availableKeys = flattenKeys(messages);\n        return requiredKeys.every((key) => availableKeys.includes(key));\n      };\n\n      expect(validateMessages(mockEnMessages)).toBe(true);\n      expect(validateMessages(mockZhMessages)).toBe(true);\n    });\n  });\n\n  describe('格式化配置', () => {\n    it('应该为英文提供正确的格式化配置', () => {\n      const enFormats = {\n        dateTime: {\n          short: {\n            day: 'numeric' as const,\n            month: 'short' as const,\n            year: 'numeric' as const,\n          },\n        },\n        number: {\n          currency: {\n            style: 'currency' as const,\n            currency: 'USD',\n          },\n        },\n      };\n\n      mockGetFormats.mockReturnValue(enFormats);\n      const formats = mockGetFormats('en');\n\n      expect(formats.number.currency.currency).toBe('USD');\n      expect(formats.dateTime.short.day).toBe('numeric');\n    });\n\n    it('应该为中文提供正确的格式化配置', () => {\n      const zhFormats = {\n        dateTime: {\n          short: {\n            day: 'numeric' as const,\n            month: 'short' as const,\n            year: 'numeric' as const,\n          },\n        },\n        number: {\n          currency: {\n            style: 'currency' as const,\n            currency: 'CNY',\n          },\n        },\n      };\n\n      mockGetFormats.mockReturnValue(zhFormats);\n      const formats = mockGetFormats('zh');\n\n      expect(formats.number.currency.currency).toBe('CNY');\n      expect(formats.dateTime.short.day).toBe('numeric');\n    });\n  });\n\n  describe('时区配置', () => {\n    it('应该为不同 locale 提供正确的时区', () => {\n      const getTimeZone = (locale: string) => {\n        return locale === 'zh' ? 'Asia/Shanghai' : 'UTC';\n      };\n\n      expect(getTimeZone('en')).toBe('UTC');\n      expect(getTimeZone('zh')).toBe('Asia/Shanghai');\n      expect(getTimeZone('unknown')).toBe('UTC'); // 默认回退\n    });\n  });\n\n  describe('测试环境特殊处理', () => {\n    it('应该在测试环境下禁用严格类型检查', () => {\n      vi.stubEnv('NODE_ENV', 'test');\n\n      const getStrictMessageTypeSafety = () => {\n        return (\n          process.env.NODE_ENV !== 'test' &&\n          process.env.PLAYWRIGHT_TEST !== 'true'\n        );\n      };\n\n      expect(getStrictMessageTypeSafety()).toBe(false);\n    });\n\n    it('应该在 Playwright 测试环境下禁用严格类型检查', () => {\n      vi.stubEnv('PLAYWRIGHT_TEST', 'true');\n\n      const getStrictMessageTypeSafety = () => {\n        return (\n          process.env.NODE_ENV !== 'test' &&\n          process.env.PLAYWRIGHT_TEST !== 'true'\n        );\n      };\n\n      expect(getStrictMessageTypeSafety()).toBe(false);\n    });\n\n    it('应该在生产环境下启用严格类型检查', () => {\n      vi.stubEnv('NODE_ENV', 'production');\n      vi.stubEnv('PLAYWRIGHT_TEST', 'false');\n\n      const getStrictMessageTypeSafety = () => {\n        return (\n          process.env.NODE_ENV !== 'test' &&\n          process.env.PLAYWRIGHT_TEST !== 'true'\n        );\n      };\n\n      expect(getStrictMessageTypeSafety()).toBe(true);\n    });\n  });\n\n  describe('配置对象生成', () => {\n    it('应该生成完整的 i18n 配置对象', () => {\n      const generateConfig = (locale: string, messages: Record<string, unknown>) => {\n        return {\n          locale,\n          messages: messages || {},\n          timeZone: locale === 'zh' ? 'Asia/Shanghai' : 'UTC',\n          now: new Date(),\n          formats: mockGetFormats(locale),\n          strictMessageTypeSafety:\n            process.env.NODE_ENV !== 'test' &&\n            process.env.PLAYWRIGHT_TEST !== 'true',\n        };\n      };\n\n      const enConfig = generateConfig('en', mockEnMessages);\n      expect(enConfig.locale).toBe('en');\n      expect(enConfig.messages).toEqual(mockEnMessages);\n      expect(enConfig.timeZone).toBe('UTC');\n      expect(enConfig.now).toBeInstanceOf(Date);\n      expect(enConfig.strictMessageTypeSafety).toBe(false); // 测试环境\n\n      const zhConfig = generateConfig('zh', mockZhMessages);\n      expect(zhConfig.locale).toBe('zh');\n      expect(zhConfig.messages).toEqual(mockZhMessages);\n      expect(zhConfig.timeZone).toBe('Asia/Shanghai');\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/vitest.config.browser.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"/Users/Data/Warehouse/Focus/tucsenberg-web-frontier/vitest.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-return-await","replacedBy":[],"info":{"message":"The original assumption of the rule no longer holds true because of engine optimization.","deprecatedSince":"8.46.0","availableUntil":null,"replacedBy":[]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":null,"replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]}]