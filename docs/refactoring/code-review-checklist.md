# ✅ 架构重构代码审查Checklist

## 🏗️ 架构层面检查

### 域边界规则
- [ ] **跨域访问合规**：是否通过公开API访问其他域？
- [ ] **依赖方向正确**：是否遵循应用层→领域层→基础层的依赖方向？
- [ ] **循环依赖检查**：是否存在循环依赖？
- [ ] **模块职责单一**：每个模块是否职责明确？

### 导入导出规范
- [ ] **禁止export \***：是否避免了新增export *重新导出？
- [ ] **使用@/别名**：是否统一使用@/路径别名而非相对路径？
- [ ] **import type正确**：是否正确使用import type导入类型？
- [ ] **命名导出优先**：是否使用命名导出而非默认导出？

### 文件组织结构
- [ ] **目录结构清晰**：新增目录是否遵循域驱动设计原则？
- [ ] **文件命名规范**：文件名是否遵循kebab-case命名规范？
- [ ] **类型文件独立**：类型定义是否集中在types.ts文件中？
- [ ] **公开API明确**：是否通过index.ts明确定义公开API？

## 🔧 代码质量检查

### TypeScript规范
- [ ] **严格模式**：是否启用TypeScript严格模式？
- [ ] **类型安全**：是否避免使用any类型？
- [ ] **接口优先**：是否优先使用interface而非type？
- [ ] **枚举避免**：是否避免使用enum，改用const assertion？

### 代码复杂度
- [ ] **函数长度**：函数是否不超过120行？
- [ ] **圈复杂度**：函数圈复杂度是否不超过15？
- [ ] **参数数量**：函数参数是否不超过5个？
- [ ] **嵌套深度**：代码嵌套深度是否不超过4层？

### 命名规范
- [ ] **布尔值命名**：布尔值是否使用is/has/can/should前缀？
- [ ] **事件处理器**：事件处理器是否使用handle前缀？
- [ ] **常量命名**：常量是否使用UPPER_SNAKE_CASE？
- [ ] **组件命名**：React组件是否使用PascalCase？

## 🧪 测试与质量

### 测试覆盖
- [ ] **单元测试**：新增代码是否有对应的单元测试？
- [ ] **集成测试**：重构的模块是否有集成测试？
- [ ] **测试覆盖率**：测试覆盖率是否保持或提升？
- [ ] **边界测试**：是否测试了边界条件和错误情况？

### 质量门禁
- [ ] **TypeScript编译**：`pnpm type-check`是否通过？
- [ ] **ESLint检查**：`pnpm lint:check`是否通过？
- [ ] **测试执行**：`pnpm test`是否全部通过？
- [ ] **构建成功**：`pnpm build`是否成功？

### 性能检查
- [ ] **构建时间**：构建时间是否无明显增加？
- [ ] **包大小**：包大小是否在预算范围内？
- [ ] **运行时性能**：是否无性能回归？
- [ ] **内存使用**：是否无内存泄漏风险？

## 📚 文档与兼容性

### 文档更新
- [ ] **API文档**：是否更新了相关API文档？
- [ ] **README更新**：是否更新了项目README？
- [ ] **变更日志**：是否记录了重要变更？
- [ ] **迁移指南**：是否提供了迁移指南？

### 向后兼容
- [ ] **API兼容性**：公开API是否保持向后兼容？
- [ ] **过渡期支持**：是否建立了过渡期兼容层？
- [ ] **废弃标记**：旧API是否添加了@deprecated标记？
- [ ] **迁移时间表**：是否制定了清晰的迁移时间表？

## 🔄 重构特定检查

### 小步快跑原则
- [ ] **PR大小**：PR是否控制在300-600行代码变更？
- [ ] **文件数量**：单次PR是否不超过10个文件？
- [ ] **域范围**：是否仅涉及1-2个功能域？
- [ ] **原子性**：变更是否具有原子性，可以独立部署？

### 过渡期管理
- [ ] **兼容层建立**：是否为重构的模块建立了兼容层？
- [ ] **渐进式迁移**：是否采用渐进式迁移策略？
- [ ] **回滚计划**：是否有明确的回滚计划？
- [ ] **监控机制**：是否建立了重构进度监控？

### 工具使用
- [ ] **度量工具**：是否使用了架构度量工具验证改进？
- [ ] **转换脚本**：是否使用了自动化转换脚本？
- [ ] **依赖检查**：是否运行了dependency-cruiser检查？
- [ ] **质量监控**：是否更新了质量监控基线？

## 🚨 风险评估

### 高风险变更
- [ ] **核心模块**：如果涉及核心模块，是否有额外的测试保障？
- [ ] **外部依赖**：是否影响了外部系统的集成？
- [ ] **数据迁移**：是否涉及数据结构变更？
- [ ] **配置变更**：是否需要更新部署配置？

### 回滚准备
- [ ] **回滚脚本**：是否准备了回滚脚本？
- [ ] **数据备份**：是否备份了相关数据？
- [ ] **监控告警**：是否设置了监控告警？
- [ ] **应急预案**：是否制定了应急预案？

## 📊 审查结果

### 审查评级
- [ ] **✅ 通过**：所有检查项都满足，可以合并
- [ ] **⚠️ 有条件通过**：大部分检查项满足，有小问题需要修复
- [ ] **❌ 不通过**：存在重大问题，需要重新修改

### 改进建议
- [ ] **架构建议**：是否有架构层面的改进建议？
- [ ] **性能优化**：是否有性能优化建议？
- [ ] **代码质量**：是否有代码质量改进建议？
- [ ] **最佳实践**：是否有最佳实践分享？

## 🎯 审查要点总结

### 必须检查项（阻塞性）
1. TypeScript编译通过
2. 所有测试通过
3. 无破坏性API变更
4. 遵循域边界规则
5. 无新增export *

### 重要检查项（建议性）
1. 代码质量指标达标
2. 测试覆盖率保持
3. 文档更新完整
4. 性能无回归
5. 遵循命名规范

### 优化检查项（改进性）
1. 代码可读性
2. 架构清晰度
3. 重构完整性
4. 工具使用效果
5. 团队协作效率

---

**审查原则**：严格把关质量，积极提供建设性建议，确保重构目标达成！
