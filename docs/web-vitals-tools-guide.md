# Web Vitals å·¥å…·å®Œæ•´æŒ‡å—

**æ›´æ–°æ—¥æœŸ**: 2025-09-30  
**é¡¹ç›®**: tucsenberg-web-frontier  
**æŠ€æœ¯æ ˆ**: Next.js 15.5.4 + React 19.1.1

---

## ğŸ“Š é¡¹ç›®ç°æœ‰ Web Vitals å·¥å…·

### 1. Web Vitals Indicatorï¼ˆå·¦ä¸‹è§’å®æ—¶æ˜¾ç¤ºï¼‰

**ä½ç½®**: æ‰€æœ‰é¡µé¢å·¦ä¸‹è§’  
**æ–‡ä»¶**: `src/components/performance/web-vitals-indicator.tsx`

**æ ¸å¿ƒåŠŸèƒ½**:
- âœ… **å®æ—¶ç›‘æ§**: æ˜¾ç¤º 5 ä¸ªæ ¸å¿ƒ Web Vitals æŒ‡æ ‡
- âœ… **æ‹–åŠ¨åŠŸèƒ½**: å¯æ‹–åŠ¨åˆ°ä»»æ„ä½ç½®ï¼Œ8 ç§’åè‡ªåŠ¨å½’ä½
- âœ… **é¢œè‰²ç¼–ç **: ç»¿è‰²ï¼ˆä¼˜ç§€ï¼‰ã€é»„è‰²ï¼ˆéœ€æ”¹è¿›ï¼‰ã€çº¢è‰²ï¼ˆå·®ï¼‰
- âœ… **å“åº”å¼**: é€‚é…ç§»åŠ¨ç«¯å’Œæ¡Œé¢ç«¯

**ç›‘æ§æŒ‡æ ‡**:
| æŒ‡æ ‡ | å…¨ç§° | å«ä¹‰ | ä¼˜ç§€é˜ˆå€¼ |
|------|------|------|---------|
| **CLS** | Cumulative Layout Shift | ç´¯ç§¯å¸ƒå±€åç§» | â‰¤0.1 |
| **FID** | First Input Delay | é¦–æ¬¡è¾“å…¥å»¶è¿Ÿ | â‰¤100ms |
| **LCP** | Largest Contentful Paint | æœ€å¤§å†…å®¹ç»˜åˆ¶ | â‰¤2.5s |
| **FCP** | First Contentful Paint | é¦–æ¬¡å†…å®¹ç»˜åˆ¶ | â‰¤1.8s |
| **TTFB** | Time to First Byte | é¦–å­—èŠ‚æ—¶é—´ | â‰¤800ms |

**ä½¿ç”¨æ–¹å¼**:
```typescript
// å·²åœ¨ src/app/[locale]/layout.tsx ä¸­å…¨å±€å¯ç”¨
<WebVitalsIndicator />
```

**æ‹–åŠ¨åŠŸèƒ½**:
- é¼ æ ‡æŒ‰ä½æ‹–åŠ¨åˆ°ä»»æ„ä½ç½®
- 8 ç§’åè‡ªåŠ¨å½’ä½åˆ°å·¦ä¸‹è§’
- æ‹–åŠ¨æ—¶æ˜¾ç¤º `cursor: grabbing`

---

### 2. Web Vitals API ç«¯ç‚¹

**ç«¯ç‚¹**: `/api/analytics/web-vitals`  
**æ–‡ä»¶**: `src/app/api/analytics/web-vitals/route.ts`

**åŠŸèƒ½**:
- âœ… **æ•°æ®æ”¶é›†**: æ¥æ”¶å®¢æˆ·ç«¯å‘é€çš„ Web Vitals æ•°æ®
- âœ… **æ•°æ®å­˜å‚¨**: å­˜å‚¨åˆ°æ•°æ®åº“æˆ–æ—¥å¿—ç³»ç»Ÿ
- âœ… **æ•°æ®åˆ†æ**: æ”¯æŒæ‰¹é‡æ•°æ®åˆ†æ

**è¯·æ±‚æ ¼å¼**:
```typescript
POST /api/analytics/web-vitals
Content-Type: application/json

{
  "name": "CLS",
  "value": 0.05,
  "rating": "good",
  "delta": 0.05,
  "id": "v3-1234567890",
  "navigationType": "navigate"
}
```

**å“åº”æ ¼å¼**:
```typescript
{
  "success": true,
  "message": "Web Vitals data received"
}
```

---

### 3. Web Vitals æ•°æ®æ”¶é›†å™¨

**æ–‡ä»¶**: `src/lib/web-vitals/web-vitals-collector-base.ts`

**åŠŸèƒ½**:
- âœ… **è‡ªåŠ¨æ”¶é›†**: ä½¿ç”¨ `web-vitals` åº“è‡ªåŠ¨æ”¶é›†æ•°æ®
- âœ… **æ‰¹é‡å‘é€**: æ‰¹é‡å‘é€æ•°æ®åˆ° API ç«¯ç‚¹
- âœ… **é”™è¯¯å¤„ç†**: å®Œå–„çš„é”™è¯¯å¤„ç†æœºåˆ¶

**ä½¿ç”¨æ–¹å¼**:
```typescript
import { WebVitalsCollector } from '@/lib/web-vitals/web-vitals-collector-base';

const collector = new WebVitalsCollector({
  endpoint: '/api/analytics/web-vitals',
  batchSize: 10,
  flushInterval: 5000
});

collector.start();
```

---

## ğŸ› ï¸ æ¨èçš„å¤–éƒ¨ Web Vitals å·¥å…·

### 1. Chrome DevToolsï¼ˆå…è´¹ï¼Œæœ€å¼ºå¤§ï¼‰

**ä¼˜åŠ¿**:
- âœ… **å®Œå…¨å…è´¹**: å†…ç½®äº Chrome æµè§ˆå™¨
- âœ… **åŠŸèƒ½æœ€å¼º**: æœ€è¯¦ç»†çš„æ€§èƒ½åˆ†æ
- âœ… **å®æ—¶ç›‘æ§**: Performance é¢æ¿å®æ—¶ç›‘æ§
- âœ… **å½•åˆ¶å›æ”¾**: å½•åˆ¶æ€§èƒ½é—®é¢˜å¹¶å›æ”¾åˆ†æ

**ä½¿ç”¨æ–¹å¼**:
1. æ‰“å¼€ Chrome DevToolsï¼ˆF12ï¼‰
2. åˆ‡æ¢åˆ° **Performance** é¢æ¿
3. ç‚¹å‡» **Record** å¼€å§‹å½•åˆ¶
4. æ‰§è¡Œæ“ä½œåç‚¹å‡» **Stop**
5. åˆ†æ Web Vitals æŒ‡æ ‡

**æ ¸å¿ƒåŠŸèƒ½**:
- **Performance é¢æ¿**: è¯¦ç»†çš„æ€§èƒ½æ—¶é—´çº¿
- **Lighthouse é¢æ¿**: è‡ªåŠ¨åŒ–æ€§èƒ½å®¡è®¡
- **Network é¢æ¿**: ç½‘ç»œè¯·æ±‚åˆ†æ
- **Coverage é¢æ¿**: ä»£ç è¦†ç›–ç‡åˆ†æ

---

### 2. Lighthouseï¼ˆå…è´¹ï¼Œè‡ªåŠ¨åŒ–å®¡è®¡ï¼‰

**ä¼˜åŠ¿**:
- âœ… **è‡ªåŠ¨åŒ–**: ä¸€é”®ç”Ÿæˆå®Œæ•´æ€§èƒ½æŠ¥å‘Š
- âœ… **å…¨é¢è¯„åˆ†**: æ€§èƒ½ã€å¯è®¿é—®æ€§ã€æœ€ä½³å®è·µã€SEO
- âœ… **ä¼˜åŒ–å»ºè®®**: å…·ä½“çš„ä¼˜åŒ–å»ºè®®å’Œä»£ç ç¤ºä¾‹
- âœ… **CI/CD é›†æˆ**: æ”¯æŒå‘½ä»¤è¡Œå’Œ CI/CD é›†æˆ

**ä½¿ç”¨æ–¹å¼**:

**æ–¹å¼ 1: Chrome DevTools**
1. æ‰“å¼€ Chrome DevToolsï¼ˆF12ï¼‰
2. åˆ‡æ¢åˆ° **Lighthouse** é¢æ¿
3. é€‰æ‹©å®¡è®¡ç±»åˆ«ï¼ˆPerformance, Accessibility, etc.ï¼‰
4. ç‚¹å‡» **Analyze page load**

**æ–¹å¼ 2: å‘½ä»¤è¡Œ**
```bash
# å®‰è£… Lighthouse CLI
npm install -g lighthouse

# è¿è¡Œå®¡è®¡
lighthouse https://example.com --view

# ç”Ÿæˆ JSON æŠ¥å‘Š
lighthouse https://example.com --output json --output-path ./report.json
```

**æ–¹å¼ 3: CI/CD é›†æˆï¼ˆé¡¹ç›®å·²é…ç½®ï¼‰**
```bash
# é¡¹ç›®å·²é…ç½® Lighthouse CI
pnpm lighthouse:ci

# é…ç½®æ–‡ä»¶: lighthouserc.js
```

---

### 3. Web Vitals Chrome æ‰©å±•ï¼ˆå…è´¹ï¼Œå®æ—¶æ˜¾ç¤ºï¼‰

**ä¼˜åŠ¿**:
- âœ… **å®æ—¶æ˜¾ç¤º**: åœ¨ä»»ä½•ç½‘ç«™ä¸Šå®æ—¶æ˜¾ç¤º Web Vitals
- âœ… **ç®€å•æ˜“ç”¨**: æ— éœ€é…ç½®ï¼Œå®‰è£…å³ç”¨
- âœ… **å†å²è®°å½•**: è®°å½•å†å²æ•°æ®

**å®‰è£…æ–¹å¼**:
1. è®¿é—® [Chrome Web Store](https://chrome.google.com/webstore/detail/web-vitals/ahfhijdlegdabablpippeagghigmibma)
2. ç‚¹å‡» **Add to Chrome**
3. è®¿é—®ä»»ä½•ç½‘ç«™å³å¯çœ‹åˆ° Web Vitals æ•°æ®

---

### 4. PageSpeed Insightsï¼ˆå…è´¹ï¼ŒGoogle å®˜æ–¹ï¼‰

**ä¼˜åŠ¿**:
- âœ… **å®˜æ–¹å·¥å…·**: Google å®˜æ–¹æ€§èƒ½åˆ†æå·¥å…·
- âœ… **çœŸå®æ•°æ®**: åŸºäº Chrome User Experience Report çš„çœŸå®ç”¨æˆ·æ•°æ®
- âœ… **ç§»åŠ¨ç«¯åˆ†æ**: åŒæ—¶åˆ†æç§»åŠ¨ç«¯å’Œæ¡Œé¢ç«¯æ€§èƒ½
- âœ… **ä¼˜åŒ–å»ºè®®**: è¯¦ç»†çš„ä¼˜åŒ–å»ºè®®

**ä½¿ç”¨æ–¹å¼**:
1. è®¿é—® [PageSpeed Insights](https://pagespeed.web.dev/)
2. è¾“å…¥ç½‘ç«™ URL
3. ç‚¹å‡» **Analyze**
4. æŸ¥çœ‹æ€§èƒ½æŠ¥å‘Šå’Œä¼˜åŒ–å»ºè®®

---

### 5. Sentry Performanceï¼ˆä»˜è´¹ï¼Œç”Ÿäº§çº§ç›‘æ§ï¼Œé»˜è®¤å®¢æˆ·ç«¯ç¦ç”¨ï¼‰

**ä¼˜åŠ¿**:
- âœ… **ç”Ÿäº§çº§ç›‘æ§**: å®æ—¶ç›‘æ§ç”Ÿäº§ç¯å¢ƒæ€§èƒ½
- âœ… **é”™è¯¯è¿½è¸ª**: åŒæ—¶è¿½è¸ªé”™è¯¯å’Œæ€§èƒ½é—®é¢˜
- âœ… **ç”¨æˆ·ä¼šè¯**: è®°å½•ç”¨æˆ·ä¼šè¯å’Œæ€§èƒ½æ•°æ®
- âœ… **å‘Šè­¦ç³»ç»Ÿ**: æ€§èƒ½é€€åŒ–è‡ªåŠ¨å‘Šè­¦

**ä»·æ ¼**:
- **å…è´¹ç‰ˆ**: 5,000 events/æœˆ
- **å›¢é˜Ÿç‰ˆ**: $26/æœˆèµ·
- **ä¼ä¸šç‰ˆ**: å®šåˆ¶ä»·æ ¼

**é»˜è®¤ç­–ç•¥**:
- æ¨¡æ¿é»˜è®¤ä¸å¯ç”¨â€œå®¢æˆ·ç«¯ Sentryâ€ï¼Œä»¥é¿å…å½±å“é¦–å±ä¸ CWVã€‚
- æ¨èâ€œæœåŠ¡ç«¯/è¾¹ç¼˜ä¼˜å…ˆâ€æ¥å…¥ï¼ˆAPIã€Server Actionsã€Edgeï¼‰å¹¶æŒ‰éœ€å¼€å¯å®¢æˆ·ç«¯æœ€å°åŒ–ä¸ŠæŠ¥ã€‚

**å¯ç”¨/ç¦ç”¨é—¨æ§**ï¼ˆäºŒé€‰ä¸€ï¼‰ï¼š
```bash
# ç¦ç”¨ï¼ˆé»˜è®¤å»ºè®®ï¼‰ï¼šä¸æ‰“åŒ…ã€ä¸å¯ç”¨å®¢æˆ·ç«¯
DISABLE_SENTRY_BUNDLE=1
NEXT_PUBLIC_DISABLE_SENTRY=1

# å¯ç”¨ï¼ˆç”Ÿäº§ä¸”æœ‰å‘Šè­¦æµç¨‹æ—¶ï¼‰ï¼š
unset DISABLE_SENTRY_BUNDLE
unset NEXT_PUBLIC_DISABLE_SENTRY
```

**æœåŠ¡ç«¯/è¾¹ç¼˜ç¤ºä¾‹**ï¼ˆæŒ‰éœ€å¯ç”¨ï¼‰ï¼š
```ts
// sentry.server.config.ts / sentry.edge.config.tsï¼ˆå­˜åœ¨æ—¶ï¼‰
import * as Sentry from '@sentry/nextjs';

Sentry.init({
  dsn: process.env.SENTRY_DSN,
  tracesSampleRate: 0,         // å…³é—­ tracingï¼Œæ§åˆ¶æˆæœ¬ä¸ä½“ç§¯
  integrations: [],            // ä»…å¯ç”¨å¿…è¦é›†æˆ
  debug: false,
});
```

---

### 6. Datadog RUMï¼ˆä»˜è´¹ï¼Œä¼ä¸šçº§ï¼‰

**ä¼˜åŠ¿**:
- âœ… **ä¼ä¸šçº§**: é€‚åˆå¤§å‹ä¼ä¸š
- âœ… **å…¨æ ˆç›‘æ§**: å‰ç«¯ + åç«¯ + åŸºç¡€è®¾æ–½
- âœ… **AI åˆ†æ**: AI é©±åŠ¨çš„æ€§èƒ½åˆ†æ
- âœ… **é›†æˆä¸°å¯Œ**: ä¸å„ç§å·¥å…·é›†æˆ

**ä»·æ ¼**:
- **å…è´¹è¯•ç”¨**: 14 å¤©
- **Pro ç‰ˆ**: $15/æœˆèµ·
- **Enterprise ç‰ˆ**: å®šåˆ¶ä»·æ ¼

---

## ğŸ“ˆ å·¥å…·å¯¹æ¯”è¡¨

| å·¥å…· | ç±»å‹ | ä»·æ ¼ | å®æ—¶ç›‘æ§ | å†å²æ•°æ® | è¯¦ç»†åˆ†æ | CI/CD | æ¨èåº¦ |
|------|------|------|---------|---------|---------|-------|--------|
| **Web Vitals Indicator** | å†…ç½® | å…è´¹ | âœ… | âŒ | âŒ | âŒ | â­â­â­â­ |
| **Chrome DevTools** | æµè§ˆå™¨ | å…è´¹ | âœ… | âœ… | âœ… | âŒ | â­â­â­â­â­ |
| **Lighthouse** | å®¡è®¡ | å…è´¹ | âŒ | âŒ | âœ… | âœ… | â­â­â­â­â­ |
| **Web Vitals æ‰©å±•** | æ‰©å±• | å…è´¹ | âœ… | âœ… | âŒ | âŒ | â­â­â­â­ |
| **PageSpeed Insights** | åœ¨çº¿ | å…è´¹ | âŒ | âœ… | âœ… | âŒ | â­â­â­â­ |
| **Sentry Performance** | SaaS | ä»˜è´¹ | âœ… | âœ… | âœ… | âœ… | â­â­â­â­ |
| **Datadog RUM** | SaaS | ä»˜è´¹ | âœ… | âœ… | âœ… | âœ… | â­â­â­â­ |

---

## ğŸ¯ ä½¿ç”¨åœºæ™¯æ¨è

### åœºæ™¯ 1: æ—¥å¸¸å¼€å‘
**æ¨èå·¥å…·**: Web Vitals Indicator + Chrome DevTools
- **ç†ç”±**: å®æ—¶åé¦ˆ + è¯¦ç»†åˆ†æ
- **æˆæœ¬**: å…è´¹
- **æ•ˆç‡**: é«˜

### åœºæ™¯ 2: æ€§èƒ½ä¼˜åŒ–
**æ¨èå·¥å…·**: Chrome DevTools + Lighthouse
- **ç†ç”±**: æœ€è¯¦ç»†çš„æ€§èƒ½åˆ†æ + ä¼˜åŒ–å»ºè®®
- **æˆæœ¬**: å…è´¹
- **æ•ˆç‡**: æœ€é«˜

### åœºæ™¯ 3: CI/CD é›†æˆ
**æ¨èå·¥å…·**: Lighthouse CIï¼ˆé¡¹ç›®å·²é…ç½®ï¼‰
- **ç†ç”±**: è‡ªåŠ¨åŒ–æ€§èƒ½å®¡è®¡ + æ€§èƒ½å›å½’æ£€æµ‹
- **æˆæœ¬**: å…è´¹
- **æ•ˆç‡**: é«˜

### åœºæ™¯ 4: ç”Ÿäº§ç¯å¢ƒç›‘æ§
**æ¨èå·¥å…·**: Sentry Performanceï¼ˆå¯é€‰ï¼Œé»˜è®¤å®¢æˆ·ç«¯ç¦ç”¨ï¼ŒæœåŠ¡ç«¯/è¾¹ç¼˜ä¼˜å…ˆï¼‰
- **ç†ç”±**: å®æ—¶ç›‘æ§ + é”™è¯¯è¿½è¸ª + å‘Šè­¦ç³»ç»Ÿ
- **æˆæœ¬**: $26/æœˆèµ·
- **æ•ˆç‡**: é«˜

### åœºæ™¯ 5: ä¼ä¸šçº§ç›‘æ§
**æ¨èå·¥å…·**: Datadog RUM
- **ç†ç”±**: å…¨æ ˆç›‘æ§ + AI åˆ†æ + ä¸°å¯Œé›†æˆ
- **æˆæœ¬**: $15/æœˆèµ·
- **æ•ˆç‡**: æœ€é«˜

---

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. å¼€å‘é˜¶æ®µ
```bash
# ä½¿ç”¨ Web Vitals Indicator å®æ—¶ç›‘æ§
# ä½¿ç”¨ Chrome DevTools è¯¦ç»†åˆ†æ
# ä½¿ç”¨ Lighthouse å®šæœŸå®¡è®¡
```

### 2. æäº¤å‰æ£€æŸ¥
```bash
# è¿è¡Œ Lighthouse CI
pnpm lighthouse:ci

# æ£€æŸ¥æ€§èƒ½æŒ‡æ ‡æ˜¯å¦é€€åŒ–
```

### 3. ç”Ÿäº§ç¯å¢ƒ
```bash
# é»˜è®¤ï¼šç¦ç”¨å®¢æˆ·ç«¯ Sentryï¼Œä¾èµ– Vercel Analytics + Speed Insights + æœåŠ¡å™¨æ—¥å¿—
# å¯é€‰ï¼šå¯ç”¨æœåŠ¡ç«¯/è¾¹ç¼˜ Sentryï¼ˆæœ‰å‘Šè­¦æµç¨‹æ—¶ï¼‰
``` 

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [Web Vitals å®˜æ–¹æ–‡æ¡£](https://web.dev/vitals/)
- [Chrome DevTools æ–‡æ¡£](https://developer.chrome.com/docs/devtools/)
- [Lighthouse æ–‡æ¡£](https://developer.chrome.com/docs/lighthouse/)
- [Sentry Performance æ–‡æ¡£](https://docs.sentry.io/product/performance/)

---

**æ–‡æ¡£å®Œæˆæ—¶é—´**: 2025-09-30  
**ç»´æŠ¤è€…**: AI Assistant
